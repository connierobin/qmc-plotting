Rank =    0  Free Memory = 75189 MB
Rank =    1  Free Memory = 75188 MB
Rank =    2  Free Memory = 75188 MB
Rank =    3  Free Memory = 75186 MB
Rank =    4  Free Memory = 75184 MB
Rank =    5  Free Memory = 75184 MB
Rank =    6  Free Memory = 75183 MB
Rank =    7  Free Memory = 75183 MB
Rank =    8  Free Memory = 75183 MB
Rank =    9  Free Memory = 75183 MB
Rank =   10  Free Memory = 75183 MB
Rank =   11  Free Memory = 75183 MB
Rank =   12  Free Memory = 75183 MB
Rank =   13  Free Memory = 75183 MB
Rank =   14  Free Memory = 75182 MB
Rank =   15  Free Memory = 75173 MB
Rank =   16  Free Memory = 75171 MB
Rank =   17  Free Memory = 75170 MB
Rank =   18  Free Memory = 75170 MB
Rank =   19  Free Memory = 75170 MB
Rank =   20  Free Memory = 75170 MB
Rank =   21  Free Memory = 75170 MB
Rank =   22  Free Memory = 75170 MB
Rank =   23  Free Memory = 75170 MB
Rank =   24  Free Memory = 75170 MB
Rank =   25  Free Memory = 75170 MB
Rank =   26  Free Memory = 75170 MB
Rank =   27  Free Memory = 75170 MB
Rank =   28  Free Memory = 75170 MB
Rank =   29  Free Memory = 75170 MB
Rank =   30  Free Memory = 75170 MB
Rank =   31  Free Memory = 75170 MB
Rank =   32  Free Memory = 67562 MB
Rank =   33  Free Memory = 67562 MB
Rank =   34  Free Memory = 67562 MB
Rank =   35  Free Memory = 67562 MB
Rank =   36  Free Memory = 67562 MB
Rank =   37  Free Memory = 67562 MB
Rank =   38  Free Memory = 67562 MB
Rank =   39  Free Memory = 67562 MB
Rank =   40  Free Memory = 67562 MB
Rank =   41  Free Memory = 67562 MB
Rank =   42  Free Memory = 67561 MB
Rank =   43  Free Memory = 67561 MB
Rank =   44  Free Memory = 67561 MB
Rank =   45  Free Memory = 67561 MB
Rank =   46  Free Memory = 67561 MB
Rank =   47  Free Memory = 67561 MB
Rank =   48  Free Memory = 67561 MB
Rank =   49  Free Memory = 67560 MB
Rank =   50  Free Memory = 67560 MB
Rank =   51  Free Memory = 67560 MB
Rank =   52  Free Memory = 67560 MB
Rank =   53  Free Memory = 67560 MB
Rank =   54  Free Memory = 67560 MB
Rank =   55  Free Memory = 67560 MB
Rank =   56  Free Memory = 67560 MB
Rank =   57  Free Memory = 67560 MB
Rank =   58  Free Memory = 67560 MB
Rank =   59  Free Memory = 67560 MB
Rank =   60  Free Memory = 67560 MB
Rank =   61  Free Memory = 67560 MB
Rank =   62  Free Memory = 67560 MB
Rank =   63  Free Memory = 67560 MB
Rank =   64  Free Memory = 79321 MB
Rank =   65  Free Memory = 79321 MB
Rank =   66  Free Memory = 79321 MB
Rank =   67  Free Memory = 79321 MB
Rank =   68  Free Memory = 79321 MB
Rank =   69  Free Memory = 79321 MB
Rank =   70  Free Memory = 79321 MB
Rank =   71  Free Memory = 79321 MB
Rank =   72  Free Memory = 79321 MB
Rank =   73  Free Memory = 79320 MB
Rank =   74  Free Memory = 79320 MB
Rank =   75  Free Memory = 79320 MB
Rank =   76  Free Memory = 79320 MB
Rank =   77  Free Memory = 79320 MB
Rank =   78  Free Memory = 79320 MB
Rank =   79  Free Memory = 79320 MB
Rank =   80  Free Memory = 79320 MB
Rank =   81  Free Memory = 79320 MB
Rank =   82  Free Memory = 79320 MB
Rank =   83  Free Memory = 79320 MB
Rank =   84  Free Memory = 79320 MB
Rank =   85  Free Memory = 79320 MB
Rank =   86  Free Memory = 79320 MB
Rank =   87  Free Memory = 79319 MB
Rank =   88  Free Memory = 79319 MB
Rank =   89  Free Memory = 79319 MB
Rank =   90  Free Memory = 79319 MB
Rank =   91  Free Memory = 79319 MB
Rank =   92  Free Memory = 79319 MB
Rank =   93  Free Memory = 79319 MB
Rank =   94  Free Memory = 79319 MB
Rank =   95  Free Memory = 79319 MB
Rank =   96  Free Memory = 87781 MB
Rank =   97  Free Memory = 87781 MB
Rank =   98  Free Memory = 87781 MB
Rank =   99  Free Memory = 87781 MB
Rank =  100  Free Memory = 87781 MB
Rank =  101  Free Memory = 87781 MB
Rank =  102  Free Memory = 87781 MB
Rank =  103  Free Memory = 87781 MB
Rank =  104  Free Memory = 87781 MB
Rank =  105  Free Memory = 87781 MB
Rank =  106  Free Memory = 87781 MB
Rank =  107  Free Memory = 87781 MB
Rank =  108  Free Memory = 87781 MB
Rank =  109  Free Memory = 87781 MB
Rank =  110  Free Memory = 87781 MB
Rank =  111  Free Memory = 87781 MB
Rank =  112  Free Memory = 87781 MB
Rank =  113  Free Memory = 87781 MB
Rank =  114  Free Memory = 87781 MB
Rank =  115  Free Memory = 87781 MB
Rank =  116  Free Memory = 87781 MB
Rank =  117  Free Memory = 87781 MB
Rank =  118  Free Memory = 87781 MB
Rank =  119  Free Memory = 87781 MB
Rank =  120  Free Memory = 87781 MB
Rank =  121  Free Memory = 87781 MB
Rank =  122  Free Memory = 87781 MB
Rank =  123  Free Memory = 87781 MB
Rank =  124  Free Memory = 87781 MB
Rank =  125  Free Memory = 87781 MB
Rank =  126  Free Memory = 87781 MB
Rank =  127  Free Memory = 87781 MB
  Input file(s): opt_h2o_1b1_gvptt_run003p.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003p.xml

  Project = H2O
  date    = 2023-04-17 10:05:15 PDT
  host    = n0042.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 75

  Range of prime numbers to use as seeds over processors and threads = 389-1259


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.119027e-01    1         1  ON     0
     uu_1                 1.447644e-01    1         1  ON     1
     uu_2                 4.283048e-02    1         1  ON     2
     uu_3                -2.009056e-02    1         1  ON     3
     uu_4                -6.622479e-02    1         1  ON     4
     uu_5                -1.019625e-01    1         1  ON     5
     uu_6                -1.301786e-01    1         1  ON     6
     uu_7                -1.447708e-01    1         1  ON     7
     uu_8                -1.378457e-01    1         1  ON     8
     uu_9                -1.085017e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.510911e-01    1         1  ON     0
     ud_1                 1.849190e-01    1         1  ON     1
     ud_2                 6.413327e-02    1         1  ON     2
     ud_3                -7.494902e-03    1         1  ON     3
     ud_4                -6.508117e-02    1         1  ON     4
     ud_5                -1.070096e-01    1         1  ON     5
     ud_6                -1.351384e-01    1         1  ON     6
     ud_7                -1.519485e-01    1         1  ON     7
     ud_8                -1.530499e-01    1         1  ON     8
     ud_9                -1.416735e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.565029e-01    1         1  ON     0
     eO_1                -4.349852e-01    1         1  ON     1
     eO_2                -1.830981e-02    1         1  ON     2
     eO_3                 2.998817e-01    1         1  ON     3
     eO_4                 5.267951e-01    1         1  ON     4
     eO_5                 4.897751e-01    1         1  ON     5
     eO_6                 2.601941e-01    1         1  ON     6
     eO_7                -4.207305e-02    1         1  ON     7
     eO_8                -2.288039e-01    1         1  ON     8
     eO_9                -9.350273e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.560540e-01    1         1  ON     0
     eH1_1                -1.520700e-01    1         1  ON     1
     eH1_2                -1.036247e-01    1         1  ON     2
     eH1_3                -4.830958e-02    1         1  ON     3
     eH1_4                 1.441136e-03    1         1  ON     4
     eH1_5                 3.734827e-02    1         1  ON     5
     eH1_6                 9.665943e-02    1         1  ON     6
     eH1_7                 1.560749e-01    1         1  ON     7
     eH1_8                 1.877784e-01    1         1  ON     8
     eH1_9                 8.153203e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.528837e-01    1         1  ON     0
     eH2_1                -1.487448e-01    1         1  ON     1
     eH2_2                -1.003116e-01    1         1  ON     2
     eH2_3                -4.515755e-02    1         1  ON     3
     eH2_4                 4.106201e-03    1         1  ON     4
     eH2_5                 3.958872e-02    1         1  ON     5
     eH2_6                 9.885952e-02    1         1  ON     6
     eH2_7                 1.592561e-01    1         1  ON     7
     eH2_8                 1.921720e-01    1         1  ON     8
     eH2_9                 6.867299e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.166775e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 4.4807e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9293
    reference variance = 0.274628
====================================================
  Execution time = 2.1400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3446e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334449996322
                                         uncertainty =       0.002708664032

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334449996322
                                         uncertainty =       0.002708664032

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408938758
  error estimate for blocks of size 2^( 2) =       0.000421629629
  error estimate for blocks of size 2^( 3) =       0.000434688126
  error estimate for blocks of size 2^( 4) =       0.000447552667
  error estimate for blocks of size 2^( 5) =       0.000458864520
  error estimate for blocks of size 2^( 6) =       0.000469641380
  error estimate for blocks of size 2^( 7) =       0.000476262377

      target function =                  N/A
              le_mean =     -16.906541584631
             les_mean =     286.165610001809
             stat err =       0.000463080236
             autocorr =       1.282318606324
              std dev =       0.578326738256
             le_variance =       0.334461816182


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690654158463e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906541584631       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906541454959       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906542065062       residual = 7.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906541389919       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906541744328       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906542268219       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906542694274       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906542715247       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906542638470       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906542701226       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.479600e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906541584631       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906541535773       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906541732021       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906541603749       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906541745645       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906541804123       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906541917153       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906541878033       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.554650e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906541584631       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906541570643       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906541622837       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906541603329       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906541647285       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906541662250       residual = 5.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906541678201       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906541667389       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 6.603140e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129497 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7029e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.120366e-01                 1 1 ON  0
uu_1  1.447409e-01                 1 1 ON  1
uu_2  4.282774e-02                 1 1 ON  2
uu_3  -2.010224e-02                1 1 ON  3
uu_4  -6.622810e-02                1 1 ON  4
uu_5  -1.020150e-01                1 1 ON  5
uu_6  -1.302717e-01                1 1 ON  6
uu_7  -1.448064e-01                1 1 ON  7
uu_8  -1.378342e-01                1 1 ON  8
uu_9  -1.085562e-01                1 1 ON  9
ud_0  4.510703e-01                 1 1 ON  10
ud_1  1.849759e-01                 1 1 ON  11
ud_2  6.417966e-02                 1 1 ON  12
ud_3  -7.497973e-03                1 1 ON  13
ud_4  -6.505389e-02                1 1 ON  14
ud_5  -1.069939e-01                1 1 ON  15
ud_6  -1.350835e-01                1 1 ON  16
ud_7  -1.519821e-01                1 1 ON  17
ud_8  -1.531442e-01                1 1 ON  18
ud_9  -1.417278e-01                1 1 ON  19
eO_0  -7.564478e-01                1 1 ON  20
eO_1  -4.349815e-01                1 1 ON  21
eO_2  -1.829436e-02                1 1 ON  22
eO_3  2.999342e-01                 1 1 ON  23
eO_4  5.267935e-01                 1 1 ON  24
eO_5  4.898269e-01                 1 1 ON  25
eO_6  2.602841e-01                 1 1 ON  26
eO_7  -4.210685e-02                1 1 ON  27
eO_8  -2.289165e-01                1 1 ON  28
eO_9  -9.361135e-02                1 1 ON  29
eH1_0 -2.563094e-01                1 1 ON  30
eH1_1 -1.521606e-01                1 1 ON  31
eH1_2 -1.036503e-01                1 1 ON  32
eH1_3 -4.831971e-02                1 1 ON  33
eH1_4 1.395125e-03                 1 1 ON  34
eH1_5 3.739361e-02                 1 1 ON  35
eH1_6 9.671246e-02                 1 1 ON  36
eH1_7 1.561189e-01                 1 1 ON  37
eH1_8 1.878537e-01                 1 1 ON  38
eH1_9 8.170352e-02                 1 1 ON  39
eH2_0 -2.529232e-01                1 1 ON  40
eH2_1 -1.487733e-01                1 1 ON  41
eH2_2 -1.003034e-01                1 1 ON  42
eH2_3 -4.527582e-02                1 1 ON  43
eH2_4 4.098819e-03                 1 1 ON  44
eH2_5 3.951121e-02                 1 1 ON  45
eH2_6 9.878992e-02                 1 1 ON  46
eH2_7 1.591970e-01                 1 1 ON  47
eH2_8 1.922825e-01                 1 1 ON  48
eH2_9 6.890467e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9232
    reference variance = 0.228766
====================================================
  Execution time = 2.0358e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5759e-01
  Total weights = 2.0000e+06
  Execution time = 1.9012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357780839924
                                         uncertainty =       0.019344771992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357780839924
                                         uncertainty =       0.019344771992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422887181
  error estimate for blocks of size 2^( 2) =       0.000435350621
  error estimate for blocks of size 2^( 3) =       0.000448242970
  error estimate for blocks of size 2^( 4) =       0.000461036767
  error estimate for blocks of size 2^( 5) =       0.000470834862
  error estimate for blocks of size 2^( 6) =       0.000478740744
  error estimate for blocks of size 2^( 7) =       0.000482562578

      target function =                  N/A
              le_mean =     -16.905949237817
             les_mean =     286.168786588916
             stat err =       0.000473293738
             autocorr =       1.252600195501
              std dev =       0.598052787043
             le_variance =       0.357667136090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357646421165
                                         uncertainty =       0.019294389601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357646421165
                                         uncertainty =       0.019294389601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422807875
  error estimate for blocks of size 2^( 2) =       0.000435275382
  error estimate for blocks of size 2^( 3) =       0.000448170049
  error estimate for blocks of size 2^( 4) =       0.000460964785
  error estimate for blocks of size 2^( 5) =       0.000470767470
  error estimate for blocks of size 2^( 6) =       0.000478677267
  error estimate for blocks of size 2^( 7) =       0.000482506620

      target function =                  N/A
              le_mean =     -16.905949642024
             les_mean =     286.168666118450
             stat err =       0.000473229035
             autocorr =       1.252727557165
              std dev =       0.597940631299
             le_variance =       0.357532998558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357626530317
                                         uncertainty =       0.019299213761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357626530317
                                         uncertainty =       0.019299213761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422796096
  error estimate for blocks of size 2^( 2) =       0.000435264184
  error estimate for blocks of size 2^( 3) =       0.000448159591
  error estimate for blocks of size 2^( 4) =       0.000460955278
  error estimate for blocks of size 2^( 5) =       0.000470758820
  error estimate for blocks of size 2^( 6) =       0.000478668476
  error estimate for blocks of size 2^( 7) =       0.000482496204

      target function =                  N/A
              le_mean =     -16.905949883930
             les_mean =     286.168654376296
             stat err =       0.000473219694
             autocorr =       1.252747905139
              std dev =       0.597923972668
             le_variance =       0.357513077091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357753580298
                                         uncertainty =       0.019337510589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357753580298
                                         uncertainty =       0.019337510589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422871089
  error estimate for blocks of size 2^( 2) =       0.000435335347
  error estimate for blocks of size 2^( 3) =       0.000448228268
  error estimate for blocks of size 2^( 4) =       0.000461022452
  error estimate for blocks of size 2^( 5) =       0.000470821464
  error estimate for blocks of size 2^( 6) =       0.000478727986
  error estimate for blocks of size 2^( 7) =       0.000482550722

      target function =                  N/A
              le_mean =     -16.905949309642
             les_mean =     286.168761797398
             stat err =       0.000473280656
             autocorr =       1.252626282433
              std dev =       0.598030029380
             le_variance =       0.357639916041


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905949237817        initial
     2.5000e-01     2.5000e+00             9.4796e-04       -16.905949642024
     1.0000e+00     1.0000e+01             2.5547e-04       -16.905949883930  <--
     4.0000e+00     4.0000e+01             6.6031e-05       -16.905949309642

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.9927e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.120366e-01 1 1  ON 0
 uu_1                 1.447409e-01 1 1  ON 1
 uu_2                 4.282774e-02 1 1  ON 2
 uu_3                -2.010224e-02 1 1  ON 3
 uu_4                -6.622810e-02 1 1  ON 4
 uu_5                -1.020150e-01 1 1  ON 5
 uu_6                -1.302717e-01 1 1  ON 6
 uu_7                -1.448064e-01 1 1  ON 7
 uu_8                -1.378342e-01 1 1  ON 8
 uu_9                -1.085562e-01 1 1  ON 9
 ud_0                 4.510703e-01 1 1  ON 10
 ud_1                 1.849759e-01 1 1  ON 11
 ud_2                 6.417966e-02 1 1  ON 12
 ud_3                -7.497973e-03 1 1  ON 13
 ud_4                -6.505389e-02 1 1  ON 14
 ud_5                -1.069939e-01 1 1  ON 15
 ud_6                -1.350835e-01 1 1  ON 16
 ud_7                -1.519821e-01 1 1  ON 17
 ud_8                -1.531442e-01 1 1  ON 18
 ud_9                -1.417278e-01 1 1  ON 19
 eO_0                -7.564478e-01 1 1  ON 20
 eO_1                -4.349815e-01 1 1  ON 21
 eO_2                -1.829436e-02 1 1  ON 22
 eO_3                 2.999342e-01 1 1  ON 23
 eO_4                 5.267935e-01 1 1  ON 24
 eO_5                 4.898269e-01 1 1  ON 25
 eO_6                 2.602841e-01 1 1  ON 26
 eO_7                -4.210685e-02 1 1  ON 27
 eO_8                -2.289165e-01 1 1  ON 28
 eO_9                -9.361135e-02 1 1  ON 29
eH1_0                -2.563094e-01 1 1  ON 30
eH1_1                -1.521606e-01 1 1  ON 31
eH1_2                -1.036503e-01 1 1  ON 32
eH1_3                -4.831971e-02 1 1  ON 33
eH1_4                 1.395125e-03 1 1  ON 34
eH1_5                 3.739361e-02 1 1  ON 35
eH1_6                 9.671246e-02 1 1  ON 36
eH1_7                 1.561189e-01 1 1  ON 37
eH1_8                 1.878537e-01 1 1  ON 38
eH1_9                 8.170352e-02 1 1  ON 39
eH2_0                -2.529232e-01 1 1  ON 40
eH2_1                -1.487733e-01 1 1  ON 41
eH2_2                -1.003034e-01 1 1  ON 42
eH2_3                -4.527582e-02 1 1  ON 43
eH2_4                 4.098819e-03 1 1  ON 44
eH2_5                 3.951121e-02 1 1  ON 45
eH2_6                 9.878992e-02 1 1  ON 46
eH2_7                 1.591970e-01 1 1  ON 47
eH2_8                 1.922825e-01 1 1  ON 48
eH2_9                 6.890467e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7050e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9733
    reference variance = 0.195185
====================================================
  Execution time = 2.0552e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3368e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333765100814
                                         uncertainty =       0.003184722164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333765100814
                                         uncertainty =       0.003184722164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408460769
  error estimate for blocks of size 2^( 2) =       0.000421522915
  error estimate for blocks of size 2^( 3) =       0.000435029561
  error estimate for blocks of size 2^( 4) =       0.000447246797
  error estimate for blocks of size 2^( 5) =       0.000459112877
  error estimate for blocks of size 2^( 6) =       0.000466818477
  error estimate for blocks of size 2^( 7) =       0.000473055757

      target function =                  N/A
              le_mean =     -16.906610901548
             les_mean =     286.167172408330
             stat err =       0.000461558477
             autocorr =       1.276887875200
              std dev =       0.577650758523
             le_variance =       0.333680398822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690661090155e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906610901548       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906611525116       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906611523107       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906611964075       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906612833492       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906613762865       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906613554986       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906613194965       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906613138803       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.783927e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906610901548       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906611130500       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906611146648       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906611337889       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906611697324       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906611965910       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906611966443       residual = 2.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906611814510       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.988769e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906610901548       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906610966382       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906610974232       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906611034211       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906611136145       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906611212749       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906611219815       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906611188490       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.037530e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.134103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6132e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.120110e-01 1 1  ON 0
 uu_1                 1.447497e-01 1 1  ON 1
 uu_2                 4.284386e-02 1 1  ON 2
 uu_3                -2.011293e-02 1 1  ON 3
 uu_4                -6.627384e-02 1 1  ON 4
 uu_5                -1.020259e-01 1 1  ON 5
 uu_6                -1.303281e-01 1 1  ON 6
 uu_7                -1.449437e-01 1 1  ON 7
 uu_8                -1.377931e-01 1 1  ON 8
 uu_9                -1.085317e-01 1 1  ON 9
 ud_0                 4.510029e-01 1 1  ON 10
 ud_1                 1.850414e-01 1 1  ON 11
 ud_2                 6.417533e-02 1 1  ON 12
 ud_3                -7.452973e-03 1 1  ON 13
 ud_4                -6.503546e-02 1 1  ON 14
 ud_5                -1.069621e-01 1 1  ON 15
 ud_6                -1.350648e-01 1 1  ON 16
 ud_7                -1.519857e-01 1 1  ON 17
 ud_8                -1.531110e-01 1 1  ON 18
 ud_9                -1.417912e-01 1 1  ON 19
 eO_0                -7.564502e-01 1 1  ON 20
 eO_1                -4.348501e-01 1 1  ON 21
 eO_2                -1.833743e-02 1 1  ON 22
 eO_3                 2.999992e-01 1 1  ON 23
 eO_4                 5.267630e-01 1 1  ON 24
 eO_5                 4.898422e-01 1 1  ON 25
 eO_6                 2.603683e-01 1 1  ON 26
 eO_7                -4.207674e-02 1 1  ON 27
 eO_8                -2.290226e-01 1 1  ON 28
 eO_9                -9.373988e-02 1 1  ON 29
eH1_0                -2.564650e-01 1 1  ON 30
eH1_1                -1.522441e-01 1 1  ON 31
eH1_2                -1.036573e-01 1 1  ON 32
eH1_3                -4.828156e-02 1 1  ON 33
eH1_4                 1.337743e-03 1 1  ON 34
eH1_5                 3.727654e-02 1 1  ON 35
eH1_6                 9.680695e-02 1 1  ON 36
eH1_7                 1.561628e-01 1 1  ON 37
eH1_8                 1.878864e-01 1 1  ON 38
eH1_9                 8.187044e-02 1 1  ON 39
eH2_0                -2.530812e-01 1 1  ON 40
eH2_1                -1.488339e-01 1 1  ON 41
eH2_2                -1.004167e-01 1 1  ON 42
eH2_3                -4.531782e-02 1 1  ON 43
eH2_4                 4.155148e-03 1 1  ON 44
eH2_5                 3.953721e-02 1 1  ON 45
eH2_6                 9.884965e-02 1 1  ON 46
eH2_7                 1.591321e-01 1 1  ON 47
eH2_8                 1.923504e-01 1 1  ON 48
eH2_9                 6.910354e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9032
    reference variance = 0.245837
====================================================
  Execution time = 2.2694e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3366e-01
  Total weights = 2.0000e+06
  Execution time = 1.8954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333820184845
                                         uncertainty =       0.003093677309

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333820184845
                                         uncertainty =       0.003093677309

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408496371
  error estimate for blocks of size 2^( 2) =       0.000421018460
  error estimate for blocks of size 2^( 3) =       0.000433843047
  error estimate for blocks of size 2^( 4) =       0.000445536374
  error estimate for blocks of size 2^( 5) =       0.000456031332
  error estimate for blocks of size 2^( 6) =       0.000462807188
  error estimate for blocks of size 2^( 7) =       0.000467419902

      target function =                  N/A
              le_mean =     -16.906172986270
             les_mean =     286.152423445324
             stat err =       0.000457948699
             autocorr =       1.256774191432
              std dev =       0.577701108278
             le_variance =       0.333738570506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333699051286
                                         uncertainty =       0.003092671775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333699051286
                                         uncertainty =       0.003092671775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408422239
  error estimate for blocks of size 2^( 2) =       0.000420945815
  error estimate for blocks of size 2^( 3) =       0.000433770304
  error estimate for blocks of size 2^( 4) =       0.000445464212
  error estimate for blocks of size 2^( 5) =       0.000455959215
  error estimate for blocks of size 2^( 6) =       0.000462737385
  error estimate for blocks of size 2^( 7) =       0.000467349547

      target function =                  N/A
              le_mean =     -16.906172745940
             les_mean =     286.152294199058
             stat err =       0.000457877590
             autocorr =       1.256840055667
              std dev =       0.577596269281
             le_variance =       0.333617450288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333664418799
                                         uncertainty =       0.003092172067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333664418799
                                         uncertainty =       0.003092172067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408401038
  error estimate for blocks of size 2^( 2) =       0.000420925504
  error estimate for blocks of size 2^( 3) =       0.000433751198
  error estimate for blocks of size 2^( 4) =       0.000445445838
  error estimate for blocks of size 2^( 5) =       0.000455940786
  error estimate for blocks of size 2^( 6) =       0.000462718892
  error estimate for blocks of size 2^( 7) =       0.000467331768

      target function =                  N/A
              le_mean =     -16.906173080167
             les_mean =     286.152270866182
             stat err =       0.000457859321
             autocorr =       1.256870244366
              std dev =       0.577566287447
             le_variance =       0.333582816395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333793481539
                                         uncertainty =       0.003093427072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333793481539
                                         uncertainty =       0.003093427072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408480029
  error estimate for blocks of size 2^( 2) =       0.000421002500
  error estimate for blocks of size 2^( 3) =       0.000433827301
  error estimate for blocks of size 2^( 4) =       0.000445520815
  error estimate for blocks of size 2^( 5) =       0.000456015785
  error estimate for blocks of size 2^( 6) =       0.000462792010
  error estimate for blocks of size 2^( 7) =       0.000467404783

      target function =                  N/A
              le_mean =     -16.906172985902
             les_mean =     286.152396731063
             stat err =       0.000457933348
             autocorr =       1.256790489555
              std dev =       0.577677997384
             le_variance =       0.333711868661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906172986270        initial
     2.5000e-01     2.5000e+00             7.7839e-04       -16.906172745940
     1.0000e+00     1.0000e+01             1.9888e-04       -16.906173080167  <--
     4.0000e+00     4.0000e+01             5.0375e-05       -16.906172985902

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 3.2216e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.120110e-01 1 1  ON 0
 uu_1                 1.447497e-01 1 1  ON 1
 uu_2                 4.284386e-02 1 1  ON 2
 uu_3                -2.011293e-02 1 1  ON 3
 uu_4                -6.627384e-02 1 1  ON 4
 uu_5                -1.020259e-01 1 1  ON 5
 uu_6                -1.303281e-01 1 1  ON 6
 uu_7                -1.449437e-01 1 1  ON 7
 uu_8                -1.377931e-01 1 1  ON 8
 uu_9                -1.085317e-01 1 1  ON 9
 ud_0                 4.510029e-01 1 1  ON 10
 ud_1                 1.850414e-01 1 1  ON 11
 ud_2                 6.417533e-02 1 1  ON 12
 ud_3                -7.452973e-03 1 1  ON 13
 ud_4                -6.503546e-02 1 1  ON 14
 ud_5                -1.069621e-01 1 1  ON 15
 ud_6                -1.350648e-01 1 1  ON 16
 ud_7                -1.519857e-01 1 1  ON 17
 ud_8                -1.531110e-01 1 1  ON 18
 ud_9                -1.417912e-01 1 1  ON 19
 eO_0                -7.564502e-01 1 1  ON 20
 eO_1                -4.348501e-01 1 1  ON 21
 eO_2                -1.833743e-02 1 1  ON 22
 eO_3                 2.999992e-01 1 1  ON 23
 eO_4                 5.267630e-01 1 1  ON 24
 eO_5                 4.898422e-01 1 1  ON 25
 eO_6                 2.603683e-01 1 1  ON 26
 eO_7                -4.207674e-02 1 1  ON 27
 eO_8                -2.290226e-01 1 1  ON 28
 eO_9                -9.373988e-02 1 1  ON 29
eH1_0                -2.564650e-01 1 1  ON 30
eH1_1                -1.522441e-01 1 1  ON 31
eH1_2                -1.036573e-01 1 1  ON 32
eH1_3                -4.828156e-02 1 1  ON 33
eH1_4                 1.337743e-03 1 1  ON 34
eH1_5                 3.727654e-02 1 1  ON 35
eH1_6                 9.680695e-02 1 1  ON 36
eH1_7                 1.561628e-01 1 1  ON 37
eH1_8                 1.878864e-01 1 1  ON 38
eH1_9                 8.187044e-02 1 1  ON 39
eH2_0                -2.530812e-01 1 1  ON 40
eH2_1                -1.488339e-01 1 1  ON 41
eH2_2                -1.004167e-01 1 1  ON 42
eH2_3                -4.531782e-02 1 1  ON 43
eH2_4                 4.155148e-03 1 1  ON 44
eH2_5                 3.953721e-02 1 1  ON 45
eH2_6                 9.884965e-02 1 1  ON 46
eH2_7                 1.591321e-01 1 1  ON 47
eH2_8                 1.923504e-01 1 1  ON 48
eH2_9                 6.910354e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8465e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6932e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9614
    reference variance = 0.337868
====================================================
  Execution time = 2.0416e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4238e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6127e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342389705104
                                         uncertainty =       0.005631962249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342389705104
                                         uncertainty =       0.005631962249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413752661
  error estimate for blocks of size 2^( 2) =       0.000425607318
  error estimate for blocks of size 2^( 3) =       0.000438009345
  error estimate for blocks of size 2^( 4) =       0.000448819056
  error estimate for blocks of size 2^( 5) =       0.000457924308
  error estimate for blocks of size 2^( 6) =       0.000464650595
  error estimate for blocks of size 2^( 7) =       0.000469958427

      target function =                  N/A
              le_mean =     -16.906005070304
             les_mean =     286.155389795185
             stat err =       0.000460338097
             autocorr =       1.237862011945
              std dev =       0.585134624877
             le_variance =       0.342382529230


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600507030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005070304       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005877199       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906008091954       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906008629601       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906009062281       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906009600053       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906008579056       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906009118534       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906009017843       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906008944087       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 6.711083e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005070304       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005377555       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906006078731       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906006422845       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906006500557       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906006632635       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906006241920       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906006306907       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906006351207       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.840928e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906005070304       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906005158674       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906005350118       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906005475529       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906005490445       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906005518010       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906005413968       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906005424849       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 4.818982e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137315 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6036e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.120139e-01 1 1  ON 0
 uu_1                 1.447862e-01 1 1  ON 1
 uu_2                 4.286798e-02 1 1  ON 2
 uu_3                -2.010836e-02 1 1  ON 3
 uu_4                -6.621714e-02 1 1  ON 4
 uu_5                -1.019414e-01 1 1  ON 5
 uu_6                -1.302681e-01 1 1  ON 6
 uu_7                -1.449892e-01 1 1  ON 7
 uu_8                -1.379634e-01 1 1  ON 8
 uu_9                -1.086385e-01 1 1  ON 9
 ud_0                 4.511737e-01 1 1  ON 10
 ud_1                 1.851433e-01 1 1  ON 11
 ud_2                 6.420544e-02 1 1  ON 12
 ud_3                -7.423397e-03 1 1  ON 13
 ud_4                -6.495800e-02 1 1  ON 14
 ud_5                -1.070083e-01 1 1  ON 15
 ud_6                -1.350326e-01 1 1  ON 16
 ud_7                -1.520152e-01 1 1  ON 17
 ud_8                -1.532397e-01 1 1  ON 18
 ud_9                -1.419011e-01 1 1  ON 19
 eO_0                -7.563814e-01 1 1  ON 20
 eO_1                -4.347930e-01 1 1  ON 21
 eO_2                -1.832011e-02 1 1  ON 22
 eO_3                 3.000283e-01 1 1  ON 23
 eO_4                 5.268064e-01 1 1  ON 24
 eO_5                 4.898951e-01 1 1  ON 25
 eO_6                 2.604668e-01 1 1  ON 26
 eO_7                -4.212521e-02 1 1  ON 27
 eO_8                -2.291653e-01 1 1  ON 28
 eO_9                -9.387978e-02 1 1  ON 29
eH1_0                -2.564096e-01 1 1  ON 30
eH1_1                -1.522927e-01 1 1  ON 31
eH1_2                -1.036637e-01 1 1  ON 32
eH1_3                -4.831475e-02 1 1  ON 33
eH1_4                 1.253274e-03 1 1  ON 34
eH1_5                 3.720240e-02 1 1  ON 35
eH1_6                 9.676786e-02 1 1  ON 36
eH1_7                 1.561740e-01 1 1  ON 37
eH1_8                 1.879585e-01 1 1  ON 38
eH1_9                 8.203120e-02 1 1  ON 39
eH2_0                -2.532653e-01 1 1  ON 40
eH2_1                -1.489642e-01 1 1  ON 41
eH2_2                -1.004115e-01 1 1  ON 42
eH2_3                -4.524725e-02 1 1  ON 43
eH2_4                 4.136468e-03 1 1  ON 44
eH2_5                 3.947945e-02 1 1  ON 45
eH2_6                 9.888508e-02 1 1  ON 46
eH2_7                 1.591688e-01 1 1  ON 47
eH2_8                 1.924207e-01 1 1  ON 48
eH2_9                 6.926671e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8775
    reference variance = 0.309192
====================================================
  Execution time = 2.0131e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4456e-01
  Total weights = 2.0000e+06
  Execution time = 1.8996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344564078392
                                         uncertainty =       0.003967645462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344564078392
                                         uncertainty =       0.003967645462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415010619
  error estimate for blocks of size 2^( 2) =       0.000427772740
  error estimate for blocks of size 2^( 3) =       0.000441235178
  error estimate for blocks of size 2^( 4) =       0.000454200684
  error estimate for blocks of size 2^( 5) =       0.000465093954
  error estimate for blocks of size 2^( 6) =       0.000472957336
  error estimate for blocks of size 2^( 7) =       0.000476875864

      target function =                  N/A
              le_mean =     -16.906509475658
             les_mean =     286.174530106449
             stat err =       0.000467281959
             autocorr =       1.267767486287
              std dev =       0.586913646265
             le_variance =       0.344467628172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344739833052
                                         uncertainty =       0.003969742386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344739833052
                                         uncertainty =       0.003969742386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415116485
  error estimate for blocks of size 2^( 2) =       0.000427867477
  error estimate for blocks of size 2^( 3) =       0.000441317331
  error estimate for blocks of size 2^( 4) =       0.000454274169
  error estimate for blocks of size 2^( 5) =       0.000465162966
  error estimate for blocks of size 2^( 6) =       0.000473022988
  error estimate for blocks of size 2^( 7) =       0.000476935765

      target function =                  N/A
              le_mean =     -16.906511386802
             les_mean =     286.174770491962
             stat err =       0.000467348972
             autocorr =       1.267484399483
              std dev =       0.587063363047
             le_variance =       0.344643392232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344741827151
                                         uncertainty =       0.003969611120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344741827151
                                         uncertainty =       0.003969611120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415117694
  error estimate for blocks of size 2^( 2) =       0.000427870458
  error estimate for blocks of size 2^( 3) =       0.000441322875
  error estimate for blocks of size 2^( 4) =       0.000454281697
  error estimate for blocks of size 2^( 5) =       0.000465170376
  error estimate for blocks of size 2^( 6) =       0.000473029999
  error estimate for blocks of size 2^( 7) =       0.000476943281

      target function =                  N/A
              le_mean =     -16.906510838150
             les_mean =     286.174753947592
             stat err =       0.000467356338
             autocorr =       1.267516973430
              std dev =       0.587065072570
             le_variance =       0.344645399432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344590902387
                                         uncertainty =       0.003967940802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344590902387
                                         uncertainty =       0.003967940802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415026780
  error estimate for blocks of size 2^( 2) =       0.000427787521
  error estimate for blocks of size 2^( 3) =       0.000441248515
  error estimate for blocks of size 2^( 4) =       0.000454213136
  error estimate for blocks of size 2^( 5) =       0.000465105726
  error estimate for blocks of size 2^( 6) =       0.000472968473
  error estimate for blocks of size 2^( 7) =       0.000476886137

      target function =                  N/A
              le_mean =     -16.906509602843
             les_mean =     286.174561235105
             stat err =       0.000467293368
             autocorr =       1.267730657261
              std dev =       0.586936501118
             le_variance =       0.344494456345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906509475658        initial
     2.5000e-01     2.5000e+00             6.7111e-04       -16.906511386802  <--
     1.0000e+00     1.0000e+01             1.8409e-04       -16.906510838150
     4.0000e+00     4.0000e+01             4.8190e-05       -16.906509602843

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9693e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.120525e-01 1 1  ON 0
 uu_1                 1.448631e-01 1 1  ON 1
 uu_2                 4.292750e-02 1 1  ON 2
 uu_3                -2.004664e-02 1 1  ON 3
 uu_4                -6.609288e-02 1 1  ON 4
 uu_5                -1.017568e-01 1 1  ON 5
 uu_6                -1.301424e-01 1 1  ON 6
 uu_7                -1.450533e-01 1 1  ON 7
 uu_8                -1.384032e-01 1 1  ON 8
 uu_9                -1.089517e-01 1 1  ON 9
 ud_0                 4.514898e-01 1 1  ON 10
 ud_1                 1.853773e-01 1 1  ON 11
 ud_2                 6.436735e-02 1 1  ON 12
 ud_3                -7.290528e-03 1 1  ON 13
 ud_4                -6.480152e-02 1 1  ON 14
 ud_5                -1.069851e-01 1 1  ON 15
 ud_6                -1.350111e-01 1 1  ON 16
 ud_7                -1.520511e-01 1 1  ON 17
 ud_8                -1.535531e-01 1 1  ON 18
 ud_9                -1.422201e-01 1 1  ON 19
 eO_0                -7.562222e-01 1 1  ON 20
 eO_1                -4.346228e-01 1 1  ON 21
 eO_2                -1.825395e-02 1 1  ON 22
 eO_3                 3.000906e-01 1 1  ON 23
 eO_4                 5.269599e-01 1 1  ON 24
 eO_5                 4.900533e-01 1 1  ON 25
 eO_6                 2.607432e-01 1 1  ON 26
 eO_7                -4.224798e-02 1 1  ON 27
 eO_8                -2.295761e-01 1 1  ON 28
 eO_9                -9.428722e-02 1 1  ON 29
eH1_0                -2.563250e-01 1 1  ON 30
eH1_1                -1.524332e-01 1 1  ON 31
eH1_2                -1.037059e-01 1 1  ON 32
eH1_3                -4.838917e-02 1 1  ON 33
eH1_4                 1.050993e-03 1 1  ON 34
eH1_5                 3.700179e-02 1 1  ON 35
eH1_6                 9.666581e-02 1 1  ON 36
eH1_7                 1.562121e-01 1 1  ON 37
eH1_8                 1.881724e-01 1 1  ON 38
eH1_9                 8.249677e-02 1 1  ON 39
eH2_0                -2.537523e-01 1 1  ON 40
eH2_1                -1.492133e-01 1 1  ON 41
eH2_2                -1.004536e-01 1 1  ON 42
eH2_3                -4.517959e-02 1 1  ON 43
eH2_4                 4.097328e-03 1 1  ON 44
eH2_5                 3.933128e-02 1 1  ON 45
eH2_6                 9.897562e-02 1 1  ON 46
eH2_7                 1.592731e-01 1 1  ON 47
eH2_8                 1.926267e-01 1 1  ON 48
eH2_9                 6.973809e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5839e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8953
    reference variance = 0.23348
====================================================
  Execution time = 2.0711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3538e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335399944159
                                         uncertainty =       0.003223802775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335399944159
                                         uncertainty =       0.003223802775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409501762
  error estimate for blocks of size 2^( 2) =       0.000422323492
  error estimate for blocks of size 2^( 3) =       0.000435706952
  error estimate for blocks of size 2^( 4) =       0.000447608739
  error estimate for blocks of size 2^( 5) =       0.000457612818
  error estimate for blocks of size 2^( 6) =       0.000465081798
  error estimate for blocks of size 2^( 7) =       0.000468779167

      target function =                  N/A
              le_mean =     -16.905891021709
             les_mean =     286.144534456696
             stat err =       0.000459770631
             autocorr =       1.260581419607
              std dev =       0.579122945919
             le_variance =       0.335383386490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589102171e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905891021709       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905894048592       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905893342210       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895365119       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905894341654       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905895052001       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905894805995       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905894281347       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905893675454       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905895701494       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905895925794       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905896592092       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905896215462       residual = 6.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 2.543851e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905891021709       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905892634234       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905892133049       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905893028541       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905892409430       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905892984866       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905892757680       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905892485164       residual = 5.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905892477704       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905892745608       residual = 4.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.702754e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905891021709       residual = 6.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905891583748       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905891378308       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905891651464       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905891488438       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905891680907       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905891664878       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905891613126       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905891574857       residual = 2.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.312454e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142685 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6256e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.120669e-01 1 1  ON 0
 uu_1                 1.449257e-01 1 1  ON 1
 uu_2                 4.288356e-02 1 1  ON 2
 uu_3                -2.004519e-02 1 1  ON 3
 uu_4                -6.603817e-02 1 1  ON 4
 uu_5                -1.016633e-01 1 1  ON 5
 uu_6                -1.302008e-01 1 1  ON 6
 uu_7                -1.451264e-01 1 1  ON 7
 uu_8                -1.386946e-01 1 1  ON 8
 uu_9                -1.093269e-01 1 1  ON 9
 ud_0                 4.514837e-01 1 1  ON 10
 ud_1                 1.856046e-01 1 1  ON 11
 ud_2                 6.467574e-02 1 1  ON 12
 ud_3                -7.093397e-03 1 1  ON 13
 ud_4                -6.465787e-02 1 1  ON 14
 ud_5                -1.069152e-01 1 1  ON 15
 ud_6                -1.350124e-01 1 1  ON 16
 ud_7                -1.523584e-01 1 1  ON 17
 ud_8                -1.538577e-01 1 1  ON 18
 ud_9                -1.421999e-01 1 1  ON 19
 eO_0                -7.560814e-01 1 1  ON 20
 eO_1                -4.343208e-01 1 1  ON 21
 eO_2                -1.799875e-02 1 1  ON 22
 eO_3                 3.000681e-01 1 1  ON 23
 eO_4                 5.268005e-01 1 1  ON 24
 eO_5                 4.901604e-01 1 1  ON 25
 eO_6                 2.613608e-01 1 1  ON 26
 eO_7                -4.238720e-02 1 1  ON 27
 eO_8                -2.301528e-01 1 1  ON 28
 eO_9                -9.473311e-02 1 1  ON 29
eH1_0                -2.570952e-01 1 1  ON 30
eH1_1                -1.526032e-01 1 1  ON 31
eH1_2                -1.036210e-01 1 1  ON 32
eH1_3                -4.852117e-02 1 1  ON 33
eH1_4                 1.040632e-03 1 1  ON 34
eH1_5                 3.706406e-02 1 1  ON 35
eH1_6                 9.662134e-02 1 1  ON 36
eH1_7                 1.561667e-01 1 1  ON 37
eH1_8                 1.884888e-01 1 1  ON 38
eH1_9                 8.307436e-02 1 1  ON 39
eH2_0                -2.538131e-01 1 1  ON 40
eH2_1                -1.495324e-01 1 1  ON 41
eH2_2                -1.005807e-01 1 1  ON 42
eH2_3                -4.550642e-02 1 1  ON 43
eH2_4                 4.083985e-03 1 1  ON 44
eH2_5                 3.918098e-02 1 1  ON 45
eH2_6                 9.915300e-02 1 1  ON 46
eH2_7                 1.591777e-01 1 1  ON 47
eH2_8                 1.929228e-01 1 1  ON 48
eH2_9                 7.037608e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8661
    reference variance = 0.214589
====================================================
  Execution time = 2.0267e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.8134e-01
  Total weights = 2.0000e+06
  Execution time = 1.9013e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381782431260
                                         uncertainty =       0.039011851935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381782431260
                                         uncertainty =       0.039011851935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436850153
  error estimate for blocks of size 2^( 2) =       0.000448998699
  error estimate for blocks of size 2^( 3) =       0.000461239318
  error estimate for blocks of size 2^( 4) =       0.000473436349
  error estimate for blocks of size 2^( 5) =       0.000483200100
  error estimate for blocks of size 2^( 6) =       0.000492608262
  error estimate for blocks of size 2^( 7) =       0.000497166347

      target function =                  N/A
              le_mean =     -16.907088432353
             les_mean =     286.231315180981
             stat err =       0.000486602764
             autocorr =       1.240749644131
              std dev =       0.617799411157
             le_variance =       0.381676112426

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381312807451
                                         uncertainty =       0.038935113925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381312807451
                                         uncertainty =       0.038935113925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436581461
  error estimate for blocks of size 2^( 2) =       0.000448736183
  error estimate for blocks of size 2^( 3) =       0.000460985500
  error estimate for blocks of size 2^( 4) =       0.000473189275
  error estimate for blocks of size 2^( 5) =       0.000482964696
  error estimate for blocks of size 2^( 6) =       0.000492384512
  error estimate for blocks of size 2^( 7) =       0.000496945567

      target function =                  N/A
              le_mean =     -16.907085557983
             les_mean =     286.230748618576
             stat err =       0.000486371013
             autocorr =       1.241094316789
              std dev =       0.617419423256
             le_variance =       0.381206744214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381107732823
                                         uncertainty =       0.038880645157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381107732823
                                         uncertainty =       0.038880645157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436464060
  error estimate for blocks of size 2^( 2) =       0.000448625410
  error estimate for blocks of size 2^( 3) =       0.000460882225
  error estimate for blocks of size 2^( 4) =       0.000473093366
  error estimate for blocks of size 2^( 5) =       0.000482873540
  error estimate for blocks of size 2^( 6) =       0.000492294517
  error estimate for blocks of size 2^( 7) =       0.000496850331

      target function =                  N/A
              le_mean =     -16.907084867300
             les_mean =     286.230520271265
             stat err =       0.000486277938
             autocorr =       1.241286856662
              std dev =       0.617253393420
             le_variance =       0.381001751688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381614748288
                                         uncertainty =       0.038978139251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.381614748288
                                         uncertainty =       0.038978139251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436754229
  error estimate for blocks of size 2^( 2) =       0.000448906170
  error estimate for blocks of size 2^( 3) =       0.000461151027
  error estimate for blocks of size 2^( 4) =       0.000473351661
  error estimate for blocks of size 2^( 5) =       0.000483119066
  error estimate for blocks of size 2^( 6) =       0.000492530268
  error estimate for blocks of size 2^( 7) =       0.000497087026

      target function =                  N/A
              le_mean =     -16.907087348570
             les_mean =     286.231110934955
             stat err =       0.000486522005
             autocorr =       1.240882722453
              std dev =       0.617663754424
             le_variance =       0.381508513530


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907088432353        initial  <--
     6.2500e-02     6.2500e-01             2.5439e-03       -16.907085557983
     2.5000e-01     2.5000e+00             7.7028e-04       -16.907084867300
     1.0000e+00     1.0000e+01             2.3125e-04       -16.907087348570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8342
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.120525e-01 1 1  ON 0
 uu_1                 1.448631e-01 1 1  ON 1
 uu_2                 4.292750e-02 1 1  ON 2
 uu_3                -2.004664e-02 1 1  ON 3
 uu_4                -6.609288e-02 1 1  ON 4
 uu_5                -1.017568e-01 1 1  ON 5
 uu_6                -1.301424e-01 1 1  ON 6
 uu_7                -1.450533e-01 1 1  ON 7
 uu_8                -1.384032e-01 1 1  ON 8
 uu_9                -1.089517e-01 1 1  ON 9
 ud_0                 4.514898e-01 1 1  ON 10
 ud_1                 1.853773e-01 1 1  ON 11
 ud_2                 6.436735e-02 1 1  ON 12
 ud_3                -7.290528e-03 1 1  ON 13
 ud_4                -6.480152e-02 1 1  ON 14
 ud_5                -1.069851e-01 1 1  ON 15
 ud_6                -1.350111e-01 1 1  ON 16
 ud_7                -1.520511e-01 1 1  ON 17
 ud_8                -1.535531e-01 1 1  ON 18
 ud_9                -1.422201e-01 1 1  ON 19
 eO_0                -7.562222e-01 1 1  ON 20
 eO_1                -4.346228e-01 1 1  ON 21
 eO_2                -1.825395e-02 1 1  ON 22
 eO_3                 3.000906e-01 1 1  ON 23
 eO_4                 5.269599e-01 1 1  ON 24
 eO_5                 4.900533e-01 1 1  ON 25
 eO_6                 2.607432e-01 1 1  ON 26
 eO_7                -4.224798e-02 1 1  ON 27
 eO_8                -2.295761e-01 1 1  ON 28
 eO_9                -9.428722e-02 1 1  ON 29
eH1_0                -2.563250e-01 1 1  ON 30
eH1_1                -1.524332e-01 1 1  ON 31
eH1_2                -1.037059e-01 1 1  ON 32
eH1_3                -4.838917e-02 1 1  ON 33
eH1_4                 1.050993e-03 1 1  ON 34
eH1_5                 3.700179e-02 1 1  ON 35
eH1_6                 9.666581e-02 1 1  ON 36
eH1_7                 1.562121e-01 1 1  ON 37
eH1_8                 1.881724e-01 1 1  ON 38
eH1_9                 8.249677e-02 1 1  ON 39
eH2_0                -2.537523e-01 1 1  ON 40
eH2_1                -1.492133e-01 1 1  ON 41
eH2_2                -1.004536e-01 1 1  ON 42
eH2_3                -4.517959e-02 1 1  ON 43
eH2_4                 4.097328e-03 1 1  ON 44
eH2_5                 3.933128e-02 1 1  ON 45
eH2_6                 9.897562e-02 1 1  ON 46
eH2_7                 1.592731e-01 1 1  ON 47
eH2_8                 1.926267e-01 1 1  ON 48
eH2_9                 6.973809e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6099e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8786
    reference variance = 0.3547
====================================================
  Execution time = 2.0558e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4929e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349385648048
                                         uncertainty =       0.010626544240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349385648048
                                         uncertainty =       0.010626544240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417908177
  error estimate for blocks of size 2^( 2) =       0.000430533548
  error estimate for blocks of size 2^( 3) =       0.000443456112
  error estimate for blocks of size 2^( 4) =       0.000454742156
  error estimate for blocks of size 2^( 5) =       0.000466067925
  error estimate for blocks of size 2^( 6) =       0.000474367620
  error estimate for blocks of size 2^( 7) =       0.000483167192

      target function =                  N/A
              le_mean =     -16.906110071597
             les_mean =     286.165852066898
             stat err =       0.000469586223
             autocorr =       1.262609220815
              std dev =       0.591011411564
             le_variance =       0.349294488598


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611007160e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906110071597       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906109821333       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906109546924       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109665371       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906109869593       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906110041622       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906109993797       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906110292941       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.363516e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906110071597       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906109995765       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906109899341       residual = 7.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109897043       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906109974088       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906110029205       residual = 8.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906110015368       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906110059280       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.108836e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906110071597       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906110051578       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906110024828       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906110021850       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906110041299       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906110056142       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906110053879       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906110062440       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.780209e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.145414 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6196e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.120373e-01 1 1  ON 0
 uu_1                 1.448732e-01 1 1  ON 1
 uu_2                 4.293425e-02 1 1  ON 2
 uu_3                -2.004782e-02 1 1  ON 3
 uu_4                -6.608325e-02 1 1  ON 4
 uu_5                -1.017488e-01 1 1  ON 5
 uu_6                -1.301732e-01 1 1  ON 6
 uu_7                -1.451315e-01 1 1  ON 7
 uu_8                -1.384457e-01 1 1  ON 8
 uu_9                -1.089155e-01 1 1  ON 9
 ud_0                 4.514633e-01 1 1  ON 10
 ud_1                 1.853611e-01 1 1  ON 11
 ud_2                 6.435640e-02 1 1  ON 12
 ud_3                -7.295547e-03 1 1  ON 13
 ud_4                -6.481614e-02 1 1  ON 14
 ud_5                -1.069800e-01 1 1  ON 15
 ud_6                -1.350416e-01 1 1  ON 16
 ud_7                -1.520237e-01 1 1  ON 17
 ud_8                -1.535058e-01 1 1  ON 18
 ud_9                -1.421800e-01 1 1  ON 19
 eO_0                -7.562523e-01 1 1  ON 20
 eO_1                -4.345746e-01 1 1  ON 21
 eO_2                -1.824851e-02 1 1  ON 22
 eO_3                 3.000953e-01 1 1  ON 23
 eO_4                 5.269910e-01 1 1  ON 24
 eO_5                 4.900542e-01 1 1  ON 25
 eO_6                 2.607331e-01 1 1  ON 26
 eO_7                -4.224801e-02 1 1  ON 27
 eO_8                -2.295880e-01 1 1  ON 28
 eO_9                -9.431863e-02 1 1  ON 29
eH1_0                -2.563614e-01 1 1  ON 30
eH1_1                -1.524413e-01 1 1  ON 31
eH1_2                -1.037320e-01 1 1  ON 32
eH1_3                -4.838718e-02 1 1  ON 33
eH1_4                 1.031697e-03 1 1  ON 34
eH1_5                 3.695309e-02 1 1  ON 35
eH1_6                 9.667073e-02 1 1  ON 36
eH1_7                 1.562265e-01 1 1  ON 37
eH1_8                 1.882150e-01 1 1  ON 38
eH1_9                 8.256200e-02 1 1  ON 39
eH2_0                -2.538181e-01 1 1  ON 40
eH2_1                -1.492783e-01 1 1  ON 41
eH2_2                -1.004823e-01 1 1  ON 42
eH2_3                -4.522303e-02 1 1  ON 43
eH2_4                 4.096651e-03 1 1  ON 44
eH2_5                 3.934889e-02 1 1  ON 45
eH2_6                 9.898046e-02 1 1  ON 46
eH2_7                 1.592632e-01 1 1  ON 47
eH2_8                 1.926759e-01 1 1  ON 48
eH2_9                 6.984897e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8038
    reference variance = 0.245104
====================================================
  Execution time = 2.0386e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3277e-01
  Total weights = 2.0000e+06
  Execution time = 1.8971e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332776195979
                                         uncertainty =       0.003108461657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332776195979
                                         uncertainty =       0.003108461657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407907508
  error estimate for blocks of size 2^( 2) =       0.000420556665
  error estimate for blocks of size 2^( 3) =       0.000433944656
  error estimate for blocks of size 2^( 4) =       0.000446677705
  error estimate for blocks of size 2^( 5) =       0.000458065686
  error estimate for blocks of size 2^( 6) =       0.000466660332
  error estimate for blocks of size 2^( 7) =       0.000472283155

      target function =                  N/A
              le_mean =     -16.906266119217
             les_mean =     286.154610996935
             stat err =       0.000460921719
             autocorr =       1.276823741416
              std dev =       0.576868329470
             le_variance =       0.332777069545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332747712506
                                         uncertainty =       0.003108802432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332747712506
                                         uncertainty =       0.003108802432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407890004
  error estimate for blocks of size 2^( 2) =       0.000420540115
  error estimate for blocks of size 2^( 3) =       0.000433928951
  error estimate for blocks of size 2^( 4) =       0.000446662012
  error estimate for blocks of size 2^( 5) =       0.000458048311
  error estimate for blocks of size 2^( 6) =       0.000466639534
  error estimate for blocks of size 2^( 7) =       0.000472264426

      target function =                  N/A
              le_mean =     -16.906267449816
             les_mean =     286.154627428815
             stat err =       0.000460903571
             autocorr =       1.276832773661
              std dev =       0.576843575390
             le_variance =       0.332748510469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332753024297
                                         uncertainty =       0.003108631442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332753024297
                                         uncertainty =       0.003108631442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407893275
  error estimate for blocks of size 2^( 2) =       0.000420543024
  error estimate for blocks of size 2^( 3) =       0.000433931662
  error estimate for blocks of size 2^( 4) =       0.000446665054
  error estimate for blocks of size 2^( 5) =       0.000458052141
  error estimate for blocks of size 2^( 6) =       0.000466644836
  error estimate for blocks of size 2^( 7) =       0.000472268911

      target function =                  N/A
              le_mean =     -16.906266953870
             les_mean =     286.154615997487
             stat err =       0.000460907736
             autocorr =       1.276835365874
              std dev =       0.576848202178
             le_variance =       0.332753848356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332772818609
                                         uncertainty =       0.003108481612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332772818609
                                         uncertainty =       0.003108481612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407905434
  error estimate for blocks of size 2^( 2) =       0.000420554670
  error estimate for blocks of size 2^( 3) =       0.000433942751
  error estimate for blocks of size 2^( 4) =       0.000446675859
  error estimate for blocks of size 2^( 5) =       0.000458063726
  error estimate for blocks of size 2^( 6) =       0.000466658115
  error estimate for blocks of size 2^( 7) =       0.000472281108

      target function =                  N/A
              le_mean =     -16.906266227489
             les_mean =     286.154611273791
             stat err =       0.000460919702
             autocorr =       1.276825548610
              std dev =       0.576865396306
             le_variance =       0.332773685455


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906266119217        initial
     6.2500e-01     6.2500e+00             4.3635e-04       -16.906267449816  <--
     2.5000e+00     2.5000e+01             1.1088e-04       -16.906266953870
     1.0000e+01     1.0000e+02             2.7802e-05       -16.906266227489

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9918e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.120174e-01 1 1  ON 0
 uu_1                 1.449026e-01 1 1  ON 1
 uu_2                 4.294891e-02 1 1  ON 2
 uu_3                -2.004595e-02 1 1  ON 3
 uu_4                -6.606480e-02 1 1  ON 4
 uu_5                -1.017411e-01 1 1  ON 5
 uu_6                -1.302576e-01 1 1  ON 6
 uu_7                -1.453562e-01 1 1  ON 7
 uu_8                -1.385780e-01 1 1  ON 8
 uu_9                -1.088129e-01 1 1  ON 9
 ud_0                 4.514030e-01 1 1  ON 10
 ud_1                 1.853209e-01 1 1  ON 11
 ud_2                 6.432057e-02 1 1  ON 12
 ud_3                -7.317074e-03 1 1  ON 13
 ud_4                -6.485572e-02 1 1  ON 14
 ud_5                -1.069808e-01 1 1  ON 15
 ud_6                -1.351076e-01 1 1  ON 16
 ud_7                -1.519610e-01 1 1  ON 17
 ud_8                -1.533763e-01 1 1  ON 18
 ud_9                -1.420620e-01 1 1  ON 19
 eO_0                -7.562971e-01 1 1  ON 20
 eO_1                -4.344820e-01 1 1  ON 21
 eO_2                -1.822142e-02 1 1  ON 22
 eO_3                 3.001080e-01 1 1  ON 23
 eO_4                 5.270801e-01 1 1  ON 24
 eO_5                 4.900607e-01 1 1  ON 25
 eO_6                 2.607016e-01 1 1  ON 26
 eO_7                -4.225201e-02 1 1  ON 27
 eO_8                -2.296241e-01 1 1  ON 28
 eO_9                -9.441069e-02 1 1  ON 29
eH1_0                -2.564584e-01 1 1  ON 30
eH1_1                -1.524805e-01 1 1  ON 31
eH1_2                -1.037944e-01 1 1  ON 32
eH1_3                -4.840095e-02 1 1  ON 33
eH1_4                 9.901848e-04 1 1  ON 34
eH1_5                 3.681219e-02 1 1  ON 35
eH1_6                 9.668035e-02 1 1  ON 36
eH1_7                 1.562667e-01 1 1  ON 37
eH1_8                 1.883396e-01 1 1  ON 38
eH1_9                 8.275387e-02 1 1  ON 39
eH2_0                -2.540091e-01 1 1  ON 40
eH2_1                -1.494509e-01 1 1  ON 41
eH2_2                -1.005807e-01 1 1  ON 42
eH2_3                -4.534165e-02 1 1  ON 43
eH2_4                 4.081481e-03 1 1  ON 44
eH2_5                 3.939451e-02 1 1  ON 45
eH2_6                 9.899829e-02 1 1  ON 46
eH2_7                 1.592355e-01 1 1  ON 47
eH2_8                 1.928194e-01 1 1  ON 48
eH2_9                 7.017444e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6301e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8701
    reference variance = 0.358688
====================================================
  Execution time = 2.0509e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334628811743
                                         uncertainty =       0.003788778664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334628811743
                                         uncertainty =       0.003788778664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408975028
  error estimate for blocks of size 2^( 2) =       0.000421834606
  error estimate for blocks of size 2^( 3) =       0.000435584375
  error estimate for blocks of size 2^( 4) =       0.000447649624
  error estimate for blocks of size 2^( 5) =       0.000457771345
  error estimate for blocks of size 2^( 6) =       0.000466047269
  error estimate for blocks of size 2^( 7) =       0.000474463340

      target function =                  N/A
              le_mean =     -16.906305110297
             les_mean =     286.157673462571
             stat err =       0.000461482894
             autocorr =       1.273261577203
              std dev =       0.578378031533
             le_variance =       0.334521147360


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630511030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906305110297       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906304243590       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906305542178       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906305756950       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906307347183       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906306997125       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906306615265       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906306393722       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906306680051       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906306550714       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906306801322       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.368407e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906305110297       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906304731318       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906305304618       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906305341569       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906305897463       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906305831977       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906305610210       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906305611330       residual = 8.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.305044e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906305110297       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906304993722       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906305161897       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906305162303       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906305307935       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906305331064       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906305274032       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906305264595       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 8.694377e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148704 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6060e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.120772e-01 1 1  ON 0
 uu_1                 1.448306e-01 1 1  ON 1
 uu_2                 4.291902e-02 1 1  ON 2
 uu_3                -2.005068e-02 1 1  ON 3
 uu_4                -6.607837e-02 1 1  ON 4
 uu_5                -1.017452e-01 1 1  ON 5
 uu_6                -1.304306e-01 1 1  ON 6
 uu_7                -1.455209e-01 1 1  ON 7
 uu_8                -1.384817e-01 1 1  ON 8
 uu_9                -1.087234e-01 1 1  ON 9
 ud_0                 4.513854e-01 1 1  ON 10
 ud_1                 1.853423e-01 1 1  ON 11
 ud_2                 6.432843e-02 1 1  ON 12
 ud_3                -7.277825e-03 1 1  ON 13
 ud_4                -6.482202e-02 1 1  ON 14
 ud_5                -1.069357e-01 1 1  ON 15
 ud_6                -1.350740e-01 1 1  ON 16
 ud_7                -1.519891e-01 1 1  ON 17
 ud_8                -1.533542e-01 1 1  ON 18
 ud_9                -1.420907e-01 1 1  ON 19
 eO_0                -7.561263e-01 1 1  ON 20
 eO_1                -4.344582e-01 1 1  ON 21
 eO_2                -1.825470e-02 1 1  ON 22
 eO_3                 3.000108e-01 1 1  ON 23
 eO_4                 5.271130e-01 1 1  ON 24
 eO_5                 4.901953e-01 1 1  ON 25
 eO_6                 2.607885e-01 1 1  ON 26
 eO_7                -4.223561e-02 1 1  ON 27
 eO_8                -2.297466e-01 1 1  ON 28
 eO_9                -9.458301e-02 1 1  ON 29
eH1_0                -2.567889e-01 1 1  ON 30
eH1_1                -1.525756e-01 1 1  ON 31
eH1_2                -1.038499e-01 1 1  ON 32
eH1_3                -4.839180e-02 1 1  ON 33
eH1_4                 9.883336e-04 1 1  ON 34
eH1_5                 3.677602e-02 1 1  ON 35
eH1_6                 9.672281e-02 1 1  ON 36
eH1_7                 1.562195e-01 1 1  ON 37
eH1_8                 1.884975e-01 1 1  ON 38
eH1_9                 8.308191e-02 1 1  ON 39
eH2_0                -2.540203e-01 1 1  ON 40
eH2_1                -1.494705e-01 1 1  ON 41
eH2_2                -1.007109e-01 1 1  ON 42
eH2_3                -4.544314e-02 1 1  ON 43
eH2_4                 3.894991e-03 1 1  ON 44
eH2_5                 3.922243e-02 1 1  ON 45
eH2_6                 9.920973e-02 1 1  ON 46
eH2_7                 1.593031e-01 1 1  ON 47
eH2_8                 1.929092e-01 1 1  ON 48
eH2_9                 7.041257e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9753
    reference variance = 0.223748
====================================================
  Execution time = 2.0149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4761e-01
  Total weights = 2.0000e+06
  Execution time = 1.8963e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347640440976
                                         uncertainty =       0.007094375995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347640440976
                                         uncertainty =       0.007094375995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416917495
  error estimate for blocks of size 2^( 2) =       0.000429940328
  error estimate for blocks of size 2^( 3) =       0.000442700127
  error estimate for blocks of size 2^( 4) =       0.000454275364
  error estimate for blocks of size 2^( 5) =       0.000464515436
  error estimate for blocks of size 2^( 6) =       0.000472148695
  error estimate for blocks of size 2^( 7) =       0.000476266738

      target function =                  N/A
              le_mean =     -16.906456334336
             les_mean =     286.175906006097
             stat err =       0.000466801558
             autocorr =       1.253615505152
              std dev =       0.589610375669
             le_variance =       0.347640395097

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347564390849
                                         uncertainty =       0.007092744586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347564390849
                                         uncertainty =       0.007092744586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416871928
  error estimate for blocks of size 2^( 2) =       0.000429898638
  error estimate for blocks of size 2^( 3) =       0.000442663392
  error estimate for blocks of size 2^( 4) =       0.000454241158
  error estimate for blocks of size 2^( 5) =       0.000464480776
  error estimate for blocks of size 2^( 6) =       0.000472112702
  error estimate for blocks of size 2^( 7) =       0.000476231278

      target function =                  N/A
              le_mean =     -16.906457648194
             les_mean =     286.175874444909
             stat err =       0.000466766479
             autocorr =       1.253701129247
              std dev =       0.589545934185
             le_variance =       0.347564408515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347590607925
                                         uncertainty =       0.007092946872

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347590607925
                                         uncertainty =       0.007092946872

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416887647
  error estimate for blocks of size 2^( 2) =       0.000429913142
  error estimate for blocks of size 2^( 3) =       0.000442676768
  error estimate for blocks of size 2^( 4) =       0.000454253941
  error estimate for blocks of size 2^( 5) =       0.000464494313
  error estimate for blocks of size 2^( 6) =       0.000472126603
  error estimate for blocks of size 2^( 7) =       0.000476245138

      target function =                  N/A
              le_mean =     -16.906456912547
             les_mean =     286.175875783257
             stat err =       0.000466779999
             autocorr =       1.253679207503
              std dev =       0.589568165041
             le_variance =       0.347590621230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347634016916
                                         uncertainty =       0.007094156378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347634016916
                                         uncertainty =       0.007094156378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416913649
  error estimate for blocks of size 2^( 2) =       0.000429936809
  error estimate for blocks of size 2^( 3) =       0.000442697126
  error estimate for blocks of size 2^( 4) =       0.000454272596
  error estimate for blocks of size 2^( 5) =       0.000464512655
  error estimate for blocks of size 2^( 6) =       0.000472145726
  error estimate for blocks of size 2^( 7) =       0.000476263780

      target function =                  N/A
              le_mean =     -16.906456341800
             les_mean =     286.175899844051
             stat err =       0.000466798689
             autocorr =       1.253623227210
              std dev =       0.589604936113
             le_variance =       0.347633980689


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906456334336        initial
     1.5625e-01     1.5625e+00             1.3684e-03       -16.906457648194  <--
     6.2500e-01     6.2500e+00             3.3050e-04       -16.906456912547
     2.5000e+00     2.5000e+01             8.6944e-05       -16.906456341800

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9676e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.120319e-01 1 1  ON 0
 uu_1                 1.447062e-01 1 1  ON 1
 uu_2                 4.285318e-02 1 1  ON 2
 uu_3                -2.007694e-02 1 1  ON 3
 uu_4                -6.611225e-02 1 1  ON 4
 uu_5                -1.018153e-01 1 1  ON 5
 uu_6                -1.307078e-01 1 1  ON 6
 uu_7                -1.459250e-01 1 1  ON 7
 uu_8                -1.383535e-01 1 1  ON 8
 uu_9                -1.085003e-01 1 1  ON 9
 ud_0                 4.514382e-01 1 1  ON 10
 ud_1                 1.854169e-01 1 1  ON 11
 ud_2                 6.440879e-02 1 1  ON 12
 ud_3                -7.166932e-03 1 1  ON 13
 ud_4                -6.471431e-02 1 1  ON 14
 ud_5                -1.068374e-01 1 1  ON 15
 ud_6                -1.350154e-01 1 1  ON 16
 ud_7                -1.520323e-01 1 1  ON 17
 ud_8                -1.533508e-01 1 1  ON 18
 ud_9                -1.422105e-01 1 1  ON 19
 eO_0                -7.558345e-01 1 1  ON 20
 eO_1                -4.343314e-01 1 1  ON 21
 eO_2                -1.825638e-02 1 1  ON 22
 eO_3                 2.999019e-01 1 1  ON 23
 eO_4                 5.272137e-01 1 1  ON 24
 eO_5                 4.905403e-01 1 1  ON 25
 eO_6                 2.611129e-01 1 1  ON 26
 eO_7                -4.219822e-02 1 1  ON 27
 eO_8                -2.301721e-01 1 1  ON 28
 eO_9                -9.514354e-02 1 1  ON 29
eH1_0                -2.575140e-01 1 1  ON 30
eH1_1                -1.528933e-01 1 1  ON 31
eH1_2                -1.040762e-01 1 1  ON 32
eH1_3                -4.852058e-02 1 1  ON 33
eH1_4                 8.963302e-04 1 1  ON 34
eH1_5                 3.668823e-02 1 1  ON 35
eH1_6                 9.680766e-02 1 1  ON 36
eH1_7                 1.560909e-01 1 1  ON 37
eH1_8                 1.889857e-01 1 1  ON 38
eH1_9                 8.412228e-02 1 1  ON 39
eH2_0                -2.541946e-01 1 1  ON 40
eH2_1                -1.496921e-01 1 1  ON 41
eH2_2                -1.010262e-01 1 1  ON 42
eH2_3                -4.572020e-02 1 1  ON 43
eH2_4                 3.482288e-03 1 1  ON 44
eH2_5                 3.881805e-02 1 1  ON 45
eH2_6                 9.970089e-02 1 1  ON 46
eH2_7                 1.595081e-01 1 1  ON 47
eH2_8                 1.932092e-01 1 1  ON 48
eH2_9                 7.117663e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5837e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9816
    reference variance = 0.549945
====================================================
  Execution time = 2.0657e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4489e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344985820533
                                         uncertainty =       0.005068585644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344985820533
                                         uncertainty =       0.005068585644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415262735
  error estimate for blocks of size 2^( 2) =       0.000427729157
  error estimate for blocks of size 2^( 3) =       0.000440179526
  error estimate for blocks of size 2^( 4) =       0.000452247230
  error estimate for blocks of size 2^( 5) =       0.000463009095
  error estimate for blocks of size 2^( 6) =       0.000472211263
  error estimate for blocks of size 2^( 7) =       0.000474895328

      target function =                  N/A
              le_mean =     -16.905968993566
             les_mean =     286.156673716642
             stat err =       0.000465590729
             autocorr =       1.257079454793
              std dev =       0.587270191371
             le_variance =       0.344886277673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596899357e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905968993566       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905970363103       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905968800866       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905969918681       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905971988305       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905976486040       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905975628642       residual = 8.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905975708035       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905979845190       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905979692766       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905979465210       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905977842579       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905977693064       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905978073210       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.365605e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905968993566       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905969903022       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905968972291       residual = 9.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905969861124       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905970716234       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905972475028       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905971917337       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905971640801       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905972527138       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905972576733       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905972416847       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.347274e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905968993566       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905969381600       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905969018674       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905969619864       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905969758356       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905970079617       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905969966662       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905969836816       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905970008084       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.387464e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153580 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6210e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.116929e-01 1 1  ON 0
 uu_1                 1.445419e-01 1 1  ON 1
 uu_2                 4.277643e-02 1 1  ON 2
 uu_3                -2.010163e-02 1 1  ON 3
 uu_4                -6.617811e-02 1 1  ON 4
 uu_5                -1.019526e-01 1 1  ON 5
 uu_6                -1.303126e-01 1 1  ON 6
 uu_7                -1.456801e-01 1 1  ON 7
 uu_8                -1.382994e-01 1 1  ON 8
 uu_9                -1.090360e-01 1 1  ON 9
 ud_0                 4.518754e-01 1 1  ON 10
 ud_1                 1.858419e-01 1 1  ON 11
 ud_2                 6.475212e-02 1 1  ON 12
 ud_3                -7.173644e-03 1 1  ON 13
 ud_4                -6.473988e-02 1 1  ON 14
 ud_5                -1.068119e-01 1 1  ON 15
 ud_6                -1.351648e-01 1 1  ON 16
 ud_7                -1.519825e-01 1 1  ON 17
 ud_8                -1.530325e-01 1 1  ON 18
 ud_9                -1.425684e-01 1 1  ON 19
 eO_0                -7.559122e-01 1 1  ON 20
 eO_1                -4.344911e-01 1 1  ON 21
 eO_2                -1.813042e-02 1 1  ON 22
 eO_3                 3.001515e-01 1 1  ON 23
 eO_4                 5.279593e-01 1 1  ON 24
 eO_5                 4.907609e-01 1 1  ON 25
 eO_6                 2.616598e-01 1 1  ON 26
 eO_7                -4.212313e-02 1 1  ON 27
 eO_8                -2.307147e-01 1 1  ON 28
 eO_9                -9.613577e-02 1 1  ON 29
eH1_0                -2.578750e-01 1 1  ON 30
eH1_1                -1.532892e-01 1 1  ON 31
eH1_2                -1.043504e-01 1 1  ON 32
eH1_3                -4.867381e-02 1 1  ON 33
eH1_4                 8.513467e-04 1 1  ON 34
eH1_5                 3.604589e-02 1 1  ON 35
eH1_6                 9.656048e-02 1 1  ON 36
eH1_7                 1.567724e-01 1 1  ON 37
eH1_8                 1.895139e-01 1 1  ON 38
eH1_9                 8.504357e-02 1 1  ON 39
eH2_0                -2.548404e-01 1 1  ON 40
eH2_1                -1.498693e-01 1 1  ON 41
eH2_2                -1.014596e-01 1 1  ON 42
eH2_3                -4.612421e-02 1 1  ON 43
eH2_4                 3.225404e-03 1 1  ON 44
eH2_5                 3.852088e-02 1 1  ON 45
eH2_6                 9.982956e-02 1 1  ON 46
eH2_7                 1.594680e-01 1 1  ON 47
eH2_8                 1.937017e-01 1 1  ON 48
eH2_9                 7.252391e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9118
    reference variance = 0.369399
====================================================
  Execution time = 2.0327e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3237e-01
  Total weights = 2.0000e+06
  Execution time = 1.8786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332453124072
                                         uncertainty =       0.002342503595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332453124072
                                         uncertainty =       0.002342503595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407661757
  error estimate for blocks of size 2^( 2) =       0.000420230003
  error estimate for blocks of size 2^( 3) =       0.000433245484
  error estimate for blocks of size 2^( 4) =       0.000444902471
  error estimate for blocks of size 2^( 5) =       0.000454683132
  error estimate for blocks of size 2^( 6) =       0.000462539073
  error estimate for blocks of size 2^( 7) =       0.000465859692

      target function =                  N/A
              le_mean =     -16.905924272171
             les_mean =     286.142651546644
             stat err =       0.000456996092
             autocorr =       1.256680942018
              std dev =       0.576520785787
             le_variance =       0.332376216444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332604036672
                                         uncertainty =       0.002344613106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332604036672
                                         uncertainty =       0.002344613106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407754261
  error estimate for blocks of size 2^( 2) =       0.000420317210
  error estimate for blocks of size 2^( 3) =       0.000433321291
  error estimate for blocks of size 2^( 4) =       0.000444964493
  error estimate for blocks of size 2^( 5) =       0.000454728948
  error estimate for blocks of size 2^( 6) =       0.000462568682
  error estimate for blocks of size 2^( 7) =       0.000465875986

      target function =                  N/A
              le_mean =     -16.905924841661
             les_mean =     286.142821660584
             stat err =       0.000457034527
             autocorr =       1.256322115098
              std dev =       0.576651606215
             le_variance =       0.332527074950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332456850778
                                         uncertainty =       0.002343409738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332456850778
                                         uncertainty =       0.002343409738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407664059
  error estimate for blocks of size 2^( 2) =       0.000420231170
  error estimate for blocks of size 2^( 3) =       0.000433241068
  error estimate for blocks of size 2^( 4) =       0.000444891359
  error estimate for blocks of size 2^( 5) =       0.000454663634
  error estimate for blocks of size 2^( 6) =       0.000462509219
  error estimate for blocks of size 2^( 7) =       0.000465820854

      target function =                  N/A
              le_mean =     -16.905924289561
             les_mean =     286.142655888424
             stat err =       0.000456971266
             autocorr =       1.256530218642
              std dev =       0.576524041336
             le_variance =       0.332379970238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332420569214
                                         uncertainty =       0.002342474500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332420569214
                                         uncertainty =       0.002342474500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407641802
  error estimate for blocks of size 2^( 2) =       0.000420210609
  error estimate for blocks of size 2^( 3) =       0.000433225942
  error estimate for blocks of size 2^( 4) =       0.000444882670
  error estimate for blocks of size 2^( 5) =       0.000454662340
  error estimate for blocks of size 2^( 6) =       0.000462517395
  error estimate for blocks of size 2^( 7) =       0.000465837080

      target function =                  N/A
              le_mean =     -16.905923819058
             les_mean =     286.142603686526
             stat err =       0.000456974871
             autocorr =       1.256687263623
              std dev =       0.576492564487
             le_variance =       0.332343676908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905924272171        initial
     3.9062e-02     3.9062e-01             5.3656e-03       -16.905924841661  <--
     1.5625e-01     1.5625e+00             1.3473e-03       -16.905924289561
     6.2500e-01     6.2500e+00             3.3875e-04       -16.905923819058

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 3.3594e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.115234e-01 1 1  ON 0
 uu_1                 1.444171e-01 1 1  ON 1
 uu_2                 4.264111e-02 1 1  ON 2
 uu_3                -2.022647e-02 1 1  ON 3
 uu_4                -6.636031e-02 1 1  ON 4
 uu_5                -1.020937e-01 1 1  ON 5
 uu_6                -1.302552e-01 1 1  ON 6
 uu_7                -1.457358e-01 1 1  ON 7
 uu_8                -1.381263e-01 1 1  ON 8
 uu_9                -1.102911e-01 1 1  ON 9
 ud_0                 4.526821e-01 1 1  ON 10
 ud_1                 1.865834e-01 1 1  ON 11
 ud_2                 6.539667e-02 1 1  ON 12
 ud_3                -6.727618e-03 1 1  ON 13
 ud_4                -6.444365e-02 1 1  ON 14
 ud_5                -1.065796e-01 1 1  ON 15
 ud_6                -1.351432e-01 1 1  ON 16
 ud_7                -1.518322e-01 1 1  ON 17
 ud_8                -1.525142e-01 1 1  ON 18
 ud_9                -1.433187e-01 1 1  ON 19
 eO_0                -7.559742e-01 1 1  ON 20
 eO_1                -4.344246e-01 1 1  ON 21
 eO_2                -1.778668e-02 1 1  ON 22
 eO_3                 3.008453e-01 1 1  ON 23
 eO_4                 5.292695e-01 1 1  ON 24
 eO_5                 4.918120e-01 1 1  ON 25
 eO_6                 2.630921e-01 1 1  ON 26
 eO_7                -4.192608e-02 1 1  ON 27
 eO_8                -2.322479e-01 1 1  ON 28
 eO_9                -9.906234e-02 1 1  ON 29
eH1_0                -2.588380e-01 1 1  ON 30
eH1_1                -1.542438e-01 1 1  ON 31
eH1_2                -1.051908e-01 1 1  ON 32
eH1_3                -4.941723e-02 1 1  ON 33
eH1_4                 1.874581e-04 1 1  ON 34
eH1_5                 3.503487e-02 1 1  ON 35
eH1_6                 9.583928e-02 1 1  ON 36
eH1_7                 1.583342e-01 1 1  ON 37
eH1_8                 1.910555e-01 1 1  ON 38
eH1_9                 8.784280e-02 1 1  ON 39
eH2_0                -2.560836e-01 1 1  ON 40
eH2_1                -1.509440e-01 1 1  ON 41
eH2_2                -1.025879e-01 1 1  ON 42
eH2_3                -4.720292e-02 1 1  ON 43
eH2_4                 2.242089e-03 1 1  ON 44
eH2_5                 3.753472e-02 1 1  ON 45
eH2_6                 9.984120e-02 1 1  ON 46
eH2_7                 1.595246e-01 1 1  ON 47
eH2_8                 1.952287e-01 1 1  ON 48
eH2_9                 7.654224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9878e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6911e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9581
    reference variance = 0.314926
====================================================
  Execution time = 2.0802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3789e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5451e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337947485736
                                         uncertainty =       0.003159959394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337947485736
                                         uncertainty =       0.003159959394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411027391
  error estimate for blocks of size 2^( 2) =       0.000423554733
  error estimate for blocks of size 2^( 3) =       0.000437122215
  error estimate for blocks of size 2^( 4) =       0.000448975118
  error estimate for blocks of size 2^( 5) =       0.000460808066
  error estimate for blocks of size 2^( 6) =       0.000468519806
  error estimate for blocks of size 2^( 7) =       0.000472642455

      target function =                  N/A
              le_mean =     -16.905646117049
             les_mean =     286.138757498568
             stat err =       0.000462736362
             autocorr =       1.267435086928
              std dev =       0.581280511117
             le_variance =       0.337887032605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564611705e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905646117049       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905651263186       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905651999001       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905651776133       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905655515714       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905653734513       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905656424347       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905658199407       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905661245669       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905661741511       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905667044960       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905668840862       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905670855503       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905669281835       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905670914606       residual = 4.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905670624317       residual = 7.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905670988679       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905670679519       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905670903845       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905670998421       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.172860e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905646117049       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905650701469       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905651222401       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905650965045       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905653994067       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905652701625       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905654829922       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905655078852       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905656048524       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905655878317       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905657516291       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905657193594       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905657285477       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905656880936       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.471089e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905646117049       residual = 5.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905649308181       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905649536051       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905649384574       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905651182191       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905650787413       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905650775992       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905651049477       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905651241352       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905651319507       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905651260828       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.357412e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.162514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6360e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.116864e-01 1 1  ON 0
 uu_1                 1.446510e-01 1 1  ON 1
 uu_2                 4.242142e-02 1 1  ON 2
 uu_3                -2.046701e-02 1 1  ON 3
 uu_4                -6.690873e-02 1 1  ON 4
 uu_5                -1.022743e-01 1 1  ON 5
 uu_6                -1.311666e-01 1 1  ON 6
 uu_7                -1.466486e-01 1 1  ON 7
 uu_8                -1.398853e-01 1 1  ON 8
 uu_9                -1.107386e-01 1 1  ON 9
 ud_0                 4.522843e-01 1 1  ON 10
 ud_1                 1.861975e-01 1 1  ON 11
 ud_2                 6.515601e-02 1 1  ON 12
 ud_3                -6.379778e-03 1 1  ON 13
 ud_4                -6.383948e-02 1 1  ON 14
 ud_5                -1.059098e-01 1 1  ON 15
 ud_6                -1.353817e-01 1 1  ON 16
 ud_7                -1.522652e-01 1 1  ON 17
 ud_8                -1.537387e-01 1 1  ON 18
 ud_9                -1.427575e-01 1 1  ON 19
 eO_0                -7.547519e-01 1 1  ON 20
 eO_1                -4.331706e-01 1 1  ON 21
 eO_2                -1.658407e-02 1 1  ON 22
 eO_3                 3.009446e-01 1 1  ON 23
 eO_4                 5.289611e-01 1 1  ON 24
 eO_5                 4.937180e-01 1 1  ON 25
 eO_6                 2.635856e-01 1 1  ON 26
 eO_7                -4.354143e-02 1 1  ON 27
 eO_8                -2.339221e-01 1 1  ON 28
 eO_9                -1.011834e-01 1 1  ON 29
eH1_0                -2.604507e-01 1 1  ON 30
eH1_1                -1.556225e-01 1 1  ON 31
eH1_2                -1.069491e-01 1 1  ON 32
eH1_3                -5.178030e-02 1 1  ON 33
eH1_4                -1.980875e-03 1 1  ON 34
eH1_5                 3.345852e-02 1 1  ON 35
eH1_6                 9.548604e-02 1 1  ON 36
eH1_7                 1.592831e-01 1 1  ON 37
eH1_8                 1.941862e-01 1 1  ON 38
eH1_9                 9.331389e-02 1 1  ON 39
eH2_0                -2.574755e-01 1 1  ON 40
eH2_1                -1.527219e-01 1 1  ON 41
eH2_2                -1.039789e-01 1 1  ON 42
eH2_3                -4.880996e-02 1 1  ON 43
eH2_4                 7.547211e-04 1 1  ON 44
eH2_5                 3.618952e-02 1 1  ON 45
eH2_6                 1.000721e-01 1 1  ON 46
eH2_7                 1.612707e-01 1 1  ON 47
eH2_8                 1.966406e-01 1 1  ON 48
eH2_9                 8.122333e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.922
    reference variance = 0.213952
====================================================
  Execution time = 2.0061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3731e-01
  Total weights = 2.0000e+06
  Execution time = 1.8960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337418143756
                                         uncertainty =       0.003503371891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337418143756
                                         uncertainty =       0.003503371891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410667570
  error estimate for blocks of size 2^( 2) =       0.000423575288
  error estimate for blocks of size 2^( 3) =       0.000436641732
  error estimate for blocks of size 2^( 4) =       0.000448214810
  error estimate for blocks of size 2^( 5) =       0.000460149024
  error estimate for blocks of size 2^( 6) =       0.000468635971
  error estimate for blocks of size 2^( 7) =       0.000474531641

      target function =                  N/A
              le_mean =     -16.905719859489
             les_mean =     286.140659504922
             stat err =       0.000462882862
             autocorr =       1.270461139819
              std dev =       0.580771647064
             le_variance =       0.337295706033

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337500404112
                                         uncertainty =       0.003496627264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337500404112
                                         uncertainty =       0.003496627264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410717631
  error estimate for blocks of size 2^( 2) =       0.000423628699
  error estimate for blocks of size 2^( 3) =       0.000436697161
  error estimate for blocks of size 2^( 4) =       0.000448254222
  error estimate for blocks of size 2^( 5) =       0.000460170989
  error estimate for blocks of size 2^( 6) =       0.000468639282
  error estimate for blocks of size 2^( 7) =       0.000474524110

      target function =                  N/A
              le_mean =     -16.905714736121
             les_mean =     286.140568515144
             stat err =       0.000462897151
             autocorr =       1.270229875110
              std dev =       0.580842443988
             le_variance =       0.337377944737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337466858370
                                         uncertainty =       0.003491005666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337466858370
                                         uncertainty =       0.003491005666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410697234
  error estimate for blocks of size 2^( 2) =       0.000423607464
  error estimate for blocks of size 2^( 3) =       0.000436677079
  error estimate for blocks of size 2^( 4) =       0.000448237355
  error estimate for blocks of size 2^( 5) =       0.000460163937
  error estimate for blocks of size 2^( 6) =       0.000468634843
  error estimate for blocks of size 2^( 7) =       0.000474536991

      target function =                  N/A
              le_mean =     -16.905714624718
             les_mean =     286.140531239941
             stat err =       0.000462893281
             autocorr =       1.270334809249
              std dev =       0.580813598492
             le_variance =       0.337344436194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337467539349
                                         uncertainty =       0.003499502316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337467539349
                                         uncertainty =       0.003499502316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410697631
  error estimate for blocks of size 2^( 2) =       0.000423602331
  error estimate for blocks of size 2^( 3) =       0.000436666127
  error estimate for blocks of size 2^( 4) =       0.000448233560
  error estimate for blocks of size 2^( 5) =       0.000460164883
  error estimate for blocks of size 2^( 6) =       0.000468649692
  error estimate for blocks of size 2^( 7) =       0.000474552063

      target function =                  N/A
              le_mean =     -16.905714740305
             les_mean =     286.140535799389
             stat err =       0.000462900050
             autocorr =       1.270369505591
              std dev =       0.580814159159
             le_variance =       0.337345087479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905719859489        initial  <--
     9.7656e-03     9.7656e-02             2.1729e-02       -16.905714736121
     3.9062e-02     3.9062e-01             5.4711e-03       -16.905714624718
     1.5625e-01     1.5625e+00             1.3574e-03       -16.905714740305

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5038
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.115234e-01 1 1  ON 0
 uu_1                 1.444171e-01 1 1  ON 1
 uu_2                 4.264111e-02 1 1  ON 2
 uu_3                -2.022647e-02 1 1  ON 3
 uu_4                -6.636031e-02 1 1  ON 4
 uu_5                -1.020937e-01 1 1  ON 5
 uu_6                -1.302552e-01 1 1  ON 6
 uu_7                -1.457358e-01 1 1  ON 7
 uu_8                -1.381263e-01 1 1  ON 8
 uu_9                -1.102911e-01 1 1  ON 9
 ud_0                 4.526821e-01 1 1  ON 10
 ud_1                 1.865834e-01 1 1  ON 11
 ud_2                 6.539667e-02 1 1  ON 12
 ud_3                -6.727618e-03 1 1  ON 13
 ud_4                -6.444365e-02 1 1  ON 14
 ud_5                -1.065796e-01 1 1  ON 15
 ud_6                -1.351432e-01 1 1  ON 16
 ud_7                -1.518322e-01 1 1  ON 17
 ud_8                -1.525142e-01 1 1  ON 18
 ud_9                -1.433187e-01 1 1  ON 19
 eO_0                -7.559742e-01 1 1  ON 20
 eO_1                -4.344246e-01 1 1  ON 21
 eO_2                -1.778668e-02 1 1  ON 22
 eO_3                 3.008453e-01 1 1  ON 23
 eO_4                 5.292695e-01 1 1  ON 24
 eO_5                 4.918120e-01 1 1  ON 25
 eO_6                 2.630921e-01 1 1  ON 26
 eO_7                -4.192608e-02 1 1  ON 27
 eO_8                -2.322479e-01 1 1  ON 28
 eO_9                -9.906234e-02 1 1  ON 29
eH1_0                -2.588380e-01 1 1  ON 30
eH1_1                -1.542438e-01 1 1  ON 31
eH1_2                -1.051908e-01 1 1  ON 32
eH1_3                -4.941723e-02 1 1  ON 33
eH1_4                 1.874581e-04 1 1  ON 34
eH1_5                 3.503487e-02 1 1  ON 35
eH1_6                 9.583928e-02 1 1  ON 36
eH1_7                 1.583342e-01 1 1  ON 37
eH1_8                 1.910555e-01 1 1  ON 38
eH1_9                 8.784280e-02 1 1  ON 39
eH2_0                -2.560836e-01 1 1  ON 40
eH2_1                -1.509440e-01 1 1  ON 41
eH2_2                -1.025879e-01 1 1  ON 42
eH2_3                -4.720292e-02 1 1  ON 43
eH2_4                 2.242089e-03 1 1  ON 44
eH2_5                 3.753472e-02 1 1  ON 45
eH2_6                 9.984120e-02 1 1  ON 46
eH2_7                 1.595246e-01 1 1  ON 47
eH2_8                 1.952287e-01 1 1  ON 48
eH2_9                 7.654224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5943e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9593
    reference variance = 0.307857
====================================================
  Execution time = 2.0648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5639e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356469786400
                                         uncertainty =       0.013846528252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356469786400
                                         uncertainty =       0.013846528252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422130374
  error estimate for blocks of size 2^( 2) =       0.000434776698
  error estimate for blocks of size 2^( 3) =       0.000447329300
  error estimate for blocks of size 2^( 4) =       0.000458842164
  error estimate for blocks of size 2^( 5) =       0.000468512887
  error estimate for blocks of size 2^( 6) =       0.000473608763
  error estimate for blocks of size 2^( 7) =       0.000477319287

      target function =                  N/A
              le_mean =     -16.905939891875
             les_mean =     286.167191554784
             stat err =       0.000469570776
             autocorr =       1.237396590670
              std dev =       0.596982499996
             le_variance =       0.356388105302


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593989187e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905939891875       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905942524770       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905943799108       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905943582511       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905943552587       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905945003835       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905943780448       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905943924019       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905944724891       residual = 7.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905945053749       residual = 5.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905944911111       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905945051332       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.743756e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905939891875       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905941162957       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905941945493       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905942000961       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905942050976       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905942070183       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905941942098       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905941803010       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905942047967       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.538853e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905939891875       residual = 7.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905940306053       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905940615678       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905940737131       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905940766403       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905940724659       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905940635736       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905940617144       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905940659922       residual = 1.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.169602e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6217e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.117099e-01 1 1  ON 0
 uu_1                 1.445737e-01 1 1  ON 1
 uu_2                 4.273750e-02 1 1  ON 2
 uu_3                -2.019141e-02 1 1  ON 3
 uu_4                -6.626743e-02 1 1  ON 4
 uu_5                -1.018891e-01 1 1  ON 5
 uu_6                -1.303336e-01 1 1  ON 6
 uu_7                -1.457443e-01 1 1  ON 7
 uu_8                -1.385383e-01 1 1  ON 8
 uu_9                -1.106543e-01 1 1  ON 9
 ud_0                 4.527782e-01 1 1  ON 10
 ud_1                 1.866142e-01 1 1  ON 11
 ud_2                 6.545384e-02 1 1  ON 12
 ud_3                -6.500044e-03 1 1  ON 13
 ud_4                -6.420417e-02 1 1  ON 14
 ud_5                -1.064240e-01 1 1  ON 15
 ud_6                -1.348209e-01 1 1  ON 16
 ud_7                -1.517917e-01 1 1  ON 17
 ud_8                -1.527832e-01 1 1  ON 18
 ud_9                -1.436611e-01 1 1  ON 19
 eO_0                -7.559547e-01 1 1  ON 20
 eO_1                -4.342866e-01 1 1  ON 21
 eO_2                -1.748975e-02 1 1  ON 22
 eO_3                 3.009897e-01 1 1  ON 23
 eO_4                 5.292664e-01 1 1  ON 24
 eO_5                 4.919132e-01 1 1  ON 25
 eO_6                 2.632354e-01 1 1  ON 26
 eO_7                -4.182281e-02 1 1  ON 27
 eO_8                -2.327018e-01 1 1  ON 28
 eO_9                -9.947420e-02 1 1  ON 29
eH1_0                -2.590692e-01 1 1  ON 30
eH1_1                -1.543793e-01 1 1  ON 31
eH1_2                -1.051818e-01 1 1  ON 32
eH1_3                -4.960827e-02 1 1  ON 33
eH1_4                 6.333429e-05 1 1  ON 34
eH1_5                 3.511034e-02 1 1  ON 35
eH1_6                 9.596761e-02 1 1  ON 36
eH1_7                 1.584000e-01 1 1  ON 37
eH1_8                 1.912419e-01 1 1  ON 38
eH1_9                 8.812866e-02 1 1  ON 39
eH2_0                -2.561469e-01 1 1  ON 40
eH2_1                -1.508818e-01 1 1  ON 41
eH2_2                -1.026775e-01 1 1  ON 42
eH2_3                -4.736308e-02 1 1  ON 43
eH2_4                 2.128717e-03 1 1  ON 44
eH2_5                 3.739855e-02 1 1  ON 45
eH2_6                 9.967390e-02 1 1  ON 46
eH2_7                 1.596103e-01 1 1  ON 47
eH2_8                 1.954562e-01 1 1  ON 48
eH2_9                 7.692951e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9058
    reference variance = 0.34396
====================================================
  Execution time = 2.0095e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4398e-01
  Total weights = 2.0000e+06
  Execution time = 1.8708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343919588249
                                         uncertainty =       0.004645338674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343919588249
                                         uncertainty =       0.004645338674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414690279
  error estimate for blocks of size 2^( 2) =       0.000427640827
  error estimate for blocks of size 2^( 3) =       0.000440679348
  error estimate for blocks of size 2^( 4) =       0.000452650053
  error estimate for blocks of size 2^( 5) =       0.000464097220
  error estimate for blocks of size 2^( 6) =       0.000472058843
  error estimate for blocks of size 2^( 7) =       0.000475996184

      target function =                  N/A
              le_mean =     -16.906543896501
             les_mean =     286.175162406530
             stat err =       0.000466200575
             autocorr =       1.263856891008
              std dev =       0.586460616052
             le_variance =       0.343936054180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343950371377
                                         uncertainty =       0.004649530023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343950371377
                                         uncertainty =       0.004649530023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414708748
  error estimate for blocks of size 2^( 2) =       0.000427650435
  error estimate for blocks of size 2^( 3) =       0.000440680755
  error estimate for blocks of size 2^( 4) =       0.000452648905
  error estimate for blocks of size 2^( 5) =       0.000464094192
  error estimate for blocks of size 2^( 6) =       0.000472055339
  error estimate for blocks of size 2^( 7) =       0.000476004804

      target function =                  N/A
              le_mean =     -16.906540943469
             les_mean =     286.175093192496
             stat err =       0.000466200810
             autocorr =       1.263745592796
              std dev =       0.586486735803
             le_variance =       0.343966691272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344014934377
                                         uncertainty =       0.004651299895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344014934377
                                         uncertainty =       0.004651299895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414747629
  error estimate for blocks of size 2^( 2) =       0.000427689803
  error estimate for blocks of size 2^( 3) =       0.000440722100
  error estimate for blocks of size 2^( 4) =       0.000452691855
  error estimate for blocks of size 2^( 5) =       0.000464136170
  error estimate for blocks of size 2^( 6) =       0.000472095753
  error estimate for blocks of size 2^( 7) =       0.000476039916

      target function =                  N/A
              le_mean =     -16.906541657014
             les_mean =     286.175181820178
             stat err =       0.000466240924
             autocorr =       1.263726104237
              std dev =       0.586541722159
             le_variance =       0.344031191834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343942456483
                                         uncertainty =       0.004646619758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343942456483
                                         uncertainty =       0.004646619758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414704042
  error estimate for blocks of size 2^( 2) =       0.000427652971
  error estimate for blocks of size 2^( 3) =       0.000440690315
  error estimate for blocks of size 2^( 4) =       0.000452660702
  error estimate for blocks of size 2^( 5) =       0.000464107079
  error estimate for blocks of size 2^( 6) =       0.000472067899
  error estimate for blocks of size 2^( 7) =       0.000476006119

      target function =                  N/A
              le_mean =     -16.906543387159
             les_mean =     286.175168013996
             stat err =       0.000466210450
             autocorr =       1.263826541252
              std dev =       0.586480079882
             le_variance =       0.343958884098


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906543896501        initial  <--
     9.7656e-02     9.7656e-01             1.7438e-03       -16.906540943469
     3.9062e-01     3.9062e+00             4.5389e-04       -16.906541657014
     1.5625e+00     1.5625e+01             1.1696e-04       -16.906543387159

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5035
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.115234e-01 1 1  ON 0
 uu_1                 1.444171e-01 1 1  ON 1
 uu_2                 4.264111e-02 1 1  ON 2
 uu_3                -2.022647e-02 1 1  ON 3
 uu_4                -6.636031e-02 1 1  ON 4
 uu_5                -1.020937e-01 1 1  ON 5
 uu_6                -1.302552e-01 1 1  ON 6
 uu_7                -1.457358e-01 1 1  ON 7
 uu_8                -1.381263e-01 1 1  ON 8
 uu_9                -1.102911e-01 1 1  ON 9
 ud_0                 4.526821e-01 1 1  ON 10
 ud_1                 1.865834e-01 1 1  ON 11
 ud_2                 6.539667e-02 1 1  ON 12
 ud_3                -6.727618e-03 1 1  ON 13
 ud_4                -6.444365e-02 1 1  ON 14
 ud_5                -1.065796e-01 1 1  ON 15
 ud_6                -1.351432e-01 1 1  ON 16
 ud_7                -1.518322e-01 1 1  ON 17
 ud_8                -1.525142e-01 1 1  ON 18
 ud_9                -1.433187e-01 1 1  ON 19
 eO_0                -7.559742e-01 1 1  ON 20
 eO_1                -4.344246e-01 1 1  ON 21
 eO_2                -1.778668e-02 1 1  ON 22
 eO_3                 3.008453e-01 1 1  ON 23
 eO_4                 5.292695e-01 1 1  ON 24
 eO_5                 4.918120e-01 1 1  ON 25
 eO_6                 2.630921e-01 1 1  ON 26
 eO_7                -4.192608e-02 1 1  ON 27
 eO_8                -2.322479e-01 1 1  ON 28
 eO_9                -9.906234e-02 1 1  ON 29
eH1_0                -2.588380e-01 1 1  ON 30
eH1_1                -1.542438e-01 1 1  ON 31
eH1_2                -1.051908e-01 1 1  ON 32
eH1_3                -4.941723e-02 1 1  ON 33
eH1_4                 1.874581e-04 1 1  ON 34
eH1_5                 3.503487e-02 1 1  ON 35
eH1_6                 9.583928e-02 1 1  ON 36
eH1_7                 1.583342e-01 1 1  ON 37
eH1_8                 1.910555e-01 1 1  ON 38
eH1_9                 8.784280e-02 1 1  ON 39
eH2_0                -2.560836e-01 1 1  ON 40
eH2_1                -1.509440e-01 1 1  ON 41
eH2_2                -1.025879e-01 1 1  ON 42
eH2_3                -4.720292e-02 1 1  ON 43
eH2_4                 2.242089e-03 1 1  ON 44
eH2_5                 3.753472e-02 1 1  ON 45
eH2_6                 9.984120e-02 1 1  ON 46
eH2_7                 1.595246e-01 1 1  ON 47
eH2_8                 1.952287e-01 1 1  ON 48
eH2_9                 7.654224e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.888
    reference variance = 0.473126
====================================================
  Execution time = 2.0574e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5516e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336940257239
                                         uncertainty =       0.003049880234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336940257239
                                         uncertainty =       0.003049880234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410443584
  error estimate for blocks of size 2^( 2) =       0.000423297619
  error estimate for blocks of size 2^( 3) =       0.000435563573
  error estimate for blocks of size 2^( 4) =       0.000448088078
  error estimate for blocks of size 2^( 5) =       0.000458412922
  error estimate for blocks of size 2^( 6) =       0.000466335283
  error estimate for blocks of size 2^( 7) =       0.000470631804

      target function =                  N/A
              le_mean =     -16.905287901095
             les_mean =     286.125686721903
             stat err =       0.000460867022
             autocorr =       1.260794547955
              std dev =       0.580454883226
             le_variance =       0.336927871461


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690528790109e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905287901095       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905288732661       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905289004270       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905288873925       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905288864219       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905288750057       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905288763765       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905288865422       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905288849933       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.252686e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905287901095       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905288142153       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905288240853       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905288210743       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905288216283       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905288186455       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905288172034       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905288190226       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.473142e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905287901095       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905287963863       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905287991427       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905287984312       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905287986914       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905287979959       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905287975046       residual = 3.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905287978856       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.399131e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.169258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6132e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.115494e-01 1 1  ON 0
 uu_1                 1.444487e-01 1 1  ON 1
 uu_2                 4.262874e-02 1 1  ON 2
 uu_3                -2.022337e-02 1 1  ON 3
 uu_4                -6.635219e-02 1 1  ON 4
 uu_5                -1.020994e-01 1 1  ON 5
 uu_6                -1.302735e-01 1 1  ON 6
 uu_7                -1.457434e-01 1 1  ON 7
 uu_8                -1.381608e-01 1 1  ON 8
 uu_9                -1.103095e-01 1 1  ON 9
 ud_0                 4.527177e-01 1 1  ON 10
 ud_1                 1.865720e-01 1 1  ON 11
 ud_2                 6.536743e-02 1 1  ON 12
 ud_3                -6.720596e-03 1 1  ON 13
 ud_4                -6.445372e-02 1 1  ON 14
 ud_5                -1.065890e-01 1 1  ON 15
 ud_6                -1.351137e-01 1 1  ON 16
 ud_7                -1.518489e-01 1 1  ON 17
 ud_8                -1.525454e-01 1 1  ON 18
 ud_9                -1.432878e-01 1 1  ON 19
 eO_0                -7.559853e-01 1 1  ON 20
 eO_1                -4.344301e-01 1 1  ON 21
 eO_2                -1.774834e-02 1 1  ON 22
 eO_3                 3.008624e-01 1 1  ON 23
 eO_4                 5.292662e-01 1 1  ON 24
 eO_5                 4.918269e-01 1 1  ON 25
 eO_6                 2.631006e-01 1 1  ON 26
 eO_7                -4.193577e-02 1 1  ON 27
 eO_8                -2.322686e-01 1 1  ON 28
 eO_9                -9.908688e-02 1 1  ON 29
eH1_0                -2.588475e-01 1 1  ON 30
eH1_1                -1.542289e-01 1 1  ON 31
eH1_2                -1.051855e-01 1 1  ON 32
eH1_3                -4.947133e-02 1 1  ON 33
eH1_4                 1.378874e-04 1 1  ON 34
eH1_5                 3.504555e-02 1 1  ON 35
eH1_6                 9.584589e-02 1 1  ON 36
eH1_7                 1.583407e-01 1 1  ON 37
eH1_8                 1.910828e-01 1 1  ON 38
eH1_9                 8.788282e-02 1 1  ON 39
eH2_0                -2.560785e-01 1 1  ON 40
eH2_1                -1.509444e-01 1 1  ON 41
eH2_2                -1.026367e-01 1 1  ON 42
eH2_3                -4.724340e-02 1 1  ON 43
eH2_4                 2.239152e-03 1 1  ON 44
eH2_5                 3.753574e-02 1 1  ON 45
eH2_6                 9.983523e-02 1 1  ON 46
eH2_7                 1.595315e-01 1 1  ON 47
eH2_8                 1.952523e-01 1 1  ON 48
eH2_9                 7.659697e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9122
    reference variance = 0.297956
====================================================
  Execution time = 2.0146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5197e-01
  Total weights = 2.0000e+06
  Execution time = 1.8695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351994932154
                                         uncertainty =       0.016103518111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351994932154
                                         uncertainty =       0.016103518111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419463624
  error estimate for blocks of size 2^( 2) =       0.000432199716
  error estimate for blocks of size 2^( 3) =       0.000444255465
  error estimate for blocks of size 2^( 4) =       0.000456217646
  error estimate for blocks of size 2^( 5) =       0.000467167199
  error estimate for blocks of size 2^( 6) =       0.000476343285
  error estimate for blocks of size 2^( 7) =       0.000481560376

      target function =                  N/A
              le_mean =     -16.906068073498
             les_mean =     286.167036992781
             stat err =       0.000470322126
             autocorr =       1.257193748391
              std dev =       0.593211145353
             le_variance =       0.351899462971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352208894577
                                         uncertainty =       0.016107308115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352208894577
                                         uncertainty =       0.016107308115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419591102
  error estimate for blocks of size 2^( 2) =       0.000432321344
  error estimate for blocks of size 2^( 3) =       0.000444371071
  error estimate for blocks of size 2^( 4) =       0.000456328789
  error estimate for blocks of size 2^( 5) =       0.000467273587
  error estimate for blocks of size 2^( 6) =       0.000476445974
  error estimate for blocks of size 2^( 7) =       0.000481662975

      target function =                  N/A
              le_mean =     -16.906069907133
             les_mean =     286.167312914062
             stat err =       0.000470427831
             autocorr =       1.256994784735
              std dev =       0.593391426672
             le_variance =       0.352113385248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352138578403
                                         uncertainty =       0.016105728363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352138578403
                                         uncertainty =       0.016105728363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419549213
  error estimate for blocks of size 2^( 2) =       0.000432281188
  error estimate for blocks of size 2^( 3) =       0.000444332714
  error estimate for blocks of size 2^( 4) =       0.000456291906
  error estimate for blocks of size 2^( 5) =       0.000467238642
  error estimate for blocks of size 2^( 6) =       0.000476412704
  error estimate for blocks of size 2^( 7) =       0.000481629933

      target function =                  N/A
              le_mean =     -16.906069124154
             les_mean =     286.167216139411
             stat err =       0.000470393296
             autocorr =       1.257061210356
              std dev =       0.593332187526
             le_variance =       0.352043084754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352014195680
                                         uncertainty =       0.016103805084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352014195680
                                         uncertainty =       0.016103805084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419475103
  error estimate for blocks of size 2^( 2) =       0.000432210634
  error estimate for blocks of size 2^( 3) =       0.000444265810
  error estimate for blocks of size 2^( 4) =       0.000456227588
  error estimate for blocks of size 2^( 5) =       0.000467176773
  error estimate for blocks of size 2^( 6) =       0.000476352601
  error estimate for blocks of size 2^( 7) =       0.000481569722

      target function =                  N/A
              le_mean =     -16.906068203500
             les_mean =     286.167060648757
             stat err =       0.000470331671
             autocorr =       1.257175967514
              std dev =       0.593227379103
             le_variance =       0.351918723318


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906068073498        initial
     9.7656e-01     9.7656e+00             2.2527e-04       -16.906069907133  <--
     3.9062e+00     3.9062e+01             5.4731e-05       -16.906069124154
     1.5625e+01     1.5625e+02             1.3991e-05       -16.906068203500

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.9572e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.116240e-01 1 1  ON 0
 uu_1                 1.445156e-01 1 1  ON 1
 uu_2                 4.261380e-02 1 1  ON 2
 uu_3                -2.022437e-02 1 1  ON 3
 uu_4                -6.633162e-02 1 1  ON 4
 uu_5                -1.021072e-01 1 1  ON 5
 uu_6                -1.303204e-01 1 1  ON 6
 uu_7                -1.457642e-01 1 1  ON 7
 uu_8                -1.382626e-01 1 1  ON 8
 uu_9                -1.103656e-01 1 1  ON 9
 ud_0                 4.527797e-01 1 1  ON 10
 ud_1                 1.865421e-01 1 1  ON 11
 ud_2                 6.531428e-02 1 1  ON 12
 ud_3                -6.714389e-03 1 1  ON 13
 ud_4                -6.447075e-02 1 1  ON 14
 ud_5                -1.066092e-01 1 1  ON 15
 ud_6                -1.350448e-01 1 1  ON 16
 ud_7                -1.518881e-01 1 1  ON 17
 ud_8                -1.526333e-01 1 1  ON 18
 ud_9                -1.431929e-01 1 1  ON 19
 eO_0                -7.560178e-01 1 1  ON 20
 eO_1                -4.344356e-01 1 1  ON 21
 eO_2                -1.765992e-02 1 1  ON 22
 eO_3                 3.009253e-01 1 1  ON 23
 eO_4                 5.292633e-01 1 1  ON 24
 eO_5                 4.918710e-01 1 1  ON 25
 eO_6                 2.631269e-01 1 1  ON 26
 eO_7                -4.196357e-02 1 1  ON 27
 eO_8                -2.323325e-01 1 1  ON 28
 eO_9                -9.916347e-02 1 1  ON 29
eH1_0                -2.588768e-01 1 1  ON 30
eH1_1                -1.542035e-01 1 1  ON 31
eH1_2                -1.051829e-01 1 1  ON 32
eH1_3                -4.960974e-02 1 1  ON 33
eH1_4                -7.397254e-06 1 1  ON 34
eH1_5                 3.507160e-02 1 1  ON 35
eH1_6                 9.586521e-02 1 1  ON 36
eH1_7                 1.583630e-01 1 1  ON 37
eH1_8                 1.911690e-01 1 1  ON 38
eH1_9                 8.800785e-02 1 1  ON 39
eH2_0                -2.560711e-01 1 1  ON 40
eH2_1                -1.509696e-01 1 1  ON 41
eH2_2                -1.027716e-01 1 1  ON 42
eH2_3                -4.735867e-02 1 1  ON 43
eH2_4                 2.226404e-03 1 1  ON 44
eH2_5                 3.754568e-02 1 1  ON 45
eH2_6                 9.981834e-02 1 1  ON 46
eH2_7                 1.595527e-01 1 1  ON 47
eH2_8                 1.953257e-01 1 1  ON 48
eH2_9                 7.676751e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5790e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8853
    reference variance = 0.258937
====================================================
  Execution time = 2.0770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3529e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335360130689
                                         uncertainty =       0.002728553462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335360130689
                                         uncertainty =       0.002728553462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409442556
  error estimate for blocks of size 2^( 2) =       0.000422201534
  error estimate for blocks of size 2^( 3) =       0.000435373020
  error estimate for blocks of size 2^( 4) =       0.000447741147
  error estimate for blocks of size 2^( 5) =       0.000457541339
  error estimate for blocks of size 2^( 6) =       0.000464885518
  error estimate for blocks of size 2^( 7) =       0.000469183635

      target function =                  N/A
              le_mean =     -16.905675133343
             les_mean =     286.137137959268
             stat err =       0.000459837910
             autocorr =       1.261315074307
              std dev =       0.579039215226
             le_variance =       0.335286412770


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567513334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905675133343       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905677030568       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905676899378       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905677304097       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905677392814       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905678199544       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905678475747       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905678062122       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905678192919       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905678208939       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 8.515587e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905675133343       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905675852050       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905675806500       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905675982154       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905676063952       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905676314746       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905676315745       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905676210068       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.081464e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905675133343       residual = 6.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905675339589       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905675329418       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905675381928       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905675404807       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905675458858       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905675476113       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905675448699       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.069518e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6396e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.116850e-01 1 1  ON 0
 uu_1                 1.445135e-01 1 1  ON 1
 uu_2                 4.259536e-02 1 1  ON 2
 uu_3                -2.025589e-02 1 1  ON 3
 uu_4                -6.642814e-02 1 1  ON 4
 uu_5                -1.021059e-01 1 1  ON 5
 uu_6                -1.304581e-01 1 1  ON 6
 uu_7                -1.456943e-01 1 1  ON 7
 uu_8                -1.382363e-01 1 1  ON 8
 uu_9                -1.103746e-01 1 1  ON 9
 ud_0                 4.527370e-01 1 1  ON 10
 ud_1                 1.864743e-01 1 1  ON 11
 ud_2                 6.531623e-02 1 1  ON 12
 ud_3                -6.677198e-03 1 1  ON 13
 ud_4                -6.440865e-02 1 1  ON 14
 ud_5                -1.065193e-01 1 1  ON 15
 ud_6                -1.349599e-01 1 1  ON 16
 ud_7                -1.520209e-01 1 1  ON 17
 ud_8                -1.526512e-01 1 1  ON 18
 ud_9                -1.431685e-01 1 1  ON 19
 eO_0                -7.559938e-01 1 1  ON 20
 eO_1                -4.343491e-01 1 1  ON 21
 eO_2                -1.769959e-02 1 1  ON 22
 eO_3                 3.009292e-01 1 1  ON 23
 eO_4                 5.291950e-01 1 1  ON 24
 eO_5                 4.920587e-01 1 1  ON 25
 eO_6                 2.631298e-01 1 1  ON 26
 eO_7                -4.198596e-02 1 1  ON 27
 eO_8                -2.323684e-01 1 1  ON 28
 eO_9                -9.928173e-02 1 1  ON 29
eH1_0                -2.589354e-01 1 1  ON 30
eH1_1                -1.541303e-01 1 1  ON 31
eH1_2                -1.051823e-01 1 1  ON 32
eH1_3                -4.970276e-02 1 1  ON 33
eH1_4                -1.272708e-04 1 1  ON 34
eH1_5                 3.506024e-02 1 1  ON 35
eH1_6                 9.577672e-02 1 1  ON 36
eH1_7                 1.583162e-01 1 1  ON 37
eH1_8                 1.912530e-01 1 1  ON 38
eH1_9                 8.821309e-02 1 1  ON 39
eH2_0                -2.562385e-01 1 1  ON 40
eH2_1                -1.511778e-01 1 1  ON 41
eH2_2                -1.027133e-01 1 1  ON 42
eH2_3                -4.731425e-02 1 1  ON 43
eH2_4                 2.125858e-03 1 1  ON 44
eH2_5                 3.756477e-02 1 1  ON 45
eH2_6                 9.977670e-02 1 1  ON 46
eH2_7                 1.596539e-01 1 1  ON 47
eH2_8                 1.954387e-01 1 1  ON 48
eH2_9                 7.693393e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9595
    reference variance = 0.388825
====================================================
  Execution time = 2.0185e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3539e-01
  Total weights = 2.0000e+06
  Execution time = 1.8704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335500520265
                                         uncertainty =       0.004085357460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335500520265
                                         uncertainty =       0.004085357460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409523234
  error estimate for blocks of size 2^( 2) =       0.000421820432
  error estimate for blocks of size 2^( 3) =       0.000434992683
  error estimate for blocks of size 2^( 4) =       0.000447270597
  error estimate for blocks of size 2^( 5) =       0.000458867276
  error estimate for blocks of size 2^( 6) =       0.000468089222
  error estimate for blocks of size 2^( 7) =       0.000472460109

      target function =                  N/A
              le_mean =     -16.906398875485
             les_mean =     286.161741328000
             stat err =       0.000461671801
             autocorr =       1.270894805830
              std dev =       0.579153311915
             le_variance =       0.335418558702

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335434594728
                                         uncertainty =       0.004082561185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335434594728
                                         uncertainty =       0.004082561185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409482918
  error estimate for blocks of size 2^( 2) =       0.000421781624
  error estimate for blocks of size 2^( 3) =       0.000434960354
  error estimate for blocks of size 2^( 4) =       0.000447242083
  error estimate for blocks of size 2^( 5) =       0.000458841254
  error estimate for blocks of size 2^( 6) =       0.000468064714
  error estimate for blocks of size 2^( 7) =       0.000472423228

      target function =                  N/A
              le_mean =     -16.906398913132
             les_mean =     286.161676563354
             stat err =       0.000461642820
             autocorr =       1.270985483557
              std dev =       0.579096296898
             le_variance =       0.335352521081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335447452020
                                         uncertainty =       0.004083023065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335447452020
                                         uncertainty =       0.004083023065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409490778
  error estimate for blocks of size 2^( 2) =       0.000421789375
  error estimate for blocks of size 2^( 3) =       0.000434966409
  error estimate for blocks of size 2^( 4) =       0.000447247204
  error estimate for blocks of size 2^( 5) =       0.000458846227
  error estimate for blocks of size 2^( 6) =       0.000468069902
  error estimate for blocks of size 2^( 7) =       0.000472431038

      target function =                  N/A
              le_mean =     -16.906398811401
             les_mean =     286.161685996885
             stat err =       0.000461648593
             autocorr =       1.270968481571
              std dev =       0.579107411831
             le_variance =       0.335365394438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335495736519
                                         uncertainty =       0.004085078949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335495736519
                                         uncertainty =       0.004085078949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409520304
  error estimate for blocks of size 2^( 2) =       0.000421817581
  error estimate for blocks of size 2^( 3) =       0.000434990441
  error estimate for blocks of size 2^( 4) =       0.000447268707
  error estimate for blocks of size 2^( 5) =       0.000458865684
  error estimate for blocks of size 2^( 6) =       0.000468087875
  error estimate for blocks of size 2^( 7) =       0.000472457396

      target function =                  N/A
              le_mean =     -16.906398814768
             les_mean =     286.161734474964
             stat err =       0.000461669915
             autocorr =       1.270902609989
              std dev =       0.579149167901
             le_variance =       0.335413758680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906398875485        initial
     2.4414e-01     2.4414e+00             8.5156e-04       -16.906398913132  <--
     9.7656e-01     9.7656e+00             2.0815e-04       -16.906398811401
     3.9062e+00     3.9062e+01             6.0695e-05       -16.906398814768

*****************************************************************************
Applying the update for shift_i =   2.4414e-01     and shift_s =   2.4414e+00
*****************************************************************************

  Execution time = 2.9591e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.117654e-01 1 1  ON 0
 uu_1                 1.444812e-01 1 1  ON 1
 uu_2                 4.254965e-02 1 1  ON 2
 uu_3                -2.034092e-02 1 1  ON 3
 uu_4                -6.661460e-02 1 1  ON 4
 uu_5                -1.021715e-01 1 1  ON 5
 uu_6                -1.306882e-01 1 1  ON 6
 uu_7                -1.455723e-01 1 1  ON 7
 uu_8                -1.381957e-01 1 1  ON 8
 uu_9                -1.104045e-01 1 1  ON 9
 ud_0                 4.526865e-01 1 1  ON 10
 ud_1                 1.863751e-01 1 1  ON 11
 ud_2                 6.532226e-02 1 1  ON 12
 ud_3                -6.595927e-03 1 1  ON 13
 ud_4                -6.425913e-02 1 1  ON 14
 ud_5                -1.063461e-01 1 1  ON 15
 ud_6                -1.348206e-01 1 1  ON 16
 ud_7                -1.522619e-01 1 1  ON 17
 ud_8                -1.527245e-01 1 1  ON 18
 ud_9                -1.431231e-01 1 1  ON 19
 eO_0                -7.558928e-01 1 1  ON 20
 eO_1                -4.342054e-01 1 1  ON 21
 eO_2                -1.771717e-02 1 1  ON 22
 eO_3                 3.009139e-01 1 1  ON 23
 eO_4                 5.290544e-01 1 1  ON 24
 eO_5                 4.925935e-01 1 1  ON 25
 eO_6                 2.631650e-01 1 1  ON 26
 eO_7                -4.205896e-02 1 1  ON 27
 eO_8                -2.324938e-01 1 1  ON 28
 eO_9                -9.965956e-02 1 1  ON 29
eH1_0                -2.590766e-01 1 1  ON 30
eH1_1                -1.541121e-01 1 1  ON 31
eH1_2                -1.052371e-01 1 1  ON 32
eH1_3                -4.990562e-02 1 1  ON 33
eH1_4                -4.237951e-04 1 1  ON 34
eH1_5                 3.502605e-02 1 1  ON 35
eH1_6                 9.553635e-02 1 1  ON 36
eH1_7                 1.581856e-01 1 1  ON 37
eH1_8                 1.915149e-01 1 1  ON 38
eH1_9                 8.885941e-02 1 1  ON 39
eH2_0                -2.567095e-01 1 1  ON 40
eH2_1                -1.515306e-01 1 1  ON 41
eH2_2                -1.027204e-01 1 1  ON 42
eH2_3                -4.730362e-02 1 1  ON 43
eH2_4                 1.891721e-03 1 1  ON 44
eH2_5                 3.755121e-02 1 1  ON 45
eH2_6                 9.962166e-02 1 1  ON 46
eH2_7                 1.599533e-01 1 1  ON 47
eH2_8                 1.957895e-01 1 1  ON 48
eH2_9                 7.745944e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6042e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9534
    reference variance = 0.31866
====================================================
  Execution time = 2.0595e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4867e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6588e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348679330705
                                         uncertainty =       0.010197205407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348679330705
                                         uncertainty =       0.010197205407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417533619
  error estimate for blocks of size 2^( 2) =       0.000430022456
  error estimate for blocks of size 2^( 3) =       0.000442581224
  error estimate for blocks of size 2^( 4) =       0.000454800156
  error estimate for blocks of size 2^( 5) =       0.000464046071
  error estimate for blocks of size 2^( 6) =       0.000470029579
  error estimate for blocks of size 2^( 7) =       0.000472327006

      target function =                  N/A
              le_mean =     -16.906882239557
             les_mean =     286.191335534203
             stat err =       0.000465300703
             autocorr =       1.241893965931
              std dev =       0.590481706988
             le_variance =       0.348668646288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690688223956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906882239557       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906883902724       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906885281692       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906884605773       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906886060844       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906889388209       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906889471111       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906890416832       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906892192271       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906892936078       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906892371054       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906892279878       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906892136260       residual = 6.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-02 is 3.027168e-03

solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906882239557       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906883143293       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906883774425       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906883497772       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906884229092       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906885045608       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906885169582       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906885282589       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906885690703       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906885689725       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 7.555648e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906882239557       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906882559297       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906882803961       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906882759587       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906883072065       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906883157686       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906883193918       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906883191173       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.870780e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.176427 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6263e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.118434e-01 1 1  ON 0
 uu_1                 1.445869e-01 1 1  ON 1
 uu_2                 4.271833e-02 1 1  ON 2
 uu_3                -2.025098e-02 1 1  ON 3
 uu_4                -6.656164e-02 1 1  ON 4
 uu_5                -1.020174e-01 1 1  ON 5
 uu_6                -1.308463e-01 1 1  ON 6
 uu_7                -1.457144e-01 1 1  ON 7
 uu_8                -1.385615e-01 1 1  ON 8
 uu_9                -1.107953e-01 1 1  ON 9
 ud_0                 4.527316e-01 1 1  ON 10
 ud_1                 1.865100e-01 1 1  ON 11
 ud_2                 6.551430e-02 1 1  ON 12
 ud_3                -6.202428e-03 1 1  ON 13
 ud_4                -6.395407e-02 1 1  ON 14
 ud_5                -1.060672e-01 1 1  ON 15
 ud_6                -1.347540e-01 1 1  ON 16
 ud_7                -1.522243e-01 1 1  ON 17
 ud_8                -1.531677e-01 1 1  ON 18
 ud_9                -1.437437e-01 1 1  ON 19
 eO_0                -7.557383e-01 1 1  ON 20
 eO_1                -4.338653e-01 1 1  ON 21
 eO_2                -1.748547e-02 1 1  ON 22
 eO_3                 3.010839e-01 1 1  ON 23
 eO_4                 5.288627e-01 1 1  ON 24
 eO_5                 4.928643e-01 1 1  ON 25
 eO_6                 2.634175e-01 1 1  ON 26
 eO_7                -4.200088e-02 1 1  ON 27
 eO_8                -2.330339e-01 1 1  ON 28
 eO_9                -1.003019e-01 1 1  ON 29
eH1_0                -2.589142e-01 1 1  ON 30
eH1_1                -1.543698e-01 1 1  ON 31
eH1_2                -1.054107e-01 1 1  ON 32
eH1_3                -5.024847e-02 1 1  ON 33
eH1_4                -9.794002e-04 1 1  ON 34
eH1_5                 3.485319e-02 1 1  ON 35
eH1_6                 9.585350e-02 1 1  ON 36
eH1_7                 1.584255e-01 1 1  ON 37
eH1_8                 1.918687e-01 1 1  ON 38
eH1_9                 8.930464e-02 1 1  ON 39
eH2_0                -2.569543e-01 1 1  ON 40
eH2_1                -1.519049e-01 1 1  ON 41
eH2_2                -1.026742e-01 1 1  ON 42
eH2_3                -4.731664e-02 1 1  ON 43
eH2_4                 1.739743e-03 1 1  ON 44
eH2_5                 3.763993e-02 1 1  ON 45
eH2_6                 9.952530e-02 1 1  ON 46
eH2_7                 1.595732e-01 1 1  ON 47
eH2_8                 1.960846e-01 1 1  ON 48
eH2_9                 7.821501e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8419
    reference variance = 0.355379
====================================================
  Execution time = 2.0494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3090e-01
  Total weights = 2.0000e+06
  Execution time = 1.8607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331163462746
                                         uncertainty =       0.002750116450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331163462746
                                         uncertainty =       0.002750116450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406860578
  error estimate for blocks of size 2^( 2) =       0.000419859404
  error estimate for blocks of size 2^( 3) =       0.000432833240
  error estimate for blocks of size 2^( 4) =       0.000446022710
  error estimate for blocks of size 2^( 5) =       0.000457294156
  error estimate for blocks of size 2^( 6) =       0.000464914313
  error estimate for blocks of size 2^( 7) =       0.000468980828

      target function =                  N/A
              le_mean =     -16.905304178497
             les_mean =     286.120380262148
             stat err =       0.000459303002
             autocorr =       1.274404638906
              std dev =       0.575387747671
             le_variance =       0.331071060170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330894571998
                                         uncertainty =       0.002747282499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330894571998
                                         uncertainty =       0.002747282499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406695553
  error estimate for blocks of size 2^( 2) =       0.000419694305
  error estimate for blocks of size 2^( 3) =       0.000432671372
  error estimate for blocks of size 2^( 4) =       0.000445860955
  error estimate for blocks of size 2^( 5) =       0.000457140077
  error estimate for blocks of size 2^( 6) =       0.000464775473
  error estimate for blocks of size 2^( 7) =       0.000468853798

      target function =                  N/A
              le_mean =     -16.905301897513
             les_mean =     286.120034625843
             stat err =       0.000459157576
             autocorr =       1.274631544992
              std dev =       0.575154366391
             le_variance =       0.330802545179

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330826091059
                                         uncertainty =       0.002746981302

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330826091059
                                         uncertainty =       0.002746981302

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406653498
  error estimate for blocks of size 2^( 2) =       0.000419656641
  error estimate for blocks of size 2^( 3) =       0.000432640149
  error estimate for blocks of size 2^( 4) =       0.000445834883
  error estimate for blocks of size 2^( 5) =       0.000457117835
  error estimate for blocks of size 2^( 6) =       0.000464751923
  error estimate for blocks of size 2^( 7) =       0.000468833061

      target function =                  N/A
              le_mean =     -16.905301952877
             les_mean =     286.119968088062
             stat err =       0.000459134425
             autocorr =       1.274766636044
              std dev =       0.575094892598
             le_variance =       0.330734135493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331080155061
                                         uncertainty =       0.002749364707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331080155061
                                         uncertainty =       0.002749364707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406809441
  error estimate for blocks of size 2^( 2) =       0.000419809694
  error estimate for blocks of size 2^( 3) =       0.000432786014
  error estimate for blocks of size 2^( 4) =       0.000445976858
  error estimate for blocks of size 2^( 5) =       0.000457250724
  error estimate for blocks of size 2^( 6) =       0.000464873596
  error estimate for blocks of size 2^( 7) =       0.000468943576

      target function =                  N/A
              le_mean =     -16.905303398194
             les_mean =     286.120270662267
             stat err =       0.000459261189
             autocorr =       1.274492969446
              std dev =       0.575315428938
             le_variance =       0.330987842774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905304178497        initial  <--
     6.1035e-02     6.1035e-01             3.0272e-03       -16.905301897513
     2.4414e-01     2.4414e+00             7.5556e-04       -16.905301952877
     9.7656e-01     9.7656e+00             1.8708e-04       -16.905303398194

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8653
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.117654e-01 1 1  ON 0
 uu_1                 1.444812e-01 1 1  ON 1
 uu_2                 4.254965e-02 1 1  ON 2
 uu_3                -2.034092e-02 1 1  ON 3
 uu_4                -6.661460e-02 1 1  ON 4
 uu_5                -1.021715e-01 1 1  ON 5
 uu_6                -1.306882e-01 1 1  ON 6
 uu_7                -1.455723e-01 1 1  ON 7
 uu_8                -1.381957e-01 1 1  ON 8
 uu_9                -1.104045e-01 1 1  ON 9
 ud_0                 4.526865e-01 1 1  ON 10
 ud_1                 1.863751e-01 1 1  ON 11
 ud_2                 6.532226e-02 1 1  ON 12
 ud_3                -6.595927e-03 1 1  ON 13
 ud_4                -6.425913e-02 1 1  ON 14
 ud_5                -1.063461e-01 1 1  ON 15
 ud_6                -1.348206e-01 1 1  ON 16
 ud_7                -1.522619e-01 1 1  ON 17
 ud_8                -1.527245e-01 1 1  ON 18
 ud_9                -1.431231e-01 1 1  ON 19
 eO_0                -7.558928e-01 1 1  ON 20
 eO_1                -4.342054e-01 1 1  ON 21
 eO_2                -1.771717e-02 1 1  ON 22
 eO_3                 3.009139e-01 1 1  ON 23
 eO_4                 5.290544e-01 1 1  ON 24
 eO_5                 4.925935e-01 1 1  ON 25
 eO_6                 2.631650e-01 1 1  ON 26
 eO_7                -4.205896e-02 1 1  ON 27
 eO_8                -2.324938e-01 1 1  ON 28
 eO_9                -9.965956e-02 1 1  ON 29
eH1_0                -2.590766e-01 1 1  ON 30
eH1_1                -1.541121e-01 1 1  ON 31
eH1_2                -1.052371e-01 1 1  ON 32
eH1_3                -4.990562e-02 1 1  ON 33
eH1_4                -4.237951e-04 1 1  ON 34
eH1_5                 3.502605e-02 1 1  ON 35
eH1_6                 9.553635e-02 1 1  ON 36
eH1_7                 1.581856e-01 1 1  ON 37
eH1_8                 1.915149e-01 1 1  ON 38
eH1_9                 8.885941e-02 1 1  ON 39
eH2_0                -2.567095e-01 1 1  ON 40
eH2_1                -1.515306e-01 1 1  ON 41
eH2_2                -1.027204e-01 1 1  ON 42
eH2_3                -4.730362e-02 1 1  ON 43
eH2_4                 1.891721e-03 1 1  ON 44
eH2_5                 3.755121e-02 1 1  ON 45
eH2_6                 9.962166e-02 1 1  ON 46
eH2_7                 1.599533e-01 1 1  ON 47
eH2_8                 1.957895e-01 1 1  ON 48
eH2_9                 7.745944e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6223e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.7999
    reference variance = 0.200147
====================================================
  Execution time = 2.2914e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4831e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348204272743
                                         uncertainty =       0.007224892145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348204272743
                                         uncertainty =       0.007224892145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417316784
  error estimate for blocks of size 2^( 2) =       0.000429433565
  error estimate for blocks of size 2^( 3) =       0.000442381082
  error estimate for blocks of size 2^( 4) =       0.000454216740
  error estimate for blocks of size 2^( 5) =       0.000464440183
  error estimate for blocks of size 2^( 6) =       0.000471959393
  error estimate for blocks of size 2^( 7) =       0.000476205228

      target function =                  N/A
              le_mean =     -16.905727279118
             les_mean =     286.151921257495
             stat err =       0.000466705386
             autocorr =       1.250702225282
              std dev =       0.590175055158
             le_variance =       0.348306595731


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690572727912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905727279118       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905725830554       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905725980365       residual = 9.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905726082732       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905726348696       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905726515025       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905726396480       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905726575806       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905726462059       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.326621e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905727279118       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905726806161       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905726799089       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905726785360       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905726867834       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905726869550       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905726907861       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905726931614       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.174135e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905727279118       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905727151084       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905727143097       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905727135518       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905727152649       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905727151976       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905727168830       residual = 7.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.945314e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179124 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8489e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.117897e-01 1 1  ON 0
 uu_1                 1.444634e-01 1 1  ON 1
 uu_2                 4.256573e-02 1 1  ON 2
 uu_3                -2.036513e-02 1 1  ON 3
 uu_4                -6.657051e-02 1 1  ON 4
 uu_5                -1.021832e-01 1 1  ON 5
 uu_6                -1.307321e-01 1 1  ON 6
 uu_7                -1.455828e-01 1 1  ON 7
 uu_8                -1.382438e-01 1 1  ON 8
 uu_9                -1.104139e-01 1 1  ON 9
 ud_0                 4.526713e-01 1 1  ON 10
 ud_1                 1.863873e-01 1 1  ON 11
 ud_2                 6.531407e-02 1 1  ON 12
 ud_3                -6.592333e-03 1 1  ON 13
 ud_4                -6.425456e-02 1 1  ON 14
 ud_5                -1.063810e-01 1 1  ON 15
 ud_6                -1.347765e-01 1 1  ON 16
 ud_7                -1.522598e-01 1 1  ON 17
 ud_8                -1.527578e-01 1 1  ON 18
 ud_9                -1.431067e-01 1 1  ON 19
 eO_0                -7.559194e-01 1 1  ON 20
 eO_1                -4.341806e-01 1 1  ON 21
 eO_2                -1.769175e-02 1 1  ON 22
 eO_3                 3.009084e-01 1 1  ON 23
 eO_4                 5.290546e-01 1 1  ON 24
 eO_5                 4.926170e-01 1 1  ON 25
 eO_6                 2.632156e-01 1 1  ON 26
 eO_7                -4.206965e-02 1 1  ON 27
 eO_8                -2.325268e-01 1 1  ON 28
 eO_9                -9.970165e-02 1 1  ON 29
eH1_0                -2.591068e-01 1 1  ON 30
eH1_1                -1.541531e-01 1 1  ON 31
eH1_2                -1.052748e-01 1 1  ON 32
eH1_3                -4.988591e-02 1 1  ON 33
eH1_4                -4.731902e-04 1 1  ON 34
eH1_5                 3.504358e-02 1 1  ON 35
eH1_6                 9.556610e-02 1 1  ON 36
eH1_7                 1.582187e-01 1 1  ON 37
eH1_8                 1.915288e-01 1 1  ON 38
eH1_9                 8.890746e-02 1 1  ON 39
eH2_0                -2.567359e-01 1 1  ON 40
eH2_1                -1.515267e-01 1 1  ON 41
eH2_2                -1.027361e-01 1 1  ON 42
eH2_3                -4.736844e-02 1 1  ON 43
eH2_4                 1.868898e-03 1 1  ON 44
eH2_5                 3.753080e-02 1 1  ON 45
eH2_6                 9.960744e-02 1 1  ON 46
eH2_7                 1.599733e-01 1 1  ON 47
eH2_8                 1.958369e-01 1 1  ON 48
eH2_9                 7.754118e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9834
    reference variance = 0.485861
====================================================
  Execution time = 2.0036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4607e-01
  Total weights = 2.0000e+06
  Execution time = 1.8745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346114718451
                                         uncertainty =       0.007143250651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346114718451
                                         uncertainty =       0.007143250651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415978623
  error estimate for blocks of size 2^( 2) =       0.000428498688
  error estimate for blocks of size 2^( 3) =       0.000441559986
  error estimate for blocks of size 2^( 4) =       0.000454436135
  error estimate for blocks of size 2^( 5) =       0.000465070471
  error estimate for blocks of size 2^( 6) =       0.000476052266
  error estimate for blocks of size 2^( 7) =       0.000484547672

      target function =                  N/A
              le_mean =     -16.906394240148
             les_mean =     286.172242459117
             stat err =       0.000470026636
             autocorr =       1.276741323253
              std dev =       0.588282609667
             le_variance =       0.346076428837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346115539850
                                         uncertainty =       0.007142789285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346115539850
                                         uncertainty =       0.007142789285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415979170
  error estimate for blocks of size 2^( 2) =       0.000428499523
  error estimate for blocks of size 2^( 3) =       0.000441560118
  error estimate for blocks of size 2^( 4) =       0.000454436056
  error estimate for blocks of size 2^( 5) =       0.000465068804
  error estimate for blocks of size 2^( 6) =       0.000476049973
  error estimate for blocks of size 2^( 7) =       0.000484544979

      target function =                  N/A
              le_mean =     -16.906395025951
             les_mean =     286.172269939817
             stat err =       0.000470024953
             autocorr =       1.276728818794
              std dev =       0.588283383549
             le_variance =       0.346077339359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346102162629
                                         uncertainty =       0.007142965720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346102162629
                                         uncertainty =       0.007142965720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415971114
  error estimate for blocks of size 2^( 2) =       0.000428491681
  error estimate for blocks of size 2^( 3) =       0.000441552906
  error estimate for blocks of size 2^( 4) =       0.000454429319
  error estimate for blocks of size 2^( 5) =       0.000465062952
  error estimate for blocks of size 2^( 6) =       0.000476044185
  error estimate for blocks of size 2^( 7) =       0.000484538863

      target function =                  N/A
              le_mean =     -16.906394845553
             les_mean =     286.172250436558
             stat err =       0.000470018830
             autocorr =       1.276745002014
              std dev =       0.588271991388
             le_variance =       0.346063935852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346111780796
                                         uncertainty =       0.007143220821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346111780796
                                         uncertainty =       0.007143220821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415976863
  error estimate for blocks of size 2^( 2) =       0.000428497015
  error estimate for blocks of size 2^( 3) =       0.000441558326
  error estimate for blocks of size 2^( 4) =       0.000454434547
  error estimate for blocks of size 2^( 5) =       0.000465068812
  error estimate for blocks of size 2^( 6) =       0.000476050483
  error estimate for blocks of size 2^( 7) =       0.000484545761

      target function =                  N/A
              le_mean =     -16.906394328013
             les_mean =     286.172242501617
             stat err =       0.000470024901
             autocorr =       1.276742696869
              std dev =       0.588280120672
             le_variance =       0.346073500378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906394240148        initial
     6.1035e-01     6.1035e+00             3.3266e-04       -16.906395025951  <--
     2.4414e+00     2.4414e+01             8.1741e-05       -16.906394845553
     9.7656e+00     9.7656e+01             1.9453e-05       -16.906394328013

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9441e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.118478e-01 1 1  ON 0
 uu_1                 1.444348e-01 1 1  ON 1
 uu_2                 4.259508e-02 1 1  ON 2
 uu_3                -2.039788e-02 1 1  ON 3
 uu_4                -6.649291e-02 1 1  ON 4
 uu_5                -1.022031e-01 1 1  ON 5
 uu_6                -1.308512e-01 1 1  ON 6
 uu_7                -1.456245e-01 1 1  ON 7
 uu_8                -1.383864e-01 1 1  ON 8
 uu_9                -1.104422e-01 1 1  ON 9
 ud_0                 4.526568e-01 1 1  ON 10
 ud_1                 1.864074e-01 1 1  ON 11
 ud_2                 6.529440e-02 1 1  ON 12
 ud_3                -6.591811e-03 1 1  ON 13
 ud_4                -6.425385e-02 1 1  ON 14
 ud_5                -1.064463e-01 1 1  ON 15
 ud_6                -1.347009e-01 1 1  ON 16
 ud_7                -1.522475e-01 1 1  ON 17
 ud_8                -1.528434e-01 1 1  ON 18
 ud_9                -1.430562e-01 1 1  ON 19
 eO_0                -7.559658e-01 1 1  ON 20
 eO_1                -4.341329e-01 1 1  ON 21
 eO_2                -1.762855e-02 1 1  ON 22
 eO_3                 3.009026e-01 1 1  ON 23
 eO_4                 5.290592e-01 1 1  ON 24
 eO_5                 4.926840e-01 1 1  ON 25
 eO_6                 2.633636e-01 1 1  ON 26
 eO_7                -4.209871e-02 1 1  ON 27
 eO_8                -2.326264e-01 1 1  ON 28
 eO_9                -9.983087e-02 1 1  ON 29
eH1_0                -2.592024e-01 1 1  ON 30
eH1_1                -1.542623e-01 1 1  ON 31
eH1_2                -1.053748e-01 1 1  ON 32
eH1_3                -4.986897e-02 1 1  ON 33
eH1_4                -5.861912e-04 1 1  ON 34
eH1_5                 3.508223e-02 1 1  ON 35
eH1_6                 9.564773e-02 1 1  ON 36
eH1_7                 1.583186e-01 1 1  ON 37
eH1_8                 1.915733e-01 1 1  ON 38
eH1_9                 8.905533e-02 1 1  ON 39
eH2_0                -2.568105e-01 1 1  ON 40
eH2_1                -1.515449e-01 1 1  ON 41
eH2_2                -1.027996e-01 1 1  ON 42
eH2_3                -4.752764e-02 1 1  ON 43
eH2_4                 1.787075e-03 1 1  ON 44
eH2_5                 3.747506e-02 1 1  ON 45
eH2_6                 9.956861e-02 1 1  ON 46
eH2_7                 1.600343e-01 1 1  ON 47
eH2_8                 1.959823e-01 1 1  ON 48
eH2_9                 7.779210e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7945e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8756
    reference variance = 0.366526
====================================================
  Execution time = 2.0605e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7654e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376687512610
                                         uncertainty =       0.027411087364

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.376687512610
                                         uncertainty =       0.027411087364

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433902396
  error estimate for blocks of size 2^( 2) =       0.000445973824
  error estimate for blocks of size 2^( 3) =       0.000458452222
  error estimate for blocks of size 2^( 4) =       0.000470365650
  error estimate for blocks of size 2^( 5) =       0.000481724435
  error estimate for blocks of size 2^( 6) =       0.000490581697
  error estimate for blocks of size 2^( 7) =       0.000498122504

      target function =                  N/A
              le_mean =     -16.905809655724
             les_mean =     286.182942505263
             stat err =       0.000485198571
             autocorr =       1.250417177208
              std dev =       0.613630652717
             le_variance =       0.376542577954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580965572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905809655724       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809275385       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905806461547       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905806851320       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905808443700       residual = 4.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905809860201       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905810124147       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905810562377       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905809927912       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905810375412       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905810217657       residual = 4.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 1.429955e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905809655724       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809487068       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905808136690       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905808155522       residual = 7.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905808835777       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905809110098       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905809388371       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905809195792       residual = 9.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 3.503702e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905809655724       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905809603448       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905809153362       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905809141561       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905809354987       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905809398626       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905809458677       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905809440736       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 8.800348e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182344 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6182e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.118064e-01 1 1  ON 0
 uu_1                 1.444054e-01 1 1  ON 1
 uu_2                 4.261357e-02 1 1  ON 2
 uu_3                -2.037436e-02 1 1  ON 3
 uu_4                -6.651616e-02 1 1  ON 4
 uu_5                -1.023224e-01 1 1  ON 5
 uu_6                -1.308595e-01 1 1  ON 6
 uu_7                -1.457604e-01 1 1  ON 7
 uu_8                -1.385461e-01 1 1  ON 8
 uu_9                -1.103832e-01 1 1  ON 9
 ud_0                 4.526387e-01 1 1  ON 10
 ud_1                 1.863709e-01 1 1  ON 11
 ud_2                 6.534770e-02 1 1  ON 12
 ud_3                -6.646376e-03 1 1  ON 13
 ud_4                -6.412969e-02 1 1  ON 14
 ud_5                -1.065230e-01 1 1  ON 15
 ud_6                -1.347300e-01 1 1  ON 16
 ud_7                -1.522200e-01 1 1  ON 17
 ud_8                -1.528509e-01 1 1  ON 18
 ud_9                -1.429712e-01 1 1  ON 19
 eO_0                -7.558158e-01 1 1  ON 20
 eO_1                -4.341889e-01 1 1  ON 21
 eO_2                -1.760374e-02 1 1  ON 22
 eO_3                 3.007529e-01 1 1  ON 23
 eO_4                 5.292902e-01 1 1  ON 24
 eO_5                 4.927964e-01 1 1  ON 25
 eO_6                 2.633962e-01 1 1  ON 26
 eO_7                -4.207686e-02 1 1  ON 27
 eO_8                -2.327790e-01 1 1  ON 28
 eO_9                -1.000145e-01 1 1  ON 29
eH1_0                -2.592449e-01 1 1  ON 30
eH1_1                -1.543850e-01 1 1  ON 31
eH1_2                -1.055552e-01 1 1  ON 32
eH1_3                -5.004298e-02 1 1  ON 33
eH1_4                -7.075186e-04 1 1  ON 34
eH1_5                 3.507386e-02 1 1  ON 35
eH1_6                 9.579127e-02 1 1  ON 36
eH1_7                 1.583024e-01 1 1  ON 37
eH1_8                 1.917294e-01 1 1  ON 38
eH1_9                 8.935899e-02 1 1  ON 39
eH2_0                -2.568189e-01 1 1  ON 40
eH2_1                -1.514560e-01 1 1  ON 41
eH2_2                -1.029225e-01 1 1  ON 42
eH2_3                -4.768188e-02 1 1  ON 43
eH2_4                 1.780492e-03 1 1  ON 44
eH2_5                 3.730444e-02 1 1  ON 45
eH2_6                 9.944127e-02 1 1  ON 46
eH2_7                 1.600165e-01 1 1  ON 47
eH2_8                 1.961255e-01 1 1  ON 48
eH2_9                 7.814247e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9666
    reference variance = 0.561751
====================================================
  Execution time = 1.9982e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4122e-01
  Total weights = 2.0000e+06
  Execution time = 1.8630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341280304221
                                         uncertainty =       0.007060133681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341280304221
                                         uncertainty =       0.007060133681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413076704
  error estimate for blocks of size 2^( 2) =       0.000425903997
  error estimate for blocks of size 2^( 3) =       0.000439182122
  error estimate for blocks of size 2^( 4) =       0.000450768438
  error estimate for blocks of size 2^( 5) =       0.000461157580
  error estimate for blocks of size 2^( 6) =       0.000468388912
  error estimate for blocks of size 2^( 7) =       0.000472347334

      target function =                  N/A
              le_mean =     -16.905556531280
             les_mean =     286.139106187710
             stat err =       0.000463165566
             autocorr =       1.257219541651
              std dev =       0.584178676465
             le_variance =       0.341264726037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341204289205
                                         uncertainty =       0.007055972047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341204289205
                                         uncertainty =       0.007055972047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413030722
  error estimate for blocks of size 2^( 2) =       0.000425864024
  error estimate for blocks of size 2^( 3) =       0.000439144309
  error estimate for blocks of size 2^( 4) =       0.000450727338
  error estimate for blocks of size 2^( 5) =       0.000461107084
  error estimate for blocks of size 2^( 6) =       0.000468340964
  error estimate for blocks of size 2^( 7) =       0.000472305566

      target function =                  N/A
              le_mean =     -16.905555756696
             les_mean =     286.139004026928
             stat err =       0.000463120238
             autocorr =       1.257253364206
              std dev =       0.584113648857
             le_variance =       0.341188754781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341194416446
                                         uncertainty =       0.007055784260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341194416446
                                         uncertainty =       0.007055784260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413024744
  error estimate for blocks of size 2^( 2) =       0.000425857905
  error estimate for blocks of size 2^( 3) =       0.000439139166
  error estimate for blocks of size 2^( 4) =       0.000450724179
  error estimate for blocks of size 2^( 5) =       0.000461105454
  error estimate for blocks of size 2^( 6) =       0.000468341218
  error estimate for blocks of size 2^( 7) =       0.000472306903

      target function =                  N/A
              le_mean =     -16.905555050167
             les_mean =     286.138970261876
             stat err =       0.000463119439
             autocorr =       1.257285419405
              std dev =       0.584105194508
             le_variance =       0.341178878251

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341267942615
                                         uncertainty =       0.007059413564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341267942615
                                         uncertainty =       0.007059413564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413069226
  error estimate for blocks of size 2^( 2) =       0.000425897462
  error estimate for blocks of size 2^( 3) =       0.000439176063
  error estimate for blocks of size 2^( 4) =       0.000450762157
  error estimate for blocks of size 2^( 5) =       0.000461149840
  error estimate for blocks of size 2^( 6) =       0.000468382176
  error estimate for blocks of size 2^( 7) =       0.000472342161

      target function =                  N/A
              le_mean =     -16.905556158815
             les_mean =     286.139081239348
             stat err =       0.000463159084
             autocorr =       1.257229867426
              std dev =       0.584168101759
             le_variance =       0.341252371113


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905556531280        initial  <--
     1.5259e-01     1.5259e+00             1.4300e-03       -16.905555756696
     6.1035e-01     6.1035e+00             3.5037e-04       -16.905555050167
     2.4414e+00     2.4414e+01             8.8003e-05       -16.905556158815

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3431
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.118478e-01 1 1  ON 0
 uu_1                 1.444348e-01 1 1  ON 1
 uu_2                 4.259508e-02 1 1  ON 2
 uu_3                -2.039788e-02 1 1  ON 3
 uu_4                -6.649291e-02 1 1  ON 4
 uu_5                -1.022031e-01 1 1  ON 5
 uu_6                -1.308512e-01 1 1  ON 6
 uu_7                -1.456245e-01 1 1  ON 7
 uu_8                -1.383864e-01 1 1  ON 8
 uu_9                -1.104422e-01 1 1  ON 9
 ud_0                 4.526568e-01 1 1  ON 10
 ud_1                 1.864074e-01 1 1  ON 11
 ud_2                 6.529440e-02 1 1  ON 12
 ud_3                -6.591811e-03 1 1  ON 13
 ud_4                -6.425385e-02 1 1  ON 14
 ud_5                -1.064463e-01 1 1  ON 15
 ud_6                -1.347009e-01 1 1  ON 16
 ud_7                -1.522475e-01 1 1  ON 17
 ud_8                -1.528434e-01 1 1  ON 18
 ud_9                -1.430562e-01 1 1  ON 19
 eO_0                -7.559658e-01 1 1  ON 20
 eO_1                -4.341329e-01 1 1  ON 21
 eO_2                -1.762855e-02 1 1  ON 22
 eO_3                 3.009026e-01 1 1  ON 23
 eO_4                 5.290592e-01 1 1  ON 24
 eO_5                 4.926840e-01 1 1  ON 25
 eO_6                 2.633636e-01 1 1  ON 26
 eO_7                -4.209871e-02 1 1  ON 27
 eO_8                -2.326264e-01 1 1  ON 28
 eO_9                -9.983087e-02 1 1  ON 29
eH1_0                -2.592024e-01 1 1  ON 30
eH1_1                -1.542623e-01 1 1  ON 31
eH1_2                -1.053748e-01 1 1  ON 32
eH1_3                -4.986897e-02 1 1  ON 33
eH1_4                -5.861912e-04 1 1  ON 34
eH1_5                 3.508223e-02 1 1  ON 35
eH1_6                 9.564773e-02 1 1  ON 36
eH1_7                 1.583186e-01 1 1  ON 37
eH1_8                 1.915733e-01 1 1  ON 38
eH1_9                 8.905533e-02 1 1  ON 39
eH2_0                -2.568105e-01 1 1  ON 40
eH2_1                -1.515449e-01 1 1  ON 41
eH2_2                -1.027996e-01 1 1  ON 42
eH2_3                -4.752764e-02 1 1  ON 43
eH2_4                 1.787075e-03 1 1  ON 44
eH2_5                 3.747506e-02 1 1  ON 45
eH2_6                 9.956861e-02 1 1  ON 46
eH2_7                 1.600343e-01 1 1  ON 47
eH2_8                 1.959823e-01 1 1  ON 48
eH2_9                 7.779210e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5651e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9162
    reference variance = 0.141606
====================================================
  Execution time = 2.0839e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4204e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5869e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341907499290
                                         uncertainty =       0.005149487081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341907499290
                                         uncertainty =       0.005149487081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413543134
  error estimate for blocks of size 2^( 2) =       0.000426274252
  error estimate for blocks of size 2^( 3) =       0.000439413849
  error estimate for blocks of size 2^( 4) =       0.000450946611
  error estimate for blocks of size 2^( 5) =       0.000461065425
  error estimate for blocks of size 2^( 6) =       0.000470071161
  error estimate for blocks of size 2^( 7) =       0.000474726931

      target function =                  N/A
              le_mean =     -16.905667141434
             les_mean =     286.143617173947
             stat err =       0.000464202532
             autocorr =       1.260008223556
              std dev =       0.584838309284
             le_variance =       0.342035848006


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566714143e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905667141434       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905667071612       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905667237171       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905667431395       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905667558991       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905667487313       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905667580763       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905667579288       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.344652e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905667141434       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905667121604       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905667163756       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905667215904       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905667249369       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905667229471       residual = 4.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905667254406       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905667256484       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.376907e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905667141434       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905667136302       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905667146877       residual = 9.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905667160118       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905667168557       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905667163400       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905667169709       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905667170468       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 8.450553e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185008 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6433e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.118530e-01 1 1  ON 0
 uu_1                 1.444389e-01 1 1  ON 1
 uu_2                 4.259146e-02 1 1  ON 2
 uu_3                -2.039588e-02 1 1  ON 3
 uu_4                -6.649993e-02 1 1  ON 4
 uu_5                -1.022165e-01 1 1  ON 5
 uu_6                -1.308627e-01 1 1  ON 6
 uu_7                -1.456248e-01 1 1  ON 7
 uu_8                -1.383883e-01 1 1  ON 8
 uu_9                -1.104430e-01 1 1  ON 9
 ud_0                 4.526486e-01 1 1  ON 10
 ud_1                 1.864088e-01 1 1  ON 11
 ud_2                 6.529770e-02 1 1  ON 12
 ud_3                -6.596487e-03 1 1  ON 13
 ud_4                -6.423874e-02 1 1  ON 14
 ud_5                -1.064437e-01 1 1  ON 15
 ud_6                -1.346755e-01 1 1  ON 16
 ud_7                -1.522477e-01 1 1  ON 17
 ud_8                -1.528649e-01 1 1  ON 18
 ud_9                -1.430670e-01 1 1  ON 19
 eO_0                -7.559616e-01 1 1  ON 20
 eO_1                -4.341317e-01 1 1  ON 21
 eO_2                -1.759834e-02 1 1  ON 22
 eO_3                 3.008973e-01 1 1  ON 23
 eO_4                 5.290570e-01 1 1  ON 24
 eO_5                 4.926784e-01 1 1  ON 25
 eO_6                 2.633648e-01 1 1  ON 26
 eO_7                -4.209157e-02 1 1  ON 27
 eO_8                -2.326362e-01 1 1  ON 28
 eO_9                -9.984916e-02 1 1  ON 29
eH1_0                -2.592161e-01 1 1  ON 30
eH1_1                -1.542583e-01 1 1  ON 31
eH1_2                -1.053813e-01 1 1  ON 32
eH1_3                -4.987785e-02 1 1  ON 33
eH1_4                -6.045206e-04 1 1  ON 34
eH1_5                 3.506832e-02 1 1  ON 35
eH1_6                 9.565464e-02 1 1  ON 36
eH1_7                 1.583184e-01 1 1  ON 37
eH1_8                 1.915895e-01 1 1  ON 38
eH1_9                 8.908484e-02 1 1  ON 39
eH2_0                -2.568176e-01 1 1  ON 40
eH2_1                -1.515458e-01 1 1  ON 41
eH2_2                -1.028214e-01 1 1  ON 42
eH2_3                -4.753668e-02 1 1  ON 43
eH2_4                 1.783383e-03 1 1  ON 44
eH2_5                 3.747480e-02 1 1  ON 45
eH2_6                 9.956722e-02 1 1  ON 46
eH2_7                 1.600278e-01 1 1  ON 47
eH2_8                 1.959947e-01 1 1  ON 48
eH2_9                 7.782587e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8877
    reference variance = 0.266361
====================================================
  Execution time = 2.0082e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4366e-01
  Total weights = 2.0000e+06
  Execution time = 1.8581e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343741381145
                                         uncertainty =       0.004741791658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343741381145
                                         uncertainty =       0.004741791658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414526012
  error estimate for blocks of size 2^( 2) =       0.000427509786
  error estimate for blocks of size 2^( 3) =       0.000441470216
  error estimate for blocks of size 2^( 4) =       0.000454561090
  error estimate for blocks of size 2^( 5) =       0.000467213840
  error estimate for blocks of size 2^( 6) =       0.000479482522
  error estimate for blocks of size 2^( 7) =       0.000488801652

      target function =                  N/A
              le_mean =     -16.905967237763
             les_mean =     286.155391701940
             stat err =       0.000472514776
             autocorr =       1.299353171333
              std dev =       0.586228308293
             le_variance =       0.343663629444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343723578588
                                         uncertainty =       0.004741765854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343723578588
                                         uncertainty =       0.004741765854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414515288
  error estimate for blocks of size 2^( 2) =       0.000427499009
  error estimate for blocks of size 2^( 3) =       0.000441458938
  error estimate for blocks of size 2^( 4) =       0.000454549611
  error estimate for blocks of size 2^( 5) =       0.000467203385
  error estimate for blocks of size 2^( 6) =       0.000479473129
  error estimate for blocks of size 2^( 7) =       0.000488790417

      target function =                  N/A
              le_mean =     -16.905967389485
             les_mean =     286.155379049984
             stat err =       0.000472504136
             autocorr =       1.299361885701
              std dev =       0.586213141693
             le_variance =       0.343645847494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343729630477
                                         uncertainty =       0.004741775703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343729630477
                                         uncertainty =       0.004741775703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414518933
  error estimate for blocks of size 2^( 2) =       0.000427502741
  error estimate for blocks of size 2^( 3) =       0.000441462934
  error estimate for blocks of size 2^( 4) =       0.000454553700
  error estimate for blocks of size 2^( 5) =       0.000467207047
  error estimate for blocks of size 2^( 6) =       0.000479476226
  error estimate for blocks of size 2^( 7) =       0.000488794317

      target function =                  N/A
              le_mean =     -16.905967355303
             les_mean =     286.155383938297
             stat err =       0.000472507823
             autocorr =       1.299359310042
              std dev =       0.586218296850
             le_variance =       0.343651891561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343739794301
                                         uncertainty =       0.004741789414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343739794301
                                         uncertainty =       0.004741789414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414525056
  error estimate for blocks of size 2^( 2) =       0.000427508837
  error estimate for blocks of size 2^( 3) =       0.000441469238
  error estimate for blocks of size 2^( 4) =       0.000454560098
  error estimate for blocks of size 2^( 5) =       0.000467212926
  error estimate for blocks of size 2^( 6) =       0.000479481668
  error estimate for blocks of size 2^( 7) =       0.000488800664

      target function =                  N/A
              le_mean =     -16.905967253419
             les_mean =     286.155390646125
             stat err =       0.000472513839
             autocorr =       1.299354011654
              std dev =       0.586226956303
             le_variance =       0.343662044296


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905967237763        initial
     1.5259e+00     1.5259e+01             1.3447e-04       -16.905967389485  <--
     6.1035e+00     6.1035e+01             3.3769e-05       -16.905967355303
     2.4414e+01     2.4414e+02             8.4506e-06       -16.905967253419

*****************************************************************************
Applying the update for shift_i =   1.5259e+00     and shift_s =   1.5259e+01
*****************************************************************************

  Execution time = 2.9467e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.118683e-01 1 1  ON 0
 uu_1                 1.444476e-01 1 1  ON 1
 uu_2                 4.258279e-02 1 1  ON 2
 uu_3                -2.039283e-02 1 1  ON 3
 uu_4                -6.651802e-02 1 1  ON 4
 uu_5                -1.022542e-01 1 1  ON 5
 uu_6                -1.308972e-01 1 1  ON 6
 uu_7                -1.456267e-01 1 1  ON 7
 uu_8                -1.383935e-01 1 1  ON 8
 uu_9                -1.104452e-01 1 1  ON 9
 ud_0                 4.526301e-01 1 1  ON 10
 ud_1                 1.864119e-01 1 1  ON 11
 ud_2                 6.530429e-02 1 1  ON 12
 ud_3                -6.604836e-03 1 1  ON 13
 ud_4                -6.420223e-02 1 1  ON 14
 ud_5                -1.064318e-01 1 1  ON 15
 ud_6                -1.346067e-01 1 1  ON 16
 ud_7                -1.522462e-01 1 1  ON 17
 ud_8                -1.529270e-01 1 1  ON 18
 ud_9                -1.430993e-01 1 1  ON 19
 eO_0                -7.559463e-01 1 1  ON 20
 eO_1                -4.341256e-01 1 1  ON 21
 eO_2                -1.751732e-02 1 1  ON 22
 eO_3                 3.008863e-01 1 1  ON 23
 eO_4                 5.290499e-01 1 1  ON 24
 eO_5                 4.926610e-01 1 1  ON 25
 eO_6                 2.633682e-01 1 1  ON 26
 eO_7                -4.206991e-02 1 1  ON 27
 eO_8                -2.326656e-01 1 1  ON 28
 eO_9                -9.990374e-02 1 1  ON 29
eH1_0                -2.592556e-01 1 1  ON 30
eH1_1                -1.542494e-01 1 1  ON 31
eH1_2                -1.053998e-01 1 1  ON 32
eH1_3                -4.990467e-02 1 1  ON 33
eH1_4                -6.579925e-04 1 1  ON 34
eH1_5                 3.502716e-02 1 1  ON 35
eH1_6                 9.567451e-02 1 1  ON 36
eH1_7                 1.583182e-01 1 1  ON 37
eH1_8                 1.916381e-01 1 1  ON 38
eH1_9                 8.917290e-02 1 1  ON 39
eH2_0                -2.568394e-01 1 1  ON 40
eH2_1                -1.515524e-01 1 1  ON 41
eH2_2                -1.028804e-01 1 1  ON 42
eH2_3                -4.756417e-02 1 1  ON 43
eH2_4                 1.770787e-03 1 1  ON 44
eH2_5                 3.747492e-02 1 1  ON 45
eH2_6                 9.956292e-02 1 1  ON 46
eH2_7                 1.600086e-01 1 1  ON 47
eH2_8                 1.960316e-01 1 1  ON 48
eH2_9                 7.792657e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5977e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9294
    reference variance = 0.350668
====================================================
  Execution time = 2.0420e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.5923e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358996065567
                                         uncertainty =       0.022592545888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358996065567
                                         uncertainty =       0.022592545888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423809806
  error estimate for blocks of size 2^( 2) =       0.000435755401
  error estimate for blocks of size 2^( 3) =       0.000448227932
  error estimate for blocks of size 2^( 4) =       0.000459485008
  error estimate for blocks of size 2^( 5) =       0.000468104950
  error estimate for blocks of size 2^( 6) =       0.000476828445
  error estimate for blocks of size 2^( 7) =       0.000479400211

      target function =                  N/A
              le_mean =     -16.907647359820
             les_mean =     286.227768566919
             stat err =       0.000470954653
             autocorr =       1.234855623413
              std dev =       0.599357574824
             le_variance =       0.359229502499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690764735982e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907647359820       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907649071358       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907647928248       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907647593581       residual = 9.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907647633757       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907647363339       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907647674420       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907648011852       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907647951540       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907648102832       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 5.060047e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907647359820       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907647932855       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907647571566       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907647473006       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907647529344       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907647388421       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907647415274       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907647484634       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.315316e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907647359820       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907647516354       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907647419543       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907647395210       residual = 6.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907647415827       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907647376454       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907647376014       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907647387538       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.403056e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5968e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.118238e-01 1 1  ON 0
 uu_1                 1.445077e-01 1 1  ON 1
 uu_2                 4.256675e-02 1 1  ON 2
 uu_3                -2.037558e-02 1 1  ON 3
 uu_4                -6.652652e-02 1 1  ON 4
 uu_5                -1.022682e-01 1 1  ON 5
 uu_6                -1.309198e-01 1 1  ON 6
 uu_7                -1.457186e-01 1 1  ON 7
 uu_8                -1.384634e-01 1 1  ON 8
 uu_9                -1.104123e-01 1 1  ON 9
 ud_0                 4.526224e-01 1 1  ON 10
 ud_1                 1.863909e-01 1 1  ON 11
 ud_2                 6.530753e-02 1 1  ON 12
 ud_3                -6.506145e-03 1 1  ON 13
 ud_4                -6.418007e-02 1 1  ON 14
 ud_5                -1.064565e-01 1 1  ON 15
 ud_6                -1.345782e-01 1 1  ON 16
 ud_7                -1.522376e-01 1 1  ON 17
 ud_8                -1.529900e-01 1 1  ON 18
 ud_9                -1.431263e-01 1 1  ON 19
 eO_0                -7.559081e-01 1 1  ON 20
 eO_1                -4.340363e-01 1 1  ON 21
 eO_2                -1.746538e-02 1 1  ON 22
 eO_3                 3.008300e-01 1 1  ON 23
 eO_4                 5.290351e-01 1 1  ON 24
 eO_5                 4.927205e-01 1 1  ON 25
 eO_6                 2.633693e-01 1 1  ON 26
 eO_7                -4.209739e-02 1 1  ON 27
 eO_8                -2.327245e-01 1 1  ON 28
 eO_9                -9.997875e-02 1 1  ON 29
eH1_0                -2.593345e-01 1 1  ON 30
eH1_1                -1.542745e-01 1 1  ON 31
eH1_2                -1.054749e-01 1 1  ON 32
eH1_3                -4.999916e-02 1 1  ON 33
eH1_4                -6.372485e-04 1 1  ON 34
eH1_5                 3.507312e-02 1 1  ON 35
eH1_6                 9.567511e-02 1 1  ON 36
eH1_7                 1.583069e-01 1 1  ON 37
eH1_8                 1.917256e-01 1 1  ON 38
eH1_9                 8.929588e-02 1 1  ON 39
eH2_0                -2.569709e-01 1 1  ON 40
eH2_1                -1.515668e-01 1 1  ON 41
eH2_2                -1.028931e-01 1 1  ON 42
eH2_3                -4.754756e-02 1 1  ON 43
eH2_4                 1.754545e-03 1 1  ON 44
eH2_5                 3.753458e-02 1 1  ON 45
eH2_6                 9.957835e-02 1 1  ON 46
eH2_7                 1.599589e-01 1 1  ON 47
eH2_8                 1.960604e-01 1 1  ON 48
eH2_9                 7.803031e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8974
    reference variance = 0.29404
====================================================
  Execution time = 2.0146e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4558e-01
  Total weights = 2.0000e+06
  Execution time = 1.8576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345636527507
                                         uncertainty =       0.005857410859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345636527507
                                         uncertainty =       0.005857410859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415682381
  error estimate for blocks of size 2^( 2) =       0.000428381462
  error estimate for blocks of size 2^( 3) =       0.000441128846
  error estimate for blocks of size 2^( 4) =       0.000453724513
  error estimate for blocks of size 2^( 5) =       0.000464848220
  error estimate for blocks of size 2^( 6) =       0.000471520253
  error estimate for blocks of size 2^( 7) =       0.000479348338

      target function =                  N/A
              le_mean =     -16.906671676338
             les_mean =     286.181130682970
             stat err =       0.000467360331
             autocorr =       1.264097172517
              std dev =       0.587863661301
             le_variance =       0.345583684279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345599680514
                                         uncertainty =       0.005856766579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345599680514
                                         uncertainty =       0.005856766579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415660259
  error estimate for blocks of size 2^( 2) =       0.000428359028
  error estimate for blocks of size 2^( 3) =       0.000441109684
  error estimate for blocks of size 2^( 4) =       0.000453705029
  error estimate for blocks of size 2^( 5) =       0.000464833469
  error estimate for blocks of size 2^( 6) =       0.000471510170
  error estimate for blocks of size 2^( 7) =       0.000479331921

      target function =                  N/A
              le_mean =     -16.906669434145
             les_mean =     286.181018084070
             stat err =       0.000467345148
             autocorr =       1.264149591006
              std dev =       0.587832375238
             le_variance =       0.345546901378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345630311331
                                         uncertainty =       0.005857473821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345630311331
                                         uncertainty =       0.005857473821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415678677
  error estimate for blocks of size 2^( 2) =       0.000428376761
  error estimate for blocks of size 2^( 3) =       0.000441126244
  error estimate for blocks of size 2^( 4) =       0.000453721556
  error estimate for blocks of size 2^( 5) =       0.000464848195
  error estimate for blocks of size 2^( 6) =       0.000471523741
  error estimate for blocks of size 2^( 7) =       0.000479346445

      target function =                  N/A
              le_mean =     -16.906670066883
             les_mean =     286.181070102730
             stat err =       0.000467359984
             autocorr =       1.264117827067
              std dev =       0.587858422662
             le_variance =       0.345577525095

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345637467280
                                         uncertainty =       0.005857456576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345637467280
                                         uncertainty =       0.005857456576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415682952
  error estimate for blocks of size 2^( 2) =       0.000428381815
  error estimate for blocks of size 2^( 3) =       0.000441129440
  error estimate for blocks of size 2^( 4) =       0.000453725028
  error estimate for blocks of size 2^( 5) =       0.000464849116
  error estimate for blocks of size 2^( 6) =       0.000471521629
  error estimate for blocks of size 2^( 7) =       0.000479348898

      target function =                  N/A
              le_mean =     -16.906671429088
             les_mean =     286.181123271037
             stat err =       0.000467361168
             autocorr =       1.264098229377
              std dev =       0.587864467969
             le_variance =       0.345584632701


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906671676338        initial  <--
     3.8147e-01     3.8147e+00             5.0600e-04       -16.906669434145
     1.5259e+00     1.5259e+01             1.3153e-04       -16.906670066883
     6.1035e+00     6.1035e+01             3.4031e-05       -16.906671429088

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5078
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.118683e-01 1 1  ON 0
 uu_1                 1.444476e-01 1 1  ON 1
 uu_2                 4.258279e-02 1 1  ON 2
 uu_3                -2.039283e-02 1 1  ON 3
 uu_4                -6.651802e-02 1 1  ON 4
 uu_5                -1.022542e-01 1 1  ON 5
 uu_6                -1.308972e-01 1 1  ON 6
 uu_7                -1.456267e-01 1 1  ON 7
 uu_8                -1.383935e-01 1 1  ON 8
 uu_9                -1.104452e-01 1 1  ON 9
 ud_0                 4.526301e-01 1 1  ON 10
 ud_1                 1.864119e-01 1 1  ON 11
 ud_2                 6.530429e-02 1 1  ON 12
 ud_3                -6.604836e-03 1 1  ON 13
 ud_4                -6.420223e-02 1 1  ON 14
 ud_5                -1.064318e-01 1 1  ON 15
 ud_6                -1.346067e-01 1 1  ON 16
 ud_7                -1.522462e-01 1 1  ON 17
 ud_8                -1.529270e-01 1 1  ON 18
 ud_9                -1.430993e-01 1 1  ON 19
 eO_0                -7.559463e-01 1 1  ON 20
 eO_1                -4.341256e-01 1 1  ON 21
 eO_2                -1.751732e-02 1 1  ON 22
 eO_3                 3.008863e-01 1 1  ON 23
 eO_4                 5.290499e-01 1 1  ON 24
 eO_5                 4.926610e-01 1 1  ON 25
 eO_6                 2.633682e-01 1 1  ON 26
 eO_7                -4.206991e-02 1 1  ON 27
 eO_8                -2.326656e-01 1 1  ON 28
 eO_9                -9.990374e-02 1 1  ON 29
eH1_0                -2.592556e-01 1 1  ON 30
eH1_1                -1.542494e-01 1 1  ON 31
eH1_2                -1.053998e-01 1 1  ON 32
eH1_3                -4.990467e-02 1 1  ON 33
eH1_4                -6.579925e-04 1 1  ON 34
eH1_5                 3.502716e-02 1 1  ON 35
eH1_6                 9.567451e-02 1 1  ON 36
eH1_7                 1.583182e-01 1 1  ON 37
eH1_8                 1.916381e-01 1 1  ON 38
eH1_9                 8.917290e-02 1 1  ON 39
eH2_0                -2.568394e-01 1 1  ON 40
eH2_1                -1.515524e-01 1 1  ON 41
eH2_2                -1.028804e-01 1 1  ON 42
eH2_3                -4.756417e-02 1 1  ON 43
eH2_4                 1.770787e-03 1 1  ON 44
eH2_5                 3.747492e-02 1 1  ON 45
eH2_6                 9.956292e-02 1 1  ON 46
eH2_7                 1.600086e-01 1 1  ON 47
eH2_8                 1.960316e-01 1 1  ON 48
eH2_9                 7.792657e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5686e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9288
    reference variance = 0.279081
====================================================
  Execution time = 2.0343e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5784e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357873150768
                                         uncertainty =       0.015596642711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357873150768
                                         uncertainty =       0.015596642711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422987130
  error estimate for blocks of size 2^( 2) =       0.000435333480
  error estimate for blocks of size 2^( 3) =       0.000448149107
  error estimate for blocks of size 2^( 4) =       0.000461146346
  error estimate for blocks of size 2^( 5) =       0.000472366468
  error estimate for blocks of size 2^( 6) =       0.000482367183
  error estimate for blocks of size 2^( 7) =       0.000485723192

      target function =                  N/A
              le_mean =     -16.905995898883
             les_mean =     286.170533377847
             stat err =       0.000475400797
             autocorr =       1.263180769068
              std dev =       0.598194135487
             le_variance =       0.357836223732


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599589888e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905995898883       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905995961761       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905996055254       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905996019025       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905996006528       residual = 8.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905996021384       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905996044978       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905996041881       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.462449e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905995898883       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905995915215       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905995940203       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905995933000       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905995928245       residual = 9.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905995938059       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905995935705       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905995939203       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.369225e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905995898883       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905995903006       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905995909364       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905995907692       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905995906437       residual = 9.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905995908962       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905995908432       residual = 9.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.240306e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.190440 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5858e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.118650e-01 1 1  ON 0
 uu_1                 1.444427e-01 1 1  ON 1
 uu_2                 4.257866e-02 1 1  ON 2
 uu_3                -2.039599e-02 1 1  ON 3
 uu_4                -6.651410e-02 1 1  ON 4
 uu_5                -1.022501e-01 1 1  ON 5
 uu_6                -1.308925e-01 1 1  ON 6
 uu_7                -1.456274e-01 1 1  ON 7
 uu_8                -1.383933e-01 1 1  ON 8
 uu_9                -1.104499e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864205e-01 1 1  ON 11
 ud_2                 6.530313e-02 1 1  ON 12
 ud_3                -6.599429e-03 1 1  ON 13
 ud_4                -6.420398e-02 1 1  ON 14
 ud_5                -1.064340e-01 1 1  ON 15
 ud_6                -1.346105e-01 1 1  ON 16
 ud_7                -1.522452e-01 1 1  ON 17
 ud_8                -1.529243e-01 1 1  ON 18
 ud_9                -1.431011e-01 1 1  ON 19
 eO_0                -7.559420e-01 1 1  ON 20
 eO_1                -4.341184e-01 1 1  ON 21
 eO_2                -1.751779e-02 1 1  ON 22
 eO_3                 3.008767e-01 1 1  ON 23
 eO_4                 5.290516e-01 1 1  ON 24
 eO_5                 4.926651e-01 1 1  ON 25
 eO_6                 2.633697e-01 1 1  ON 26
 eO_7                -4.206417e-02 1 1  ON 27
 eO_8                -2.326682e-01 1 1  ON 28
 eO_9                -9.991269e-02 1 1  ON 29
eH1_0                -2.592595e-01 1 1  ON 30
eH1_1                -1.542576e-01 1 1  ON 31
eH1_2                -1.053984e-01 1 1  ON 32
eH1_3                -4.991401e-02 1 1  ON 33
eH1_4                -6.591848e-04 1 1  ON 34
eH1_5                 3.502133e-02 1 1  ON 35
eH1_6                 9.568263e-02 1 1  ON 36
eH1_7                 1.583215e-01 1 1  ON 37
eH1_8                 1.916414e-01 1 1  ON 38
eH1_9                 8.918523e-02 1 1  ON 39
eH2_0                -2.568405e-01 1 1  ON 40
eH2_1                -1.515572e-01 1 1  ON 41
eH2_2                -1.028889e-01 1 1  ON 42
eH2_3                -4.756431e-02 1 1  ON 43
eH2_4                 1.771630e-03 1 1  ON 44
eH2_5                 3.747700e-02 1 1  ON 45
eH2_6                 9.956251e-02 1 1  ON 46
eH2_7                 1.600055e-01 1 1  ON 47
eH2_8                 1.960311e-01 1 1  ON 48
eH2_9                 7.794026e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9037
    reference variance = 0.28854
====================================================
  Execution time = 1.9884e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5380e-01
  Total weights = 2.0000e+06
  Execution time = 1.8640e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353720418554
                                         uncertainty =       0.011849268492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353720418554
                                         uncertainty =       0.011849268492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420592693
  error estimate for blocks of size 2^( 2) =       0.000432589142
  error estimate for blocks of size 2^( 3) =       0.000445709853
  error estimate for blocks of size 2^( 4) =       0.000457467262
  error estimate for blocks of size 2^( 5) =       0.000466493021
  error estimate for blocks of size 2^( 6) =       0.000471841679
  error estimate for blocks of size 2^( 7) =       0.000476856594

      target function =                  N/A
              le_mean =     -16.906015041108
             les_mean =     286.167140820503
             stat err =       0.000468164639
             autocorr =       1.239007023793
              std dev =       0.594807891018
             le_variance =       0.353796427218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353717254026
                                         uncertainty =       0.011849142149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353717254026
                                         uncertainty =       0.011849142149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420590792
  error estimate for blocks of size 2^( 2) =       0.000432587053
  error estimate for blocks of size 2^( 3) =       0.000445707508
  error estimate for blocks of size 2^( 4) =       0.000457464396
  error estimate for blocks of size 2^( 5) =       0.000466489717
  error estimate for blocks of size 2^( 6) =       0.000471838473
  error estimate for blocks of size 2^( 7) =       0.000476852703

      target function =                  N/A
              le_mean =     -16.906015288699
             les_mean =     286.167145994209
             stat err =       0.000468161322
             autocorr =       1.239000666193
              std dev =       0.594805202874
             le_variance =       0.353793229366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353718543545
                                         uncertainty =       0.011849255899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353718543545
                                         uncertainty =       0.011849255899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420591568
  error estimate for blocks of size 2^( 2) =       0.000432587915
  error estimate for blocks of size 2^( 3) =       0.000445708485
  error estimate for blocks of size 2^( 4) =       0.000457465601
  error estimate for blocks of size 2^( 5) =       0.000466491112
  error estimate for blocks of size 2^( 6) =       0.000471839839
  error estimate for blocks of size 2^( 7) =       0.000476854375

      target function =                  N/A
              le_mean =     -16.906015174685
             les_mean =     286.167143444001
             stat err =       0.000468162732
             autocorr =       1.239003559086
              std dev =       0.594806299744
             le_variance =       0.353794534215

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353720114239
                                         uncertainty =       0.011849256013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353720114239
                                         uncertainty =       0.011849256013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420592511
  error estimate for blocks of size 2^( 2) =       0.000432588950
  error estimate for blocks of size 2^( 3) =       0.000445709646
  error estimate for blocks of size 2^( 4) =       0.000457467018
  error estimate for blocks of size 2^( 5) =       0.000466492747
  error estimate for blocks of size 2^( 6) =       0.000471841413
  error estimate for blocks of size 2^( 7) =       0.000476856277

      target function =                  N/A
              le_mean =     -16.906015058611
             les_mean =     286.167141105679
             stat err =       0.000468164364
             autocorr =       1.239006640965
              std dev =       0.594807633260
             le_variance =       0.353796120585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906015041108        initial
     3.8147e+00     3.8147e+01             5.4624e-05       -16.906015288699  <--
     1.5259e+01     1.5259e+02             1.3692e-05       -16.906015174685
     6.1035e+01     6.1035e+02             3.2403e-06       -16.906015058611

*****************************************************************************
Applying the update for shift_i =   3.8147e+00     and shift_s =   3.8147e+01
*****************************************************************************

  Execution time = 2.9204e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.118550e-01 1 1  ON 0
 uu_1                 1.444284e-01 1 1  ON 1
 uu_2                 4.256683e-02 1 1  ON 2
 uu_3                -2.040470e-02 1 1  ON 3
 uu_4                -6.650346e-02 1 1  ON 4
 uu_5                -1.022382e-01 1 1  ON 5
 uu_6                -1.308788e-01 1 1  ON 6
 uu_7                -1.456293e-01 1 1  ON 7
 uu_8                -1.383927e-01 1 1  ON 8
 uu_9                -1.104639e-01 1 1  ON 9
 ud_0                 4.526321e-01 1 1  ON 10
 ud_1                 1.864433e-01 1 1  ON 11
 ud_2                 6.530159e-02 1 1  ON 12
 ud_3                -6.585039e-03 1 1  ON 13
 ud_4                -6.420859e-02 1 1  ON 14
 ud_5                -1.064408e-01 1 1  ON 15
 ud_6                -1.346211e-01 1 1  ON 16
 ud_7                -1.522421e-01 1 1  ON 17
 ud_8                -1.529162e-01 1 1  ON 18
 ud_9                -1.431061e-01 1 1  ON 19
 eO_0                -7.559289e-01 1 1  ON 20
 eO_1                -4.340973e-01 1 1  ON 21
 eO_2                -1.751938e-02 1 1  ON 22
 eO_3                 3.008482e-01 1 1  ON 23
 eO_4                 5.290563e-01 1 1  ON 24
 eO_5                 4.926774e-01 1 1  ON 25
 eO_6                 2.633742e-01 1 1  ON 26
 eO_7                -4.204700e-02 1 1  ON 27
 eO_8                -2.326759e-01 1 1  ON 28
 eO_9                -9.993943e-02 1 1  ON 29
eH1_0                -2.592713e-01 1 1  ON 30
eH1_1                -1.542814e-01 1 1  ON 31
eH1_2                -1.053958e-01 1 1  ON 32
eH1_3                -4.994110e-02 1 1  ON 33
eH1_4                -6.629966e-04 1 1  ON 34
eH1_5                 3.500400e-02 1 1  ON 35
eH1_6                 9.570686e-02 1 1  ON 36
eH1_7                 1.583315e-01 1 1  ON 37
eH1_8                 1.916511e-01 1 1  ON 38
eH1_9                 8.922212e-02 1 1  ON 39
eH2_0                -2.568439e-01 1 1  ON 40
eH2_1                -1.515720e-01 1 1  ON 41
eH2_2                -1.029133e-01 1 1  ON 42
eH2_3                -4.756541e-02 1 1  ON 43
eH2_4                 1.774411e-03 1 1  ON 44
eH2_5                 3.748316e-02 1 1  ON 45
eH2_6                 9.956123e-02 1 1  ON 46
eH2_7                 1.599962e-01 1 1  ON 47
eH2_8                 1.960297e-01 1 1  ON 48
eH2_9                 7.798119e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9782
    reference variance = 0.251321
====================================================
  Execution time = 2.0686e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4377e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343678791664
                                         uncertainty =       0.007377047496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343678791664
                                         uncertainty =       0.007377047496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414593130
  error estimate for blocks of size 2^( 2) =       0.000427949685
  error estimate for blocks of size 2^( 3) =       0.000440835856
  error estimate for blocks of size 2^( 4) =       0.000452932269
  error estimate for blocks of size 2^( 5) =       0.000463124742
  error estimate for blocks of size 2^( 6) =       0.000471208332
  error estimate for blocks of size 2^( 7) =       0.000473997095

      target function =                  N/A
              le_mean =     -16.905760102654
             les_mean =     286.148499403809
             stat err =       0.000465315610
             autocorr =       1.259653333464
              std dev =       0.586323227594
             le_variance =       0.343774927216


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576010265e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760102654       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760049879       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905759983729       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760063648       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760178608       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760101840       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760067731       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760057009       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905760051557       residual = 1.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.654614e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760102654       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760087527       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760057517       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760078770       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760066045       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760096442       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760074874       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760060483       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 6.440817e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760102654       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760098728       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760090017       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905760095054       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905760090875       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905760099591       residual = 4.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905760094333       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905760089731       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.617048e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193264 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6282e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.118312e-01 1 1  ON 0
 uu_1                 1.444462e-01 1 1  ON 1
 uu_2                 4.255869e-02 1 1  ON 2
 uu_3                -2.039813e-02 1 1  ON 3
 uu_4                -6.651516e-02 1 1  ON 4
 uu_5                -1.022429e-01 1 1  ON 5
 uu_6                -1.308723e-01 1 1  ON 6
 uu_7                -1.456621e-01 1 1  ON 7
 uu_8                -1.384098e-01 1 1  ON 8
 uu_9                -1.104679e-01 1 1  ON 9
 ud_0                 4.526088e-01 1 1  ON 10
 ud_1                 1.864246e-01 1 1  ON 11
 ud_2                 6.530741e-02 1 1  ON 12
 ud_3                -6.582833e-03 1 1  ON 13
 ud_4                -6.420855e-02 1 1  ON 14
 ud_5                -1.064289e-01 1 1  ON 15
 ud_6                -1.346527e-01 1 1  ON 16
 ud_7                -1.522243e-01 1 1  ON 17
 ud_8                -1.529060e-01 1 1  ON 18
 ud_9                -1.430938e-01 1 1  ON 19
 eO_0                -7.559326e-01 1 1  ON 20
 eO_1                -4.340763e-01 1 1  ON 21
 eO_2                -1.752152e-02 1 1  ON 22
 eO_3                 3.008486e-01 1 1  ON 23
 eO_4                 5.290687e-01 1 1  ON 24
 eO_5                 4.926932e-01 1 1  ON 25
 eO_6                 2.633858e-01 1 1  ON 26
 eO_7                -4.205272e-02 1 1  ON 27
 eO_8                -2.326930e-01 1 1  ON 28
 eO_9                -9.996557e-02 1 1  ON 29
eH1_0                -2.592917e-01 1 1  ON 30
eH1_1                -1.543123e-01 1 1  ON 31
eH1_2                -1.054099e-01 1 1  ON 32
eH1_3                -4.994099e-02 1 1  ON 33
eH1_4                -6.836667e-04 1 1  ON 34
eH1_5                 3.500337e-02 1 1  ON 35
eH1_6                 9.573223e-02 1 1  ON 36
eH1_7                 1.583381e-01 1 1  ON 37
eH1_8                 1.916731e-01 1 1  ON 38
eH1_9                 8.925194e-02 1 1  ON 39
eH2_0                -2.568710e-01 1 1  ON 40
eH2_1                -1.515860e-01 1 1  ON 41
eH2_2                -1.029139e-01 1 1  ON 42
eH2_3                -4.760415e-02 1 1  ON 43
eH2_4                 1.792945e-03 1 1  ON 44
eH2_5                 3.747351e-02 1 1  ON 45
eH2_6                 9.953482e-02 1 1  ON 46
eH2_7                 1.599861e-01 1 1  ON 47
eH2_8                 1.960620e-01 1 1  ON 48
eH2_9                 7.804560e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9262
    reference variance = 0.273883
====================================================
  Execution time = 2.2300e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3606e-01
  Total weights = 2.0000e+06
  Execution time = 1.8644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336061660681
                                         uncertainty =       0.002430717358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336061660681
                                         uncertainty =       0.002430717358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409927995
  error estimate for blocks of size 2^( 2) =       0.000422175428
  error estimate for blocks of size 2^( 3) =       0.000435516971
  error estimate for blocks of size 2^( 4) =       0.000448148069
  error estimate for blocks of size 2^( 5) =       0.000460001078
  error estimate for blocks of size 2^( 6) =       0.000470512020
  error estimate for blocks of size 2^( 7) =       0.000476867349

      target function =                  N/A
              le_mean =     -16.906534310405
             les_mean =     286.166984143705
             stat err =       0.000463882129
             autocorr =       1.280560571160
              std dev =       0.579725730693
             le_variance =       0.336081922828

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335992167611
                                         uncertainty =       0.002430365834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335992167611
                                         uncertainty =       0.002430365834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409885637
  error estimate for blocks of size 2^( 2) =       0.000422135118
  error estimate for blocks of size 2^( 3) =       0.000435479652
  error estimate for blocks of size 2^( 4) =       0.000448113094
  error estimate for blocks of size 2^( 5) =       0.000459965976
  error estimate for blocks of size 2^( 6) =       0.000470476194
  error estimate for blocks of size 2^( 7) =       0.000476830919

      target function =                  N/A
              le_mean =     -16.906534089958
             les_mean =     286.166907238508
             stat err =       0.000463846546
             autocorr =       1.280628763032
              std dev =       0.579665827536
             le_variance =       0.336012471613

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336019520934
                                         uncertainty =       0.002430498876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336019520934
                                         uncertainty =       0.002430498876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409902314
  error estimate for blocks of size 2^( 2) =       0.000422150918
  error estimate for blocks of size 2^( 3) =       0.000435494241
  error estimate for blocks of size 2^( 4) =       0.000448126802
  error estimate for blocks of size 2^( 5) =       0.000459979714
  error estimate for blocks of size 2^( 6) =       0.000470490335
  error estimate for blocks of size 2^( 7) =       0.000476845263

      target function =                  N/A
              le_mean =     -16.906534096488
             les_mean =     286.166934801908
             stat err =       0.000463860528
             autocorr =       1.280601765702
              std dev =       0.579689411844
             le_variance =       0.336039814204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336056218758
                                         uncertainty =       0.002430689616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336056218758
                                         uncertainty =       0.002430689616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409924679
  error estimate for blocks of size 2^( 2) =       0.000422172261
  error estimate for blocks of size 2^( 3) =       0.000435514037
  error estimate for blocks of size 2^( 4) =       0.000448145329
  error estimate for blocks of size 2^( 5) =       0.000459998327
  error estimate for blocks of size 2^( 6) =       0.000470509228
  error estimate for blocks of size 2^( 7) =       0.000476864512

      target function =                  N/A
              le_mean =     -16.906534278895
             les_mean =     286.166977640551
             stat err =       0.000463879349
             autocorr =       1.280565940956
              std dev =       0.579721040795
             le_variance =       0.336076485140


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906534310405        initial  <--
     9.5367e-01     9.5367e+00             2.6546e-04       -16.906534089958
     3.8147e+00     3.8147e+01             6.4408e-05       -16.906534096488
     1.5259e+01     1.5259e+02             1.6170e-05       -16.906534278895

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6800
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.118550e-01 1 1  ON 0
 uu_1                 1.444284e-01 1 1  ON 1
 uu_2                 4.256683e-02 1 1  ON 2
 uu_3                -2.040470e-02 1 1  ON 3
 uu_4                -6.650346e-02 1 1  ON 4
 uu_5                -1.022382e-01 1 1  ON 5
 uu_6                -1.308788e-01 1 1  ON 6
 uu_7                -1.456293e-01 1 1  ON 7
 uu_8                -1.383927e-01 1 1  ON 8
 uu_9                -1.104639e-01 1 1  ON 9
 ud_0                 4.526321e-01 1 1  ON 10
 ud_1                 1.864433e-01 1 1  ON 11
 ud_2                 6.530159e-02 1 1  ON 12
 ud_3                -6.585039e-03 1 1  ON 13
 ud_4                -6.420859e-02 1 1  ON 14
 ud_5                -1.064408e-01 1 1  ON 15
 ud_6                -1.346211e-01 1 1  ON 16
 ud_7                -1.522421e-01 1 1  ON 17
 ud_8                -1.529162e-01 1 1  ON 18
 ud_9                -1.431061e-01 1 1  ON 19
 eO_0                -7.559289e-01 1 1  ON 20
 eO_1                -4.340973e-01 1 1  ON 21
 eO_2                -1.751938e-02 1 1  ON 22
 eO_3                 3.008482e-01 1 1  ON 23
 eO_4                 5.290563e-01 1 1  ON 24
 eO_5                 4.926774e-01 1 1  ON 25
 eO_6                 2.633742e-01 1 1  ON 26
 eO_7                -4.204700e-02 1 1  ON 27
 eO_8                -2.326759e-01 1 1  ON 28
 eO_9                -9.993943e-02 1 1  ON 29
eH1_0                -2.592713e-01 1 1  ON 30
eH1_1                -1.542814e-01 1 1  ON 31
eH1_2                -1.053958e-01 1 1  ON 32
eH1_3                -4.994110e-02 1 1  ON 33
eH1_4                -6.629966e-04 1 1  ON 34
eH1_5                 3.500400e-02 1 1  ON 35
eH1_6                 9.570686e-02 1 1  ON 36
eH1_7                 1.583315e-01 1 1  ON 37
eH1_8                 1.916511e-01 1 1  ON 38
eH1_9                 8.922212e-02 1 1  ON 39
eH2_0                -2.568439e-01 1 1  ON 40
eH2_1                -1.515720e-01 1 1  ON 41
eH2_2                -1.029133e-01 1 1  ON 42
eH2_3                -4.756541e-02 1 1  ON 43
eH2_4                 1.774411e-03 1 1  ON 44
eH2_5                 3.748316e-02 1 1  ON 45
eH2_6                 9.956123e-02 1 1  ON 46
eH2_7                 1.599962e-01 1 1  ON 47
eH2_8                 1.960297e-01 1 1  ON 48
eH2_9                 7.798119e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7971e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8725
    reference variance = 0.205694
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3561e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5557e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335642442801
                                         uncertainty =       0.004349952738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335642442801
                                         uncertainty =       0.004349952738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409641537
  error estimate for blocks of size 2^( 2) =       0.000422676149
  error estimate for blocks of size 2^( 3) =       0.000435539130
  error estimate for blocks of size 2^( 4) =       0.000447623292
  error estimate for blocks of size 2^( 5) =       0.000457784680
  error estimate for blocks of size 2^( 6) =       0.000463985684
  error estimate for blocks of size 2^( 7) =       0.000468156862

      target function =                  N/A
              le_mean =     -16.906491343661
             les_mean =     286.165061762451
             stat err =       0.000459387630
             autocorr =       1.257623430462
              std dev =       0.579320616746
             le_variance =       0.335612376987


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649134366e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906491343661       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906491426209       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906491413940       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906491440151       residual = 4.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906491430128       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906491434935       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906491423488       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906491424881       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 1.595104e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906491343661       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906491364606       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906491361436       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906491368125       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906491365817       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906491367123       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906491364204       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906491364430       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.080063e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906491343661       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906491348917       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906491348118       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906491349799       residual = 4.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906491349235       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906491349568       residual = 6.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906491348836       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906491348884       residual = 2.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.028325e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.195885 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5840e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.118547e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256643e-02 1 1  ON 2
 uu_3                -2.040062e-02 1 1  ON 3
 uu_4                -6.650401e-02 1 1  ON 4
 uu_5                -1.022395e-01 1 1  ON 5
 uu_6                -1.308803e-01 1 1  ON 6
 uu_7                -1.456319e-01 1 1  ON 7
 uu_8                -1.383949e-01 1 1  ON 8
 uu_9                -1.104655e-01 1 1  ON 9
 ud_0                 4.526309e-01 1 1  ON 10
 ud_1                 1.864443e-01 1 1  ON 11
 ud_2                 6.530343e-02 1 1  ON 12
 ud_3                -6.585316e-03 1 1  ON 13
 ud_4                -6.420468e-02 1 1  ON 14
 ud_5                -1.064391e-01 1 1  ON 15
 ud_6                -1.346192e-01 1 1  ON 16
 ud_7                -1.522432e-01 1 1  ON 17
 ud_8                -1.529183e-01 1 1  ON 18
 ud_9                -1.431085e-01 1 1  ON 19
 eO_0                -7.559283e-01 1 1  ON 20
 eO_1                -4.340959e-01 1 1  ON 21
 eO_2                -1.751632e-02 1 1  ON 22
 eO_3                 3.008481e-01 1 1  ON 23
 eO_4                 5.290568e-01 1 1  ON 24
 eO_5                 4.926787e-01 1 1  ON 25
 eO_6                 2.633749e-01 1 1  ON 26
 eO_7                -4.204748e-02 1 1  ON 27
 eO_8                -2.326793e-01 1 1  ON 28
 eO_9                -9.994243e-02 1 1  ON 29
eH1_0                -2.592740e-01 1 1  ON 30
eH1_1                -1.542820e-01 1 1  ON 31
eH1_2                -1.053972e-01 1 1  ON 32
eH1_3                -4.994191e-02 1 1  ON 33
eH1_4                -6.617168e-04 1 1  ON 34
eH1_5                 3.500392e-02 1 1  ON 35
eH1_6                 9.570723e-02 1 1  ON 36
eH1_7                 1.583299e-01 1 1  ON 37
eH1_8                 1.916521e-01 1 1  ON 38
eH1_9                 8.922602e-02 1 1  ON 39
eH2_0                -2.568460e-01 1 1  ON 40
eH2_1                -1.515760e-01 1 1  ON 41
eH2_2                -1.029166e-01 1 1  ON 42
eH2_3                -4.756618e-02 1 1  ON 43
eH2_4                 1.774962e-03 1 1  ON 44
eH2_5                 3.748624e-02 1 1  ON 45
eH2_6                 9.956071e-02 1 1  ON 46
eH2_7                 1.599968e-01 1 1  ON 47
eH2_8                 1.960320e-01 1 1  ON 48
eH2_9                 7.798451e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9009
    reference variance = 0.215048
====================================================
  Execution time = 1.9882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5658e-01
  Total weights = 2.0000e+06
  Execution time = 1.8777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356604322522
                                         uncertainty =       0.014455578820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356604322522
                                         uncertainty =       0.014455578820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422244998
  error estimate for blocks of size 2^( 2) =       0.000434654954
  error estimate for blocks of size 2^( 3) =       0.000447305882
  error estimate for blocks of size 2^( 4) =       0.000459869717
  error estimate for blocks of size 2^( 5) =       0.000471393841
  error estimate for blocks of size 2^( 6) =       0.000479793644
  error estimate for blocks of size 2^( 7) =       0.000483407852

      target function =                  N/A
              le_mean =     -16.905896548721
             les_mean =     286.165919613980
             stat err =       0.000473616264
             autocorr =       1.258126146384
              std dev =       0.597144602440
             le_variance =       0.356581676223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356593550828
                                         uncertainty =       0.014454736555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356593550828
                                         uncertainty =       0.014454736555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422238617
  error estimate for blocks of size 2^( 2) =       0.000434648850
  error estimate for blocks of size 2^( 3) =       0.000447300065
  error estimate for blocks of size 2^( 4) =       0.000459863949
  error estimate for blocks of size 2^( 5) =       0.000471388054
  error estimate for blocks of size 2^( 6) =       0.000479788392
  error estimate for blocks of size 2^( 7) =       0.000483403055

      target function =                  N/A
              le_mean =     -16.905896460040
             les_mean =     286.165905838425
             stat err =       0.000473610863
             autocorr =       1.258135476872
              std dev =       0.597135578519
             le_variance =       0.356570899133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356598790425
                                         uncertainty =       0.014455140801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356598790425
                                         uncertainty =       0.014455140801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422241721
  error estimate for blocks of size 2^( 2) =       0.000434651819
  error estimate for blocks of size 2^( 3) =       0.000447302896
  error estimate for blocks of size 2^( 4) =       0.000459866757
  error estimate for blocks of size 2^( 5) =       0.000471390872
  error estimate for blocks of size 2^( 6) =       0.000479790952
  error estimate for blocks of size 2^( 7) =       0.000483405399

      target function =                  N/A
              le_mean =     -16.905896503109
             les_mean =     286.165912536857
             stat err =       0.000473613495
             autocorr =       1.258130966281
              std dev =       0.597139967935
             le_variance =       0.356576141306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356603626001
                                         uncertainty =       0.014455523497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356603626001
                                         uncertainty =       0.014455523497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422244585
  error estimate for blocks of size 2^( 2) =       0.000434654559
  error estimate for blocks of size 2^( 3) =       0.000447305507
  error estimate for blocks of size 2^( 4) =       0.000459869344
  error estimate for blocks of size 2^( 5) =       0.000471393467
  error estimate for blocks of size 2^( 6) =       0.000479793305
  error estimate for blocks of size 2^( 7) =       0.000483407543

      target function =                  N/A
              le_mean =     -16.905896542942
             les_mean =     286.165918721729
             stat err =       0.000473615915
             autocorr =       1.258126753888
              std dev =       0.597144018931
             le_variance =       0.356580979345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905896548721        initial  <--
     9.5367e+00     9.5367e+01             1.5951e-05       -16.905896460040
     3.8147e+01     3.8147e+02             4.0801e-06       -16.905896503109
     1.5259e+02     1.5259e+03             1.0283e-06       -16.905896542942

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2654
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.118550e-01 1 1  ON 0
 uu_1                 1.444284e-01 1 1  ON 1
 uu_2                 4.256683e-02 1 1  ON 2
 uu_3                -2.040470e-02 1 1  ON 3
 uu_4                -6.650346e-02 1 1  ON 4
 uu_5                -1.022382e-01 1 1  ON 5
 uu_6                -1.308788e-01 1 1  ON 6
 uu_7                -1.456293e-01 1 1  ON 7
 uu_8                -1.383927e-01 1 1  ON 8
 uu_9                -1.104639e-01 1 1  ON 9
 ud_0                 4.526321e-01 1 1  ON 10
 ud_1                 1.864433e-01 1 1  ON 11
 ud_2                 6.530159e-02 1 1  ON 12
 ud_3                -6.585039e-03 1 1  ON 13
 ud_4                -6.420859e-02 1 1  ON 14
 ud_5                -1.064408e-01 1 1  ON 15
 ud_6                -1.346211e-01 1 1  ON 16
 ud_7                -1.522421e-01 1 1  ON 17
 ud_8                -1.529162e-01 1 1  ON 18
 ud_9                -1.431061e-01 1 1  ON 19
 eO_0                -7.559289e-01 1 1  ON 20
 eO_1                -4.340973e-01 1 1  ON 21
 eO_2                -1.751938e-02 1 1  ON 22
 eO_3                 3.008482e-01 1 1  ON 23
 eO_4                 5.290563e-01 1 1  ON 24
 eO_5                 4.926774e-01 1 1  ON 25
 eO_6                 2.633742e-01 1 1  ON 26
 eO_7                -4.204700e-02 1 1  ON 27
 eO_8                -2.326759e-01 1 1  ON 28
 eO_9                -9.993943e-02 1 1  ON 29
eH1_0                -2.592713e-01 1 1  ON 30
eH1_1                -1.542814e-01 1 1  ON 31
eH1_2                -1.053958e-01 1 1  ON 32
eH1_3                -4.994110e-02 1 1  ON 33
eH1_4                -6.629966e-04 1 1  ON 34
eH1_5                 3.500400e-02 1 1  ON 35
eH1_6                 9.570686e-02 1 1  ON 36
eH1_7                 1.583315e-01 1 1  ON 37
eH1_8                 1.916511e-01 1 1  ON 38
eH1_9                 8.922212e-02 1 1  ON 39
eH2_0                -2.568439e-01 1 1  ON 40
eH2_1                -1.515720e-01 1 1  ON 41
eH2_2                -1.029133e-01 1 1  ON 42
eH2_3                -4.756541e-02 1 1  ON 43
eH2_4                 1.774411e-03 1 1  ON 44
eH2_5                 3.748316e-02 1 1  ON 45
eH2_6                 9.956123e-02 1 1  ON 46
eH2_7                 1.599962e-01 1 1  ON 47
eH2_8                 1.960297e-01 1 1  ON 48
eH2_9                 7.798119e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5176e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8049
    reference variance = 0.209396
====================================================
  Execution time = 2.0808e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4338e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343354322767
                                         uncertainty =       0.004326289699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343354322767
                                         uncertainty =       0.004326289699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414354156
  error estimate for blocks of size 2^( 2) =       0.000426695241
  error estimate for blocks of size 2^( 3) =       0.000439516917
  error estimate for blocks of size 2^( 4) =       0.000451326876
  error estimate for blocks of size 2^( 5) =       0.000461243912
  error estimate for blocks of size 2^( 6) =       0.000468302941
  error estimate for blocks of size 2^( 7) =       0.000471165670

      target function =                  N/A
              le_mean =     -16.906365325228
             les_mean =     286.168567070857
             stat err =       0.000463009850
             autocorr =       1.248639479734
              std dev =       0.585985266440
             le_variance =       0.343378732485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636532523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365325228       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906365326855       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906365333443       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365335412       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365337207       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365337049       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365335408       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906365335801       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.398346e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365325228       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906365325635       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906365327284       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365327777       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365328226       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365328186       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365327777       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906365327875       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 5.997433e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365325228       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906365325330       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906365325742       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365325865       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365325978       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365325967       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365325865       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906365325889       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.499457e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6300e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.118547e-01 1 1  ON 0
 uu_1                 1.444288e-01 1 1  ON 1
 uu_2                 4.256680e-02 1 1  ON 2
 uu_3                -2.040485e-02 1 1  ON 3
 uu_4                -6.650358e-02 1 1  ON 4
 uu_5                -1.022384e-01 1 1  ON 5
 uu_6                -1.308789e-01 1 1  ON 6
 uu_7                -1.456293e-01 1 1  ON 7
 uu_8                -1.383926e-01 1 1  ON 8
 uu_9                -1.104638e-01 1 1  ON 9
 ud_0                 4.526317e-01 1 1  ON 10
 ud_1                 1.864434e-01 1 1  ON 11
 ud_2                 6.530151e-02 1 1  ON 12
 ud_3                -6.584823e-03 1 1  ON 13
 ud_4                -6.420845e-02 1 1  ON 14
 ud_5                -1.064404e-01 1 1  ON 15
 ud_6                -1.346210e-01 1 1  ON 16
 ud_7                -1.522421e-01 1 1  ON 17
 ud_8                -1.529164e-01 1 1  ON 18
 ud_9                -1.431062e-01 1 1  ON 19
 eO_0                -7.559292e-01 1 1  ON 20
 eO_1                -4.340972e-01 1 1  ON 21
 eO_2                -1.751885e-02 1 1  ON 22
 eO_3                 3.008483e-01 1 1  ON 23
 eO_4                 5.290562e-01 1 1  ON 24
 eO_5                 4.926775e-01 1 1  ON 25
 eO_6                 2.633743e-01 1 1  ON 26
 eO_7                -4.204695e-02 1 1  ON 27
 eO_8                -2.326761e-01 1 1  ON 28
 eO_9                -9.993972e-02 1 1  ON 29
eH1_0                -2.592716e-01 1 1  ON 30
eH1_1                -1.542813e-01 1 1  ON 31
eH1_2                -1.053960e-01 1 1  ON 32
eH1_3                -4.994127e-02 1 1  ON 33
eH1_4                -6.632339e-04 1 1  ON 34
eH1_5                 3.500408e-02 1 1  ON 35
eH1_6                 9.570699e-02 1 1  ON 36
eH1_7                 1.583317e-01 1 1  ON 37
eH1_8                 1.916512e-01 1 1  ON 38
eH1_9                 8.922239e-02 1 1  ON 39
eH2_0                -2.568442e-01 1 1  ON 40
eH2_1                -1.515721e-01 1 1  ON 41
eH2_2                -1.029134e-01 1 1  ON 42
eH2_3                -4.756549e-02 1 1  ON 43
eH2_4                 1.774285e-03 1 1  ON 44
eH2_5                 3.748318e-02 1 1  ON 45
eH2_6                 9.956082e-02 1 1  ON 46
eH2_7                 1.599961e-01 1 1  ON 47
eH2_8                 1.960301e-01 1 1  ON 48
eH2_9                 7.798179e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.84
    reference variance = 0.338261
====================================================
  Execution time = 2.0032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4325e-01
  Total weights = 2.0000e+06
  Execution time = 1.8671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342998111105
                                         uncertainty =       0.005231114771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342998111105
                                         uncertainty =       0.005231114771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414279512
  error estimate for blocks of size 2^( 2) =       0.000426549391
  error estimate for blocks of size 2^( 3) =       0.000439190121
  error estimate for blocks of size 2^( 4) =       0.000451238858
  error estimate for blocks of size 2^( 5) =       0.000461310164
  error estimate for blocks of size 2^( 6) =       0.000469957162
  error estimate for blocks of size 2^( 7) =       0.000474975007

      target function =                  N/A
              le_mean =     -16.906369402254
             les_mean =     286.168581222085
             stat err =       0.000464370298
             autocorr =       1.256440579320
              std dev =       0.585879704571
             le_variance =       0.343255028229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342996667642
                                         uncertainty =       0.005231086637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342996667642
                                         uncertainty =       0.005231086637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414278640
  error estimate for blocks of size 2^( 2) =       0.000426548537
  error estimate for blocks of size 2^( 3) =       0.000439189278
  error estimate for blocks of size 2^( 4) =       0.000451238031
  error estimate for blocks of size 2^( 5) =       0.000461309341
  error estimate for blocks of size 2^( 6) =       0.000469956321
  error estimate for blocks of size 2^( 7) =       0.000474974117

      target function =                  N/A
              le_mean =     -16.906369430165
             les_mean =     286.168580720942
             stat err =       0.000464369453
             autocorr =       1.256441295420
              std dev =       0.585878471482
             le_variance =       0.343253583346

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342997387041
                                         uncertainty =       0.005231100650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342997387041
                                         uncertainty =       0.005231100650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414279075
  error estimate for blocks of size 2^( 2) =       0.000426548963
  error estimate for blocks of size 2^( 3) =       0.000439189698
  error estimate for blocks of size 2^( 4) =       0.000451238443
  error estimate for blocks of size 2^( 5) =       0.000461309751
  error estimate for blocks of size 2^( 6) =       0.000469956740
  error estimate for blocks of size 2^( 7) =       0.000474974560

      target function =                  N/A
              le_mean =     -16.906369416249
             les_mean =     286.168580970518
             stat err =       0.000464369874
             autocorr =       1.256440938538
              std dev =       0.585879086034
             le_variance =       0.343254303453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342998020521
                                         uncertainty =       0.005231113004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342998020521
                                         uncertainty =       0.005231113004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414279457
  error estimate for blocks of size 2^( 2) =       0.000426549337
  error estimate for blocks of size 2^( 3) =       0.000439190068
  error estimate for blocks of size 2^( 4) =       0.000451238806
  error estimate for blocks of size 2^( 5) =       0.000461310112
  error estimate for blocks of size 2^( 6) =       0.000469957109
  error estimate for blocks of size 2^( 7) =       0.000474974951

      target function =                  N/A
              le_mean =     -16.906369404005
             les_mean =     286.168581190595
             stat err =       0.000464370245
             autocorr =       1.256440624256
              std dev =       0.585879627189
             le_variance =       0.343254937555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906369402254        initial
     9.5367e+01     9.5367e+02             2.3983e-06       -16.906369430165  <--
     3.8147e+02     3.8147e+03             5.9974e-07       -16.906369416249
     1.5259e+03     1.5259e+04             1.4995e-07       -16.906369404005

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.9375e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530128e-02 1 1  ON 12
 ud_3                -6.584176e-03 1 1  ON 13
 ud_4                -6.420806e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751727e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994056e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639456e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922318e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515723e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773907e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955958e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798359e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8947
    reference variance = 0.193313
====================================================
  Execution time = 2.0440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3643e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336505816215
                                         uncertainty =       0.003158230079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336505816215
                                         uncertainty =       0.003158230079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410138116
  error estimate for blocks of size 2^( 2) =       0.000422483382
  error estimate for blocks of size 2^( 3) =       0.000435293827
  error estimate for blocks of size 2^( 4) =       0.000445589034
  error estimate for blocks of size 2^( 5) =       0.000454581868
  error estimate for blocks of size 2^( 6) =       0.000460848504
  error estimate for blocks of size 2^( 7) =       0.000463815450

      target function =                  N/A
              le_mean =     -16.907366193306
             les_mean =     286.195457974222
             stat err =       0.000456208714
             autocorr =       1.237276857966
              std dev =       0.580022885660
             le_variance =       0.336426547890


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690736619331e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907366193306       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907366184382       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907366189030       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907366193786       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907366192903       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907366203985       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907366199708       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907366204688       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 6.529308e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907366193306       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907366191063       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907366192219       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907366193393       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907366193146       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907366195996       residual = 2.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907366194916       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907366196134       residual = 1.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.635048e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907366193306       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907366192745       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907366193033       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907366193326       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907366193262       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907366193980       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907366193709       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907366194011       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.089322e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201443 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5940e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.118544e-01 1 1  ON 0
 uu_1                 1.444300e-01 1 1  ON 1
 uu_2                 4.256642e-02 1 1  ON 2
 uu_3                -2.040576e-02 1 1  ON 3
 uu_4                -6.650288e-02 1 1  ON 4
 uu_5                -1.022386e-01 1 1  ON 5
 uu_6                -1.308792e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383931e-01 1 1  ON 8
 uu_9                -1.104647e-01 1 1  ON 9
 ud_0                 4.526300e-01 1 1  ON 10
 ud_1                 1.864440e-01 1 1  ON 11
 ud_2                 6.530247e-02 1 1  ON 12
 ud_3                -6.583524e-03 1 1  ON 13
 ud_4                -6.420748e-02 1 1  ON 14
 ud_5                -1.064387e-01 1 1  ON 15
 ud_6                -1.346203e-01 1 1  ON 16
 ud_7                -1.522419e-01 1 1  ON 17
 ud_8                -1.529182e-01 1 1  ON 18
 ud_9                -1.431075e-01 1 1  ON 19
 eO_0                -7.559292e-01 1 1  ON 20
 eO_1                -4.340957e-01 1 1  ON 21
 eO_2                -1.751592e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290560e-01 1 1  ON 24
 eO_5                 4.926760e-01 1 1  ON 25
 eO_6                 2.633753e-01 1 1  ON 26
 eO_7                -4.204688e-02 1 1  ON 27
 eO_8                -2.326777e-01 1 1  ON 28
 eO_9                -9.994193e-02 1 1  ON 29
eH1_0                -2.592720e-01 1 1  ON 30
eH1_1                -1.542813e-01 1 1  ON 31
eH1_2                -1.053967e-01 1 1  ON 32
eH1_3                -4.994278e-02 1 1  ON 33
eH1_4                -6.639023e-04 1 1  ON 34
eH1_5                 3.500352e-02 1 1  ON 35
eH1_6                 9.570710e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916525e-01 1 1  ON 38
eH1_9                 8.922435e-02 1 1  ON 39
eH2_0                -2.568459e-01 1 1  ON 40
eH2_1                -1.515729e-01 1 1  ON 41
eH2_2                -1.029137e-01 1 1  ON 42
eH2_3                -4.756586e-02 1 1  ON 43
eH2_4                 1.773629e-03 1 1  ON 44
eH2_5                 3.748338e-02 1 1  ON 45
eH2_6                 9.955903e-02 1 1  ON 46
eH2_7                 1.599960e-01 1 1  ON 47
eH2_8                 1.960322e-01 1 1  ON 48
eH2_9                 7.798510e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9461
    reference variance = 0.252775
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3903e-01
  Total weights = 2.0000e+06
  Execution time = 1.8714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339099861047
                                         uncertainty =       0.003617683170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339099861047
                                         uncertainty =       0.003617683170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411723124
  error estimate for blocks of size 2^( 2) =       0.000424482155
  error estimate for blocks of size 2^( 3) =       0.000438235060
  error estimate for blocks of size 2^( 4) =       0.000450606352
  error estimate for blocks of size 2^( 5) =       0.000461901085
  error estimate for blocks of size 2^( 6) =       0.000469895187
  error estimate for blocks of size 2^( 7) =       0.000476921684

      target function =                  N/A
              le_mean =     -16.905440190125
             les_mean =     286.132939713837
             stat err =       0.000464831077
             autocorr =       1.274617254650
              std dev =       0.582264425723
             le_variance =       0.339031861462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339096095728
                                         uncertainty =       0.003617647315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339096095728
                                         uncertainty =       0.003617647315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411720839
  error estimate for blocks of size 2^( 2) =       0.000424479966
  error estimate for blocks of size 2^( 3) =       0.000438232964
  error estimate for blocks of size 2^( 4) =       0.000450604299
  error estimate for blocks of size 2^( 5) =       0.000461899133
  error estimate for blocks of size 2^( 6) =       0.000469893414
  error estimate for blocks of size 2^( 7) =       0.000476919903

      target function =                  N/A
              le_mean =     -16.905440170355
             les_mean =     286.132935282890
             stat err =       0.000464829187
             autocorr =       1.274621035961
              std dev =       0.582261194794
             le_variance =       0.339028098963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339097955362
                                         uncertainty =       0.003617665021

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339097955362
                                         uncertainty =       0.003617665021

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411721968
  error estimate for blocks of size 2^( 2) =       0.000424481048
  error estimate for blocks of size 2^( 3) =       0.000438234000
  error estimate for blocks of size 2^( 4) =       0.000450605313
  error estimate for blocks of size 2^( 5) =       0.000461900097
  error estimate for blocks of size 2^( 6) =       0.000469894290
  error estimate for blocks of size 2^( 7) =       0.000476920783

      target function =                  N/A
              le_mean =     -16.905440180088
             les_mean =     286.132937470213
             stat err =       0.000464830121
             autocorr =       1.274619169677
              std dev =       0.582262790502
             le_variance =       0.339029957203

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339099622092
                                         uncertainty =       0.003617680894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339099622092
                                         uncertainty =       0.003617680894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411722979
  error estimate for blocks of size 2^( 2) =       0.000424482016
  error estimate for blocks of size 2^( 3) =       0.000438234927
  error estimate for blocks of size 2^( 4) =       0.000450606222
  error estimate for blocks of size 2^( 5) =       0.000461900961
  error estimate for blocks of size 2^( 6) =       0.000469895075
  error estimate for blocks of size 2^( 7) =       0.000476921571

      target function =                  N/A
              le_mean =     -16.905440188863
             les_mean =     286.132939432397
             stat err =       0.000464830957
             autocorr =       1.274617494804
              std dev =       0.582264220681
             le_variance =       0.339031622686


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905440190125        initial  <--
     2.3842e+01     2.3842e+02             6.5293e-06       -16.905440170355
     9.5367e+01     9.5367e+02             1.6350e-06       -16.905440180088
     3.8147e+02     3.8147e+03             4.0893e-07       -16.905440188863

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5178
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530128e-02 1 1  ON 12
 ud_3                -6.584176e-03 1 1  ON 13
 ud_4                -6.420806e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751727e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994056e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639456e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922318e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515723e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773907e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955958e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798359e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.0115
    reference variance = 0.234348
====================================================
  Execution time = 2.0284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4046e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340502612059
                                         uncertainty =       0.004029292531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340502612059
                                         uncertainty =       0.004029292531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412589032
  error estimate for blocks of size 2^( 2) =       0.000425389106
  error estimate for blocks of size 2^( 3) =       0.000438370044
  error estimate for blocks of size 2^( 4) =       0.000451557430
  error estimate for blocks of size 2^( 5) =       0.000463536724
  error estimate for blocks of size 2^( 6) =       0.000472477764
  error estimate for blocks of size 2^( 7) =       0.000478079786

      target function =                  N/A
              le_mean =     -16.906092567060
             les_mean =     286.156425134177
             stat err =       0.000466412926
             autocorr =       1.277926272143
              std dev =       0.583489004529
             le_variance =       0.340459418406


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609256706e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906092567060       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906092568676       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906092570540       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906092573091       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906092570791       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906092570998       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906092571770       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906092571946       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 8.010064e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906092567060       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906092567464       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906092567930       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906092568568       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906092567993       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906092568046       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906092568237       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906092568282       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.002611e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906092567060       residual = 8.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906092567161       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906092567278       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906092567437       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906092567299       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906092567306       residual = 6.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906092567353       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906092567364       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 5.006586e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5814e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040541e-02 1 1  ON 3
 uu_4                -6.650398e-02 1 1  ON 4
 uu_5                -1.022392e-01 1 1  ON 5
 uu_6                -1.308795e-01 1 1  ON 6
 uu_7                -1.456293e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530114e-02 1 1  ON 12
 ud_3                -6.584131e-03 1 1  ON 13
 ud_4                -6.420800e-02 1 1  ON 14
 ud_5                -1.064393e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522419e-01 1 1  ON 17
 ud_8                -1.529169e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751711e-02 1 1  ON 22
 eO_3                 3.008484e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633747e-01 1 1  ON 26
 eO_7                -4.204675e-02 1 1  ON 27
 eO_8                -2.326767e-01 1 1  ON 28
 eO_9                -9.994071e-02 1 1  ON 29
eH1_0                -2.592724e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994179e-02 1 1  ON 33
eH1_4                -6.640769e-04 1 1  ON 34
eH1_5                 3.500438e-02 1 1  ON 35
eH1_6                 9.570729e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916518e-01 1 1  ON 38
eH1_9                 8.922338e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515725e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756572e-02 1 1  ON 43
eH2_4                 1.773874e-03 1 1  ON 44
eH2_5                 3.748317e-02 1 1  ON 45
eH2_6                 9.955952e-02 1 1  ON 46
eH2_7                 1.599959e-01 1 1  ON 47
eH2_8                 1.960315e-01 1 1  ON 48
eH2_9                 7.798379e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9188
    reference variance = 0.178646
====================================================
  Execution time = 1.9864e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4636e-01
  Total weights = 2.0000e+06
  Execution time = 1.8685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346438043780
                                         uncertainty =       0.008959038953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346438043780
                                         uncertainty =       0.008959038953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416147847
  error estimate for blocks of size 2^( 2) =       0.000428715670
  error estimate for blocks of size 2^( 3) =       0.000442261840
  error estimate for blocks of size 2^( 4) =       0.000455072284
  error estimate for blocks of size 2^( 5) =       0.000465566063
  error estimate for blocks of size 2^( 6) =       0.000475262741
  error estimate for blocks of size 2^( 7) =       0.000481491958

      target function =                  N/A
              le_mean =     -16.905974934288
             les_mean =     286.158346365945
             stat err =       0.000469348261
             autocorr =       1.272023467020
              std dev =       0.588521928525
             le_variance =       0.346358060355

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346438352103
                                         uncertainty =       0.008959052989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346438352103
                                         uncertainty =       0.008959052989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416148032
  error estimate for blocks of size 2^( 2) =       0.000428715837
  error estimate for blocks of size 2^( 3) =       0.000442261993
  error estimate for blocks of size 2^( 4) =       0.000455072432
  error estimate for blocks of size 2^( 5) =       0.000465566222
  error estimate for blocks of size 2^( 6) =       0.000475262904
  error estimate for blocks of size 2^( 7) =       0.000481492101

      target function =                  N/A
              le_mean =     -16.905974931814
             les_mean =     286.158346590211
             stat err =       0.000469348415
             autocorr =       1.272023169424
              std dev =       0.588522190136
             le_variance =       0.346358368282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346438198237
                                         uncertainty =       0.008959045986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346438198237
                                         uncertainty =       0.008959045986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416147939
  error estimate for blocks of size 2^( 2) =       0.000428715754
  error estimate for blocks of size 2^( 3) =       0.000442261917
  error estimate for blocks of size 2^( 4) =       0.000455072358
  error estimate for blocks of size 2^( 5) =       0.000465566143
  error estimate for blocks of size 2^( 6) =       0.000475262823
  error estimate for blocks of size 2^( 7) =       0.000481492030

      target function =                  N/A
              le_mean =     -16.905974933047
             les_mean =     286.158346478240
             stat err =       0.000469348338
             autocorr =       1.272023317901
              std dev =       0.588522059581
             le_variance =       0.346358214614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346438063096
                                         uncertainty =       0.008959039832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346438063096
                                         uncertainty =       0.008959039832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416147858
  error estimate for blocks of size 2^( 2) =       0.000428715680
  error estimate for blocks of size 2^( 3) =       0.000442261850
  error estimate for blocks of size 2^( 4) =       0.000455072293
  error estimate for blocks of size 2^( 5) =       0.000465566073
  error estimate for blocks of size 2^( 6) =       0.000475262751
  error estimate for blocks of size 2^( 7) =       0.000481491967

      target function =                  N/A
              le_mean =     -16.905974934133
             les_mean =     286.158346379985
             stat err =       0.000469348271
             autocorr =       1.272023448370
              std dev =       0.588521944915
             le_variance =       0.346358079646


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905974934288        initial  <--
     2.3842e+02     2.3842e+03             8.0101e-07       -16.905974931814
     9.5367e+02     9.5367e+03             2.0026e-07       -16.905974933047
     3.8147e+03     3.8147e+04             5.0066e-08       -16.905974934133

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2474
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530128e-02 1 1  ON 12
 ud_3                -6.584176e-03 1 1  ON 13
 ud_4                -6.420806e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751727e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994056e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639456e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922318e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515723e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773907e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955958e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798359e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5077e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9126
    reference variance = 0.24968
====================================================
  Execution time = 2.0532e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3872e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338740284261
                                         uncertainty =       0.006861856697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338740284261
                                         uncertainty =       0.006861856697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411531617
  error estimate for blocks of size 2^( 2) =       0.000423691667
  error estimate for blocks of size 2^( 3) =       0.000436374707
  error estimate for blocks of size 2^( 4) =       0.000446986719
  error estimate for blocks of size 2^( 5) =       0.000457483748
  error estimate for blocks of size 2^( 6) =       0.000464342774
  error estimate for blocks of size 2^( 7) =       0.000467222538

      target function =                  N/A
              le_mean =     -16.905580303837
             les_mean =     286.137361783803
             stat err =       0.000459008945
             autocorr =       1.244044410312
              std dev =       0.581993594206
             le_variance =       0.338716543696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690558030384e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905580303837       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905580304133       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905580304374       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905580304517       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905580304470       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580304446       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905580304521       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905580304518       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 9.501227e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905580303837       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905580303911       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905580303971       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905580304007       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905580303994       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580303996       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905580304008       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905580304013       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.375318e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905580303837       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905580303855       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905580303870       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905580303879       residual = 9.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905580303871       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905580303898       residual = 6.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905580303843       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905580303876       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.938301e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206822 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6045e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256673e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530128e-02 1 1  ON 12
 ud_3                -6.584180e-03 1 1  ON 13
 ud_4                -6.420805e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751726e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204679e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994058e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639607e-04 1 1  ON 34
eH1_5                 3.500431e-02 1 1  ON 35
eH1_6                 9.570734e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922321e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756572e-02 1 1  ON 43
eH2_4                 1.773911e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955957e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798361e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9072
    reference variance = 0.225477
====================================================
  Execution time = 1.9801e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3974e-01
  Total weights = 2.0000e+06
  Execution time = 2.1202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709451734
                                         uncertainty =       0.004322811885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709451734
                                         uncertainty =       0.004322811885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412155135
  error estimate for blocks of size 2^( 2) =       0.000424669639
  error estimate for blocks of size 2^( 3) =       0.000437804814
  error estimate for blocks of size 2^( 4) =       0.000449723712
  error estimate for blocks of size 2^( 5) =       0.000459851258
  error estimate for blocks of size 2^( 6) =       0.000465996760
  error estimate for blocks of size 2^( 7) =       0.000470705419

      target function =                  N/A
              le_mean =     -16.906988962836
             les_mean =     286.186019330027
             stat err =       0.000461569287
             autocorr =       1.254158356649
              std dev =       0.582875381583
             le_variance =       0.339743710455

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709515873
                                         uncertainty =       0.004322812712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709515873
                                         uncertainty =       0.004322812712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412155174
  error estimate for blocks of size 2^( 2) =       0.000424669675
  error estimate for blocks of size 2^( 3) =       0.000437804847
  error estimate for blocks of size 2^( 4) =       0.000449723744
  error estimate for blocks of size 2^( 5) =       0.000459851289
  error estimate for blocks of size 2^( 6) =       0.000465996791
  error estimate for blocks of size 2^( 7) =       0.000470705452

      target function =                  N/A
              le_mean =     -16.906988962743
             les_mean =     286.186019391105
             stat err =       0.000461569319
             autocorr =       1.254158293196
              std dev =       0.582875436658
             le_variance =       0.339743774659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709483808
                                         uncertainty =       0.004322812298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709483808
                                         uncertainty =       0.004322812298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412155154
  error estimate for blocks of size 2^( 2) =       0.000424669657
  error estimate for blocks of size 2^( 3) =       0.000437804830
  error estimate for blocks of size 2^( 4) =       0.000449723728
  error estimate for blocks of size 2^( 5) =       0.000459851274
  error estimate for blocks of size 2^( 6) =       0.000465996775
  error estimate for blocks of size 2^( 7) =       0.000470705435

      target function =                  N/A
              le_mean =     -16.906988962789
             les_mean =     286.186019360570
             stat err =       0.000461569303
             autocorr =       1.254158324918
              std dev =       0.582875409124
             le_variance =       0.339743742562

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709455743
                                         uncertainty =       0.004322811936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339709455743
                                         uncertainty =       0.004322811936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412155137
  error estimate for blocks of size 2^( 2) =       0.000424669641
  error estimate for blocks of size 2^( 3) =       0.000437804816
  error estimate for blocks of size 2^( 4) =       0.000449723714
  error estimate for blocks of size 2^( 5) =       0.000459851260
  error estimate for blocks of size 2^( 6) =       0.000465996762
  error estimate for blocks of size 2^( 7) =       0.000470705421

      target function =                  N/A
              le_mean =     -16.906988962830
             les_mean =     286.186019333845
             stat err =       0.000461569289
             autocorr =       1.254158352683
              std dev =       0.582875385026
             le_variance =       0.339743714469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906988962836        initial  <--
     2.3842e+03     2.3842e+04             9.5012e-08       -16.906988962743
     9.5367e+03     9.5367e+04             2.3753e-08       -16.906988962789
     3.8147e+04     3.8147e+05             5.9383e-09       -16.906988962830

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0310
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530128e-02 1 1  ON 12
 ud_3                -6.584176e-03 1 1  ON 13
 ud_4                -6.420806e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751727e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994056e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639456e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922318e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515723e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773907e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955958e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798359e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7084e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8504
    reference variance = 0.13526
====================================================
  Execution time = 2.0858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4777e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347863411652
                                         uncertainty =       0.006217085875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347863411652
                                         uncertainty =       0.006217085875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416994462
  error estimate for blocks of size 2^( 2) =       0.000430186661
  error estimate for blocks of size 2^( 3) =       0.000443533919
  error estimate for blocks of size 2^( 4) =       0.000456329282
  error estimate for blocks of size 2^( 5) =       0.000468046579
  error estimate for blocks of size 2^( 6) =       0.000475751600
  error estimate for blocks of size 2^( 7) =       0.000479315837

      target function =                  N/A
              le_mean =     -16.905814322005
             les_mean =     286.154326478429
             stat err =       0.000469860825
             autocorr =       1.269632114466
              std dev =       0.589719223190
             le_variance =       0.347768762200


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581432201e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905814322005       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905814322024       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905814322012       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905814322012       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905814321993       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905814322027       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905814322036       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905814322047       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.002876e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905814322005       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905814322010       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905814322007       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905814321997       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905814321993       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905814322023       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905814322079       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905814322016       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.507192e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905814322005       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905814322006       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905814322006       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905814322005       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905814322005       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905814322006       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905814321913       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905814322432       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 6.267981e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209438 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6432e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530128e-02 1 1  ON 12
 ud_3                -6.584176e-03 1 1  ON 13
 ud_4                -6.420805e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751727e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994056e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639467e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922318e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515723e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773906e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955958e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798359e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9022
    reference variance = 0.279741
====================================================
  Execution time = 1.9834e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3644e-01
  Total weights = 2.0000e+06
  Execution time = 1.8700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336437117790
                                         uncertainty =       0.004202490964

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336437117790
                                         uncertainty =       0.004202490964

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410144462
  error estimate for blocks of size 2^( 2) =       0.000423031290
  error estimate for blocks of size 2^( 3) =       0.000436234533
  error estimate for blocks of size 2^( 4) =       0.000448725660
  error estimate for blocks of size 2^( 5) =       0.000457982917
  error estimate for blocks of size 2^( 6) =       0.000465079607
  error estimate for blocks of size 2^( 7) =       0.000469768726

      target function =                  N/A
              le_mean =     -16.905959376389
             les_mean =     286.147899226555
             stat err =       0.000460389228
             autocorr =       1.260017577741
              std dev =       0.580031860031
             le_variance =       0.336436958651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336437121135
                                         uncertainty =       0.004202491045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336437121135
                                         uncertainty =       0.004202491045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410144464
  error estimate for blocks of size 2^( 2) =       0.000423031292
  error estimate for blocks of size 2^( 3) =       0.000436234535
  error estimate for blocks of size 2^( 4) =       0.000448725662
  error estimate for blocks of size 2^( 5) =       0.000457982918
  error estimate for blocks of size 2^( 6) =       0.000465079609
  error estimate for blocks of size 2^( 7) =       0.000469768728

      target function =                  N/A
              le_mean =     -16.905959376392
             les_mean =     286.147899230003
             stat err =       0.000460389229
             autocorr =       1.260017574678
              std dev =       0.580031862916
             le_variance =       0.336436961998

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336437119462
                                         uncertainty =       0.004202491004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336437119462
                                         uncertainty =       0.004202491004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410144463
  error estimate for blocks of size 2^( 2) =       0.000423031291
  error estimate for blocks of size 2^( 3) =       0.000436234534
  error estimate for blocks of size 2^( 4) =       0.000448725661
  error estimate for blocks of size 2^( 5) =       0.000457982918
  error estimate for blocks of size 2^( 6) =       0.000465079608
  error estimate for blocks of size 2^( 7) =       0.000469768727

      target function =                  N/A
              le_mean =     -16.905959376391
             les_mean =     286.147899228279
             stat err =       0.000460389228
             autocorr =       1.260017576207
              std dev =       0.580031861474
             le_variance =       0.336436960325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336437117999
                                         uncertainty =       0.004202490969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336437117999
                                         uncertainty =       0.004202490969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410144462
  error estimate for blocks of size 2^( 2) =       0.000423031290
  error estimate for blocks of size 2^( 3) =       0.000436234533
  error estimate for blocks of size 2^( 4) =       0.000448725660
  error estimate for blocks of size 2^( 5) =       0.000457982917
  error estimate for blocks of size 2^( 6) =       0.000465079607
  error estimate for blocks of size 2^( 7) =       0.000469768726

      target function =                  N/A
              le_mean =     -16.905959376389
             les_mean =     286.147899226770
             stat err =       0.000460389228
             autocorr =       1.260017577539
              std dev =       0.580031860211
             le_variance =       0.336436958860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905959376389        initial
     2.3842e+04     2.3842e+05             1.0029e-08       -16.905959376392  <--
     9.5367e+04     9.5367e+05             2.5072e-09       -16.905959376391
     3.8147e+05     3.8147e+06             6.2680e-10       -16.905959376389

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 2.9216e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530127e-02 1 1  ON 12
 ud_3                -6.584177e-03 1 1  ON 13
 ud_4                -6.420805e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751727e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204679e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994057e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639500e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922319e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515723e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773903e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955957e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798360e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5657e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8737
    reference variance = 0.183643
====================================================
  Execution time = 2.0468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4037e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340352718897
                                         uncertainty =       0.004424889596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340352718897
                                         uncertainty =       0.004424889596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412532191
  error estimate for blocks of size 2^( 2) =       0.000424995625
  error estimate for blocks of size 2^( 3) =       0.000437580482
  error estimate for blocks of size 2^( 4) =       0.000449523828
  error estimate for blocks of size 2^( 5) =       0.000459469474
  error estimate for blocks of size 2^( 6) =       0.000467574079
  error estimate for blocks of size 2^( 7) =       0.000472652645

      target function =                  N/A
              le_mean =     -16.906175882849
             les_mean =     286.159148428127
             stat err =       0.000462305006
             autocorr =       1.255860807402
              std dev =       0.583408618807
             le_variance =       0.340365616498


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617588285e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906175882849       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906175883054       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906175883178       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906175883125       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906175883075       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906175883077       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906175883108       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.957142e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906175882849       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906175882900       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906175882931       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906175882919       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906175882905       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906175882906       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906175882928       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.892914e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906175882849       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906175882861       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906175882869       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906175882866       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906175882797       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906175882850       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906175882871       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.473232e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211778 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6016e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256673e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530127e-02 1 1  ON 12
 ud_3                -6.584177e-03 1 1  ON 13
 ud_4                -6.420805e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751726e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204679e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994057e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639498e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922320e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756572e-02 1 1  ON 43
eH2_4                 1.773905e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955957e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798361e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8452
    reference variance = 0.26887
====================================================
  Execution time = 2.0001e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3860e-01
  Total weights = 2.0000e+06
  Execution time = 1.8653e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338719773776
                                         uncertainty =       0.004023125131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338719773776
                                         uncertainty =       0.004023125131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411463383
  error estimate for blocks of size 2^( 2) =       0.000424013748
  error estimate for blocks of size 2^( 3) =       0.000437214474
  error estimate for blocks of size 2^( 4) =       0.000449956941
  error estimate for blocks of size 2^( 5) =       0.000461506680
  error estimate for blocks of size 2^( 6) =       0.000470041436
  error estimate for blocks of size 2^( 7) =       0.000474887389

      target function =                  N/A
              le_mean =     -16.906264254979
             les_mean =     286.160375121406
             stat err =       0.000464098111
             autocorr =       1.272205347402
              std dev =       0.581897097033
             le_variance =       0.338604231535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338719800604
                                         uncertainty =       0.004023125671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338719800604
                                         uncertainty =       0.004023125671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411463400
  error estimate for blocks of size 2^( 2) =       0.000424013763
  error estimate for blocks of size 2^( 3) =       0.000437214489
  error estimate for blocks of size 2^( 4) =       0.000449956954
  error estimate for blocks of size 2^( 5) =       0.000461506694
  error estimate for blocks of size 2^( 6) =       0.000470041449
  error estimate for blocks of size 2^( 7) =       0.000474887402

      target function =                  N/A
              le_mean =     -16.906264254758
             les_mean =     286.160375140777
             stat err =       0.000464098125
             autocorr =       1.272205320206
              std dev =       0.581897120083
             le_variance =       0.338604258361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338719787190
                                         uncertainty =       0.004023125401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338719787190
                                         uncertainty =       0.004023125401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411463391
  error estimate for blocks of size 2^( 2) =       0.000424013755
  error estimate for blocks of size 2^( 3) =       0.000437214482
  error estimate for blocks of size 2^( 4) =       0.000449956948
  error estimate for blocks of size 2^( 5) =       0.000461506687
  error estimate for blocks of size 2^( 6) =       0.000470041442
  error estimate for blocks of size 2^( 7) =       0.000474887395

      target function =                  N/A
              le_mean =     -16.906264254869
             les_mean =     286.160375131092
             stat err =       0.000464098118
             autocorr =       1.272205333804
              std dev =       0.581897108558
             le_variance =       0.338604244948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338719775452
                                         uncertainty =       0.004023125165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338719775452
                                         uncertainty =       0.004023125165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411463384
  error estimate for blocks of size 2^( 2) =       0.000424013749
  error estimate for blocks of size 2^( 3) =       0.000437214475
  error estimate for blocks of size 2^( 4) =       0.000449956942
  error estimate for blocks of size 2^( 5) =       0.000461506681
  error estimate for blocks of size 2^( 6) =       0.000470041437
  error estimate for blocks of size 2^( 7) =       0.000474887390

      target function =                  N/A
              le_mean =     -16.906264254965
             les_mean =     286.160375122617
             stat err =       0.000464098112
             autocorr =       1.272205345710
              std dev =       0.581897098473
             le_variance =       0.338604233212


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906264254979        initial  <--
     5.9605e+03     5.9605e+04             3.9571e-08       -16.906264254758
     2.3842e+04     2.3842e+05             9.8929e-09       -16.906264254869
     9.5367e+04     9.5367e+05             2.4732e-09       -16.906264254965

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3985
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530127e-02 1 1  ON 12
 ud_3                -6.584177e-03 1 1  ON 13
 ud_4                -6.420805e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751727e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204679e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994057e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639500e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922319e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515723e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773903e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955957e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798360e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5428e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8928
    reference variance = 0.338236
====================================================
  Execution time = 2.0670e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4391e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343945779970
                                         uncertainty =       0.005310324710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343945779970
                                         uncertainty =       0.005310324710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414672245
  error estimate for blocks of size 2^( 2) =       0.000427069908
  error estimate for blocks of size 2^( 3) =       0.000439557684
  error estimate for blocks of size 2^( 4) =       0.000451478566
  error estimate for blocks of size 2^( 5) =       0.000462381424
  error estimate for blocks of size 2^( 6) =       0.000469129811
  error estimate for blocks of size 2^( 7) =       0.000475002602

      target function =                  N/A
              le_mean =     -16.906923883704
             les_mean =     286.187981179185
             stat err =       0.000464498101
             autocorr =       1.254752151074
              std dev =       0.586435113007
             le_variance =       0.343906141767


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690692388370e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906923883704       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906923883714       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906923883708       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906923883700       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906923883700       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906923883695       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906923883700       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906923883783       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.327077e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906923883704       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906923883707       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906923883705       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906923883705       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906923883714       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906923883704       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906923883712       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906923883561       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 8.317695e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906923883704       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906923883705       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906923883705       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906923883705       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906923883753       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906923883480       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906923883774       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906923883781       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.079424e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.214384 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6233e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530127e-02 1 1  ON 12
 ud_3                -6.584177e-03 1 1  ON 13
 ud_4                -6.420805e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751727e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204679e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994057e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639498e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922319e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515723e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773903e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955957e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798360e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9391
    reference variance = 0.216038
====================================================
  Execution time = 1.9914e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3300e-01
  Total weights = 2.0000e+06
  Execution time = 1.8628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333066349606
                                         uncertainty =       0.003378881743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333066349606
                                         uncertainty =       0.003378881743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408043332
  error estimate for blocks of size 2^( 2) =       0.000420735985
  error estimate for blocks of size 2^( 3) =       0.000433665705
  error estimate for blocks of size 2^( 4) =       0.000445122134
  error estimate for blocks of size 2^( 5) =       0.000455666502
  error estimate for blocks of size 2^( 6) =       0.000463780745
  error estimate for blocks of size 2^( 7) =       0.000468611164

      target function =                  N/A
              le_mean =     -16.906407697979
             les_mean =     286.159619805355
             stat err =       0.000458295136
             autocorr =       1.261472901513
              std dev =       0.577060414154
             le_variance =       0.332998721583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333066349700
                                         uncertainty =       0.003378881763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333066349700
                                         uncertainty =       0.003378881763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408043332
  error estimate for blocks of size 2^( 2) =       0.000420735985
  error estimate for blocks of size 2^( 3) =       0.000433665705
  error estimate for blocks of size 2^( 4) =       0.000445122134
  error estimate for blocks of size 2^( 5) =       0.000455666502
  error estimate for blocks of size 2^( 6) =       0.000463780745
  error estimate for blocks of size 2^( 7) =       0.000468611164

      target function =                  N/A
              le_mean =     -16.906407697986
             les_mean =     286.159619805699
             stat err =       0.000458295136
             autocorr =       1.261472901194
              std dev =       0.577060414236
             le_variance =       0.332998721678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333066349653
                                         uncertainty =       0.003378881753

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333066349653
                                         uncertainty =       0.003378881753

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408043332
  error estimate for blocks of size 2^( 2) =       0.000420735985
  error estimate for blocks of size 2^( 3) =       0.000433665705
  error estimate for blocks of size 2^( 4) =       0.000445122134
  error estimate for blocks of size 2^( 5) =       0.000455666502
  error estimate for blocks of size 2^( 6) =       0.000463780745
  error estimate for blocks of size 2^( 7) =       0.000468611164

      target function =                  N/A
              le_mean =     -16.906407697982
             les_mean =     286.159619805527
             stat err =       0.000458295136
             autocorr =       1.261472901355
              std dev =       0.577060414195
             le_variance =       0.332998721631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333066349612
                                         uncertainty =       0.003378881744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333066349612
                                         uncertainty =       0.003378881744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408043332
  error estimate for blocks of size 2^( 2) =       0.000420735985
  error estimate for blocks of size 2^( 3) =       0.000433665705
  error estimate for blocks of size 2^( 4) =       0.000445122134
  error estimate for blocks of size 2^( 5) =       0.000455666502
  error estimate for blocks of size 2^( 6) =       0.000463780745
  error estimate for blocks of size 2^( 7) =       0.000468611164

      target function =                  N/A
              le_mean =     -16.906407697979
             les_mean =     286.159619805377
             stat err =       0.000458295136
             autocorr =       1.261472901492
              std dev =       0.577060414159
             le_variance =       0.332998721589


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906407697979        initial
     5.9605e+04     5.9605e+05             3.3271e-09       -16.906407697986  <--
     2.3842e+05     2.3842e+06             8.3177e-10       -16.906407697982
     9.5367e+05     9.5367e+06             2.0794e-10       -16.906407697979

*****************************************************************************
Applying the update for shift_i =   5.9605e+04     and shift_s =   5.9605e+05
*****************************************************************************

  Execution time = 2.9295e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530127e-02 1 1  ON 12
 ud_3                -6.584176e-03 1 1  ON 13
 ud_4                -6.420805e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751726e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204679e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994057e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639493e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922319e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515723e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773903e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955957e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798360e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5539e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.918
    reference variance = 0.182009
====================================================
  Execution time = 2.0470e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3695e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337083037256
                                         uncertainty =       0.003096239779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337083037256
                                         uncertainty =       0.003096239779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410458394
  error estimate for blocks of size 2^( 2) =       0.000423232083
  error estimate for blocks of size 2^( 3) =       0.000435669859
  error estimate for blocks of size 2^( 4) =       0.000447967096
  error estimate for blocks of size 2^( 5) =       0.000457352349
  error estimate for blocks of size 2^( 6) =       0.000464216440
  error estimate for blocks of size 2^( 7) =       0.000469263147

      target function =                  N/A
              le_mean =     -16.906296829412
             les_mean =     286.159824502669
             stat err =       0.000459699758
             autocorr =       1.254325544378
              std dev =       0.580475828050
             le_variance =       0.336952186950


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629682941e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906296829412       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906296829469       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906296829497       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906296829492       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906296829472       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906296829453       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906296829465       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906296829476       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.201448e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906296829412       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906296829426       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906296829434       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906296829433       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906296829426       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906296829421       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906296829435       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906296829399       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.003624e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906296829412       residual = 8.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906296829416       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906296829418       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906296829419       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906296829416       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906296829463       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906296829350       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906296829578       residual = 3.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 7.509064e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.217023 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5963e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256673e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530128e-02 1 1  ON 12
 ud_3                -6.584174e-03 1 1  ON 13
 ud_4                -6.420805e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751726e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204679e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994057e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639478e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922319e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773903e-03 1 1  ON 44
eH2_5                 3.748326e-02 1 1  ON 45
eH2_6                 9.955957e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798361e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9125
    reference variance = 0.245865
====================================================
  Execution time = 1.9859e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3650e-01
  Total weights = 2.0000e+06
  Execution time = 1.8630e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525683770
                                         uncertainty =       0.002595291086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525683770
                                         uncertainty =       0.002595291086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410185565
  error estimate for blocks of size 2^( 2) =       0.000423315480
  error estimate for blocks of size 2^( 3) =       0.000436680948
  error estimate for blocks of size 2^( 4) =       0.000449523470
  error estimate for blocks of size 2^( 5) =       0.000461333259
  error estimate for blocks of size 2^( 6) =       0.000471891982
  error estimate for blocks of size 2^( 7) =       0.000481646477

      target function =                  N/A
              le_mean =     -16.906342516749
             les_mean =     286.160921521632
             stat err =       0.000466098797
             autocorr =       1.291205053877
              std dev =       0.580089989778
             le_variance =       0.336504396241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525674484
                                         uncertainty =       0.002595291011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525674484
                                         uncertainty =       0.002595291011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410185560
  error estimate for blocks of size 2^( 2) =       0.000423315475
  error estimate for blocks of size 2^( 3) =       0.000436680942
  error estimate for blocks of size 2^( 4) =       0.000449523465
  error estimate for blocks of size 2^( 5) =       0.000461333254
  error estimate for blocks of size 2^( 6) =       0.000471891977
  error estimate for blocks of size 2^( 7) =       0.000481646472

      target function =                  N/A
              le_mean =     -16.906342516756
             les_mean =     286.160921512567
             stat err =       0.000466098792
             autocorr =       1.291205061753
              std dev =       0.580089981776
             le_variance =       0.336504386957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525679127
                                         uncertainty =       0.002595291049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525679127
                                         uncertainty =       0.002595291049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410185563
  error estimate for blocks of size 2^( 2) =       0.000423315477
  error estimate for blocks of size 2^( 3) =       0.000436680945
  error estimate for blocks of size 2^( 4) =       0.000449523467
  error estimate for blocks of size 2^( 5) =       0.000461333256
  error estimate for blocks of size 2^( 6) =       0.000471891979
  error estimate for blocks of size 2^( 7) =       0.000481646475

      target function =                  N/A
              le_mean =     -16.906342516752
             les_mean =     286.160921517100
             stat err =       0.000466098794
             autocorr =       1.291205057809
              std dev =       0.580089985777
             le_variance =       0.336504391599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525683190
                                         uncertainty =       0.002595291081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336525683190
                                         uncertainty =       0.002595291081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410185565
  error estimate for blocks of size 2^( 2) =       0.000423315480
  error estimate for blocks of size 2^( 3) =       0.000436680948
  error estimate for blocks of size 2^( 4) =       0.000449523470
  error estimate for blocks of size 2^( 5) =       0.000461333258
  error estimate for blocks of size 2^( 6) =       0.000471891982
  error estimate for blocks of size 2^( 7) =       0.000481646477

      target function =                  N/A
              le_mean =     -16.906342516750
             les_mean =     286.160921521066
             stat err =       0.000466098797
             autocorr =       1.291205054365
              std dev =       0.580089989278
             le_variance =       0.336504395661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906342516749        initial
     1.4901e+04     1.4901e+05             1.2014e-08       -16.906342516756  <--
     5.9605e+04     5.9605e+05             3.0036e-09       -16.906342516752
     2.3842e+05     2.3842e+06             7.5091e-10       -16.906342516750

*****************************************************************************
Applying the update for shift_i =   1.4901e+04     and shift_s =   1.4901e+05
*****************************************************************************

  Execution time = 2.9245e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256673e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530128e-02 1 1  ON 12
 ud_3                -6.584170e-03 1 1  ON 13
 ud_4                -6.420805e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751726e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204679e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994058e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639433e-04 1 1  ON 34
eH1_5                 3.500432e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922320e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756571e-02 1 1  ON 43
eH2_4                 1.773904e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955957e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798362e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5215e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8628
    reference variance = 0.233814
====================================================
  Execution time = 2.0440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4900e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349073244038
                                         uncertainty =       0.013360009889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349073244038
                                         uncertainty =       0.013360009889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417729539
  error estimate for blocks of size 2^( 2) =       0.000430269989
  error estimate for blocks of size 2^( 3) =       0.000443031768
  error estimate for blocks of size 2^( 4) =       0.000455384512
  error estimate for blocks of size 2^( 5) =       0.000466257103
  error estimate for blocks of size 2^( 6) =       0.000474870519
  error estimate for blocks of size 2^( 7) =       0.000480868662

      target function =                  N/A
              le_mean =     -16.906726033559
             les_mean =     286.186380934276
             stat err =       0.000469345199
             autocorr =       1.262392445395
              std dev =       0.590758778986
             le_variance =       0.348995934949


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690672603356e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906726033559       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906726033483       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906726033416       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906726033402       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906726033393       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906726033374       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906726033418       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906726033440       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.952962e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906726033559       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906726033540       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906726033523       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906726033521       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906726033517       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906726033532       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906726033529       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906726033505       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.488248e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906726033559       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906726033554       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906726033550       residual = 9.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906726033560       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906726033548       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906726033546       residual = 7.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906726033519       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906726033563       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.720625e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.219681 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6090e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444301e-01 1 1  ON 1
 uu_2                 4.256673e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650396e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530129e-02 1 1  ON 12
 ud_3                -6.584171e-03 1 1  ON 13
 ud_4                -6.420804e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994059e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994176e-02 1 1  ON 33
eH1_4                -6.639457e-04 1 1  ON 34
eH1_5                 3.500431e-02 1 1  ON 35
eH1_6                 9.570735e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922321e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756572e-02 1 1  ON 43
eH2_4                 1.773903e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955956e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798363e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.179424
====================================================
  Execution time = 2.0151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4017e-01
  Total weights = 2.0000e+06
  Execution time = 1.8691e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340177159933
                                         uncertainty =       0.003198321803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340177159933
                                         uncertainty =       0.003198321803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412413451
  error estimate for blocks of size 2^( 2) =       0.000425260616
  error estimate for blocks of size 2^( 3) =       0.000437881238
  error estimate for blocks of size 2^( 4) =       0.000449872887
  error estimate for blocks of size 2^( 5) =       0.000460966656
  error estimate for blocks of size 2^( 6) =       0.000469820092
  error estimate for blocks of size 2^( 7) =       0.000475298501

      target function =                  N/A
              le_mean =     -16.906282673551
             les_mean =     286.162563377249
             stat err =       0.000463989534
             autocorr =       1.265758130607
              std dev =       0.583240695887
             le_variance =       0.340169709339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340177146296
                                         uncertainty =       0.003198321887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340177146296
                                         uncertainty =       0.003198321887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412413443
  error estimate for blocks of size 2^( 2) =       0.000425260608
  error estimate for blocks of size 2^( 3) =       0.000437881231
  error estimate for blocks of size 2^( 4) =       0.000449872881
  error estimate for blocks of size 2^( 5) =       0.000460966650
  error estimate for blocks of size 2^( 6) =       0.000469820086
  error estimate for blocks of size 2^( 7) =       0.000475298495

      target function =                  N/A
              le_mean =     -16.906282673567
             les_mean =     286.162563364175
             stat err =       0.000463989528
             autocorr =       1.265758150485
              std dev =       0.583240684191
             le_variance =       0.340169695695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340177153114
                                         uncertainty =       0.003198321845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340177153114
                                         uncertainty =       0.003198321845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412413447
  error estimate for blocks of size 2^( 2) =       0.000425260612
  error estimate for blocks of size 2^( 3) =       0.000437881235
  error estimate for blocks of size 2^( 4) =       0.000449872884
  error estimate for blocks of size 2^( 5) =       0.000460966653
  error estimate for blocks of size 2^( 6) =       0.000469820089
  error estimate for blocks of size 2^( 7) =       0.000475298498

      target function =                  N/A
              le_mean =     -16.906282673559
             les_mean =     286.162563370711
             stat err =       0.000463989531
             autocorr =       1.265758140548
              std dev =       0.583240690039
             le_variance =       0.340169702517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340177159081
                                         uncertainty =       0.003198321809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340177159081
                                         uncertainty =       0.003198321809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412413451
  error estimate for blocks of size 2^( 2) =       0.000425260615
  error estimate for blocks of size 2^( 3) =       0.000437881238
  error estimate for blocks of size 2^( 4) =       0.000449872887
  error estimate for blocks of size 2^( 5) =       0.000460966656
  error estimate for blocks of size 2^( 6) =       0.000469820091
  error estimate for blocks of size 2^( 7) =       0.000475298500

      target function =                  N/A
              le_mean =     -16.906282673552
             les_mean =     286.162563376432
             stat err =       0.000463989534
             autocorr =       1.265758131843
              std dev =       0.583240695156
             le_variance =       0.340169708486


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906282673551        initial
     3.7253e+03     3.7253e+04             5.9530e-08       -16.906282673567  <--
     1.4901e+04     1.4901e+05             1.4882e-08       -16.906282673559
     5.9605e+04     5.9605e+05             3.7206e-09       -16.906282673552

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 2.9574e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584174e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994061e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639528e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922323e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773899e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798367e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5676e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9256
    reference variance = 0.680194
====================================================
  Execution time = 2.2729e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.4343e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343450091892
                                         uncertainty =       0.005362557522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343450091892
                                         uncertainty =       0.005362557522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414382593
  error estimate for blocks of size 2^( 2) =       0.000426605363
  error estimate for blocks of size 2^( 3) =       0.000439549944
  error estimate for blocks of size 2^( 4) =       0.000450409614
  error estimate for blocks of size 2^( 5) =       0.000459991441
  error estimate for blocks of size 2^( 6) =       0.000465304519
  error estimate for blocks of size 2^( 7) =       0.000470153348

      target function =                  N/A
              le_mean =     -16.907722121132
             les_mean =     286.214493020688
             stat err =       0.000461464731
             autocorr =       1.240149435486
              std dev =       0.586025483225
             le_variance =       0.343425866989


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690772212113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907722121132       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907722121309       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907722121580       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907722122059       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907722122712       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907722122817       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907722122356       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907722122433       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+02 is 2.437554e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907722121132       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907722121176       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907722121244       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907722121363       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907722121530       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907722121558       residual = 7.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907722121437       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907722121457       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 6.094022e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907722121132       residual = 6.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907722121143       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907722121160       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907722121188       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907722121231       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907722121232       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907722121200       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907722121214       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.523514e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.222440 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8178e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256673e-02 1 1  ON 2
 uu_3                -2.040528e-02 1 1  ON 3
 uu_4                -6.650398e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456295e-01 1 1  ON 7
 uu_8                -1.383925e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526303e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530133e-02 1 1  ON 12
 ud_3                -6.584158e-03 1 1  ON 13
 ud_4                -6.420801e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204681e-02 1 1  ON 27
 eO_8                -2.326767e-01 1 1  ON 28
 eO_9                -9.994065e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994180e-02 1 1  ON 33
eH1_4                -6.639520e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570740e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922327e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756574e-02 1 1  ON 43
eH2_4                 1.773907e-03 1 1  ON 44
eH2_5                 3.748328e-02 1 1  ON 45
eH2_6                 9.955953e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960314e-01 1 1  ON 48
eH2_9                 7.798374e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8716
    reference variance = 0.167254
====================================================
  Execution time = 1.9942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3785e-01
  Total weights = 2.0000e+06
  Execution time = 1.8669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337953602406
                                         uncertainty =       0.004731985492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337953602406
                                         uncertainty =       0.004731985492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411007542
  error estimate for blocks of size 2^( 2) =       0.000424013657
  error estimate for blocks of size 2^( 3) =       0.000437327641
  error estimate for blocks of size 2^( 4) =       0.000450303047
  error estimate for blocks of size 2^( 5) =       0.000461736038
  error estimate for blocks of size 2^( 6) =       0.000470797325
  error estimate for blocks of size 2^( 7) =       0.000476381310

      target function =                  N/A
              le_mean =     -16.906004018993
             les_mean =     286.150826121160
             stat err =       0.000464804430
             autocorr =       1.278912798639
              std dev =       0.581252440747
             le_variance =       0.337854399874

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337953530363
                                         uncertainty =       0.004731985295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337953530363
                                         uncertainty =       0.004731985295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411007499
  error estimate for blocks of size 2^( 2) =       0.000424013615
  error estimate for blocks of size 2^( 3) =       0.000437327601
  error estimate for blocks of size 2^( 4) =       0.000450303008
  error estimate for blocks of size 2^( 5) =       0.000461736001
  error estimate for blocks of size 2^( 6) =       0.000470797289
  error estimate for blocks of size 2^( 7) =       0.000476381273

      target function =                  N/A
              le_mean =     -16.906004018496
             les_mean =     286.150826032294
             stat err =       0.000464804393
             autocorr =       1.278912867245
              std dev =       0.581252378768
             le_variance =       0.337854327823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337953566378
                                         uncertainty =       0.004731985394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337953566378
                                         uncertainty =       0.004731985394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411007521
  error estimate for blocks of size 2^( 2) =       0.000424013636
  error estimate for blocks of size 2^( 3) =       0.000437327621
  error estimate for blocks of size 2^( 4) =       0.000450303027
  error estimate for blocks of size 2^( 5) =       0.000461736020
  error estimate for blocks of size 2^( 6) =       0.000470797307
  error estimate for blocks of size 2^( 7) =       0.000476381291

      target function =                  N/A
              le_mean =     -16.906004018744
             les_mean =     286.150826076716
             stat err =       0.000464804411
             autocorr =       1.278912832946
              std dev =       0.581252409751
             le_variance =       0.337854363842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337953597903
                                         uncertainty =       0.004731985480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337953597903
                                         uncertainty =       0.004731985480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411007540
  error estimate for blocks of size 2^( 2) =       0.000424013654
  error estimate for blocks of size 2^( 3) =       0.000437327639
  error estimate for blocks of size 2^( 4) =       0.000450303044
  error estimate for blocks of size 2^( 5) =       0.000461736036
  error estimate for blocks of size 2^( 6) =       0.000470797323
  error estimate for blocks of size 2^( 7) =       0.000476381307

      target function =                  N/A
              le_mean =     -16.906004018962
             les_mean =     286.150826115604
             stat err =       0.000464804428
             autocorr =       1.278912802924
              std dev =       0.581252436872
             le_variance =       0.337854395370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906004018993        initial  <--
     9.3132e+02     9.3132e+03             2.4376e-07       -16.906004018496
     3.7253e+03     3.7253e+04             6.0940e-08       -16.906004018744
     1.4901e+04     1.4901e+05             1.5235e-08       -16.906004018962

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3181
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584174e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994061e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639528e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922323e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773899e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798367e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7506e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9079
    reference variance = 0.215216
====================================================
  Execution time = 2.0694e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3883e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5431e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338901151260
                                         uncertainty =       0.004359343669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338901151260
                                         uncertainty =       0.004359343669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411598008
  error estimate for blocks of size 2^( 2) =       0.000424935162
  error estimate for blocks of size 2^( 3) =       0.000438416478
  error estimate for blocks of size 2^( 4) =       0.000451035005
  error estimate for blocks of size 2^( 5) =       0.000463164885
  error estimate for blocks of size 2^( 6) =       0.000471794522
  error estimate for blocks of size 2^( 7) =       0.000475516722

      target function =                  N/A
              le_mean =     -16.906017968857
             les_mean =     286.152269234139
             stat err =       0.000465377783
             autocorr =       1.278394121005
              std dev =       0.582087485041
             le_variance =       0.338825840241


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601796886e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906017968857       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906017968837       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906017968836       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906017968924       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906017968893       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906017968892       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906017968878       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906017968829       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 1.976248e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906017968857       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906017968852       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906017968852       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906017968868       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906017968869       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906017968863       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906017968887       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906017968863       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 4.940623e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906017968857       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906017968856       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906017968856       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906017968861       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906017968860       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906017968842       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906017968674       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906017968763       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.235156e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.224963 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6244e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040532e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584174e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751724e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639532e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756574e-02 1 1  ON 43
eH2_4                 1.773900e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8123
    reference variance = 2.0052
====================================================
  Execution time = 2.0289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3996e-01
  Total weights = 2.0000e+06
  Execution time = 1.8657e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339748902945
                                         uncertainty =       0.006232095452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339748902945
                                         uncertainty =       0.006232095452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412283691
  error estimate for blocks of size 2^( 2) =       0.000424339995
  error estimate for blocks of size 2^( 3) =       0.000437054770
  error estimate for blocks of size 2^( 4) =       0.000448644216
  error estimate for blocks of size 2^( 5) =       0.000459573972
  error estimate for blocks of size 2^( 6) =       0.000466625206
  error estimate for blocks of size 2^( 7) =       0.000468288678

      target function =                  N/A
              le_mean =     -16.906023265908
             les_mean =     286.153578180799
             stat err =       0.000460783018
             autocorr =       1.249109809204
              std dev =       0.583057187025
             le_variance =       0.339955683342

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339748908684
                                         uncertainty =       0.006232095585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339748908684
                                         uncertainty =       0.006232095585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412283694
  error estimate for blocks of size 2^( 2) =       0.000424339998
  error estimate for blocks of size 2^( 3) =       0.000437054774
  error estimate for blocks of size 2^( 4) =       0.000448644219
  error estimate for blocks of size 2^( 5) =       0.000459573975
  error estimate for blocks of size 2^( 6) =       0.000466625209
  error estimate for blocks of size 2^( 7) =       0.000468288681

      target function =                  N/A
              le_mean =     -16.906023265887
             les_mean =     286.153578185808
             stat err =       0.000460783021
             autocorr =       1.249109806555
              std dev =       0.583057191948
             le_variance =       0.339955689082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339748905815
                                         uncertainty =       0.006232095518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339748905815
                                         uncertainty =       0.006232095518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412283693
  error estimate for blocks of size 2^( 2) =       0.000424339996
  error estimate for blocks of size 2^( 3) =       0.000437054772
  error estimate for blocks of size 2^( 4) =       0.000448644218
  error estimate for blocks of size 2^( 5) =       0.000459573974
  error estimate for blocks of size 2^( 6) =       0.000466625207
  error estimate for blocks of size 2^( 7) =       0.000468288679

      target function =                  N/A
              le_mean =     -16.906023265898
             les_mean =     286.153578183303
             stat err =       0.000460783019
             autocorr =       1.249109807883
              std dev =       0.583057189487
             le_variance =       0.339955686212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339748903304
                                         uncertainty =       0.006232095460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339748903304
                                         uncertainty =       0.006232095460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412283691
  error estimate for blocks of size 2^( 2) =       0.000424339995
  error estimate for blocks of size 2^( 3) =       0.000437054771
  error estimate for blocks of size 2^( 4) =       0.000448644216
  error estimate for blocks of size 2^( 5) =       0.000459573972
  error estimate for blocks of size 2^( 6) =       0.000466625206
  error estimate for blocks of size 2^( 7) =       0.000468288678

      target function =                  N/A
              le_mean =     -16.906023265907
             les_mean =     286.153578181112
             stat err =       0.000460783018
             autocorr =       1.249109809035
              std dev =       0.583057187333
             le_variance =       0.339955683701


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906023265908        initial  <--
     9.3132e+03     9.3132e+04             1.9762e-08       -16.906023265887
     3.7253e+04     3.7253e+05             4.9406e-09       -16.906023265898
     1.4901e+05     1.4901e+06             1.2352e-09       -16.906023265907

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6868
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584174e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994061e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639528e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922323e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773899e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798367e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5938e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9136
    reference variance = 0.232444
====================================================
  Execution time = 2.0493e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4222e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341783393172
                                         uncertainty =       0.004893484094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341783393172
                                         uncertainty =       0.004893484094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413653191
  error estimate for blocks of size 2^( 2) =       0.000426725507
  error estimate for blocks of size 2^( 3) =       0.000440235534
  error estimate for blocks of size 2^( 4) =       0.000452868835
  error estimate for blocks of size 2^( 5) =       0.000464317896
  error estimate for blocks of size 2^( 6) =       0.000473854882
  error estimate for blocks of size 2^( 7) =       0.000480366856

      target function =                  N/A
              le_mean =     -16.906002128733
             les_mean =     286.155125730075
             stat err =       0.000467852117
             autocorr =       1.279217645343
              std dev =       0.584993952492
             le_variance =       0.342217924452


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690600212873e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002128733       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002128735       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002128734       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002128736       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002128582       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002128736       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002128726       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906002128834       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.873900e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002128733       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002128734       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002128733       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002129083       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002128734       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002128527       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002128579       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906002128902       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 7.184750e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906002128733       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906002128733       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906002128733       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906002128941       residual = 6.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906002127539       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906002129092       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906002128711       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906002130105       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.796188e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6037e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584174e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994061e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639527e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773899e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9724
    reference variance = 0.377202
====================================================
  Execution time = 1.9970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3640e-01
  Total weights = 2.0000e+06
  Execution time = 1.8637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336422104115
                                         uncertainty =       0.003324471073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336422104115
                                         uncertainty =       0.003324471073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410122701
  error estimate for blocks of size 2^( 2) =       0.000422815802
  error estimate for blocks of size 2^( 3) =       0.000435164039
  error estimate for blocks of size 2^( 4) =       0.000446992804
  error estimate for blocks of size 2^( 5) =       0.000459237693
  error estimate for blocks of size 2^( 6) =       0.000466205420
  error estimate for blocks of size 2^( 7) =       0.000469701948

      target function =                  N/A
              le_mean =     -16.905880628138
             les_mean =     286.145200904050
             stat err =       0.000460534466
             autocorr =       1.260946495040
              std dev =       0.580001085681
             le_variance =       0.336401259392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336422103950
                                         uncertainty =       0.003324471070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336422103950
                                         uncertainty =       0.003324471070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410122701
  error estimate for blocks of size 2^( 2) =       0.000422815802
  error estimate for blocks of size 2^( 3) =       0.000435164039
  error estimate for blocks of size 2^( 4) =       0.000446992804
  error estimate for blocks of size 2^( 5) =       0.000459237693
  error estimate for blocks of size 2^( 6) =       0.000466205420
  error estimate for blocks of size 2^( 7) =       0.000469701947

      target function =                  N/A
              le_mean =     -16.905880628144
             les_mean =     286.145200904075
             stat err =       0.000460534466
             autocorr =       1.260946494981
              std dev =       0.580001085539
             le_variance =       0.336401259227

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336422104032
                                         uncertainty =       0.003324471072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336422104032
                                         uncertainty =       0.003324471072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410122701
  error estimate for blocks of size 2^( 2) =       0.000422815802
  error estimate for blocks of size 2^( 3) =       0.000435164039
  error estimate for blocks of size 2^( 4) =       0.000446992804
  error estimate for blocks of size 2^( 5) =       0.000459237693
  error estimate for blocks of size 2^( 6) =       0.000466205420
  error estimate for blocks of size 2^( 7) =       0.000469701947

      target function =                  N/A
              le_mean =     -16.905880628141
             les_mean =     286.145200904063
             stat err =       0.000460534466
             autocorr =       1.260946495012
              std dev =       0.580001085610
             le_variance =       0.336401259309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336422104104
                                         uncertainty =       0.003324471073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336422104104
                                         uncertainty =       0.003324471073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410122701
  error estimate for blocks of size 2^( 2) =       0.000422815802
  error estimate for blocks of size 2^( 3) =       0.000435164039
  error estimate for blocks of size 2^( 4) =       0.000446992804
  error estimate for blocks of size 2^( 5) =       0.000459237693
  error estimate for blocks of size 2^( 6) =       0.000466205420
  error estimate for blocks of size 2^( 7) =       0.000469701948

      target function =                  N/A
              le_mean =     -16.905880628139
             les_mean =     286.145200904052
             stat err =       0.000460534466
             autocorr =       1.260946495029
              std dev =       0.580001085672
             le_variance =       0.336401259381


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905880628138        initial
     9.3132e+04     9.3132e+05             2.8739e-09       -16.905880628144  <--
     3.7253e+05     3.7253e+06             7.1848e-10       -16.905880628141
     1.4901e+06     1.4901e+07             1.7962e-10       -16.905880628139

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 2.9329e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639525e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5377e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9028
    reference variance = 0.629034
====================================================
  Execution time = 2.0362e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3318e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333277502972
                                         uncertainty =       0.003352435157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333277502972
                                         uncertainty =       0.003352435157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408155182
  error estimate for blocks of size 2^( 2) =       0.000420989403
  error estimate for blocks of size 2^( 3) =       0.000433863019
  error estimate for blocks of size 2^( 4) =       0.000445700060
  error estimate for blocks of size 2^( 5) =       0.000456280238
  error estimate for blocks of size 2^( 6) =       0.000462539265
  error estimate for blocks of size 2^( 7) =       0.000467123669

      target function =                  N/A
              le_mean =     -16.905197016183
             les_mean =     286.118867295156
             stat err =       0.000457910808
             autocorr =       1.258667905542
              std dev =       0.577218594455
             le_variance =       0.333181305784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690519701618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905197016183       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905197016197       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905197016191       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905197016185       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905197016194       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905197016203       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905197016196       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905197016200       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.153587e-08

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905197016183       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905197016186       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905197016185       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905197016135       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905197016185       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905197016197       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905197016163       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905197016285       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.883969e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905197016183       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905197016184       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905197016183       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905197016183       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905197016184       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905197015661       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905197016433       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905197016451       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 7.209918e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230200 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5830e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639549e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9543
    reference variance = 0.254956
====================================================
  Execution time = 1.9982e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3816e-01
  Total weights = 2.0000e+06
  Execution time = 1.8654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338254764170
                                         uncertainty =       0.007428773086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338254764170
                                         uncertainty =       0.007428773086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411194706
  error estimate for blocks of size 2^( 2) =       0.000424091626
  error estimate for blocks of size 2^( 3) =       0.000437499786
  error estimate for blocks of size 2^( 4) =       0.000449415554
  error estimate for blocks of size 2^( 5) =       0.000459408361
  error estimate for blocks of size 2^( 6) =       0.000466013642
  error estimate for blocks of size 2^( 7) =       0.000472720925

      target function =                  N/A
              le_mean =     -16.906110366419
             les_mean =     286.154729725554
             stat err =       0.000461889620
             autocorr =       1.261773424057
              std dev =       0.581517130513
             le_variance =       0.338162173080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338254769043
                                         uncertainty =       0.007428773739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338254769043
                                         uncertainty =       0.007428773739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411194709
  error estimate for blocks of size 2^( 2) =       0.000424091629
  error estimate for blocks of size 2^( 3) =       0.000437499788
  error estimate for blocks of size 2^( 4) =       0.000449415557
  error estimate for blocks of size 2^( 5) =       0.000459408364
  error estimate for blocks of size 2^( 6) =       0.000466013645
  error estimate for blocks of size 2^( 7) =       0.000472720927

      target function =                  N/A
              le_mean =     -16.906110366403
             les_mean =     286.154729729871
             stat err =       0.000461889623
             autocorr =       1.261773420305
              std dev =       0.581517134699
             le_variance =       0.338162177949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338254766607
                                         uncertainty =       0.007428773413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338254766607
                                         uncertainty =       0.007428773413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411194708
  error estimate for blocks of size 2^( 2) =       0.000424091627
  error estimate for blocks of size 2^( 3) =       0.000437499787
  error estimate for blocks of size 2^( 4) =       0.000449415556
  error estimate for blocks of size 2^( 5) =       0.000459408362
  error estimate for blocks of size 2^( 6) =       0.000466013644
  error estimate for blocks of size 2^( 7) =       0.000472720926

      target function =                  N/A
              le_mean =     -16.906110366411
             les_mean =     286.154729727713
             stat err =       0.000461889622
             autocorr =       1.261773422173
              std dev =       0.581517132606
             le_variance =       0.338162175514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338254764475
                                         uncertainty =       0.007428773127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338254764475
                                         uncertainty =       0.007428773127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411194707
  error estimate for blocks of size 2^( 2) =       0.000424091626
  error estimate for blocks of size 2^( 3) =       0.000437499786
  error estimate for blocks of size 2^( 4) =       0.000449415554
  error estimate for blocks of size 2^( 5) =       0.000459408361
  error estimate for blocks of size 2^( 6) =       0.000466013642
  error estimate for blocks of size 2^( 7) =       0.000472720925

      target function =                  N/A
              le_mean =     -16.906110366418
             les_mean =     286.154729725824
             stat err =       0.000461889621
             autocorr =       1.261773423816
              std dev =       0.581517130774
             le_variance =       0.338162173384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906110366419        initial  <--
     2.3283e+04     2.3283e+05             1.1536e-08       -16.906110366403
     9.3132e+04     9.3132e+05             2.8840e-09       -16.906110366411
     3.7253e+05     3.7253e+06             7.2099e-10       -16.906110366418

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3788
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639525e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.755475
====================================================
  Execution time = 2.0443e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3689e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336982753419
                                         uncertainty =       0.004261821668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336982753419
                                         uncertainty =       0.004261821668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410420558
  error estimate for blocks of size 2^( 2) =       0.000423255422
  error estimate for blocks of size 2^( 3) =       0.000435967108
  error estimate for blocks of size 2^( 4) =       0.000448142853
  error estimate for blocks of size 2^( 5) =       0.000457477175
  error estimate for blocks of size 2^( 6) =       0.000465743337
  error estimate for blocks of size 2^( 7) =       0.000469346731

      target function =                  N/A
              le_mean =     -16.906800609702
             les_mean =     286.176796756486
             stat err =       0.000460177524
             autocorr =       1.257165904004
              std dev =       0.580422319261
             le_variance =       0.336890068696


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680060970e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906800609702       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906800609703       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906800609707       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906800609605       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906800609848       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906800609710       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906800609650       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 9.633105e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906800609702       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906800609702       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906800609704       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906800609427       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906800609631       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906800609328       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906800609739       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.408276e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906800609702       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906800609702       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906800609703       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906800609703       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906800610360       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906800610321       residual = 6.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906800603837       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 6.020703e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.232441 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5918e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639525e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8654
    reference variance = 0.322027
====================================================
  Execution time = 1.9936e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4106e-01
  Total weights = 2.0000e+06
  Execution time = 1.8662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341168409895
                                         uncertainty =       0.005471155245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341168409895
                                         uncertainty =       0.005471155245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412950905
  error estimate for blocks of size 2^( 2) =       0.000425410080
  error estimate for blocks of size 2^( 3) =       0.000438319711
  error estimate for blocks of size 2^( 4) =       0.000449643523
  error estimate for blocks of size 2^( 5) =       0.000458891476
  error estimate for blocks of size 2^( 6) =       0.000466832060
  error estimate for blocks of size 2^( 7) =       0.000472166472

      target function =                  N/A
              le_mean =     -16.905659595394
             les_mean =     286.142383084652
             stat err =       0.000461883383
             autocorr =       1.251030309387
              std dev =       0.584000770406
             le_variance =       0.341056899834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341168409989
                                         uncertainty =       0.005471155237

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341168409989
                                         uncertainty =       0.005471155237

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412950905
  error estimate for blocks of size 2^( 2) =       0.000425410080
  error estimate for blocks of size 2^( 3) =       0.000438319711
  error estimate for blocks of size 2^( 4) =       0.000449643523
  error estimate for blocks of size 2^( 5) =       0.000458891477
  error estimate for blocks of size 2^( 6) =       0.000466832060
  error estimate for blocks of size 2^( 7) =       0.000472166472

      target function =                  N/A
              le_mean =     -16.905659595398
             les_mean =     286.142383084878
             stat err =       0.000461883383
             autocorr =       1.251030309252
              std dev =       0.584000770486
             le_variance =       0.341056899929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341168409942
                                         uncertainty =       0.005471155241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341168409942
                                         uncertainty =       0.005471155241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412950905
  error estimate for blocks of size 2^( 2) =       0.000425410080
  error estimate for blocks of size 2^( 3) =       0.000438319711
  error estimate for blocks of size 2^( 4) =       0.000449643523
  error estimate for blocks of size 2^( 5) =       0.000458891477
  error estimate for blocks of size 2^( 6) =       0.000466832060
  error estimate for blocks of size 2^( 7) =       0.000472166472

      target function =                  N/A
              le_mean =     -16.905659595396
             les_mean =     286.142383084765
             stat err =       0.000461883383
             autocorr =       1.251030309325
              std dev =       0.584000770446
             le_variance =       0.341056899882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341168409901
                                         uncertainty =       0.005471155244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341168409901
                                         uncertainty =       0.005471155244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412950905
  error estimate for blocks of size 2^( 2) =       0.000425410080
  error estimate for blocks of size 2^( 3) =       0.000438319711
  error estimate for blocks of size 2^( 4) =       0.000449643523
  error estimate for blocks of size 2^( 5) =       0.000458891476
  error estimate for blocks of size 2^( 6) =       0.000466832060
  error estimate for blocks of size 2^( 7) =       0.000472166472

      target function =                  N/A
              le_mean =     -16.905659595395
             les_mean =     286.142383084667
             stat err =       0.000461883383
             autocorr =       1.251030309379
              std dev =       0.584000770411
             le_variance =       0.341056899840


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905659595394        initial
     2.3283e+05     2.3283e+06             9.6331e-10       -16.905659595398  <--
     9.3132e+05     9.3132e+06             2.4083e-10       -16.905659595396
     3.7253e+06     3.7253e+07             6.0207e-11       -16.905659595395

*****************************************************************************
Applying the update for shift_i =   2.3283e+05     and shift_s =   2.3283e+06
*****************************************************************************

  Execution time = 2.9294e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639526e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5222e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8445
    reference variance = 0.137354
====================================================
  Execution time = 2.0223e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3312e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333122806927
                                         uncertainty =       0.002659153282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333122806927
                                         uncertainty =       0.002659153282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408119417
  error estimate for blocks of size 2^( 2) =       0.000420847209
  error estimate for blocks of size 2^( 3) =       0.000434287315
  error estimate for blocks of size 2^( 4) =       0.000446974448
  error estimate for blocks of size 2^( 5) =       0.000457014605
  error estimate for blocks of size 2^( 6) =       0.000466557453
  error estimate for blocks of size 2^( 7) =       0.000471093277

      target function =                  N/A
              le_mean =     -16.906384595300
             les_mean =     286.158962835328
             stat err =       0.000460409946
             autocorr =       1.272667276121
              std dev =       0.577168015146
             le_variance =       0.333122917708


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690638459530e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906384595300       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906384595298       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906384595310       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906384595314       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906384595327       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906384595314       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906384595272       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906384595328       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 3.394720e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906384595300       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906384595299       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906384595302       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906384595303       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906384595305       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906384595305       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906384595555       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906384595163       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 8.486811e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906384595300       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906384595299       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906384595300       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906384594906       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906384595190       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906384594626       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906384596026       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906384594750       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.121706e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.235055 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5760e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639526e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8677
    reference variance = 0.207463
====================================================
  Execution time = 2.2117e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3818e-01
  Total weights = 2.0000e+06
  Execution time = 1.8586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338210502991
                                         uncertainty =       0.003559065853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338210502991
                                         uncertainty =       0.003559065853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411207979
  error estimate for blocks of size 2^( 2) =       0.000424028451
  error estimate for blocks of size 2^( 3) =       0.000437423813
  error estimate for blocks of size 2^( 4) =       0.000449300833
  error estimate for blocks of size 2^( 5) =       0.000460043869
  error estimate for blocks of size 2^( 6) =       0.000466738038
  error estimate for blocks of size 2^( 7) =       0.000471729236

      target function =                  N/A
              le_mean =     -16.905867547140
             les_mean =     286.146541356376
             stat err =       0.000461952994
             autocorr =       1.262038217340
              std dev =       0.581535900906
             le_variance =       0.338184004042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338210502228
                                         uncertainty =       0.003559065855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338210502228
                                         uncertainty =       0.003559065855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411207979
  error estimate for blocks of size 2^( 2) =       0.000424028451
  error estimate for blocks of size 2^( 3) =       0.000437423813
  error estimate for blocks of size 2^( 4) =       0.000449300833
  error estimate for blocks of size 2^( 5) =       0.000460043868
  error estimate for blocks of size 2^( 6) =       0.000466738038
  error estimate for blocks of size 2^( 7) =       0.000471729236

      target function =                  N/A
              le_mean =     -16.905867547128
             les_mean =     286.146541355221
             stat err =       0.000461952994
             autocorr =       1.262038218004
              std dev =       0.581535900248
             le_variance =       0.338184003278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338210502609
                                         uncertainty =       0.003559065854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338210502609
                                         uncertainty =       0.003559065854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411207979
  error estimate for blocks of size 2^( 2) =       0.000424028451
  error estimate for blocks of size 2^( 3) =       0.000437423813
  error estimate for blocks of size 2^( 4) =       0.000449300833
  error estimate for blocks of size 2^( 5) =       0.000460043868
  error estimate for blocks of size 2^( 6) =       0.000466738038
  error estimate for blocks of size 2^( 7) =       0.000471729236

      target function =                  N/A
              le_mean =     -16.905867547134
             les_mean =     286.146541355798
             stat err =       0.000461952994
             autocorr =       1.262038217688
              std dev =       0.581535900577
             le_variance =       0.338184003660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338210502943
                                         uncertainty =       0.003559065853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338210502943
                                         uncertainty =       0.003559065853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411207979
  error estimate for blocks of size 2^( 2) =       0.000424028451
  error estimate for blocks of size 2^( 3) =       0.000437423813
  error estimate for blocks of size 2^( 4) =       0.000449300833
  error estimate for blocks of size 2^( 5) =       0.000460043869
  error estimate for blocks of size 2^( 6) =       0.000466738038
  error estimate for blocks of size 2^( 7) =       0.000471729236

      target function =                  N/A
              le_mean =     -16.905867547139
             les_mean =     286.146541356303
             stat err =       0.000461952994
             autocorr =       1.262038217388
              std dev =       0.581535900865
             le_variance =       0.338184003994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905867547140        initial  <--
     5.8208e+04     5.8208e+05             3.3947e-09       -16.905867547128
     2.3283e+05     2.3283e+06             8.4868e-10       -16.905867547134
     9.3132e+05     9.3132e+06             2.1217e-10       -16.905867547139

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.4787
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639526e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7247e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8066
    reference variance = 2.73758
====================================================
  Execution time = 2.0199e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3101e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330953555489
                                         uncertainty =       0.002841019048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330953555489
                                         uncertainty =       0.002841019048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406820783
  error estimate for blocks of size 2^( 2) =       0.000419418416
  error estimate for blocks of size 2^( 3) =       0.000432185909
  error estimate for blocks of size 2^( 4) =       0.000443352112
  error estimate for blocks of size 2^( 5) =       0.000453677207
  error estimate for blocks of size 2^( 6) =       0.000461889314
  error estimate for blocks of size 2^( 7) =       0.000464258481

      target function =                  N/A
              le_mean =     -16.905551790779
             les_mean =     286.128687484972
             stat err =       0.000455794279
             autocorr =       1.255253597834
              std dev =       0.575331469469
             le_variance =       0.331006299761


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690555179078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905551790779       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905551790780       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905551790779       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905551790779       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905551790709       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905551790500       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905551790781       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905551790914       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 4.280309e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905551790779       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905551790779       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905551790779       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905551788749       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905551791003       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905551789475       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905551788345       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905551792050       residual = 3.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.070077e-10

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905551790779       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905551790779       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905551790779       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905551790779       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905551785496       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905551834783       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905551790597       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905551797033       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 2.675200e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5782e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639526e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8214
    reference variance = 0.182383
====================================================
  Execution time = 1.9935e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2951e-01
  Total weights = 2.0000e+06
  Execution time = 1.8585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329553459779
                                         uncertainty =       0.002421983540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329553459779
                                         uncertainty =       0.002421983540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405903343
  error estimate for blocks of size 2^( 2) =       0.000418476224
  error estimate for blocks of size 2^( 3) =       0.000431390056
  error estimate for blocks of size 2^( 4) =       0.000442676422
  error estimate for blocks of size 2^( 5) =       0.000452474374
  error estimate for blocks of size 2^( 6) =       0.000462381956
  error estimate for blocks of size 2^( 7) =       0.000467132072

      target function =                  N/A
              le_mean =     -16.906350760442
             les_mean =     286.154210918596
             stat err =       0.000456166206
             autocorr =       1.262993048466
              std dev =       0.574034013145
             le_variance =       0.329515048247

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329553459942
                                         uncertainty =       0.002421983541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329553459942
                                         uncertainty =       0.002421983541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405903343
  error estimate for blocks of size 2^( 2) =       0.000418476224
  error estimate for blocks of size 2^( 3) =       0.000431390056
  error estimate for blocks of size 2^( 4) =       0.000442676422
  error estimate for blocks of size 2^( 5) =       0.000452474374
  error estimate for blocks of size 2^( 6) =       0.000462381956
  error estimate for blocks of size 2^( 7) =       0.000467132072

      target function =                  N/A
              le_mean =     -16.906350760443
             les_mean =     286.154210918769
             stat err =       0.000456166206
             autocorr =       1.262993048271
              std dev =       0.574034013287
             le_variance =       0.329515048411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329553459861
                                         uncertainty =       0.002421983541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329553459861
                                         uncertainty =       0.002421983541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405903343
  error estimate for blocks of size 2^( 2) =       0.000418476224
  error estimate for blocks of size 2^( 3) =       0.000431390056
  error estimate for blocks of size 2^( 4) =       0.000442676422
  error estimate for blocks of size 2^( 5) =       0.000452474374
  error estimate for blocks of size 2^( 6) =       0.000462381956
  error estimate for blocks of size 2^( 7) =       0.000467132072

      target function =                  N/A
              le_mean =     -16.906350760442
             les_mean =     286.154210918682
             stat err =       0.000456166206
             autocorr =       1.262993048366
              std dev =       0.574034013216
             le_variance =       0.329515048329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329553459789
                                         uncertainty =       0.002421983540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329553459789
                                         uncertainty =       0.002421983540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405903343
  error estimate for blocks of size 2^( 2) =       0.000418476224
  error estimate for blocks of size 2^( 3) =       0.000431390056
  error estimate for blocks of size 2^( 4) =       0.000442676422
  error estimate for blocks of size 2^( 5) =       0.000452474374
  error estimate for blocks of size 2^( 6) =       0.000462381956
  error estimate for blocks of size 2^( 7) =       0.000467132072

      target function =                  N/A
              le_mean =     -16.906350760442
             les_mean =     286.154210918606
             stat err =       0.000456166206
             autocorr =       1.262993048443
              std dev =       0.574034013154
             le_variance =       0.329515048258


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906350760442        initial
     5.8208e+05     5.8208e+06             4.2803e-10       -16.906350760443  <--
     2.3283e+06     2.3283e+07             1.0701e-10       -16.906350760442
     9.3132e+06     9.3132e+07             2.6752e-11       -16.906350760442

*****************************************************************************
Applying the update for shift_i =   5.8208e+05     and shift_s =   5.8208e+06
*****************************************************************************

  Execution time = 2.9301e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639526e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8664
    reference variance = 0.433084
====================================================
  Execution time = 2.0217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3242e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332410391024
                                         uncertainty =       0.002964821714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332410391024
                                         uncertainty =       0.002964821714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407687601
  error estimate for blocks of size 2^( 2) =       0.000420841934
  error estimate for blocks of size 2^( 3) =       0.000434135852
  error estimate for blocks of size 2^( 4) =       0.000446283611
  error estimate for blocks of size 2^( 5) =       0.000457177532
  error estimate for blocks of size 2^( 6) =       0.000465631370
  error estimate for blocks of size 2^( 7) =       0.000470246273

      target function =                  N/A
              le_mean =     -16.905299850683
             les_mean =     286.121581235191
             stat err =       0.000459834696
             autocorr =       1.272179720398
              std dev =       0.576557334448
             le_variance =       0.332418359906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690529985068e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905299850683       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905299850682       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905299850679       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905299850682       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905299850667       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905299850621       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905299850674       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905299850693       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.681746e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905299850683       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905299850682       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905299850682       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905299850683       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905299850068       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905299850287       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905299851104       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905299850840       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 4.204367e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905299850683       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905299850683       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905299850683       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905299850464       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905299851889       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905299850641       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905299850411       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905299851374       residual = 2.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.051092e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5741e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639527e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9019
    reference variance = 0.273122
====================================================
  Execution time = 2.0076e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3392e-01
  Total weights = 2.0000e+06
  Execution time = 1.8633e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333920291536
                                         uncertainty =       0.003171517532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333920291536
                                         uncertainty =       0.003171517532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408607603
  error estimate for blocks of size 2^( 2) =       0.000421406015
  error estimate for blocks of size 2^( 3) =       0.000434060863
  error estimate for blocks of size 2^( 4) =       0.000446104851
  error estimate for blocks of size 2^( 5) =       0.000455853408
  error estimate for blocks of size 2^( 6) =       0.000464030996
  error estimate for blocks of size 2^( 7) =       0.000468183354

      target function =                  N/A
              le_mean =     -16.906576743104
             les_mean =     286.166257350745
             stat err =       0.000458543152
             autocorr =       1.259353160956
              std dev =       0.577858414529
             le_variance =       0.333920347242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333920291840
                                         uncertainty =       0.003171517531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333920291840
                                         uncertainty =       0.003171517531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408607604
  error estimate for blocks of size 2^( 2) =       0.000421406015
  error estimate for blocks of size 2^( 3) =       0.000434060863
  error estimate for blocks of size 2^( 4) =       0.000446104851
  error estimate for blocks of size 2^( 5) =       0.000455853408
  error estimate for blocks of size 2^( 6) =       0.000464030996
  error estimate for blocks of size 2^( 7) =       0.000468183354

      target function =                  N/A
              le_mean =     -16.906576743094
             les_mean =     286.166257350699
             stat err =       0.000458543152
             autocorr =       1.259353160715
              std dev =       0.577858414792
             le_variance =       0.333920347545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333920291688
                                         uncertainty =       0.003171517532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333920291688
                                         uncertainty =       0.003171517532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408607604
  error estimate for blocks of size 2^( 2) =       0.000421406015
  error estimate for blocks of size 2^( 3) =       0.000434060863
  error estimate for blocks of size 2^( 4) =       0.000446104851
  error estimate for blocks of size 2^( 5) =       0.000455853408
  error estimate for blocks of size 2^( 6) =       0.000464030996
  error estimate for blocks of size 2^( 7) =       0.000468183354

      target function =                  N/A
              le_mean =     -16.906576743099
             les_mean =     286.166257350722
             stat err =       0.000458543152
             autocorr =       1.259353160836
              std dev =       0.577858414660
             le_variance =       0.333920347394

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333920291555
                                         uncertainty =       0.003171517532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333920291555
                                         uncertainty =       0.003171517532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408607603
  error estimate for blocks of size 2^( 2) =       0.000421406015
  error estimate for blocks of size 2^( 3) =       0.000434060863
  error estimate for blocks of size 2^( 4) =       0.000446104851
  error estimate for blocks of size 2^( 5) =       0.000455853408
  error estimate for blocks of size 2^( 6) =       0.000464030996
  error estimate for blocks of size 2^( 7) =       0.000468183354

      target function =                  N/A
              le_mean =     -16.906576743103
             les_mean =     286.166257350742
             stat err =       0.000458543152
             autocorr =       1.259353160942
              std dev =       0.577858414545
             le_variance =       0.333920347261


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906576743104        initial  <--
     1.4552e+05     1.4552e+06             1.6817e-09       -16.906576743094
     5.8208e+05     5.8208e+06             4.2044e-10       -16.906576743099
     2.3283e+06     2.3283e+07             1.0511e-10       -16.906576743103

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4329
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639526e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5183e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8825
    reference variance = 0.250346
====================================================
  Execution time = 2.0258e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3920e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5530e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339204065434
                                         uncertainty =       0.007258679101

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339204065434
                                         uncertainty =       0.007258679101

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411824556
  error estimate for blocks of size 2^( 2) =       0.000424417129
  error estimate for blocks of size 2^( 3) =       0.000436668816
  error estimate for blocks of size 2^( 4) =       0.000448754135
  error estimate for blocks of size 2^( 5) =       0.000459353815
  error estimate for blocks of size 2^( 6) =       0.000468082817
  error estimate for blocks of size 2^( 7) =       0.000473628541

      target function =                  N/A
              le_mean =     -16.906846908965
             les_mean =     286.180671163761
             stat err =       0.000462454827
             autocorr =       1.260997296793
              std dev =       0.582407872687
             le_variance =       0.339198930168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690684690897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906846908965       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906846908966       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906846908966       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906846909193       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906846908966       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906846910299       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906846908026       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906846908977       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.254765e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906846908965       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906846908965       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906846908965       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906846904077       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906846906884       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906846912253       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906846911586       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906846909013       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 3.136941e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906846908965       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906846908965       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906846908965       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906846908965       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906846908964       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906846914728       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906846901412       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906846899845       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 7.842248e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.243010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5817e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639526e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9907
    reference variance = 0.500467
====================================================
  Execution time = 1.9940e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4060e-01
  Total weights = 2.0000e+06
  Execution time = 1.8585e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340615653064
                                         uncertainty =       0.005316300507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340615653064
                                         uncertainty =       0.005316300507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412673867
  error estimate for blocks of size 2^( 2) =       0.000425412434
  error estimate for blocks of size 2^( 3) =       0.000437720471
  error estimate for blocks of size 2^( 4) =       0.000449593939
  error estimate for blocks of size 2^( 5) =       0.000458924020
  error estimate for blocks of size 2^( 6) =       0.000467993165
  error estimate for blocks of size 2^( 7) =       0.000471942796

      target function =                  N/A
              le_mean =     -16.906282994476
             les_mean =     286.163003959450
             stat err =       0.000462113480
             autocorr =       1.253959009764
              std dev =       0.583608979063
             le_variance =       0.340599440443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340615653040
                                         uncertainty =       0.005316300508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340615653040
                                         uncertainty =       0.005316300508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412673867
  error estimate for blocks of size 2^( 2) =       0.000425412434
  error estimate for blocks of size 2^( 3) =       0.000437720471
  error estimate for blocks of size 2^( 4) =       0.000449593939
  error estimate for blocks of size 2^( 5) =       0.000458924020
  error estimate for blocks of size 2^( 6) =       0.000467993165
  error estimate for blocks of size 2^( 7) =       0.000471942796

      target function =                  N/A
              le_mean =     -16.906282994476
             les_mean =     286.163003959436
             stat err =       0.000462113480
             autocorr =       1.253959009766
              std dev =       0.583608979042
             le_variance =       0.340599440418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340615653052
                                         uncertainty =       0.005316300507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340615653052
                                         uncertainty =       0.005316300507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412673867
  error estimate for blocks of size 2^( 2) =       0.000425412434
  error estimate for blocks of size 2^( 3) =       0.000437720471
  error estimate for blocks of size 2^( 4) =       0.000449593939
  error estimate for blocks of size 2^( 5) =       0.000458924020
  error estimate for blocks of size 2^( 6) =       0.000467993165
  error estimate for blocks of size 2^( 7) =       0.000471942796

      target function =                  N/A
              le_mean =     -16.906282994476
             les_mean =     286.163003959443
             stat err =       0.000462113480
             autocorr =       1.253959009758
              std dev =       0.583608979052
             le_variance =       0.340599440431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340615653063
                                         uncertainty =       0.005316300507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340615653063
                                         uncertainty =       0.005316300507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412673867
  error estimate for blocks of size 2^( 2) =       0.000425412434
  error estimate for blocks of size 2^( 3) =       0.000437720471
  error estimate for blocks of size 2^( 4) =       0.000449593939
  error estimate for blocks of size 2^( 5) =       0.000458924020
  error estimate for blocks of size 2^( 6) =       0.000467993165
  error estimate for blocks of size 2^( 7) =       0.000471942796

      target function =                  N/A
              le_mean =     -16.906282994476
             les_mean =     286.163003959449
             stat err =       0.000462113480
             autocorr =       1.253959009756
              std dev =       0.583608979062
             le_variance =       0.340599440441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906282994476        initial
     1.4552e+06     1.4552e+07             1.2548e-10       -16.906282994476  <--
     5.8208e+06     5.8208e+07             3.1369e-11       -16.906282994476
     2.3283e+07     2.3283e+08             7.8422e-12       -16.906282994476

*****************************************************************************
Applying the update for shift_i =   1.4552e+06     and shift_s =   1.4552e+07
*****************************************************************************

  Execution time = 2.9309e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639527e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5134e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.513258
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3984e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5458e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339831569240
                                         uncertainty =       0.007117018308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339831569240
                                         uncertainty =       0.007117018308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412215145
  error estimate for blocks of size 2^( 2) =       0.000424566759
  error estimate for blocks of size 2^( 3) =       0.000437363285
  error estimate for blocks of size 2^( 4) =       0.000449037839
  error estimate for blocks of size 2^( 5) =       0.000458045941
  error estimate for blocks of size 2^( 6) =       0.000464291527
  error estimate for blocks of size 2^( 7) =       0.000468898763

      target function =                  N/A
              le_mean =     -16.906933197112
             les_mean =     286.184232613430
             stat err =       0.000460068517
             autocorr =       1.245653184769
              std dev =       0.582960248847
             le_variance =       0.339842651736


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690693319711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906933197112       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906933197114       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906933197115       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906933197114       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906933197028       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906933197222       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906933197011       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906933196832       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 6.001020e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906933197112       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906933197113       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906933197113       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906933196119       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906933197113       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906933196837       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906933196429       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906933195252       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.500255e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906933197112       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906933197112       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906933197112       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906933200391       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906933197113       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906933197431       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906933196358       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906933195014       residual = 1.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 3.750641e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.245651 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5952e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584173e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639526e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9485
    reference variance = 0.383153
====================================================
  Execution time = 2.0065e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4143e-01
  Total weights = 2.0000e+06
  Execution time = 1.8639e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341420652384
                                         uncertainty =       0.004233763276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341420652384
                                         uncertainty =       0.004233763276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413174630
  error estimate for blocks of size 2^( 2) =       0.000425607013
  error estimate for blocks of size 2^( 3) =       0.000438248683
  error estimate for blocks of size 2^( 4) =       0.000449885589
  error estimate for blocks of size 2^( 5) =       0.000460588336
  error estimate for blocks of size 2^( 6) =       0.000469874353
  error estimate for blocks of size 2^( 7) =       0.000475881723

      target function =                  N/A
              le_mean =     -16.905610915528
             les_mean =     286.141106805846
             stat err =       0.000464057500
             autocorr =       1.261468178102
              std dev =       0.584317165032
             le_variance =       0.341426549351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341420652419
                                         uncertainty =       0.004233763276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341420652419
                                         uncertainty =       0.004233763276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413174630
  error estimate for blocks of size 2^( 2) =       0.000425607013
  error estimate for blocks of size 2^( 3) =       0.000438248683
  error estimate for blocks of size 2^( 4) =       0.000449885589
  error estimate for blocks of size 2^( 5) =       0.000460588336
  error estimate for blocks of size 2^( 6) =       0.000469874353
  error estimate for blocks of size 2^( 7) =       0.000475881723

      target function =                  N/A
              le_mean =     -16.905610915530
             les_mean =     286.141106805943
             stat err =       0.000464057500
             autocorr =       1.261468178087
              std dev =       0.584317165062
             le_variance =       0.341426549386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341420652401
                                         uncertainty =       0.004233763276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341420652401
                                         uncertainty =       0.004233763276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413174630
  error estimate for blocks of size 2^( 2) =       0.000425607013
  error estimate for blocks of size 2^( 3) =       0.000438248683
  error estimate for blocks of size 2^( 4) =       0.000449885589
  error estimate for blocks of size 2^( 5) =       0.000460588336
  error estimate for blocks of size 2^( 6) =       0.000469874353
  error estimate for blocks of size 2^( 7) =       0.000475881723

      target function =                  N/A
              le_mean =     -16.905610915529
             les_mean =     286.141106805894
             stat err =       0.000464057500
             autocorr =       1.261468178103
              std dev =       0.584317165047
             le_variance =       0.341426549368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341420652386
                                         uncertainty =       0.004233763276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341420652386
                                         uncertainty =       0.004233763276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413174630
  error estimate for blocks of size 2^( 2) =       0.000425607013
  error estimate for blocks of size 2^( 3) =       0.000438248683
  error estimate for blocks of size 2^( 4) =       0.000449885589
  error estimate for blocks of size 2^( 5) =       0.000460588336
  error estimate for blocks of size 2^( 6) =       0.000469874353
  error estimate for blocks of size 2^( 7) =       0.000475881723

      target function =                  N/A
              le_mean =     -16.905610915528
             les_mean =     286.141106805852
             stat err =       0.000464057500
             autocorr =       1.261468178102
              std dev =       0.584317165034
             le_variance =       0.341426549353


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905610915528        initial
     3.6380e+05     3.6380e+06             6.0010e-10       -16.905610915530  <--
     1.4552e+06     1.4552e+07             1.5003e-10       -16.905610915529
     5.8208e+06     5.8208e+07             3.7506e-11       -16.905610915528

*****************************************************************************
Applying the update for shift_i =   3.6380e+05     and shift_s =   3.6380e+06
*****************************************************************************

  Execution time = 2.9434e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584172e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639525e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5394e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9469
    reference variance = 0.189924
====================================================
  Execution time = 2.0354e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3673e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5566e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336771446923
                                         uncertainty =       0.003008998852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336771446923
                                         uncertainty =       0.003008998852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410324930
  error estimate for blocks of size 2^( 2) =       0.000423419166
  error estimate for blocks of size 2^( 3) =       0.000436128080
  error estimate for blocks of size 2^( 4) =       0.000449247784
  error estimate for blocks of size 2^( 5) =       0.000460308171
  error estimate for blocks of size 2^( 6) =       0.000469580152
  error estimate for blocks of size 2^( 7) =       0.000473982835

      target function =                  N/A
              le_mean =     -16.907039664565
             les_mean =     286.184723147782
             stat err =       0.000463279735
             autocorr =       1.274766959567
              std dev =       0.580287081518
             le_variance =       0.336733096976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690703966456e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907039664565       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907039664569       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907039664568       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907039664569       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907039664539       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907039664569       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907039664577       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907039664612       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 2.255868e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907039664565       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907039664566       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907039664566       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907039664566       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907039664608       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907039664554       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907039664567       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907039664591       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 5.639674e-10

solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907039664565       residual = 8.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907039664565       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907039664565       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907039663987       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907039664577       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907039664195       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907039664902       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907039664504       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.409919e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248282 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5917e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584172e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639526e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773897e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8847
    reference variance = 0.223584
====================================================
  Execution time = 1.9983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3305e-01
  Total weights = 2.0000e+06
  Execution time = 1.8721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333069869500
                                         uncertainty =       0.002701325958

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333069869500
                                         uncertainty =       0.002701325958

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408073179
  error estimate for blocks of size 2^( 2) =       0.000420755632
  error estimate for blocks of size 2^( 3) =       0.000434306910
  error estimate for blocks of size 2^( 4) =       0.000446621155
  error estimate for blocks of size 2^( 5) =       0.000458597528
  error estimate for blocks of size 2^( 6) =       0.000467557283
  error estimate for blocks of size 2^( 7) =       0.000476379582

      target function =                  N/A
              le_mean =     -16.906121802098
             les_mean =     286.150001660467
             stat err =       0.000462288887
             autocorr =       1.283366810189
              std dev =       0.577102624848
             le_variance =       0.333047439606

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333069868230
                                         uncertainty =       0.002701325950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333069868230
                                         uncertainty =       0.002701325950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408073179
  error estimate for blocks of size 2^( 2) =       0.000420755631
  error estimate for blocks of size 2^( 3) =       0.000434306909
  error estimate for blocks of size 2^( 4) =       0.000446621154
  error estimate for blocks of size 2^( 5) =       0.000458597527
  error estimate for blocks of size 2^( 6) =       0.000467557283
  error estimate for blocks of size 2^( 7) =       0.000476379582

      target function =                  N/A
              le_mean =     -16.906121802111
             les_mean =     286.150001659620
             stat err =       0.000462288886
             autocorr =       1.283366811774
              std dev =       0.577102623747
             le_variance =       0.333047438336

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333069868865
                                         uncertainty =       0.002701325954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333069868865
                                         uncertainty =       0.002701325954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408073179
  error estimate for blocks of size 2^( 2) =       0.000420755631
  error estimate for blocks of size 2^( 3) =       0.000434306910
  error estimate for blocks of size 2^( 4) =       0.000446621155
  error estimate for blocks of size 2^( 5) =       0.000458597527
  error estimate for blocks of size 2^( 6) =       0.000467557283
  error estimate for blocks of size 2^( 7) =       0.000476379582

      target function =                  N/A
              le_mean =     -16.906121802105
             les_mean =     286.150001660044
             stat err =       0.000462288887
             autocorr =       1.283366810980
              std dev =       0.577102624297
             le_variance =       0.333047438971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333069869421
                                         uncertainty =       0.002701325957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333069869421
                                         uncertainty =       0.002701325957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408073179
  error estimate for blocks of size 2^( 2) =       0.000420755632
  error estimate for blocks of size 2^( 3) =       0.000434306910
  error estimate for blocks of size 2^( 4) =       0.000446621155
  error estimate for blocks of size 2^( 5) =       0.000458597528
  error estimate for blocks of size 2^( 6) =       0.000467557283
  error estimate for blocks of size 2^( 7) =       0.000476379582

      target function =                  N/A
              le_mean =     -16.906121802099
             les_mean =     286.150001660414
             stat err =       0.000462288887
             autocorr =       1.283366810287
              std dev =       0.577102624779
             le_variance =       0.333047439527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906121802098        initial
     9.0949e+04     9.0949e+05             2.2559e-09       -16.906121802111  <--
     3.6380e+05     3.6380e+06             5.6397e-10       -16.906121802105
     1.4552e+06     1.4552e+07             1.4099e-10       -16.906121802099

*****************************************************************************
Applying the update for shift_i =   9.0949e+04     and shift_s =   9.0949e+05
*****************************************************************************

  Execution time = 3.3119e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584172e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639528e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773896e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960313e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9044e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.8902
    reference variance = 0.269353
====================================================
  Execution time = 2.0414e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5467e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5672e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354407015712
                                         uncertainty =       0.008131495299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.354407015712
                                         uncertainty =       0.008131495299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421112673
  error estimate for blocks of size 2^( 2) =       0.000433417609
  error estimate for blocks of size 2^( 3) =       0.000446154904
  error estimate for blocks of size 2^( 4) =       0.000458910114
  error estimate for blocks of size 2^( 5) =       0.000469796391
  error estimate for blocks of size 2^( 6) =       0.000476874640
  error estimate for blocks of size 2^( 7) =       0.000481266255

      target function =                  N/A
              le_mean =     -16.906444709249
             les_mean =     286.182544295929
             stat err =       0.000471711850
             autocorr =       1.254749266740
              std dev =       0.595543253150
             le_variance =       0.354671766373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690644470925e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+04, overlap shift 2.2737e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906444709249       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906444709250       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906444709275       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906444709278       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906444709274       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906444709272       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906444709265       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+04 is 9.816944e-09

solving harmonic davidson linear method for identity shift 9.0949e+04, overlap shift 9.0949e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906444709249       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906444709249       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906444709255       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906444709280       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906444709235       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906444709255       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906444709219       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+04 is 2.454241e-09

solving harmonic davidson linear method for identity shift 3.6380e+05, overlap shift 3.6380e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906444709249       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906444709249       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906444709251       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906444709463       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906444709311       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906444709164       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906444709329       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+05 is 6.135606e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.250516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5988e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.118538e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584172e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639529e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922324e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756573e-02 1 1  ON 43
eH2_4                 1.773896e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960314e-01 1 1  ON 48
eH2_9                 7.798368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.847
    reference variance = 0.155258
====================================================
  Execution time = 2.0147e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3612e-01
  Total weights = 2.0000e+06
  Execution time = 1.8884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336262703611
                                         uncertainty =       0.003364498354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336262703611
                                         uncertainty =       0.003364498354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409952664
  error estimate for blocks of size 2^( 2) =       0.000422686219
  error estimate for blocks of size 2^( 3) =       0.000435682656
  error estimate for blocks of size 2^( 4) =       0.000447577297
  error estimate for blocks of size 2^( 5) =       0.000458168432
  error estimate for blocks of size 2^( 6) =       0.000467165310
  error estimate for blocks of size 2^( 7) =       0.000470681428

      target function =                  N/A
              le_mean =     -16.906002703343
             les_mean =     286.149049611209
             stat err =       0.000460898117
             autocorr =       1.263986515623
              std dev =       0.579760617687
             le_variance =       0.336122373821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336262695122
                                         uncertainty =       0.003364498275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336262695122
                                         uncertainty =       0.003364498275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409952659
  error estimate for blocks of size 2^( 2) =       0.000422686214
  error estimate for blocks of size 2^( 3) =       0.000435682652
  error estimate for blocks of size 2^( 4) =       0.000447577293
  error estimate for blocks of size 2^( 5) =       0.000458168427
  error estimate for blocks of size 2^( 6) =       0.000467165307
  error estimate for blocks of size 2^( 7) =       0.000470681424

      target function =                  N/A
              le_mean =     -16.906002703359
             les_mean =     286.149049603264
             stat err =       0.000460898113
             autocorr =       1.263986525617
              std dev =       0.579760610371
             le_variance =       0.336122365337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336262699366
                                         uncertainty =       0.003364498315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336262699366
                                         uncertainty =       0.003364498315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409952662
  error estimate for blocks of size 2^( 2) =       0.000422686216
  error estimate for blocks of size 2^( 3) =       0.000435682654
  error estimate for blocks of size 2^( 4) =       0.000447577295
  error estimate for blocks of size 2^( 5) =       0.000458168430
  error estimate for blocks of size 2^( 6) =       0.000467165308
  error estimate for blocks of size 2^( 7) =       0.000470681426

      target function =                  N/A
              le_mean =     -16.906002703351
             les_mean =     286.149049607236
             stat err =       0.000460898115
             autocorr =       1.263986520622
              std dev =       0.579760614029
             le_variance =       0.336122369579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336262703080
                                         uncertainty =       0.003364498349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336262703080
                                         uncertainty =       0.003364498349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409952664
  error estimate for blocks of size 2^( 2) =       0.000422686219
  error estimate for blocks of size 2^( 3) =       0.000435682656
  error estimate for blocks of size 2^( 4) =       0.000447577297
  error estimate for blocks of size 2^( 5) =       0.000458168431
  error estimate for blocks of size 2^( 6) =       0.000467165310
  error estimate for blocks of size 2^( 7) =       0.000470681428

      target function =                  N/A
              le_mean =     -16.906002703344
             les_mean =     286.149049610712
             stat err =       0.000460898117
             autocorr =       1.263986516231
              std dev =       0.579760617230
             le_variance =       0.336122373291


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906002703343        initial
     2.2737e+04     2.2737e+05             9.8169e-09       -16.906002703359  <--
     9.0949e+04     9.0949e+05             2.4542e-09       -16.906002703351
     3.6380e+05     3.6380e+06             6.1356e-10       -16.906002703344

*****************************************************************************
Applying the update for shift_i =   2.2737e+04     and shift_s =   2.2737e+05
*****************************************************************************

  Execution time = 2.9646e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.118537e-01 1 1  ON 0
 uu_1                 1.444302e-01 1 1  ON 1
 uu_2                 4.256672e-02 1 1  ON 2
 uu_3                -2.040531e-02 1 1  ON 3
 uu_4                -6.650397e-02 1 1  ON 4
 uu_5                -1.022390e-01 1 1  ON 5
 uu_6                -1.308794e-01 1 1  ON 6
 uu_7                -1.456294e-01 1 1  ON 7
 uu_8                -1.383924e-01 1 1  ON 8
 uu_9                -1.104636e-01 1 1  ON 9
 ud_0                 4.526302e-01 1 1  ON 10
 ud_1                 1.864436e-01 1 1  ON 11
 ud_2                 6.530131e-02 1 1  ON 12
 ud_3                -6.584169e-03 1 1  ON 13
 ud_4                -6.420802e-02 1 1  ON 14
 ud_5                -1.064395e-01 1 1  ON 15
 ud_6                -1.346207e-01 1 1  ON 16
 ud_7                -1.522420e-01 1 1  ON 17
 ud_8                -1.529168e-01 1 1  ON 18
 ud_9                -1.431063e-01 1 1  ON 19
 eO_0                -7.559302e-01 1 1  ON 20
 eO_1                -4.340968e-01 1 1  ON 21
 eO_2                -1.751725e-02 1 1  ON 22
 eO_3                 3.008485e-01 1 1  ON 23
 eO_4                 5.290559e-01 1 1  ON 24
 eO_5                 4.926777e-01 1 1  ON 25
 eO_6                 2.633746e-01 1 1  ON 26
 eO_7                -4.204680e-02 1 1  ON 27
 eO_8                -2.326766e-01 1 1  ON 28
 eO_9                -9.994062e-02 1 1  ON 29
eH1_0                -2.592723e-01 1 1  ON 30
eH1_1                -1.542809e-01 1 1  ON 31
eH1_2                -1.053969e-01 1 1  ON 32
eH1_3                -4.994178e-02 1 1  ON 33
eH1_4                -6.639533e-04 1 1  ON 34
eH1_5                 3.500430e-02 1 1  ON 35
eH1_6                 9.570738e-02 1 1  ON 36
eH1_7                 1.583323e-01 1 1  ON 37
eH1_8                 1.916517e-01 1 1  ON 38
eH1_9                 8.922325e-02 1 1  ON 39
eH2_0                -2.568450e-01 1 1  ON 40
eH2_1                -1.515724e-01 1 1  ON 41
eH2_2                -1.029136e-01 1 1  ON 42
eH2_3                -4.756574e-02 1 1  ON 43
eH2_4                 1.773898e-03 1 1  ON 44
eH2_5                 3.748327e-02 1 1  ON 45
eH2_6                 9.955954e-02 1 1  ON 46
eH2_7                 1.599958e-01 1 1  ON 47
eH2_8                 1.960314e-01 1 1  ON 48
eH2_9                 7.798369e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5641e+01 secs
  Total Execution time = 2.2538e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
