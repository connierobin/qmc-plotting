Rank =    0  Free Memory = 81422 MB
Rank =    1  Free Memory = 81422 MB
Rank =    2  Free Memory = 81422 MB
Rank =    3  Free Memory = 81422 MB
Rank =    4  Free Memory = 81422 MB
Rank =    5  Free Memory = 81422 MB
Rank =    6  Free Memory = 81422 MB
Rank =    7  Free Memory = 81422 MB
Rank =    8  Free Memory = 81422 MB
Rank =    9  Free Memory = 81422 MB
Rank =   10  Free Memory = 81422 MB
Rank =   11  Free Memory = 81422 MB
Rank =   12  Free Memory = 81422 MB
Rank =   13  Free Memory = 81422 MB
Rank =   14  Free Memory = 81421 MB
Rank =   15  Free Memory = 81411 MB
Rank =   16  Free Memory = 81411 MB
Rank =   17  Free Memory = 81411 MB
Rank =   18  Free Memory = 81411 MB
Rank =   19  Free Memory = 81410 MB
Rank =   20  Free Memory = 81410 MB
Rank =   21  Free Memory = 81409 MB
Rank =   22  Free Memory = 81409 MB
Rank =   23  Free Memory = 81409 MB
Rank =   24  Free Memory = 81409 MB
Rank =   25  Free Memory = 81409 MB
Rank =   26  Free Memory = 81409 MB
Rank =   27  Free Memory = 81409 MB
Rank =   28  Free Memory = 81409 MB
Rank =   29  Free Memory = 81409 MB
Rank =   30  Free Memory = 81409 MB
Rank =   31  Free Memory = 81409 MB
Rank =   32  Free Memory = 70070 MB
Rank =   33  Free Memory = 70070 MB
Rank =   34  Free Memory = 70070 MB
Rank =   35  Free Memory = 70070 MB
Rank =   36  Free Memory = 70070 MB
Rank =   37  Free Memory = 70070 MB
Rank =   38  Free Memory = 70070 MB
Rank =   39  Free Memory = 70070 MB
Rank =   40  Free Memory = 70070 MB
Rank =   41  Free Memory = 70070 MB
Rank =   42  Free Memory = 70070 MB
Rank =   43  Free Memory = 70070 MB
Rank =   44  Free Memory = 70070 MB
Rank =   45  Free Memory = 70070 MB
Rank =   46  Free Memory = 70070 MB
Rank =   47  Free Memory = 70070 MB
Rank =   48  Free Memory = 70070 MB
Rank =   49  Free Memory = 70070 MB
Rank =   50  Free Memory = 70070 MB
Rank =   51  Free Memory = 70070 MB
Rank =   52  Free Memory = 70070 MB
Rank =   53  Free Memory = 70070 MB
Rank =   54  Free Memory = 70070 MB
Rank =   55  Free Memory = 70070 MB
Rank =   56  Free Memory = 70070 MB
Rank =   57  Free Memory = 70070 MB
Rank =   58  Free Memory = 70070 MB
Rank =   59  Free Memory = 70070 MB
Rank =   60  Free Memory = 70070 MB
Rank =   61  Free Memory = 70070 MB
Rank =   62  Free Memory = 70070 MB
Rank =   63  Free Memory = 70070 MB
Rank =   64  Free Memory = 85387 MB
Rank =   65  Free Memory = 85387 MB
Rank =   66  Free Memory = 85387 MB
Rank =   67  Free Memory = 85387 MB
Rank =   68  Free Memory = 85387 MB
Rank =   69  Free Memory = 85387 MB
Rank =   70  Free Memory = 85387 MB
Rank =   71  Free Memory = 85387 MB
Rank =   72  Free Memory = 85387 MB
Rank =   73  Free Memory = 85387 MB
Rank =   74  Free Memory = 85387 MB
Rank =   75  Free Memory = 85387 MB
Rank =   76  Free Memory = 85387 MB
Rank =   77  Free Memory = 85387 MB
Rank =   78  Free Memory = 85387 MB
Rank =   79  Free Memory = 85387 MB
Rank =   80  Free Memory = 85387 MB
Rank =   81  Free Memory = 85387 MB
Rank =   82  Free Memory = 85387 MB
Rank =   83  Free Memory = 85387 MB
Rank =   84  Free Memory = 85387 MB
Rank =   85  Free Memory = 85387 MB
Rank =   86  Free Memory = 85387 MB
Rank =   87  Free Memory = 85387 MB
Rank =   88  Free Memory = 85387 MB
Rank =   89  Free Memory = 85387 MB
Rank =   90  Free Memory = 85387 MB
Rank =   91  Free Memory = 85387 MB
Rank =   92  Free Memory = 85387 MB
Rank =   93  Free Memory = 85387 MB
Rank =   94  Free Memory = 85387 MB
Rank =   95  Free Memory = 85387 MB
Rank =   96  Free Memory = 82487 MB
Rank =   97  Free Memory = 82487 MB
Rank =   98  Free Memory = 82487 MB
Rank =   99  Free Memory = 82487 MB
Rank =  100  Free Memory = 82487 MB
Rank =  101  Free Memory = 82487 MB
Rank =  102  Free Memory = 82487 MB
Rank =  103  Free Memory = 82487 MB
Rank =  104  Free Memory = 82487 MB
Rank =  105  Free Memory = 82487 MB
Rank =  106  Free Memory = 82487 MB
Rank =  107  Free Memory = 82487 MB
Rank =  108  Free Memory = 82487 MB
Rank =  109  Free Memory = 82487 MB
Rank =  110  Free Memory = 82487 MB
Rank =  111  Free Memory = 82487 MB
Rank =  112  Free Memory = 82487 MB
Rank =  113  Free Memory = 82487 MB
Rank =  114  Free Memory = 82487 MB
Rank =  115  Free Memory = 82487 MB
Rank =  116  Free Memory = 82487 MB
Rank =  117  Free Memory = 82487 MB
Rank =  118  Free Memory = 82487 MB
Rank =  119  Free Memory = 82487 MB
Rank =  120  Free Memory = 82487 MB
Rank =  121  Free Memory = 82487 MB
Rank =  122  Free Memory = 82487 MB
Rank =  123  Free Memory = 82487 MB
Rank =  124  Free Memory = 82487 MB
Rank =  125  Free Memory = 82486 MB
Rank =  126  Free Memory = 82486 MB
Rank =  127  Free Memory = 82486 MB
  Input file(s): opt_h2o_1b1_lmc_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_lmc_run001b.xml

  Project = H2O
  date    = 2023-03-03 12:27:07 PST
  host    = n0017.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 27

  Range of prime numbers to use as seeds over processors and threads = 109-919


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.117531e-01    1         1  ON     0
     uu_1                 1.447377e-01    1         1  ON     1
     uu_2                 4.305772e-02    1         1  ON     2
     uu_3                -1.916587e-02    1         1  ON     3
     uu_4                -6.454693e-02    1         1  ON     4
     uu_5                -9.932998e-02    1         1  ON     5
     uu_6                -1.264844e-01    1         1  ON     6
     uu_7                -1.389809e-01    1         1  ON     7
     uu_8                -1.311520e-01    1         1  ON     8
     uu_9                -1.002764e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.453621e-01    1         1  ON     0
     ud_1                 1.799295e-01    1         1  ON     1
     ud_2                 5.987753e-02    1         1  ON     2
     ud_3                -1.076749e-02    1         1  ON     3
     ud_4                -6.720102e-02    1         1  ON     4
     ud_5                -1.077671e-01    1         1  ON     5
     ud_6                -1.341374e-01    1         1  ON     6
     ud_7                -1.497585e-01    1         1  ON     7
     ud_8                -1.506344e-01    1         1  ON     8
     ud_9                -1.385813e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.471078e-01    1         1  ON     0
     eO_1                -4.276999e-01    1         1  ON     1
     eO_2                -1.909341e-02    1         1  ON     2
     eO_3                 2.902573e-01    1         1  ON     3
     eO_4                 5.129991e-01    1         1  ON     4
     eO_5                 4.729072e-01    1         1  ON     5
     eO_6                 2.454354e-01    1         1  ON     6
     eO_7                -4.920388e-02    1         1  ON     7
     eO_8                -2.099812e-01    1         1  ON     8
     eO_9                -6.985333e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.490247e-01    1         1  ON     0
     eH1_1                -1.410049e-01    1         1  ON     1
     eH1_2                -9.187710e-02    1         1  ON     2
     eH1_3                -3.738922e-02    1         1  ON     3
     eH1_4                 1.162155e-02    1         1  ON     4
     eH1_5                 4.534866e-02    1         1  ON     5
     eH1_6                 1.014842e-01    1         1  ON     6
     eH1_7                 1.507969e-01    1         1  ON     7
     eH1_8                 1.645796e-01    1         1  ON     8
     eH1_9                 4.968283e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.461192e-01    1         1  ON     0
     eH2_1                -1.390233e-01    1         1  ON     1
     eH2_2                -8.956155e-02    1         1  ON     2
     eH2_3                -3.460410e-02    1         1  ON     3
     eH2_4                 1.430620e-02    1         1  ON     4
     eH2_5                 4.960727e-02    1         1  ON     5
     eH2_6                 1.052386e-01    1         1  ON     6
     eH2_7                 1.534309e-01    1         1  ON     7
     eH2_8                 1.693383e-01    1         1  ON     8
     eH2_9                 3.486813e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.935555e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2381e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 124
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8959
    reference variance = 0.398269
====================================================
  Execution time = 2.2040e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3939e-01
  Total weights = 1.951685386e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324427248957
                                         uncertainty =       0.002392989767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324427248957
                                         uncertainty =       0.002392989767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402703470
  error estimate for blocks of size 2^( 2) =       0.000415646651
  error estimate for blocks of size 2^( 3) =       0.000428800396
  error estimate for blocks of size 2^( 4) =       0.000441345070
  error estimate for blocks of size 2^( 5) =       0.000452760776
  error estimate for blocks of size 2^( 6) =       0.000461574927
  error estimate for blocks of size 2^( 7) =       0.000465518009

      target function =                  N/A
              le_mean =     -16.905639282051
             les_mean =     286.140031669564
             stat err =       0.000455299695
             autocorr =       1.278274058666
              std dev =       0.569508709112
             le_variance =       0.324340169754


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690563928205e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639282046       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905658220256       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905656816585       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905655077862       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905655305100       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905653051245       residual = 9.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905654150921       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905654011476       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905654025593       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905654548828       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905654708593       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905654851788       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 8.820286e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639282046       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905646623344       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905646452884       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905645830548       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905646022010       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905645384825       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905645467243       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905645489204       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905645520057       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905645579852       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 3.032471e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639282046       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905641410314       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905641403789       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905641302381       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905641343883       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905641145116       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905641161911       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905641156024       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905641172425       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905641175159       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 4.0000e+00 is 8.851667e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8302e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0    3.118813e-01                 1 1 ON  0
uu_1    1.447492e-01                 1 1 ON  1
uu_2    4.306826e-02                 1 1 ON  2
uu_3    -1.920687e-02                1 1 ON  3
uu_4    -6.458461e-02                1 1 ON  4
uu_5    -9.942350e-02                1 1 ON  5
uu_6    -1.265491e-01                1 1 ON  6
uu_7    -1.390873e-01                1 1 ON  7
uu_8    -1.311999e-01                1 1 ON  8
uu_9    -1.002969e-01                1 1 ON  9
ud_0    4.454749e-01                 1 1 ON  10
ud_1    1.799324e-01                 1 1 ON  11
ud_2    5.985106e-02                 1 1 ON  12
ud_3    -1.075305e-02                1 1 ON  13
ud_4    -6.719769e-02                1 1 ON  14
ud_5    -1.077742e-01                1 1 ON  15
ud_6    -1.341436e-01                1 1 ON  16
ud_7    -1.498293e-01                1 1 ON  17
ud_8    -1.506706e-01                1 1 ON  18
ud_9    -1.385894e-01                1 1 ON  19
eO_0    -7.471999e-01                1 1 ON  20
eO_1    -4.277239e-01                1 1 ON  21
eO_2    -1.910985e-02                1 1 ON  22
eO_3    2.903005e-01                 1 1 ON  23
eO_4    5.129981e-01                 1 1 ON  24
eO_5    4.730549e-01                 1 1 ON  25
eO_6    2.455482e-01                 1 1 ON  26
eO_7    -4.916022e-02                1 1 ON  27
eO_8    -2.100708e-01                1 1 ON  28
eO_9    -6.996180e-02                1 1 ON  29
eH1_0   -2.490964e-01                1 1 ON  30
eH1_1   -1.412253e-01                1 1 ON  31
eH1_2   -9.193470e-02                1 1 ON  32
eH1_3   -3.735881e-02                1 1 ON  33
eH1_4   1.163538e-02                 1 1 ON  34
eH1_5   4.517557e-02                 1 1 ON  35
eH1_6   1.014727e-01                 1 1 ON  36
eH1_7   1.508746e-01                 1 1 ON  37
eH1_8   1.647447e-01                 1 1 ON  38
eH1_9   4.988583e-02                 1 1 ON  39
eH2_0   -2.463086e-01                1 1 ON  40
eH2_1   -1.390831e-01                1 1 ON  41
eH2_2   -8.956692e-02                1 1 ON  42
eH2_3   -3.472881e-02                1 1 ON  43
eH2_4   1.428241e-02                 1 1 ON  44
eH2_5   4.950902e-02                 1 1 ON  45
eH2_6   1.052127e-01                 1 1 ON  46
eH2_7   1.535229e-01                 1 1 ON  47
eH2_8   1.695333e-01                 1 1 ON  48
eH2_9   3.508630e-02                 1 1 ON  49
ci_0001 7.014391e-01                 3 1 ON  50
ci_0002 7.001122e-01                 3 1 ON  51
ci_0003 -2.772591e-02                3 1 ON  52
ci_0004 -2.753212e-02                3 1 ON  53
ci_0005 -3.654529e-02                3 1 ON  54
ci_0006 -3.718036e-02                3 1 ON  55
ci_0007 -2.251232e-02                3 1 ON  56
ci_0008 -2.167042e-02                3 1 ON  57
ci_0009 -1.790504e-02                3 1 ON  58
ci_0010 -1.732174e-02                3 1 ON  59
ci_0011 -1.225606e-02                3 1 ON  60
ci_0012 -1.261513e-02                3 1 ON  61
ci_0013 1.281945e-02                 3 1 ON  62
ci_0014 1.318859e-02                 3 1 ON  63
ci_0015 1.366673e-02                 3 1 ON  64
ci_0016 1.347559e-02                 3 1 ON  65
ci_0017 1.097577e-02                 3 1 ON  66
ci_0018 1.185617e-02                 3 1 ON  67
ci_0019 1.132208e-02                 3 1 ON  68
ci_0020 1.140366e-02                 3 1 ON  69
ci_0021 -2.142940e-03                3 1 ON  70
ci_0022 -6.180044e-04                3 1 ON  71
ci_0023 -1.093510e-02                3 1 ON  72
ci_0024 -1.089526e-02                3 1 ON  73
ci_0025 -1.166678e-02                3 1 ON  74
ci_0026 -1.102257e-02                3 1 ON  75
ci_0027 -1.156207e-02                3 1 ON  76
ci_0028 -1.105698e-02                3 1 ON  77
ci_0029 -1.002773e-02                3 1 ON  78
ci_0030 -1.119111e-02                3 1 ON  79
ci_0031 2.043222e-02                 3 1 ON  80
ci_0032 2.103097e-02                 3 1 ON  81
ci_0033 1.047486e-02                 3 1 ON  82
ci_0034 9.912643e-03                 3 1 ON  83
ci_0035 6.477036e-03                 3 1 ON  84
ci_0036 6.923628e-03                 3 1 ON  85
ci_0037 -1.065097e-02                3 1 ON  86
ci_0038 -1.088564e-02                3 1 ON  87
ci_0039 -2.598880e-03                3 1 ON  88
ci_0040 -2.481619e-03                3 1 ON  89
ci_0041 6.621633e-03                 3 1 ON  90
ci_0042 7.321308e-03                 3 1 ON  91
ci_0043 -1.955408e-02                3 1 ON  92
ci_0044 -1.900970e-02                3 1 ON  93
ci_0045 7.501711e-03                 3 1 ON  94
ci_0046 7.365376e-03                 3 1 ON  95
ci_0047 -1.501343e-03                3 1 ON  96
ci_0048 -1.991638e-03                3 1 ON  97
ci_0049 -5.382446e-03                3 1 ON  98
ci_0050 -5.856647e-03                3 1 ON  99
ci_0051 -3.564652e-03                3 1 ON  100
ci_0052 -3.509155e-03                3 1 ON  101
ci_0053 -4.401774e-03                3 1 ON  102
ci_0054 -4.355092e-03                3 1 ON  103
ci_0055 6.578006e-03                 3 1 ON  104
ci_0056 6.244119e-03                 3 1 ON  105
ci_0057 4.832409e-03                 3 1 ON  106
ci_0058 4.731614e-03                 3 1 ON  107
ci_0059 -4.580205e-03                3 1 ON  108
ci_0060 -4.682366e-03                3 1 ON  109
ci_0061 -4.453473e-03                3 1 ON  110
ci_0062 -3.628721e-03                3 1 ON  111
ci_0063 -8.929129e-03                3 1 ON  112
ci_0064 -8.269029e-03                3 1 ON  113
ci_0065 -5.152773e-03                3 1 ON  114
ci_0066 -5.151795e-03                3 1 ON  115
ci_0067 -5.275374e-03                3 1 ON  116
ci_0068 -4.762720e-03                3 1 ON  117
ci_0069 4.758135e-03                 3 1 ON  118
ci_0070 4.574502e-03                 3 1 ON  119
ci_0071 3.662190e-04                 3 1 ON  120
ci_0072 -1.859637e-04                3 1 ON  121
ci_0073 4.285844e-03                 3 1 ON  122
ci_0074 4.273664e-03                 3 1 ON  123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.202137
====================================================
  Execution time = 2.3214e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3273e-01
  Total weights = 1.9517e+06
  Execution time = 1.9043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320144736140
                                         uncertainty =       0.002155045994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320144736140
                                         uncertainty =       0.002155045994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400084321
  error estimate for blocks of size 2^( 2) =       0.000412849220
  error estimate for blocks of size 2^( 3) =       0.000426070307
  error estimate for blocks of size 2^( 4) =       0.000438662119
  error estimate for blocks of size 2^( 5) =       0.000448314983
  error estimate for blocks of size 2^( 6) =       0.000455535023
  error estimate for blocks of size 2^( 7) =       0.000460169633

      target function =                  N/A
              le_mean =     -16.905838148499
             les_mean =     286.140328817204
             stat err =       0.000450670439
             autocorr =       1.268864015142
              std dev =       0.565804672965
             le_variance =       0.320134927949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320434985208
                                         uncertainty =       0.002178819767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320434985208
                                         uncertainty =       0.002178819767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400265198
  error estimate for blocks of size 2^( 2) =       0.000413033725
  error estimate for blocks of size 2^( 3) =       0.000426251505
  error estimate for blocks of size 2^( 4) =       0.000438824961
  error estimate for blocks of size 2^( 5) =       0.000448460661
  error estimate for blocks of size 2^( 6) =       0.000455684458
  error estimate for blocks of size 2^( 7) =       0.000460341597

      target function =                  N/A
              le_mean =     -16.905841835714
             les_mean =     286.141043978885
             stat err =       0.000450827919
             autocorr =       1.268603616957
              std dev =       0.566060471429
             le_variance =       0.320424457314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320369131341
                                         uncertainty =       0.002173704562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320369131341
                                         uncertainty =       0.002173704562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400224247
  error estimate for blocks of size 2^( 2) =       0.000412991232
  error estimate for blocks of size 2^( 3) =       0.000426210020
  error estimate for blocks of size 2^( 4) =       0.000438787993
  error estimate for blocks of size 2^( 5) =       0.000448427796
  error estimate for blocks of size 2^( 6) =       0.000455648768
  error estimate for blocks of size 2^( 7) =       0.000460300450

      target function =                  N/A
              le_mean =     -16.905837734224
             les_mean =     286.140415091394
             stat err =       0.000450791252
             autocorr =       1.268656840154
              std dev =       0.566002558559
             le_variance =       0.320358896296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320170574822
                                         uncertainty =       0.002157656259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320170574822
                                         uncertainty =       0.002157656259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400100436
  error estimate for blocks of size 2^( 2) =       0.000412865510
  error estimate for blocks of size 2^( 3) =       0.000426086498
  error estimate for blocks of size 2^( 4) =       0.000438676051
  error estimate for blocks of size 2^( 5) =       0.000448326858
  error estimate for blocks of size 2^( 6) =       0.000455547176
  error estimate for blocks of size 2^( 7) =       0.000460184721

      target function =                  N/A
              le_mean =     -16.905836806456
             les_mean =     286.140364031583
             stat err =       0.000450683701
             autocorr =       1.268836475771
              std dev =       0.565827463155
             le_variance =       0.320160718060


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905838148499        initial
     2.5000e-01     2.5000e+00             8.8203e-04       -16.905841835714  <--
     1.0000e+00     1.0000e+01             3.0325e-04       -16.905837734224
     4.0000e+00     4.0000e+01             8.8517e-05       -16.905836806456

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.2849e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
   uu_0                 3.121124e-01 1 1  ON 0
   uu_1                 1.447920e-01 1 1  ON 1
   uu_2                 4.307628e-02 1 1  ON 2
   uu_3                -1.928369e-02 1 1  ON 3
   uu_4                -6.469706e-02 1 1  ON 4
   uu_5                -9.962725e-02 1 1  ON 5
   uu_6                -1.267457e-01 1 1  ON 6
   uu_7                -1.393652e-01 1 1  ON 7
   uu_8                -1.313452e-01 1 1  ON 8
   uu_9                -1.003630e-01 1 1  ON 9
   ud_0                 4.456431e-01 1 1  ON 10
   ud_1                 1.799849e-01 1 1  ON 11
   ud_2                 5.985859e-02 1 1  ON 12
   ud_3                -1.071802e-02 1 1  ON 13
   ud_4                -6.717392e-02 1 1  ON 14
   ud_5                -1.077737e-01 1 1  ON 15
   ud_6                -1.341862e-01 1 1  ON 16
   ud_7                -1.499873e-01 1 1  ON 17
   ud_8                -1.507815e-01 1 1  ON 18
   ud_9                -1.386265e-01 1 1  ON 19
   eO_0                -7.474673e-01 1 1  ON 20
   eO_1                -4.278132e-01 1 1  ON 21
   eO_2                -1.919219e-02 1 1  ON 22
   eO_3                 2.904038e-01 1 1  ON 23
   eO_4                 5.130855e-01 1 1  ON 24
   eO_5                 4.734718e-01 1 1  ON 25
   eO_6                 2.458899e-01 1 1  ON 26
   eO_7                -4.901592e-02 1 1  ON 27
   eO_8                -2.103461e-01 1 1  ON 28
   eO_9                -7.029298e-02 1 1  ON 29
  eH1_0                -2.493721e-01 1 1  ON 30
  eH1_1                -1.416880e-01 1 1  ON 31
  eH1_2                -9.213399e-02 1 1  ON 32
  eH1_3                -3.738907e-02 1 1  ON 33
  eH1_4                 1.161325e-02 1 1  ON 34
  eH1_5                 4.475038e-02 1 1  ON 35
  eH1_6                 1.014203e-01 1 1  ON 36
  eH1_7                 1.510891e-01 1 1  ON 37
  eH1_8                 1.652460e-01 1 1  ON 38
  eH1_9                 5.050266e-02 1 1  ON 39
  eH2_0                -2.467926e-01 1 1  ON 40
  eH2_1                -1.393123e-01 1 1  ON 41
  eH2_2                -8.969853e-02 1 1  ON 42
  eH2_3                -3.500829e-02 1 1  ON 43
  eH2_4                 1.411403e-02 1 1  ON 44
  eH2_5                 4.926115e-02 1 1  ON 45
  eH2_6                 1.051486e-01 1 1  ON 46
  eH2_7                 1.538001e-01 1 1  ON 47
  eH2_8                 1.701297e-01 1 1  ON 48
  eH2_9                 3.575016e-02 1 1  ON 49
ci_0001                 7.013918e-01 3 1  ON 50
ci_0002                 7.001784e-01 3 1  ON 51
ci_0003                -2.757777e-02 3 1  ON 52
ci_0004                -2.759896e-02 3 1  ON 53
ci_0005                -3.630399e-02 3 1  ON 54
ci_0006                -3.733929e-02 3 1  ON 55
ci_0007                -2.249871e-02 3 1  ON 56
ci_0008                -2.194060e-02 3 1  ON 57
ci_0009                -1.799118e-02 3 1  ON 58
ci_0010                -1.704579e-02 3 1  ON 59
ci_0011                -1.235784e-02 3 1  ON 60
ci_0012                -1.306351e-02 3 1  ON 61
ci_0013                 1.251038e-02 3 1  ON 62
ci_0014                 1.319677e-02 3 1  ON 63
ci_0015                 1.373194e-02 3 1  ON 64
ci_0016                 1.343466e-02 3 1  ON 65
ci_0017                 1.095503e-02 3 1  ON 66
ci_0018                 1.176624e-02 3 1  ON 67
ci_0019                 1.125310e-02 3 1  ON 68
ci_0020                 1.116320e-02 3 1  ON 69
ci_0021                -2.258520e-03 3 1  ON 70
ci_0022                -8.763164e-04 3 1  ON 71
ci_0023                -1.067719e-02 3 1  ON 72
ci_0024                -1.087606e-02 3 1  ON 73
ci_0025                -1.154526e-02 3 1  ON 74
ci_0026                -1.093889e-02 3 1  ON 75
ci_0027                -1.140988e-02 3 1  ON 76
ci_0028                -1.142632e-02 3 1  ON 77
ci_0029                -1.015963e-02 3 1  ON 78
ci_0030                -1.105464e-02 3 1  ON 79
ci_0031                 2.058681e-02 3 1  ON 80
ci_0032                 2.049537e-02 3 1  ON 81
ci_0033                 1.072080e-02 3 1  ON 82
ci_0034                 1.013365e-02 3 1  ON 83
ci_0035                 6.531032e-03 3 1  ON 84
ci_0036                 6.969134e-03 3 1  ON 85
ci_0037                -1.078416e-02 3 1  ON 86
ci_0038                -1.033055e-02 3 1  ON 87
ci_0039                -2.681257e-03 3 1  ON 88
ci_0040                -2.131639e-03 3 1  ON 89
ci_0041                 6.597053e-03 3 1  ON 90
ci_0042                 7.301712e-03 3 1  ON 91
ci_0043                -1.975918e-02 3 1  ON 92
ci_0044                -1.905339e-02 3 1  ON 93
ci_0045                 7.519010e-03 3 1  ON 94
ci_0046                 7.273869e-03 3 1  ON 95
ci_0047                -1.431126e-03 3 1  ON 96
ci_0048                -2.152911e-03 3 1  ON 97
ci_0049                -5.441380e-03 3 1  ON 98
ci_0050                -5.754460e-03 3 1  ON 99
ci_0051                -3.497643e-03 3 1  ON 100
ci_0052                -3.659741e-03 3 1  ON 101
ci_0053                -4.275594e-03 3 1  ON 102
ci_0054                -4.392553e-03 3 1  ON 103
ci_0055                 6.942166e-03 3 1  ON 104
ci_0056                 6.130903e-03 3 1  ON 105
ci_0057                 5.004296e-03 3 1  ON 106
ci_0058                 4.542682e-03 3 1  ON 107
ci_0059                -4.549380e-03 3 1  ON 108
ci_0060                -4.762209e-03 3 1  ON 109
ci_0061                -4.314415e-03 3 1  ON 110
ci_0062                -3.393764e-03 3 1  ON 111
ci_0063                -8.614513e-03 3 1  ON 112
ci_0064                -8.303296e-03 3 1  ON 113
ci_0065                -5.321906e-03 3 1  ON 114
ci_0066                -5.203603e-03 3 1  ON 115
ci_0067                -5.237775e-03 3 1  ON 116
ci_0068                -4.503706e-03 3 1  ON 117
ci_0069                 4.936180e-03 3 1  ON 118
ci_0070                 4.615422e-03 3 1  ON 119
ci_0071                 6.255387e-05 3 1  ON 120
ci_0072                 1.712758e-04 3 1  ON 121
ci_0073                 4.336815e-03 3 1  ON 122
ci_0074                 4.533466e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9079
    reference variance = 0.204924
====================================================
  Execution time = 2.1611e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3374e-01
  Total weights = 1.951316718e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321482597664
                                         uncertainty =       0.002098522939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321482597664
                                         uncertainty =       0.002098522939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400907414
  error estimate for blocks of size 2^( 2) =       0.000414032436
  error estimate for blocks of size 2^( 3) =       0.000427549554
  error estimate for blocks of size 2^( 4) =       0.000440500416
  error estimate for blocks of size 2^( 5) =       0.000451994982
  error estimate for blocks of size 2^( 6) =       0.000461999232
  error estimate for blocks of size 2^( 7) =       0.000466470518

      target function =                  N/A
              le_mean =     -16.905639004544
             les_mean =     286.134366855470
             stat err =       0.000455241287
             autocorr =       1.289422100597
              std dev =       0.566968702155
             le_variance =       0.321453509224


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563900454e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639004544       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905657668156       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905651154656       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905651593302       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905653883062       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905651966822       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905657127144       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905658520133       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905658403310       residual = 9.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905659371818       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905659372426       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905660055555       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905660556021       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905660428834       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905660696853       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905660848847       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905660719020       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905660783880       residual = 6.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-02 is 4.177413e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639004544       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905650635617       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905648287750       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905647791928       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905649775298       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905649018470       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905650448446       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905650345253       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905649963477       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905650015809       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905650300913       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905650313709       residual = 6.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 1.019767e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905639004544       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905643643570       residual = 4.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905643278555       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905642929729       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905643597442       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905643652836       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905643791643       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905643590462       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905643593040       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905643547831       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 4.079622e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180155 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7810e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
   uu_0                 3.122061e-01 1 1  ON 0
   uu_1                 1.447211e-01 1 1  ON 1
   uu_2                 4.302827e-02 1 1  ON 2
   uu_3                -1.933173e-02 1 1  ON 3
   uu_4                -6.473210e-02 1 1  ON 4
   uu_5                -9.968422e-02 1 1  ON 5
   uu_6                -1.271077e-01 1 1  ON 6
   uu_7                -1.396112e-01 1 1  ON 7
   uu_8                -1.317999e-01 1 1  ON 8
   uu_9                -1.004717e-01 1 1  ON 9
   ud_0                 4.456052e-01 1 1  ON 10
   ud_1                 1.799683e-01 1 1  ON 11
   ud_2                 5.982382e-02 1 1  ON 12
   ud_3                -1.077981e-02 1 1  ON 13
   ud_4                -6.715460e-02 1 1  ON 14
   ud_5                -1.079930e-01 1 1  ON 15
   ud_6                -1.342062e-01 1 1  ON 16
   ud_7                -1.499673e-01 1 1  ON 17
   ud_8                -1.507005e-01 1 1  ON 18
   ud_9                -1.385286e-01 1 1  ON 19
   eO_0                -7.480437e-01 1 1  ON 20
   eO_1                -4.281586e-01 1 1  ON 21
   eO_2                -1.931520e-02 1 1  ON 22
   eO_3                 2.906984e-01 1 1  ON 23
   eO_4                 5.130897e-01 1 1  ON 24
   eO_5                 4.739375e-01 1 1  ON 25
   eO_6                 2.468164e-01 1 1  ON 26
   eO_7                -4.859362e-02 1 1  ON 27
   eO_8                -2.108552e-01 1 1  ON 28
   eO_9                -7.078700e-02 1 1  ON 29
  eH1_0                -2.494748e-01 1 1  ON 30
  eH1_1                -1.423534e-01 1 1  ON 31
  eH1_2                -9.265169e-02 1 1  ON 32
  eH1_3                -3.793006e-02 1 1  ON 33
  eH1_4                 1.097632e-02 1 1  ON 34
  eH1_5                 4.442212e-02 1 1  ON 35
  eH1_6                 1.014769e-01 1 1  ON 36
  eH1_7                 1.516811e-01 1 1  ON 37
  eH1_8                 1.662366e-01 1 1  ON 38
  eH1_9                 5.152243e-02 1 1  ON 39
  eH2_0                -2.469041e-01 1 1  ON 40
  eH2_1                -1.394119e-01 1 1  ON 41
  eH2_2                -9.012410e-02 1 1  ON 42
  eH2_3                -3.516091e-02 1 1  ON 43
  eH2_4                 1.383087e-02 1 1  ON 44
  eH2_5                 4.886182e-02 1 1  ON 45
  eH2_6                 1.048396e-01 1 1  ON 46
  eH2_7                 1.541919e-01 1 1  ON 47
  eH2_8                 1.707195e-01 1 1  ON 48
  eH2_9                 3.649947e-02 1 1  ON 49
ci_0001                 7.016216e-01 3 1  ON 50
ci_0002                 7.000821e-01 3 1  ON 51
ci_0003                -2.763326e-02 3 1  ON 52
ci_0004                -2.706893e-02 3 1  ON 53
ci_0005                -3.606184e-02 3 1  ON 54
ci_0006                -3.714130e-02 3 1  ON 55
ci_0007                -2.252834e-02 3 1  ON 56
ci_0008                -2.113911e-02 3 1  ON 57
ci_0009                -1.789584e-02 3 1  ON 58
ci_0010                -1.745108e-02 3 1  ON 59
ci_0011                -1.223290e-02 3 1  ON 60
ci_0012                -1.274599e-02 3 1  ON 61
ci_0013                 1.246753e-02 3 1  ON 62
ci_0014                 1.276496e-02 3 1  ON 63
ci_0015                 1.329710e-02 3 1  ON 64
ci_0016                 1.360767e-02 3 1  ON 65
ci_0017                 1.121464e-02 3 1  ON 66
ci_0018                 1.156138e-02 3 1  ON 67
ci_0019                 1.141936e-02 3 1  ON 68
ci_0020                 1.096543e-02 3 1  ON 69
ci_0021                -1.743836e-03 3 1  ON 70
ci_0022                -1.333888e-03 3 1  ON 71
ci_0023                -1.079711e-02 3 1  ON 72
ci_0024                -1.108936e-02 3 1  ON 73
ci_0025                -1.111897e-02 3 1  ON 74
ci_0026                -1.069885e-02 3 1  ON 75
ci_0027                -1.108299e-02 3 1  ON 76
ci_0028                -1.082812e-02 3 1  ON 77
ci_0029                -1.013201e-02 3 1  ON 78
ci_0030                -1.111483e-02 3 1  ON 79
ci_0031                 2.006217e-02 3 1  ON 80
ci_0032                 2.062267e-02 3 1  ON 81
ci_0033                 1.033229e-02 3 1  ON 82
ci_0034                 1.014294e-02 3 1  ON 83
ci_0035                 6.969003e-03 3 1  ON 84
ci_0036                 6.763745e-03 3 1  ON 85
ci_0037                -1.099819e-02 3 1  ON 86
ci_0038                -1.085816e-02 3 1  ON 87
ci_0039                -2.792533e-03 3 1  ON 88
ci_0040                -2.796863e-03 3 1  ON 89
ci_0041                 6.547445e-03 3 1  ON 90
ci_0042                 7.379577e-03 3 1  ON 91
ci_0043                -1.906473e-02 3 1  ON 92
ci_0044                -1.904268e-02 3 1  ON 93
ci_0045                 7.558525e-03 3 1  ON 94
ci_0046                 7.001614e-03 3 1  ON 95
ci_0047                -1.722673e-03 3 1  ON 96
ci_0048                -2.023982e-03 3 1  ON 97
ci_0049                -5.566333e-03 3 1  ON 98
ci_0050                -5.853301e-03 3 1  ON 99
ci_0051                -3.321407e-03 3 1  ON 100
ci_0052                -3.481503e-03 3 1  ON 101
ci_0053                -4.560033e-03 3 1  ON 102
ci_0054                -4.411764e-03 3 1  ON 103
ci_0055                 6.639829e-03 3 1  ON 104
ci_0056                 6.594197e-03 3 1  ON 105
ci_0057                 4.774634e-03 3 1  ON 106
ci_0058                 4.614438e-03 3 1  ON 107
ci_0059                -4.943314e-03 3 1  ON 108
ci_0060                -4.769267e-03 3 1  ON 109
ci_0061                -3.722856e-03 3 1  ON 110
ci_0062                -3.359123e-03 3 1  ON 111
ci_0063                -8.542810e-03 3 1  ON 112
ci_0064                -8.482041e-03 3 1  ON 113
ci_0065                -4.805251e-03 3 1  ON 114
ci_0066                -5.721258e-03 3 1  ON 115
ci_0067                -4.858100e-03 3 1  ON 116
ci_0068                -4.803874e-03 3 1  ON 117
ci_0069                 4.435713e-03 3 1  ON 118
ci_0070                 4.601216e-03 3 1  ON 119
ci_0071                 5.386853e-05 3 1  ON 120
ci_0072                 4.519083e-04 3 1  ON 121
ci_0073                 4.439775e-03 3 1  ON 122
ci_0074                 3.601961e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9572
    reference variance = 0.309106
====================================================
  Execution time = 2.1311e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4047e-01
  Total weights = 1.9519e+06
  Execution time = 1.9013e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326607864994
                                         uncertainty =       0.003272238372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326607864994
                                         uncertainty =       0.003272238372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404117849
  error estimate for blocks of size 2^( 2) =       0.000416731346
  error estimate for blocks of size 2^( 3) =       0.000429930576
  error estimate for blocks of size 2^( 4) =       0.000442875191
  error estimate for blocks of size 2^( 5) =       0.000453742251
  error estimate for blocks of size 2^( 6) =       0.000460414689
  error estimate for blocks of size 2^( 7) =       0.000464973839

      target function =                  N/A
              le_mean =     -16.906031967870
             les_mean =     286.157227392756
             stat err =       0.000455501493
             autocorr =       1.270467452043
              std dev =       0.571508942882
             le_variance =       0.326622471794

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326308749410
                                         uncertainty =       0.003251158717

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326308749410
                                         uncertainty =       0.003251158717

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403932044
  error estimate for blocks of size 2^( 2) =       0.000416573335
  error estimate for blocks of size 2^( 3) =       0.000429767843
  error estimate for blocks of size 2^( 4) =       0.000442712904
  error estimate for blocks of size 2^( 5) =       0.000453552091
  error estimate for blocks of size 2^( 6) =       0.000460187150
  error estimate for blocks of size 2^( 7) =       0.000464747783

      target function =                  N/A
              le_mean =     -16.906047485741
             les_mean =     286.203596487456
             stat err =       0.000455299982
             autocorr =       1.270511650537
              std dev =       0.571246175019
             le_variance =       0.326322192474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326297467356
                                         uncertainty =       0.003220056459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326297467356
                                         uncertainty =       0.003220056459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403924659
  error estimate for blocks of size 2^( 2) =       0.000416568568
  error estimate for blocks of size 2^( 3) =       0.000429768408
  error estimate for blocks of size 2^( 4) =       0.000442731120
  error estimate for blocks of size 2^( 5) =       0.000453566343
  error estimate for blocks of size 2^( 6) =       0.000460220142
  error estimate for blocks of size 2^( 7) =       0.000464803580

      target function =                  N/A
              le_mean =     -16.906066057306
             les_mean =     287.158284821840
             stat err =       0.000455330296
             autocorr =       1.270727306798
              std dev =       0.571235730339
             le_variance =       0.326310259616

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326418196268
                                         uncertainty =       0.003257492582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326418196268
                                         uncertainty =       0.003257492582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404000288
  error estimate for blocks of size 2^( 2) =       0.000416622444
  error estimate for blocks of size 2^( 3) =       0.000429819746
  error estimate for blocks of size 2^( 4) =       0.000442765446
  error estimate for blocks of size 2^( 5) =       0.000453626102
  error estimate for blocks of size 2^( 6) =       0.000460303359
  error estimate for blocks of size 2^( 7) =       0.000464870328

      target function =                  N/A
              le_mean =     -16.906026114061
             les_mean =     286.167918409861
             stat err =       0.000455391309
             autocorr =       1.270592024344
              std dev =       0.571342687181
             le_variance =       0.326432466195


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906031967870        initial
     6.2500e-02     6.2500e-01             4.1774e-03       -16.906047485741
     2.5000e-01     2.5000e+00             1.0198e-03       -16.906066057306  <--
     1.0000e+00     1.0000e+01             4.0796e-04       -16.906026114061

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0933e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
   uu_0                 3.122061e-01 1 1  ON 0
   uu_1                 1.447211e-01 1 1  ON 1
   uu_2                 4.302827e-02 1 1  ON 2
   uu_3                -1.933173e-02 1 1  ON 3
   uu_4                -6.473210e-02 1 1  ON 4
   uu_5                -9.968422e-02 1 1  ON 5
   uu_6                -1.271077e-01 1 1  ON 6
   uu_7                -1.396112e-01 1 1  ON 7
   uu_8                -1.317999e-01 1 1  ON 8
   uu_9                -1.004717e-01 1 1  ON 9
   ud_0                 4.456052e-01 1 1  ON 10
   ud_1                 1.799683e-01 1 1  ON 11
   ud_2                 5.982382e-02 1 1  ON 12
   ud_3                -1.077981e-02 1 1  ON 13
   ud_4                -6.715460e-02 1 1  ON 14
   ud_5                -1.079930e-01 1 1  ON 15
   ud_6                -1.342062e-01 1 1  ON 16
   ud_7                -1.499673e-01 1 1  ON 17
   ud_8                -1.507005e-01 1 1  ON 18
   ud_9                -1.385286e-01 1 1  ON 19
   eO_0                -7.480437e-01 1 1  ON 20
   eO_1                -4.281586e-01 1 1  ON 21
   eO_2                -1.931520e-02 1 1  ON 22
   eO_3                 2.906984e-01 1 1  ON 23
   eO_4                 5.130897e-01 1 1  ON 24
   eO_5                 4.739375e-01 1 1  ON 25
   eO_6                 2.468164e-01 1 1  ON 26
   eO_7                -4.859362e-02 1 1  ON 27
   eO_8                -2.108552e-01 1 1  ON 28
   eO_9                -7.078700e-02 1 1  ON 29
  eH1_0                -2.494748e-01 1 1  ON 30
  eH1_1                -1.423534e-01 1 1  ON 31
  eH1_2                -9.265169e-02 1 1  ON 32
  eH1_3                -3.793006e-02 1 1  ON 33
  eH1_4                 1.097632e-02 1 1  ON 34
  eH1_5                 4.442212e-02 1 1  ON 35
  eH1_6                 1.014769e-01 1 1  ON 36
  eH1_7                 1.516811e-01 1 1  ON 37
  eH1_8                 1.662366e-01 1 1  ON 38
  eH1_9                 5.152243e-02 1 1  ON 39
  eH2_0                -2.469041e-01 1 1  ON 40
  eH2_1                -1.394119e-01 1 1  ON 41
  eH2_2                -9.012410e-02 1 1  ON 42
  eH2_3                -3.516091e-02 1 1  ON 43
  eH2_4                 1.383087e-02 1 1  ON 44
  eH2_5                 4.886182e-02 1 1  ON 45
  eH2_6                 1.048396e-01 1 1  ON 46
  eH2_7                 1.541919e-01 1 1  ON 47
  eH2_8                 1.707195e-01 1 1  ON 48
  eH2_9                 3.649947e-02 1 1  ON 49
ci_0001                 7.016216e-01 3 1  ON 50
ci_0002                 7.000821e-01 3 1  ON 51
ci_0003                -2.763326e-02 3 1  ON 52
ci_0004                -2.706893e-02 3 1  ON 53
ci_0005                -3.606184e-02 3 1  ON 54
ci_0006                -3.714130e-02 3 1  ON 55
ci_0007                -2.252834e-02 3 1  ON 56
ci_0008                -2.113911e-02 3 1  ON 57
ci_0009                -1.789584e-02 3 1  ON 58
ci_0010                -1.745108e-02 3 1  ON 59
ci_0011                -1.223290e-02 3 1  ON 60
ci_0012                -1.274599e-02 3 1  ON 61
ci_0013                 1.246753e-02 3 1  ON 62
ci_0014                 1.276496e-02 3 1  ON 63
ci_0015                 1.329710e-02 3 1  ON 64
ci_0016                 1.360767e-02 3 1  ON 65
ci_0017                 1.121464e-02 3 1  ON 66
ci_0018                 1.156138e-02 3 1  ON 67
ci_0019                 1.141936e-02 3 1  ON 68
ci_0020                 1.096543e-02 3 1  ON 69
ci_0021                -1.743836e-03 3 1  ON 70
ci_0022                -1.333888e-03 3 1  ON 71
ci_0023                -1.079711e-02 3 1  ON 72
ci_0024                -1.108936e-02 3 1  ON 73
ci_0025                -1.111897e-02 3 1  ON 74
ci_0026                -1.069885e-02 3 1  ON 75
ci_0027                -1.108299e-02 3 1  ON 76
ci_0028                -1.082812e-02 3 1  ON 77
ci_0029                -1.013201e-02 3 1  ON 78
ci_0030                -1.111483e-02 3 1  ON 79
ci_0031                 2.006217e-02 3 1  ON 80
ci_0032                 2.062267e-02 3 1  ON 81
ci_0033                 1.033229e-02 3 1  ON 82
ci_0034                 1.014294e-02 3 1  ON 83
ci_0035                 6.969003e-03 3 1  ON 84
ci_0036                 6.763745e-03 3 1  ON 85
ci_0037                -1.099819e-02 3 1  ON 86
ci_0038                -1.085816e-02 3 1  ON 87
ci_0039                -2.792533e-03 3 1  ON 88
ci_0040                -2.796863e-03 3 1  ON 89
ci_0041                 6.547445e-03 3 1  ON 90
ci_0042                 7.379577e-03 3 1  ON 91
ci_0043                -1.906473e-02 3 1  ON 92
ci_0044                -1.904268e-02 3 1  ON 93
ci_0045                 7.558525e-03 3 1  ON 94
ci_0046                 7.001614e-03 3 1  ON 95
ci_0047                -1.722673e-03 3 1  ON 96
ci_0048                -2.023982e-03 3 1  ON 97
ci_0049                -5.566333e-03 3 1  ON 98
ci_0050                -5.853301e-03 3 1  ON 99
ci_0051                -3.321407e-03 3 1  ON 100
ci_0052                -3.481503e-03 3 1  ON 101
ci_0053                -4.560033e-03 3 1  ON 102
ci_0054                -4.411764e-03 3 1  ON 103
ci_0055                 6.639829e-03 3 1  ON 104
ci_0056                 6.594197e-03 3 1  ON 105
ci_0057                 4.774634e-03 3 1  ON 106
ci_0058                 4.614438e-03 3 1  ON 107
ci_0059                -4.943314e-03 3 1  ON 108
ci_0060                -4.769267e-03 3 1  ON 109
ci_0061                -3.722856e-03 3 1  ON 110
ci_0062                -3.359123e-03 3 1  ON 111
ci_0063                -8.542810e-03 3 1  ON 112
ci_0064                -8.482041e-03 3 1  ON 113
ci_0065                -4.805251e-03 3 1  ON 114
ci_0066                -5.721258e-03 3 1  ON 115
ci_0067                -4.858100e-03 3 1  ON 116
ci_0068                -4.803874e-03 3 1  ON 117
ci_0069                 4.435713e-03 3 1  ON 118
ci_0070                 4.601216e-03 3 1  ON 119
ci_0071                 5.386853e-05 3 1  ON 120
ci_0072                 4.519083e-04 3 1  ON 121
ci_0073                 4.439775e-03 3 1  ON 122
ci_0074                 3.601961e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8756e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9388
    reference variance = 0.385233
====================================================
  Execution time = 2.1705e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3318e-01
  Total weights = 1.951877547e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320135714759
                                         uncertainty =       0.002440170149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320135714759
                                         uncertainty =       0.002440170149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400060981
  error estimate for blocks of size 2^( 2) =       0.000412674079
  error estimate for blocks of size 2^( 3) =       0.000425808921
  error estimate for blocks of size 2^( 4) =       0.000438647142
  error estimate for blocks of size 2^( 5) =       0.000447881203
  error estimate for blocks of size 2^( 6) =       0.000453344478
  error estimate for blocks of size 2^( 7) =       0.000457601701

      target function =                  N/A
              le_mean =     -16.906397797411
             les_mean =     286.159463755287
             stat err =       0.000449368631
             autocorr =       1.261691314755
              std dev =       0.565771665217
             le_variance =       0.320097577162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690639779741e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906397797417       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906414213804       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906413024498       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906417656544       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906414852617       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906412639929       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906413258905       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906414163983       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906417096583       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906417084569       residual = 4.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906418254547       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906417963931       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906419402622       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906418780535       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906418943446       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906419063627       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906419304100       residual = 7.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-02 is 4.381739e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906397797417       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906407663714       residual = 6.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906406969747       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906406868648       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906408294908       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906405932223       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906406830126       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906406752884       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906407532141       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906407548763       residual = 3.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906407864229       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906407883179       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906407820232       residual = 1.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 1.108831e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906397797417       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906401598005       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906401461693       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906400943724       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906401495874       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906400876549       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906401106477       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906401086910       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906401231208       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906401285130       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 2.697336e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7859e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
   uu_0                 3.121868e-01 1 1  ON 0
   uu_1                 1.449027e-01 1 1  ON 1
   uu_2                 4.312757e-02 1 1  ON 2
   uu_3                -1.924135e-02 1 1  ON 3
   uu_4                -6.460448e-02 1 1  ON 4
   uu_5                -9.949997e-02 1 1  ON 5
   uu_6                -1.270358e-01 1 1  ON 6
   uu_7                -1.400487e-01 1 1  ON 7
   uu_8                -1.321826e-01 1 1  ON 8
   uu_9                -1.009985e-01 1 1  ON 9
   ud_0                 4.460392e-01 1 1  ON 10
   ud_1                 1.802281e-01 1 1  ON 11
   ud_2                 6.005471e-02 1 1  ON 12
   ud_3                -1.054274e-02 1 1  ON 13
   ud_4                -6.700158e-02 1 1  ON 14
   ud_5                -1.079223e-01 1 1  ON 15
   ud_6                -1.343725e-01 1 1  ON 16
   ud_7                -1.498739e-01 1 1  ON 17
   ud_8                -1.510435e-01 1 1  ON 18
   ud_9                -1.391051e-01 1 1  ON 19
   eO_0                -7.484265e-01 1 1  ON 20
   eO_1                -4.285153e-01 1 1  ON 21
   eO_2                -1.904670e-02 1 1  ON 22
   eO_3                 2.909731e-01 1 1  ON 23
   eO_4                 5.133761e-01 1 1  ON 24
   eO_5                 4.740862e-01 1 1  ON 25
   eO_6                 2.473822e-01 1 1  ON 26
   eO_7                -4.809252e-02 1 1  ON 27
   eO_8                -2.114644e-01 1 1  ON 28
   eO_9                -7.137409e-02 1 1  ON 29
  eH1_0                -2.496403e-01 1 1  ON 30
  eH1_1                -1.423292e-01 1 1  ON 31
  eH1_2                -9.293600e-02 1 1  ON 32
  eH1_3                -3.822554e-02 1 1  ON 33
  eH1_4                 1.085362e-02 1 1  ON 34
  eH1_5                 4.441231e-02 1 1  ON 35
  eH1_6                 1.013149e-01 1 1  ON 36
  eH1_7                 1.516840e-01 1 1  ON 37
  eH1_8                 1.667596e-01 1 1  ON 38
  eH1_9                 5.205026e-02 1 1  ON 39
  eH2_0                -2.470870e-01 1 1  ON 40
  eH2_1                -1.399904e-01 1 1  ON 41
  eH2_2                -9.054627e-02 1 1  ON 42
  eH2_3                -3.540926e-02 1 1  ON 43
  eH2_4                 1.345221e-02 1 1  ON 44
  eH2_5                 4.871826e-02 1 1  ON 45
  eH2_6                 1.048344e-01 1 1  ON 46
  eH2_7                 1.543013e-01 1 1  ON 47
  eH2_8                 1.714627e-01 1 1  ON 48
  eH2_9                 3.760830e-02 1 1  ON 49
ci_0001                 7.014258e-01 3 1  ON 50
ci_0002                 7.003647e-01 3 1  ON 51
ci_0003                -2.734006e-02 3 1  ON 52
ci_0004                -2.671332e-02 3 1  ON 53
ci_0005                -3.589966e-02 3 1  ON 54
ci_0006                -3.680362e-02 3 1  ON 55
ci_0007                -2.212112e-02 3 1  ON 56
ci_0008                -2.138813e-02 3 1  ON 57
ci_0009                -1.765218e-02 3 1  ON 58
ci_0010                -1.767850e-02 3 1  ON 59
ci_0011                -1.208015e-02 3 1  ON 60
ci_0012                -1.284253e-02 3 1  ON 61
ci_0013                 1.260473e-02 3 1  ON 62
ci_0014                 1.295290e-02 3 1  ON 63
ci_0015                 1.344047e-02 3 1  ON 64
ci_0016                 1.323075e-02 3 1  ON 65
ci_0017                 1.150859e-02 3 1  ON 66
ci_0018                 1.127630e-02 3 1  ON 67
ci_0019                 1.103143e-02 3 1  ON 68
ci_0020                 1.140399e-02 3 1  ON 69
ci_0021                -1.223092e-03 3 1  ON 70
ci_0022                -8.354092e-04 3 1  ON 71
ci_0023                -1.097722e-02 3 1  ON 72
ci_0024                -1.117376e-02 3 1  ON 73
ci_0025                -1.094860e-02 3 1  ON 74
ci_0026                -1.047167e-02 3 1  ON 75
ci_0027                -1.104841e-02 3 1  ON 76
ci_0028                -1.056569e-02 3 1  ON 77
ci_0029                -1.057495e-02 3 1  ON 78
ci_0030                -1.083504e-02 3 1  ON 79
ci_0031                 1.973525e-02 3 1  ON 80
ci_0032                 2.057734e-02 3 1  ON 81
ci_0033                 1.045886e-02 3 1  ON 82
ci_0034                 9.879441e-03 3 1  ON 83
ci_0035                 7.055254e-03 3 1  ON 84
ci_0036                 6.735548e-03 3 1  ON 85
ci_0037                -1.034523e-02 3 1  ON 86
ci_0038                -1.090405e-02 3 1  ON 87
ci_0039                -2.479572e-03 3 1  ON 88
ci_0040                -2.806053e-03 3 1  ON 89
ci_0041                 6.796716e-03 3 1  ON 90
ci_0042                 7.158483e-03 3 1  ON 91
ci_0043                -1.879230e-02 3 1  ON 92
ci_0044                -1.919263e-02 3 1  ON 93
ci_0045                 7.881716e-03 3 1  ON 94
ci_0046                 7.087636e-03 3 1  ON 95
ci_0047                -1.565513e-03 3 1  ON 96
ci_0048                -2.094374e-03 3 1  ON 97
ci_0049                -5.309265e-03 3 1  ON 98
ci_0050                -5.639495e-03 3 1  ON 99
ci_0051                -3.069195e-03 3 1  ON 100
ci_0052                -3.339969e-03 3 1  ON 101
ci_0053                -4.508886e-03 3 1  ON 102
ci_0054                -4.715091e-03 3 1  ON 103
ci_0055                 6.600319e-03 3 1  ON 104
ci_0056                 6.143163e-03 3 1  ON 105
ci_0057                 4.776670e-03 3 1  ON 106
ci_0058                 4.684129e-03 3 1  ON 107
ci_0059                -4.648772e-03 3 1  ON 108
ci_0060                -4.829962e-03 3 1  ON 109
ci_0061                -3.622202e-03 3 1  ON 110
ci_0062                -3.117534e-03 3 1  ON 111
ci_0063                -8.686611e-03 3 1  ON 112
ci_0064                -8.937475e-03 3 1  ON 113
ci_0065                -5.191334e-03 3 1  ON 114
ci_0066                -5.800482e-03 3 1  ON 115
ci_0067                -5.169893e-03 3 1  ON 116
ci_0068                -4.476684e-03 3 1  ON 117
ci_0069                 4.650012e-03 3 1  ON 118
ci_0070                 4.428521e-03 3 1  ON 119
ci_0071                 2.816867e-04 3 1  ON 120
ci_0072                 2.178806e-04 3 1  ON 121
ci_0073                 4.281920e-03 3 1  ON 122
ci_0074                 3.878391e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9636
    reference variance = 0.400657
====================================================
  Execution time = 2.1168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3402e-01
  Total weights = 1.9518e+06
  Execution time = 1.9040e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319310240546
                                         uncertainty =       0.002245075221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319310240546
                                         uncertainty =       0.002245075221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399563839
  error estimate for blocks of size 2^( 2) =       0.000412283319
  error estimate for blocks of size 2^( 3) =       0.000425510818
  error estimate for blocks of size 2^( 4) =       0.000437957396
  error estimate for blocks of size 2^( 5) =       0.000448380629
  error estimate for blocks of size 2^( 6) =       0.000456110320
  error estimate for blocks of size 2^( 7) =       0.000462073190

      target function =                  N/A
              le_mean =     -16.906225007612
             les_mean =     286.163863408734
             stat err =       0.000451130384
             autocorr =       1.274769904046
              std dev =       0.565068599901
             le_variance =       0.319302522595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319458385256
                                         uncertainty =       0.002282715435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319458385256
                                         uncertainty =       0.002282715435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399655914
  error estimate for blocks of size 2^( 2) =       0.000412359238
  error estimate for blocks of size 2^( 3) =       0.000425556919
  error estimate for blocks of size 2^( 4) =       0.000437988672
  error estimate for blocks of size 2^( 5) =       0.000448397326
  error estimate for blocks of size 2^( 6) =       0.000456150902
  error estimate for blocks of size 2^( 7) =       0.000462151315

      target function =                  N/A
              le_mean =     -16.906217956953
             les_mean =     286.190942510304
             stat err =       0.000451172054
             autocorr =       1.274417994386
              std dev =       0.565198813341
             le_variance =       0.319449698602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319252538660
                                         uncertainty =       0.002267528245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319252538660
                                         uncertainty =       0.002267528245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399527642
  error estimate for blocks of size 2^( 2) =       0.000412237322
  error estimate for blocks of size 2^( 3) =       0.000425445218
  error estimate for blocks of size 2^( 4) =       0.000437886846
  error estimate for blocks of size 2^( 5) =       0.000448285069
  error estimate for blocks of size 2^( 6) =       0.000456034994
  error estimate for blocks of size 2^( 7) =       0.000462032239

      target function =                  N/A
              le_mean =     -16.906226047252
             les_mean =     286.156466266461
             stat err =       0.000451059787
             autocorr =       1.274601884028
              std dev =       0.565017410503
             le_variance =       0.319244674171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319218766529
                                         uncertainty =       0.002248724469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319218766529
                                         uncertainty =       0.002248724469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399506650
  error estimate for blocks of size 2^( 2) =       0.000412227259
  error estimate for blocks of size 2^( 3) =       0.000425455478
  error estimate for blocks of size 2^( 4) =       0.000437900455
  error estimate for blocks of size 2^( 5) =       0.000448318425
  error estimate for blocks of size 2^( 6) =       0.000456051069
  error estimate for blocks of size 2^( 7) =       0.000462043806

      target function =                  N/A
              le_mean =     -16.906223777643
             les_mean =     286.154434256812
             stat err =       0.000451078439
             autocorr =       1.274841259980
              std dev =       0.564987723341
             le_variance =       0.319211127526


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906225007612        initial
     6.2500e-02     6.2500e-01             4.3817e-03       -16.906217956953
     2.5000e-01     2.5000e+00             1.1088e-03       -16.906226047252  <--
     1.0000e+00     1.0000e+01             2.6973e-04       -16.906223777643

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0802e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
   uu_0                 3.121868e-01 1 1  ON 0
   uu_1                 1.449027e-01 1 1  ON 1
   uu_2                 4.312757e-02 1 1  ON 2
   uu_3                -1.924135e-02 1 1  ON 3
   uu_4                -6.460448e-02 1 1  ON 4
   uu_5                -9.949997e-02 1 1  ON 5
   uu_6                -1.270358e-01 1 1  ON 6
   uu_7                -1.400487e-01 1 1  ON 7
   uu_8                -1.321826e-01 1 1  ON 8
   uu_9                -1.009985e-01 1 1  ON 9
   ud_0                 4.460392e-01 1 1  ON 10
   ud_1                 1.802281e-01 1 1  ON 11
   ud_2                 6.005471e-02 1 1  ON 12
   ud_3                -1.054274e-02 1 1  ON 13
   ud_4                -6.700158e-02 1 1  ON 14
   ud_5                -1.079223e-01 1 1  ON 15
   ud_6                -1.343725e-01 1 1  ON 16
   ud_7                -1.498739e-01 1 1  ON 17
   ud_8                -1.510435e-01 1 1  ON 18
   ud_9                -1.391051e-01 1 1  ON 19
   eO_0                -7.484265e-01 1 1  ON 20
   eO_1                -4.285153e-01 1 1  ON 21
   eO_2                -1.904670e-02 1 1  ON 22
   eO_3                 2.909731e-01 1 1  ON 23
   eO_4                 5.133761e-01 1 1  ON 24
   eO_5                 4.740862e-01 1 1  ON 25
   eO_6                 2.473822e-01 1 1  ON 26
   eO_7                -4.809252e-02 1 1  ON 27
   eO_8                -2.114644e-01 1 1  ON 28
   eO_9                -7.137409e-02 1 1  ON 29
  eH1_0                -2.496403e-01 1 1  ON 30
  eH1_1                -1.423292e-01 1 1  ON 31
  eH1_2                -9.293600e-02 1 1  ON 32
  eH1_3                -3.822554e-02 1 1  ON 33
  eH1_4                 1.085362e-02 1 1  ON 34
  eH1_5                 4.441231e-02 1 1  ON 35
  eH1_6                 1.013149e-01 1 1  ON 36
  eH1_7                 1.516840e-01 1 1  ON 37
  eH1_8                 1.667596e-01 1 1  ON 38
  eH1_9                 5.205026e-02 1 1  ON 39
  eH2_0                -2.470870e-01 1 1  ON 40
  eH2_1                -1.399904e-01 1 1  ON 41
  eH2_2                -9.054627e-02 1 1  ON 42
  eH2_3                -3.540926e-02 1 1  ON 43
  eH2_4                 1.345221e-02 1 1  ON 44
  eH2_5                 4.871826e-02 1 1  ON 45
  eH2_6                 1.048344e-01 1 1  ON 46
  eH2_7                 1.543013e-01 1 1  ON 47
  eH2_8                 1.714627e-01 1 1  ON 48
  eH2_9                 3.760830e-02 1 1  ON 49
ci_0001                 7.014258e-01 3 1  ON 50
ci_0002                 7.003647e-01 3 1  ON 51
ci_0003                -2.734006e-02 3 1  ON 52
ci_0004                -2.671332e-02 3 1  ON 53
ci_0005                -3.589966e-02 3 1  ON 54
ci_0006                -3.680362e-02 3 1  ON 55
ci_0007                -2.212112e-02 3 1  ON 56
ci_0008                -2.138813e-02 3 1  ON 57
ci_0009                -1.765218e-02 3 1  ON 58
ci_0010                -1.767850e-02 3 1  ON 59
ci_0011                -1.208015e-02 3 1  ON 60
ci_0012                -1.284253e-02 3 1  ON 61
ci_0013                 1.260473e-02 3 1  ON 62
ci_0014                 1.295290e-02 3 1  ON 63
ci_0015                 1.344047e-02 3 1  ON 64
ci_0016                 1.323075e-02 3 1  ON 65
ci_0017                 1.150859e-02 3 1  ON 66
ci_0018                 1.127630e-02 3 1  ON 67
ci_0019                 1.103143e-02 3 1  ON 68
ci_0020                 1.140399e-02 3 1  ON 69
ci_0021                -1.223092e-03 3 1  ON 70
ci_0022                -8.354092e-04 3 1  ON 71
ci_0023                -1.097722e-02 3 1  ON 72
ci_0024                -1.117376e-02 3 1  ON 73
ci_0025                -1.094860e-02 3 1  ON 74
ci_0026                -1.047167e-02 3 1  ON 75
ci_0027                -1.104841e-02 3 1  ON 76
ci_0028                -1.056569e-02 3 1  ON 77
ci_0029                -1.057495e-02 3 1  ON 78
ci_0030                -1.083504e-02 3 1  ON 79
ci_0031                 1.973525e-02 3 1  ON 80
ci_0032                 2.057734e-02 3 1  ON 81
ci_0033                 1.045886e-02 3 1  ON 82
ci_0034                 9.879441e-03 3 1  ON 83
ci_0035                 7.055254e-03 3 1  ON 84
ci_0036                 6.735548e-03 3 1  ON 85
ci_0037                -1.034523e-02 3 1  ON 86
ci_0038                -1.090405e-02 3 1  ON 87
ci_0039                -2.479572e-03 3 1  ON 88
ci_0040                -2.806053e-03 3 1  ON 89
ci_0041                 6.796716e-03 3 1  ON 90
ci_0042                 7.158483e-03 3 1  ON 91
ci_0043                -1.879230e-02 3 1  ON 92
ci_0044                -1.919263e-02 3 1  ON 93
ci_0045                 7.881716e-03 3 1  ON 94
ci_0046                 7.087636e-03 3 1  ON 95
ci_0047                -1.565513e-03 3 1  ON 96
ci_0048                -2.094374e-03 3 1  ON 97
ci_0049                -5.309265e-03 3 1  ON 98
ci_0050                -5.639495e-03 3 1  ON 99
ci_0051                -3.069195e-03 3 1  ON 100
ci_0052                -3.339969e-03 3 1  ON 101
ci_0053                -4.508886e-03 3 1  ON 102
ci_0054                -4.715091e-03 3 1  ON 103
ci_0055                 6.600319e-03 3 1  ON 104
ci_0056                 6.143163e-03 3 1  ON 105
ci_0057                 4.776670e-03 3 1  ON 106
ci_0058                 4.684129e-03 3 1  ON 107
ci_0059                -4.648772e-03 3 1  ON 108
ci_0060                -4.829962e-03 3 1  ON 109
ci_0061                -3.622202e-03 3 1  ON 110
ci_0062                -3.117534e-03 3 1  ON 111
ci_0063                -8.686611e-03 3 1  ON 112
ci_0064                -8.937475e-03 3 1  ON 113
ci_0065                -5.191334e-03 3 1  ON 114
ci_0066                -5.800482e-03 3 1  ON 115
ci_0067                -5.169893e-03 3 1  ON 116
ci_0068                -4.476684e-03 3 1  ON 117
ci_0069                 4.650012e-03 3 1  ON 118
ci_0070                 4.428521e-03 3 1  ON 119
ci_0071                 2.816867e-04 3 1  ON 120
ci_0072                 2.178806e-04 3 1  ON 121
ci_0073                 4.281920e-03 3 1  ON 122
ci_0074                 3.878391e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8668e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.226477
====================================================
  Execution time = 2.1842e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3113e-01
  Total weights = 1.951412134e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320515154962
                                         uncertainty =       0.002099235085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320515154962
                                         uncertainty =       0.002099235085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400377394
  error estimate for blocks of size 2^( 2) =       0.000413246070
  error estimate for blocks of size 2^( 3) =       0.000426345643
  error estimate for blocks of size 2^( 4) =       0.000438617728
  error estimate for blocks of size 2^( 5) =       0.000449114383
  error estimate for blocks of size 2^( 6) =       0.000456972411
  error estimate for blocks of size 2^( 7) =       0.000462824762

      target function =                  N/A
              le_mean =     -16.906231755037
             les_mean =     286.151800284108
             stat err =       0.000451882321
             autocorr =       1.273830385932
              std dev =       0.566219141031
             le_variance =       0.320604115670


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690623175504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906231755019       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906249374346       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906253587460       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906253433952       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906254012949       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906252043630       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906256696110       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906255367829       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906257437675       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906259252857       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906257434672       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906257788726       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906258578988       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906258643321       residual = 4.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906259174112       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906259275311       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906259277315       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-02 is 4.243847e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906231755019       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906242355229       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906244129729       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906244708751       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906245609641       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906244395591       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906245335417       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906245515908       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906246058332       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906246032873       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906245734043       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906245689252       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e-01 is 1.056935e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906231755019       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906235842228       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906236382810       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906236823466       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906237371450       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906237154613       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906237031546       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906237054659       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906237134893       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906237149143       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+00 is 2.696663e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194305 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8018e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
   uu_0                 3.123163e-01 1 1  ON 0
   uu_1                 1.450467e-01 1 1  ON 1
   uu_2                 4.343087e-02 1 1  ON 2
   uu_3                -1.919512e-02 1 1  ON 3
   uu_4                -6.468337e-02 1 1  ON 4
   uu_5                -9.954555e-02 1 1  ON 5
   uu_6                -1.270578e-01 1 1  ON 6
   uu_7                -1.403197e-01 1 1  ON 7
   uu_8                -1.326571e-01 1 1  ON 8
   uu_9                -1.016308e-01 1 1  ON 9
   ud_0                 4.462286e-01 1 1  ON 10
   ud_1                 1.804773e-01 1 1  ON 11
   ud_2                 6.028757e-02 1 1  ON 12
   ud_3                -1.036790e-02 1 1  ON 13
   ud_4                -6.671587e-02 1 1  ON 14
   ud_5                -1.078756e-01 1 1  ON 15
   ud_6                -1.343971e-01 1 1  ON 16
   ud_7                -1.498358e-01 1 1  ON 17
   ud_8                -1.514907e-01 1 1  ON 18
   ud_9                -1.395182e-01 1 1  ON 19
   eO_0                -7.485177e-01 1 1  ON 20
   eO_1                -4.287307e-01 1 1  ON 21
   eO_2                -1.909073e-02 1 1  ON 22
   eO_3                 2.909979e-01 1 1  ON 23
   eO_4                 5.140735e-01 1 1  ON 24
   eO_5                 4.743913e-01 1 1  ON 25
   eO_6                 2.476853e-01 1 1  ON 26
   eO_7                -4.785315e-02 1 1  ON 27
   eO_8                -2.120024e-01 1 1  ON 28
   eO_9                -7.200015e-02 1 1  ON 29
  eH1_0                -2.502146e-01 1 1  ON 30
  eH1_1                -1.427412e-01 1 1  ON 31
  eH1_2                -9.330144e-02 1 1  ON 32
  eH1_3                -3.842743e-02 1 1  ON 33
  eH1_4                 1.076854e-02 1 1  ON 34
  eH1_5                 4.443376e-02 1 1  ON 35
  eH1_6                 1.014320e-01 1 1  ON 36
  eH1_7                 1.521380e-01 1 1  ON 37
  eH1_8                 1.673335e-01 1 1  ON 38
  eH1_9                 5.255351e-02 1 1  ON 39
  eH2_0                -2.474221e-01 1 1  ON 40
  eH2_1                -1.400965e-01 1 1  ON 41
  eH2_2                -9.087432e-02 1 1  ON 42
  eH2_3                -3.615864e-02 1 1  ON 43
  eH2_4                 1.328226e-02 1 1  ON 44
  eH2_5                 4.823781e-02 1 1  ON 45
  eH2_6                 1.047223e-01 1 1  ON 46
  eH2_7                 1.545622e-01 1 1  ON 47
  eH2_8                 1.723901e-01 1 1  ON 48
  eH2_9                 3.866523e-02 1 1  ON 49
ci_0001                 7.011245e-01 3 1  ON 50
ci_0002                 7.006478e-01 3 1  ON 51
ci_0003                -2.748872e-02 3 1  ON 52
ci_0004                -2.641246e-02 3 1  ON 53
ci_0005                -3.613257e-02 3 1  ON 54
ci_0006                -3.652045e-02 3 1  ON 55
ci_0007                -2.193471e-02 3 1  ON 56
ci_0008                -2.153752e-02 3 1  ON 57
ci_0009                -1.754815e-02 3 1  ON 58
ci_0010                -1.718391e-02 3 1  ON 59
ci_0011                -1.218860e-02 3 1  ON 60
ci_0012                -1.237456e-02 3 1  ON 61
ci_0013                 1.293649e-02 3 1  ON 62
ci_0014                 1.292158e-02 3 1  ON 63
ci_0015                 1.310729e-02 3 1  ON 64
ci_0016                 1.310564e-02 3 1  ON 65
ci_0017                 1.185083e-02 3 1  ON 66
ci_0018                 1.150015e-02 3 1  ON 67
ci_0019                 1.130189e-02 3 1  ON 68
ci_0020                 1.164963e-02 3 1  ON 69
ci_0021                -9.032589e-04 3 1  ON 70
ci_0022                -9.201918e-04 3 1  ON 71
ci_0023                -1.138445e-02 3 1  ON 72
ci_0024                -1.099230e-02 3 1  ON 73
ci_0025                -1.086674e-02 3 1  ON 74
ci_0026                -1.031356e-02 3 1  ON 75
ci_0027                -1.167910e-02 3 1  ON 76
ci_0028                -1.087878e-02 3 1  ON 77
ci_0029                -1.076517e-02 3 1  ON 78
ci_0030                -1.085466e-02 3 1  ON 79
ci_0031                 2.045664e-02 3 1  ON 80
ci_0032                 2.028683e-02 3 1  ON 81
ci_0033                 1.000584e-02 3 1  ON 82
ci_0034                 1.054588e-02 3 1  ON 83
ci_0035                 7.775848e-03 3 1  ON 84
ci_0036                 6.504603e-03 3 1  ON 85
ci_0037                -1.075944e-02 3 1  ON 86
ci_0038                -1.055562e-02 3 1  ON 87
ci_0039                -2.472165e-03 3 1  ON 88
ci_0040                -2.868064e-03 3 1  ON 89
ci_0041                 7.004559e-03 3 1  ON 90
ci_0042                 7.720714e-03 3 1  ON 91
ci_0043                -1.866770e-02 3 1  ON 92
ci_0044                -1.931681e-02 3 1  ON 93
ci_0045                 7.587017e-03 3 1  ON 94
ci_0046                 7.182024e-03 3 1  ON 95
ci_0047                -1.460007e-03 3 1  ON 96
ci_0048                -1.679822e-03 3 1  ON 97
ci_0049                -5.996304e-03 3 1  ON 98
ci_0050                -5.744681e-03 3 1  ON 99
ci_0051                -3.251313e-03 3 1  ON 100
ci_0052                -3.365893e-03 3 1  ON 101
ci_0053                -4.508081e-03 3 1  ON 102
ci_0054                -4.396978e-03 3 1  ON 103
ci_0055                 6.187815e-03 3 1  ON 104
ci_0056                 6.280960e-03 3 1  ON 105
ci_0057                 4.730721e-03 3 1  ON 106
ci_0058                 4.483388e-03 3 1  ON 107
ci_0059                -4.670041e-03 3 1  ON 108
ci_0060                -5.091990e-03 3 1  ON 109
ci_0061                -3.803574e-03 3 1  ON 110
ci_0062                -3.428161e-03 3 1  ON 111
ci_0063                -8.251478e-03 3 1  ON 112
ci_0064                -8.617213e-03 3 1  ON 113
ci_0065                -5.781484e-03 3 1  ON 114
ci_0066                -5.617111e-03 3 1  ON 115
ci_0067                -4.666103e-03 3 1  ON 116
ci_0068                -4.801420e-03 3 1  ON 117
ci_0069                 4.210044e-03 3 1  ON 118
ci_0070                 4.440755e-03 3 1  ON 119
ci_0071                 1.866695e-04 3 1  ON 120
ci_0072                 1.892478e-04 3 1  ON 121
ci_0073                 4.359258e-03 3 1  ON 122
ci_0074                 4.000082e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9513
    reference variance = 0.257173
====================================================
  Execution time = 2.1438e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3855e-01
  Total weights = 1.9518e+06
  Execution time = 1.8992e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323685287890
                                         uncertainty =       0.002340886380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323685287890
                                         uncertainty =       0.002340886380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402308112
  error estimate for blocks of size 2^( 2) =       0.000415138258
  error estimate for blocks of size 2^( 3) =       0.000429138813
  error estimate for blocks of size 2^( 4) =       0.000440820030
  error estimate for blocks of size 2^( 5) =       0.000449654148
  error estimate for blocks of size 2^( 6) =       0.000458138911
  error estimate for blocks of size 2^( 7) =       0.000463915769

      target function =                  N/A
              le_mean =     -16.905873540830
             les_mean =     286.169187442617
             stat err =       0.000453132215
             autocorr =       1.268622172171
              std dev =       0.568949588642
             le_variance =       0.323703634416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323882336640
                                         uncertainty =       0.002344991008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323882336640
                                         uncertainty =       0.002344991008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402428463
  error estimate for blocks of size 2^( 2) =       0.000415240894
  error estimate for blocks of size 2^( 3) =       0.000429246466
  error estimate for blocks of size 2^( 4) =       0.000440896609
  error estimate for blocks of size 2^( 5) =       0.000449700281
  error estimate for blocks of size 2^( 6) =       0.000458235506
  error estimate for blocks of size 2^( 7) =       0.000463988205

      target function =                  N/A
              le_mean =     -16.905855115908
             les_mean =     286.148983370784
             stat err =       0.000453205151
             autocorr =       1.268271675173
              std dev =       0.569119790579
             le_variance =       0.323897336029

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323863935333
                                         uncertainty =       0.002343641712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323863935333
                                         uncertainty =       0.002343641712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402416967
  error estimate for blocks of size 2^( 2) =       0.000415231793
  error estimate for blocks of size 2^( 3) =       0.000429238346
  error estimate for blocks of size 2^( 4) =       0.000440896915
  error estimate for blocks of size 2^( 5) =       0.000449707723
  error estimate for blocks of size 2^( 6) =       0.000458269070
  error estimate for blocks of size 2^( 7) =       0.000464023271

      target function =                  N/A
              le_mean =     -16.905861394741
             les_mean =     286.224577097756
             stat err =       0.000453224245
             autocorr =       1.268451013843
              std dev =       0.569103532803
             le_variance =       0.323878831049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323579077247
                                         uncertainty =       0.002340702116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323579077247
                                         uncertainty =       0.002340702116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402241773
  error estimate for blocks of size 2^( 2) =       0.000415067538
  error estimate for blocks of size 2^( 3) =       0.000429077370
  error estimate for blocks of size 2^( 4) =       0.000440756587
  error estimate for blocks of size 2^( 5) =       0.000449587261
  error estimate for blocks of size 2^( 6) =       0.000458096035
  error estimate for blocks of size 2^( 7) =       0.000463867194

      target function =                  N/A
              le_mean =     -16.905857455413
             les_mean =     286.147026869657
             stat err =       0.000453076769
             autocorr =       1.268730115778
              std dev =       0.568855771279
             le_variance =       0.323596888518


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905873540830        initial  <--
     6.2500e-02     6.2500e-01             4.2438e-03       -16.905855115908
     2.5000e-01     2.5000e+00             1.0569e-03       -16.905861394741
     1.0000e+00     1.0000e+01             2.6967e-04       -16.905857455413

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0452
  </log>
  <optVariables href="H2O.s003.opt.xml">
   uu_0                 3.121868e-01 1 1  ON 0
   uu_1                 1.449027e-01 1 1  ON 1
   uu_2                 4.312757e-02 1 1  ON 2
   uu_3                -1.924135e-02 1 1  ON 3
   uu_4                -6.460448e-02 1 1  ON 4
   uu_5                -9.949997e-02 1 1  ON 5
   uu_6                -1.270358e-01 1 1  ON 6
   uu_7                -1.400487e-01 1 1  ON 7
   uu_8                -1.321826e-01 1 1  ON 8
   uu_9                -1.009985e-01 1 1  ON 9
   ud_0                 4.460392e-01 1 1  ON 10
   ud_1                 1.802281e-01 1 1  ON 11
   ud_2                 6.005471e-02 1 1  ON 12
   ud_3                -1.054274e-02 1 1  ON 13
   ud_4                -6.700158e-02 1 1  ON 14
   ud_5                -1.079223e-01 1 1  ON 15
   ud_6                -1.343725e-01 1 1  ON 16
   ud_7                -1.498739e-01 1 1  ON 17
   ud_8                -1.510435e-01 1 1  ON 18
   ud_9                -1.391051e-01 1 1  ON 19
   eO_0                -7.484265e-01 1 1  ON 20
   eO_1                -4.285153e-01 1 1  ON 21
   eO_2                -1.904670e-02 1 1  ON 22
   eO_3                 2.909731e-01 1 1  ON 23
   eO_4                 5.133761e-01 1 1  ON 24
   eO_5                 4.740862e-01 1 1  ON 25
   eO_6                 2.473822e-01 1 1  ON 26
   eO_7                -4.809252e-02 1 1  ON 27
   eO_8                -2.114644e-01 1 1  ON 28
   eO_9                -7.137409e-02 1 1  ON 29
  eH1_0                -2.496403e-01 1 1  ON 30
  eH1_1                -1.423292e-01 1 1  ON 31
  eH1_2                -9.293600e-02 1 1  ON 32
  eH1_3                -3.822554e-02 1 1  ON 33
  eH1_4                 1.085362e-02 1 1  ON 34
  eH1_5                 4.441231e-02 1 1  ON 35
  eH1_6                 1.013149e-01 1 1  ON 36
  eH1_7                 1.516840e-01 1 1  ON 37
  eH1_8                 1.667596e-01 1 1  ON 38
  eH1_9                 5.205026e-02 1 1  ON 39
  eH2_0                -2.470870e-01 1 1  ON 40
  eH2_1                -1.399904e-01 1 1  ON 41
  eH2_2                -9.054627e-02 1 1  ON 42
  eH2_3                -3.540926e-02 1 1  ON 43
  eH2_4                 1.345221e-02 1 1  ON 44
  eH2_5                 4.871826e-02 1 1  ON 45
  eH2_6                 1.048344e-01 1 1  ON 46
  eH2_7                 1.543013e-01 1 1  ON 47
  eH2_8                 1.714627e-01 1 1  ON 48
  eH2_9                 3.760830e-02 1 1  ON 49
ci_0001                 7.014258e-01 3 1  ON 50
ci_0002                 7.003647e-01 3 1  ON 51
ci_0003                -2.734006e-02 3 1  ON 52
ci_0004                -2.671332e-02 3 1  ON 53
ci_0005                -3.589966e-02 3 1  ON 54
ci_0006                -3.680362e-02 3 1  ON 55
ci_0007                -2.212112e-02 3 1  ON 56
ci_0008                -2.138813e-02 3 1  ON 57
ci_0009                -1.765218e-02 3 1  ON 58
ci_0010                -1.767850e-02 3 1  ON 59
ci_0011                -1.208015e-02 3 1  ON 60
ci_0012                -1.284253e-02 3 1  ON 61
ci_0013                 1.260473e-02 3 1  ON 62
ci_0014                 1.295290e-02 3 1  ON 63
ci_0015                 1.344047e-02 3 1  ON 64
ci_0016                 1.323075e-02 3 1  ON 65
ci_0017                 1.150859e-02 3 1  ON 66
ci_0018                 1.127630e-02 3 1  ON 67
ci_0019                 1.103143e-02 3 1  ON 68
ci_0020                 1.140399e-02 3 1  ON 69
ci_0021                -1.223092e-03 3 1  ON 70
ci_0022                -8.354092e-04 3 1  ON 71
ci_0023                -1.097722e-02 3 1  ON 72
ci_0024                -1.117376e-02 3 1  ON 73
ci_0025                -1.094860e-02 3 1  ON 74
ci_0026                -1.047167e-02 3 1  ON 75
ci_0027                -1.104841e-02 3 1  ON 76
ci_0028                -1.056569e-02 3 1  ON 77
ci_0029                -1.057495e-02 3 1  ON 78
ci_0030                -1.083504e-02 3 1  ON 79
ci_0031                 1.973525e-02 3 1  ON 80
ci_0032                 2.057734e-02 3 1  ON 81
ci_0033                 1.045886e-02 3 1  ON 82
ci_0034                 9.879441e-03 3 1  ON 83
ci_0035                 7.055254e-03 3 1  ON 84
ci_0036                 6.735548e-03 3 1  ON 85
ci_0037                -1.034523e-02 3 1  ON 86
ci_0038                -1.090405e-02 3 1  ON 87
ci_0039                -2.479572e-03 3 1  ON 88
ci_0040                -2.806053e-03 3 1  ON 89
ci_0041                 6.796716e-03 3 1  ON 90
ci_0042                 7.158483e-03 3 1  ON 91
ci_0043                -1.879230e-02 3 1  ON 92
ci_0044                -1.919263e-02 3 1  ON 93
ci_0045                 7.881716e-03 3 1  ON 94
ci_0046                 7.087636e-03 3 1  ON 95
ci_0047                -1.565513e-03 3 1  ON 96
ci_0048                -2.094374e-03 3 1  ON 97
ci_0049                -5.309265e-03 3 1  ON 98
ci_0050                -5.639495e-03 3 1  ON 99
ci_0051                -3.069195e-03 3 1  ON 100
ci_0052                -3.339969e-03 3 1  ON 101
ci_0053                -4.508886e-03 3 1  ON 102
ci_0054                -4.715091e-03 3 1  ON 103
ci_0055                 6.600319e-03 3 1  ON 104
ci_0056                 6.143163e-03 3 1  ON 105
ci_0057                 4.776670e-03 3 1  ON 106
ci_0058                 4.684129e-03 3 1  ON 107
ci_0059                -4.648772e-03 3 1  ON 108
ci_0060                -4.829962e-03 3 1  ON 109
ci_0061                -3.622202e-03 3 1  ON 110
ci_0062                -3.117534e-03 3 1  ON 111
ci_0063                -8.686611e-03 3 1  ON 112
ci_0064                -8.937475e-03 3 1  ON 113
ci_0065                -5.191334e-03 3 1  ON 114
ci_0066                -5.800482e-03 3 1  ON 115
ci_0067                -5.169893e-03 3 1  ON 116
ci_0068                -4.476684e-03 3 1  ON 117
ci_0069                 4.650012e-03 3 1  ON 118
ci_0070                 4.428521e-03 3 1  ON 119
ci_0071                 2.816867e-04 3 1  ON 120
ci_0072                 2.178806e-04 3 1  ON 121
ci_0073                 4.281920e-03 3 1  ON 122
ci_0074                 3.878391e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9071e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9224
    reference variance = 0.303518
====================================================
  Execution time = 2.1616e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3636e-01
  Total weights = 1.951444625e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1478e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323116435815
                                         uncertainty =       0.002116209480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323116435815
                                         uncertainty =       0.002116209480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401975163
  error estimate for blocks of size 2^( 2) =       0.000414933638
  error estimate for blocks of size 2^( 3) =       0.000428529164
  error estimate for blocks of size 2^( 4) =       0.000441109227
  error estimate for blocks of size 2^( 5) =       0.000453080514
  error estimate for blocks of size 2^( 6) =       0.000462515079
  error estimate for blocks of size 2^( 7) =       0.000467789881

      target function =                  N/A
              le_mean =     -16.906263238226
             les_mean =     286.158091986652
             stat err =       0.000456123675
             autocorr =       1.287557964974
              std dev =       0.568478727469
             le_variance =       0.323168063584


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690626323823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906263238232       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906261291568       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906261347292       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906260435562       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906260314449       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906259460477       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906259658371       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906260121839       residual = 9.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906260224193       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906260242083       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 3.436553e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906263238232       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906262643759       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906262595303       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262286015       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262126449       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906261935120       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906261988243       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262110846       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906262111282       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906262114889       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+00 is 1.057879e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906263238232       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906263080901       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906263062398       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906262977199       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906262927304       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906262877201       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906262889945       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906262919659       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906262919656       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906262920448       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.0000e+01 is 2.808397e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.198399 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7776e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
   uu_0                 3.122080e-01 1 1  ON 0
   uu_1                 1.449322e-01 1 1  ON 1
   uu_2                 4.312248e-02 1 1  ON 2
   uu_3                -1.923657e-02 1 1  ON 3
   uu_4                -6.461322e-02 1 1  ON 4
   uu_5                -9.946978e-02 1 1  ON 5
   uu_6                -1.270530e-01 1 1  ON 6
   uu_7                -1.400880e-01 1 1  ON 7
   uu_8                -1.322206e-01 1 1  ON 8
   uu_9                -1.010257e-01 1 1  ON 9
   ud_0                 4.460383e-01 1 1  ON 10
   ud_1                 1.802745e-01 1 1  ON 11
   ud_2                 6.009121e-02 1 1  ON 12
   ud_3                -1.054489e-02 1 1  ON 13
   ud_4                -6.697889e-02 1 1  ON 14
   ud_5                -1.079077e-01 1 1  ON 15
   ud_6                -1.344744e-01 1 1  ON 16
   ud_7                -1.498465e-01 1 1  ON 17
   ud_8                -1.510291e-01 1 1  ON 18
   ud_9                -1.391313e-01 1 1  ON 19
   eO_0                -7.484551e-01 1 1  ON 20
   eO_1                -4.285576e-01 1 1  ON 21
   eO_2                -1.903707e-02 1 1  ON 22
   eO_3                 2.909892e-01 1 1  ON 23
   eO_4                 5.134415e-01 1 1  ON 24
   eO_5                 4.741168e-01 1 1  ON 25
   eO_6                 2.474139e-01 1 1  ON 26
   eO_7                -4.806678e-02 1 1  ON 27
   eO_8                -2.115127e-01 1 1  ON 28
   eO_9                -7.142684e-02 1 1  ON 29
  eH1_0                -2.496456e-01 1 1  ON 30
  eH1_1                -1.423646e-01 1 1  ON 31
  eH1_2                -9.296750e-02 1 1  ON 32
  eH1_3                -3.827770e-02 1 1  ON 33
  eH1_4                 1.081521e-02 1 1  ON 34
  eH1_5                 4.442762e-02 1 1  ON 35
  eH1_6                 1.012938e-01 1 1  ON 36
  eH1_7                 1.517056e-01 1 1  ON 37
  eH1_8                 1.668281e-01 1 1  ON 38
  eH1_9                 5.212658e-02 1 1  ON 39
  eH2_0                -2.470817e-01 1 1  ON 40
  eH2_1                -1.400226e-01 1 1  ON 41
  eH2_2                -9.057155e-02 1 1  ON 42
  eH2_3                -3.542853e-02 1 1  ON 43
  eH2_4                 1.340889e-02 1 1  ON 44
  eH2_5                 4.869498e-02 1 1  ON 45
  eH2_6                 1.048287e-01 1 1  ON 46
  eH2_7                 1.543016e-01 1 1  ON 47
  eH2_8                 1.715177e-01 1 1  ON 48
  eH2_9                 3.768976e-02 1 1  ON 49
ci_0001                 7.013937e-01 3 1  ON 50
ci_0002                 7.003980e-01 3 1  ON 51
ci_0003                -2.733527e-02 3 1  ON 52
ci_0004                -2.679865e-02 3 1  ON 53
ci_0005                -3.595831e-02 3 1  ON 54
ci_0006                -3.681428e-02 3 1  ON 55
ci_0007                -2.213987e-02 3 1  ON 56
ci_0008                -2.137712e-02 3 1  ON 57
ci_0009                -1.766057e-02 3 1  ON 58
ci_0010                -1.768493e-02 3 1  ON 59
ci_0011                -1.207361e-02 3 1  ON 60
ci_0012                -1.273674e-02 3 1  ON 61
ci_0013                 1.266831e-02 3 1  ON 62
ci_0014                 1.294645e-02 3 1  ON 63
ci_0015                 1.339274e-02 3 1  ON 64
ci_0016                 1.323470e-02 3 1  ON 65
ci_0017                 1.154042e-02 3 1  ON 66
ci_0018                 1.126284e-02 3 1  ON 67
ci_0019                 1.100205e-02 3 1  ON 68
ci_0020                 1.139293e-02 3 1  ON 69
ci_0021                -1.187126e-03 3 1  ON 70
ci_0022                -8.878444e-04 3 1  ON 71
ci_0023                -1.097885e-02 3 1  ON 72
ci_0024                -1.111458e-02 3 1  ON 73
ci_0025                -1.085399e-02 3 1  ON 74
ci_0026                -1.049922e-02 3 1  ON 75
ci_0027                -1.114243e-02 3 1  ON 76
ci_0028                -1.064597e-02 3 1  ON 77
ci_0029                -1.056474e-02 3 1  ON 78
ci_0030                -1.079107e-02 3 1  ON 79
ci_0031                 1.966679e-02 3 1  ON 80
ci_0032                 2.052443e-02 3 1  ON 81
ci_0033                 1.052462e-02 3 1  ON 82
ci_0034                 9.959362e-03 3 1  ON 83
ci_0035                 7.021285e-03 3 1  ON 84
ci_0036                 6.756657e-03 3 1  ON 85
ci_0037                -1.041568e-02 3 1  ON 86
ci_0038                -1.083140e-02 3 1  ON 87
ci_0039                -2.512552e-03 3 1  ON 88
ci_0040                -2.809678e-03 3 1  ON 89
ci_0041                 6.844098e-03 3 1  ON 90
ci_0042                 7.195595e-03 3 1  ON 91
ci_0043                -1.877834e-02 3 1  ON 92
ci_0044                -1.914763e-02 3 1  ON 93
ci_0045                 7.856218e-03 3 1  ON 94
ci_0046                 7.108248e-03 3 1  ON 95
ci_0047                -1.528228e-03 3 1  ON 96
ci_0048                -2.093646e-03 3 1  ON 97
ci_0049                -5.308470e-03 3 1  ON 98
ci_0050                -5.552208e-03 3 1  ON 99
ci_0051                -3.077925e-03 3 1  ON 100
ci_0052                -3.372600e-03 3 1  ON 101
ci_0053                -4.585566e-03 3 1  ON 102
ci_0054                -4.672200e-03 3 1  ON 103
ci_0055                 6.568383e-03 3 1  ON 104
ci_0056                 6.130854e-03 3 1  ON 105
ci_0057                 4.735508e-03 3 1  ON 106
ci_0058                 4.686706e-03 3 1  ON 107
ci_0059                -4.611713e-03 3 1  ON 108
ci_0060                -4.751797e-03 3 1  ON 109
ci_0061                -3.566692e-03 3 1  ON 110
ci_0062                -3.135606e-03 3 1  ON 111
ci_0063                -8.705587e-03 3 1  ON 112
ci_0064                -8.871731e-03 3 1  ON 113
ci_0065                -5.164082e-03 3 1  ON 114
ci_0066                -5.763521e-03 3 1  ON 115
ci_0067                -5.143182e-03 3 1  ON 116
ci_0068                -4.505137e-03 3 1  ON 117
ci_0069                 4.634817e-03 3 1  ON 118
ci_0070                 4.349875e-03 3 1  ON 119
ci_0071                 2.705921e-04 3 1  ON 120
ci_0072                 3.084988e-04 3 1  ON 121
ci_0073                 4.319907e-03 3 1  ON 122
ci_0074                 3.839893e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9629
    reference variance = 0.195867
====================================================
  Execution time = 2.1199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3805e-01
  Total weights = 1.9521e+06
  Execution time = 1.8887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322805689319
                                         uncertainty =       0.002208734719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322805689319
                                         uncertainty =       0.002208734719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401776938
  error estimate for blocks of size 2^( 2) =       0.000415210080
  error estimate for blocks of size 2^( 3) =       0.000428430603
  error estimate for blocks of size 2^( 4) =       0.000441169820
  error estimate for blocks of size 2^( 5) =       0.000453070070
  error estimate for blocks of size 2^( 6) =       0.000459408867
  error estimate for blocks of size 2^( 7) =       0.000467532657

      target function =                  N/A
              le_mean =     -16.906250207973
             les_mean =     286.159664310686
             stat err =       0.000455295353
             autocorr =       1.284151985559
              std dev =       0.568198394391
             le_variance =       0.322849415389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322549011773
                                         uncertainty =       0.002200944293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322549011773
                                         uncertainty =       0.002200944293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401617114
  error estimate for blocks of size 2^( 2) =       0.000415054080
  error estimate for blocks of size 2^( 3) =       0.000428283196
  error estimate for blocks of size 2^( 4) =       0.000441020145
  error estimate for blocks of size 2^( 5) =       0.000452913482
  error estimate for blocks of size 2^( 6) =       0.000459253043
  error estimate for blocks of size 2^( 7) =       0.000467356406

      target function =                  N/A
              le_mean =     -16.906251187214
             les_mean =     286.159395268121
             stat err =       0.000455135769
             autocorr =       1.284273481818
              std dev =       0.567972368867
             le_variance =       0.322592611797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322619673641
                                         uncertainty =       0.002203603106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322619673641
                                         uncertainty =       0.002203603106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401661119
  error estimate for blocks of size 2^( 2) =       0.000415097278
  error estimate for blocks of size 2^( 3) =       0.000428323801
  error estimate for blocks of size 2^( 4) =       0.000441062336
  error estimate for blocks of size 2^( 5) =       0.000452959025
  error estimate for blocks of size 2^( 6) =       0.000459298707
  error estimate for blocks of size 2^( 7) =       0.000467409775

      target function =                  N/A
              le_mean =     -16.906249950950
             les_mean =     286.159155442931
             stat err =       0.000455182461
             autocorr =       1.284255551358
              std dev =       0.568034601435
             le_variance =       0.322663308428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322778439332
                                         uncertainty =       0.002208013654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322778439332
                                         uncertainty =       0.002208013654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401759974
  error estimate for blocks of size 2^( 2) =       0.000415193565
  error estimate for blocks of size 2^( 3) =       0.000428414936
  error estimate for blocks of size 2^( 4) =       0.000441154099
  error estimate for blocks of size 2^( 5) =       0.000453053952
  error estimate for blocks of size 2^( 6) =       0.000459393030
  error estimate for blocks of size 2^( 7) =       0.000467515131

      target function =                  N/A
              le_mean =     -16.906250006616
             les_mean =     286.159622383968
             stat err =       0.000455279053
             autocorr =       1.284168473488
              std dev =       0.568174403987
             le_variance =       0.322822153346


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906250207973        initial
     6.2500e-01     6.2500e+00             3.4366e-04       -16.906251187214  <--
     2.5000e+00     2.5000e+01             1.0579e-04       -16.906249950950
     1.0000e+01     1.0000e+02             2.8084e-05       -16.906250006616

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 3.0754e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
   uu_0                 3.122654e-01 1 1  ON 0
   uu_1                 1.449984e-01 1 1  ON 1
   uu_2                 4.313271e-02 1 1  ON 2
   uu_3                -1.922475e-02 1 1  ON 3
   uu_4                -6.461954e-02 1 1  ON 4
   uu_5                -9.941455e-02 1 1  ON 5
   uu_6                -1.270874e-01 1 1  ON 6
   uu_7                -1.401970e-01 1 1  ON 7
   uu_8                -1.323371e-01 1 1  ON 8
   uu_9                -1.011080e-01 1 1  ON 9
   ud_0                 4.460807e-01 1 1  ON 10
   ud_1                 1.803811e-01 1 1  ON 11
   ud_2                 6.017747e-02 1 1  ON 12
   ud_3                -1.052633e-02 1 1  ON 13
   ud_4                -6.693652e-02 1 1  ON 14
   ud_5                -1.078839e-01 1 1  ON 15
   ud_6                -1.347080e-01 1 1  ON 16
   ud_7                -1.497974e-01 1 1  ON 17
   ud_8                -1.509976e-01 1 1  ON 18
   ud_9                -1.392067e-01 1 1  ON 19
   eO_0                -7.485449e-01 1 1  ON 20
   eO_1                -4.286603e-01 1 1  ON 21
   eO_2                -1.902569e-02 1 1  ON 22
   eO_3                 2.910388e-01 1 1  ON 23
   eO_4                 5.136349e-01 1 1  ON 24
   eO_5                 4.742127e-01 1 1  ON 25
   eO_6                 2.475054e-01 1 1  ON 26
   eO_7                -4.799558e-02 1 1  ON 27
   eO_8                -2.116557e-01 1 1  ON 28
   eO_9                -7.158298e-02 1 1  ON 29
  eH1_0                -2.496687e-01 1 1  ON 30
  eH1_1                -1.424736e-01 1 1  ON 31
  eH1_2                -9.306560e-02 1 1  ON 32
  eH1_3                -3.841503e-02 1 1  ON 33
  eH1_4                 1.070024e-02 1 1  ON 34
  eH1_5                 4.446766e-02 1 1  ON 35
  eH1_6                 1.012369e-01 1 1  ON 36
  eH1_7                 1.517708e-01 1 1  ON 37
  eH1_8                 1.670301e-01 1 1  ON 38
  eH1_9                 5.235267e-02 1 1  ON 39
  eH2_0                -2.470731e-01 1 1  ON 40
  eH2_1                -1.401143e-01 1 1  ON 41
  eH2_2                -9.064569e-02 1 1  ON 42
  eH2_3                -3.549209e-02 1 1  ON 43
  eH2_4                 1.329476e-02 1 1  ON 44
  eH2_5                 4.862418e-02 1 1  ON 45
  eH2_6                 1.048102e-01 1 1  ON 46
  eH2_7                 1.543019e-01 1 1  ON 47
  eH2_8                 1.716792e-01 1 1  ON 48
  eH2_9                 3.793113e-02 1 1  ON 49
ci_0001                 7.012999e-01 3 1  ON 50
ci_0002                 7.004941e-01 3 1  ON 51
ci_0003                -2.732209e-02 3 1  ON 52
ci_0004                -2.700040e-02 3 1  ON 53
ci_0005                -3.610102e-02 3 1  ON 54
ci_0006                -3.683953e-02 3 1  ON 55
ci_0007                -2.218860e-02 3 1  ON 56
ci_0008                -2.134834e-02 3 1  ON 57
ci_0009                -1.767553e-02 3 1  ON 58
ci_0010                -1.770110e-02 3 1  ON 59
ci_0011                -1.205902e-02 3 1  ON 60
ci_0012                -1.249888e-02 3 1  ON 61
ci_0013                 1.280801e-02 3 1  ON 62
ci_0014                 1.293378e-02 3 1  ON 63
ci_0015                 1.328350e-02 3 1  ON 64
ci_0016                 1.324214e-02 3 1  ON 65
ci_0017                 1.161122e-02 3 1  ON 66
ci_0018                 1.123806e-02 3 1  ON 67
ci_0019                 1.093578e-02 3 1  ON 68
ci_0020                 1.137300e-02 3 1  ON 69
ci_0021                -1.087033e-03 3 1  ON 70
ci_0022                -1.027469e-03 3 1  ON 71
ci_0023                -1.097855e-02 3 1  ON 72
ci_0024                -1.098964e-02 3 1  ON 73
ci_0025                -1.064252e-02 3 1  ON 74
ci_0026                -1.055826e-02 3 1  ON 75
ci_0027                -1.135092e-02 3 1  ON 76
ci_0028                -1.082766e-02 3 1  ON 77
ci_0029                -1.054119e-02 3 1  ON 78
ci_0030                -1.069426e-02 3 1  ON 79
ci_0031                 1.949583e-02 3 1  ON 80
ci_0032                 2.039324e-02 3 1  ON 81
ci_0033                 1.069440e-02 3 1  ON 82
ci_0034                 1.016262e-02 3 1  ON 83
ci_0035                 6.943264e-03 3 1  ON 84
ci_0036                 6.804347e-03 3 1  ON 85
ci_0037                -1.058426e-02 3 1  ON 86
ci_0038                -1.066026e-02 3 1  ON 87
ci_0039                -2.572672e-03 3 1  ON 88
ci_0040                -2.815690e-03 3 1  ON 89
ci_0041                 6.952339e-03 3 1  ON 90
ci_0042                 7.279395e-03 3 1  ON 91
ci_0043                -1.873861e-02 3 1  ON 92
ci_0044                -1.902520e-02 3 1  ON 93
ci_0045                 7.794887e-03 3 1  ON 94
ci_0046                 7.158836e-03 3 1  ON 95
ci_0047                -1.456329e-03 3 1  ON 96
ci_0048                -2.091960e-03 3 1  ON 97
ci_0049                -5.307062e-03 3 1  ON 98
ci_0050                -5.359650e-03 3 1  ON 99
ci_0051                -3.096450e-03 3 1  ON 100
ci_0052                -3.435581e-03 3 1  ON 101
ci_0053                -4.740580e-03 3 1  ON 102
ci_0054                -4.587138e-03 3 1  ON 103
ci_0055                 6.492478e-03 3 1  ON 104
ci_0056                 6.102102e-03 3 1  ON 105
ci_0057                 4.641324e-03 3 1  ON 106
ci_0058                 4.692863e-03 3 1  ON 107
ci_0059                -4.537104e-03 3 1  ON 108
ci_0060                -4.592006e-03 3 1  ON 109
ci_0061                -3.438373e-03 3 1  ON 110
ci_0062                -3.175510e-03 3 1  ON 111
ci_0063                -8.744160e-03 3 1  ON 112
ci_0064                -8.734795e-03 3 1  ON 113
ci_0065                -5.104884e-03 3 1  ON 114
ci_0066                -5.684761e-03 3 1  ON 115
ci_0067                -5.089415e-03 3 1  ON 116
ci_0068                -4.566697e-03 3 1  ON 117
ci_0069                 4.602191e-03 3 1  ON 118
ci_0070                 4.196166e-03 3 1  ON 119
ci_0071                 2.488623e-04 3 1  ON 120
ci_0072                 5.084886e-04 3 1  ON 121
ci_0073                 4.393347e-03 3 1  ON 122
ci_0074                 3.764532e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8538e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8582
    reference variance = 0.130694
====================================================
  Execution time = 2.1627e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3435e-01
  Total weights = 1.951592756e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323374619523
                                         uncertainty =       0.002160999414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323374619523
                                         uncertainty =       0.002160999414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402101633
  error estimate for blocks of size 2^( 2) =       0.000414696000
  error estimate for blocks of size 2^( 3) =       0.000428376822
  error estimate for blocks of size 2^( 4) =       0.000441566241
  error estimate for blocks of size 2^( 5) =       0.000453475826
  error estimate for blocks of size 2^( 6) =       0.000461806847
  error estimate for blocks of size 2^( 7) =       0.000468687733

      target function =                  N/A
              le_mean =     -16.905669565085
             les_mean =     286.136016376923
             stat err =       0.000456384162
             autocorr =       1.288218274365
              std dev =       0.568657582585
             le_variance =       0.323371446231


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566956508e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905669565051       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905681424322       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905681990550       residual = 7.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905683701038       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905682386756       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905686488718       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905687220650       residual = 4.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905686657528       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905686209531       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905686279078       residual = 7.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905686247243       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905686418964       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905686346990       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905686453315       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e-01 is 1.700165e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905669565051       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905674836474       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905674919568       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905675502262       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905675191270       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905676662224       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905676797654       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905676706228       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905676348298       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905676431485       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905676467096       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e-01 is 4.537654e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905669565051       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905671201117       residual = 9.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905671217198       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905671342008       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905671314932       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905671684348       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905671707379       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905671728355       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905671633429       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905671625425       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+00 is 1.406374e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.203877 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7887e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
   uu_0                 3.122690e-01 1 1  ON 0
   uu_1                 1.449408e-01 1 1  ON 1
   uu_2                 4.319577e-02 1 1  ON 2
   uu_3                -1.914778e-02 1 1  ON 3
   uu_4                -6.470650e-02 1 1  ON 4
   uu_5                -9.950261e-02 1 1  ON 5
   uu_6                -1.271738e-01 1 1  ON 6
   uu_7                -1.401759e-01 1 1  ON 7
   uu_8                -1.323366e-01 1 1  ON 8
   uu_9                -1.012503e-01 1 1  ON 9
   ud_0                 4.460811e-01 1 1  ON 10
   ud_1                 1.804423e-01 1 1  ON 11
   ud_2                 6.019029e-02 1 1  ON 12
   ud_3                -1.041555e-02 1 1  ON 13
   ud_4                -6.691610e-02 1 1  ON 14
   ud_5                -1.078752e-01 1 1  ON 15
   ud_6                -1.346875e-01 1 1  ON 16
   ud_7                -1.499344e-01 1 1  ON 17
   ud_8                -1.509978e-01 1 1  ON 18
   ud_9                -1.392562e-01 1 1  ON 19
   eO_0                -7.484710e-01 1 1  ON 20
   eO_1                -4.285549e-01 1 1  ON 21
   eO_2                -1.930178e-02 1 1  ON 22
   eO_3                 2.910272e-01 1 1  ON 23
   eO_4                 5.137413e-01 1 1  ON 24
   eO_5                 4.743401e-01 1 1  ON 25
   eO_6                 2.476366e-01 1 1  ON 26
   eO_7                -4.789803e-02 1 1  ON 27
   eO_8                -2.118165e-01 1 1  ON 28
   eO_9                -7.175475e-02 1 1  ON 29
  eH1_0                -2.498648e-01 1 1  ON 30
  eH1_1                -1.427667e-01 1 1  ON 31
  eH1_2                -9.322574e-02 1 1  ON 32
  eH1_3                -3.845223e-02 1 1  ON 33
  eH1_4                 1.078367e-02 1 1  ON 34
  eH1_5                 4.448163e-02 1 1  ON 35
  eH1_6                 1.013362e-01 1 1  ON 36
  eH1_7                 1.519135e-01 1 1  ON 37
  eH1_8                 1.671958e-01 1 1  ON 38
  eH1_9                 5.256093e-02 1 1  ON 39
  eH2_0                -2.472292e-01 1 1  ON 40
  eH2_1                -1.403009e-01 1 1  ON 41
  eH2_2                -9.063677e-02 1 1  ON 42
  eH2_3                -3.561195e-02 1 1  ON 43
  eH2_4                 1.313646e-02 1 1  ON 44
  eH2_5                 4.845969e-02 1 1  ON 45
  eH2_6                 1.047691e-01 1 1  ON 46
  eH2_7                 1.543101e-01 1 1  ON 47
  eH2_8                 1.719705e-01 1 1  ON 48
  eH2_9                 3.835338e-02 1 1  ON 49
ci_0001                 7.012395e-01 3 1  ON 50
ci_0002                 7.005262e-01 3 1  ON 51
ci_0003                -2.762222e-02 3 1  ON 52
ci_0004                -2.716499e-02 3 1  ON 53
ci_0005                -3.604701e-02 3 1  ON 54
ci_0006                -3.651598e-02 3 1  ON 55
ci_0007                -2.197713e-02 3 1  ON 56
ci_0008                -2.128379e-02 3 1  ON 57
ci_0009                -1.774540e-02 3 1  ON 58
ci_0010                -1.783139e-02 3 1  ON 59
ci_0011                -1.197534e-02 3 1  ON 60
ci_0012                -1.228738e-02 3 1  ON 61
ci_0013                 1.298668e-02 3 1  ON 62
ci_0014                 1.321024e-02 3 1  ON 63
ci_0015                 1.301112e-02 3 1  ON 64
ci_0016                 1.316013e-02 3 1  ON 65
ci_0017                 1.182470e-02 3 1  ON 66
ci_0018                 1.132074e-02 3 1  ON 67
ci_0019                 1.123787e-02 3 1  ON 68
ci_0020                 1.126503e-02 3 1  ON 69
ci_0021                -1.247030e-03 3 1  ON 70
ci_0022                -1.237287e-03 3 1  ON 71
ci_0023                -1.103650e-02 3 1  ON 72
ci_0024                -1.113904e-02 3 1  ON 73
ci_0025                -1.046538e-02 3 1  ON 74
ci_0026                -1.047798e-02 3 1  ON 75
ci_0027                -1.118951e-02 3 1  ON 76
ci_0028                -1.098020e-02 3 1  ON 77
ci_0029                -1.063702e-02 3 1  ON 78
ci_0030                -1.114803e-02 3 1  ON 79
ci_0031                 1.959017e-02 3 1  ON 80
ci_0032                 2.036725e-02 3 1  ON 81
ci_0033                 1.077808e-02 3 1  ON 82
ci_0034                 1.030729e-02 3 1  ON 83
ci_0035                 6.966531e-03 3 1  ON 84
ci_0036                 7.059453e-03 3 1  ON 85
ci_0037                -1.054264e-02 3 1  ON 86
ci_0038                -1.038997e-02 3 1  ON 87
ci_0039                -2.594483e-03 3 1  ON 88
ci_0040                -2.861852e-03 3 1  ON 89
ci_0041                 7.040471e-03 3 1  ON 90
ci_0042                 7.243021e-03 3 1  ON 91
ci_0043                -1.880066e-02 3 1  ON 92
ci_0044                -1.938095e-02 3 1  ON 93
ci_0045                 7.673998e-03 3 1  ON 94
ci_0046                 7.246880e-03 3 1  ON 95
ci_0047                -1.620677e-03 3 1  ON 96
ci_0048                -2.072510e-03 3 1  ON 97
ci_0049                -5.430860e-03 3 1  ON 98
ci_0050                -5.593926e-03 3 1  ON 99
ci_0051                -3.424867e-03 3 1  ON 100
ci_0052                -3.245147e-03 3 1  ON 101
ci_0053                -4.600990e-03 3 1  ON 102
ci_0054                -4.621461e-03 3 1  ON 103
ci_0055                 6.362898e-03 3 1  ON 104
ci_0056                 6.387601e-03 3 1  ON 105
ci_0057                 4.700765e-03 3 1  ON 106
ci_0058                 4.779843e-03 3 1  ON 107
ci_0059                -4.337366e-03 3 1  ON 108
ci_0060                -4.662984e-03 3 1  ON 109
ci_0061                -3.603668e-03 3 1  ON 110
ci_0062                -3.121385e-03 3 1  ON 111
ci_0063                -8.637668e-03 3 1  ON 112
ci_0064                -8.885514e-03 3 1  ON 113
ci_0065                -5.320657e-03 3 1  ON 114
ci_0066                -5.599945e-03 3 1  ON 115
ci_0067                -4.827576e-03 3 1  ON 116
ci_0068                -4.828917e-03 3 1  ON 117
ci_0069                 4.565057e-03 3 1  ON 118
ci_0070                 4.198877e-03 3 1  ON 119
ci_0071                 2.906347e-05 3 1  ON 120
ci_0072                 4.233224e-04 3 1  ON 121
ci_0073                 4.366531e-03 3 1  ON 122
ci_0074                 3.973327e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.0034
    reference variance = 0.371341
====================================================
  Execution time = 2.3354e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3984e-01
  Total weights = 1.9518e+06
  Execution time = 1.9021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324926087466
                                         uncertainty =       0.002838169852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324926087466
                                         uncertainty =       0.002838169852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403046848
  error estimate for blocks of size 2^( 2) =       0.000415879286
  error estimate for blocks of size 2^( 3) =       0.000428890720
  error estimate for blocks of size 2^( 4) =       0.000441177205
  error estimate for blocks of size 2^( 5) =       0.000452561872
  error estimate for blocks of size 2^( 6) =       0.000459984070
  error estimate for blocks of size 2^( 7) =       0.000465878233

      target function =                  N/A
              le_mean =     -16.905257609525
             les_mean =     286.127853803506
             stat err =       0.000454900345
             autocorr =       1.273859335423
              std dev =       0.569994318845
             le_variance =       0.324893523515

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324920813186
                                         uncertainty =       0.002847101626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324920813186
                                         uncertainty =       0.002847101626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403043454
  error estimate for blocks of size 2^( 2) =       0.000415848112
  error estimate for blocks of size 2^( 3) =       0.000428824382
  error estimate for blocks of size 2^( 4) =       0.000441077476
  error estimate for blocks of size 2^( 5) =       0.000452463949
  error estimate for blocks of size 2^( 6) =       0.000459854522
  error estimate for blocks of size 2^( 7) =       0.000465765900

      target function =                  N/A
              le_mean =     -16.905257059466
             les_mean =     286.131465863205
             stat err =       0.000454790462
             autocorr =       1.273265444493
              std dev =       0.569989518311
             le_variance =       0.324888050985

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324917340386
                                         uncertainty =       0.002848648910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324917340386
                                         uncertainty =       0.002848648910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403041381
  error estimate for blocks of size 2^( 2) =       0.000415844260
  error estimate for blocks of size 2^( 3) =       0.000428821953
  error estimate for blocks of size 2^( 4) =       0.000441074855
  error estimate for blocks of size 2^( 5) =       0.000452463260
  error estimate for blocks of size 2^( 6) =       0.000459854153
  error estimate for blocks of size 2^( 7) =       0.000465766031

      target function =                  N/A
              le_mean =     -16.905255794935
             les_mean =     286.128139579863
             stat err =       0.000454789575
             autocorr =       1.273273572406
              std dev =       0.569986587051
             le_variance =       0.324884709418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324905572986
                                         uncertainty =       0.002839696340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324905572986
                                         uncertainty =       0.002839696340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403034133
  error estimate for blocks of size 2^( 2) =       0.000415861582
  error estimate for blocks of size 2^( 3) =       0.000428867752
  error estimate for blocks of size 2^( 4) =       0.000441149218
  error estimate for blocks of size 2^( 5) =       0.000452534695
  error estimate for blocks of size 2^( 6) =       0.000459953341
  error estimate for blocks of size 2^( 7) =       0.000465849620

      target function =                  N/A
              le_mean =     -16.905254760905
             les_mean =     286.127532010405
             stat err =       0.000454871719
             autocorr =       1.273779385887
              std dev =       0.569976336283
             le_variance =       0.324873023922


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905257609525        initial  <--
     1.5625e-01     1.5625e+00             1.7002e-03       -16.905257059466
     6.2500e-01     6.2500e+00             4.5377e-04       -16.905255794935
     2.5000e+00     2.5000e+01             1.4064e-04       -16.905254760905

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.9697
  </log>
  <optVariables href="H2O.s005.opt.xml">
   uu_0                 3.122654e-01 1 1  ON 0
   uu_1                 1.449984e-01 1 1  ON 1
   uu_2                 4.313271e-02 1 1  ON 2
   uu_3                -1.922475e-02 1 1  ON 3
   uu_4                -6.461954e-02 1 1  ON 4
   uu_5                -9.941455e-02 1 1  ON 5
   uu_6                -1.270874e-01 1 1  ON 6
   uu_7                -1.401970e-01 1 1  ON 7
   uu_8                -1.323371e-01 1 1  ON 8
   uu_9                -1.011080e-01 1 1  ON 9
   ud_0                 4.460807e-01 1 1  ON 10
   ud_1                 1.803811e-01 1 1  ON 11
   ud_2                 6.017747e-02 1 1  ON 12
   ud_3                -1.052633e-02 1 1  ON 13
   ud_4                -6.693652e-02 1 1  ON 14
   ud_5                -1.078839e-01 1 1  ON 15
   ud_6                -1.347080e-01 1 1  ON 16
   ud_7                -1.497974e-01 1 1  ON 17
   ud_8                -1.509976e-01 1 1  ON 18
   ud_9                -1.392067e-01 1 1  ON 19
   eO_0                -7.485449e-01 1 1  ON 20
   eO_1                -4.286603e-01 1 1  ON 21
   eO_2                -1.902569e-02 1 1  ON 22
   eO_3                 2.910388e-01 1 1  ON 23
   eO_4                 5.136349e-01 1 1  ON 24
   eO_5                 4.742127e-01 1 1  ON 25
   eO_6                 2.475054e-01 1 1  ON 26
   eO_7                -4.799558e-02 1 1  ON 27
   eO_8                -2.116557e-01 1 1  ON 28
   eO_9                -7.158298e-02 1 1  ON 29
  eH1_0                -2.496687e-01 1 1  ON 30
  eH1_1                -1.424736e-01 1 1  ON 31
  eH1_2                -9.306560e-02 1 1  ON 32
  eH1_3                -3.841503e-02 1 1  ON 33
  eH1_4                 1.070024e-02 1 1  ON 34
  eH1_5                 4.446766e-02 1 1  ON 35
  eH1_6                 1.012369e-01 1 1  ON 36
  eH1_7                 1.517708e-01 1 1  ON 37
  eH1_8                 1.670301e-01 1 1  ON 38
  eH1_9                 5.235267e-02 1 1  ON 39
  eH2_0                -2.470731e-01 1 1  ON 40
  eH2_1                -1.401143e-01 1 1  ON 41
  eH2_2                -9.064569e-02 1 1  ON 42
  eH2_3                -3.549209e-02 1 1  ON 43
  eH2_4                 1.329476e-02 1 1  ON 44
  eH2_5                 4.862418e-02 1 1  ON 45
  eH2_6                 1.048102e-01 1 1  ON 46
  eH2_7                 1.543019e-01 1 1  ON 47
  eH2_8                 1.716792e-01 1 1  ON 48
  eH2_9                 3.793113e-02 1 1  ON 49
ci_0001                 7.012999e-01 3 1  ON 50
ci_0002                 7.004941e-01 3 1  ON 51
ci_0003                -2.732209e-02 3 1  ON 52
ci_0004                -2.700040e-02 3 1  ON 53
ci_0005                -3.610102e-02 3 1  ON 54
ci_0006                -3.683953e-02 3 1  ON 55
ci_0007                -2.218860e-02 3 1  ON 56
ci_0008                -2.134834e-02 3 1  ON 57
ci_0009                -1.767553e-02 3 1  ON 58
ci_0010                -1.770110e-02 3 1  ON 59
ci_0011                -1.205902e-02 3 1  ON 60
ci_0012                -1.249888e-02 3 1  ON 61
ci_0013                 1.280801e-02 3 1  ON 62
ci_0014                 1.293378e-02 3 1  ON 63
ci_0015                 1.328350e-02 3 1  ON 64
ci_0016                 1.324214e-02 3 1  ON 65
ci_0017                 1.161122e-02 3 1  ON 66
ci_0018                 1.123806e-02 3 1  ON 67
ci_0019                 1.093578e-02 3 1  ON 68
ci_0020                 1.137300e-02 3 1  ON 69
ci_0021                -1.087033e-03 3 1  ON 70
ci_0022                -1.027469e-03 3 1  ON 71
ci_0023                -1.097855e-02 3 1  ON 72
ci_0024                -1.098964e-02 3 1  ON 73
ci_0025                -1.064252e-02 3 1  ON 74
ci_0026                -1.055826e-02 3 1  ON 75
ci_0027                -1.135092e-02 3 1  ON 76
ci_0028                -1.082766e-02 3 1  ON 77
ci_0029                -1.054119e-02 3 1  ON 78
ci_0030                -1.069426e-02 3 1  ON 79
ci_0031                 1.949583e-02 3 1  ON 80
ci_0032                 2.039324e-02 3 1  ON 81
ci_0033                 1.069440e-02 3 1  ON 82
ci_0034                 1.016262e-02 3 1  ON 83
ci_0035                 6.943264e-03 3 1  ON 84
ci_0036                 6.804347e-03 3 1  ON 85
ci_0037                -1.058426e-02 3 1  ON 86
ci_0038                -1.066026e-02 3 1  ON 87
ci_0039                -2.572672e-03 3 1  ON 88
ci_0040                -2.815690e-03 3 1  ON 89
ci_0041                 6.952339e-03 3 1  ON 90
ci_0042                 7.279395e-03 3 1  ON 91
ci_0043                -1.873861e-02 3 1  ON 92
ci_0044                -1.902520e-02 3 1  ON 93
ci_0045                 7.794887e-03 3 1  ON 94
ci_0046                 7.158836e-03 3 1  ON 95
ci_0047                -1.456329e-03 3 1  ON 96
ci_0048                -2.091960e-03 3 1  ON 97
ci_0049                -5.307062e-03 3 1  ON 98
ci_0050                -5.359650e-03 3 1  ON 99
ci_0051                -3.096450e-03 3 1  ON 100
ci_0052                -3.435581e-03 3 1  ON 101
ci_0053                -4.740580e-03 3 1  ON 102
ci_0054                -4.587138e-03 3 1  ON 103
ci_0055                 6.492478e-03 3 1  ON 104
ci_0056                 6.102102e-03 3 1  ON 105
ci_0057                 4.641324e-03 3 1  ON 106
ci_0058                 4.692863e-03 3 1  ON 107
ci_0059                -4.537104e-03 3 1  ON 108
ci_0060                -4.592006e-03 3 1  ON 109
ci_0061                -3.438373e-03 3 1  ON 110
ci_0062                -3.175510e-03 3 1  ON 111
ci_0063                -8.744160e-03 3 1  ON 112
ci_0064                -8.734795e-03 3 1  ON 113
ci_0065                -5.104884e-03 3 1  ON 114
ci_0066                -5.684761e-03 3 1  ON 115
ci_0067                -5.089415e-03 3 1  ON 116
ci_0068                -4.566697e-03 3 1  ON 117
ci_0069                 4.602191e-03 3 1  ON 118
ci_0070                 4.196166e-03 3 1  ON 119
ci_0071                 2.488623e-04 3 1  ON 120
ci_0072                 5.084886e-04 3 1  ON 121
ci_0073                 4.393347e-03 3 1  ON 122
ci_0074                 3.764532e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0864e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6929e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8296
    reference variance = 0.204757
====================================================
  Execution time = 2.1669e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4063e-01
  Total weights = 1.951992098e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1707e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326663078723
                                         uncertainty =       0.003287534257

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326663078723
                                         uncertainty =       0.003287534257

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404155565
  error estimate for blocks of size 2^( 2) =       0.000417074352
  error estimate for blocks of size 2^( 3) =       0.000430688555
  error estimate for blocks of size 2^( 4) =       0.000443438393
  error estimate for blocks of size 2^( 5) =       0.000455084100
  error estimate for blocks of size 2^( 6) =       0.000463417775
  error estimate for blocks of size 2^( 7) =       0.000470823810

      target function =                  N/A
              le_mean =     -16.905813153550
             les_mean =     286.147151455345
             stat err =       0.000458191019
             autocorr =       1.285274878081
              std dev =       0.571562281389
             le_variance =       0.326683441506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581315355e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905813153530       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905812160407       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905812104845       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905812310050       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905812110736       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905812227246       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905812176120       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905812244193       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905812241190       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905812294914       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+00 is 1.748976e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905813153530       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905812879227       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905812860816       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905812908101       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905812848791       residual = 7.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905812868918       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905812863395       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905812881992       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905812877141       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905812889358       residual = 2.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e+00 is 5.025311e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905813153530       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905813083109       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905813078136       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905813089515       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905813073988       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905813078367       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905813077533       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905813082166       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905813080812       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905813083670       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.5000e+01 is 1.305777e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.207968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7853e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
   uu_0                 3.122798e-01 1 1  ON 0
   uu_1                 1.449981e-01 1 1  ON 1
   uu_2                 4.312993e-02 1 1  ON 2
   uu_3                -1.922336e-02 1 1  ON 3
   uu_4                -6.461751e-02 1 1  ON 4
   uu_5                -9.942673e-02 1 1  ON 5
   uu_6                -1.270926e-01 1 1  ON 6
   uu_7                -1.401993e-01 1 1  ON 7
   uu_8                -1.323496e-01 1 1  ON 8
   uu_9                -1.011233e-01 1 1  ON 9
   ud_0                 4.460987e-01 1 1  ON 10
   ud_1                 1.803980e-01 1 1  ON 11
   ud_2                 6.017430e-02 1 1  ON 12
   ud_3                -1.053303e-02 1 1  ON 13
   ud_4                -6.693443e-02 1 1  ON 14
   ud_5                -1.078782e-01 1 1  ON 15
   ud_6                -1.347134e-01 1 1  ON 16
   ud_7                -1.498157e-01 1 1  ON 17
   ud_8                -1.510034e-01 1 1  ON 18
   ud_9                -1.392120e-01 1 1  ON 19
   eO_0                -7.485596e-01 1 1  ON 20
   eO_1                -4.286650e-01 1 1  ON 21
   eO_2                -1.902125e-02 1 1  ON 22
   eO_3                 2.910495e-01 1 1  ON 23
   eO_4                 5.136337e-01 1 1  ON 24
   eO_5                 4.742292e-01 1 1  ON 25
   eO_6                 2.475289e-01 1 1  ON 26
   eO_7                -4.798966e-02 1 1  ON 27
   eO_8                -2.116742e-01 1 1  ON 28
   eO_9                -7.160139e-02 1 1  ON 29
  eH1_0                -2.496760e-01 1 1  ON 30
  eH1_1                -1.425036e-01 1 1  ON 31
  eH1_2                -9.307626e-02 1 1  ON 32
  eH1_3                -3.843115e-02 1 1  ON 33
  eH1_4                 1.068637e-02 1 1  ON 34
  eH1_5                 4.446994e-02 1 1  ON 35
  eH1_6                 1.012321e-01 1 1  ON 36
  eH1_7                 1.517913e-01 1 1  ON 37
  eH1_8                 1.670613e-01 1 1  ON 38
  eH1_9                 5.238144e-02 1 1  ON 39
  eH2_0                -2.470817e-01 1 1  ON 40
  eH2_1                -1.401224e-01 1 1  ON 41
  eH2_2                -9.064668e-02 1 1  ON 42
  eH2_3                -3.551532e-02 1 1  ON 43
  eH2_4                 1.329863e-02 1 1  ON 44
  eH2_5                 4.860364e-02 1 1  ON 45
  eH2_6                 1.047979e-01 1 1  ON 46
  eH2_7                 1.543098e-01 1 1  ON 47
  eH2_8                 1.717059e-01 1 1  ON 48
  eH2_9                 3.796342e-02 1 1  ON 49
ci_0001                 7.013095e-01 3 1  ON 50
ci_0002                 7.004844e-01 3 1  ON 51
ci_0003                -2.732710e-02 3 1  ON 52
ci_0004                -2.701002e-02 3 1  ON 53
ci_0005                -3.608968e-02 3 1  ON 54
ci_0006                -3.685795e-02 3 1  ON 55
ci_0007                -2.216682e-02 3 1  ON 56
ci_0008                -2.136074e-02 3 1  ON 57
ci_0009                -1.763041e-02 3 1  ON 58
ci_0010                -1.767478e-02 3 1  ON 59
ci_0011                -1.205100e-02 3 1  ON 60
ci_0012                -1.247527e-02 3 1  ON 61
ci_0013                 1.279859e-02 3 1  ON 62
ci_0014                 1.298039e-02 3 1  ON 63
ci_0015                 1.328385e-02 3 1  ON 64
ci_0016                 1.325131e-02 3 1  ON 65
ci_0017                 1.156444e-02 3 1  ON 66
ci_0018                 1.119215e-02 3 1  ON 67
ci_0019                 1.093817e-02 3 1  ON 68
ci_0020                 1.138792e-02 3 1  ON 69
ci_0021                -1.075926e-03 3 1  ON 70
ci_0022                -1.016584e-03 3 1  ON 71
ci_0023                -1.097133e-02 3 1  ON 72
ci_0024                -1.097797e-02 3 1  ON 73
ci_0025                -1.064515e-02 3 1  ON 74
ci_0026                -1.057358e-02 3 1  ON 75
ci_0027                -1.134069e-02 3 1  ON 76
ci_0028                -1.082410e-02 3 1  ON 77
ci_0029                -1.055580e-02 3 1  ON 78
ci_0030                -1.070786e-02 3 1  ON 79
ci_0031                 1.951681e-02 3 1  ON 80
ci_0032                 2.042421e-02 3 1  ON 81
ci_0033                 1.068244e-02 3 1  ON 82
ci_0034                 1.018924e-02 3 1  ON 83
ci_0035                 6.964823e-03 3 1  ON 84
ci_0036                 6.801659e-03 3 1  ON 85
ci_0037                -1.059499e-02 3 1  ON 86
ci_0038                -1.068261e-02 3 1  ON 87
ci_0039                -2.569802e-03 3 1  ON 88
ci_0040                -2.783291e-03 3 1  ON 89
ci_0041                 6.933645e-03 3 1  ON 90
ci_0042                 7.259641e-03 3 1  ON 91
ci_0043                -1.874265e-02 3 1  ON 92
ci_0044                -1.900920e-02 3 1  ON 93
ci_0045                 7.803007e-03 3 1  ON 94
ci_0046                 7.164062e-03 3 1  ON 95
ci_0047                -1.456509e-03 3 1  ON 96
ci_0048                -2.087378e-03 3 1  ON 97
ci_0049                -5.329097e-03 3 1  ON 98
ci_0050                -5.386305e-03 3 1  ON 99
ci_0051                -3.098410e-03 3 1  ON 100
ci_0052                -3.412951e-03 3 1  ON 101
ci_0053                -4.739013e-03 3 1  ON 102
ci_0054                -4.583366e-03 3 1  ON 103
ci_0055                 6.519590e-03 3 1  ON 104
ci_0056                 6.118343e-03 3 1  ON 105
ci_0057                 4.668643e-03 3 1  ON 106
ci_0058                 4.672420e-03 3 1  ON 107
ci_0059                -4.530739e-03 3 1  ON 108
ci_0060                -4.560313e-03 3 1  ON 109
ci_0061                -3.425367e-03 3 1  ON 110
ci_0062                -3.196367e-03 3 1  ON 111
ci_0063                -8.742434e-03 3 1  ON 112
ci_0064                -8.713041e-03 3 1  ON 113
ci_0065                -5.112189e-03 3 1  ON 114
ci_0066                -5.676659e-03 3 1  ON 115
ci_0067                -5.086279e-03 3 1  ON 116
ci_0068                -4.569630e-03 3 1  ON 117
ci_0069                 4.604235e-03 3 1  ON 118
ci_0070                 4.226118e-03 3 1  ON 119
ci_0071                 2.342130e-04 3 1  ON 120
ci_0072                 4.922734e-04 3 1  ON 121
ci_0073                 4.360639e-03 3 1  ON 122
ci_0074                 3.814785e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8243
    reference variance = 0.180699
====================================================
  Execution time = 2.1424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3320e-01
  Total weights = 1.9517e+06
  Execution time = 1.9099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322114907619
                                         uncertainty =       0.002457136544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322114907619
                                         uncertainty =       0.002457136544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401284817
  error estimate for blocks of size 2^( 2) =       0.000414185663
  error estimate for blocks of size 2^( 3) =       0.000427867848
  error estimate for blocks of size 2^( 4) =       0.000440627008
  error estimate for blocks of size 2^( 5) =       0.000450515694
  error estimate for blocks of size 2^( 6) =       0.000455875203
  error estimate for blocks of size 2^( 7) =       0.000460843864

      target function =                  N/A
              le_mean =     -16.905990544181
             les_mean =     286.145991704980
             stat err =       0.000451965442
             autocorr =       1.268542443745
              std dev =       0.567502430463
             le_variance =       0.322059008582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322221577275
                                         uncertainty =       0.002458798602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322221577275
                                         uncertainty =       0.002458798602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401351206
  error estimate for blocks of size 2^( 2) =       0.000414252069
  error estimate for blocks of size 2^( 3) =       0.000427934926
  error estimate for blocks of size 2^( 4) =       0.000440689893
  error estimate for blocks of size 2^( 5) =       0.000450575106
  error estimate for blocks of size 2^( 6) =       0.000455934672
  error estimate for blocks of size 2^( 7) =       0.000460903990

      target function =                  N/A
              le_mean =     -16.905990764189
             les_mean =     286.145840143237
             stat err =       0.000452025915
             autocorr =       1.268462180580
              std dev =       0.567596318968
             le_variance =       0.322165581306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322169499347
                                         uncertainty =       0.002457942165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322169499347
                                         uncertainty =       0.002457942165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401318792
  error estimate for blocks of size 2^( 2) =       0.000414219718
  error estimate for blocks of size 2^( 3) =       0.000427902474
  error estimate for blocks of size 2^( 4) =       0.000440659381
  error estimate for blocks of size 2^( 5) =       0.000450546228
  error estimate for blocks of size 2^( 6) =       0.000455905602
  error estimate for blocks of size 2^( 7) =       0.000460874682

      target function =                  N/A
              le_mean =     -16.905990424609
             les_mean =     286.145684601439
             stat err =       0.000451996473
             autocorr =       1.268501835095
              std dev =       0.567550478318
             le_variance =       0.322113545439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322121575237
                                         uncertainty =       0.002457233031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322121575237
                                         uncertainty =       0.002457233031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401288966
  error estimate for blocks of size 2^( 2) =       0.000414189824
  error estimate for blocks of size 2^( 3) =       0.000427872097
  error estimate for blocks of size 2^( 4) =       0.000440630974
  error estimate for blocks of size 2^( 5) =       0.000450519428
  error estimate for blocks of size 2^( 6) =       0.000455878901
  error estimate for blocks of size 2^( 7) =       0.000460847620

      target function =                  N/A
              le_mean =     -16.905990491213
             les_mean =     286.145864809848
             stat err =       0.000451969231
             autocorr =       1.268537477182
              std dev =       0.567508298805
             le_variance =       0.322065669213


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905990544181        initial
     1.5625e+00     1.5625e+01             1.7490e-04       -16.905990764189  <--
     6.2500e+00     6.2500e+01             5.0253e-05       -16.905990424609
     2.5000e+01     2.5000e+02             1.3058e-05       -16.905990491213

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 3.1083e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
   uu_0                 3.123181e-01 1 1  ON 0
   uu_1                 1.449976e-01 1 1  ON 1
   uu_2                 4.312487e-02 1 1  ON 2
   uu_3                -1.922079e-02 1 1  ON 3
   uu_4                -6.461350e-02 1 1  ON 4
   uu_5                -9.945814e-02 1 1  ON 5
   uu_6                -1.271088e-01 1 1  ON 6
   uu_7                -1.402066e-01 1 1  ON 7
   uu_8                -1.323862e-01 1 1  ON 8
   uu_9                -1.011687e-01 1 1  ON 9
   ud_0                 4.461508e-01 1 1  ON 10
   ud_1                 1.804401e-01 1 1  ON 11
   ud_2                 6.016908e-02 1 1  ON 12
   ud_3                -1.054926e-02 1 1  ON 13
   ud_4                -6.692692e-02 1 1  ON 14
   ud_5                -1.078648e-01 1 1  ON 15
   ud_6                -1.347282e-01 1 1  ON 16
   ud_7                -1.498675e-01 1 1  ON 17
   ud_8                -1.510210e-01 1 1  ON 18
   ud_9                -1.392278e-01 1 1  ON 19
   eO_0                -7.486060e-01 1 1  ON 20
   eO_1                -4.286742e-01 1 1  ON 21
   eO_2                -1.901167e-02 1 1  ON 22
   eO_3                 2.910804e-01 1 1  ON 23
   eO_4                 5.136319e-01 1 1  ON 24
   eO_5                 4.742787e-01 1 1  ON 25
   eO_6                 2.475988e-01 1 1  ON 26
   eO_7                -4.797165e-02 1 1  ON 27
   eO_8                -2.117293e-01 1 1  ON 28
   eO_9                -7.165642e-02 1 1  ON 29
  eH1_0                -2.496998e-01 1 1  ON 30
  eH1_1                -1.425895e-01 1 1  ON 31
  eH1_2                -9.311152e-02 1 1  ON 32
  eH1_3                -3.847904e-02 1 1  ON 33
  eH1_4                 1.064500e-02 1 1  ON 34
  eH1_5                 4.447626e-02 1 1  ON 35
  eH1_6                 1.012188e-01 1 1  ON 36
  eH1_7                 1.518527e-01 1 1  ON 37
  eH1_8                 1.671551e-01 1 1  ON 38
  eH1_9                 5.246748e-02 1 1  ON 39
  eH2_0                -2.471063e-01 1 1  ON 40
  eH2_1                -1.401486e-01 1 1  ON 41
  eH2_2                -9.065379e-02 1 1  ON 42
  eH2_3                -3.557871e-02 1 1  ON 43
  eH2_4                 1.330541e-02 1 1  ON 44
  eH2_5                 4.854547e-02 1 1  ON 45
  eH2_6                 1.047617e-01 1 1  ON 46
  eH2_7                 1.543330e-01 1 1  ON 47
  eH2_8                 1.717857e-01 1 1  ON 48
  eH2_9                 3.805999e-02 1 1  ON 49
ci_0001                 7.013368e-01 3 1  ON 50
ci_0002                 7.004562e-01 3 1  ON 51
ci_0003                -2.734048e-02 3 1  ON 52
ci_0004                -2.703588e-02 3 1  ON 53
ci_0005                -3.605799e-02 3 1  ON 54
ci_0006                -3.690970e-02 3 1  ON 55
ci_0007                -2.210504e-02 3 1  ON 56
ci_0008                -2.139588e-02 3 1  ON 57
ci_0009                -1.751356e-02 3 1  ON 58
ci_0010                -1.760630e-02 3 1  ON 59
ci_0011                -1.203029e-02 3 1  ON 60
ci_0012                -1.241265e-02 3 1  ON 61
ci_0013                 1.277405e-02 3 1  ON 62
ci_0014                 1.310372e-02 3 1  ON 63
ci_0015                 1.328540e-02 3 1  ON 64
ci_0016                 1.327603e-02 3 1  ON 65
ci_0017                 1.144286e-02 3 1  ON 66
ci_0018                 1.107269e-02 3 1  ON 67
ci_0019                 1.094525e-02 3 1  ON 68
ci_0020                 1.142750e-02 3 1  ON 69
ci_0021                -1.043329e-03 3 1  ON 70
ci_0022                -9.846307e-04 3 1  ON 71
ci_0023                -1.095413e-02 3 1  ON 72
ci_0024                -1.094798e-02 3 1  ON 73
ci_0025                -1.065251e-02 3 1  ON 74
ci_0026                -1.061430e-02 3 1  ON 75
ci_0027                -1.131435e-02 3 1  ON 76
ci_0028                -1.081374e-02 3 1  ON 77
ci_0029                -1.059587e-02 3 1  ON 78
ci_0030                -1.074421e-02 3 1  ON 79
ci_0031                 1.957535e-02 3 1  ON 80
ci_0032                 2.051024e-02 3 1  ON 81
ci_0033                 1.064898e-02 3 1  ON 82
ci_0034                 1.026436e-02 3 1  ON 83
ci_0035                 7.022366e-03 3 1  ON 84
ci_0036                 6.793992e-03 3 1  ON 85
ci_0037                -1.062417e-02 3 1  ON 86
ci_0038                -1.074383e-02 3 1  ON 87
ci_0039                -2.562674e-03 3 1  ON 88
ci_0040                -2.703927e-03 3 1  ON 89
ci_0041                 6.884197e-03 3 1  ON 90
ci_0042                 7.206958e-03 3 1  ON 91
ci_0043                -1.875389e-02 3 1  ON 92
ci_0044                -1.896376e-02 3 1  ON 93
ci_0045                 7.825149e-03 3 1  ON 94
ci_0046                 7.178842e-03 3 1  ON 95
ci_0047                -1.456938e-03 3 1  ON 96
ci_0048                -2.076109e-03 3 1  ON 97
ci_0049                -5.387189e-03 3 1  ON 98
ci_0050                -5.456235e-03 3 1  ON 99
ci_0051                -3.103048e-03 3 1  ON 100
ci_0052                -3.357177e-03 3 1  ON 101
ci_0053                -4.734846e-03 3 1  ON 102
ci_0054                -4.573139e-03 3 1  ON 103
ci_0055                 6.593613e-03 3 1  ON 104
ci_0056                 6.162078e-03 3 1  ON 105
ci_0057                 4.742211e-03 3 1  ON 106
ci_0058                 4.616825e-03 3 1  ON 107
ci_0059                -4.514843e-03 3 1  ON 108
ci_0060                -4.479698e-03 3 1  ON 109
ci_0061                -3.390456e-03 3 1  ON 110
ci_0062                -3.251763e-03 3 1  ON 111
ci_0063                -8.737660e-03 3 1  ON 112
ci_0064                -8.657048e-03 3 1  ON 113
ci_0065                -5.131117e-03 3 1  ON 114
ci_0066                -5.655929e-03 3 1  ON 115
ci_0067                -5.078074e-03 3 1  ON 116
ci_0068                -4.575919e-03 3 1  ON 117
ci_0069                 4.609145e-03 3 1  ON 118
ci_0070                 4.300376e-03 3 1  ON 119
ci_0071                 1.958620e-04 3 1  ON 120
ci_0072                 4.505776e-04 3 1  ON 121
ci_0073                 4.279543e-03 3 1  ON 122
ci_0074                 3.939430e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9571
    reference variance = 0.435416
====================================================
  Execution time = 2.1817e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3499e-01
  Total weights = 1.951952543e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324102745206
                                         uncertainty =       0.002427292672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324102745206
                                         uncertainty =       0.002427292672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402700689
  error estimate for blocks of size 2^( 2) =       0.000415410114
  error estimate for blocks of size 2^( 3) =       0.000428819053
  error estimate for blocks of size 2^( 4) =       0.000441241441
  error estimate for blocks of size 2^( 5) =       0.000451353246
  error estimate for blocks of size 2^( 6) =       0.000456810831
  error estimate for blocks of size 2^( 7) =       0.000462853452

      target function =                  N/A
              le_mean =     -16.906832357569
             les_mean =     286.175967504382
             stat err =       0.000453064743
             autocorr =       1.265772887601
              std dev =       0.569504775413
             le_variance =       0.324335689218


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690683235757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906832357543       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906841708617       residual = 7.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906838101684       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906838791939       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906839147529       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906837848890       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906838578154       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906839456001       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906839505320       residual = 6.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906839362154       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906839163647       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906839116792       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-01 is 6.854745e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906832357543       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906835549842       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906834360882       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906834237310       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906834431765       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906834108892       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906834242125       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906834459587       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906834449094       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906834460763       residual = 5.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+00 is 2.260220e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906832357543       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906833235883       residual = 7.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906832912887       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906832850196       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906832890897       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906832819585       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906832853620       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906832894943       residual = 4.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906832903647       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906832906308       residual = 4.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.2500e+00 is 6.159812e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.212608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8025e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
   uu_0                 3.123291e-01 1 1  ON 0
   uu_1                 1.449937e-01 1 1  ON 1
   uu_2                 4.315235e-02 1 1  ON 2
   uu_3                -1.919767e-02 1 1  ON 3
   uu_4                -6.465493e-02 1 1  ON 4
   uu_5                -9.945286e-02 1 1  ON 5
   uu_6                -1.271226e-01 1 1  ON 6
   uu_7                -1.402896e-01 1 1  ON 7
   uu_8                -1.324656e-01 1 1  ON 8
   uu_9                -1.011982e-01 1 1  ON 9
   ud_0                 4.460679e-01 1 1  ON 10
   ud_1                 1.804396e-01 1 1  ON 11
   ud_2                 6.023696e-02 1 1  ON 12
   ud_3                -1.048939e-02 1 1  ON 13
   ud_4                -6.691225e-02 1 1  ON 14
   ud_5                -1.079057e-01 1 1  ON 15
   ud_6                -1.347178e-01 1 1  ON 16
   ud_7                -1.499373e-01 1 1  ON 17
   ud_8                -1.510702e-01 1 1  ON 18
   ud_9                -1.392112e-01 1 1  ON 19
   eO_0                -7.486000e-01 1 1  ON 20
   eO_1                -4.286166e-01 1 1  ON 21
   eO_2                -1.909737e-02 1 1  ON 22
   eO_3                 2.910153e-01 1 1  ON 23
   eO_4                 5.136749e-01 1 1  ON 24
   eO_5                 4.743874e-01 1 1  ON 25
   eO_6                 2.476646e-01 1 1  ON 26
   eO_7                -4.795264e-02 1 1  ON 27
   eO_8                -2.117967e-01 1 1  ON 28
   eO_9                -7.172942e-02 1 1  ON 29
  eH1_0                -2.498042e-01 1 1  ON 30
  eH1_1                -1.426573e-01 1 1  ON 31
  eH1_2                -9.320955e-02 1 1  ON 32
  eH1_3                -3.859010e-02 1 1  ON 33
  eH1_4                 1.066612e-02 1 1  ON 34
  eH1_5                 4.456278e-02 1 1  ON 35
  eH1_6                 1.012380e-01 1 1  ON 36
  eH1_7                 1.519077e-01 1 1  ON 37
  eH1_8                 1.672472e-01 1 1  ON 38
  eH1_9                 5.257056e-02 1 1  ON 39
  eH2_0                -2.471850e-01 1 1  ON 40
  eH2_1                -1.401902e-01 1 1  ON 41
  eH2_2                -9.071721e-02 1 1  ON 42
  eH2_3                -3.570934e-02 1 1  ON 43
  eH2_4                 1.332106e-02 1 1  ON 44
  eH2_5                 4.854108e-02 1 1  ON 45
  eH2_6                 1.047136e-01 1 1  ON 46
  eH2_7                 1.543855e-01 1 1  ON 47
  eH2_8                 1.719187e-01 1 1  ON 48
  eH2_9                 3.821256e-02 1 1  ON 49
ci_0001                 7.013340e-01 3 1  ON 50
ci_0002                 7.004276e-01 3 1  ON 51
ci_0003                -2.727870e-02 3 1  ON 52
ci_0004                -2.724593e-02 3 1  ON 53
ci_0005                -3.611876e-02 3 1  ON 54
ci_0006                -3.689588e-02 3 1  ON 55
ci_0007                -2.205338e-02 3 1  ON 56
ci_0008                -2.145692e-02 3 1  ON 57
ci_0009                -1.758844e-02 3 1  ON 58
ci_0010                -1.766176e-02 3 1  ON 59
ci_0011                -1.205417e-02 3 1  ON 60
ci_0012                -1.235654e-02 3 1  ON 61
ci_0013                 1.292361e-02 3 1  ON 62
ci_0014                 1.308589e-02 3 1  ON 63
ci_0015                 1.329177e-02 3 1  ON 64
ci_0016                 1.329217e-02 3 1  ON 65
ci_0017                 1.146558e-02 3 1  ON 66
ci_0018                 1.101217e-02 3 1  ON 67
ci_0019                 1.106025e-02 3 1  ON 68
ci_0020                 1.141128e-02 3 1  ON 69
ci_0021                -1.073045e-03 3 1  ON 70
ci_0022                -1.039330e-03 3 1  ON 71
ci_0023                -1.105328e-02 3 1  ON 72
ci_0024                -1.095654e-02 3 1  ON 73
ci_0025                -1.072164e-02 3 1  ON 74
ci_0026                -1.064781e-02 3 1  ON 75
ci_0027                -1.131650e-02 3 1  ON 76
ci_0028                -1.086422e-02 3 1  ON 77
ci_0029                -1.055767e-02 3 1  ON 78
ci_0030                -1.078500e-02 3 1  ON 79
ci_0031                 1.970399e-02 3 1  ON 80
ci_0032                 2.055861e-02 3 1  ON 81
ci_0033                 1.051209e-02 3 1  ON 82
ci_0034                 1.020436e-02 3 1  ON 83
ci_0035                 7.122633e-03 3 1  ON 84
ci_0036                 6.802592e-03 3 1  ON 85
ci_0037                -1.063375e-02 3 1  ON 86
ci_0038                -1.070055e-02 3 1  ON 87
ci_0039                -2.578879e-03 3 1  ON 88
ci_0040                -2.715420e-03 3 1  ON 89
ci_0041                 6.790465e-03 3 1  ON 90
ci_0042                 7.226472e-03 3 1  ON 91
ci_0043                -1.882226e-02 3 1  ON 92
ci_0044                -1.905698e-02 3 1  ON 93
ci_0045                 7.859603e-03 3 1  ON 94
ci_0046                 7.153460e-03 3 1  ON 95
ci_0047                -1.548557e-03 3 1  ON 96
ci_0048                -1.922873e-03 3 1  ON 97
ci_0049                -5.533315e-03 3 1  ON 98
ci_0050                -5.660114e-03 3 1  ON 99
ci_0051                -3.173187e-03 3 1  ON 100
ci_0052                -3.409935e-03 3 1  ON 101
ci_0053                -4.786281e-03 3 1  ON 102
ci_0054                -4.626331e-03 3 1  ON 103
ci_0055                 6.561340e-03 3 1  ON 104
ci_0056                 6.220768e-03 3 1  ON 105
ci_0057                 4.754082e-03 3 1  ON 106
ci_0058                 4.631775e-03 3 1  ON 107
ci_0059                -4.620198e-03 3 1  ON 108
ci_0060                -4.561343e-03 3 1  ON 109
ci_0061                -3.363111e-03 3 1  ON 110
ci_0062                -3.477785e-03 3 1  ON 111
ci_0063                -8.688766e-03 3 1  ON 112
ci_0064                -8.535609e-03 3 1  ON 113
ci_0065                -5.153500e-03 3 1  ON 114
ci_0066                -5.634977e-03 3 1  ON 115
ci_0067                -5.058320e-03 3 1  ON 116
ci_0068                -4.684636e-03 3 1  ON 117
ci_0069                 4.575280e-03 3 1  ON 118
ci_0070                 4.303814e-03 3 1  ON 119
ci_0071                 2.527081e-04 3 1  ON 120
ci_0072                 4.116359e-04 3 1  ON 121
ci_0073                 4.380899e-03 3 1  ON 122
ci_0074                 4.085057e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.0333
    reference variance = 0.456418
====================================================
  Execution time = 2.1713e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2818e-01
  Total weights = 1.9519e+06
  Execution time = 1.9194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318163727347
                                         uncertainty =       0.001860431874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318163727347
                                         uncertainty =       0.001860431874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398869728
  error estimate for blocks of size 2^( 2) =       0.000411823933
  error estimate for blocks of size 2^( 3) =       0.000424741109
  error estimate for blocks of size 2^( 4) =       0.000437638068
  error estimate for blocks of size 2^( 5) =       0.000447170010
  error estimate for blocks of size 2^( 6) =       0.000453270960
  error estimate for blocks of size 2^( 7) =       0.000457599867

      target function =                  N/A
              le_mean =     -16.907010535693
             les_mean =     286.175063703492
             stat err =       0.000448919726
             autocorr =       1.266704239639
              std dev =       0.564086979509
             le_variance =       0.318194120451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318348115596
                                         uncertainty =       0.001858708882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318348115596
                                         uncertainty =       0.001858708882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398984634
  error estimate for blocks of size 2^( 2) =       0.000411932095
  error estimate for blocks of size 2^( 3) =       0.000424835188
  error estimate for blocks of size 2^( 4) =       0.000437710063
  error estimate for blocks of size 2^( 5) =       0.000447237851
  error estimate for blocks of size 2^( 6) =       0.000453332747
  error estimate for blocks of size 2^( 7) =       0.000457632347

      target function =                  N/A
              le_mean =     -16.907011280340
             les_mean =     286.176410161547
             stat err =       0.000448978252
             autocorr =       1.266304844745
              std dev =       0.564249481227
             le_variance =       0.318377477065

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318251756996
                                         uncertainty =       0.001859149869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318251756996
                                         uncertainty =       0.001859149869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398924445
  error estimate for blocks of size 2^( 2) =       0.000411874648
  error estimate for blocks of size 2^( 3) =       0.000424782859
  error estimate for blocks of size 2^( 4) =       0.000437667295
  error estimate for blocks of size 2^( 5) =       0.000447196518
  error estimate for blocks of size 2^( 6) =       0.000453293704
  error estimate for blocks of size 2^( 7) =       0.000457604333

      target function =                  N/A
              le_mean =     -16.907008974803
             les_mean =     286.176282331373
             stat err =       0.000448940462
             autocorr =       1.266473769245
              std dev =       0.564164361005
             le_variance =       0.318281426229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318170554033
                                         uncertainty =       0.001860241445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318170554033
                                         uncertainty =       0.001860241445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398873945
  error estimate for blocks of size 2^( 2) =       0.000411827683
  error estimate for blocks of size 2^( 3) =       0.000424743572
  error estimate for blocks of size 2^( 4) =       0.000437638880
  error estimate for blocks of size 2^( 5) =       0.000447170104
  error estimate for blocks of size 2^( 6) =       0.000453269906
  error estimate for blocks of size 2^( 7) =       0.000457596174

      target function =                  N/A
              le_mean =     -16.907009601869
             les_mean =     286.175215549919
             stat err =       0.000448918766
             autocorr =       1.266672038799
              std dev =       0.564092942903
             le_variance =       0.318200848233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907010535693        initial
     3.9062e-01     3.9062e+00             6.8547e-04       -16.907011280340  <--
     1.5625e+00     1.5625e+01             2.2602e-04       -16.907008974803
     6.2500e+00     6.2500e+01             6.1598e-05       -16.907009601869

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 3.1420e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
   uu_0                 3.123625e-01 1 1  ON 0
   uu_1                 1.450127e-01 1 1  ON 1
   uu_2                 4.321870e-02 1 1  ON 2
   uu_3                -1.913351e-02 1 1  ON 3
   uu_4                -6.472563e-02 1 1  ON 4
   uu_5                -9.948298e-02 1 1  ON 5
   uu_6                -1.271889e-01 1 1  ON 6
   uu_7                -1.405186e-01 1 1  ON 7
   uu_8                -1.327087e-01 1 1  ON 8
   uu_9                -1.012988e-01 1 1  ON 9
   ud_0                 4.459628e-01 1 1  ON 10
   ud_1                 1.804542e-01 1 1  ON 11
   ud_2                 6.036021e-02 1 1  ON 12
   ud_3                -1.036235e-02 1 1  ON 13
   ud_4                -6.688462e-02 1 1  ON 14
   ud_5                -1.079989e-01 1 1  ON 15
   ud_6                -1.347506e-01 1 1  ON 16
   ud_7                -1.501134e-01 1 1  ON 17
   ud_8                -1.512161e-01 1 1  ON 18
   ud_9                -1.391727e-01 1 1  ON 19
   eO_0                -7.485380e-01 1 1  ON 20
   eO_1                -4.285404e-01 1 1  ON 21
   eO_2                -1.926853e-02 1 1  ON 22
   eO_3                 2.908378e-01 1 1  ON 23
   eO_4                 5.137691e-01 1 1  ON 24
   eO_5                 4.746957e-01 1 1  ON 25
   eO_6                 2.478690e-01 1 1  ON 26
   eO_7                -4.788952e-02 1 1  ON 27
   eO_8                -2.120047e-01 1 1  ON 28
   eO_9                -7.195412e-02 1 1  ON 29
  eH1_0                -2.501127e-01 1 1  ON 30
  eH1_1                -1.428761e-01 1 1  ON 31
  eH1_2                -9.347442e-02 1 1  ON 32
  eH1_3                -3.887242e-02 1 1  ON 33
  eH1_4                 1.068125e-02 1 1  ON 34
  eH1_5                 4.478394e-02 1 1  ON 35
  eH1_6                 1.012992e-01 1 1  ON 36
  eH1_7                 1.520771e-01 1 1  ON 37
  eH1_8                 1.675285e-01 1 1  ON 38
  eH1_9                 5.288454e-02 1 1  ON 39
  eH2_0                -2.474170e-01 1 1  ON 40
  eH2_1                -1.403514e-01 1 1  ON 41
  eH2_2                -9.091001e-02 1 1  ON 42
  eH2_3                -3.602185e-02 1 1  ON 43
  eH2_4                 1.330076e-02 1 1  ON 44
  eH2_5                 4.852833e-02 1 1  ON 45
  eH2_6                 1.045842e-01 1 1  ON 46
  eH2_7                 1.545412e-01 1 1  ON 47
  eH2_8                 1.723200e-01 1 1  ON 48
  eH2_9                 3.867717e-02 1 1  ON 49
ci_0001                 7.013488e-01 3 1  ON 50
ci_0002                 7.003498e-01 3 1  ON 51
ci_0003                -2.714699e-02 3 1  ON 52
ci_0004                -2.767628e-02 3 1  ON 53
ci_0005                -3.626607e-02 3 1  ON 54
ci_0006                -3.686739e-02 3 1  ON 55
ci_0007                -2.192867e-02 3 1  ON 56
ci_0008                -2.160111e-02 3 1  ON 57
ci_0009                -1.772416e-02 3 1  ON 58
ci_0010                -1.776388e-02 3 1  ON 59
ci_0011                -1.208993e-02 3 1  ON 60
ci_0012                -1.223973e-02 3 1  ON 61
ci_0013                 1.321476e-02 3 1  ON 62
ci_0014                 1.304311e-02 3 1  ON 63
ci_0015                 1.330390e-02 3 1  ON 64
ci_0016                 1.331644e-02 3 1  ON 65
ci_0017                 1.150225e-02 3 1  ON 66
ci_0018                 1.089543e-02 3 1  ON 67
ci_0019                 1.127747e-02 3 1  ON 68
ci_0020                 1.137310e-02 3 1  ON 69
ci_0021                -1.147759e-03 3 1  ON 70
ci_0022                -1.173266e-03 3 1  ON 71
ci_0023                -1.123566e-02 3 1  ON 72
ci_0024                -1.097247e-02 3 1  ON 73
ci_0025                -1.085760e-02 3 1  ON 74
ci_0026                -1.071316e-02 3 1  ON 75
ci_0027                -1.131394e-02 3 1  ON 76
ci_0028                -1.095908e-02 3 1  ON 77
ci_0029                -1.047961e-02 3 1  ON 78
ci_0030                -1.086256e-02 3 1  ON 79
ci_0031                 2.000278e-02 3 1  ON 80
ci_0032                 2.067409e-02 3 1  ON 81
ci_0033                 1.019965e-02 3 1  ON 82
ci_0034                 1.006101e-02 3 1  ON 83
ci_0035                 7.319954e-03 3 1  ON 84
ci_0036                 6.808023e-03 3 1  ON 85
ci_0037                -1.065498e-02 3 1  ON 86
ci_0038                -1.060733e-02 3 1  ON 87
ci_0039                -2.605452e-03 3 1  ON 88
ci_0040                -2.733145e-03 3 1  ON 89
ci_0041                 6.604634e-03 3 1  ON 90
ci_0042                 7.259260e-03 3 1  ON 91
ci_0043                -1.898262e-02 3 1  ON 92
ci_0044                -1.928694e-02 3 1  ON 93
ci_0045                 7.932983e-03 3 1  ON 94
ci_0046                 7.095178e-03 3 1  ON 95
ci_0047                -1.696450e-03 3 1  ON 96
ci_0048                -1.679084e-03 3 1  ON 97
ci_0049                -5.813902e-03 3 1  ON 98
ci_0050                -6.061247e-03 3 1  ON 99
ci_0051                -3.288036e-03 3 1  ON 100
ci_0052                -3.493671e-03 3 1  ON 101
ci_0053                -4.877527e-03 3 1  ON 102
ci_0054                -4.714611e-03 3 1  ON 103
ci_0055                 6.486961e-03 3 1  ON 104
ci_0056                 6.341512e-03 3 1  ON 105
ci_0057                 4.771422e-03 3 1  ON 106
ci_0058                 4.656026e-03 3 1  ON 107
ci_0059                -4.798713e-03 3 1  ON 108
ci_0060                -4.697675e-03 3 1  ON 109
ci_0061                -3.304699e-03 3 1  ON 110
ci_0062                -3.937237e-03 3 1  ON 111
ci_0063                -8.605878e-03 3 1  ON 112
ci_0064                -8.319760e-03 3 1  ON 113
ci_0065                -5.196356e-03 3 1  ON 114
ci_0066                -5.594165e-03 3 1  ON 115
ci_0067                -5.025330e-03 3 1  ON 116
ci_0068                -4.859521e-03 3 1  ON 117
ci_0069                 4.519865e-03 3 1  ON 118
ci_0070                 4.308155e-03 3 1  ON 119
ci_0071                 3.603189e-04 3 1  ON 120
ci_0072                 3.393831e-04 3 1  ON 121
ci_0073                 4.545909e-03 3 1  ON 122
ci_0074                 4.321001e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9452e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9391
    reference variance = 0.528505
====================================================
  Execution time = 2.2326e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2837e-01
  Total weights = 1.951714514e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1346e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318692037847
                                         uncertainty =       0.001974041784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.318692037847
                                         uncertainty =       0.001974041784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399155710
  error estimate for blocks of size 2^( 2) =       0.000412446551
  error estimate for blocks of size 2^( 3) =       0.000426358305
  error estimate for blocks of size 2^( 4) =       0.000439321307
  error estimate for blocks of size 2^( 5) =       0.000449602651
  error estimate for blocks of size 2^( 6) =       0.000457894453
  error estimate for blocks of size 2^( 7) =       0.000463320596

      target function =                  N/A
              le_mean =     -16.905430024576
             les_mean =     286.121929813417
             stat err =       0.000452534752
             autocorr =       1.285343418437
              std dev =       0.564491419180
             le_variance =       0.318650562328


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690543002458e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905430024560       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905445814251       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905450916729       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905453382161       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905452161633       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905454996188       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905453275670       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905455324098       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905457399753       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905457818366       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905457751302       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905457766278       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905457413456       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905457464140       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905457449314       residual = 8.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-02 is 2.435424e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905430024560       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905437864744       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905438933550       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905439904986       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905439808215       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905438789705       residual = 7.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905439754140       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905440255473       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905440657742       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905440577738       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905440577417       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905440671723       residual = 2.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-01 is 6.769205e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905430024560       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905432625944       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905432795881       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905432853006       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905432902693       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905432527501       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905432716360       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905432931500       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905432961109       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905432921724       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5625e+00 is 1.944528e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.218739 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8476e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
   uu_0                 3.122803e-01 1 1  ON 0
   uu_1                 1.450641e-01 1 1  ON 1
   uu_2                 4.312696e-02 1 1  ON 2
   uu_3                -1.934919e-02 1 1  ON 3
   uu_4                -6.468015e-02 1 1  ON 4
   uu_5                -9.952968e-02 1 1  ON 5
   uu_6                -1.271486e-01 1 1  ON 6
   uu_7                -1.405210e-01 1 1  ON 7
   uu_8                -1.327514e-01 1 1  ON 8
   uu_9                -1.014112e-01 1 1  ON 9
   ud_0                 4.462817e-01 1 1  ON 10
   ud_1                 1.806202e-01 1 1  ON 11
   ud_2                 6.047906e-02 1 1  ON 12
   ud_3                -1.023688e-02 1 1  ON 13
   ud_4                -6.700665e-02 1 1  ON 14
   ud_5                -1.081055e-01 1 1  ON 15
   ud_6                -1.348232e-01 1 1  ON 16
   ud_7                -1.505962e-01 1 1  ON 17
   ud_8                -1.512752e-01 1 1  ON 18
   ud_9                -1.391268e-01 1 1  ON 19
   eO_0                -7.486746e-01 1 1  ON 20
   eO_1                -4.286867e-01 1 1  ON 21
   eO_2                -1.935191e-02 1 1  ON 22
   eO_3                 2.909333e-01 1 1  ON 23
   eO_4                 5.141116e-01 1 1  ON 24
   eO_5                 4.748256e-01 1 1  ON 25
   eO_6                 2.481294e-01 1 1  ON 26
   eO_7                -4.770944e-02 1 1  ON 27
   eO_8                -2.123015e-01 1 1  ON 28
   eO_9                -7.225643e-02 1 1  ON 29
  eH1_0                -2.503948e-01 1 1  ON 30
  eH1_1                -1.434429e-01 1 1  ON 31
  eH1_2                -9.357505e-02 1 1  ON 32
  eH1_3                -3.895125e-02 1 1  ON 33
  eH1_4                 1.053923e-02 1 1  ON 34
  eH1_5                 4.474351e-02 1 1  ON 35
  eH1_6                 1.012169e-01 1 1  ON 36
  eH1_7                 1.522868e-01 1 1  ON 37
  eH1_8                 1.680641e-01 1 1  ON 38
  eH1_9                 5.336400e-02 1 1  ON 39
  eH2_0                -2.479409e-01 1 1  ON 40
  eH2_1                -1.406717e-01 1 1  ON 41
  eH2_2                -9.088825e-02 1 1  ON 42
  eH2_3                -3.598295e-02 1 1  ON 43
  eH2_4                 1.340170e-02 1 1  ON 44
  eH2_5                 4.838119e-02 1 1  ON 45
  eH2_6                 1.044654e-01 1 1  ON 46
  eH2_7                 1.544764e-01 1 1  ON 47
  eH2_8                 1.726442e-01 1 1  ON 48
  eH2_9                 3.929248e-02 1 1  ON 49
ci_0001                 7.014080e-01 3 1  ON 50
ci_0002                 7.002982e-01 3 1  ON 51
ci_0003                -2.715727e-02 3 1  ON 52
ci_0004                -2.739316e-02 3 1  ON 53
ci_0005                -3.636001e-02 3 1  ON 54
ci_0006                -3.710819e-02 3 1  ON 55
ci_0007                -2.125175e-02 3 1  ON 56
ci_0008                -2.164072e-02 3 1  ON 57
ci_0009                -1.797228e-02 3 1  ON 58
ci_0010                -1.776335e-02 3 1  ON 59
ci_0011                -1.201240e-02 3 1  ON 60
ci_0012                -1.235028e-02 3 1  ON 61
ci_0013                 1.342664e-02 3 1  ON 62
ci_0014                 1.328330e-02 3 1  ON 63
ci_0015                 1.323376e-02 3 1  ON 64
ci_0016                 1.327043e-02 3 1  ON 65
ci_0017                 1.109701e-02 3 1  ON 66
ci_0018                 1.082504e-02 3 1  ON 67
ci_0019                 1.158827e-02 3 1  ON 68
ci_0020                 1.133230e-02 3 1  ON 69
ci_0021                -1.357305e-03 3 1  ON 70
ci_0022                -1.029223e-03 3 1  ON 71
ci_0023                -1.110997e-02 3 1  ON 72
ci_0024                -1.080785e-02 3 1  ON 73
ci_0025                -1.067177e-02 3 1  ON 74
ci_0026                -1.061842e-02 3 1  ON 75
ci_0027                -1.141649e-02 3 1  ON 76
ci_0028                -1.111734e-02 3 1  ON 77
ci_0029                -1.079860e-02 3 1  ON 78
ci_0030                -1.056958e-02 3 1  ON 79
ci_0031                 1.978535e-02 3 1  ON 80
ci_0032                 2.049603e-02 3 1  ON 81
ci_0033                 1.047822e-02 3 1  ON 82
ci_0034                 9.985749e-03 3 1  ON 83
ci_0035                 7.226768e-03 3 1  ON 84
ci_0036                 7.023040e-03 3 1  ON 85
ci_0037                -1.068689e-02 3 1  ON 86
ci_0038                -1.085222e-02 3 1  ON 87
ci_0039                -2.614185e-03 3 1  ON 88
ci_0040                -2.670624e-03 3 1  ON 89
ci_0041                 6.655703e-03 3 1  ON 90
ci_0042                 7.627376e-03 3 1  ON 91
ci_0043                -1.890283e-02 3 1  ON 92
ci_0044                -1.943992e-02 3 1  ON 93
ci_0045                 8.042154e-03 3 1  ON 94
ci_0046                 7.297225e-03 3 1  ON 95
ci_0047                -1.640599e-03 3 1  ON 96
ci_0048                -1.791016e-03 3 1  ON 97
ci_0049                -5.794870e-03 3 1  ON 98
ci_0050                -5.596006e-03 3 1  ON 99
ci_0051                -3.278782e-03 3 1  ON 100
ci_0052                -3.306061e-03 3 1  ON 101
ci_0053                -4.667511e-03 3 1  ON 102
ci_0054                -4.544314e-03 3 1  ON 103
ci_0055                 6.181531e-03 3 1  ON 104
ci_0056                 6.345681e-03 3 1  ON 105
ci_0057                 4.791535e-03 3 1  ON 106
ci_0058                 4.633364e-03 3 1  ON 107
ci_0059                -4.952115e-03 3 1  ON 108
ci_0060                -4.661288e-03 3 1  ON 109
ci_0061                -3.750655e-03 3 1  ON 110
ci_0062                -3.726413e-03 3 1  ON 111
ci_0063                -8.574519e-03 3 1  ON 112
ci_0064                -8.413787e-03 3 1  ON 113
ci_0065                -5.337413e-03 3 1  ON 114
ci_0066                -5.625012e-03 3 1  ON 115
ci_0067                -5.015285e-03 3 1  ON 116
ci_0068                -5.006883e-03 3 1  ON 117
ci_0069                 4.650844e-03 3 1  ON 118
ci_0070                 4.228044e-03 3 1  ON 119
ci_0071                 1.602809e-04 3 1  ON 120
ci_0072                -6.540439e-05 3 1  ON 121
ci_0073                 4.445220e-03 3 1  ON 122
ci_0074                 4.396491e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9435
    reference variance = 0.18736
====================================================
  Execution time = 2.1612e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3317e-01
  Total weights = 1.9518e+06
  Execution time = 1.8919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000315833
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321828944706
                                         uncertainty =       0.003282079225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321828944706
                                         uncertainty =       0.003282079225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401145123
  error estimate for blocks of size 2^( 2) =       0.000414120480
  error estimate for blocks of size 2^( 3) =       0.000427679124
  error estimate for blocks of size 2^( 4) =       0.000439597419
  error estimate for blocks of size 2^( 5) =       0.000451026586
  error estimate for blocks of size 2^( 6) =       0.000459146239
  error estimate for blocks of size 2^( 7) =       0.000461908322

      target function =                  N/A
              le_mean =     -16.906479135252
             les_mean =     286.164347979469
             stat err =       0.000452919642
             autocorr =       1.274791848825
              std dev =       0.567304872833
             le_variance =       0.321834818740

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000244748
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321663177419
                                         uncertainty =       0.003241139728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321663177419
                                         uncertainty =       0.003241139728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401040621
  error estimate for blocks of size 2^( 2) =       0.000414002196
  error estimate for blocks of size 2^( 3) =       0.000427570824
  error estimate for blocks of size 2^( 4) =       0.000439491186
  error estimate for blocks of size 2^( 5) =       0.000450920327
  error estimate for blocks of size 2^( 6) =       0.000458999539
  error estimate for blocks of size 2^( 7) =       0.000461780781

      target function =                  N/A
              le_mean =     -16.906495711150
             les_mean =     286.169440580163
             stat err =       0.000452797958
             autocorr =       1.274771046601
              std dev =       0.567157085561
             le_variance =       0.321667159702

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000317331
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329157140982
                                         uncertainty =       0.008133026904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329157140982
                                         uncertainty =       0.008133026904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405683941
  error estimate for blocks of size 2^( 2) =       0.000418481326
  error estimate for blocks of size 2^( 3) =       0.000431904681
  error estimate for blocks of size 2^( 4) =       0.000443691811
  error estimate for blocks of size 2^( 5) =       0.000454987853
  error estimate for blocks of size 2^( 6) =       0.000462781344
  error estimate for blocks of size 2^( 7) =       0.000465374077

      target function =                  N/A
              le_mean =     -16.906429911312
             les_mean =     290.120411123698
             stat err =       0.000456708771
             autocorr =       1.267368974362
              std dev =       0.573723731860
             le_variance =       0.329158920499

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000855273
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321781327264
                                         uncertainty =       0.003274285768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321781327264
                                         uncertainty =       0.003274285768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401115280
  error estimate for blocks of size 2^( 2) =       0.000414088484
  error estimate for blocks of size 2^( 3) =       0.000427647465
  error estimate for blocks of size 2^( 4) =       0.000439570613
  error estimate for blocks of size 2^( 5) =       0.000450993214
  error estimate for blocks of size 2^( 6) =       0.000459110281
  error estimate for blocks of size 2^( 7) =       0.000461881300

      target function =                  N/A
              le_mean =     -16.906479667364
             les_mean =     286.167119182369
             stat err =       0.000452888852
             autocorr =       1.274808198747
              std dev =       0.567262669649
             le_variance =       0.321786936378


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906479135252        initial
     9.7656e-02     9.7656e-01             2.4354e-03       -16.906495711150  <--
     3.9062e-01     3.9062e+00             6.7692e-04       -16.906429911312
     1.5625e+00     1.5625e+01             1.9445e-04       -16.906479667364

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 3.1183e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
   uu_0                 3.122101e-01 1 1  ON 0
   uu_1                 1.450553e-01 1 1  ON 1
   uu_2                 4.300989e-02 1 1  ON 2
   uu_3                -1.957470e-02 1 1  ON 3
   uu_4                -6.481338e-02 1 1  ON 4
   uu_5                -9.966643e-02 1 1  ON 5
   uu_6                -1.272184e-01 1 1  ON 6
   uu_7                -1.406241e-01 1 1  ON 7
   uu_8                -1.328959e-01 1 1  ON 8
   uu_9                -1.017498e-01 1 1  ON 9
   ud_0                 4.467865e-01 1 1  ON 10
   ud_1                 1.810043e-01 1 1  ON 11
   ud_2                 6.078373e-02 1 1  ON 12
   ud_3                -1.004838e-02 1 1  ON 13
   ud_4                -6.704505e-02 1 1  ON 14
   ud_5                -1.083131e-01 1 1  ON 15
   ud_6                -1.350428e-01 1 1  ON 16
   ud_7                -1.513991e-01 1 1  ON 17
   ud_8                -1.516143e-01 1 1  ON 18
   ud_9                -1.391005e-01 1 1  ON 19
   eO_0                -7.490927e-01 1 1  ON 20
   eO_1                -4.289988e-01 1 1  ON 21
   eO_2                -1.956304e-02 1 1  ON 22
   eO_3                 2.911285e-01 1 1  ON 23
   eO_4                 5.149171e-01 1 1  ON 24
   eO_5                 4.753958e-01 1 1  ON 25
   eO_6                 2.489241e-01 1 1  ON 26
   eO_7                -4.719733e-02 1 1  ON 27
   eO_8                -2.132018e-01 1 1  ON 28
   eO_9                -7.316350e-02 1 1  ON 29
  eH1_0                -2.513449e-01 1 1  ON 30
  eH1_1                -1.444627e-01 1 1  ON 31
  eH1_2                -9.415268e-02 1 1  ON 32
  eH1_3                -3.938533e-02 1 1  ON 33
  eH1_4                 1.010230e-02 1 1  ON 34
  eH1_5                 4.450226e-02 1 1  ON 35
  eH1_6                 1.010395e-01 1 1  ON 36
  eH1_7                 1.529045e-01 1 1  ON 37
  eH1_8                 1.696442e-01 1 1  ON 38
  eH1_9                 5.479730e-02 1 1  ON 39
  eH2_0                -2.490202e-01 1 1  ON 40
  eH2_1                -1.412860e-01 1 1  ON 41
  eH2_2                -9.114349e-02 1 1  ON 42
  eH2_3                -3.611839e-02 1 1  ON 43
  eH2_4                 1.337938e-02 1 1  ON 44
  eH2_5                 4.803246e-02 1 1  ON 45
  eH2_6                 1.041464e-01 1 1  ON 46
  eH2_7                 1.542842e-01 1 1  ON 47
  eH2_8                 1.735701e-01 1 1  ON 48
  eH2_9                 4.111260e-02 1 1  ON 49
ci_0001                 7.016294e-01 3 1  ON 50
ci_0002                 7.000985e-01 3 1  ON 51
ci_0003                -2.714114e-02 3 1  ON 52
ci_0004                -2.707385e-02 3 1  ON 53
ci_0005                -3.646654e-02 3 1  ON 54
ci_0006                -3.742569e-02 3 1  ON 55
ci_0007                -2.012398e-02 3 1  ON 56
ci_0008                -2.169594e-02 3 1  ON 57
ci_0009                -1.818727e-02 3 1  ON 58
ci_0010                -1.776289e-02 3 1  ON 59
ci_0011                -1.190824e-02 3 1  ON 60
ci_0012                -1.246760e-02 3 1  ON 61
ci_0013                 1.362184e-02 3 1  ON 62
ci_0014                 1.352359e-02 3 1  ON 63
ci_0015                 1.314933e-02 3 1  ON 64
ci_0016                 1.323053e-02 3 1  ON 65
ci_0017                 1.073648e-02 3 1  ON 66
ci_0018                 1.076992e-02 3 1  ON 67
ci_0019                 1.191486e-02 3 1  ON 68
ci_0020                 1.128937e-02 3 1  ON 69
ci_0021                -1.703110e-03 3 1  ON 70
ci_0022                -7.684974e-04 3 1  ON 71
ci_0023                -1.099854e-02 3 1  ON 72
ci_0024                -1.065450e-02 3 1  ON 73
ci_0025                -1.049475e-02 3 1  ON 74
ci_0026                -1.052039e-02 3 1  ON 75
ci_0027                -1.150544e-02 3 1  ON 76
ci_0028                -1.127743e-02 3 1  ON 77
ci_0029                -1.111433e-02 3 1  ON 78
ci_0030                -1.027113e-02 3 1  ON 79
ci_0031                 1.948080e-02 3 1  ON 80
ci_0032                 2.027085e-02 3 1  ON 81
ci_0033                 1.087867e-02 3 1  ON 82
ci_0034                 9.868953e-03 3 1  ON 83
ci_0035                 7.099588e-03 3 1  ON 84
ci_0036                 7.262198e-03 3 1  ON 85
ci_0037                -1.072741e-02 3 1  ON 86
ci_0038                -1.112325e-02 3 1  ON 87
ci_0039                -2.618578e-03 3 1  ON 88
ci_0040                -2.626217e-03 3 1  ON 89
ci_0041                 6.705804e-03 3 1  ON 90
ci_0042                 7.985207e-03 3 1  ON 91
ci_0043                -1.873561e-02 3 1  ON 92
ci_0044                -1.968521e-02 3 1  ON 93
ci_0045                 8.160224e-03 3 1  ON 94
ci_0046                 7.541938e-03 3 1  ON 95
ci_0047                -1.594866e-03 3 1  ON 96
ci_0048                -1.856982e-03 3 1  ON 97
ci_0049                -5.773744e-03 3 1  ON 98
ci_0050                -5.136009e-03 3 1  ON 99
ci_0051                -3.264161e-03 3 1  ON 100
ci_0052                -3.172225e-03 3 1  ON 101
ci_0053                -4.497083e-03 3 1  ON 102
ci_0054                -4.396469e-03 3 1  ON 103
ci_0055                 5.832139e-03 3 1  ON 104
ci_0056                 6.344909e-03 3 1  ON 105
ci_0057                 4.811942e-03 3 1  ON 106
ci_0058                 4.592856e-03 3 1  ON 107
ci_0059                -5.065159e-03 3 1  ON 108
ci_0060                -4.645016e-03 3 1  ON 109
ci_0061                -4.186851e-03 3 1  ON 110
ci_0062                -3.503631e-03 3 1  ON 111
ci_0063                -8.553122e-03 3 1  ON 112
ci_0064                -8.484644e-03 3 1  ON 113
ci_0065                -5.453391e-03 3 1  ON 114
ci_0066                -5.654953e-03 3 1  ON 115
ci_0067                -5.000407e-03 3 1  ON 116
ci_0068                -5.094357e-03 3 1  ON 117
ci_0069                 4.731556e-03 3 1  ON 118
ci_0070                 4.166312e-03 3 1  ON 119
ci_0071                -5.756397e-05 3 1  ON 120
ci_0072                -4.677930e-04 3 1  ON 121
ci_0073                 4.384003e-03 3 1  ON 122
ci_0074                 4.450769e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9674e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6926e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8877
    reference variance = 0.166719
====================================================
  Execution time = 2.1745e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3685e-01
  Total weights = 1.951781541e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1439e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324828076064
                                         uncertainty =       0.002750116607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324828076064
                                         uncertainty =       0.002750116607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402973835
  error estimate for blocks of size 2^( 2) =       0.000416219353
  error estimate for blocks of size 2^( 3) =       0.000429984863
  error estimate for blocks of size 2^( 4) =       0.000442697187
  error estimate for blocks of size 2^( 5) =       0.000455131414
  error estimate for blocks of size 2^( 6) =       0.000463722522
  error estimate for blocks of size 2^( 7) =       0.000468074671

      target function =                  N/A
              le_mean =     -16.906030787151
             les_mean =     286.150725505282
             stat err =       0.000457406448
             autocorr =       1.288400454334
              std dev =       0.569891062526
             le_variance =       0.324775823147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690603078715e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906030787155       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906043024616       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906041672336       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906048176973       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906048153829       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906047763053       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906051418623       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906052754399       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906052294137       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906051410712       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906054696864       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906058116134       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906056938742       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906057353708       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906058170209       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906058706940       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906059267408       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906060125884       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906059676497       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906060188009       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906060392251       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906059924379       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906060195316       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906060044668       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.906059884554       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906060103752       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e-02 is 9.803901e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906030787155       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906040024163       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906038743224       residual = 6.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906042163248       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906042004366       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043727011       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906044363625       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906045063458       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906044563242       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906045045397       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906045425887       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906045247882       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906044831985       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906044854513       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906044991997       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-02 is 2.384301e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906030787155       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906035450554       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906034732791       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906035640471       residual = 9.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906035716015       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906036497754       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906036410879       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906036598288       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906036426984       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906036611672       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906036577695       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-01 is 6.417452e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7922e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
   uu_0                 3.121978e-01 1 1  ON 0
   uu_1                 1.451145e-01 1 1  ON 1
   uu_2                 4.323060e-02 1 1  ON 2
   uu_3                -1.933289e-02 1 1  ON 3
   uu_4                -6.503735e-02 1 1  ON 4
   uu_5                -1.000925e-01 1 1  ON 5
   uu_6                -1.275630e-01 1 1  ON 6
   uu_7                -1.411287e-01 1 1  ON 7
   uu_8                -1.339405e-01 1 1  ON 8
   uu_9                -1.023974e-01 1 1  ON 9
   ud_0                 4.467265e-01 1 1  ON 10
   ud_1                 1.810756e-01 1 1  ON 11
   ud_2                 6.076714e-02 1 1  ON 12
   ud_3                -1.008043e-02 1 1  ON 13
   ud_4                -6.681241e-02 1 1  ON 14
   ud_5                -1.082452e-01 1 1  ON 15
   ud_6                -1.350469e-01 1 1  ON 16
   ud_7                -1.508555e-01 1 1  ON 17
   ud_8                -1.510705e-01 1 1  ON 18
   ud_9                -1.401989e-01 1 1  ON 19
   eO_0                -7.497002e-01 1 1  ON 20
   eO_1                -4.292473e-01 1 1  ON 21
   eO_2                -1.981744e-02 1 1  ON 22
   eO_3                 2.911667e-01 1 1  ON 23
   eO_4                 5.151285e-01 1 1  ON 24
   eO_5                 4.766716e-01 1 1  ON 25
   eO_6                 2.500132e-01 1 1  ON 26
   eO_7                -4.639209e-02 1 1  ON 27
   eO_8                -2.141113e-01 1 1  ON 28
   eO_9                -7.446938e-02 1 1  ON 29
  eH1_0                -2.520571e-01 1 1  ON 30
  eH1_1                -1.455731e-01 1 1  ON 31
  eH1_2                -9.553778e-02 1 1  ON 32
  eH1_3                -4.012488e-02 1 1  ON 33
  eH1_4                 8.945577e-03 1 1  ON 34
  eH1_5                 4.370319e-02 1 1  ON 35
  eH1_6                 1.011366e-01 1 1  ON 36
  eH1_7                 1.543232e-01 1 1  ON 37
  eH1_8                 1.715110e-01 1 1  ON 38
  eH1_9                 5.694391e-02 1 1  ON 39
  eH2_0                -2.497181e-01 1 1  ON 40
  eH2_1                -1.421979e-01 1 1  ON 41
  eH2_2                -9.239530e-02 1 1  ON 42
  eH2_3                -3.688510e-02 1 1  ON 43
  eH2_4                 1.253002e-02 1 1  ON 44
  eH2_5                 4.752327e-02 1 1  ON 45
  eH2_6                 1.042797e-01 1 1  ON 46
  eH2_7                 1.546442e-01 1 1  ON 47
  eH2_8                 1.751108e-01 1 1  ON 48
  eH2_9                 4.349690e-02 1 1  ON 49
ci_0001                 7.012400e-01 3 1  ON 50
ci_0002                 7.005174e-01 3 1  ON 51
ci_0003                -2.731553e-02 3 1  ON 52
ci_0004                -2.714404e-02 3 1  ON 53
ci_0005                -3.619701e-02 3 1  ON 54
ci_0006                -3.634898e-02 3 1  ON 55
ci_0007                -2.124772e-02 3 1  ON 56
ci_0008                -2.151420e-02 3 1  ON 57
ci_0009                -1.739974e-02 3 1  ON 58
ci_0010                -1.722001e-02 3 1  ON 59
ci_0011                -1.137249e-02 3 1  ON 60
ci_0012                -1.253270e-02 3 1  ON 61
ci_0013                 1.294260e-02 3 1  ON 62
ci_0014                 1.387634e-02 3 1  ON 63
ci_0015                 1.319510e-02 3 1  ON 64
ci_0016                 1.315079e-02 3 1  ON 65
ci_0017                 1.155058e-02 3 1  ON 66
ci_0018                 1.075815e-02 3 1  ON 67
ci_0019                 1.239450e-02 3 1  ON 68
ci_0020                 1.100780e-02 3 1  ON 69
ci_0021                -1.603954e-03 3 1  ON 70
ci_0022                -8.056795e-04 3 1  ON 71
ci_0023                -1.064865e-02 3 1  ON 72
ci_0024                -1.028563e-02 3 1  ON 73
ci_0025                -1.091438e-02 3 1  ON 74
ci_0026                -1.090066e-02 3 1  ON 75
ci_0027                -1.159323e-02 3 1  ON 76
ci_0028                -1.176417e-02 3 1  ON 77
ci_0029                -1.082271e-02 3 1  ON 78
ci_0030                -1.043011e-02 3 1  ON 79
ci_0031                 2.059946e-02 3 1  ON 80
ci_0032                 2.123148e-02 3 1  ON 81
ci_0033                 1.042008e-02 3 1  ON 82
ci_0034                 1.000448e-02 3 1  ON 83
ci_0035                 7.417045e-03 3 1  ON 84
ci_0036                 7.362055e-03 3 1  ON 85
ci_0037                -1.001400e-02 3 1  ON 86
ci_0038                -1.115616e-02 3 1  ON 87
ci_0039                -2.521356e-03 3 1  ON 88
ci_0040                -2.647168e-03 3 1  ON 89
ci_0041                 6.475331e-03 3 1  ON 90
ci_0042                 7.368064e-03 3 1  ON 91
ci_0043                -1.841719e-02 3 1  ON 92
ci_0044                -1.923865e-02 3 1  ON 93
ci_0045                 7.843598e-03 3 1  ON 94
ci_0046                 8.974675e-03 3 1  ON 95
ci_0047                -1.857462e-03 3 1  ON 96
ci_0048                -1.940890e-03 3 1  ON 97
ci_0049                -5.950106e-03 3 1  ON 98
ci_0050                -5.904002e-03 3 1  ON 99
ci_0051                -3.224067e-03 3 1  ON 100
ci_0052                -3.549789e-03 3 1  ON 101
ci_0053                -4.387632e-03 3 1  ON 102
ci_0054                -4.867848e-03 3 1  ON 103
ci_0055                 5.560551e-03 3 1  ON 104
ci_0056                 6.431895e-03 3 1  ON 105
ci_0057                 4.285269e-03 3 1  ON 106
ci_0058                 5.333245e-03 3 1  ON 107
ci_0059                -4.846861e-03 3 1  ON 108
ci_0060                -4.357972e-03 3 1  ON 109
ci_0061                -4.790238e-03 3 1  ON 110
ci_0062                -3.922145e-03 3 1  ON 111
ci_0063                -8.049717e-03 3 1  ON 112
ci_0064                -8.986858e-03 3 1  ON 113
ci_0065                -5.322693e-03 3 1  ON 114
ci_0066                -5.304741e-03 3 1  ON 115
ci_0067                -4.557885e-03 3 1  ON 116
ci_0068                -5.074442e-03 3 1  ON 117
ci_0069                 4.773779e-03 3 1  ON 118
ci_0070                 4.325290e-03 3 1  ON 119
ci_0071                 5.783908e-04 3 1  ON 120
ci_0072                -5.433553e-04 3 1  ON 121
ci_0073                 4.093453e-03 3 1  ON 122
ci_0074                 4.109101e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.883
    reference variance = 0.49942
====================================================
  Execution time = 2.1772e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3450e-01
  Total weights = 1.9518e+06
  Execution time = 1.8878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320986801168
                                         uncertainty =       0.001820204716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320986801168
                                         uncertainty =       0.001820204716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400638401
  error estimate for blocks of size 2^( 2) =       0.000413659983
  error estimate for blocks of size 2^( 3) =       0.000426220429
  error estimate for blocks of size 2^( 4) =       0.000438928093
  error estimate for blocks of size 2^( 5) =       0.000450129315
  error estimate for blocks of size 2^( 6) =       0.000457955995
  error estimate for blocks of size 2^( 7) =       0.000463405369

      target function =                  N/A
              le_mean =     -16.906343850842
             les_mean =     286.181962728605
             stat err =       0.000452604693
             autocorr =       1.276241780994
              std dev =       0.566588260034
             le_variance =       0.321022256409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321730316253
                                         uncertainty =       0.001830692649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321730316253
                                         uncertainty =       0.001830692649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401104245
  error estimate for blocks of size 2^( 2) =       0.000414117178
  error estimate for blocks of size 2^( 3) =       0.000426650565
  error estimate for blocks of size 2^( 4) =       0.000439339460
  error estimate for blocks of size 2^( 5) =       0.000450509906
  error estimate for blocks of size 2^( 6) =       0.000458266662
  error estimate for blocks of size 2^( 7) =       0.000463664357

      target function =                  N/A
              le_mean =     -16.906323097449
             les_mean =     286.162047523245
             stat err =       0.000452945096
             autocorr =       1.275195016610
              std dev =       0.567247063745
             le_variance =       0.321769231328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322088277269
                                         uncertainty =       0.001832776049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322088277269
                                         uncertainty =       0.001832776049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401328213
  error estimate for blocks of size 2^( 2) =       0.000414338163
  error estimate for blocks of size 2^( 3) =       0.000426887618
  error estimate for blocks of size 2^( 4) =       0.000439590351
  error estimate for blocks of size 2^( 5) =       0.000450769341
  error estimate for blocks of size 2^( 6) =       0.000458540678
  error estimate for blocks of size 2^( 7) =       0.000463871242

      target function =                  N/A
              le_mean =     -16.906350401509
             les_mean =     286.165757125941
             stat err =       0.000453192903
             autocorr =       1.275166273596
              std dev =       0.567563801674
             le_variance =       0.322128668971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321000194902
                                         uncertainty =       0.001822774707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321000194902
                                         uncertainty =       0.001822774707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400647627
  error estimate for blocks of size 2^( 2) =       0.000413672184
  error estimate for blocks of size 2^( 3) =       0.000426235965
  error estimate for blocks of size 2^( 4) =       0.000438945788
  error estimate for blocks of size 2^( 5) =       0.000450130562
  error estimate for blocks of size 2^( 6) =       0.000457935523
  error estimate for blocks of size 2^( 7) =       0.000463378265

      target function =                  N/A
              le_mean =     -16.906325938367
             les_mean =     286.162571811803
             stat err =       0.000452597534
             autocorr =       1.276142634483
              std dev =       0.566601307440
             le_variance =       0.321037041593


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906343850842        initial
     2.4414e-02     2.4414e-01             9.8039e-03       -16.906323097449
     9.7656e-02     9.7656e-01             2.3843e-03       -16.906350401509  <--
     3.9062e-01     3.9062e+00             6.4175e-04       -16.906325938367

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 3.1301e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
   uu_0                 3.121978e-01 1 1  ON 0
   uu_1                 1.451145e-01 1 1  ON 1
   uu_2                 4.323060e-02 1 1  ON 2
   uu_3                -1.933289e-02 1 1  ON 3
   uu_4                -6.503735e-02 1 1  ON 4
   uu_5                -1.000925e-01 1 1  ON 5
   uu_6                -1.275630e-01 1 1  ON 6
   uu_7                -1.411287e-01 1 1  ON 7
   uu_8                -1.339405e-01 1 1  ON 8
   uu_9                -1.023974e-01 1 1  ON 9
   ud_0                 4.467265e-01 1 1  ON 10
   ud_1                 1.810756e-01 1 1  ON 11
   ud_2                 6.076714e-02 1 1  ON 12
   ud_3                -1.008043e-02 1 1  ON 13
   ud_4                -6.681241e-02 1 1  ON 14
   ud_5                -1.082452e-01 1 1  ON 15
   ud_6                -1.350469e-01 1 1  ON 16
   ud_7                -1.508555e-01 1 1  ON 17
   ud_8                -1.510705e-01 1 1  ON 18
   ud_9                -1.401989e-01 1 1  ON 19
   eO_0                -7.497002e-01 1 1  ON 20
   eO_1                -4.292473e-01 1 1  ON 21
   eO_2                -1.981744e-02 1 1  ON 22
   eO_3                 2.911667e-01 1 1  ON 23
   eO_4                 5.151285e-01 1 1  ON 24
   eO_5                 4.766716e-01 1 1  ON 25
   eO_6                 2.500132e-01 1 1  ON 26
   eO_7                -4.639209e-02 1 1  ON 27
   eO_8                -2.141113e-01 1 1  ON 28
   eO_9                -7.446938e-02 1 1  ON 29
  eH1_0                -2.520571e-01 1 1  ON 30
  eH1_1                -1.455731e-01 1 1  ON 31
  eH1_2                -9.553778e-02 1 1  ON 32
  eH1_3                -4.012488e-02 1 1  ON 33
  eH1_4                 8.945577e-03 1 1  ON 34
  eH1_5                 4.370319e-02 1 1  ON 35
  eH1_6                 1.011366e-01 1 1  ON 36
  eH1_7                 1.543232e-01 1 1  ON 37
  eH1_8                 1.715110e-01 1 1  ON 38
  eH1_9                 5.694391e-02 1 1  ON 39
  eH2_0                -2.497181e-01 1 1  ON 40
  eH2_1                -1.421979e-01 1 1  ON 41
  eH2_2                -9.239530e-02 1 1  ON 42
  eH2_3                -3.688510e-02 1 1  ON 43
  eH2_4                 1.253002e-02 1 1  ON 44
  eH2_5                 4.752327e-02 1 1  ON 45
  eH2_6                 1.042797e-01 1 1  ON 46
  eH2_7                 1.546442e-01 1 1  ON 47
  eH2_8                 1.751108e-01 1 1  ON 48
  eH2_9                 4.349690e-02 1 1  ON 49
ci_0001                 7.012400e-01 3 1  ON 50
ci_0002                 7.005174e-01 3 1  ON 51
ci_0003                -2.731553e-02 3 1  ON 52
ci_0004                -2.714404e-02 3 1  ON 53
ci_0005                -3.619701e-02 3 1  ON 54
ci_0006                -3.634898e-02 3 1  ON 55
ci_0007                -2.124772e-02 3 1  ON 56
ci_0008                -2.151420e-02 3 1  ON 57
ci_0009                -1.739974e-02 3 1  ON 58
ci_0010                -1.722001e-02 3 1  ON 59
ci_0011                -1.137249e-02 3 1  ON 60
ci_0012                -1.253270e-02 3 1  ON 61
ci_0013                 1.294260e-02 3 1  ON 62
ci_0014                 1.387634e-02 3 1  ON 63
ci_0015                 1.319510e-02 3 1  ON 64
ci_0016                 1.315079e-02 3 1  ON 65
ci_0017                 1.155058e-02 3 1  ON 66
ci_0018                 1.075815e-02 3 1  ON 67
ci_0019                 1.239450e-02 3 1  ON 68
ci_0020                 1.100780e-02 3 1  ON 69
ci_0021                -1.603954e-03 3 1  ON 70
ci_0022                -8.056795e-04 3 1  ON 71
ci_0023                -1.064865e-02 3 1  ON 72
ci_0024                -1.028563e-02 3 1  ON 73
ci_0025                -1.091438e-02 3 1  ON 74
ci_0026                -1.090066e-02 3 1  ON 75
ci_0027                -1.159323e-02 3 1  ON 76
ci_0028                -1.176417e-02 3 1  ON 77
ci_0029                -1.082271e-02 3 1  ON 78
ci_0030                -1.043011e-02 3 1  ON 79
ci_0031                 2.059946e-02 3 1  ON 80
ci_0032                 2.123148e-02 3 1  ON 81
ci_0033                 1.042008e-02 3 1  ON 82
ci_0034                 1.000448e-02 3 1  ON 83
ci_0035                 7.417045e-03 3 1  ON 84
ci_0036                 7.362055e-03 3 1  ON 85
ci_0037                -1.001400e-02 3 1  ON 86
ci_0038                -1.115616e-02 3 1  ON 87
ci_0039                -2.521356e-03 3 1  ON 88
ci_0040                -2.647168e-03 3 1  ON 89
ci_0041                 6.475331e-03 3 1  ON 90
ci_0042                 7.368064e-03 3 1  ON 91
ci_0043                -1.841719e-02 3 1  ON 92
ci_0044                -1.923865e-02 3 1  ON 93
ci_0045                 7.843598e-03 3 1  ON 94
ci_0046                 8.974675e-03 3 1  ON 95
ci_0047                -1.857462e-03 3 1  ON 96
ci_0048                -1.940890e-03 3 1  ON 97
ci_0049                -5.950106e-03 3 1  ON 98
ci_0050                -5.904002e-03 3 1  ON 99
ci_0051                -3.224067e-03 3 1  ON 100
ci_0052                -3.549789e-03 3 1  ON 101
ci_0053                -4.387632e-03 3 1  ON 102
ci_0054                -4.867848e-03 3 1  ON 103
ci_0055                 5.560551e-03 3 1  ON 104
ci_0056                 6.431895e-03 3 1  ON 105
ci_0057                 4.285269e-03 3 1  ON 106
ci_0058                 5.333245e-03 3 1  ON 107
ci_0059                -4.846861e-03 3 1  ON 108
ci_0060                -4.357972e-03 3 1  ON 109
ci_0061                -4.790238e-03 3 1  ON 110
ci_0062                -3.922145e-03 3 1  ON 111
ci_0063                -8.049717e-03 3 1  ON 112
ci_0064                -8.986858e-03 3 1  ON 113
ci_0065                -5.322693e-03 3 1  ON 114
ci_0066                -5.304741e-03 3 1  ON 115
ci_0067                -4.557885e-03 3 1  ON 116
ci_0068                -5.074442e-03 3 1  ON 117
ci_0069                 4.773779e-03 3 1  ON 118
ci_0070                 4.325290e-03 3 1  ON 119
ci_0071                 5.783908e-04 3 1  ON 120
ci_0072                -5.433553e-04 3 1  ON 121
ci_0073                 4.093453e-03 3 1  ON 122
ci_0074                 4.109101e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9208
    reference variance = 0.248815
====================================================
  Execution time = 2.1473e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3799e-01
  Total weights = 1.951835261e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324161645420
                                         uncertainty =       0.002875871914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324161645420
                                         uncertainty =       0.002875871914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402556221
  error estimate for blocks of size 2^( 2) =       0.000415544765
  error estimate for blocks of size 2^( 3) =       0.000428807327
  error estimate for blocks of size 2^( 4) =       0.000440977559
  error estimate for blocks of size 2^( 5) =       0.000451508086
  error estimate for blocks of size 2^( 6) =       0.000460123322
  error estimate for blocks of size 2^( 7) =       0.000464060498

      target function =                  N/A
              le_mean =     -16.905641304294
             les_mean =     286.138695024445
             stat err =       0.000454167366
             autocorr =       1.272854508312
              std dev =       0.569300467595
             le_variance =       0.324103022404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564130429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905641304259       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905655598223       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905671299187       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905679514354       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905680913720       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905677875825       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905680860829       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905680736126       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905680251406       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905680274421       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905682022146       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905682226422       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905682719373       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905683520933       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905684524999       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.905683903087       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905684413353       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.905684437349       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905685813928       residual = 6.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.905686585596       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.905686395848       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.905686402884       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905685805718       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.905685757627       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905685497698       residual = 9.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e-02 is 9.137251e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905641304259       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905652982502       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905663317867       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905667145457       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905668678465       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905666460837       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905668742968       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905668843764       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905668132787       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905667923336       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905668334631       residual = 9.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905668474288       residual = 6.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905668718818       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905668687293       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905668660637       residual = 9.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-02 is 2.615452e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905641304259       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905648046970       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905651807420       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905652497013       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905653612228       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905652537905       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905653296901       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905653538850       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905653171590       residual = 8.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905653016181       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905653219958       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905653256739       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e-01 is 1.375735e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259987 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7574e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
   uu_0                 3.126446e-01 1 1  ON 0
   uu_1                 1.453689e-01 1 1  ON 1
   uu_2                 4.351428e-02 1 1  ON 2
   uu_3                -1.902352e-02 1 1  ON 3
   uu_4                -6.487640e-02 1 1  ON 4
   uu_5                -1.004313e-01 1 1  ON 5
   uu_6                -1.284453e-01 1 1  ON 6
   uu_7                -1.422495e-01 1 1  ON 7
   uu_8                -1.347465e-01 1 1  ON 8
   uu_9                -1.030278e-01 1 1  ON 9
   ud_0                 4.473275e-01 1 1  ON 10
   ud_1                 1.814973e-01 1 1  ON 11
   ud_2                 6.103176e-02 1 1  ON 12
   ud_3                -9.978849e-03 1 1  ON 13
   ud_4                -6.701128e-02 1 1  ON 14
   ud_5                -1.081021e-01 1 1  ON 15
   ud_6                -1.351712e-01 1 1  ON 16
   ud_7                -1.507853e-01 1 1  ON 17
   ud_8                -1.515636e-01 1 1  ON 18
   ud_9                -1.403540e-01 1 1  ON 19
   eO_0                -7.501160e-01 1 1  ON 20
   eO_1                -4.297441e-01 1 1  ON 21
   eO_2                -1.964900e-02 1 1  ON 22
   eO_3                 2.918713e-01 1 1  ON 23
   eO_4                 5.156549e-01 1 1  ON 24
   eO_5                 4.774879e-01 1 1  ON 25
   eO_6                 2.510738e-01 1 1  ON 26
   eO_7                -4.627313e-02 1 1  ON 27
   eO_8                -2.151579e-01 1 1  ON 28
   eO_9                -7.568547e-02 1 1  ON 29
  eH1_0                -2.533625e-01 1 1  ON 30
  eH1_1                -1.460326e-01 1 1  ON 31
  eH1_2                -9.605867e-02 1 1  ON 32
  eH1_3                -4.105996e-02 1 1  ON 33
  eH1_4                 8.439906e-03 1 1  ON 34
  eH1_5                 4.368607e-02 1 1  ON 35
  eH1_6                 1.015666e-01 1 1  ON 36
  eH1_7                 1.544517e-01 1 1  ON 37
  eH1_8                 1.726812e-01 1 1  ON 38
  eH1_9                 5.876374e-02 1 1  ON 39
  eH2_0                -2.508645e-01 1 1  ON 40
  eH2_1                -1.433555e-01 1 1  ON 41
  eH2_2                -9.349089e-02 1 1  ON 42
  eH2_3                -3.815243e-02 1 1  ON 43
  eH2_4                 1.177960e-02 1 1  ON 44
  eH2_5                 4.698533e-02 1 1  ON 45
  eH2_6                 1.050075e-01 1 1  ON 46
  eH2_7                 1.559715e-01 1 1  ON 47
  eH2_8                 1.765055e-01 1 1  ON 48
  eH2_9                 4.571159e-02 1 1  ON 49
ci_0001                 7.011843e-01 3 1  ON 50
ci_0002                 7.007558e-01 3 1  ON 51
ci_0003                -2.669469e-02 3 1  ON 52
ci_0004                -2.704283e-02 3 1  ON 53
ci_0005                -3.614233e-02 3 1  ON 54
ci_0006                -3.616296e-02 3 1  ON 55
ci_0007                -2.037545e-02 3 1  ON 56
ci_0008                -2.180145e-02 3 1  ON 57
ci_0009                -1.771045e-02 3 1  ON 58
ci_0010                -1.697530e-02 3 1  ON 59
ci_0011                -1.133165e-02 3 1  ON 60
ci_0012                -1.185114e-02 3 1  ON 61
ci_0013                 1.362389e-02 3 1  ON 62
ci_0014                 1.320397e-02 3 1  ON 63
ci_0015                 1.329923e-02 3 1  ON 64
ci_0016                 1.320566e-02 3 1  ON 65
ci_0017                 1.061869e-02 3 1  ON 66
ci_0018                 1.096287e-02 3 1  ON 67
ci_0019                 1.209552e-02 3 1  ON 68
ci_0020                 1.119761e-02 3 1  ON 69
ci_0021                -2.778342e-03 3 1  ON 70
ci_0022                -1.754706e-03 3 1  ON 71
ci_0023                -1.092172e-02 3 1  ON 72
ci_0024                -1.053797e-02 3 1  ON 73
ci_0025                -1.046862e-02 3 1  ON 74
ci_0026                -1.125443e-02 3 1  ON 75
ci_0027                -1.146852e-02 3 1  ON 76
ci_0028                -1.149069e-02 3 1  ON 77
ci_0029                -1.050740e-02 3 1  ON 78
ci_0030                -1.011079e-02 3 1  ON 79
ci_0031                 2.079745e-02 3 1  ON 80
ci_0032                 2.093663e-02 3 1  ON 81
ci_0033                 9.975065e-03 3 1  ON 82
ci_0034                 1.052621e-02 3 1  ON 83
ci_0035                 6.604702e-03 3 1  ON 84
ci_0036                 4.746603e-03 3 1  ON 85
ci_0037                -1.093301e-02 3 1  ON 86
ci_0038                -1.089123e-02 3 1  ON 87
ci_0039                -3.000391e-03 3 1  ON 88
ci_0040                -2.949651e-03 3 1  ON 89
ci_0041                 7.393892e-03 3 1  ON 90
ci_0042                 7.043408e-03 3 1  ON 91
ci_0043                -1.830784e-02 3 1  ON 92
ci_0044                -1.835476e-02 3 1  ON 93
ci_0045                 7.063630e-03 3 1  ON 94
ci_0046                 7.939088e-03 3 1  ON 95
ci_0047                -1.301412e-03 3 1  ON 96
ci_0048                -1.284011e-03 3 1  ON 97
ci_0049                -3.986558e-03 3 1  ON 98
ci_0050                -6.205760e-03 3 1  ON 99
ci_0051                -2.494479e-03 3 1  ON 100
ci_0052                -3.367952e-03 3 1  ON 101
ci_0053                -4.973940e-03 3 1  ON 102
ci_0054                -4.785762e-03 3 1  ON 103
ci_0055                 4.935392e-03 3 1  ON 104
ci_0056                 6.302835e-03 3 1  ON 105
ci_0057                 5.293182e-03 3 1  ON 106
ci_0058                 5.288970e-03 3 1  ON 107
ci_0059                -3.520064e-03 3 1  ON 108
ci_0060                -4.454110e-03 3 1  ON 109
ci_0061                -4.842478e-03 3 1  ON 110
ci_0062                -3.815820e-03 3 1  ON 111
ci_0063                -8.039916e-03 3 1  ON 112
ci_0064                -8.539849e-03 3 1  ON 113
ci_0065                -4.898062e-03 3 1  ON 114
ci_0066                -6.098964e-03 3 1  ON 115
ci_0067                -4.238847e-03 3 1  ON 116
ci_0068                -5.277197e-03 3 1  ON 117
ci_0069                 4.408085e-03 3 1  ON 118
ci_0070                 4.923480e-03 3 1  ON 119
ci_0071                -7.774443e-05 3 1  ON 120
ci_0072                 1.014475e-03 3 1  ON 121
ci_0073                 4.631112e-03 3 1  ON 122
ci_0074                 4.879278e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8506
    reference variance = 0.300029
====================================================
  Execution time = 2.3604e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4324e-01
  Total weights = 1.9517e+06
  Execution time = 1.8876e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326166088487
                                         uncertainty =       0.003324248917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326166088487
                                         uncertainty =       0.003324248917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403821967
  error estimate for blocks of size 2^( 2) =       0.000416797062
  error estimate for blocks of size 2^( 3) =       0.000430227436
  error estimate for blocks of size 2^( 4) =       0.000443201009
  error estimate for blocks of size 2^( 5) =       0.000453717126
  error estimate for blocks of size 2^( 6) =       0.000461844246
  error estimate for blocks of size 2^( 7) =       0.000469477135

      target function =                  N/A
              le_mean =     -16.906499949406
             les_mean =     286.300250641930
             stat err =       0.000457059879
             autocorr =       1.281050710817
              std dev =       0.571090501823
             le_variance =       0.326144361272

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324406823199
                                         uncertainty =       0.002711956798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324406823199
                                         uncertainty =       0.002711956798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402735745
  error estimate for blocks of size 2^( 2) =       0.000415772245
  error estimate for blocks of size 2^( 3) =       0.000429278950
  error estimate for blocks of size 2^( 4) =       0.000442305293
  error estimate for blocks of size 2^( 5) =       0.000452851891
  error estimate for blocks of size 2^( 6) =       0.000461033735
  error estimate for blocks of size 2^( 7) =       0.000468601406

      target function =                  N/A
              le_mean =     -16.906452626778
             les_mean =     286.176816044913
             stat err =       0.000456198081
             autocorr =       1.283117874269
              std dev =       0.569554351987
             le_variance =       0.324392159867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325079576978
                                         uncertainty =       0.002741091980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325079576978
                                         uncertainty =       0.002741091980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403152691
  error estimate for blocks of size 2^( 2) =       0.000416208354
  error estimate for blocks of size 2^( 3) =       0.000429719532
  error estimate for blocks of size 2^( 4) =       0.000442783746
  error estimate for blocks of size 2^( 5) =       0.000453334589
  error estimate for blocks of size 2^( 6) =       0.000461521303
  error estimate for blocks of size 2^( 7) =       0.000469162824

      target function =                  N/A
              le_mean =     -16.906491493039
             les_mean =     286.202464475934
             stat err =       0.000456700615
             autocorr =       1.283287804901
              std dev =       0.570144003517
             le_variance =       0.325064184746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323982540657
                                         uncertainty =       0.002683942550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323982540657
                                         uncertainty =       0.002683942550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402472582
  error estimate for blocks of size 2^( 2) =       0.000415502455
  error estimate for blocks of size 2^( 3) =       0.000429004969
  error estimate for blocks of size 2^( 4) =       0.000442030889
  error estimate for blocks of size 2^( 5) =       0.000452600280
  error estimate for blocks of size 2^( 6) =       0.000460781334
  error estimate for blocks of size 2^( 7) =       0.000468345504

      target function =                  N/A
              le_mean =     -16.906470453097
             les_mean =     286.173293706721
             stat err =       0.000455939502
             autocorr =       1.283340327000
              std dev =       0.569182183754
             le_variance =       0.323968358303


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906499949406        initial  <--
     2.4414e-02     2.4414e-01             9.1373e-03       -16.906452626778
     9.7656e-02     9.7656e-01             2.6155e-03       -16.906491493039
     3.9062e-01     3.9062e+00             1.3757e-03       -16.906470453097

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.1192
  </log>
  <optVariables href="H2O.s010.opt.xml">
   uu_0                 3.121978e-01 1 1  ON 0
   uu_1                 1.451145e-01 1 1  ON 1
   uu_2                 4.323060e-02 1 1  ON 2
   uu_3                -1.933289e-02 1 1  ON 3
   uu_4                -6.503735e-02 1 1  ON 4
   uu_5                -1.000925e-01 1 1  ON 5
   uu_6                -1.275630e-01 1 1  ON 6
   uu_7                -1.411287e-01 1 1  ON 7
   uu_8                -1.339405e-01 1 1  ON 8
   uu_9                -1.023974e-01 1 1  ON 9
   ud_0                 4.467265e-01 1 1  ON 10
   ud_1                 1.810756e-01 1 1  ON 11
   ud_2                 6.076714e-02 1 1  ON 12
   ud_3                -1.008043e-02 1 1  ON 13
   ud_4                -6.681241e-02 1 1  ON 14
   ud_5                -1.082452e-01 1 1  ON 15
   ud_6                -1.350469e-01 1 1  ON 16
   ud_7                -1.508555e-01 1 1  ON 17
   ud_8                -1.510705e-01 1 1  ON 18
   ud_9                -1.401989e-01 1 1  ON 19
   eO_0                -7.497002e-01 1 1  ON 20
   eO_1                -4.292473e-01 1 1  ON 21
   eO_2                -1.981744e-02 1 1  ON 22
   eO_3                 2.911667e-01 1 1  ON 23
   eO_4                 5.151285e-01 1 1  ON 24
   eO_5                 4.766716e-01 1 1  ON 25
   eO_6                 2.500132e-01 1 1  ON 26
   eO_7                -4.639209e-02 1 1  ON 27
   eO_8                -2.141113e-01 1 1  ON 28
   eO_9                -7.446938e-02 1 1  ON 29
  eH1_0                -2.520571e-01 1 1  ON 30
  eH1_1                -1.455731e-01 1 1  ON 31
  eH1_2                -9.553778e-02 1 1  ON 32
  eH1_3                -4.012488e-02 1 1  ON 33
  eH1_4                 8.945577e-03 1 1  ON 34
  eH1_5                 4.370319e-02 1 1  ON 35
  eH1_6                 1.011366e-01 1 1  ON 36
  eH1_7                 1.543232e-01 1 1  ON 37
  eH1_8                 1.715110e-01 1 1  ON 38
  eH1_9                 5.694391e-02 1 1  ON 39
  eH2_0                -2.497181e-01 1 1  ON 40
  eH2_1                -1.421979e-01 1 1  ON 41
  eH2_2                -9.239530e-02 1 1  ON 42
  eH2_3                -3.688510e-02 1 1  ON 43
  eH2_4                 1.253002e-02 1 1  ON 44
  eH2_5                 4.752327e-02 1 1  ON 45
  eH2_6                 1.042797e-01 1 1  ON 46
  eH2_7                 1.546442e-01 1 1  ON 47
  eH2_8                 1.751108e-01 1 1  ON 48
  eH2_9                 4.349690e-02 1 1  ON 49
ci_0001                 7.012400e-01 3 1  ON 50
ci_0002                 7.005174e-01 3 1  ON 51
ci_0003                -2.731553e-02 3 1  ON 52
ci_0004                -2.714404e-02 3 1  ON 53
ci_0005                -3.619701e-02 3 1  ON 54
ci_0006                -3.634898e-02 3 1  ON 55
ci_0007                -2.124772e-02 3 1  ON 56
ci_0008                -2.151420e-02 3 1  ON 57
ci_0009                -1.739974e-02 3 1  ON 58
ci_0010                -1.722001e-02 3 1  ON 59
ci_0011                -1.137249e-02 3 1  ON 60
ci_0012                -1.253270e-02 3 1  ON 61
ci_0013                 1.294260e-02 3 1  ON 62
ci_0014                 1.387634e-02 3 1  ON 63
ci_0015                 1.319510e-02 3 1  ON 64
ci_0016                 1.315079e-02 3 1  ON 65
ci_0017                 1.155058e-02 3 1  ON 66
ci_0018                 1.075815e-02 3 1  ON 67
ci_0019                 1.239450e-02 3 1  ON 68
ci_0020                 1.100780e-02 3 1  ON 69
ci_0021                -1.603954e-03 3 1  ON 70
ci_0022                -8.056795e-04 3 1  ON 71
ci_0023                -1.064865e-02 3 1  ON 72
ci_0024                -1.028563e-02 3 1  ON 73
ci_0025                -1.091438e-02 3 1  ON 74
ci_0026                -1.090066e-02 3 1  ON 75
ci_0027                -1.159323e-02 3 1  ON 76
ci_0028                -1.176417e-02 3 1  ON 77
ci_0029                -1.082271e-02 3 1  ON 78
ci_0030                -1.043011e-02 3 1  ON 79
ci_0031                 2.059946e-02 3 1  ON 80
ci_0032                 2.123148e-02 3 1  ON 81
ci_0033                 1.042008e-02 3 1  ON 82
ci_0034                 1.000448e-02 3 1  ON 83
ci_0035                 7.417045e-03 3 1  ON 84
ci_0036                 7.362055e-03 3 1  ON 85
ci_0037                -1.001400e-02 3 1  ON 86
ci_0038                -1.115616e-02 3 1  ON 87
ci_0039                -2.521356e-03 3 1  ON 88
ci_0040                -2.647168e-03 3 1  ON 89
ci_0041                 6.475331e-03 3 1  ON 90
ci_0042                 7.368064e-03 3 1  ON 91
ci_0043                -1.841719e-02 3 1  ON 92
ci_0044                -1.923865e-02 3 1  ON 93
ci_0045                 7.843598e-03 3 1  ON 94
ci_0046                 8.974675e-03 3 1  ON 95
ci_0047                -1.857462e-03 3 1  ON 96
ci_0048                -1.940890e-03 3 1  ON 97
ci_0049                -5.950106e-03 3 1  ON 98
ci_0050                -5.904002e-03 3 1  ON 99
ci_0051                -3.224067e-03 3 1  ON 100
ci_0052                -3.549789e-03 3 1  ON 101
ci_0053                -4.387632e-03 3 1  ON 102
ci_0054                -4.867848e-03 3 1  ON 103
ci_0055                 5.560551e-03 3 1  ON 104
ci_0056                 6.431895e-03 3 1  ON 105
ci_0057                 4.285269e-03 3 1  ON 106
ci_0058                 5.333245e-03 3 1  ON 107
ci_0059                -4.846861e-03 3 1  ON 108
ci_0060                -4.357972e-03 3 1  ON 109
ci_0061                -4.790238e-03 3 1  ON 110
ci_0062                -3.922145e-03 3 1  ON 111
ci_0063                -8.049717e-03 3 1  ON 112
ci_0064                -8.986858e-03 3 1  ON 113
ci_0065                -5.322693e-03 3 1  ON 114
ci_0066                -5.304741e-03 3 1  ON 115
ci_0067                -4.557885e-03 3 1  ON 116
ci_0068                -5.074442e-03 3 1  ON 117
ci_0069                 4.773779e-03 3 1  ON 118
ci_0070                 4.325290e-03 3 1  ON 119
ci_0071                 5.783908e-04 3 1  ON 120
ci_0072                -5.433553e-04 3 1  ON 121
ci_0073                 4.093453e-03 3 1  ON 122
ci_0074                 4.109101e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0709e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9233
    reference variance = 0.177567
====================================================
  Execution time = 2.1654e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3550e-01
  Total weights = 1.951815233e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324141334312
                                         uncertainty =       0.002079629415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324141334312
                                         uncertainty =       0.002079629415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402496957
  error estimate for blocks of size 2^( 2) =       0.000415654191
  error estimate for blocks of size 2^( 3) =       0.000429129651
  error estimate for blocks of size 2^( 4) =       0.000441205495
  error estimate for blocks of size 2^( 5) =       0.000451223251
  error estimate for blocks of size 2^( 6) =       0.000460661372
  error estimate for blocks of size 2^( 7) =       0.000466740533

      target function =                  N/A
              le_mean =     -16.906786860228
             les_mean =     286.174939792684
             stat err =       0.000454957663
             autocorr =       1.277664316168
              std dev =       0.569216655343
             le_variance =       0.324007600720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690678686023e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906786860244       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906818476883       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906817969782       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906818111261       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906818917926       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906818285290       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906819239488       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906819679357       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906819894813       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906819534579       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906819471039       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906819457626       residual = 6.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e-01 is 1.089332e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906786860244       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906798869570       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906798815103       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906799036724       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906799368858       residual = 6.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906798720783       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906799248591       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906799338133       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906799380536       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906799350316       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e-01 is 4.119893e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906786860244       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906790310568       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906790319009       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906790407332       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906790525912       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906790289322       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906790420217       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906790481940       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906790482066       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906790481721       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+00 is 1.182308e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.264605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7795e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
   uu_0                 3.122691e-01 1 1  ON 0
   uu_1                 1.451752e-01 1 1  ON 1
   uu_2                 4.324872e-02 1 1  ON 2
   uu_3                -1.926965e-02 1 1  ON 3
   uu_4                -6.502593e-02 1 1  ON 4
   uu_5                -1.000727e-01 1 1  ON 5
   uu_6                -1.276060e-01 1 1  ON 6
   uu_7                -1.412160e-01 1 1  ON 7
   uu_8                -1.340933e-01 1 1  ON 8
   uu_9                -1.024960e-01 1 1  ON 9
   ud_0                 4.467957e-01 1 1  ON 10
   ud_1                 1.811023e-01 1 1  ON 11
   ud_2                 6.087776e-02 1 1  ON 12
   ud_3                -9.995711e-03 1 1  ON 13
   ud_4                -6.677769e-02 1 1  ON 14
   ud_5                -1.082203e-01 1 1  ON 15
   ud_6                -1.350485e-01 1 1  ON 16
   ud_7                -1.508927e-01 1 1  ON 17
   ud_8                -1.511752e-01 1 1  ON 18
   ud_9                -1.403473e-01 1 1  ON 19
   eO_0                -7.496810e-01 1 1  ON 20
   eO_1                -4.291602e-01 1 1  ON 21
   eO_2                -1.984355e-02 1 1  ON 22
   eO_3                 2.911362e-01 1 1  ON 23
   eO_4                 5.151325e-01 1 1  ON 24
   eO_5                 4.767969e-01 1 1  ON 25
   eO_6                 2.501125e-01 1 1  ON 26
   eO_7                -4.633740e-02 1 1  ON 27
   eO_8                -2.142830e-01 1 1  ON 28
   eO_9                -7.461511e-02 1 1  ON 29
  eH1_0                -2.522569e-01 1 1  ON 30
  eH1_1                -1.456034e-01 1 1  ON 31
  eH1_2                -9.548798e-02 1 1  ON 32
  eH1_3                -4.026062e-02 1 1  ON 33
  eH1_4                 8.980787e-03 1 1  ON 34
  eH1_5                 4.372820e-02 1 1  ON 35
  eH1_6                 1.011466e-01 1 1  ON 36
  eH1_7                 1.542764e-01 1 1  ON 37
  eH1_8                 1.715987e-01 1 1  ON 38
  eH1_9                 5.711590e-02 1 1  ON 39
  eH2_0                -2.497088e-01 1 1  ON 40
  eH2_1                -1.423016e-01 1 1  ON 41
  eH2_2                -9.243395e-02 1 1  ON 42
  eH2_3                -3.699517e-02 1 1  ON 43
  eH2_4                 1.245147e-02 1 1  ON 44
  eH2_5                 4.741727e-02 1 1  ON 45
  eH2_6                 1.041852e-01 1 1  ON 46
  eH2_7                 1.546671e-01 1 1  ON 47
  eH2_8                 1.753238e-01 1 1  ON 48
  eH2_9                 4.374659e-02 1 1  ON 49
ci_0001                 7.012454e-01 3 1  ON 50
ci_0002                 7.004971e-01 3 1  ON 51
ci_0003                -2.721259e-02 3 1  ON 52
ci_0004                -2.718053e-02 3 1  ON 53
ci_0005                -3.635305e-02 3 1  ON 54
ci_0006                -3.629792e-02 3 1  ON 55
ci_0007                -2.127596e-02 3 1  ON 56
ci_0008                -2.153428e-02 3 1  ON 57
ci_0009                -1.754063e-02 3 1  ON 58
ci_0010                -1.729962e-02 3 1  ON 59
ci_0011                -1.150252e-02 3 1  ON 60
ci_0012                -1.240026e-02 3 1  ON 61
ci_0013                 1.295233e-02 3 1  ON 62
ci_0014                 1.385403e-02 3 1  ON 63
ci_0015                 1.332497e-02 3 1  ON 64
ci_0016                 1.320190e-02 3 1  ON 65
ci_0017                 1.145064e-02 3 1  ON 66
ci_0018                 1.095369e-02 3 1  ON 67
ci_0019                 1.198251e-02 3 1  ON 68
ci_0020                 1.102960e-02 3 1  ON 69
ci_0021                -1.675165e-03 3 1  ON 70
ci_0022                -8.184728e-04 3 1  ON 71
ci_0023                -1.065261e-02 3 1  ON 72
ci_0024                -1.046509e-02 3 1  ON 73
ci_0025                -1.105339e-02 3 1  ON 74
ci_0026                -1.089201e-02 3 1  ON 75
ci_0027                -1.179456e-02 3 1  ON 76
ci_0028                -1.164554e-02 3 1  ON 77
ci_0029                -1.078810e-02 3 1  ON 78
ci_0030                -1.062949e-02 3 1  ON 79
ci_0031                 2.040336e-02 3 1  ON 80
ci_0032                 2.111352e-02 3 1  ON 81
ci_0033                 1.045135e-02 3 1  ON 82
ci_0034                 1.000566e-02 3 1  ON 83
ci_0035                 7.204441e-03 3 1  ON 84
ci_0036                 7.464772e-03 3 1  ON 85
ci_0037                -1.020155e-02 3 1  ON 86
ci_0038                -1.119228e-02 3 1  ON 87
ci_0039                -2.437948e-03 3 1  ON 88
ci_0040                -2.754541e-03 3 1  ON 89
ci_0041                 6.724016e-03 3 1  ON 90
ci_0042                 7.358956e-03 3 1  ON 91
ci_0043                -1.847483e-02 3 1  ON 92
ci_0044                -1.946425e-02 3 1  ON 93
ci_0045                 7.886147e-03 3 1  ON 94
ci_0046                 8.791566e-03 3 1  ON 95
ci_0047                -1.795514e-03 3 1  ON 96
ci_0048                -1.938279e-03 3 1  ON 97
ci_0049                -5.859282e-03 3 1  ON 98
ci_0050                -5.820922e-03 3 1  ON 99
ci_0051                -3.228261e-03 3 1  ON 100
ci_0052                -3.404386e-03 3 1  ON 101
ci_0053                -4.353768e-03 3 1  ON 102
ci_0054                -4.724545e-03 3 1  ON 103
ci_0055                 5.770654e-03 3 1  ON 104
ci_0056                 6.577595e-03 3 1  ON 105
ci_0057                 4.199290e-03 3 1  ON 106
ci_0058                 5.315597e-03 3 1  ON 107
ci_0059                -4.766614e-03 3 1  ON 108
ci_0060                -4.479245e-03 3 1  ON 109
ci_0061                -4.524591e-03 3 1  ON 110
ci_0062                -3.985677e-03 3 1  ON 111
ci_0063                -8.082663e-03 3 1  ON 112
ci_0064                -8.884495e-03 3 1  ON 113
ci_0065                -5.295791e-03 3 1  ON 114
ci_0066                -5.418876e-03 3 1  ON 115
ci_0067                -4.635002e-03 3 1  ON 116
ci_0068                -5.029190e-03 3 1  ON 117
ci_0069                 4.596039e-03 3 1  ON 118
ci_0070                 4.565305e-03 3 1  ON 119
ci_0071                 4.602446e-04 3 1  ON 120
ci_0072                -3.160310e-04 3 1  ON 121
ci_0073                 4.215070e-03 3 1  ON 122
ci_0074                 4.040698e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8453
    reference variance = 0.838233
====================================================
  Execution time = 2.1057e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3404e-01
  Total weights = 1.9515e+06
  Execution time = 1.8817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322761517446
                                         uncertainty =       0.002289803505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322761517446
                                         uncertainty =       0.002289803505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401739884
  error estimate for blocks of size 2^( 2) =       0.000414623824
  error estimate for blocks of size 2^( 3) =       0.000427833076
  error estimate for blocks of size 2^( 4) =       0.000440092710
  error estimate for blocks of size 2^( 5) =       0.000451387416
  error estimate for blocks of size 2^( 6) =       0.000459051777
  error estimate for blocks of size 2^( 7) =       0.000463176322

      target function =                  N/A
              le_mean =     -16.906814320488
             les_mean =     286.174742593060
             stat err =       0.000453427056
             autocorr =       1.273869569058
              std dev =       0.568145992393
             le_variance =       0.322789868673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322734471835
                                         uncertainty =       0.002282847662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322734471835
                                         uncertainty =       0.002282847662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401722916
  error estimate for blocks of size 2^( 2) =       0.000414601371
  error estimate for blocks of size 2^( 3) =       0.000427799931
  error estimate for blocks of size 2^( 4) =       0.000440073106
  error estimate for blocks of size 2^( 5) =       0.000451382208
  error estimate for blocks of size 2^( 6) =       0.000459018246
  error estimate for blocks of size 2^( 7) =       0.000463133738

      target function =                  N/A
              le_mean =     -16.906808374638
             les_mean =     286.174992499652
             stat err =       0.000453401825
             autocorr =       1.273835400874
              std dev =       0.568121996116
             le_variance =       0.322762602471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322715407332
                                         uncertainty =       0.002282854201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322715407332
                                         uncertainty =       0.002282854201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401711064
  error estimate for blocks of size 2^( 2) =       0.000414591749
  error estimate for blocks of size 2^( 3) =       0.000427795243
  error estimate for blocks of size 2^( 4) =       0.000440068181
  error estimate for blocks of size 2^( 5) =       0.000451375672
  error estimate for blocks of size 2^( 6) =       0.000459013936
  error estimate for blocks of size 2^( 7) =       0.000463131662

      target function =                  N/A
              le_mean =     -16.906805702369
             les_mean =     286.174613482000
             stat err =       0.000453397363
             autocorr =       1.273885493199
              std dev =       0.568105235196
             le_variance =       0.322743558257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745021880
                                         uncertainty =       0.002288543185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745021880
                                         uncertainty =       0.002288543185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401729605
  error estimate for blocks of size 2^( 2) =       0.000414612795
  error estimate for blocks of size 2^( 3) =       0.000427821751
  error estimate for blocks of size 2^( 4) =       0.000440083651
  error estimate for blocks of size 2^( 5) =       0.000451380585
  error estimate for blocks of size 2^( 6) =       0.000459041209
  error estimate for blocks of size 2^( 7) =       0.000463165881

      target function =                  N/A
              le_mean =     -16.906811783161
             les_mean =     286.177779969716
             stat err =       0.000453417831
             autocorr =       1.273882925797
              std dev =       0.568131455096
             le_variance =       0.322773350270


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906814320488        initial  <--
     2.4414e-01     2.4414e+00             1.0893e-03       -16.906808374638
     9.7656e-01     9.7656e+00             4.1199e-04       -16.906805702369
     3.9062e+00     3.9062e+01             1.1823e-04       -16.906811783161

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5583
  </log>
  <optVariables href="H2O.s011.opt.xml">
   uu_0                 3.121978e-01 1 1  ON 0
   uu_1                 1.451145e-01 1 1  ON 1
   uu_2                 4.323060e-02 1 1  ON 2
   uu_3                -1.933289e-02 1 1  ON 3
   uu_4                -6.503735e-02 1 1  ON 4
   uu_5                -1.000925e-01 1 1  ON 5
   uu_6                -1.275630e-01 1 1  ON 6
   uu_7                -1.411287e-01 1 1  ON 7
   uu_8                -1.339405e-01 1 1  ON 8
   uu_9                -1.023974e-01 1 1  ON 9
   ud_0                 4.467265e-01 1 1  ON 10
   ud_1                 1.810756e-01 1 1  ON 11
   ud_2                 6.076714e-02 1 1  ON 12
   ud_3                -1.008043e-02 1 1  ON 13
   ud_4                -6.681241e-02 1 1  ON 14
   ud_5                -1.082452e-01 1 1  ON 15
   ud_6                -1.350469e-01 1 1  ON 16
   ud_7                -1.508555e-01 1 1  ON 17
   ud_8                -1.510705e-01 1 1  ON 18
   ud_9                -1.401989e-01 1 1  ON 19
   eO_0                -7.497002e-01 1 1  ON 20
   eO_1                -4.292473e-01 1 1  ON 21
   eO_2                -1.981744e-02 1 1  ON 22
   eO_3                 2.911667e-01 1 1  ON 23
   eO_4                 5.151285e-01 1 1  ON 24
   eO_5                 4.766716e-01 1 1  ON 25
   eO_6                 2.500132e-01 1 1  ON 26
   eO_7                -4.639209e-02 1 1  ON 27
   eO_8                -2.141113e-01 1 1  ON 28
   eO_9                -7.446938e-02 1 1  ON 29
  eH1_0                -2.520571e-01 1 1  ON 30
  eH1_1                -1.455731e-01 1 1  ON 31
  eH1_2                -9.553778e-02 1 1  ON 32
  eH1_3                -4.012488e-02 1 1  ON 33
  eH1_4                 8.945577e-03 1 1  ON 34
  eH1_5                 4.370319e-02 1 1  ON 35
  eH1_6                 1.011366e-01 1 1  ON 36
  eH1_7                 1.543232e-01 1 1  ON 37
  eH1_8                 1.715110e-01 1 1  ON 38
  eH1_9                 5.694391e-02 1 1  ON 39
  eH2_0                -2.497181e-01 1 1  ON 40
  eH2_1                -1.421979e-01 1 1  ON 41
  eH2_2                -9.239530e-02 1 1  ON 42
  eH2_3                -3.688510e-02 1 1  ON 43
  eH2_4                 1.253002e-02 1 1  ON 44
  eH2_5                 4.752327e-02 1 1  ON 45
  eH2_6                 1.042797e-01 1 1  ON 46
  eH2_7                 1.546442e-01 1 1  ON 47
  eH2_8                 1.751108e-01 1 1  ON 48
  eH2_9                 4.349690e-02 1 1  ON 49
ci_0001                 7.012400e-01 3 1  ON 50
ci_0002                 7.005174e-01 3 1  ON 51
ci_0003                -2.731553e-02 3 1  ON 52
ci_0004                -2.714404e-02 3 1  ON 53
ci_0005                -3.619701e-02 3 1  ON 54
ci_0006                -3.634898e-02 3 1  ON 55
ci_0007                -2.124772e-02 3 1  ON 56
ci_0008                -2.151420e-02 3 1  ON 57
ci_0009                -1.739974e-02 3 1  ON 58
ci_0010                -1.722001e-02 3 1  ON 59
ci_0011                -1.137249e-02 3 1  ON 60
ci_0012                -1.253270e-02 3 1  ON 61
ci_0013                 1.294260e-02 3 1  ON 62
ci_0014                 1.387634e-02 3 1  ON 63
ci_0015                 1.319510e-02 3 1  ON 64
ci_0016                 1.315079e-02 3 1  ON 65
ci_0017                 1.155058e-02 3 1  ON 66
ci_0018                 1.075815e-02 3 1  ON 67
ci_0019                 1.239450e-02 3 1  ON 68
ci_0020                 1.100780e-02 3 1  ON 69
ci_0021                -1.603954e-03 3 1  ON 70
ci_0022                -8.056795e-04 3 1  ON 71
ci_0023                -1.064865e-02 3 1  ON 72
ci_0024                -1.028563e-02 3 1  ON 73
ci_0025                -1.091438e-02 3 1  ON 74
ci_0026                -1.090066e-02 3 1  ON 75
ci_0027                -1.159323e-02 3 1  ON 76
ci_0028                -1.176417e-02 3 1  ON 77
ci_0029                -1.082271e-02 3 1  ON 78
ci_0030                -1.043011e-02 3 1  ON 79
ci_0031                 2.059946e-02 3 1  ON 80
ci_0032                 2.123148e-02 3 1  ON 81
ci_0033                 1.042008e-02 3 1  ON 82
ci_0034                 1.000448e-02 3 1  ON 83
ci_0035                 7.417045e-03 3 1  ON 84
ci_0036                 7.362055e-03 3 1  ON 85
ci_0037                -1.001400e-02 3 1  ON 86
ci_0038                -1.115616e-02 3 1  ON 87
ci_0039                -2.521356e-03 3 1  ON 88
ci_0040                -2.647168e-03 3 1  ON 89
ci_0041                 6.475331e-03 3 1  ON 90
ci_0042                 7.368064e-03 3 1  ON 91
ci_0043                -1.841719e-02 3 1  ON 92
ci_0044                -1.923865e-02 3 1  ON 93
ci_0045                 7.843598e-03 3 1  ON 94
ci_0046                 8.974675e-03 3 1  ON 95
ci_0047                -1.857462e-03 3 1  ON 96
ci_0048                -1.940890e-03 3 1  ON 97
ci_0049                -5.950106e-03 3 1  ON 98
ci_0050                -5.904002e-03 3 1  ON 99
ci_0051                -3.224067e-03 3 1  ON 100
ci_0052                -3.549789e-03 3 1  ON 101
ci_0053                -4.387632e-03 3 1  ON 102
ci_0054                -4.867848e-03 3 1  ON 103
ci_0055                 5.560551e-03 3 1  ON 104
ci_0056                 6.431895e-03 3 1  ON 105
ci_0057                 4.285269e-03 3 1  ON 106
ci_0058                 5.333245e-03 3 1  ON 107
ci_0059                -4.846861e-03 3 1  ON 108
ci_0060                -4.357972e-03 3 1  ON 109
ci_0061                -4.790238e-03 3 1  ON 110
ci_0062                -3.922145e-03 3 1  ON 111
ci_0063                -8.049717e-03 3 1  ON 112
ci_0064                -8.986858e-03 3 1  ON 113
ci_0065                -5.322693e-03 3 1  ON 114
ci_0066                -5.304741e-03 3 1  ON 115
ci_0067                -4.557885e-03 3 1  ON 116
ci_0068                -5.074442e-03 3 1  ON 117
ci_0069                 4.773779e-03 3 1  ON 118
ci_0070                 4.325290e-03 3 1  ON 119
ci_0071                 5.783908e-04 3 1  ON 120
ci_0072                -5.433553e-04 3 1  ON 121
ci_0073                 4.093453e-03 3 1  ON 122
ci_0074                 4.109101e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8360e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9103
    reference variance = 0.322429
====================================================
  Execution time = 2.1614e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3383e-01
  Total weights = 1.951707254e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320828976433
                                         uncertainty =       0.002415501583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320828976433
                                         uncertainty =       0.002415501583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400511919
  error estimate for blocks of size 2^( 2) =       0.000413276210
  error estimate for blocks of size 2^( 3) =       0.000426511996
  error estimate for blocks of size 2^( 4) =       0.000438648787
  error estimate for blocks of size 2^( 5) =       0.000449594272
  error estimate for blocks of size 2^( 6) =       0.000457153856
  error estimate for blocks of size 2^( 7) =       0.000461855253

      target function =                  N/A
              le_mean =     -16.905946882827
             les_mean =     286.144870981328
             stat err =       0.000451813042
             autocorr =       1.272584520552
              std dev =       0.566409387801
             le_variance =       0.320819594589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594688283e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905946882858       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905950133166       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905950841838       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905950519572       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905950644415       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905950588095       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905950762107       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905950764763       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905950746458       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905950736767       residual = 5.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+00 is 1.347748e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905946882858       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905947747521       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905947935312       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905947854546       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905947883239       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905947860439       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905947906702       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905947911500       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905947904911       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905947902869       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+00 is 3.556140e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905946882858       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905947102544       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905947150230       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905947130090       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905947137083       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905947130598       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905947142318       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905947143818       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905947142091       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905947141571       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+01 is 9.015217e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268663 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7775e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
   uu_0                 3.122226e-01 1 1  ON 0
   uu_1                 1.451163e-01 1 1  ON 1
   uu_2                 4.322973e-02 1 1  ON 2
   uu_3                -1.932795e-02 1 1  ON 3
   uu_4                -6.504116e-02 1 1  ON 4
   uu_5                -1.000887e-01 1 1  ON 5
   uu_6                -1.275857e-01 1 1  ON 6
   uu_7                -1.411388e-01 1 1  ON 7
   uu_8                -1.339463e-01 1 1  ON 8
   uu_9                -1.024054e-01 1 1  ON 9
   ud_0                 4.467337e-01 1 1  ON 10
   ud_1                 1.810805e-01 1 1  ON 11
   ud_2                 6.076948e-02 1 1  ON 12
   ud_3                -1.007770e-02 1 1  ON 13
   ud_4                -6.681739e-02 1 1  ON 14
   ud_5                -1.082414e-01 1 1  ON 15
   ud_6                -1.350409e-01 1 1  ON 16
   ud_7                -1.508596e-01 1 1  ON 17
   ud_8                -1.510813e-01 1 1  ON 18
   ud_9                -1.402003e-01 1 1  ON 19
   eO_0                -7.496940e-01 1 1  ON 20
   eO_1                -4.292492e-01 1 1  ON 21
   eO_2                -1.981532e-02 1 1  ON 22
   eO_3                 2.911618e-01 1 1  ON 23
   eO_4                 5.151352e-01 1 1  ON 24
   eO_5                 4.766804e-01 1 1  ON 25
   eO_6                 2.500218e-01 1 1  ON 26
   eO_7                -4.638761e-02 1 1  ON 27
   eO_8                -2.141272e-01 1 1  ON 28
   eO_9                -7.448144e-02 1 1  ON 29
  eH1_0                -2.520738e-01 1 1  ON 30
  eH1_1                -1.455681e-01 1 1  ON 31
  eH1_2                -9.553739e-02 1 1  ON 32
  eH1_3                -4.014411e-02 1 1  ON 33
  eH1_4                 8.949727e-03 1 1  ON 34
  eH1_5                 4.369560e-02 1 1  ON 35
  eH1_6                 1.011349e-01 1 1  ON 36
  eH1_7                 1.543221e-01 1 1  ON 37
  eH1_8                 1.715259e-01 1 1  ON 38
  eH1_9                 5.696521e-02 1 1  ON 39
  eH2_0                -2.497271e-01 1 1  ON 40
  eH2_1                -1.422127e-01 1 1  ON 41
  eH2_2                -9.240490e-02 1 1  ON 42
  eH2_3                -3.689523e-02 1 1  ON 43
  eH2_4                 1.251789e-02 1 1  ON 44
  eH2_5                 4.751396e-02 1 1  ON 45
  eH2_6                 1.042909e-01 1 1  ON 46
  eH2_7                 1.546529e-01 1 1  ON 47
  eH2_8                 1.751284e-01 1 1  ON 48
  eH2_9                 4.351993e-02 1 1  ON 49
ci_0001                 7.012329e-01 3 1  ON 50
ci_0002                 7.005226e-01 3 1  ON 51
ci_0003                -2.732263e-02 3 1  ON 52
ci_0004                -2.713902e-02 3 1  ON 53
ci_0005                -3.620267e-02 3 1  ON 54
ci_0006                -3.635599e-02 3 1  ON 55
ci_0007                -2.126296e-02 3 1  ON 56
ci_0008                -2.153568e-02 3 1  ON 57
ci_0009                -1.738329e-02 3 1  ON 58
ci_0010                -1.723039e-02 3 1  ON 59
ci_0011                -1.137440e-02 3 1  ON 60
ci_0012                -1.253394e-02 3 1  ON 61
ci_0013                 1.296112e-02 3 1  ON 62
ci_0014                 1.386319e-02 3 1  ON 63
ci_0015                 1.317235e-02 3 1  ON 64
ci_0016                 1.316105e-02 3 1  ON 65
ci_0017                 1.152557e-02 3 1  ON 66
ci_0018                 1.076284e-02 3 1  ON 67
ci_0019                 1.236047e-02 3 1  ON 68
ci_0020                 1.102869e-02 3 1  ON 69
ci_0021                -1.604906e-03 3 1  ON 70
ci_0022                -8.124540e-04 3 1  ON 71
ci_0023                -1.065669e-02 3 1  ON 72
ci_0024                -1.030776e-02 3 1  ON 73
ci_0025                -1.089893e-02 3 1  ON 74
ci_0026                -1.090972e-02 3 1  ON 75
ci_0027                -1.157286e-02 3 1  ON 76
ci_0028                -1.176569e-02 3 1  ON 77
ci_0029                -1.083507e-02 3 1  ON 78
ci_0030                -1.044054e-02 3 1  ON 79
ci_0031                 2.059621e-02 3 1  ON 80
ci_0032                 2.122619e-02 3 1  ON 81
ci_0033                 1.044167e-02 3 1  ON 82
ci_0034                 1.000322e-02 3 1  ON 83
ci_0035                 7.418798e-03 3 1  ON 84
ci_0036                 7.348290e-03 3 1  ON 85
ci_0037                -1.002375e-02 3 1  ON 86
ci_0038                -1.113470e-02 3 1  ON 87
ci_0039                -2.533198e-03 3 1  ON 88
ci_0040                -2.632753e-03 3 1  ON 89
ci_0041                 6.484358e-03 3 1  ON 90
ci_0042                 7.366842e-03 3 1  ON 91
ci_0043                -1.841620e-02 3 1  ON 92
ci_0044                -1.924641e-02 3 1  ON 93
ci_0045                 7.858349e-03 3 1  ON 94
ci_0046                 8.959954e-03 3 1  ON 95
ci_0047                -1.853257e-03 3 1  ON 96
ci_0048                -1.938507e-03 3 1  ON 97
ci_0049                -5.923315e-03 3 1  ON 98
ci_0050                -5.924133e-03 3 1  ON 99
ci_0051                -3.248137e-03 3 1  ON 100
ci_0052                -3.553069e-03 3 1  ON 101
ci_0053                -4.398931e-03 3 1  ON 102
ci_0054                -4.845782e-03 3 1  ON 103
ci_0055                 5.567984e-03 3 1  ON 104
ci_0056                 6.462203e-03 3 1  ON 105
ci_0057                 4.311187e-03 3 1  ON 106
ci_0058                 5.297683e-03 3 1  ON 107
ci_0059                -4.840614e-03 3 1  ON 108
ci_0060                -4.362119e-03 3 1  ON 109
ci_0061                -4.786199e-03 3 1  ON 110
ci_0062                -3.933058e-03 3 1  ON 111
ci_0063                -8.074318e-03 3 1  ON 112
ci_0064                -8.977583e-03 3 1  ON 113
ci_0065                -5.319620e-03 3 1  ON 114
ci_0066                -5.332763e-03 3 1  ON 115
ci_0067                -4.572922e-03 3 1  ON 116
ci_0068                -5.066919e-03 3 1  ON 117
ci_0069                 4.760079e-03 3 1  ON 118
ci_0070                 4.315342e-03 3 1  ON 119
ci_0071                 5.837461e-04 3 1  ON 120
ci_0072                -5.375042e-04 3 1  ON 121
ci_0073                 4.097779e-03 3 1  ON 122
ci_0074                 4.114162e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8329
    reference variance = 0.262754
====================================================
  Execution time = 2.0790e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3694e-01
  Total weights = 1.9518e+06
  Execution time = 1.8696e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324852106490
                                         uncertainty =       0.002411796668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324852106490
                                         uncertainty =       0.002411796668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403033551
  error estimate for blocks of size 2^( 2) =       0.000416101031
  error estimate for blocks of size 2^( 3) =       0.000429127387
  error estimate for blocks of size 2^( 4) =       0.000441071748
  error estimate for blocks of size 2^( 5) =       0.000452382677
  error estimate for blocks of size 2^( 6) =       0.000458063103
  error estimate for blocks of size 2^( 7) =       0.000460960706

      target function =                  N/A
              le_mean =     -16.905417338304
             les_mean =     286.130094277823
             stat err =       0.000453119559
             autocorr =       1.263988766788
              std dev =       0.569975514604
             le_variance =       0.324872087248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324872328253
                                         uncertainty =       0.002406216445

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324872328253
                                         uncertainty =       0.002406216445

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403046389
  error estimate for blocks of size 2^( 2) =       0.000416112977
  error estimate for blocks of size 2^( 3) =       0.000429138779
  error estimate for blocks of size 2^( 4) =       0.000441082241
  error estimate for blocks of size 2^( 5) =       0.000452392593
  error estimate for blocks of size 2^( 6) =       0.000458071718
  error estimate for blocks of size 2^( 7) =       0.000460974410

      target function =                  N/A
              le_mean =     -16.905418804292
             les_mean =     286.130232456184
             stat err =       0.000453130241
             autocorr =       1.263967838635
              std dev =       0.569993670126
             le_variance =       0.324892783984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324862129427
                                         uncertainty =       0.002408770359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324862129427
                                         uncertainty =       0.002408770359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403039925
  error estimate for blocks of size 2^( 2) =       0.000416106914
  error estimate for blocks of size 2^( 3) =       0.000429132997
  error estimate for blocks of size 2^( 4) =       0.000441076910
  error estimate for blocks of size 2^( 5) =       0.000452387593
  error estimate for blocks of size 2^( 6) =       0.000458067277
  error estimate for blocks of size 2^( 7) =       0.000460967534

      target function =                  N/A
              le_mean =     -16.905417987326
             les_mean =     286.130111636067
             stat err =       0.000453124829
             autocorr =       1.263978189392
              std dev =       0.569984528432
             le_variance =       0.324882362652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853270298
                                         uncertainty =       0.002411408649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324853270298
                                         uncertainty =       0.002411408649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403034293
  error estimate for blocks of size 2^( 2) =       0.000416101710
  error estimate for blocks of size 2^( 3) =       0.000429128032
  error estimate for blocks of size 2^( 4) =       0.000441072339
  error estimate for blocks of size 2^( 5) =       0.000452383244
  error estimate for blocks of size 2^( 6) =       0.000458063571
  error estimate for blocks of size 2^( 7) =       0.000460961503

      target function =                  N/A
              le_mean =     -16.905417405235
             les_mean =     286.130086597318
             stat err =       0.000453120164
             autocorr =       1.263987493018
              std dev =       0.569976563693
             le_variance =       0.324873283159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905417338304        initial
     2.4414e+00     2.4414e+01             1.3477e-04       -16.905418804292  <--
     9.7656e+00     9.7656e+01             3.5561e-05       -16.905417987326
     3.9062e+01     3.9062e+02             9.0152e-06       -16.905417405235

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 3.0234e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
   uu_0                 3.122911e-01 1 1  ON 0
   uu_1                 1.451218e-01 1 1  ON 1
   uu_2                 4.323039e-02 1 1  ON 2
   uu_3                -1.931530e-02 1 1  ON 3
   uu_4                -6.504976e-02 1 1  ON 4
   uu_5                -1.000803e-01 1 1  ON 5
   uu_6                -1.276490e-01 1 1  ON 6
   uu_7                -1.411682e-01 1 1  ON 7
   uu_8                -1.339639e-01 1 1  ON 8
   uu_9                -1.024293e-01 1 1  ON 9
   ud_0                 4.467537e-01 1 1  ON 10
   ud_1                 1.810940e-01 1 1  ON 11
   ud_2                 6.077689e-02 1 1  ON 12
   ud_3                -1.007032e-02 1 1  ON 13
   ud_4                -6.682874e-02 1 1  ON 14
   ud_5                -1.082320e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508705e-01 1 1  ON 17
   ud_8                -1.511130e-01 1 1  ON 18
   ud_9                -1.402044e-01 1 1  ON 19
   eO_0                -7.496787e-01 1 1  ON 20
   eO_1                -4.292517e-01 1 1  ON 21
   eO_2                -1.980998e-02 1 1  ON 22
   eO_3                 2.911483e-01 1 1  ON 23
   eO_4                 5.151543e-01 1 1  ON 24
   eO_5                 4.767067e-01 1 1  ON 25
   eO_6                 2.500483e-01 1 1  ON 26
   eO_7                -4.637413e-02 1 1  ON 27
   eO_8                -2.141746e-01 1 1  ON 28
   eO_9                -7.451749e-02 1 1  ON 29
  eH1_0                -2.521225e-01 1 1  ON 30
  eH1_1                -1.455555e-01 1 1  ON 31
  eH1_2                -9.553861e-02 1 1  ON 32
  eH1_3                -4.019706e-02 1 1  ON 33
  eH1_4                 8.959426e-03 1 1  ON 34
  eH1_5                 4.367411e-02 1 1  ON 35
  eH1_6                 1.011303e-01 1 1  ON 36
  eH1_7                 1.543190e-01 1 1  ON 37
  eH1_8                 1.715702e-01 1 1  ON 38
  eH1_9                 5.702886e-02 1 1  ON 39
  eH2_0                -2.497551e-01 1 1  ON 40
  eH2_1                -1.422564e-01 1 1  ON 41
  eH2_2                -9.243465e-02 1 1  ON 42
  eH2_3                -3.692510e-02 1 1  ON 43
  eH2_4                 1.248247e-02 1 1  ON 44
  eH2_5                 4.748624e-02 1 1  ON 45
  eH2_6                 1.043240e-01 1 1  ON 46
  eH2_7                 1.546794e-01 1 1  ON 47
  eH2_8                 1.751812e-01 1 1  ON 48
  eH2_9                 4.358878e-02 1 1  ON 49
ci_0001                 7.012117e-01 3 1  ON 50
ci_0002                 7.005386e-01 3 1  ON 51
ci_0003                -2.734217e-02 3 1  ON 52
ci_0004                -2.712490e-02 3 1  ON 53
ci_0005                -3.621919e-02 3 1  ON 54
ci_0006                -3.637604e-02 3 1  ON 55
ci_0007                -2.130719e-02 3 1  ON 56
ci_0008                -2.159785e-02 3 1  ON 57
ci_0009                -1.733847e-02 3 1  ON 58
ci_0010                -1.725858e-02 3 1  ON 59
ci_0011                -1.137963e-02 3 1  ON 60
ci_0012                -1.253680e-02 3 1  ON 61
ci_0013                 1.301235e-02 3 1  ON 62
ci_0014                 1.382643e-02 3 1  ON 63
ci_0015                 1.310997e-02 3 1  ON 64
ci_0016                 1.318891e-02 3 1  ON 65
ci_0017                 1.145737e-02 3 1  ON 66
ci_0018                 1.077478e-02 3 1  ON 67
ci_0019                 1.226678e-02 3 1  ON 68
ci_0020                 1.108622e-02 3 1  ON 69
ci_0021                -1.607341e-03 3 1  ON 70
ci_0022                -8.320711e-04 3 1  ON 71
ci_0023                -1.067925e-02 3 1  ON 72
ci_0024                -1.036805e-02 3 1  ON 73
ci_0025                -1.085625e-02 3 1  ON 74
ci_0026                -1.093451e-02 3 1  ON 75
ci_0027                -1.151685e-02 3 1  ON 76
ci_0028                -1.176972e-02 3 1  ON 77
ci_0029                -1.086959e-02 3 1  ON 78
ci_0030                -1.046910e-02 3 1  ON 79
ci_0031                 2.058676e-02 3 1  ON 80
ci_0032                 2.121149e-02 3 1  ON 81
ci_0033                 1.050381e-02 3 1  ON 82
ci_0034                 9.999495e-03 3 1  ON 83
ci_0035                 7.423478e-03 3 1  ON 84
ci_0036                 7.309794e-03 3 1  ON 85
ci_0037                -1.005070e-02 3 1  ON 86
ci_0038                -1.107454e-02 3 1  ON 87
ci_0039                -2.564101e-03 3 1  ON 88
ci_0040                -2.595005e-03 3 1  ON 89
ci_0041                 6.509499e-03 3 1  ON 90
ci_0042                 7.363128e-03 3 1  ON 91
ci_0043                -1.841364e-02 3 1  ON 92
ci_0044                -1.926876e-02 3 1  ON 93
ci_0045                 7.899889e-03 3 1  ON 94
ci_0046                 8.917870e-03 3 1  ON 95
ci_0047                -1.842133e-03 3 1  ON 96
ci_0048                -1.932376e-03 3 1  ON 97
ci_0049                -5.849465e-03 3 1  ON 98
ci_0050                -5.979566e-03 3 1  ON 99
ci_0051                -3.311522e-03 3 1  ON 100
ci_0052                -3.561788e-03 3 1  ON 101
ci_0053                -4.429475e-03 3 1  ON 102
ci_0054                -4.786773e-03 3 1  ON 103
ci_0055                 5.589019e-03 3 1  ON 104
ci_0056                 6.547684e-03 3 1  ON 105
ci_0057                 4.383603e-03 3 1  ON 106
ci_0058                 5.198470e-03 3 1  ON 107
ci_0059                -4.824173e-03 3 1  ON 108
ci_0060                -4.373069e-03 3 1  ON 109
ci_0061                -4.774805e-03 3 1  ON 110
ci_0062                -3.963481e-03 3 1  ON 111
ci_0063                -8.140312e-03 3 1  ON 112
ci_0064                -8.952769e-03 3 1  ON 113
ci_0065                -5.311215e-03 3 1  ON 114
ci_0066                -5.409164e-03 3 1  ON 115
ci_0067                -4.612911e-03 3 1  ON 116
ci_0068                -5.047155e-03 3 1  ON 117
ci_0069                 4.723691e-03 3 1  ON 118
ci_0070                 4.289237e-03 3 1  ON 119
ci_0071                 5.983590e-04 3 1  ON 120
ci_0072                -5.219850e-04 3 1  ON 121
ci_0073                 4.109130e-03 3 1  ON 122
ci_0074                 4.127876e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8016e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8587
    reference variance = 0.211541
====================================================
  Execution time = 2.1498e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3336e-01
  Total weights = 1.951774936e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320663921349
                                         uncertainty =       0.001696802712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320663921349
                                         uncertainty =       0.001696802712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400375523
  error estimate for blocks of size 2^( 2) =       0.000413414135
  error estimate for blocks of size 2^( 3) =       0.000427355535
  error estimate for blocks of size 2^( 4) =       0.000440045132
  error estimate for blocks of size 2^( 5) =       0.000452382274
  error estimate for blocks of size 2^( 6) =       0.000465439709
  error estimate for blocks of size 2^( 7) =       0.000472405296

      target function =                  N/A
              le_mean =     -16.905707765042
             les_mean =     286.136319117062
             stat err =       0.000457568102
             autocorr =       1.306100050172
              std dev =       0.566216494216
             le_variance =       0.320601118322


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570776504e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905707765007       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905714671278       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905715260698       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905716495955       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905715684826       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905715754581       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905716313499       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905716534371       residual = 8.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905716412713       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905716454826       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905716370166       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e-01 is 4.911262e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905707765007       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905709928815       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905710041367       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905710340800       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905710136969       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905710186668       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905710307809       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905710302817       residual = 4.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905710295890       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905710297260       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+00 is 1.489841e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905707765007       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905708342522       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905708367861       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905708438599       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905708385487       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905708405754       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905708431539       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905708426232       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905708426714       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905708424022       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+00 is 3.937745e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.272998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7608e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
   uu_0                 3.123294e-01 1 1  ON 0
   uu_1                 1.451331e-01 1 1  ON 1
   uu_2                 4.324427e-02 1 1  ON 2
   uu_3                -1.930101e-02 1 1  ON 3
   uu_4                -6.504607e-02 1 1  ON 4
   uu_5                -1.000869e-01 1 1  ON 5
   uu_6                -1.277085e-01 1 1  ON 6
   uu_7                -1.412379e-01 1 1  ON 7
   uu_8                -1.339831e-01 1 1  ON 8
   uu_9                -1.024307e-01 1 1  ON 9
   ud_0                 4.467331e-01 1 1  ON 10
   ud_1                 1.810946e-01 1 1  ON 11
   ud_2                 6.077216e-02 1 1  ON 12
   ud_3                -1.009723e-02 1 1  ON 13
   ud_4                -6.682099e-02 1 1  ON 14
   ud_5                -1.082170e-01 1 1  ON 15
   ud_6                -1.350231e-01 1 1  ON 16
   ud_7                -1.508454e-01 1 1  ON 17
   ud_8                -1.511235e-01 1 1  ON 18
   ud_9                -1.401766e-01 1 1  ON 19
   eO_0                -7.496940e-01 1 1  ON 20
   eO_1                -4.292946e-01 1 1  ON 21
   eO_2                -1.980861e-02 1 1  ON 22
   eO_3                 2.911087e-01 1 1  ON 23
   eO_4                 5.152142e-01 1 1  ON 24
   eO_5                 4.767795e-01 1 1  ON 25
   eO_6                 2.500702e-01 1 1  ON 26
   eO_7                -4.635631e-02 1 1  ON 27
   eO_8                -2.141999e-01 1 1  ON 28
   eO_9                -7.455912e-02 1 1  ON 29
  eH1_0                -2.521777e-01 1 1  ON 30
  eH1_1                -1.455237e-01 1 1  ON 31
  eH1_2                -9.558204e-02 1 1  ON 32
  eH1_3                -4.030006e-02 1 1  ON 33
  eH1_4                 8.934453e-03 1 1  ON 34
  eH1_5                 4.364404e-02 1 1  ON 35
  eH1_6                 1.011311e-01 1 1  ON 36
  eH1_7                 1.543538e-01 1 1  ON 37
  eH1_8                 1.716542e-01 1 1  ON 38
  eH1_9                 5.712209e-02 1 1  ON 39
  eH2_0                -2.497781e-01 1 1  ON 40
  eH2_1                -1.422433e-01 1 1  ON 41
  eH2_2                -9.247085e-02 1 1  ON 42
  eH2_3                -3.698597e-02 1 1  ON 43
  eH2_4                 1.242731e-02 1 1  ON 44
  eH2_5                 4.741581e-02 1 1  ON 45
  eH2_6                 1.043366e-01 1 1  ON 46
  eH2_7                 1.547246e-01 1 1  ON 47
  eH2_8                 1.752410e-01 1 1  ON 48
  eH2_9                 4.368262e-02 1 1  ON 49
ci_0001                 7.012233e-01 3 1  ON 50
ci_0002                 7.005323e-01 3 1  ON 51
ci_0003                -2.729901e-02 3 1  ON 52
ci_0004                -2.706303e-02 3 1  ON 53
ci_0005                -3.627525e-02 3 1  ON 54
ci_0006                -3.642526e-02 3 1  ON 55
ci_0007                -2.131034e-02 3 1  ON 56
ci_0008                -2.162624e-02 3 1  ON 57
ci_0009                -1.742399e-02 3 1  ON 58
ci_0010                -1.725863e-02 3 1  ON 59
ci_0011                -1.139073e-02 3 1  ON 60
ci_0012                -1.249745e-02 3 1  ON 61
ci_0013                 1.297803e-02 3 1  ON 62
ci_0014                 1.378494e-02 3 1  ON 63
ci_0015                 1.307802e-02 3 1  ON 64
ci_0016                 1.317551e-02 3 1  ON 65
ci_0017                 1.142605e-02 3 1  ON 66
ci_0018                 1.083934e-02 3 1  ON 67
ci_0019                 1.218073e-02 3 1  ON 68
ci_0020                 1.107500e-02 3 1  ON 69
ci_0021                -1.651282e-03 3 1  ON 70
ci_0022                -8.324544e-04 3 1  ON 71
ci_0023                -1.075040e-02 3 1  ON 72
ci_0024                -1.047197e-02 3 1  ON 73
ci_0025                -1.083072e-02 3 1  ON 74
ci_0026                -1.089969e-02 3 1  ON 75
ci_0027                -1.150062e-02 3 1  ON 76
ci_0028                -1.170945e-02 3 1  ON 77
ci_0029                -1.088850e-02 3 1  ON 78
ci_0030                -1.047798e-02 3 1  ON 79
ci_0031                 2.051192e-02 3 1  ON 80
ci_0032                 2.125247e-02 3 1  ON 81
ci_0033                 1.050543e-02 3 1  ON 82
ci_0034                 9.969723e-03 3 1  ON 83
ci_0035                 7.464820e-03 3 1  ON 84
ci_0036                 7.168001e-03 3 1  ON 85
ci_0037                -1.008372e-02 3 1  ON 86
ci_0038                -1.102179e-02 3 1  ON 87
ci_0039                -2.536236e-03 3 1  ON 88
ci_0040                -2.590457e-03 3 1  ON 89
ci_0041                 6.580047e-03 3 1  ON 90
ci_0042                 7.317384e-03 3 1  ON 91
ci_0043                -1.841699e-02 3 1  ON 92
ci_0044                -1.925318e-02 3 1  ON 93
ci_0045                 7.877542e-03 3 1  ON 94
ci_0046                 8.817913e-03 3 1  ON 95
ci_0047                -1.924985e-03 3 1  ON 96
ci_0048                -1.959852e-03 3 1  ON 97
ci_0049                -5.798990e-03 3 1  ON 98
ci_0050                -5.963078e-03 3 1  ON 99
ci_0051                -3.355500e-03 3 1  ON 100
ci_0052                -3.546049e-03 3 1  ON 101
ci_0053                -4.567260e-03 3 1  ON 102
ci_0054                -4.763177e-03 3 1  ON 103
ci_0055                 5.554153e-03 3 1  ON 104
ci_0056                 6.536889e-03 3 1  ON 105
ci_0057                 4.418971e-03 3 1  ON 106
ci_0058                 5.133457e-03 3 1  ON 107
ci_0059                -4.842678e-03 3 1  ON 108
ci_0060                -4.428647e-03 3 1  ON 109
ci_0061                -4.625821e-03 3 1  ON 110
ci_0062                -3.832147e-03 3 1  ON 111
ci_0063                -8.047900e-03 3 1  ON 112
ci_0064                -8.921087e-03 3 1  ON 113
ci_0065                -5.372315e-03 3 1  ON 114
ci_0066                -5.342470e-03 3 1  ON 115
ci_0067                -4.662608e-03 3 1  ON 116
ci_0068                -5.070374e-03 3 1  ON 117
ci_0069                 4.736156e-03 3 1  ON 118
ci_0070                 4.325302e-03 3 1  ON 119
ci_0071                 5.479491e-04 3 1  ON 120
ci_0072                -5.158855e-04 3 1  ON 121
ci_0073                 4.134423e-03 3 1  ON 122
ci_0074                 4.108640e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9352
    reference variance = 0.307068
====================================================
  Execution time = 2.1021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3185e-01
  Total weights = 1.9514e+06
  Execution time = 1.8814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321138992207
                                         uncertainty =       0.001918952502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321138992207
                                         uncertainty =       0.001918952502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400706828
  error estimate for blocks of size 2^( 2) =       0.000413601939
  error estimate for blocks of size 2^( 3) =       0.000426477687
  error estimate for blocks of size 2^( 4) =       0.000438616877
  error estimate for blocks of size 2^( 5) =       0.000449010793
  error estimate for blocks of size 2^( 6) =       0.000456871311
  error estimate for blocks of size 2^( 7) =       0.000462704086

      target function =                  N/A
              le_mean =     -16.906618665241
             les_mean =     286.171580889462
             stat err =       0.000451800767
             autocorr =       1.271277736057
              std dev =       0.566685030693
             le_variance =       0.321131924012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321128134565
                                         uncertainty =       0.001924070171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321128134565
                                         uncertainty =       0.001924070171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400700009
  error estimate for blocks of size 2^( 2) =       0.000413592241
  error estimate for blocks of size 2^( 3) =       0.000426473116
  error estimate for blocks of size 2^( 4) =       0.000438614577
  error estimate for blocks of size 2^( 5) =       0.000449013033
  error estimate for blocks of size 2^( 6) =       0.000456866166
  error estimate for blocks of size 2^( 7) =       0.000462717654

      target function =                  N/A
              le_mean =     -16.906615655645
             les_mean =     286.182807109642
             stat err =       0.000451802857
             autocorr =       1.271332769379
              std dev =       0.566675387390
             le_variance =       0.321120994673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321125438317
                                         uncertainty =       0.001921945239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321125438317
                                         uncertainty =       0.001921945239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400698348
  error estimate for blocks of size 2^( 2) =       0.000413591811
  error estimate for blocks of size 2^( 3) =       0.000426469050
  error estimate for blocks of size 2^( 4) =       0.000438608751
  error estimate for blocks of size 2^( 5) =       0.000449006004
  error estimate for blocks of size 2^( 6) =       0.000456864332
  error estimate for blocks of size 2^( 7) =       0.000462708660

      target function =                  N/A
              le_mean =     -16.906615849367
             les_mean =     286.166255801434
             stat err =       0.000451796937
             autocorr =       1.271309994710
              std dev =       0.566673037531
             le_variance =       0.321118331465

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321136402622
                                         uncertainty =       0.001919358943

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321136402622
                                         uncertainty =       0.001919358943

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400705207
  error estimate for blocks of size 2^( 2) =       0.000413599855
  error estimate for blocks of size 2^( 3) =       0.000426476337
  error estimate for blocks of size 2^( 4) =       0.000438614393
  error estimate for blocks of size 2^( 5) =       0.000449008257
  error estimate for blocks of size 2^( 6) =       0.000456867322
  error estimate for blocks of size 2^( 7) =       0.000462707796

      target function =                  N/A
              le_mean =     -16.906618957376
             les_mean =     286.195473656322
             stat err =       0.000451799442
             autocorr =       1.271280568878
              std dev =       0.566682738218
             le_variance =       0.321129325794


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906618665241        initial
     6.1035e-01     6.1035e+00             4.9113e-04       -16.906615655645
     2.4414e+00     2.4414e+01             1.4898e-04       -16.906615849367
     9.7656e+00     9.7656e+01             3.9377e-05       -16.906618957376  <--

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 3.0523e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953760e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705222e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694096e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746845e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361229e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736141e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252635e-02 3 1  ON 61
ci_0013                 1.300327e-02 3 1  ON 62
ci_0014                 1.381531e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144898e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224396e-02 3 1  ON 68
ci_0020                 1.108326e-02 3 1  ON 69
ci_0021                -1.618604e-03 3 1  ON 70
ci_0022                -8.320199e-04 3 1  ON 71
ci_0023                -1.069833e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084949e-02 3 1  ON 74
ci_0026                -1.092519e-02 3 1  ON 75
ci_0027                -1.151257e-02 3 1  ON 76
ci_0028                -1.175369e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056727e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050419e-02 3 1  ON 82
ci_0034                 9.991776e-03 3 1  ON 83
ci_0035                 7.434389e-03 3 1  ON 84
ci_0036                 7.272306e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556382e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528326e-03 3 1  ON 90
ci_0042                 7.350895e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894039e-03 3 1  ON 94
ci_0046                 8.891825e-03 3 1  ON 95
ci_0047                -1.864947e-03 3 1  ON 96
ci_0048                -1.939926e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975167e-03 3 1  ON 99
ci_0051                -3.323584e-03 3 1  ON 100
ci_0052                -3.557435e-03 3 1  ON 101
ci_0053                -4.467074e-03 3 1  ON 102
ci_0054                -4.780394e-03 3 1  ON 103
ci_0055                 5.579917e-03 3 1  ON 104
ci_0056                 6.544855e-03 3 1  ON 105
ci_0057                 4.392876e-03 3 1  ON 106
ci_0058                 5.181286e-03 3 1  ON 107
ci_0059                -4.829206e-03 3 1  ON 108
ci_0060                -4.388228e-03 3 1  ON 109
ci_0061                -4.735428e-03 3 1  ON 110
ci_0062                -3.928747e-03 3 1  ON 111
ci_0063                -8.115239e-03 3 1  ON 112
ci_0064                -8.944079e-03 3 1  ON 113
ci_0065                -5.327619e-03 3 1  ON 114
ci_0066                -5.391198e-03 3 1  ON 115
ci_0067                -4.626607e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727134e-03 3 1  ON 118
ci_0070                 4.299142e-03 3 1  ON 119
ci_0071                 5.847606e-04 3 1  ON 120
ci_0072                -5.204101e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122659e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8138e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9518
    reference variance = 0.393891
====================================================
  Execution time = 2.1270e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5254e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4265e-01
  Total weights = 1.951936212e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323060360207
                                         uncertainty =       0.002023216885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323060360207
                                         uncertainty =       0.002023216885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401836563
  error estimate for blocks of size 2^( 2) =       0.000414414976
  error estimate for blocks of size 2^( 3) =       0.000427301481
  error estimate for blocks of size 2^( 4) =       0.000439300189
  error estimate for blocks of size 2^( 5) =       0.000449555240
  error estimate for blocks of size 2^( 6) =       0.000458334896
  error estimate for blocks of size 2^( 7) =       0.000463849455

      target function =                  N/A
              le_mean =     -16.906297650318
             les_mean =     286.165552066281
             stat err =       0.000452759945
             autocorr =       1.269512830941
              std dev =       0.568282717808
             le_variance =       0.322945247360


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690629765032e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906297650286       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906300854586       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906300671159       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906300747247       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906300871379       residual = 7.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906300915713       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906300981281       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906301039064       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906300996094       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906301001578       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+00 is 1.528674e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906297650286       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906298499666       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906298456090       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906298481588       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906298517872       residual = 7.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906298524528       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906298534902       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906298554500       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906298544927       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906298545996       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+00 is 4.095083e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906297650286       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906297865881       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906297855172       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906297862018       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906297871465       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906297872915       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906297875045       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906297880219       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906297877987       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906297878244       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+01 is 1.042404e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277052 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7381e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
   uu_0                 3.123100e-01 1 1  ON 0
   uu_1                 1.451279e-01 1 1  ON 1
   uu_2                 4.323749e-02 1 1  ON 2
   uu_3                -1.930158e-02 1 1  ON 3
   uu_4                -6.504694e-02 1 1  ON 4
   uu_5                -1.000802e-01 1 1  ON 5
   uu_6                -1.276707e-01 1 1  ON 6
   uu_7                -1.411912e-01 1 1  ON 7
   uu_8                -1.339752e-01 1 1  ON 8
   uu_9                -1.024481e-01 1 1  ON 9
   ud_0                 4.467600e-01 1 1  ON 10
   ud_1                 1.810970e-01 1 1  ON 11
   ud_2                 6.079245e-02 1 1  ON 12
   ud_3                -1.007195e-02 1 1  ON 13
   ud_4                -6.682168e-02 1 1  ON 14
   ud_5                -1.082263e-01 1 1  ON 15
   ud_6                -1.350120e-01 1 1  ON 16
   ud_7                -1.508663e-01 1 1  ON 17
   ud_8                -1.511426e-01 1 1  ON 18
   ud_9                -1.402121e-01 1 1  ON 19
   eO_0                -7.496718e-01 1 1  ON 20
   eO_1                -4.292583e-01 1 1  ON 21
   eO_2                -1.981216e-02 1 1  ON 22
   eO_3                 2.911333e-01 1 1  ON 23
   eO_4                 5.151741e-01 1 1  ON 24
   eO_5                 4.767327e-01 1 1  ON 25
   eO_6                 2.500632e-01 1 1  ON 26
   eO_7                -4.636559e-02 1 1  ON 27
   eO_8                -2.141960e-01 1 1  ON 28
   eO_9                -7.454356e-02 1 1  ON 29
  eH1_0                -2.521452e-01 1 1  ON 30
  eH1_1                -1.455394e-01 1 1  ON 31
  eH1_2                -9.554700e-02 1 1  ON 32
  eH1_3                -4.023370e-02 1 1  ON 33
  eH1_4                 8.945066e-03 1 1  ON 34
  eH1_5                 4.366078e-02 1 1  ON 35
  eH1_6                 1.011352e-01 1 1  ON 36
  eH1_7                 1.543305e-01 1 1  ON 37
  eH1_8                 1.715994e-01 1 1  ON 38
  eH1_9                 5.706299e-02 1 1  ON 39
  eH2_0                -2.497583e-01 1 1  ON 40
  eH2_1                -1.422547e-01 1 1  ON 41
  eH2_2                -9.244431e-02 1 1  ON 42
  eH2_3                -3.695866e-02 1 1  ON 43
  eH2_4                 1.246129e-02 1 1  ON 44
  eH2_5                 4.744594e-02 1 1  ON 45
  eH2_6                 1.043196e-01 1 1  ON 46
  eH2_7                 1.546989e-01 1 1  ON 47
  eH2_8                 1.752152e-01 1 1  ON 48
  eH2_9                 4.363732e-02 1 1  ON 49
ci_0001                 7.012056e-01 3 1  ON 50
ci_0002                 7.005447e-01 3 1  ON 51
ci_0003                -2.733747e-02 3 1  ON 52
ci_0004                -2.711358e-02 3 1  ON 53
ci_0005                -3.625534e-02 3 1  ON 54
ci_0006                -3.640228e-02 3 1  ON 55
ci_0007                -2.131308e-02 3 1  ON 56
ci_0008                -2.161125e-02 3 1  ON 57
ci_0009                -1.738099e-02 3 1  ON 58
ci_0010                -1.721769e-02 3 1  ON 59
ci_0011                -1.139373e-02 3 1  ON 60
ci_0012                -1.252914e-02 3 1  ON 61
ci_0013                 1.300660e-02 3 1  ON 62
ci_0014                 1.380191e-02 3 1  ON 63
ci_0015                 1.308741e-02 3 1  ON 64
ci_0016                 1.321634e-02 3 1  ON 65
ci_0017                 1.144569e-02 3 1  ON 66
ci_0018                 1.082399e-02 3 1  ON 67
ci_0019                 1.223855e-02 3 1  ON 68
ci_0020                 1.106929e-02 3 1  ON 69
ci_0021                -1.612201e-03 3 1  ON 70
ci_0022                -8.516018e-04 3 1  ON 71
ci_0023                -1.071229e-02 3 1  ON 72
ci_0024                -1.039742e-02 3 1  ON 73
ci_0025                -1.083647e-02 3 1  ON 74
ci_0026                -1.095899e-02 3 1  ON 75
ci_0027                -1.150775e-02 3 1  ON 76
ci_0028                -1.172750e-02 3 1  ON 77
ci_0029                -1.087020e-02 3 1  ON 78
ci_0030                -1.050031e-02 3 1  ON 79
ci_0031                 2.054842e-02 3 1  ON 80
ci_0032                 2.123228e-02 3 1  ON 81
ci_0033                 1.049526e-02 3 1  ON 82
ci_0034                 9.979386e-03 3 1  ON 83
ci_0035                 7.417688e-03 3 1  ON 84
ci_0036                 7.243424e-03 3 1  ON 85
ci_0037                -1.007522e-02 3 1  ON 86
ci_0038                -1.103424e-02 3 1  ON 87
ci_0039                -2.571562e-03 3 1  ON 88
ci_0040                -2.602402e-03 3 1  ON 89
ci_0041                 6.529006e-03 3 1  ON 90
ci_0042                 7.327850e-03 3 1  ON 91
ci_0043                -1.843085e-02 3 1  ON 92
ci_0044                -1.926846e-02 3 1  ON 93
ci_0045                 7.891323e-03 3 1  ON 94
ci_0046                 8.879788e-03 3 1  ON 95
ci_0047                -1.855394e-03 3 1  ON 96
ci_0048                -1.941850e-03 3 1  ON 97
ci_0049                -5.819438e-03 3 1  ON 98
ci_0050                -5.976230e-03 3 1  ON 99
ci_0051                -3.326039e-03 3 1  ON 100
ci_0052                -3.547065e-03 3 1  ON 101
ci_0053                -4.475300e-03 3 1  ON 102
ci_0054                -4.784008e-03 3 1  ON 103
ci_0055                 5.604971e-03 3 1  ON 104
ci_0056                 6.556919e-03 3 1  ON 105
ci_0057                 4.374223e-03 3 1  ON 106
ci_0058                 5.161754e-03 3 1  ON 107
ci_0059                -4.841605e-03 3 1  ON 108
ci_0060                -4.405964e-03 3 1  ON 109
ci_0061                -4.714851e-03 3 1  ON 110
ci_0062                -3.924053e-03 3 1  ON 111
ci_0063                -8.088231e-03 3 1  ON 112
ci_0064                -8.933160e-03 3 1  ON 113
ci_0065                -5.330468e-03 3 1  ON 114
ci_0066                -5.372765e-03 3 1  ON 115
ci_0067                -4.654484e-03 3 1  ON 116
ci_0068                -5.034518e-03 3 1  ON 117
ci_0069                 4.714213e-03 3 1  ON 118
ci_0070                 4.308685e-03 3 1  ON 119
ci_0071                 5.946397e-04 3 1  ON 120
ci_0072                -5.119566e-04 3 1  ON 121
ci_0073                 4.107703e-03 3 1  ON 122
ci_0074                 4.121815e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.014
    reference variance = 0.260711
====================================================
  Execution time = 2.0757e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3382e-01
  Total weights = 1.9518e+06
  Execution time = 1.8772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321658837947
                                         uncertainty =       0.002504095372

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321658837947
                                         uncertainty =       0.002504095372

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401019029
  error estimate for blocks of size 2^( 2) =       0.000414565152
  error estimate for blocks of size 2^( 3) =       0.000428703121
  error estimate for blocks of size 2^( 4) =       0.000441042801
  error estimate for blocks of size 2^( 5) =       0.000453455632
  error estimate for blocks of size 2^( 6) =       0.000463121480
  error estimate for blocks of size 2^( 7) =       0.000471678821

      target function =                  N/A
              le_mean =     -16.905550448807
             les_mean =     286.131095506002
             stat err =       0.000457324684
             autocorr =       1.300526849820
              std dev =       0.567126549786
             le_variance =       0.321632523473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321686402702
                                         uncertainty =       0.002519311432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321686402702
                                         uncertainty =       0.002519311432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401036270
  error estimate for blocks of size 2^( 2) =       0.000414583253
  error estimate for blocks of size 2^( 3) =       0.000428723499
  error estimate for blocks of size 2^( 4) =       0.000441063248
  error estimate for blocks of size 2^( 5) =       0.000453478620
  error estimate for blocks of size 2^( 6) =       0.000463145409
  error estimate for blocks of size 2^( 7) =       0.000471702480

      target function =                  N/A
              le_mean =     -16.905547779272
             les_mean =     286.131019675828
             stat err =       0.000457347439
             autocorr =       1.300544445432
              std dev =       0.567150932395
             le_variance =       0.321660180116

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321672931546
                                         uncertainty =       0.002512191741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321672931546
                                         uncertainty =       0.002512191741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401027846
  error estimate for blocks of size 2^( 2) =       0.000414574409
  error estimate for blocks of size 2^( 3) =       0.000428713618
  error estimate for blocks of size 2^( 4) =       0.000441053347
  error estimate for blocks of size 2^( 5) =       0.000453467526
  error estimate for blocks of size 2^( 6) =       0.000463133943
  error estimate for blocks of size 2^( 7) =       0.000471691222

      target function =                  N/A
              le_mean =     -16.905548878834
             les_mean =     286.131036045963
             stat err =       0.000457336510
             autocorr =       1.300536925030
              std dev =       0.567139018169
             le_variance =       0.321646665930

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321660495414
                                         uncertainty =       0.002505120176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321660495414
                                         uncertainty =       0.002505120176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401020066
  error estimate for blocks of size 2^( 2) =       0.000414566240
  error estimate for blocks of size 2^( 3) =       0.000428704366
  error estimate for blocks of size 2^( 4) =       0.000441044048
  error estimate for blocks of size 2^( 5) =       0.000453457057
  error estimate for blocks of size 2^( 6) =       0.000463122959
  error estimate for blocks of size 2^( 7) =       0.000471680253

      target function =                  N/A
              le_mean =     -16.905550234198
             les_mean =     286.131233214553
             stat err =       0.000457326079
             autocorr =       1.300528059494
              std dev =       0.567128016635
             le_variance =       0.321634187253


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905550448807        initial  <--
     2.4414e+00     2.4414e+01             1.5287e-04       -16.905547779272
     9.7656e+00     9.7656e+01             4.0951e-05       -16.905548878834
     3.9062e+01     3.9062e+02             1.0424e-05       -16.905550234198

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2316
  </log>
  <optVariables href="H2O.s014.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953760e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705222e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694096e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746845e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361229e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736141e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252635e-02 3 1  ON 61
ci_0013                 1.300327e-02 3 1  ON 62
ci_0014                 1.381531e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144898e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224396e-02 3 1  ON 68
ci_0020                 1.108326e-02 3 1  ON 69
ci_0021                -1.618604e-03 3 1  ON 70
ci_0022                -8.320199e-04 3 1  ON 71
ci_0023                -1.069833e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084949e-02 3 1  ON 74
ci_0026                -1.092519e-02 3 1  ON 75
ci_0027                -1.151257e-02 3 1  ON 76
ci_0028                -1.175369e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056727e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050419e-02 3 1  ON 82
ci_0034                 9.991776e-03 3 1  ON 83
ci_0035                 7.434389e-03 3 1  ON 84
ci_0036                 7.272306e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556382e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528326e-03 3 1  ON 90
ci_0042                 7.350895e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894039e-03 3 1  ON 94
ci_0046                 8.891825e-03 3 1  ON 95
ci_0047                -1.864947e-03 3 1  ON 96
ci_0048                -1.939926e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975167e-03 3 1  ON 99
ci_0051                -3.323584e-03 3 1  ON 100
ci_0052                -3.557435e-03 3 1  ON 101
ci_0053                -4.467074e-03 3 1  ON 102
ci_0054                -4.780394e-03 3 1  ON 103
ci_0055                 5.579917e-03 3 1  ON 104
ci_0056                 6.544855e-03 3 1  ON 105
ci_0057                 4.392876e-03 3 1  ON 106
ci_0058                 5.181286e-03 3 1  ON 107
ci_0059                -4.829206e-03 3 1  ON 108
ci_0060                -4.388228e-03 3 1  ON 109
ci_0061                -4.735428e-03 3 1  ON 110
ci_0062                -3.928747e-03 3 1  ON 111
ci_0063                -8.115239e-03 3 1  ON 112
ci_0064                -8.944079e-03 3 1  ON 113
ci_0065                -5.327619e-03 3 1  ON 114
ci_0066                -5.391198e-03 3 1  ON 115
ci_0067                -4.626607e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727134e-03 3 1  ON 118
ci_0070                 4.299142e-03 3 1  ON 119
ci_0071                 5.847606e-04 3 1  ON 120
ci_0072                -5.204101e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122659e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7620e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9553
    reference variance = 0.374947
====================================================
  Execution time = 2.1556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3356e-01
  Total weights = 1.951513544e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323104603989
                                         uncertainty =       0.002480060060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323104603989
                                         uncertainty =       0.002480060060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401916320
  error estimate for blocks of size 2^( 2) =       0.000414763405
  error estimate for blocks of size 2^( 3) =       0.000428026489
  error estimate for blocks of size 2^( 4) =       0.000440164908
  error estimate for blocks of size 2^( 5) =       0.000449637731
  error estimate for blocks of size 2^( 6) =       0.000456815432
  error estimate for blocks of size 2^( 7) =       0.000460512075

      target function =                  N/A
              le_mean =     -16.906127656018
             les_mean =     286.150716630122
             stat err =       0.000451782536
             autocorr =       1.263535927819
              std dev =       0.568395510970
             le_variance =       0.323073456891


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612765602e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906127656033       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906127754859       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906127736390       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906127763281       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906127749426       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906127749827       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906127749636       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906127758512       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906127757601       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906127755757       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+01 is 1.338677e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906127656033       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906127680901       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906127676185       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906127682900       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906127679409       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906127679530       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906127679458       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906127681656       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906127681439       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906127680978       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+01 is 3.381206e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906127656033       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906127662260       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906127661075       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906127662753       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906127661879       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906127661910       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906127661891       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906127662439       residual = 5.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906127662385       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906127662270       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+02 is 8.474881e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.281073 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7636e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
   uu_0                 3.123016e-01 1 1  ON 0
   uu_1                 1.451236e-01 1 1  ON 1
   uu_2                 4.323383e-02 1 1  ON 2
   uu_3                -1.931091e-02 1 1  ON 3
   uu_4                -6.504775e-02 1 1  ON 4
   uu_5                -1.000812e-01 1 1  ON 5
   uu_6                -1.276635e-01 1 1  ON 6
   uu_7                -1.411867e-01 1 1  ON 7
   uu_8                -1.339703e-01 1 1  ON 8
   uu_9                -1.024314e-01 1 1  ON 9
   ud_0                 4.467498e-01 1 1  ON 10
   ud_1                 1.810960e-01 1 1  ON 11
   ud_2                 6.077569e-02 1 1  ON 12
   ud_3                -1.007750e-02 1 1  ON 13
   ud_4                -6.682615e-02 1 1  ON 14
   ud_5                -1.082276e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508652e-01 1 1  ON 17
   ud_8                -1.511172e-01 1 1  ON 18
   ud_9                -1.401987e-01 1 1  ON 19
   eO_0                -7.496827e-01 1 1  ON 20
   eO_1                -4.292649e-01 1 1  ON 21
   eO_2                -1.980808e-02 1 1  ON 22
   eO_3                 2.911391e-01 1 1  ON 23
   eO_4                 5.151698e-01 1 1  ON 24
   eO_5                 4.767261e-01 1 1  ON 25
   eO_6                 2.500556e-01 1 1  ON 26
   eO_7                -4.636924e-02 1 1  ON 27
   eO_8                -2.141827e-01 1 1  ON 28
   eO_9                -7.452946e-02 1 1  ON 29
  eH1_0                -2.521386e-01 1 1  ON 30
  eH1_1                -1.455461e-01 1 1  ON 31
  eH1_2                -9.554987e-02 1 1  ON 32
  eH1_3                -4.022474e-02 1 1  ON 33
  eH1_4                 8.952781e-03 1 1  ON 34
  eH1_5                 4.366635e-02 1 1  ON 35
  eH1_6                 1.011307e-01 1 1  ON 36
  eH1_7                 1.543284e-01 1 1  ON 37
  eH1_8                 1.715926e-01 1 1  ON 38
  eH1_9                 5.705381e-02 1 1  ON 39
  eH2_0                -2.497601e-01 1 1  ON 40
  eH2_1                -1.422530e-01 1 1  ON 41
  eH2_2                -9.244347e-02 1 1  ON 42
  eH2_3                -3.694253e-02 1 1  ON 43
  eH2_4                 1.246803e-02 1 1  ON 44
  eH2_5                 4.746768e-02 1 1  ON 45
  eH2_6                 1.043263e-01 1 1  ON 46
  eH2_7                 1.546910e-01 1 1  ON 47
  eH2_8                 1.751974e-01 1 1  ON 48
  eH2_9                 4.361411e-02 1 1  ON 49
ci_0001                 7.012145e-01 3 1  ON 50
ci_0002                 7.005375e-01 3 1  ON 51
ci_0003                -2.732882e-02 3 1  ON 52
ci_0004                -2.710874e-02 3 1  ON 53
ci_0005                -3.623351e-02 3 1  ON 54
ci_0006                -3.638747e-02 3 1  ON 55
ci_0007                -2.130809e-02 3 1  ON 56
ci_0008                -2.160760e-02 3 1  ON 57
ci_0009                -1.736068e-02 3 1  ON 58
ci_0010                -1.725805e-02 3 1  ON 59
ci_0011                -1.138588e-02 3 1  ON 60
ci_0012                -1.252402e-02 3 1  ON 61
ci_0013                 1.300446e-02 3 1  ON 62
ci_0014                 1.381344e-02 3 1  ON 63
ci_0015                 1.310084e-02 3 1  ON 64
ci_0016                 1.318514e-02 3 1  ON 65
ci_0017                 1.144675e-02 3 1  ON 66
ci_0018                 1.079426e-02 3 1  ON 67
ci_0019                 1.224201e-02 3 1  ON 68
ci_0020                 1.108321e-02 3 1  ON 69
ci_0021                -1.618512e-03 3 1  ON 70
ci_0022                -8.327071e-04 3 1  ON 71
ci_0023                -1.069994e-02 3 1  ON 72
ci_0024                -1.039811e-02 3 1  ON 73
ci_0025                -1.084851e-02 3 1  ON 74
ci_0026                -1.092458e-02 3 1  ON 75
ci_0027                -1.151174e-02 3 1  ON 76
ci_0028                -1.175433e-02 3 1  ON 77
ci_0029                -1.087406e-02 3 1  ON 78
ci_0030                -1.047142e-02 3 1  ON 79
ci_0031                 2.056771e-02 3 1  ON 80
ci_0032                 2.122131e-02 3 1  ON 81
ci_0033                 1.050584e-02 3 1  ON 82
ci_0034                 9.992125e-03 3 1  ON 83
ci_0035                 7.432759e-03 3 1  ON 84
ci_0036                 7.271693e-03 3 1  ON 85
ci_0037                -1.005702e-02 3 1  ON 86
ci_0038                -1.105892e-02 3 1  ON 87
ci_0039                -2.555952e-03 3 1  ON 88
ci_0040                -2.592258e-03 3 1  ON 89
ci_0041                 6.529724e-03 3 1  ON 90
ci_0042                 7.351149e-03 3 1  ON 91
ci_0043                -1.841240e-02 3 1  ON 92
ci_0044                -1.926282e-02 3 1  ON 93
ci_0045                 7.893635e-03 3 1  ON 94
ci_0046                 8.889934e-03 3 1  ON 95
ci_0047                -1.864012e-03 3 1  ON 96
ci_0048                -1.938213e-03 3 1  ON 97
ci_0049                -5.834938e-03 3 1  ON 98
ci_0050                -5.974214e-03 3 1  ON 99
ci_0051                -3.324119e-03 3 1  ON 100
ci_0052                -3.557621e-03 3 1  ON 101
ci_0053                -4.466766e-03 3 1  ON 102
ci_0054                -4.781035e-03 3 1  ON 103
ci_0055                 5.581630e-03 3 1  ON 104
ci_0056                 6.545426e-03 3 1  ON 105
ci_0057                 4.394247e-03 3 1  ON 106
ci_0058                 5.179446e-03 3 1  ON 107
ci_0059                -4.828610e-03 3 1  ON 108
ci_0060                -4.389089e-03 3 1  ON 109
ci_0061                -4.732223e-03 3 1  ON 110
ci_0062                -3.928545e-03 3 1  ON 111
ci_0063                -8.115097e-03 3 1  ON 112
ci_0064                -8.941069e-03 3 1  ON 113
ci_0065                -5.325481e-03 3 1  ON 114
ci_0066                -5.390617e-03 3 1  ON 115
ci_0067                -4.626844e-03 3 1  ON 116
ci_0068                -5.055241e-03 3 1  ON 117
ci_0069                 4.727045e-03 3 1  ON 118
ci_0070                 4.300775e-03 3 1  ON 119
ci_0071                 5.843257e-04 3 1  ON 120
ci_0072                -5.188379e-04 3 1  ON 121
ci_0073                 4.119409e-03 3 1  ON 122
ci_0074                 4.122538e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8332
    reference variance = 0.229682
====================================================
  Execution time = 2.1040e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3390e-01
  Total weights = 1.9519e+06
  Execution time = 2.3302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320925332215
                                         uncertainty =       0.001812353154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320925332215
                                         uncertainty =       0.001812353154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400517325
  error estimate for blocks of size 2^( 2) =       0.000413448330
  error estimate for blocks of size 2^( 3) =       0.000426848894
  error estimate for blocks of size 2^( 4) =       0.000439076296
  error estimate for blocks of size 2^( 5) =       0.000449569674
  error estimate for blocks of size 2^( 6) =       0.000457975383
  error estimate for blocks of size 2^( 7) =       0.000460812954

      target function =                  N/A
              le_mean =     -16.906701738666
             les_mean =     286.170442213062
             stat err =       0.000451858577
             autocorr =       1.272806681578
              std dev =       0.566417032776
             le_variance =       0.320828255018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320925835966
                                         uncertainty =       0.001812106988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320925835966
                                         uncertainty =       0.001812106988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400517644
  error estimate for blocks of size 2^( 2) =       0.000413448692
  error estimate for blocks of size 2^( 3) =       0.000426849387
  error estimate for blocks of size 2^( 4) =       0.000439076349
  error estimate for blocks of size 2^( 5) =       0.000449569563
  error estimate for blocks of size 2^( 6) =       0.000457975490
  error estimate for blocks of size 2^( 7) =       0.000460812698

      target function =                  N/A
              le_mean =     -16.906701347381
             les_mean =     286.170506995828
             stat err =       0.000451858525
             autocorr =       1.272804364799
              std dev =       0.566417483664
             le_variance =       0.320828765800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320925573882
                                         uncertainty =       0.001812228487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320925573882
                                         uncertainty =       0.001812228487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400517478
  error estimate for blocks of size 2^( 2) =       0.000413448504
  error estimate for blocks of size 2^( 3) =       0.000426849135
  error estimate for blocks of size 2^( 4) =       0.000439076316
  error estimate for blocks of size 2^( 5) =       0.000449569611
  error estimate for blocks of size 2^( 6) =       0.000457975430
  error estimate for blocks of size 2^( 7) =       0.000460812816

      target function =                  N/A
              le_mean =     -16.906701540041
             les_mean =     286.170472166404
             stat err =       0.000451858543
             autocorr =       1.272805519388
              std dev =       0.566417249243
             le_variance =       0.320828500240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320925361232
                                         uncertainty =       0.001812337504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320925361232
                                         uncertainty =       0.001812337504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400517343
  error estimate for blocks of size 2^( 2) =       0.000413448351
  error estimate for blocks of size 2^( 3) =       0.000426848923
  error estimate for blocks of size 2^( 4) =       0.000439076298
  error estimate for blocks of size 2^( 5) =       0.000449569665
  error estimate for blocks of size 2^( 6) =       0.000457975388
  error estimate for blocks of size 2^( 7) =       0.000460812935

      target function =                  N/A
              le_mean =     -16.906701713640
             les_mean =     286.170445699104
             stat err =       0.000451858572
             autocorr =       1.272806536398
              std dev =       0.566417058785
             le_variance =       0.320828284482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906701738666        initial  <--
     2.4414e+01     2.4414e+02             1.3387e-05       -16.906701347381
     9.7656e+01     9.7656e+02             3.3812e-06       -16.906701540041
     3.9062e+02     3.9062e+03             8.4749e-07       -16.906701713640

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2333
  </log>
  <optVariables href="H2O.s015.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953760e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705222e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694096e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746845e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361229e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736141e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252635e-02 3 1  ON 61
ci_0013                 1.300327e-02 3 1  ON 62
ci_0014                 1.381531e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144898e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224396e-02 3 1  ON 68
ci_0020                 1.108326e-02 3 1  ON 69
ci_0021                -1.618604e-03 3 1  ON 70
ci_0022                -8.320199e-04 3 1  ON 71
ci_0023                -1.069833e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084949e-02 3 1  ON 74
ci_0026                -1.092519e-02 3 1  ON 75
ci_0027                -1.151257e-02 3 1  ON 76
ci_0028                -1.175369e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056727e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050419e-02 3 1  ON 82
ci_0034                 9.991776e-03 3 1  ON 83
ci_0035                 7.434389e-03 3 1  ON 84
ci_0036                 7.272306e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556382e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528326e-03 3 1  ON 90
ci_0042                 7.350895e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894039e-03 3 1  ON 94
ci_0046                 8.891825e-03 3 1  ON 95
ci_0047                -1.864947e-03 3 1  ON 96
ci_0048                -1.939926e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975167e-03 3 1  ON 99
ci_0051                -3.323584e-03 3 1  ON 100
ci_0052                -3.557435e-03 3 1  ON 101
ci_0053                -4.467074e-03 3 1  ON 102
ci_0054                -4.780394e-03 3 1  ON 103
ci_0055                 5.579917e-03 3 1  ON 104
ci_0056                 6.544855e-03 3 1  ON 105
ci_0057                 4.392876e-03 3 1  ON 106
ci_0058                 5.181286e-03 3 1  ON 107
ci_0059                -4.829206e-03 3 1  ON 108
ci_0060                -4.388228e-03 3 1  ON 109
ci_0061                -4.735428e-03 3 1  ON 110
ci_0062                -3.928747e-03 3 1  ON 111
ci_0063                -8.115239e-03 3 1  ON 112
ci_0064                -8.944079e-03 3 1  ON 113
ci_0065                -5.327619e-03 3 1  ON 114
ci_0066                -5.391198e-03 3 1  ON 115
ci_0067                -4.626607e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727134e-03 3 1  ON 118
ci_0070                 4.299142e-03 3 1  ON 119
ci_0071                 5.847606e-04 3 1  ON 120
ci_0072                -5.204101e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122659e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9251
    reference variance = 0.249178
====================================================
  Execution time = 2.1218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3314e-01
  Total weights = 1.951647668e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321588143556
                                         uncertainty =       0.002192307579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321588143556
                                         uncertainty =       0.002192307579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401031258
  error estimate for blocks of size 2^( 2) =       0.000414008950
  error estimate for blocks of size 2^( 3) =       0.000427447352
  error estimate for blocks of size 2^( 4) =       0.000439547277
  error estimate for blocks of size 2^( 5) =       0.000451150820
  error estimate for blocks of size 2^( 6) =       0.000459624220
  error estimate for blocks of size 2^( 7) =       0.000462936839

      target function =                  N/A
              le_mean =     -16.907380708913
             les_mean =     286.192665037723
             stat err =       0.000453314789
             autocorr =       1.277742458344
              std dev =       0.567143844037
             le_variance =       0.321652139829


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690738070891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907380708913       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907380735785       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907380737591       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907380736097       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907380738391       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907380739291       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907380738207       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907380737658       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907380738210       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907380738261       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+02 is 1.341292e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907380708913       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907380715635       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907380716087       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907380715714       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907380716289       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907380716514       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907380716244       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907380716105       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907380716244       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907380716256       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+02 is 3.354685e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907380708913       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907380710594       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907380710707       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907380710614       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907380710755       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907380710814       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907380710742       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907380710696       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907380710744       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907380710741       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+03 is 8.387621e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.285103 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7375e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
   uu_0                 3.123013e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323402e-02 1 1  ON 2
   uu_3                -1.931155e-02 1 1  ON 3
   uu_4                -6.504873e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411860e-01 1 1  ON 7
   uu_8                -1.339688e-01 1 1  ON 8
   uu_9                -1.024298e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077592e-02 1 1  ON 12
   ud_3                -1.007786e-02 1 1  ON 13
   ud_4                -6.682620e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511157e-01 1 1  ON 18
   ud_9                -1.401976e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980901e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767252e-01 1 1  ON 25
   eO_6                 2.500539e-01 1 1  ON 26
   eO_7                -4.636956e-02 1 1  ON 27
   eO_8                -2.141811e-01 1 1  ON 28
   eO_9                -7.452806e-02 1 1  ON 29
  eH1_0                -2.521367e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554947e-02 1 1  ON 32
  eH1_3                -4.022438e-02 1 1  ON 33
  eH1_4                 8.953737e-03 1 1  ON 34
  eH1_5                 4.366639e-02 1 1  ON 35
  eH1_6                 1.011304e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715914e-01 1 1  ON 38
  eH1_9                 5.705241e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422524e-01 1 1  ON 41
  eH2_2                -9.244359e-02 1 1  ON 42
  eH2_3                -3.694103e-02 1 1  ON 43
  eH2_4                 1.246858e-02 1 1  ON 44
  eH2_5                 4.746825e-02 1 1  ON 45
  eH2_6                 1.043272e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361243e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005372e-01 3 1  ON 51
ci_0003                -2.733085e-02 3 1  ON 52
ci_0004                -2.710827e-02 3 1  ON 53
ci_0005                -3.623399e-02 3 1  ON 54
ci_0006                -3.638902e-02 3 1  ON 55
ci_0007                -2.130810e-02 3 1  ON 56
ci_0008                -2.160526e-02 3 1  ON 57
ci_0009                -1.736164e-02 3 1  ON 58
ci_0010                -1.725873e-02 3 1  ON 59
ci_0011                -1.138238e-02 3 1  ON 60
ci_0012                -1.252621e-02 3 1  ON 61
ci_0013                 1.300347e-02 3 1  ON 62
ci_0014                 1.381537e-02 3 1  ON 63
ci_0015                 1.310136e-02 3 1  ON 64
ci_0016                 1.318544e-02 3 1  ON 65
ci_0017                 1.144892e-02 3 1  ON 66
ci_0018                 1.079230e-02 3 1  ON 67
ci_0019                 1.224371e-02 3 1  ON 68
ci_0020                 1.108324e-02 3 1  ON 69
ci_0021                -1.618579e-03 3 1  ON 70
ci_0022                -8.319612e-04 3 1  ON 71
ci_0023                -1.069847e-02 3 1  ON 72
ci_0024                -1.039611e-02 3 1  ON 73
ci_0025                -1.084943e-02 3 1  ON 74
ci_0026                -1.092537e-02 3 1  ON 75
ci_0027                -1.151268e-02 3 1  ON 76
ci_0028                -1.175374e-02 3 1  ON 77
ci_0029                -1.087466e-02 3 1  ON 78
ci_0030                -1.047143e-02 3 1  ON 79
ci_0031                 2.056715e-02 3 1  ON 80
ci_0032                 2.122212e-02 3 1  ON 81
ci_0033                 1.050395e-02 3 1  ON 82
ci_0034                 9.991747e-03 3 1  ON 83
ci_0035                 7.434067e-03 3 1  ON 84
ci_0036                 7.272280e-03 3 1  ON 85
ci_0037                -1.005949e-02 3 1  ON 86
ci_0038                -1.106058e-02 3 1  ON 87
ci_0039                -2.556652e-03 3 1  ON 88
ci_0040                -2.593876e-03 3 1  ON 89
ci_0041                 6.528528e-03 3 1  ON 90
ci_0042                 7.351066e-03 3 1  ON 91
ci_0043                -1.841444e-02 3 1  ON 92
ci_0044                -1.926464e-02 3 1  ON 93
ci_0045                 7.894099e-03 3 1  ON 94
ci_0046                 8.891489e-03 3 1  ON 95
ci_0047                -1.864838e-03 3 1  ON 96
ci_0048                -1.939865e-03 3 1  ON 97
ci_0049                -5.836071e-03 3 1  ON 98
ci_0050                -5.975038e-03 3 1  ON 99
ci_0051                -3.323762e-03 3 1  ON 100
ci_0052                -3.557499e-03 3 1  ON 101
ci_0053                -4.467195e-03 3 1  ON 102
ci_0054                -4.780241e-03 3 1  ON 103
ci_0055                 5.580092e-03 3 1  ON 104
ci_0056                 6.544718e-03 3 1  ON 105
ci_0057                 4.393112e-03 3 1  ON 106
ci_0058                 5.181222e-03 3 1  ON 107
ci_0059                -4.828886e-03 3 1  ON 108
ci_0060                -4.388064e-03 3 1  ON 109
ci_0061                -4.735279e-03 3 1  ON 110
ci_0062                -3.928621e-03 3 1  ON 111
ci_0063                -8.115246e-03 3 1  ON 112
ci_0064                -8.943885e-03 3 1  ON 113
ci_0065                -5.327639e-03 3 1  ON 114
ci_0066                -5.391387e-03 3 1  ON 115
ci_0067                -4.626427e-03 3 1  ON 116
ci_0068                -5.053592e-03 3 1  ON 117
ci_0069                 4.727038e-03 3 1  ON 118
ci_0070                 4.299175e-03 3 1  ON 119
ci_0071                 5.845356e-04 3 1  ON 120
ci_0072                -5.203232e-04 3 1  ON 121
ci_0073                 4.115884e-03 3 1  ON 122
ci_0074                 4.122754e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9222
    reference variance = 0.160575
====================================================
  Execution time = 2.1318e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3883e-01
  Total weights = 1.9519e+06
  Execution time = 1.8761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326288503522
                                         uncertainty =       0.002329974659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326288503522
                                         uncertainty =       0.002329974659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403890016
  error estimate for blocks of size 2^( 2) =       0.000416501915
  error estimate for blocks of size 2^( 3) =       0.000429897447
  error estimate for blocks of size 2^( 4) =       0.000443001266
  error estimate for blocks of size 2^( 5) =       0.000453567723
  error estimate for blocks of size 2^( 6) =       0.000460350084
  error estimate for blocks of size 2^( 7) =       0.000464063972

      target function =                  N/A
              le_mean =     -16.906830414477
             les_mean =     286.179747120626
             stat err =       0.000455245761
             autocorr =       1.270473428099
              std dev =       0.571186738611
             le_variance =       0.326254290365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326287879554
                                         uncertainty =       0.002329973771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326287879554
                                         uncertainty =       0.002329973771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403889630
  error estimate for blocks of size 2^( 2) =       0.000416501509
  error estimate for blocks of size 2^( 3) =       0.000429897055
  error estimate for blocks of size 2^( 4) =       0.000443000889
  error estimate for blocks of size 2^( 5) =       0.000453567397
  error estimate for blocks of size 2^( 6) =       0.000460349817
  error estimate for blocks of size 2^( 7) =       0.000464063647

      target function =                  N/A
              le_mean =     -16.906830411514
             les_mean =     286.179748526124
             stat err =       0.000455245438
             autocorr =       1.270474051696
              std dev =       0.571186191931
             le_variance =       0.326253665853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326288191183
                                         uncertainty =       0.002329974213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326288191183
                                         uncertainty =       0.002329974213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403889823
  error estimate for blocks of size 2^( 2) =       0.000416501711
  error estimate for blocks of size 2^( 3) =       0.000429897251
  error estimate for blocks of size 2^( 4) =       0.000443001078
  error estimate for blocks of size 2^( 5) =       0.000453567560
  error estimate for blocks of size 2^( 6) =       0.000460349950
  error estimate for blocks of size 2^( 7) =       0.000464063810

      target function =                  N/A
              le_mean =     -16.906830412984
             les_mean =     286.179747761246
             stat err =       0.000455245599
             autocorr =       1.270473740333
              std dev =       0.571186464960
             le_variance =       0.326253977754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326288464459
                                         uncertainty =       0.002329974603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326288464459
                                         uncertainty =       0.002329974603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403889992
  error estimate for blocks of size 2^( 2) =       0.000416501889
  error estimate for blocks of size 2^( 3) =       0.000429897423
  error estimate for blocks of size 2^( 4) =       0.000443001243
  error estimate for blocks of size 2^( 5) =       0.000453567702
  error estimate for blocks of size 2^( 6) =       0.000460350068
  error estimate for blocks of size 2^( 7) =       0.000464063952

      target function =                  N/A
              le_mean =     -16.906830414289
             les_mean =     286.179747194396
             stat err =       0.000455245741
             autocorr =       1.270473467142
              std dev =       0.571186704387
             le_variance =       0.326254251268


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906830414477        initial  <--
     2.4414e+02     2.4414e+03             1.3413e-06       -16.906830411514
     9.7656e+02     9.7656e+03             3.3547e-07       -16.906830412984
     3.9062e+03     3.9062e+04             8.3876e-08       -16.906830414289

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7945
  </log>
  <optVariables href="H2O.s016.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953760e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705222e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694096e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746845e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361229e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736141e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252635e-02 3 1  ON 61
ci_0013                 1.300327e-02 3 1  ON 62
ci_0014                 1.381531e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144898e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224396e-02 3 1  ON 68
ci_0020                 1.108326e-02 3 1  ON 69
ci_0021                -1.618604e-03 3 1  ON 70
ci_0022                -8.320199e-04 3 1  ON 71
ci_0023                -1.069833e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084949e-02 3 1  ON 74
ci_0026                -1.092519e-02 3 1  ON 75
ci_0027                -1.151257e-02 3 1  ON 76
ci_0028                -1.175369e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056727e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050419e-02 3 1  ON 82
ci_0034                 9.991776e-03 3 1  ON 83
ci_0035                 7.434389e-03 3 1  ON 84
ci_0036                 7.272306e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556382e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528326e-03 3 1  ON 90
ci_0042                 7.350895e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894039e-03 3 1  ON 94
ci_0046                 8.891825e-03 3 1  ON 95
ci_0047                -1.864947e-03 3 1  ON 96
ci_0048                -1.939926e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975167e-03 3 1  ON 99
ci_0051                -3.323584e-03 3 1  ON 100
ci_0052                -3.557435e-03 3 1  ON 101
ci_0053                -4.467074e-03 3 1  ON 102
ci_0054                -4.780394e-03 3 1  ON 103
ci_0055                 5.579917e-03 3 1  ON 104
ci_0056                 6.544855e-03 3 1  ON 105
ci_0057                 4.392876e-03 3 1  ON 106
ci_0058                 5.181286e-03 3 1  ON 107
ci_0059                -4.829206e-03 3 1  ON 108
ci_0060                -4.388228e-03 3 1  ON 109
ci_0061                -4.735428e-03 3 1  ON 110
ci_0062                -3.928747e-03 3 1  ON 111
ci_0063                -8.115239e-03 3 1  ON 112
ci_0064                -8.944079e-03 3 1  ON 113
ci_0065                -5.327619e-03 3 1  ON 114
ci_0066                -5.391198e-03 3 1  ON 115
ci_0067                -4.626607e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727134e-03 3 1  ON 118
ci_0070                 4.299142e-03 3 1  ON 119
ci_0071                 5.847606e-04 3 1  ON 120
ci_0072                -5.204101e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122659e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8177e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9369
    reference variance = 0.162049
====================================================
  Execution time = 2.1186e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3984e-01
  Total weights = 1.951383830e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1419e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324682720586
                                         uncertainty =       0.002322964642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324682720586
                                         uncertainty =       0.002322964642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402896585
  error estimate for blocks of size 2^( 2) =       0.000415794481
  error estimate for blocks of size 2^( 3) =       0.000429429877
  error estimate for blocks of size 2^( 4) =       0.000441864460
  error estimate for blocks of size 2^( 5) =       0.000453391289
  error estimate for blocks of size 2^( 6) =       0.000461606182
  error estimate for blocks of size 2^( 7) =       0.000466393129

      target function =                  N/A
              le_mean =     -16.905761924219
             les_mean =     286.144624458226
             stat err =       0.000455813765
             autocorr =       1.279934367364
              std dev =       0.569781814289
             le_variance =       0.324651315895


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576192422e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905761924224       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905761926022       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905761925992       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905761925936       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905761925823       residual = 7.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905761925885       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905761925883       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905761925861       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905761925923       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+03 is 1.337627e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905761924224       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905761924673       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905761924666       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905761924652       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905761924620       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905761924642       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905761924635       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905761924622       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905761924640       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+03 is 3.344374e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905761924224       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905761924336       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905761924334       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905761924336       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905761924349       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905761924315       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905761924325       residual = 8.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905761924330       residual = 3.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905761924348       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+04 is 8.361128e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.288557 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7340e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682634e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980892e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452794e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554945e-02 1 1  ON 32
  eH1_3                -4.022422e-02 1 1  ON 33
  eH1_4                 8.953756e-03 1 1  ON 34
  eH1_5                 4.366639e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705224e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244372e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246860e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361231e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733060e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623379e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160519e-02 3 1  ON 57
ci_0009                -1.736141e-02 3 1  ON 58
ci_0010                -1.725861e-02 3 1  ON 59
ci_0011                -1.138253e-02 3 1  ON 60
ci_0012                -1.252635e-02 3 1  ON 61
ci_0013                 1.300326e-02 3 1  ON 62
ci_0014                 1.381530e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144898e-02 3 1  ON 66
ci_0018                 1.079220e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618590e-03 3 1  ON 70
ci_0022                -8.320216e-04 3 1  ON 71
ci_0023                -1.069832e-02 3 1  ON 72
ci_0024                -1.039588e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092516e-02 3 1  ON 75
ci_0027                -1.151257e-02 3 1  ON 76
ci_0028                -1.175367e-02 3 1  ON 77
ci_0029                -1.087466e-02 3 1  ON 78
ci_0030                -1.047140e-02 3 1  ON 79
ci_0031                 2.056727e-02 3 1  ON 80
ci_0032                 2.122216e-02 3 1  ON 81
ci_0033                 1.050417e-02 3 1  ON 82
ci_0034                 9.991776e-03 3 1  ON 83
ci_0035                 7.434369e-03 3 1  ON 84
ci_0036                 7.272296e-03 3 1  ON 85
ci_0037                -1.005931e-02 3 1  ON 86
ci_0038                -1.106070e-02 3 1  ON 87
ci_0039                -2.556394e-03 3 1  ON 88
ci_0040                -2.593742e-03 3 1  ON 89
ci_0041                 6.528342e-03 3 1  ON 90
ci_0042                 7.350890e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894020e-03 3 1  ON 94
ci_0046                 8.891810e-03 3 1  ON 95
ci_0047                -1.864937e-03 3 1  ON 96
ci_0048                -1.939911e-03 3 1  ON 97
ci_0049                -5.836098e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323560e-03 3 1  ON 100
ci_0052                -3.557422e-03 3 1  ON 101
ci_0053                -4.467075e-03 3 1  ON 102
ci_0054                -4.780379e-03 3 1  ON 103
ci_0055                 5.579928e-03 3 1  ON 104
ci_0056                 6.544835e-03 3 1  ON 105
ci_0057                 4.392866e-03 3 1  ON 106
ci_0058                 5.181294e-03 3 1  ON 107
ci_0059                -4.829179e-03 3 1  ON 108
ci_0060                -4.388259e-03 3 1  ON 109
ci_0061                -4.735402e-03 3 1  ON 110
ci_0062                -3.928739e-03 3 1  ON 111
ci_0063                -8.115273e-03 3 1  ON 112
ci_0064                -8.944081e-03 3 1  ON 113
ci_0065                -5.327615e-03 3 1  ON 114
ci_0066                -5.391219e-03 3 1  ON 115
ci_0067                -4.626626e-03 3 1  ON 116
ci_0068                -5.053517e-03 3 1  ON 117
ci_0069                 4.727123e-03 3 1  ON 118
ci_0070                 4.299132e-03 3 1  ON 119
ci_0071                 5.847461e-04 3 1  ON 120
ci_0072                -5.203850e-04 3 1  ON 121
ci_0073                 4.116047e-03 3 1  ON 122
ci_0074                 4.122650e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8205
    reference variance = 0.81345
====================================================
  Execution time = 2.0855e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3862e-01
  Total weights = 1.9513e+06
  Execution time = 1.8766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324473232340
                                         uncertainty =       0.002679759052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324473232340
                                         uncertainty =       0.002679759052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402816862
  error estimate for blocks of size 2^( 2) =       0.000415844796
  error estimate for blocks of size 2^( 3) =       0.000429175105
  error estimate for blocks of size 2^( 4) =       0.000441863003
  error estimate for blocks of size 2^( 5) =       0.000452774061
  error estimate for blocks of size 2^( 6) =       0.000462578605
  error estimate for blocks of size 2^( 7) =       0.000469460726

      target function =                  N/A
              le_mean =     -16.905941961163
             les_mean =     286.149494535023
             stat err =       0.000456669099
             autocorr =       1.285251051170
              std dev =       0.569669068731
             le_variance =       0.324522847869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324473252947
                                         uncertainty =       0.002679770099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324473252947
                                         uncertainty =       0.002679770099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402816874
  error estimate for blocks of size 2^( 2) =       0.000415844807
  error estimate for blocks of size 2^( 3) =       0.000429175115
  error estimate for blocks of size 2^( 4) =       0.000441863007
  error estimate for blocks of size 2^( 5) =       0.000452774056
  error estimate for blocks of size 2^( 6) =       0.000462578600
  error estimate for blocks of size 2^( 7) =       0.000469460714

      target function =                  N/A
              le_mean =     -16.905941959182
             les_mean =     286.149493531648
             stat err =       0.000456669094
             autocorr =       1.285250943651
              std dev =       0.569669086878
             le_variance =       0.324522868545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324473242643
                                         uncertainty =       0.002679764575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324473242643
                                         uncertainty =       0.002679764575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402816868
  error estimate for blocks of size 2^( 2) =       0.000415844802
  error estimate for blocks of size 2^( 3) =       0.000429175110
  error estimate for blocks of size 2^( 4) =       0.000441863005
  error estimate for blocks of size 2^( 5) =       0.000452774058
  error estimate for blocks of size 2^( 6) =       0.000462578603
  error estimate for blocks of size 2^( 7) =       0.000469460720

      target function =                  N/A
              le_mean =     -16.905941960172
             les_mean =     286.149494030226
             stat err =       0.000456669096
             autocorr =       1.285250997408
              std dev =       0.569669077803
             le_variance =       0.324522858205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324473233628
                                         uncertainty =       0.002679759743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324473233628
                                         uncertainty =       0.002679759743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402816862
  error estimate for blocks of size 2^( 2) =       0.000415844797
  error estimate for blocks of size 2^( 3) =       0.000429175106
  error estimate for blocks of size 2^( 4) =       0.000441863003
  error estimate for blocks of size 2^( 5) =       0.000452774061
  error estimate for blocks of size 2^( 6) =       0.000462578605
  error estimate for blocks of size 2^( 7) =       0.000469460725

      target function =                  N/A
              le_mean =     -16.905941961039
             les_mean =     286.149494471581
             stat err =       0.000456669098
             autocorr =       1.285251044451
              std dev =       0.569669069865
             le_variance =       0.324522849160


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905941961163        initial  <--
     2.4414e+03     2.4414e+04             1.3376e-07       -16.905941959182
     9.7656e+03     9.7656e+04             3.3444e-08       -16.905941960172
     3.9062e+04     3.9062e+05             8.3611e-09       -16.905941961039

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3359
  </log>
  <optVariables href="H2O.s017.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953760e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705222e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694096e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746845e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361229e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736141e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252635e-02 3 1  ON 61
ci_0013                 1.300327e-02 3 1  ON 62
ci_0014                 1.381531e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144898e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224396e-02 3 1  ON 68
ci_0020                 1.108326e-02 3 1  ON 69
ci_0021                -1.618604e-03 3 1  ON 70
ci_0022                -8.320199e-04 3 1  ON 71
ci_0023                -1.069833e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084949e-02 3 1  ON 74
ci_0026                -1.092519e-02 3 1  ON 75
ci_0027                -1.151257e-02 3 1  ON 76
ci_0028                -1.175369e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056727e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050419e-02 3 1  ON 82
ci_0034                 9.991776e-03 3 1  ON 83
ci_0035                 7.434389e-03 3 1  ON 84
ci_0036                 7.272306e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556382e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528326e-03 3 1  ON 90
ci_0042                 7.350895e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894039e-03 3 1  ON 94
ci_0046                 8.891825e-03 3 1  ON 95
ci_0047                -1.864947e-03 3 1  ON 96
ci_0048                -1.939926e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975167e-03 3 1  ON 99
ci_0051                -3.323584e-03 3 1  ON 100
ci_0052                -3.557435e-03 3 1  ON 101
ci_0053                -4.467074e-03 3 1  ON 102
ci_0054                -4.780394e-03 3 1  ON 103
ci_0055                 5.579917e-03 3 1  ON 104
ci_0056                 6.544855e-03 3 1  ON 105
ci_0057                 4.392876e-03 3 1  ON 106
ci_0058                 5.181286e-03 3 1  ON 107
ci_0059                -4.829206e-03 3 1  ON 108
ci_0060                -4.388228e-03 3 1  ON 109
ci_0061                -4.735428e-03 3 1  ON 110
ci_0062                -3.928747e-03 3 1  ON 111
ci_0063                -8.115239e-03 3 1  ON 112
ci_0064                -8.944079e-03 3 1  ON 113
ci_0065                -5.327619e-03 3 1  ON 114
ci_0066                -5.391198e-03 3 1  ON 115
ci_0067                -4.626607e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727134e-03 3 1  ON 118
ci_0070                 4.299142e-03 3 1  ON 119
ci_0071                 5.847606e-04 3 1  ON 120
ci_0072                -5.204101e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122659e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7683e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.836
    reference variance = 0.272969
====================================================
  Execution time = 2.1145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3841e-01
  Total weights = 1.951994459e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326284860395
                                         uncertainty =       0.002619336344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326284860395
                                         uncertainty =       0.002619336344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403903722
  error estimate for blocks of size 2^( 2) =       0.000416617062
  error estimate for blocks of size 2^( 3) =       0.000429418638
  error estimate for blocks of size 2^( 4) =       0.000441588640
  error estimate for blocks of size 2^( 5) =       0.000451458050
  error estimate for blocks of size 2^( 6) =       0.000458276989
  error estimate for blocks of size 2^( 7) =       0.000460345967

      target function =                  N/A
              le_mean =     -16.906754273283
             les_mean =     286.176746278357
             stat err =       0.000452917411
             autocorr =       1.257425674251
              std dev =       0.571206120944
             le_variance =       0.326276432604


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690675427328e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906754273280       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906754273403       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906754273411       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906754273439       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906754273446       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906754273433       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906754273430       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906754273405       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906754273528       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906754273362       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+04 is 1.583607e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906754273280       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906754273311       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906754273313       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906754273310       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906754273337       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906754273318       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906754273324       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906754273313       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906754273420       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906754273556       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+04 is 3.959042e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906754273280       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906754273287       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906754273288       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906754273321       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906754273295       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906754273233       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906754273593       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906754273161       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906754272957       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906754273513       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.9062e+05 is 9.897620e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7316e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705222e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694096e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746845e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736141e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252635e-02 3 1  ON 61
ci_0013                 1.300327e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144898e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224396e-02 3 1  ON 68
ci_0020                 1.108326e-02 3 1  ON 69
ci_0021                -1.618601e-03 3 1  ON 70
ci_0022                -8.320196e-04 3 1  ON 71
ci_0023                -1.069833e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084949e-02 3 1  ON 74
ci_0026                -1.092519e-02 3 1  ON 75
ci_0027                -1.151257e-02 3 1  ON 76
ci_0028                -1.175369e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056727e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050419e-02 3 1  ON 82
ci_0034                 9.991775e-03 3 1  ON 83
ci_0035                 7.434391e-03 3 1  ON 84
ci_0036                 7.272303e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556383e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528326e-03 3 1  ON 90
ci_0042                 7.350895e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894039e-03 3 1  ON 94
ci_0046                 8.891821e-03 3 1  ON 95
ci_0047                -1.864947e-03 3 1  ON 96
ci_0048                -1.939926e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975169e-03 3 1  ON 99
ci_0051                -3.323583e-03 3 1  ON 100
ci_0052                -3.557434e-03 3 1  ON 101
ci_0053                -4.467075e-03 3 1  ON 102
ci_0054                -4.780393e-03 3 1  ON 103
ci_0055                 5.579919e-03 3 1  ON 104
ci_0056                 6.544853e-03 3 1  ON 105
ci_0057                 4.392878e-03 3 1  ON 106
ci_0058                 5.181285e-03 3 1  ON 107
ci_0059                -4.829205e-03 3 1  ON 108
ci_0060                -4.388230e-03 3 1  ON 109
ci_0061                -4.735424e-03 3 1  ON 110
ci_0062                -3.928746e-03 3 1  ON 111
ci_0063                -8.115238e-03 3 1  ON 112
ci_0064                -8.944082e-03 3 1  ON 113
ci_0065                -5.327620e-03 3 1  ON 114
ci_0066                -5.391198e-03 3 1  ON 115
ci_0067                -4.626609e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727130e-03 3 1  ON 118
ci_0070                 4.299141e-03 3 1  ON 119
ci_0071                 5.847601e-04 3 1  ON 120
ci_0072                -5.204068e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122661e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9807
    reference variance = 0.222659
====================================================
  Execution time = 2.1102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3405e-01
  Total weights = 1.9513e+06
  Execution time = 1.8933e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576627002
                                         uncertainty =       0.002309259868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576627002
                                         uncertainty =       0.002309259868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401588737
  error estimate for blocks of size 2^( 2) =       0.000414809435
  error estimate for blocks of size 2^( 3) =       0.000428899431
  error estimate for blocks of size 2^( 4) =       0.000441683643
  error estimate for blocks of size 2^( 5) =       0.000452834024
  error estimate for blocks of size 2^( 6) =       0.000460335654
  error estimate for blocks of size 2^( 7) =       0.000465918512

      target function =                  N/A
              le_mean =     -16.905868687559
             les_mean =     286.142446011838
             stat err =       0.000455192958
             autocorr =       1.284777797756
              std dev =       0.567932237830
             le_variance =       0.322547026767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576627191
                                         uncertainty =       0.002309260188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576627191
                                         uncertainty =       0.002309260188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401588737
  error estimate for blocks of size 2^( 2) =       0.000414809435
  error estimate for blocks of size 2^( 3) =       0.000428899431
  error estimate for blocks of size 2^( 4) =       0.000441683643
  error estimate for blocks of size 2^( 5) =       0.000452834024
  error estimate for blocks of size 2^( 6) =       0.000460335654
  error estimate for blocks of size 2^( 7) =       0.000465918512

      target function =                  N/A
              le_mean =     -16.905868687689
             les_mean =     286.142445820422
             stat err =       0.000455192958
             autocorr =       1.284777797258
              std dev =       0.567932238002
             le_variance =       0.322547026962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576627096
                                         uncertainty =       0.002309260028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576627096
                                         uncertainty =       0.002309260028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401588737
  error estimate for blocks of size 2^( 2) =       0.000414809435
  error estimate for blocks of size 2^( 3) =       0.000428899431
  error estimate for blocks of size 2^( 4) =       0.000441683643
  error estimate for blocks of size 2^( 5) =       0.000452834024
  error estimate for blocks of size 2^( 6) =       0.000460335654
  error estimate for blocks of size 2^( 7) =       0.000465918512

      target function =                  N/A
              le_mean =     -16.905868687624
             les_mean =     286.142445916111
             stat err =       0.000455192958
             autocorr =       1.284777797509
              std dev =       0.567932237916
             le_variance =       0.322547026864

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576627014
                                         uncertainty =       0.002309259888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322576627014
                                         uncertainty =       0.002309259888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401588737
  error estimate for blocks of size 2^( 2) =       0.000414809435
  error estimate for blocks of size 2^( 3) =       0.000428899431
  error estimate for blocks of size 2^( 4) =       0.000441683643
  error estimate for blocks of size 2^( 5) =       0.000452834024
  error estimate for blocks of size 2^( 6) =       0.000460335654
  error estimate for blocks of size 2^( 7) =       0.000465918512

      target function =                  N/A
              le_mean =     -16.905868687567
             les_mean =     286.142445999870
             stat err =       0.000455192958
             autocorr =       1.284777797728
              std dev =       0.567932237841
             le_variance =       0.322547026779


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905868687559        initial
     2.4414e+04     2.4414e+05             1.5836e-08       -16.905868687689  <--
     9.7656e+04     9.7656e+05             3.9590e-09       -16.905868687624
     3.9062e+05     3.9062e+06             9.8976e-10       -16.905868687567

*****************************************************************************
Applying the update for shift_i =   2.4414e+04     and shift_s =   2.4414e+05
*****************************************************************************

  Execution time = 3.0663e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320187e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556387e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891810e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836102e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544846e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181284e-03 3 1  ON 107
ci_0059                -4.829204e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928744e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944093e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626617e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847585e-04 3 1  ON 120
ci_0072                -5.203970e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7985e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.898
    reference variance = 0.24708
====================================================
  Execution time = 2.1089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3256e-01
  Total weights = 1.951378696e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0768e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319468722790
                                         uncertainty =       0.001760154668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319468722790
                                         uncertainty =       0.001760154668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399737719
  error estimate for blocks of size 2^( 2) =       0.000412851232
  error estimate for blocks of size 2^( 3) =       0.000426342308
  error estimate for blocks of size 2^( 4) =       0.000439327593
  error estimate for blocks of size 2^( 5) =       0.000450189591
  error estimate for blocks of size 2^( 6) =       0.000458612133
  error estimate for blocks of size 2^( 7) =       0.000462224829

      target function =                  N/A
              le_mean =     -16.906025968411
             les_mean =     286.146277715603
             stat err =       0.000452588537
             autocorr =       1.281907943911
              std dev =       0.565314504126
             le_variance =       0.319580488575


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602596841e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906025968393       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906025969022       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906025969069       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906025969135       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906025969157       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906025969108       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906025969151       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025969150       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906025969146       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+03 is 8.981287e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906025968393       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906025968550       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906025968562       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906025968579       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906025968584       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906025968570       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906025968580       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025968599       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906025968603       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+04 is 2.245351e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906025968393       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906025968432       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906025968435       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906025968439       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906025968440       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906025968428       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906025968469       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906025968445       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906025968430       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+04 is 5.613397e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7179e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007793e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452793e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022422e-02 1 1  ON 33
  eH1_4                 8.953763e-03 1 1  ON 34
  eH1_5                 4.366639e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705224e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244372e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361231e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710840e-02 3 1  ON 53
ci_0005                -3.623377e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130800e-02 3 1  ON 56
ci_0008                -2.160517e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138255e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381531e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318529e-02 3 1  ON 65
ci_0017                 1.144898e-02 3 1  ON 66
ci_0018                 1.079219e-02 3 1  ON 67
ci_0019                 1.224394e-02 3 1  ON 68
ci_0020                 1.108328e-02 3 1  ON 69
ci_0021                -1.618597e-03 3 1  ON 70
ci_0022                -8.320235e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039591e-02 3 1  ON 73
ci_0025                -1.084947e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151257e-02 3 1  ON 76
ci_0028                -1.175367e-02 3 1  ON 77
ci_0029                -1.087466e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122218e-02 3 1  ON 81
ci_0033                 1.050417e-02 3 1  ON 82
ci_0034                 9.991786e-03 3 1  ON 83
ci_0035                 7.434389e-03 3 1  ON 84
ci_0036                 7.272291e-03 3 1  ON 85
ci_0037                -1.005927e-02 3 1  ON 86
ci_0038                -1.106068e-02 3 1  ON 87
ci_0039                -2.556381e-03 3 1  ON 88
ci_0040                -2.593756e-03 3 1  ON 89
ci_0041                 6.528328e-03 3 1  ON 90
ci_0042                 7.350890e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894030e-03 3 1  ON 94
ci_0046                 8.891793e-03 3 1  ON 95
ci_0047                -1.864941e-03 3 1  ON 96
ci_0048                -1.939922e-03 3 1  ON 97
ci_0049                -5.836094e-03 3 1  ON 98
ci_0050                -5.975170e-03 3 1  ON 99
ci_0051                -3.323582e-03 3 1  ON 100
ci_0052                -3.557429e-03 3 1  ON 101
ci_0053                -4.467081e-03 3 1  ON 102
ci_0054                -4.780393e-03 3 1  ON 103
ci_0055                 5.579930e-03 3 1  ON 104
ci_0056                 6.544843e-03 3 1  ON 105
ci_0057                 4.392872e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829206e-03 3 1  ON 108
ci_0060                -4.388242e-03 3 1  ON 109
ci_0061                -4.735401e-03 3 1  ON 110
ci_0062                -3.928748e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327626e-03 3 1  ON 114
ci_0066                -5.391194e-03 3 1  ON 115
ci_0067                -4.626634e-03 3 1  ON 116
ci_0068                -5.053511e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299141e-03 3 1  ON 119
ci_0071                 5.847600e-04 3 1  ON 120
ci_0072                -5.203877e-04 3 1  ON 121
ci_0073                 4.116035e-03 3 1  ON 122
ci_0074                 4.122656e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9686
    reference variance = 1.07979
====================================================
  Execution time = 2.0980e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3909e-01
  Total weights = 1.9515e+06
  Execution time = 1.8788e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188623487
                                         uncertainty =       0.002910979089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188623487
                                         uncertainty =       0.002910979089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403228047
  error estimate for blocks of size 2^( 2) =       0.000416149373
  error estimate for blocks of size 2^( 3) =       0.000429559263
  error estimate for blocks of size 2^( 4) =       0.000442157281
  error estimate for blocks of size 2^( 5) =       0.000452510516
  error estimate for blocks of size 2^( 6) =       0.000462195289
  error estimate for blocks of size 2^( 7) =       0.000465853435

      target function =                  N/A
              le_mean =     -16.906498130697
             les_mean =     286.168770049252
             stat err =       0.000455679130
             autocorr =       1.277076205200
              std dev =       0.570250572481
             le_variance =       0.325185715415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188624424
                                         uncertainty =       0.002910977667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188624424
                                         uncertainty =       0.002910977667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403228047
  error estimate for blocks of size 2^( 2) =       0.000416149374
  error estimate for blocks of size 2^( 3) =       0.000429559263
  error estimate for blocks of size 2^( 4) =       0.000442157280
  error estimate for blocks of size 2^( 5) =       0.000452510515
  error estimate for blocks of size 2^( 6) =       0.000462195287
  error estimate for blocks of size 2^( 7) =       0.000465853435

      target function =                  N/A
              le_mean =     -16.906498130513
             les_mean =     286.168769985042
             stat err =       0.000455679129
             autocorr =       1.277076196958
              std dev =       0.570250573344
             le_variance =       0.325185716399

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188623956
                                         uncertainty =       0.002910978378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188623956
                                         uncertainty =       0.002910978378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403228047
  error estimate for blocks of size 2^( 2) =       0.000416149373
  error estimate for blocks of size 2^( 3) =       0.000429559263
  error estimate for blocks of size 2^( 4) =       0.000442157281
  error estimate for blocks of size 2^( 5) =       0.000452510516
  error estimate for blocks of size 2^( 6) =       0.000462195288
  error estimate for blocks of size 2^( 7) =       0.000465853435

      target function =                  N/A
              le_mean =     -16.906498130605
             les_mean =     286.168770017141
             stat err =       0.000455679130
             autocorr =       1.277076201083
              std dev =       0.570250572912
             le_variance =       0.325185715907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188623546
                                         uncertainty =       0.002910979000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325188623546
                                         uncertainty =       0.002910979000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403228047
  error estimate for blocks of size 2^( 2) =       0.000416149373
  error estimate for blocks of size 2^( 3) =       0.000429559263
  error estimate for blocks of size 2^( 4) =       0.000442157281
  error estimate for blocks of size 2^( 5) =       0.000452510516
  error estimate for blocks of size 2^( 6) =       0.000462195288
  error estimate for blocks of size 2^( 7) =       0.000465853435

      target function =                  N/A
              le_mean =     -16.906498130686
             les_mean =     286.168770045237
             stat err =       0.000455679130
             autocorr =       1.277076204692
              std dev =       0.570250572535
             le_variance =       0.325185715476


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906498130697        initial  <--
     6.1035e+03     6.1035e+04             8.9813e-08       -16.906498130513
     2.4414e+04     2.4414e+05             2.2454e-08       -16.906498130605
     9.7656e+04     9.7656e+05             5.6134e-09       -16.906498130686

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4605
  </log>
  <optVariables href="H2O.s019.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320187e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556387e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891810e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836102e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544846e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181284e-03 3 1  ON 107
ci_0059                -4.829204e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928744e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944093e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626617e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847585e-04 3 1  ON 120
ci_0072                -5.203970e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7646e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8215
    reference variance = 0.274653
====================================================
  Execution time = 2.1947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3710e-01
  Total weights = 1.951528526e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324509470611
                                         uncertainty =       0.002949572336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324509470611
                                         uncertainty =       0.002949572336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402778288
  error estimate for blocks of size 2^( 2) =       0.000415494794
  error estimate for blocks of size 2^( 3) =       0.000429032300
  error estimate for blocks of size 2^( 4) =       0.000442052394
  error estimate for blocks of size 2^( 5) =       0.000453317246
  error estimate for blocks of size 2^( 6) =       0.000461084657
  error estimate for blocks of size 2^( 7) =       0.000467214073

      target function =                  N/A
              le_mean =     -16.905692743415
             les_mean =     286.139546354023
             stat err =       0.000455917093
             autocorr =       1.281267012690
              std dev =       0.569614517858
             le_variance =       0.324460698954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569274342e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905692743413       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905692743552       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905692743558       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905692743554       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905692743548       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905692743514       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905692743519       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905692743558       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905692743463       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905692743734       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+04 is 6.578557e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905692743413       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905692743448       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905692743449       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905692743568       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905692743502       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905692743433       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905692743576       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905692743442       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905692743230       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905692742733       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+05 is 1.644643e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905692743413       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905692743422       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905692743422       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905692743059       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905692743069       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905692745352       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905692742785       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905692741391       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905692742407       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905692743779       residual = 5.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+05 is 4.111609e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.299740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8024e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007793e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320176e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050419e-02 3 1  ON 82
ci_0034                 9.991775e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272298e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556387e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894039e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864947e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836102e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323580e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579927e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392886e-03 3 1  ON 106
ci_0058                 5.181282e-03 3 1  ON 107
ci_0059                -4.829204e-03 3 1  ON 108
ci_0060                -4.388236e-03 3 1  ON 109
ci_0061                -4.735412e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115235e-03 3 1  ON 112
ci_0064                -8.944091e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727121e-03 3 1  ON 118
ci_0070                 4.299140e-03 3 1  ON 119
ci_0071                 5.847588e-04 3 1  ON 120
ci_0072                -5.203966e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122664e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9715
    reference variance = 0.445552
====================================================
  Execution time = 2.0882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3186e-01
  Total weights = 1.9515e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322096383686
                                         uncertainty =       0.002991266738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322096383686
                                         uncertainty =       0.002991266738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401318764
  error estimate for blocks of size 2^( 2) =       0.000413822053
  error estimate for blocks of size 2^( 3) =       0.000427128503
  error estimate for blocks of size 2^( 4) =       0.000439960199
  error estimate for blocks of size 2^( 5) =       0.000449749503
  error estimate for blocks of size 2^( 6) =       0.000457701830
  error estimate for blocks of size 2^( 7) =       0.000464738496

      target function =                  N/A
              le_mean =     -16.906509941498
             les_mean =     286.161940867326
             stat err =       0.000453037507
             autocorr =       1.274351940466
              std dev =       0.567550439461
             le_variance =       0.322113501333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322096386037
                                         uncertainty =       0.002991267229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322096386037
                                         uncertainty =       0.002991267229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401318766
  error estimate for blocks of size 2^( 2) =       0.000413822055
  error estimate for blocks of size 2^( 3) =       0.000427128504
  error estimate for blocks of size 2^( 4) =       0.000439960200
  error estimate for blocks of size 2^( 5) =       0.000449749505
  error estimate for blocks of size 2^( 6) =       0.000457701831
  error estimate for blocks of size 2^( 7) =       0.000464738497

      target function =                  N/A
              le_mean =     -16.906509941387
             les_mean =     286.161940850392
             stat err =       0.000453037508
             autocorr =       1.274351939103
              std dev =       0.567550441551
             le_variance =       0.322113503705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322096384862
                                         uncertainty =       0.002991266983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322096384862
                                         uncertainty =       0.002991266983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401318765
  error estimate for blocks of size 2^( 2) =       0.000413822054
  error estimate for blocks of size 2^( 3) =       0.000427128503
  error estimate for blocks of size 2^( 4) =       0.000439960199
  error estimate for blocks of size 2^( 5) =       0.000449749504
  error estimate for blocks of size 2^( 6) =       0.000457701831
  error estimate for blocks of size 2^( 7) =       0.000464738497

      target function =                  N/A
              le_mean =     -16.906509941443
             les_mean =     286.161940858858
             stat err =       0.000453037508
             autocorr =       1.274351939781
              std dev =       0.567550440506
             le_variance =       0.322113502519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322096383833
                                         uncertainty =       0.002991266769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322096383833
                                         uncertainty =       0.002991266769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401318765
  error estimate for blocks of size 2^( 2) =       0.000413822054
  error estimate for blocks of size 2^( 3) =       0.000427128503
  error estimate for blocks of size 2^( 4) =       0.000439960199
  error estimate for blocks of size 2^( 5) =       0.000449749504
  error estimate for blocks of size 2^( 6) =       0.000457701830
  error estimate for blocks of size 2^( 7) =       0.000464738496

      target function =                  N/A
              le_mean =     -16.906509941491
             les_mean =     286.161940866267
             stat err =       0.000453037507
             autocorr =       1.274351940385
              std dev =       0.567550439592
             le_variance =       0.322113501481


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906509941498        initial  <--
     6.1035e+04     6.1035e+05             6.5786e-09       -16.906509941387
     2.4414e+05     2.4414e+06             1.6446e-09       -16.906509941443
     9.7656e+05     9.7656e+06             4.1116e-10       -16.906509941491

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.4202
  </log>
  <optVariables href="H2O.s020.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320187e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556387e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891810e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836102e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544846e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181284e-03 3 1  ON 107
ci_0059                -4.829204e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928744e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944093e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626617e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847585e-04 3 1  ON 120
ci_0072                -5.203970e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9186
    reference variance = 0.18521
====================================================
  Execution time = 2.1389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3718e-01
  Total weights = 1.951711540e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324174818597
                                         uncertainty =       0.002330372895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324174818597
                                         uncertainty =       0.002330372895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402576005
  error estimate for blocks of size 2^( 2) =       0.000415718564
  error estimate for blocks of size 2^( 3) =       0.000428967753
  error estimate for blocks of size 2^( 4) =       0.000440928838
  error estimate for blocks of size 2^( 5) =       0.000451864055
  error estimate for blocks of size 2^( 6) =       0.000459155838
  error estimate for blocks of size 2^( 7) =       0.000464243626

      target function =                  N/A
              le_mean =     -16.907016052149
             les_mean =     286.184366968008
             stat err =       0.000454048089
             autocorr =       1.272060990188
              std dev =       0.569328445499
             le_variance =       0.324134878854


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690701605215e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907016052168       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907016052176       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907016052176       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907016052176       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907016051669       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907016052447       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907016052276       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907016052314       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907016053727       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907016051382       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+05 is 5.914154e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907016052168       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907016052170       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907016052170       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907016052146       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907016053311       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907016052025       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907016052821       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907016053159       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907016049644       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907016046701       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+06 is 1.478539e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907016052168       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907016052169       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907016052169       residual = 3.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907016052169       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907016050307       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907016050789       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907016051553       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907016044963       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907016052982       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907016089878       residual = 2.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.7656e+06 is 3.696352e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303680 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7502e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320187e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556387e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891810e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836102e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544846e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181284e-03 3 1  ON 107
ci_0059                -4.829204e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928744e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944093e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626617e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847585e-04 3 1  ON 120
ci_0072                -5.203969e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.956
    reference variance = 0.45201
====================================================
  Execution time = 2.1142e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3709e-01
  Total weights = 1.9518e+06
  Execution time = 1.8772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322309125240
                                         uncertainty =       0.002053108092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322309125240
                                         uncertainty =       0.002053108092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401439138
  error estimate for blocks of size 2^( 2) =       0.000414645584
  error estimate for blocks of size 2^( 3) =       0.000428182467
  error estimate for blocks of size 2^( 4) =       0.000441693820
  error estimate for blocks of size 2^( 5) =       0.000452951077
  error estimate for blocks of size 2^( 6) =       0.000461918551
  error estimate for blocks of size 2^( 7) =       0.000467382299

      target function =                  N/A
              le_mean =     -16.905957077127
             les_mean =     286.148477847764
             stat err =       0.000455986437
             autocorr =       1.290221952602
              std dev =       0.567720673328
             le_variance =       0.322306762924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322309125184
                                         uncertainty =       0.002053108088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322309125184
                                         uncertainty =       0.002053108088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401439138
  error estimate for blocks of size 2^( 2) =       0.000414645584
  error estimate for blocks of size 2^( 3) =       0.000428182467
  error estimate for blocks of size 2^( 4) =       0.000441693820
  error estimate for blocks of size 2^( 5) =       0.000452951077
  error estimate for blocks of size 2^( 6) =       0.000461918550
  error estimate for blocks of size 2^( 7) =       0.000467382299

      target function =                  N/A
              le_mean =     -16.905957077131
             les_mean =     286.148477847398
             stat err =       0.000455986437
             autocorr =       1.290221952588
              std dev =       0.567720673277
             le_variance =       0.322306762866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322309125212
                                         uncertainty =       0.002053108090

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322309125212
                                         uncertainty =       0.002053108090

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401439138
  error estimate for blocks of size 2^( 2) =       0.000414645584
  error estimate for blocks of size 2^( 3) =       0.000428182467
  error estimate for blocks of size 2^( 4) =       0.000441693820
  error estimate for blocks of size 2^( 5) =       0.000452951077
  error estimate for blocks of size 2^( 6) =       0.000461918551
  error estimate for blocks of size 2^( 7) =       0.000467382299

      target function =                  N/A
              le_mean =     -16.905957077129
             les_mean =     286.148477847581
             stat err =       0.000455986437
             autocorr =       1.290221952599
              std dev =       0.567720673303
             le_variance =       0.322306762895

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322309125236
                                         uncertainty =       0.002053108092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322309125236
                                         uncertainty =       0.002053108092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401439138
  error estimate for blocks of size 2^( 2) =       0.000414645584
  error estimate for blocks of size 2^( 3) =       0.000428182467
  error estimate for blocks of size 2^( 4) =       0.000441693820
  error estimate for blocks of size 2^( 5) =       0.000452951077
  error estimate for blocks of size 2^( 6) =       0.000461918551
  error estimate for blocks of size 2^( 7) =       0.000467382299

      target function =                  N/A
              le_mean =     -16.905957077128
             les_mean =     286.148477847741
             stat err =       0.000455986437
             autocorr =       1.290221952602
              std dev =       0.567720673324
             le_variance =       0.322306762920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905957077127        initial
     6.1035e+05     6.1035e+06             5.9142e-10       -16.905957077131  <--
     2.4414e+06     2.4414e+07             1.4785e-10       -16.905957077129
     9.7656e+06     9.7656e+07             3.6964e-11       -16.905957077128

*****************************************************************************
Applying the update for shift_i =   6.1035e+05     and shift_s =   6.1035e+06
*****************************************************************************

  Execution time = 3.0623e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544846e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928744e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626617e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847584e-04 3 1  ON 120
ci_0072                -5.203966e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8133e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9259
    reference variance = 0.263108
====================================================
  Execution time = 2.1950e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4205e-01
  Total weights = 1.951303222e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329138697430
                                         uncertainty =       0.004173823015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329138697430
                                         uncertainty =       0.004173823015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405682464
  error estimate for blocks of size 2^( 2) =       0.000417961505
  error estimate for blocks of size 2^( 3) =       0.000430768968
  error estimate for blocks of size 2^( 4) =       0.000443155665
  error estimate for blocks of size 2^( 5) =       0.000454832977
  error estimate for blocks of size 2^( 6) =       0.000462141028
  error estimate for blocks of size 2^( 7) =       0.000468044097

      target function =                  N/A
              le_mean =     -16.906321252861
             les_mean =     286.165751704359
             stat err =       0.000457043442
             autocorr =       1.269236325206
              std dev =       0.573721642215
             le_variance =       0.329156522746


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632125286e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906321252865       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906321252913       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906321252913       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906321252907       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906321252847       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906321252911       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906321252992       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906321252913       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906321252769       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906321252744       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+05 is 2.930840e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906321252865       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906321252877       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906321252877       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906321252876       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906321253102       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906321252921       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906321252879       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906321252901       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906321252684       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906321252329       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+05 is 7.327109e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906321252865       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906321252868       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906321252868       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906321252868       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906321251659       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906321252474       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906321251597       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906321252181       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906321253094       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906321247925       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+06 is 1.831777e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8089e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007793e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320188e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836102e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544846e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388236e-03 3 1  ON 109
ci_0061                -4.735412e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327626e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626617e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847581e-04 3 1  ON 120
ci_0072                -5.203961e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.8815
    reference variance = 0.176959
====================================================
  Execution time = 2.1032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3419e-01
  Total weights = 1.9519e+06
  Execution time = 1.8786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233351541
                                         uncertainty =       0.001836131936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233351541
                                         uncertainty =       0.001836131936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398316543
  error estimate for blocks of size 2^( 2) =       0.000411554708
  error estimate for blocks of size 2^( 3) =       0.000425350812
  error estimate for blocks of size 2^( 4) =       0.000437383756
  error estimate for blocks of size 2^( 5) =       0.000448291862
  error estimate for blocks of size 2^( 6) =       0.000456259273
  error estimate for blocks of size 2^( 7) =       0.000460081826

      target function =                  N/A
              le_mean =     -16.906148094945
             les_mean =     286.152029846933
             stat err =       0.000450504179
             autocorr =       1.279207389953
              std dev =       0.563304657798
             le_variance =       0.317312137497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233347656
                                         uncertainty =       0.001836131949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233347656
                                         uncertainty =       0.001836131949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398316541
  error estimate for blocks of size 2^( 2) =       0.000411554706
  error estimate for blocks of size 2^( 3) =       0.000425350810
  error estimate for blocks of size 2^( 4) =       0.000437383754
  error estimate for blocks of size 2^( 5) =       0.000448291860
  error estimate for blocks of size 2^( 6) =       0.000456259271
  error estimate for blocks of size 2^( 7) =       0.000460081824

      target function =                  N/A
              le_mean =     -16.906148094851
             les_mean =     286.152029753903
             stat err =       0.000450504177
             autocorr =       1.279207393900
              std dev =       0.563304654356
             le_variance =       0.317312133620

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233349599
                                         uncertainty =       0.001836131942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233349599
                                         uncertainty =       0.001836131942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398316542
  error estimate for blocks of size 2^( 2) =       0.000411554707
  error estimate for blocks of size 2^( 3) =       0.000425350811
  error estimate for blocks of size 2^( 4) =       0.000437383755
  error estimate for blocks of size 2^( 5) =       0.000448291861
  error estimate for blocks of size 2^( 6) =       0.000456259272
  error estimate for blocks of size 2^( 7) =       0.000460081825

      target function =                  N/A
              le_mean =     -16.906148094898
             les_mean =     286.152029800417
             stat err =       0.000450504178
             autocorr =       1.279207391926
              std dev =       0.563304656077
             le_variance =       0.317312135558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233351299
                                         uncertainty =       0.001836131936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.317233351299
                                         uncertainty =       0.001836131936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000398316543
  error estimate for blocks of size 2^( 2) =       0.000411554708
  error estimate for blocks of size 2^( 3) =       0.000425350812
  error estimate for blocks of size 2^( 4) =       0.000437383756
  error estimate for blocks of size 2^( 5) =       0.000448291862
  error estimate for blocks of size 2^( 6) =       0.000456259273
  error estimate for blocks of size 2^( 7) =       0.000460081826

      target function =                  N/A
              le_mean =     -16.906148094940
             les_mean =     286.152029841118
             stat err =       0.000450504179
             autocorr =       1.279207390207
              std dev =       0.563304657583
             le_variance =       0.317312137254


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906148094945        initial  <--
     1.5259e+05     1.5259e+06             2.9308e-09       -16.906148094851
     6.1035e+05     6.1035e+06             7.3271e-10       -16.906148094898
     2.4414e+06     2.4414e+07             1.8318e-10       -16.906148094940

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5153
  </log>
  <optVariables href="H2O.s022.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544846e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928744e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626617e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847584e-04 3 1  ON 120
ci_0072                -5.203966e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8486
    reference variance = 0.189659
====================================================
  Execution time = 2.1685e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3394e-01
  Total weights = 1.951497644e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321916242646
                                         uncertainty =       0.001890909151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321916242646
                                         uncertainty =       0.001890909151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401137739
  error estimate for blocks of size 2^( 2) =       0.000413716579
  error estimate for blocks of size 2^( 3) =       0.000427109880
  error estimate for blocks of size 2^( 4) =       0.000439897972
  error estimate for blocks of size 2^( 5) =       0.000450780340
  error estimate for blocks of size 2^( 6) =       0.000458737973
  error estimate for blocks of size 2^( 7) =       0.000463485426

      target function =                  N/A
              le_mean =     -16.905636767684
             les_mean =     286.134491278219
             stat err =       0.000453225428
             autocorr =       1.276560761485
              std dev =       0.567294430533
             le_variance =       0.321822970913


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690563676768e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905636767650       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905636767656       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905636767656       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905636767656       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905636767656       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905636768120       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905636766637       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905636768608       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905636766803       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905636769177       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+06 is 2.700009e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905636767650       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905636767651       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905636767651       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905636767683       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905636766295       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905636766734       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905636772457       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905636771710       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905636762136       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905636771950       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+06 is 6.750029e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905636767650       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905636767650       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905636767650       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905636767650       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905636767650       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905636767620       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905636767067       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905636766638       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905636753879       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905636784624       residual = 5.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.4414e+07 is 1.687511e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7808e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841440e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544846e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626617e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847583e-04 3 1  ON 120
ci_0072                -5.203965e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8789
    reference variance = 0.331832
====================================================
  Execution time = 2.0900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3385e-01
  Total weights = 1.9521e+06
  Execution time = 1.8810e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322174036811
                                         uncertainty =       0.002066727543

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322174036811
                                         uncertainty =       0.002066727543

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401337280
  error estimate for blocks of size 2^( 2) =       0.000414007066
  error estimate for blocks of size 2^( 3) =       0.000427112604
  error estimate for blocks of size 2^( 4) =       0.000439076945
  error estimate for blocks of size 2^( 5) =       0.000449752459
  error estimate for blocks of size 2^( 6) =       0.000457241150
  error estimate for blocks of size 2^( 7) =       0.000462011152

      target function =                  N/A
              le_mean =     -16.906452819811
             les_mean =     286.161992960948
             stat err =       0.000452020426
             autocorr =       1.268519406005
              std dev =       0.567576624206
             le_variance =       0.322143224345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322174036733
                                         uncertainty =       0.002066727537

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322174036733
                                         uncertainty =       0.002066727537

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401337280
  error estimate for blocks of size 2^( 2) =       0.000414007066
  error estimate for blocks of size 2^( 3) =       0.000427112604
  error estimate for blocks of size 2^( 4) =       0.000439076945
  error estimate for blocks of size 2^( 5) =       0.000449752459
  error estimate for blocks of size 2^( 6) =       0.000457241150
  error estimate for blocks of size 2^( 7) =       0.000462011152

      target function =                  N/A
              le_mean =     -16.906452819811
             les_mean =     286.161992961080
             stat err =       0.000452020426
             autocorr =       1.268519406091
              std dev =       0.567576624138
             le_variance =       0.322143224268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322174036772
                                         uncertainty =       0.002066727540

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322174036772
                                         uncertainty =       0.002066727540

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401337280
  error estimate for blocks of size 2^( 2) =       0.000414007066
  error estimate for blocks of size 2^( 3) =       0.000427112604
  error estimate for blocks of size 2^( 4) =       0.000439076945
  error estimate for blocks of size 2^( 5) =       0.000449752459
  error estimate for blocks of size 2^( 6) =       0.000457241150
  error estimate for blocks of size 2^( 7) =       0.000462011152

      target function =                  N/A
              le_mean =     -16.906452819811
             les_mean =     286.161992961014
             stat err =       0.000452020426
             autocorr =       1.268519406050
              std dev =       0.567576624172
             le_variance =       0.322143224306

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322174036806
                                         uncertainty =       0.002066727542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322174036806
                                         uncertainty =       0.002066727542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401337280
  error estimate for blocks of size 2^( 2) =       0.000414007066
  error estimate for blocks of size 2^( 3) =       0.000427112604
  error estimate for blocks of size 2^( 4) =       0.000439076945
  error estimate for blocks of size 2^( 5) =       0.000449752459
  error estimate for blocks of size 2^( 6) =       0.000457241150
  error estimate for blocks of size 2^( 7) =       0.000462011152

      target function =                  N/A
              le_mean =     -16.906452819811
             les_mean =     286.161992960956
             stat err =       0.000452020426
             autocorr =       1.268519406015
              std dev =       0.567576624202
             le_variance =       0.322143224340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906452819811        initial
     1.5259e+06     1.5259e+07             2.7000e-10       -16.906452819811  <--
     6.1035e+06     6.1035e+07             6.7500e-11       -16.906452819811
     2.4414e+07     2.4414e+08             1.6875e-11       -16.906452819811

*****************************************************************************
Applying the update for shift_i =   1.5259e+06     and shift_s =   1.5259e+07
*****************************************************************************

  Execution time = 3.0464e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8281e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9294
    reference variance = 0.182207
====================================================
  Execution time = 2.1068e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4174e-01
  Total weights = 1.951480128e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323026102638
                                         uncertainty =       0.002782531001

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323026102638
                                         uncertainty =       0.002782531001

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402012877
  error estimate for blocks of size 2^( 2) =       0.000415174970
  error estimate for blocks of size 2^( 3) =       0.000428469576
  error estimate for blocks of size 2^( 4) =       0.000440108938
  error estimate for blocks of size 2^( 5) =       0.000449968673
  error estimate for blocks of size 2^( 6) =       0.000457297531
  error estimate for blocks of size 2^( 7) =       0.000461579313

      target function =                  N/A
              le_mean =     -16.905031389075
             les_mean =     286.121823961159
             stat err =       0.000452238614
             autocorr =       1.265480199603
              std dev =       0.568532062749
             le_variance =       0.323228706374


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690503138907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905031389034       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905031389037       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905031389036       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905031389036       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905031389035       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905031389118       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905031389155       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905031389032       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905031388860       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905031389650       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+05 is 2.271165e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905031389034       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905031389035       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905031389035       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905031388987       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905031389021       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905031389293       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905031388350       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905031388524       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905031389329       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905031392022       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+06 is 5.677915e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905031389034       residual = 5.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905031389034       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905031389034       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905031389034       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905031389034       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905031389109       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905031390062       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905031390771       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905031384106       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905031356958       residual = 6.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+06 is 1.419480e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315463 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7137e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320188e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928744e-03 3 1  ON 111
ci_0063                -8.115235e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626617e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847586e-04 3 1  ON 120
ci_0072                -5.203962e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.7928
    reference variance = 0.852453
====================================================
  Execution time = 2.1553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3418e-01
  Total weights = 1.9514e+06
  Execution time = 1.8817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321657736766
                                         uncertainty =       0.002002976073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321657736766
                                         uncertainty =       0.002002976073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401038421
  error estimate for blocks of size 2^( 2) =       0.000413589901
  error estimate for blocks of size 2^( 3) =       0.000427387958
  error estimate for blocks of size 2^( 4) =       0.000440468896
  error estimate for blocks of size 2^( 5) =       0.000451237258
  error estimate for blocks of size 2^( 6) =       0.000461687464
  error estimate for blocks of size 2^( 7) =       0.000468729180

      target function =                  N/A
              le_mean =     -16.906445596393
             les_mean =     286.162078237230
             stat err =       0.000455530700
             autocorr =       1.290218718185
              std dev =       0.567153974166
             le_variance =       0.321663630412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321657736763
                                         uncertainty =       0.002002976073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321657736763
                                         uncertainty =       0.002002976073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401038421
  error estimate for blocks of size 2^( 2) =       0.000413589900
  error estimate for blocks of size 2^( 3) =       0.000427387958
  error estimate for blocks of size 2^( 4) =       0.000440468896
  error estimate for blocks of size 2^( 5) =       0.000451237258
  error estimate for blocks of size 2^( 6) =       0.000461687464
  error estimate for blocks of size 2^( 7) =       0.000468729180

      target function =                  N/A
              le_mean =     -16.906445596361
             les_mean =     286.162078209651
             stat err =       0.000455530700
             autocorr =       1.290218717244
              std dev =       0.567153974165
             le_variance =       0.321663630411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321657736765
                                         uncertainty =       0.002002976073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321657736765
                                         uncertainty =       0.002002976073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401038421
  error estimate for blocks of size 2^( 2) =       0.000413589901
  error estimate for blocks of size 2^( 3) =       0.000427387958
  error estimate for blocks of size 2^( 4) =       0.000440468896
  error estimate for blocks of size 2^( 5) =       0.000451237258
  error estimate for blocks of size 2^( 6) =       0.000461687464
  error estimate for blocks of size 2^( 7) =       0.000468729180

      target function =                  N/A
              le_mean =     -16.906445596377
             les_mean =     286.162078223435
             stat err =       0.000455530700
             autocorr =       1.290218717712
              std dev =       0.567153974165
             le_variance =       0.321663630411

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321657736766
                                         uncertainty =       0.002002976073

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321657736766
                                         uncertainty =       0.002002976073

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401038421
  error estimate for blocks of size 2^( 2) =       0.000413589901
  error estimate for blocks of size 2^( 3) =       0.000427387958
  error estimate for blocks of size 2^( 4) =       0.000440468896
  error estimate for blocks of size 2^( 5) =       0.000451237258
  error estimate for blocks of size 2^( 6) =       0.000461687464
  error estimate for blocks of size 2^( 7) =       0.000468729180

      target function =                  N/A
              le_mean =     -16.906445596391
             les_mean =     286.162078235505
             stat err =       0.000455530700
             autocorr =       1.290218718112
              std dev =       0.567153974166
             le_variance =       0.321663630412


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906445596393        initial  <--
     3.8147e+05     3.8147e+06             2.2712e-09       -16.906445596361
     1.5259e+06     1.5259e+07             5.6779e-10       -16.906445596377
     6.1035e+06     6.1035e+07             1.4195e-10       -16.906445596391

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0520
  </log>
  <optVariables href="H2O.s024.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8201e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8592
    reference variance = 0.299105
====================================================
  Execution time = 2.1278e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4644e-01
  Total weights = 1.951804651e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329487073477
                                         uncertainty =       0.004069141690

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329487073477
                                         uncertainty =       0.004069141690

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405919352
  error estimate for blocks of size 2^( 2) =       0.000418914037
  error estimate for blocks of size 2^( 3) =       0.000431871135
  error estimate for blocks of size 2^( 4) =       0.000444931418
  error estimate for blocks of size 2^( 5) =       0.000455174881
  error estimate for blocks of size 2^( 6) =       0.000464025766
  error estimate for blocks of size 2^( 7) =       0.000469536313

      target function =                  N/A
              le_mean =     -16.905476851798
             les_mean =     286.141584982214
             stat err =       0.000458417095
             autocorr =       1.275387320525
              std dev =       0.574056653138
             le_variance =       0.329541041012


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690547685180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905476851778       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905476851780       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905476851780       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905476851840       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905476851776       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905476845779       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905476851305       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905476852115       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905476855421       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905476857743       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+06 is 9.471518e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905476851778       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905476851778       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905476851778       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905476851297       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905476847863       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905476853124       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905476848212       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905476849791       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905476847049       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905476856667       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+07 is 2.367879e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905476851778       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905476851778       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905476851778       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905476851778       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905476862764       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905476823618       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905476905062       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905476848573       residual = 5.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905476882517       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905476862421       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 6.1035e+07 is 5.919706e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.319407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7369e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8512
    reference variance = 0.249453
====================================================
  Execution time = 2.1084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3728e-01
  Total weights = 1.9515e+06
  Execution time = 1.8754e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323035729160
                                         uncertainty =       0.002706003014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323035729160
                                         uncertainty =       0.002706003014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401930518
  error estimate for blocks of size 2^( 2) =       0.000414820339
  error estimate for blocks of size 2^( 3) =       0.000428334049
  error estimate for blocks of size 2^( 4) =       0.000440429274
  error estimate for blocks of size 2^( 5) =       0.000451642021
  error estimate for blocks of size 2^( 6) =       0.000458605159
  error estimate for blocks of size 2^( 7) =       0.000464072591

      target function =                  N/A
              le_mean =     -16.906029199969
             les_mean =     286.151102105012
             stat err =       0.000453687261
             autocorr =       1.274122560529
              std dev =       0.568415589060
             le_variance =       0.323096281886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323035729139
                                         uncertainty =       0.002706003012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323035729139
                                         uncertainty =       0.002706003012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401930518
  error estimate for blocks of size 2^( 2) =       0.000414820339
  error estimate for blocks of size 2^( 3) =       0.000428334049
  error estimate for blocks of size 2^( 4) =       0.000440429274
  error estimate for blocks of size 2^( 5) =       0.000451642021
  error estimate for blocks of size 2^( 6) =       0.000458605159
  error estimate for blocks of size 2^( 7) =       0.000464072591

      target function =                  N/A
              le_mean =     -16.906029199970
             les_mean =     286.151102104819
             stat err =       0.000453687261
             autocorr =       1.274122560538
              std dev =       0.568415589042
             le_variance =       0.323096281866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323035729149
                                         uncertainty =       0.002706003013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323035729149
                                         uncertainty =       0.002706003013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401930518
  error estimate for blocks of size 2^( 2) =       0.000414820339
  error estimate for blocks of size 2^( 3) =       0.000428334049
  error estimate for blocks of size 2^( 4) =       0.000440429274
  error estimate for blocks of size 2^( 5) =       0.000451642021
  error estimate for blocks of size 2^( 6) =       0.000458605159
  error estimate for blocks of size 2^( 7) =       0.000464072591

      target function =                  N/A
              le_mean =     -16.906029199969
             les_mean =     286.151102104916
             stat err =       0.000453687261
             autocorr =       1.274122560530
              std dev =       0.568415589051
             le_variance =       0.323096281876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323035729158
                                         uncertainty =       0.002706003014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323035729158
                                         uncertainty =       0.002706003014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401930518
  error estimate for blocks of size 2^( 2) =       0.000414820339
  error estimate for blocks of size 2^( 3) =       0.000428334049
  error estimate for blocks of size 2^( 4) =       0.000440429274
  error estimate for blocks of size 2^( 5) =       0.000451642021
  error estimate for blocks of size 2^( 6) =       0.000458605159
  error estimate for blocks of size 2^( 7) =       0.000464072591

      target function =                  N/A
              le_mean =     -16.906029199969
             les_mean =     286.151102105000
             stat err =       0.000453687261
             autocorr =       1.274122560525
              std dev =       0.568415589059
             le_variance =       0.323096281885


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906029199969        initial
     3.8147e+06     3.8147e+07             9.4715e-11       -16.906029199970  <--
     1.5259e+07     1.5259e+08             2.3679e-11       -16.906029199969
     6.1035e+07     6.1035e+08             5.9197e-12       -16.906029199969

*****************************************************************************
Applying the update for shift_i =   3.8147e+06     and shift_s =   3.8147e+07
*****************************************************************************

  Execution time = 3.0562e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7938e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9485
    reference variance = 0.364249
====================================================
  Execution time = 2.3747e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3193e-01
  Total weights = 1.951661721e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319434770026
                                         uncertainty =       0.002225677745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319434770026
                                         uncertainty =       0.002225677745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399670193
  error estimate for blocks of size 2^( 2) =       0.000412062796
  error estimate for blocks of size 2^( 3) =       0.000425084263
  error estimate for blocks of size 2^( 4) =       0.000436417062
  error estimate for blocks of size 2^( 5) =       0.000445846259
  error estimate for blocks of size 2^( 6) =       0.000452962235
  error estimate for blocks of size 2^( 7) =       0.000459153197

      target function =                  N/A
              le_mean =     -16.905901714785
             les_mean =     286.141440236535
             stat err =       0.000448594688
             autocorr =       1.259809074575
              std dev =       0.565219007801
             le_variance =       0.319472526780


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590171479e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905901714781       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905901714789       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905901714787       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905901714787       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905901715111       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905901713967       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905901715164       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905901715119       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905901713794       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905901715930       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+05 is 3.600224e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905901714781       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905901714783       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905901714783       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905901714783       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905901714350       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905901720469       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905901715204       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905901717659       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905901713644       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905901727179       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+06 is 9.000564e-11

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905901714781       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905901714782       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905901714782       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905901714781       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905901714896       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905901718138       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905901718376       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905901717077       residual = 5.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905901711046       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905901713787       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+07 is 2.250143e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.323328 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9943e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115235e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203962e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9276
    reference variance = 0.293718
====================================================
  Execution time = 2.1032e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4032e-01
  Total weights = 1.9516e+06
  Execution time = 1.8934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326962180540
                                         uncertainty =       0.002814780507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326962180540
                                         uncertainty =       0.002814780507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404303812
  error estimate for blocks of size 2^( 2) =       0.000416745903
  error estimate for blocks of size 2^( 3) =       0.000430133136
  error estimate for blocks of size 2^( 4) =       0.000442915124
  error estimate for blocks of size 2^( 5) =       0.000454931062
  error estimate for blocks of size 2^( 6) =       0.000464257805
  error estimate for blocks of size 2^( 7) =       0.000467471845

      target function =                  N/A
              le_mean =     -16.905985854102
             les_mean =     286.152678659099
             stat err =       0.000457393959
             autocorr =       1.279867983301
              std dev =       0.571771934830
             le_variance =       0.326923145459

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326962180873
                                         uncertainty =       0.002814780519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326962180873
                                         uncertainty =       0.002814780519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404303813
  error estimate for blocks of size 2^( 2) =       0.000416745903
  error estimate for blocks of size 2^( 3) =       0.000430133137
  error estimate for blocks of size 2^( 4) =       0.000442915124
  error estimate for blocks of size 2^( 5) =       0.000454931062
  error estimate for blocks of size 2^( 6) =       0.000464257805
  error estimate for blocks of size 2^( 7) =       0.000467471845

      target function =                  N/A
              le_mean =     -16.905985854099
             les_mean =     286.152678660796
             stat err =       0.000457393959
             autocorr =       1.279867982911
              std dev =       0.571771935120
             le_variance =       0.326923145791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326962180706
                                         uncertainty =       0.002814780513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326962180706
                                         uncertainty =       0.002814780513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404303813
  error estimate for blocks of size 2^( 2) =       0.000416745903
  error estimate for blocks of size 2^( 3) =       0.000430133136
  error estimate for blocks of size 2^( 4) =       0.000442915124
  error estimate for blocks of size 2^( 5) =       0.000454931062
  error estimate for blocks of size 2^( 6) =       0.000464257805
  error estimate for blocks of size 2^( 7) =       0.000467471845

      target function =                  N/A
              le_mean =     -16.905985854100
             les_mean =     286.152678659947
             stat err =       0.000457393959
             autocorr =       1.279867983107
              std dev =       0.571771934975
             le_variance =       0.326923145625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326962180561
                                         uncertainty =       0.002814780508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326962180561
                                         uncertainty =       0.002814780508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404303812
  error estimate for blocks of size 2^( 2) =       0.000416745903
  error estimate for blocks of size 2^( 3) =       0.000430133136
  error estimate for blocks of size 2^( 4) =       0.000442915124
  error estimate for blocks of size 2^( 5) =       0.000454931062
  error estimate for blocks of size 2^( 6) =       0.000464257805
  error estimate for blocks of size 2^( 7) =       0.000467471845

      target function =                  N/A
              le_mean =     -16.905985854102
             les_mean =     286.152678659205
             stat err =       0.000457393959
             autocorr =       1.279867983275
              std dev =       0.571771934848
             le_variance =       0.326923145480


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905985854102        initial  <--
     9.5367e+05     9.5367e+06             3.6002e-10       -16.905985854099
     3.8147e+06     3.8147e+07             9.0006e-11       -16.905985854100
     1.5259e+07     1.5259e+08             2.2501e-11       -16.905985854102

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4930
  </log>
  <optVariables href="H2O.s026.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8989
    reference variance = 0.22857
====================================================
  Execution time = 2.1540e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3682e-01
  Total weights = 1.951918698e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0993e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325921801728
                                         uncertainty =       0.001981315386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325921801728
                                         uncertainty =       0.001981315386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403702872
  error estimate for blocks of size 2^( 2) =       0.000416734096
  error estimate for blocks of size 2^( 3) =       0.000429662399
  error estimate for blocks of size 2^( 4) =       0.000441668833
  error estimate for blocks of size 2^( 5) =       0.000452456665
  error estimate for blocks of size 2^( 6) =       0.000460565993
  error estimate for blocks of size 2^( 7) =       0.000465587663

      target function =                  N/A
              le_mean =     -16.906365314481
             les_mean =     286.162012528031
             stat err =       0.000455069788
             autocorr =       1.270668696843
              std dev =       0.570922076135
             le_variance =       0.325952017018


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690636531448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365314487       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906365314487       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906365314487       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365314487       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365314487       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365310592       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365306943       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906365309778       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906365309151       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906365309337       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+06 is 3.037131e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365314487       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906365314487       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906365314487       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365314487       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365325713       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365308317       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365301292       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906365331267       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906365343019       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906365324104       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+07 is 7.592831e-12

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906365314487       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906365314487       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906365314487       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906365291969       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365319214       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906365324079       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906365211788       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906365411674       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906365350661       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906365471138       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+08 is 1.898190e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.327249 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7652e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203962e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8491
    reference variance = 0.349997
====================================================
  Execution time = 2.1434e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3114e-01
  Total weights = 1.9516e+06
  Execution time = 1.9280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320861786654
                                         uncertainty =       0.002189240394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320861786654
                                         uncertainty =       0.002189240394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400501052
  error estimate for blocks of size 2^( 2) =       0.000413585555
  error estimate for blocks of size 2^( 3) =       0.000427193431
  error estimate for blocks of size 2^( 4) =       0.000439804104
  error estimate for blocks of size 2^( 5) =       0.000449969934
  error estimate for blocks of size 2^( 6) =       0.000457717652
  error estimate for blocks of size 2^( 7) =       0.000462366550

      target function =                  N/A
              le_mean =     -16.906173625748
             les_mean =     286.149846783522
             stat err =       0.000452464560
             autocorr =       1.276326584845
              std dev =       0.566394018801
             le_variance =       0.320802184533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320861786655
                                         uncertainty =       0.002189240396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320861786655
                                         uncertainty =       0.002189240396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400501052
  error estimate for blocks of size 2^( 2) =       0.000413585555
  error estimate for blocks of size 2^( 3) =       0.000427193431
  error estimate for blocks of size 2^( 4) =       0.000439804104
  error estimate for blocks of size 2^( 5) =       0.000449969934
  error estimate for blocks of size 2^( 6) =       0.000457717652
  error estimate for blocks of size 2^( 7) =       0.000462366550

      target function =                  N/A
              le_mean =     -16.906173625748
             les_mean =     286.149846783528
             stat err =       0.000452464560
             autocorr =       1.276326584827
              std dev =       0.566394018802
             le_variance =       0.320802184535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320861786654
                                         uncertainty =       0.002189240395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320861786654
                                         uncertainty =       0.002189240395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400501052
  error estimate for blocks of size 2^( 2) =       0.000413585555
  error estimate for blocks of size 2^( 3) =       0.000427193431
  error estimate for blocks of size 2^( 4) =       0.000439804104
  error estimate for blocks of size 2^( 5) =       0.000449969934
  error estimate for blocks of size 2^( 6) =       0.000457717652
  error estimate for blocks of size 2^( 7) =       0.000462366550

      target function =                  N/A
              le_mean =     -16.906173625748
             les_mean =     286.149846783525
             stat err =       0.000452464560
             autocorr =       1.276326584839
              std dev =       0.566394018802
             le_variance =       0.320802184534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320861786654
                                         uncertainty =       0.002189240394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320861786654
                                         uncertainty =       0.002189240394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400501052
  error estimate for blocks of size 2^( 2) =       0.000413585555
  error estimate for blocks of size 2^( 3) =       0.000427193431
  error estimate for blocks of size 2^( 4) =       0.000439804104
  error estimate for blocks of size 2^( 5) =       0.000449969934
  error estimate for blocks of size 2^( 6) =       0.000457717652
  error estimate for blocks of size 2^( 7) =       0.000462366550

      target function =                  N/A
              le_mean =     -16.906173625748
             les_mean =     286.149846783523
             stat err =       0.000452464560
             autocorr =       1.276326584845
              std dev =       0.566394018801
             le_variance =       0.320802184533


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906173625748        initial  <--
     9.5367e+06     9.5367e+07             3.0371e-11       -16.906173625748
     3.8147e+07     3.8147e+08             7.5928e-12       -16.906173625748
     1.5259e+08     1.5259e+09             1.8982e-12       -16.906173625748

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.1203
  </log>
  <optVariables href="H2O.s027.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8779e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.924
    reference variance = 0.243542
====================================================
  Execution time = 2.1154e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3659e-01
  Total weights = 1.951510553e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321917858300
                                         uncertainty =       0.002083223920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321917858300
                                         uncertainty =       0.002083223920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401202760
  error estimate for blocks of size 2^( 2) =       0.000413945330
  error estimate for blocks of size 2^( 3) =       0.000427743774
  error estimate for blocks of size 2^( 4) =       0.000439959814
  error estimate for blocks of size 2^( 5) =       0.000450831828
  error estimate for blocks of size 2^( 6) =       0.000458581925
  error estimate for blocks of size 2^( 7) =       0.000459223467

      target function =                  N/A
              le_mean =     -16.907085655099
             les_mean =     286.186131381334
             stat err =       0.000452149258
             autocorr =       1.270093877463
              std dev =       0.567386383786
             le_variance =       0.321927308506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690708565510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907085655110       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907085655110       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907085655110       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907085655110       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907085655110       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907085655110       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907085704338       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907085679118       residual = 2.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907085598328       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907085603603       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+07 is 4.106778e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907085655110       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907085655110       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907085655110       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907085655110       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907085655110       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907085709142       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907085742533       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907085713899       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907086237327       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907086099233       residual = 1.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+08 is 1.026747e-12

solving harmonic davidson linear method for identity shift 1.5259e+09, overlap shift 1.5259e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907085655110       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907085655110       residual = 7.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907085655110       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907085684667       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907085759596       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907085861822       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907085582256       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907086584831       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907087612856       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907085160878       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.5259e+09 is 2.567200e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7276e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8749
    reference variance = 0.293795
====================================================
  Execution time = 2.0828e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3367e-01
  Total weights = 1.9517e+06
  Execution time = 1.9091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741240904
                                         uncertainty =       0.001949739491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741240904
                                         uncertainty =       0.001949739491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401680590
  error estimate for blocks of size 2^( 2) =       0.000414690523
  error estimate for blocks of size 2^( 3) =       0.000427938254
  error estimate for blocks of size 2^( 4) =       0.000440740413
  error estimate for blocks of size 2^( 5) =       0.000451318629
  error estimate for blocks of size 2^( 6) =       0.000457602298
  error estimate for blocks of size 2^( 7) =       0.000461637723

      target function =                  N/A
              le_mean =     -16.905377205538
             les_mean =     286.125451451771
             stat err =       0.000452824766
             autocorr =       1.270862746949
              std dev =       0.568062138457
             le_variance =       0.322694593148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741240902
                                         uncertainty =       0.001949739491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741240902
                                         uncertainty =       0.001949739491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401680590
  error estimate for blocks of size 2^( 2) =       0.000414690523
  error estimate for blocks of size 2^( 3) =       0.000427938254
  error estimate for blocks of size 2^( 4) =       0.000440740413
  error estimate for blocks of size 2^( 5) =       0.000451318629
  error estimate for blocks of size 2^( 6) =       0.000457602298
  error estimate for blocks of size 2^( 7) =       0.000461637723

      target function =                  N/A
              le_mean =     -16.905377205538
             les_mean =     286.125451451666
             stat err =       0.000452824766
             autocorr =       1.270862746953
              std dev =       0.568062138455
             le_variance =       0.322694593146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741240903
                                         uncertainty =       0.001949739491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741240903
                                         uncertainty =       0.001949739491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401680590
  error estimate for blocks of size 2^( 2) =       0.000414690523
  error estimate for blocks of size 2^( 3) =       0.000427938254
  error estimate for blocks of size 2^( 4) =       0.000440740413
  error estimate for blocks of size 2^( 5) =       0.000451318629
  error estimate for blocks of size 2^( 6) =       0.000457602298
  error estimate for blocks of size 2^( 7) =       0.000461637723

      target function =                  N/A
              le_mean =     -16.905377205538
             les_mean =     286.125451451719
             stat err =       0.000452824766
             autocorr =       1.270862746956
              std dev =       0.568062138456
             le_variance =       0.322694593147

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741240904
                                         uncertainty =       0.001949739491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322741240904
                                         uncertainty =       0.001949739491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401680590
  error estimate for blocks of size 2^( 2) =       0.000414690523
  error estimate for blocks of size 2^( 3) =       0.000427938254
  error estimate for blocks of size 2^( 4) =       0.000440740413
  error estimate for blocks of size 2^( 5) =       0.000451318629
  error estimate for blocks of size 2^( 6) =       0.000457602298
  error estimate for blocks of size 2^( 7) =       0.000461637723

      target function =                  N/A
              le_mean =     -16.905377205538
             les_mean =     286.125451451765
             stat err =       0.000452824766
             autocorr =       1.270862746952
              std dev =       0.568062138456
             le_variance =       0.322694593148


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905377205538        initial
     9.5367e+07     9.5367e+08             4.1068e-12       -16.905377205538  <--
     3.8147e+08     3.8147e+09             1.0267e-12       -16.905377205538
     1.5259e+09     1.5259e+10             2.5672e-13       -16.905377205538

*****************************************************************************
Applying the update for shift_i =   9.5367e+07     and shift_s =   9.5367e+08
*****************************************************************************

  Execution time = 3.0487e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7770e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8979
    reference variance = 0.329606
====================================================
  Execution time = 2.1215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5223e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4469e-01
  Total weights = 1.951727263e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.2104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332440093160
                                         uncertainty =       0.005354454612

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332440093160
                                         uncertainty =       0.005354454612

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407657420
  error estimate for blocks of size 2^( 2) =       0.000420580018
  error estimate for blocks of size 2^( 3) =       0.000433850317
  error estimate for blocks of size 2^( 4) =       0.000446163208
  error estimate for blocks of size 2^( 5) =       0.000456862845
  error estimate for blocks of size 2^( 6) =       0.000465308773
  error estimate for blocks of size 2^( 7) =       0.000470019279

      target function =                  N/A
              le_mean =     -16.905852626163
             les_mean =     286.152544047909
             stat err =       0.000459588526
             autocorr =       1.271006151016
              std dev =       0.576514652384
             le_variance =       0.332369144414


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690585262616e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905852626142       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905852626142       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905852626142       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905852626142       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905852623681       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905852629533       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905852625826       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905852624417       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905852596767       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905852631684       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+07 is 1.762317e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905852626142       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905852626142       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905852626142       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905852626142       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905852581368       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905852732091       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905852683423       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905852602264       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905852551719       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905852685832       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+07 is 4.405738e-12

solving harmonic davidson linear method for identity shift 3.8147e+08, overlap shift 3.8147e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905852626142       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905852626142       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905852626142       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905852626142       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905852699559       residual = 8.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905852626598       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905852940345       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905852800346       residual = 5.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905852371925       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905852700808       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+08 is 1.101480e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.335080 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7439e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8706
    reference variance = 0.229863
====================================================
  Execution time = 2.1129e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4111e-01
  Total weights = 1.9516e+06
  Execution time = 1.9094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323925615330
                                         uncertainty =       0.002624545407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323925615330
                                         uncertainty =       0.002624545407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402475910
  error estimate for blocks of size 2^( 2) =       0.000415084949
  error estimate for blocks of size 2^( 3) =       0.000428155317
  error estimate for blocks of size 2^( 4) =       0.000440654682
  error estimate for blocks of size 2^( 5) =       0.000450789813
  error estimate for blocks of size 2^( 6) =       0.000458095301
  error estimate for blocks of size 2^( 7) =       0.000463773840

      target function =                  N/A
              le_mean =     -16.906080544947
             les_mean =     286.156670938112
             stat err =       0.000453328409
             autocorr =       1.268662461970
              std dev =       0.569186890510
             le_variance =       0.323973716329

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323925615326
                                         uncertainty =       0.002624545404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323925615326
                                         uncertainty =       0.002624545404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402475910
  error estimate for blocks of size 2^( 2) =       0.000415084949
  error estimate for blocks of size 2^( 3) =       0.000428155317
  error estimate for blocks of size 2^( 4) =       0.000440654682
  error estimate for blocks of size 2^( 5) =       0.000450789813
  error estimate for blocks of size 2^( 6) =       0.000458095300
  error estimate for blocks of size 2^( 7) =       0.000463773840

      target function =                  N/A
              le_mean =     -16.906080544947
             les_mean =     286.156670937740
             stat err =       0.000453328409
             autocorr =       1.268662461967
              std dev =       0.569186890507
             le_variance =       0.323973716325

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323925615328
                                         uncertainty =       0.002624545405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323925615328
                                         uncertainty =       0.002624545405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402475910
  error estimate for blocks of size 2^( 2) =       0.000415084949
  error estimate for blocks of size 2^( 3) =       0.000428155317
  error estimate for blocks of size 2^( 4) =       0.000440654682
  error estimate for blocks of size 2^( 5) =       0.000450789813
  error estimate for blocks of size 2^( 6) =       0.000458095300
  error estimate for blocks of size 2^( 7) =       0.000463773840

      target function =                  N/A
              le_mean =     -16.906080544947
             les_mean =     286.156670937926
             stat err =       0.000453328409
             autocorr =       1.268662461971
              std dev =       0.569186890509
             le_variance =       0.323973716327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323925615329
                                         uncertainty =       0.002624545407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323925615329
                                         uncertainty =       0.002624545407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402475910
  error estimate for blocks of size 2^( 2) =       0.000415084949
  error estimate for blocks of size 2^( 3) =       0.000428155317
  error estimate for blocks of size 2^( 4) =       0.000440654682
  error estimate for blocks of size 2^( 5) =       0.000450789813
  error estimate for blocks of size 2^( 6) =       0.000458095300
  error estimate for blocks of size 2^( 7) =       0.000463773840

      target function =                  N/A
              le_mean =     -16.906080544947
             les_mean =     286.156670938089
             stat err =       0.000453328409
             autocorr =       1.268662461975
              std dev =       0.569186890510
             le_variance =       0.323973716329


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906080544947        initial  <--
     2.3842e+07     2.3842e+08             1.7623e-11       -16.906080544947
     9.5367e+07     9.5367e+08             4.4057e-12       -16.906080544947
     3.8147e+08     3.8147e+09             1.1015e-12       -16.906080544947

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7947
  </log>
  <optVariables href="H2O.s029.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8240e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8762
    reference variance = 0.186505
====================================================
  Execution time = 2.1404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5246e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3206e-01
  Total weights = 1.951666103e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320365163859
                                         uncertainty =       0.002360816689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320365163859
                                         uncertainty =       0.002360816689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400286718
  error estimate for blocks of size 2^( 2) =       0.000412687056
  error estimate for blocks of size 2^( 3) =       0.000425626262
  error estimate for blocks of size 2^( 4) =       0.000438146059
  error estimate for blocks of size 2^( 5) =       0.000448724578
  error estimate for blocks of size 2^( 6) =       0.000457456267
  error estimate for blocks of size 2^( 7) =       0.000461537186

      target function =                  N/A
              le_mean =     -16.906498198087
             les_mean =     286.161744996891
             stat err =       0.000451466023
             autocorr =       1.272060543592
              std dev =       0.566090905319
             le_variance =       0.320458913085


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649819809e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498198085       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498198085       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498198085       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498198085       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498177297       residual = 5.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498196061       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906498198088       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498003177       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906498126994       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906498165425       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+08 is 2.404308e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498198085       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498198085       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498198085       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498198085       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906498014975       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498383765       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906497486853       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906497695227       residual = 4.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906498260293       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906498472543       residual = 3.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+08 is 6.010740e-13

solving harmonic davidson linear method for identity shift 3.8147e+09, overlap shift 3.8147e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906498198085       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906498198085       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906498198085       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906498198085       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906497365422       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906498600539       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906497064360       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906498375207       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906498068253       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906497381907       residual = 3.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+09 is 1.502685e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.338975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7481e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9196
    reference variance = 0.317659
====================================================
  Execution time = 2.0976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3520e-01
  Total weights = 1.9513e+06
  Execution time = 1.9034e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324024110739
                                         uncertainty =       0.002984289008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324024110739
                                         uncertainty =       0.002984289008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402491962
  error estimate for blocks of size 2^( 2) =       0.000415108569
  error estimate for blocks of size 2^( 3) =       0.000427916341
  error estimate for blocks of size 2^( 4) =       0.000440359349
  error estimate for blocks of size 2^( 5) =       0.000450852702
  error estimate for blocks of size 2^( 6) =       0.000457371021
  error estimate for blocks of size 2^( 7) =       0.000461906830

      target function =                  N/A
              le_mean =     -16.905363383698
             les_mean =     286.126508208770
             stat err =       0.000452622475
             autocorr =       1.264613481510
              std dev =       0.569209591493
             le_variance =       0.323999559048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324024110741
                                         uncertainty =       0.002984289009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324024110741
                                         uncertainty =       0.002984289009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402491962
  error estimate for blocks of size 2^( 2) =       0.000415108569
  error estimate for blocks of size 2^( 3) =       0.000427916341
  error estimate for blocks of size 2^( 4) =       0.000440359349
  error estimate for blocks of size 2^( 5) =       0.000450852702
  error estimate for blocks of size 2^( 6) =       0.000457371021
  error estimate for blocks of size 2^( 7) =       0.000461906830

      target function =                  N/A
              le_mean =     -16.905363383698
             les_mean =     286.126508208770
             stat err =       0.000452622475
             autocorr =       1.264613481504
              std dev =       0.569209591495
             le_variance =       0.323999559050

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324024110740
                                         uncertainty =       0.002984289008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324024110740
                                         uncertainty =       0.002984289008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402491962
  error estimate for blocks of size 2^( 2) =       0.000415108569
  error estimate for blocks of size 2^( 3) =       0.000427916341
  error estimate for blocks of size 2^( 4) =       0.000440359349
  error estimate for blocks of size 2^( 5) =       0.000450852702
  error estimate for blocks of size 2^( 6) =       0.000457371021
  error estimate for blocks of size 2^( 7) =       0.000461906830

      target function =                  N/A
              le_mean =     -16.905363383698
             les_mean =     286.126508208770
             stat err =       0.000452622475
             autocorr =       1.264613481503
              std dev =       0.569209591494
             le_variance =       0.323999559049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324024110739
                                         uncertainty =       0.002984289008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324024110739
                                         uncertainty =       0.002984289008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402491962
  error estimate for blocks of size 2^( 2) =       0.000415108569
  error estimate for blocks of size 2^( 3) =       0.000427916341
  error estimate for blocks of size 2^( 4) =       0.000440359349
  error estimate for blocks of size 2^( 5) =       0.000450852702
  error estimate for blocks of size 2^( 6) =       0.000457371021
  error estimate for blocks of size 2^( 7) =       0.000461906830

      target function =                  N/A
              le_mean =     -16.905363383698
             les_mean =     286.126508208770
             stat err =       0.000452622475
             autocorr =       1.264613481511
              std dev =       0.569209591493
             le_variance =       0.323999559048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905363383698        initial  <--
     2.3842e+08     2.3842e+09             2.4043e-12       -16.905363383698
     9.5367e+08     9.5367e+09             6.0107e-13       -16.905363383698
     3.8147e+09     3.8147e+10             1.5027e-13       -16.905363383698

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6113
  </log>
  <optVariables href="H2O.s030.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8099e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9313
    reference variance = 0.260789
====================================================
  Execution time = 2.3233e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4299e-01
  Total weights = 1.951446362e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328222553442
                                         uncertainty =       0.006173571175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328222553442
                                         uncertainty =       0.006173571175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405042859
  error estimate for blocks of size 2^( 2) =       0.000417808491
  error estimate for blocks of size 2^( 3) =       0.000430272869
  error estimate for blocks of size 2^( 4) =       0.000441767945
  error estimate for blocks of size 2^( 5) =       0.000451471779
  error estimate for blocks of size 2^( 6) =       0.000458081943
  error estimate for blocks of size 2^( 7) =       0.000460669375

      target function =                  N/A
              le_mean =     -16.906926993140
             les_mean =     286.187171042093
             stat err =       0.000452997761
             autocorr =       1.250806559872
              std dev =       0.572817104590
             le_variance =       0.328119435311


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690692699314e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906926993137       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906926993137       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906926993137       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906926993137       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906926283129       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906925772938       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906926189967       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906927156714       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906926542799       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906925253659       residual = 4.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+09 is 1.429101e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906926993137       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906926993137       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906926993137       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906926993137       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906928002864       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906926993137       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906932884493       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906929384699       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906933600877       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906921922938       residual = 9.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+09 is 3.578809e-14

solving harmonic davidson linear method for identity shift 3.8147e+10, overlap shift 3.8147e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906926993137       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906926993137       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906926993137       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906968526637       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906915524855       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906818113352       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906966914019       residual = 4.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906942175648       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906926581546       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906973897041       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906864726143       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906923030093       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.907089669229       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906797710027       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907037059526       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906547431634       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906811678027       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906618230636       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907843074897       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907194222574       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.904762323545       residual = 6.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.907932771029       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905761135934       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906325716978       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.909056760666       residual = 6.13e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.905137645271       residual = 4.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.907563080284       residual = 5.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.907749416073       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906916983580       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.907585954380       residual = 6.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.907501534761       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.906491872211       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.907632301239       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.905951688109       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.907356541802       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.908937727091       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.907302218078       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.902647954955       residual = 2.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.903926413838       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.905645642305       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.908186810743       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.901452280794       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.904850563534       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.906814555385       residual = 8.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.909577510023       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.900633577311       residual = 4.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.909403374106       residual = 7.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.905991308061       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.907226626507       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.907291218971       residual = 9.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.911304355849       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.897285387446       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.905576564608       residual = 6.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.911004214771       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.912442008716       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.903976574114       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.904197183583       residual = 9.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.912265104984       residual = 4.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.907345987320       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.904639048619       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.907101383908       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.908960246372       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.908321479040       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   energy =     -16.907648985746       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   energy =     -16.906850247617       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   energy =     -16.904726784292       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   energy =     -16.907071481649       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   energy =     -16.900746080416       residual = 4.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   energy =     -16.897362514873       residual = 1.45e-02           smallest_sin_value = 9.99e-01
davidson iteration   69:   krylov dim =  70   energy =     -16.906524811576       residual = 2.82e-04           smallest_sin_value = 9.99e-01
davidson iteration   70:   krylov dim =  71   energy =     -16.923497718660       residual = 3.60e-02           smallest_sin_value = 9.96e-01
davidson iteration   71:   krylov dim =  72   energy =     -16.910233582652       residual = 2.60e-03           smallest_sin_value = 9.96e-01
davidson iteration   72:   krylov dim =  73   energy =     -16.904526872202       residual = 9.65e-04           smallest_sin_value = 9.94e-01
davidson iteration   73:   krylov dim =  74   energy =     -16.905187387761       residual = 6.77e-04           smallest_sin_value = 9.90e-01
davidson iteration   74 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         74 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 3.8147e+10 is 9.004472e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.578066 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9621e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8324
    reference variance = 0.24918
====================================================
  Execution time = 2.1273e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3893e-01
  Total weights = 1.9518e+06
  Execution time = 1.9083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324488700887
                                         uncertainty =       0.002672911507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324488700887
                                         uncertainty =       0.002672911507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402748794
  error estimate for blocks of size 2^( 2) =       0.000415383248
  error estimate for blocks of size 2^( 3) =       0.000428188780
  error estimate for blocks of size 2^( 4) =       0.000439528727
  error estimate for blocks of size 2^( 5) =       0.000448610592
  error estimate for blocks of size 2^( 6) =       0.000453719589
  error estimate for blocks of size 2^( 7) =       0.000457626804

      target function =                  N/A
              le_mean =     -16.906238096166
             les_mean =     286.159814264487
             stat err =       0.000449871428
             autocorr =       1.247694687340
              std dev =       0.569572806380
             le_variance =       0.324413181767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324488700887
                                         uncertainty =       0.002672911507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324488700887
                                         uncertainty =       0.002672911507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402748794
  error estimate for blocks of size 2^( 2) =       0.000415383248
  error estimate for blocks of size 2^( 3) =       0.000428188780
  error estimate for blocks of size 2^( 4) =       0.000439528727
  error estimate for blocks of size 2^( 5) =       0.000448610592
  error estimate for blocks of size 2^( 6) =       0.000453719589
  error estimate for blocks of size 2^( 7) =       0.000457626804

      target function =                  N/A
              le_mean =     -16.906238096166
             les_mean =     286.159814264488
             stat err =       0.000449871428
             autocorr =       1.247694687347
              std dev =       0.569572806380
             le_variance =       0.324413181767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324488700887
                                         uncertainty =       0.002672911507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324488700887
                                         uncertainty =       0.002672911507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402748794
  error estimate for blocks of size 2^( 2) =       0.000415383248
  error estimate for blocks of size 2^( 3) =       0.000428188780
  error estimate for blocks of size 2^( 4) =       0.000439528727
  error estimate for blocks of size 2^( 5) =       0.000448610592
  error estimate for blocks of size 2^( 6) =       0.000453719589
  error estimate for blocks of size 2^( 7) =       0.000457626804

      target function =                  N/A
              le_mean =     -16.906238096166
             les_mean =     286.159814264487
             stat err =       0.000449871428
             autocorr =       1.247694687339
              std dev =       0.569572806380
             le_variance =       0.324413181767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324488700887
                                         uncertainty =       0.002672911507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324488700887
                                         uncertainty =       0.002672911507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402748794
  error estimate for blocks of size 2^( 2) =       0.000415383248
  error estimate for blocks of size 2^( 3) =       0.000428188780
  error estimate for blocks of size 2^( 4) =       0.000439528727
  error estimate for blocks of size 2^( 5) =       0.000448610592
  error estimate for blocks of size 2^( 6) =       0.000453719589
  error estimate for blocks of size 2^( 7) =       0.000457626804

      target function =                  N/A
              le_mean =     -16.906238096166
             les_mean =     286.159814264487
             stat err =       0.000449871428
             autocorr =       1.247694687345
              std dev =       0.569572806380
             le_variance =       0.324413181767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906238096166        initial
     2.3842e+09     2.3842e+10             1.4291e-13       -16.906238096166  <--
     9.5367e+09     9.5367e+10             3.5788e-14       -16.906238096166
     3.8147e+10     3.8147e+11             9.0045e-15       -16.906238096166

*****************************************************************************
Applying the update for shift_i =   2.3842e+09     and shift_s =   2.3842e+10
*****************************************************************************

  Execution time = 3.0929e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0557e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9805
    reference variance = 0.232688
====================================================
  Execution time = 2.1404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5249e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3478e-01
  Total weights = 1.951655183e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321610763092
                                         uncertainty =       0.002182140233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321610763092
                                         uncertainty =       0.002182140233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401026297
  error estimate for blocks of size 2^( 2) =       0.000413979024
  error estimate for blocks of size 2^( 3) =       0.000427612453
  error estimate for blocks of size 2^( 4) =       0.000439866408
  error estimate for blocks of size 2^( 5) =       0.000449988941
  error estimate for blocks of size 2^( 6) =       0.000457314120
  error estimate for blocks of size 2^( 7) =       0.000458821690

      target function =                  N/A
              le_mean =     -16.906016082205
             les_mean =     286.148163724646
             stat err =       0.000451497790
             autocorr =       1.267551321111
              std dev =       0.567136828666
             le_variance =       0.321644182429


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601608221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016082195       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906016082195       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016082195       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906016235585       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906015967484       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906015891585       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906015871919       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906015925807       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906016347989       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906015941994       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+08 is 6.894184e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016082195       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906016082195       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016082195       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906016082195       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906016055900       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906016793384       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906015945039       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906016223809       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906016880416       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906015323338       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+09 is 1.723946e-13

solving harmonic davidson linear method for identity shift 9.5367e+09, overlap shift 9.5367e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906016082195       residual = 1.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906016082195       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016082195       residual = 4.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906026868117       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906016082195       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906020080375       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906012222964       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906014358206       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906018380340       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906010860697       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906009719480       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 9.5367e+09 is 4.311364e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.582316 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7530e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9089
    reference variance = 0.317617
====================================================
  Execution time = 2.0969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3584e-01
  Total weights = 1.9521e+06
  Execution time = 1.9029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323898597805
                                         uncertainty =       0.003231635156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323898597805
                                         uncertainty =       0.003231635156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433288
  error estimate for blocks of size 2^( 2) =       0.000415540884
  error estimate for blocks of size 2^( 3) =       0.000428935215
  error estimate for blocks of size 2^( 4) =       0.000441306967
  error estimate for blocks of size 2^( 5) =       0.000450362658
  error estimate for blocks of size 2^( 6) =       0.000458936221
  error estimate for blocks of size 2^( 7) =       0.000462595963

      target function =                  N/A
              le_mean =     -16.906779278730
             les_mean =     286.175026041045
             stat err =       0.000453300452
             autocorr =       1.268774704800
              std dev =       0.569126613301
             le_variance =       0.323905101967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323898597805
                                         uncertainty =       0.003231635156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323898597805
                                         uncertainty =       0.003231635156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433288
  error estimate for blocks of size 2^( 2) =       0.000415540884
  error estimate for blocks of size 2^( 3) =       0.000428935215
  error estimate for blocks of size 2^( 4) =       0.000441306967
  error estimate for blocks of size 2^( 5) =       0.000450362658
  error estimate for blocks of size 2^( 6) =       0.000458936221
  error estimate for blocks of size 2^( 7) =       0.000462595963

      target function =                  N/A
              le_mean =     -16.906779278730
             les_mean =     286.175026041044
             stat err =       0.000453300452
             autocorr =       1.268774704794
              std dev =       0.569126613301
             le_variance =       0.323905101967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323898597805
                                         uncertainty =       0.003231635156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323898597805
                                         uncertainty =       0.003231635156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433288
  error estimate for blocks of size 2^( 2) =       0.000415540884
  error estimate for blocks of size 2^( 3) =       0.000428935215
  error estimate for blocks of size 2^( 4) =       0.000441306967
  error estimate for blocks of size 2^( 5) =       0.000450362658
  error estimate for blocks of size 2^( 6) =       0.000458936221
  error estimate for blocks of size 2^( 7) =       0.000462595963

      target function =                  N/A
              le_mean =     -16.906779278730
             les_mean =     286.175026041044
             stat err =       0.000453300452
             autocorr =       1.268774704800
              std dev =       0.569126613301
             le_variance =       0.323905101967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323898597805
                                         uncertainty =       0.003231635156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323898597805
                                         uncertainty =       0.003231635156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402433288
  error estimate for blocks of size 2^( 2) =       0.000415540884
  error estimate for blocks of size 2^( 3) =       0.000428935215
  error estimate for blocks of size 2^( 4) =       0.000441306967
  error estimate for blocks of size 2^( 5) =       0.000450362658
  error estimate for blocks of size 2^( 6) =       0.000458936221
  error estimate for blocks of size 2^( 7) =       0.000462595963

      target function =                  N/A
              le_mean =     -16.906779278730
             les_mean =     286.175026041045
             stat err =       0.000453300452
             autocorr =       1.268774704801
              std dev =       0.569126613301
             le_variance =       0.323905101967


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906779278730        initial
     5.9605e+08     5.9605e+09             6.8942e-13       -16.906779278730  <--
     2.3842e+09     2.3842e+10             1.7239e-13       -16.906779278730
     9.5367e+09     9.5367e+10             4.3114e-14       -16.906779278730

*****************************************************************************
Applying the update for shift_i =   5.9605e+08     and shift_s =   5.9605e+09
*****************************************************************************

  Execution time = 3.0593e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8130e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9411
    reference variance = 0.199386
====================================================
  Execution time = 2.1132e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3514e-01
  Total weights = 1.951393600e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321130369021
                                         uncertainty =       0.002238518323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321130369021
                                         uncertainty =       0.002238518323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400667789
  error estimate for blocks of size 2^( 2) =       0.000413340077
  error estimate for blocks of size 2^( 3) =       0.000426316842
  error estimate for blocks of size 2^( 4) =       0.000439018334
  error estimate for blocks of size 2^( 5) =       0.000448867220
  error estimate for blocks of size 2^( 6) =       0.000458077432
  error estimate for blocks of size 2^( 7) =       0.000462606232

      target function =                  N/A
              le_mean =     -16.906075071907
             les_mean =     286.150517291770
             stat err =       0.000452142305
             autocorr =       1.273448625220
              std dev =       0.566629820769
             le_variance =       0.321069353785


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690607507191e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906075071896       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906075071896       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906075071896       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906075090599       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906074999473       residual = 9.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906075071896       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906075062175       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906074916246       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906075028580       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906075087705       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+08 is 4.608174e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906075071896       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906075071896       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906075071896       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906075071896       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906075070777       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906075158601       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906074739331       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906074931371       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906074929915       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906075029071       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+08 is 1.152002e-12

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906075071896       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906075071896       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906075071896       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906075071896       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906075081986       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906074884943       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906075927705       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906074940524       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906074301080       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906074124325       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+09 is 2.879874e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.586298 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7229e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8799
    reference variance = 0.407326
====================================================
  Execution time = 2.1424e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4752e-01
  Total weights = 1.9517e+06
  Execution time = 1.9012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335159696782
                                         uncertainty =       0.011334826494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335159696782
                                         uncertainty =       0.011334826494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409358103
  error estimate for blocks of size 2^( 2) =       0.000421635791
  error estimate for blocks of size 2^( 3) =       0.000434152843
  error estimate for blocks of size 2^( 4) =       0.000446286576
  error estimate for blocks of size 2^( 5) =       0.000456039893
  error estimate for blocks of size 2^( 6) =       0.000463602965
  error estimate for blocks of size 2^( 7) =       0.000465616029

      target function =                  N/A
              le_mean =     -16.906989823747
             les_mean =     286.193825274579
             stat err =       0.000457886366
             autocorr =       1.251147872401
              std dev =       0.578919780649
             le_variance =       0.335148112427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335159696771
                                         uncertainty =       0.011334826485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335159696771
                                         uncertainty =       0.011334826485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409358103
  error estimate for blocks of size 2^( 2) =       0.000421635791
  error estimate for blocks of size 2^( 3) =       0.000434152842
  error estimate for blocks of size 2^( 4) =       0.000446286576
  error estimate for blocks of size 2^( 5) =       0.000456039893
  error estimate for blocks of size 2^( 6) =       0.000463602965
  error estimate for blocks of size 2^( 7) =       0.000465616029

      target function =                  N/A
              le_mean =     -16.906989823747
             les_mean =     286.193825274566
             stat err =       0.000457886366
             autocorr =       1.251147872401
              std dev =       0.578919780640
             le_variance =       0.335148112416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335159696777
                                         uncertainty =       0.011334826489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335159696777
                                         uncertainty =       0.011334826489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409358103
  error estimate for blocks of size 2^( 2) =       0.000421635791
  error estimate for blocks of size 2^( 3) =       0.000434152843
  error estimate for blocks of size 2^( 4) =       0.000446286576
  error estimate for blocks of size 2^( 5) =       0.000456039893
  error estimate for blocks of size 2^( 6) =       0.000463602965
  error estimate for blocks of size 2^( 7) =       0.000465616029

      target function =                  N/A
              le_mean =     -16.906989823747
             les_mean =     286.193825274573
             stat err =       0.000457886366
             autocorr =       1.251147872406
              std dev =       0.578919780645
             le_variance =       0.335148112422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335159696782
                                         uncertainty =       0.011334826494

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335159696782
                                         uncertainty =       0.011334826494

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409358103
  error estimate for blocks of size 2^( 2) =       0.000421635791
  error estimate for blocks of size 2^( 3) =       0.000434152843
  error estimate for blocks of size 2^( 4) =       0.000446286576
  error estimate for blocks of size 2^( 5) =       0.000456039893
  error estimate for blocks of size 2^( 6) =       0.000463602965
  error estimate for blocks of size 2^( 7) =       0.000465616029

      target function =                  N/A
              le_mean =     -16.906989823747
             les_mean =     286.193825274579
             stat err =       0.000457886366
             autocorr =       1.251147872403
              std dev =       0.578919780649
             le_variance =       0.335148112426


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906989823747        initial  <--
     1.4901e+08     1.4901e+09             4.6082e-12       -16.906989823747
     5.9605e+08     5.9605e+09             1.1520e-12       -16.906989823747
     2.3842e+09     2.3842e+10             2.8799e-13       -16.906989823747

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0388
  </log>
  <optVariables href="H2O.s033.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8275e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8177
    reference variance = 0.442005
====================================================
  Execution time = 2.1522e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3301e-01
  Total weights = 1.951759413e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320819954524
                                         uncertainty =       0.002288140433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320819954524
                                         uncertainty =       0.002288140433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400493641
  error estimate for blocks of size 2^( 2) =       0.000413691308
  error estimate for blocks of size 2^( 3) =       0.000426681120
  error estimate for blocks of size 2^( 4) =       0.000438400010
  error estimate for blocks of size 2^( 5) =       0.000448978739
  error estimate for blocks of size 2^( 6) =       0.000457139576
  error estimate for blocks of size 2^( 7) =       0.000462840163

      target function =                  N/A
              le_mean =     -16.906843114543
             les_mean =     286.174356545590
             stat err =       0.000451839622
             autocorr =       1.272850427770
              std dev =       0.566383539120
             le_variance =       0.320790313387


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690684311454e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906843114551       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906843114551       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906843114551       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906843114551       residual = 7.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906843223387       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906842644799       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906842603475       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906841886827       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906844000297       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906842728442       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+09 is 2.254169e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906843114551       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906843114551       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906843114551       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906843114551       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906843114551       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906842811384       residual = 2.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906843448427       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906842841286       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906836527364       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906842892475       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+09 is 5.637081e-14

solving harmonic davidson linear method for identity shift 2.3842e+10, overlap shift 2.3842e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906843114551       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906843114551       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906843114551       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906843114551       residual = 7.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906838390942       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906839042219       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906845691930       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906858549593       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906832120830       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906848013877       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906856722344       residual = 2.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906836846980       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906891806985       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907003269345       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906520740418       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906516723403       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907092015200       residual = 8.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906725791312       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906864089189       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906505403698       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906784382832       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906561132325       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906493505679       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907021360379       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.908488504084       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906554003453       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906866176533       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.907232034074       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906386961340       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.907016698977       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906695982089       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.905345843757       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.905697866222       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.909202677646       residual = 7.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.907017520252       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.902450660120       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.907165815177       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.907466377270       residual = 6.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.908577579117       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.903684794117       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.908128507166       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.906633492678       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.906357199994       residual = 3.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.909906329923       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.910954265984       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.903886347835       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.906836418779       residual = 3.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.903509701443       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.907228573391       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.907584055408       residual = 7.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.905592979142       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.907681096811       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.906247296091       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.905373633450       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.905063647426       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.910830135500       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.904252958564       residual = 9.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.905926698946       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.903281689642       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.907171472259       residual = 4.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.905293317491       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.904916777687       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.906591624388       residual = 8.33e-05           smallest_sin_value = 9.99e-01
davidson iteration   63:   krylov dim =  64   energy =     -16.906414812794       residual = 6.26e-05           smallest_sin_value = 9.98e-01
davidson iteration   64:   krylov dim =  65   energy =     -16.908530539788       residual = 5.23e-04           smallest_sin_value = 9.98e-01
davidson iteration   65:   krylov dim =  66   energy =     -16.906618459200       residual = 1.42e-04           smallest_sin_value = 9.97e-01
davidson iteration   66:   krylov dim =  67   energy =     -16.905574365576       residual = 4.52e-04           smallest_sin_value = 9.97e-01
davidson iteration   67:   krylov dim =  68   energy =     -16.904312049916       residual = 9.79e-04           smallest_sin_value = 9.91e-01
davidson iteration   68:   krylov dim =  69   energy =     -16.906951699792       residual = 1.83e-04           smallest_sin_value = 9.91e-01
davidson iteration   69 stopping due to small subspace S singular value of 9.88e-01
davidson solver did not converge after         69 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+10 is 1.409791e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.719300 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7687e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8647
    reference variance = 0.456447
====================================================
  Execution time = 2.1261e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3720e-01
  Total weights = 1.9515e+06
  Execution time = 1.9087e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320817829913
                                         uncertainty =       0.001806481067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320817829913
                                         uncertainty =       0.001806481067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400533568
  error estimate for blocks of size 2^( 2) =       0.000413561571
  error estimate for blocks of size 2^( 3) =       0.000426389006
  error estimate for blocks of size 2^( 4) =       0.000438522175
  error estimate for blocks of size 2^( 5) =       0.000448619848
  error estimate for blocks of size 2^( 6) =       0.000453879909
  error estimate for blocks of size 2^( 7) =       0.000456959461

      target function =                  N/A
              le_mean =     -16.905929212686
             les_mean =     286.147647359852
             stat err =       0.000449495348
             autocorr =       1.259425739601
              std dev =       0.566440004062
             le_variance =       0.320854278202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320817829913
                                         uncertainty =       0.001806481067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320817829913
                                         uncertainty =       0.001806481067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400533568
  error estimate for blocks of size 2^( 2) =       0.000413561571
  error estimate for blocks of size 2^( 3) =       0.000426389006
  error estimate for blocks of size 2^( 4) =       0.000438522175
  error estimate for blocks of size 2^( 5) =       0.000448619848
  error estimate for blocks of size 2^( 6) =       0.000453879909
  error estimate for blocks of size 2^( 7) =       0.000456959461

      target function =                  N/A
              le_mean =     -16.905929212686
             les_mean =     286.147647359853
             stat err =       0.000449495348
             autocorr =       1.259425739601
              std dev =       0.566440004062
             le_variance =       0.320854278202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320817829913
                                         uncertainty =       0.001806481067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320817829913
                                         uncertainty =       0.001806481067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400533568
  error estimate for blocks of size 2^( 2) =       0.000413561571
  error estimate for blocks of size 2^( 3) =       0.000426389006
  error estimate for blocks of size 2^( 4) =       0.000438522175
  error estimate for blocks of size 2^( 5) =       0.000448619848
  error estimate for blocks of size 2^( 6) =       0.000453879909
  error estimate for blocks of size 2^( 7) =       0.000456959461

      target function =                  N/A
              le_mean =     -16.905929212686
             les_mean =     286.147647359852
             stat err =       0.000449495348
             autocorr =       1.259425739601
              std dev =       0.566440004062
             le_variance =       0.320854278202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320817829913
                                         uncertainty =       0.001806481067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320817829913
                                         uncertainty =       0.001806481067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400533568
  error estimate for blocks of size 2^( 2) =       0.000413561571
  error estimate for blocks of size 2^( 3) =       0.000426389006
  error estimate for blocks of size 2^( 4) =       0.000438522175
  error estimate for blocks of size 2^( 5) =       0.000448619848
  error estimate for blocks of size 2^( 6) =       0.000453879909
  error estimate for blocks of size 2^( 7) =       0.000456959461

      target function =                  N/A
              le_mean =     -16.905929212686
             les_mean =     286.147647359852
             stat err =       0.000449495348
             autocorr =       1.259425739603
              std dev =       0.566440004062
             le_variance =       0.320854278202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905929212686        initial  <--
     1.4901e+09     1.4901e+10             2.2542e-13       -16.905929212686
     5.9605e+09     5.9605e+10             5.6371e-14       -16.905929212686
     2.3842e+10     2.3842e+11             1.4098e-14       -16.905929212686

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9179
  </log>
  <optVariables href="H2O.s034.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8612e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9433
    reference variance = 0.207369
====================================================
  Execution time = 2.1487e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4022e-01
  Total weights = 1.951288049e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328257436500
                                         uncertainty =       0.002585627874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328257436500
                                         uncertainty =       0.002585627874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405143014
  error estimate for blocks of size 2^( 2) =       0.000418104935
  error estimate for blocks of size 2^( 3) =       0.000431423513
  error estimate for blocks of size 2^( 4) =       0.000443697804
  error estimate for blocks of size 2^( 5) =       0.000454683018
  error estimate for blocks of size 2^( 6) =       0.000462072351
  error estimate for blocks of size 2^( 7) =       0.000466178980

      target function =                  N/A
              le_mean =     -16.906636871330
             les_mean =     286.174592732592
             stat err =       0.000456658038
             autocorr =       1.270473190653
              std dev =       0.572958744433
             le_variance =       0.328281722822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663687133e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906636871339       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906636871339       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906636871339       residual = 5.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906645235561       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906640685839       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906635304873       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906622912498       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906636631223       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906632953785       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906644303117       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906637390350       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+10 is 5.747453e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906636871339       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906636871339       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906636871339       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906636871339       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906636871339       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906617202284       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906612224448       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906642458469       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906659785001       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906580645474       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906661707014       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906594251392       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906800881356       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906721551293       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906372809736       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906737087159       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908722145246       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907685233696       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907394265014       residual = 8.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906137015874       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908494100862       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906365197909       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905344895984       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.906608789281       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905682219983       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.911180465140       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.910481941062       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.913385229694       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.918389332567       residual = 1.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.908489393193       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.903567698331       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.911835828167       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.907298211099       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.899972430547       residual = 5.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.910860466010       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.909680391450       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.909027473112       residual = 7.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.909116112896       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.906715990389       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.912506672985       residual = 4.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.905904668085       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.904172068337       residual = 8.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.900743515522       residual = 4.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.904893641969       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.903851006226       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.909026146742       residual = 9.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.904504787081       residual = 8.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.912625590796       residual = 5.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.899461253369       residual = 7.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.911932344435       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.907073186487       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.913598256010       residual = 7.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.905831415673       residual = 4.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.892187379193       residual = 2.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.912463109003       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.904136504523       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.912094020969       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.905543834969       residual = 2.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.901579784184       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.914323834010       residual = 7.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.913737785549       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.907292926259       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.908266911584       residual = 4.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   energy =     -16.909166116569       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   energy =     -16.901744921829       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   energy =     -16.906985562544       residual = 7.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   66:   krylov dim =  67   energy =     -16.917495604290       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   67:   krylov dim =  68   energy =     -16.903700250860       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   68:   krylov dim =  69   energy =     -16.932115928091       residual = 8.82e-02           smallest_sin_value = 9.99e-01
davidson iteration   69:   krylov dim =  70   energy =     -16.896298031417       residual = 1.52e-02           smallest_sin_value = 9.99e-01
davidson iteration   70:   krylov dim =  71   energy =     -16.917906254872       residual = 1.69e-02           smallest_sin_value = 9.99e-01
davidson iteration   71:   krylov dim =  72   energy =     -16.877974076101       residual = 1.04e-01           smallest_sin_value = 9.97e-01
davidson iteration   72 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         72 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+10 is 1.437974e-14

solving harmonic davidson linear method for identity shift 2.3842e+11, overlap shift 2.3842e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906636871339       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906636871339       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906636871339       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906599861669       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906647234852       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906766593459       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906435923453       residual = 7.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906639992547       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906611950838       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907197569107       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906872969452       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906553229692       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906788504098       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906578907597       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906859223895       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906503142046       residual = 5.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.905563194700       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907914167928       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907519540793       residual = 9.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907701119144       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907746944711       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.904223368444       residual = 7.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.898249700041       residual = 9.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.914956156561       residual = 9.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.915252782103       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.913051913901       residual = 5.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.911011369917       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.909984684488       residual = 1.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.912264218131       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.920207761141       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.880522464873       residual = 9.38e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.916397536385       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.927993012896       residual = 6.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.933962632310       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.910975526307       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.887287010172       residual = 5.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.907312299835       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.928214637878       residual = 6.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.913215490708       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.894260643464       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.886531253849       residual = 5.96e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.928335467120       residual = 6.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.869225262386       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.885894429010       residual = 5.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.888718084547       residual = 5.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.909082486025       residual = 5.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.915117906079       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.914751846363       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.879240611640       residual = 1.16e-01           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.896832554446       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.884430850700       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.903524039986       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.901512864650       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.921013635417       residual = 3.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.961072130407       residual = 3.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.896099487349       residual = 4.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.915111697778       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.938995920426       residual = 1.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.902434876592       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.919963238773       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.851093376243       residual = 4.29e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.908683713671       residual = 1.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   62:   krylov dim =  63   energy =     -16.949623688698       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   63:   krylov dim =  64   energy =     -16.871643619091       residual = 1.65e-01           smallest_sin_value = 1.00e+00
davidson iteration   64:   krylov dim =  65   energy =     -16.895446965680       residual = 2.28e-02           smallest_sin_value = 1.00e+00
davidson iteration   65:   krylov dim =  66   energy =     -16.882171743937       residual = 9.33e-02           smallest_sin_value = 9.99e-01
davidson iteration   66:   krylov dim =  67   energy =     -16.857968199682       residual = 3.41e-01           smallest_sin_value = 9.98e-01
davidson iteration   67:   krylov dim =  68   energy =     -16.888161661436       residual = 5.05e-02           smallest_sin_value = 9.95e-01
davidson iteration   68:   krylov dim =  69   energy =     -16.924845979914       residual = 4.92e-02           smallest_sin_value = 9.94e-01
davidson iteration   69 stopping due to small subspace S singular value of 9.84e-01
davidson solver did not converge after         69 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+11 is 3.589496e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.988118 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7858e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9826
    reference variance = 0.486585
====================================================
  Execution time = 2.0805e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3623e-01
  Total weights = 1.9518e+06
  Execution time = 1.8911e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320586786508
                                         uncertainty =       0.001977095320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320586786508
                                         uncertainty =       0.001977095320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400361774
  error estimate for blocks of size 2^( 2) =       0.000413690455
  error estimate for blocks of size 2^( 3) =       0.000427026450
  error estimate for blocks of size 2^( 4) =       0.000440226535
  error estimate for blocks of size 2^( 5) =       0.000451935148
  error estimate for blocks of size 2^( 6) =       0.000462779807
  error estimate for blocks of size 2^( 7) =       0.000471043818

      target function =                  N/A
              le_mean =     -16.904928172082
             les_mean =     286.112824961379
             stat err =       0.000456496327
             autocorr =       1.300077867428
              std dev =       0.566197051304
             le_variance =       0.320579100905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320586786508
                                         uncertainty =       0.001977095320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320586786508
                                         uncertainty =       0.001977095320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400361774
  error estimate for blocks of size 2^( 2) =       0.000413690455
  error estimate for blocks of size 2^( 3) =       0.000427026450
  error estimate for blocks of size 2^( 4) =       0.000440226535
  error estimate for blocks of size 2^( 5) =       0.000451935148
  error estimate for blocks of size 2^( 6) =       0.000462779807
  error estimate for blocks of size 2^( 7) =       0.000471043818

      target function =                  N/A
              le_mean =     -16.904928172082
             les_mean =     286.112824961379
             stat err =       0.000456496327
             autocorr =       1.300077867431
              std dev =       0.566197051304
             le_variance =       0.320579100905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320586786508
                                         uncertainty =       0.001977095320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320586786508
                                         uncertainty =       0.001977095320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400361774
  error estimate for blocks of size 2^( 2) =       0.000413690455
  error estimate for blocks of size 2^( 3) =       0.000427026450
  error estimate for blocks of size 2^( 4) =       0.000440226535
  error estimate for blocks of size 2^( 5) =       0.000451935148
  error estimate for blocks of size 2^( 6) =       0.000462779807
  error estimate for blocks of size 2^( 7) =       0.000471043818

      target function =                  N/A
              le_mean =     -16.904928172082
             les_mean =     286.112824961379
             stat err =       0.000456496327
             autocorr =       1.300077867434
              std dev =       0.566197051304
             le_variance =       0.320579100905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320586786508
                                         uncertainty =       0.001977095320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320586786508
                                         uncertainty =       0.001977095320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400361774
  error estimate for blocks of size 2^( 2) =       0.000413690455
  error estimate for blocks of size 2^( 3) =       0.000427026450
  error estimate for blocks of size 2^( 4) =       0.000440226535
  error estimate for blocks of size 2^( 5) =       0.000451935148
  error estimate for blocks of size 2^( 6) =       0.000462779807
  error estimate for blocks of size 2^( 7) =       0.000471043818

      target function =                  N/A
              le_mean =     -16.904928172082
             les_mean =     286.112824961379
             stat err =       0.000456496327
             autocorr =       1.300077867430
              std dev =       0.566197051304
             le_variance =       0.320579100905


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.904928172082        initial  <--
     1.4901e+10     1.4901e+11             5.7475e-14       -16.904928172082
     5.9605e+10     5.9605e+11             1.4380e-14       -16.904928172082
     2.3842e+11     2.3842e+12             3.5895e-15       -16.904928172082

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3803
  </log>
  <optVariables href="H2O.s035.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8246e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9015
    reference variance = 0.280834
====================================================
  Execution time = 2.3566e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5251e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4026e-01
  Total weights = 1.952012428e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325322421965
                                         uncertainty =       0.002530493017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325322421965
                                         uncertainty =       0.002530493017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403279990
  error estimate for blocks of size 2^( 2) =       0.000415726517
  error estimate for blocks of size 2^( 3) =       0.000428624393
  error estimate for blocks of size 2^( 4) =       0.000440704438
  error estimate for blocks of size 2^( 5) =       0.000450341228
  error estimate for blocks of size 2^( 6) =       0.000456875751
  error estimate for blocks of size 2^( 7) =       0.000459948711

      target function =                  N/A
              le_mean =     -16.905765504549
             les_mean =     286.145163047445
             stat err =       0.000451967532
             autocorr =       1.256033229488
              std dev =       0.570324030675
             le_variance =       0.325269499966


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576550455e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905765504473       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905765504473       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905765504473       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905765504473       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905765504473       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905850437763       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905896385751       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905913495334       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905417492758       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905505234699       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.904984989091       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906748335887       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905881003041       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.900975550938       residual = 2.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906129327074       residual = 3.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.911918820975       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.901570967376       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910082094737       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.916605236714       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906013387166       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.911446411449       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.890352785754       residual = 3.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.901861587667       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.902296343829       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.913126287430       residual = 7.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.916732549353       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.914095744469       residual = 9.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.904031949139       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.894958189158       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.904115478400       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.901400435444       residual = 2.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.884877291134       residual = 5.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.907695638887       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.908620470354       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.917770468091       residual = 1.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.887796736241       residual = 4.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.892099254933       residual = 2.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.908871119004       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.916581941435       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.905775112721       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.905637927771       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.909319364143       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.896853236869       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.898961472485       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.913559380867       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.902359311443       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.897094314796       residual = 1.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.895605920391       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.923156214594       residual = 4.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.896290965425       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.922331506622       residual = 3.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.884183294271       residual = 6.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.898479691293       residual = 9.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.897896790968       residual = 8.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.900175309435       residual = 5.79e-03           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.905078300273       residual = 8.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.887373979186       residual = 5.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.908846748503       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.899147398290       residual = 8.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.907069959489       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   60:   krylov dim =  61   energy =     -16.874695335032       residual = 1.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   61:   krylov dim =  62   energy =     -16.920778696656       residual = 4.54e-02           smallest_sin_value = 9.99e-01
davidson iteration   62:   krylov dim =  63   energy =     -16.922047116699       residual = 4.16e-02           smallest_sin_value = 9.99e-01
davidson iteration   63:   krylov dim =  64   energy =     -16.907464702472       residual = 3.39e-03           smallest_sin_value = 9.96e-01
davidson iteration   64:   krylov dim =  65   energy =     -16.874724819036       residual = 1.30e-01           smallest_sin_value = 9.94e-01
davidson iteration   65 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         65 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+11 is 2.652103e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905765504473       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905765504473       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905765504473       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905765504473       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905841595295       residual = 6.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905774040921       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905529965587       residual = 9.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.899628393195       residual = 4.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905357985424       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.908768284516       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908819010010       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.915800735750       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906701734501       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907973422140       residual = 6.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.897626341070       residual = 9.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.900650862439       residual = 3.86e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910330730175       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.901568663360       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.922482512198       residual = 3.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.898533013832       residual = 6.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.899894557760       residual = 4.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.910813594929       residual = 5.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.899182690605       residual = 6.80e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908256095208       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.893954954742       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.959030060107       residual = 3.74e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.917223951042       residual = 1.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.932231685917       residual = 8.99e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.882859353679       residual = 6.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.953977417877       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.886983103722       residual = 4.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.922438439845       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.876729323299       residual = 1.37e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.902600082401       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.838945442248       residual = 5.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.890335266223       residual = 5.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.967764931026       residual = 5.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.907021450181       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -16.791409245178       residual = 1.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.905024212449       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.896456744256       residual = 1.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.851700316333       residual = 4.53e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -16.879996561973       residual = 1.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.848590822739       residual = 4.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.865810734373       residual = 2.19e-01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.931752082230       residual = 9.51e-02           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.920116510683       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.972486445111       residual = 5.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.894030780787       residual = 5.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.922433046545       residual = 4.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.930369472568       residual = 8.92e-02           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.814500689326       residual = 1.08e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.868443442449       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.968311437394       residual = 5.13e-01           smallest_sin_value = 9.99e-01
davidson iteration   54:   krylov dim =  55   energy =     -16.999985690414       residual = 1.24e+00           smallest_sin_value = 9.99e-01
davidson iteration   55:   krylov dim =  56   energy =     -16.866131083063       residual = 2.32e-01           smallest_sin_value = 9.99e-01
davidson iteration   56:   krylov dim =  57   energy =     -16.943742196801       residual = 1.63e-01           smallest_sin_value = 9.99e-01
davidson iteration   57:   krylov dim =  58   energy =     -16.868253818230       residual = 2.70e-01           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -16.952443812982       residual = 3.34e-01           smallest_sin_value = 9.98e-01
davidson iteration   59:   krylov dim =  60   energy =     -16.895484846570       residual = 3.73e-02           smallest_sin_value = 9.96e-01
davidson iteration   60:   krylov dim =  61   energy =     -16.931438987206       residual = 9.85e-02           smallest_sin_value = 9.96e-01
davidson iteration   61:   krylov dim =  62   energy =     -16.895920834179       residual = 2.25e-02           smallest_sin_value = 9.96e-01
davidson iteration   62:   krylov dim =  63   energy =     -16.918880033867       residual = 3.96e-02           smallest_sin_value = 9.90e-01
davidson iteration   63 stopping due to small subspace S singular value of 9.83e-01
davidson solver did not converge after         63 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+11 is 6.188857e-16

solving harmonic davidson linear method for identity shift 2.3842e+12, overlap shift 2.3842e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905765504473       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905765504473       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905765504473       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905663189745       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905903193757       residual = 6.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905765504473       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.904251997208       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.895792883568       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.914185994647       residual = 8.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.898473566557       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.908033071964       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.916274361057       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.913864520461       residual = 9.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.917252428813       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.924295184303       residual = 4.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.897584580765       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.897085511533       residual = 9.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.965075096647       residual = 4.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.866323589746       residual = 2.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.783455069282       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.923566774546       residual = 4.44e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.949024578581       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.877260390465       residual = 9.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.918282376472       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.929672182077       residual = 9.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.973464758801       residual = 5.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.878949087566       residual = 9.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.970494112651       residual = 6.01e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.959295685487       residual = 4.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.910875032898       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.055522478422       residual = 2.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.011511895367       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.962256641836       residual = 3.95e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -17.055071435087       residual = 3.09e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.747030664807       residual = 3.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -16.744511409271       residual = 3.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -16.831637606504       residual = 6.81e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.631346981690       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.175101915123       residual = 9.55e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.870697368822       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.550895201604       residual = 1.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.828919572309       residual = 8.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.244652502826       residual = 1.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.798228984774       residual = 1.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.777082150124       residual = 2.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.933115830405       residual = 3.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.799709264977       residual = 1.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -17.101649481222       residual = 5.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.769894873745       residual = 3.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.792613978807       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.846148496715       residual = 6.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.807838537318       residual = 1.59e+00           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.685336686828       residual = 6.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.870759202522       residual = 3.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.949173840537       residual = 3.90e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.764178453439       residual = 3.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.788512613213       residual = 1.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -16.837331413396       residual = 6.91e-01           smallest_sin_value = 9.99e-01
davidson iteration   58:   krylov dim =  59   energy =     -16.720921351327       residual = 5.72e+00           smallest_sin_value = 9.98e-01
davidson iteration   59:   krylov dim =  60   energy =     -17.076770175075       residual = 4.47e+00           smallest_sin_value = 9.97e-01
davidson iteration   60:   krylov dim =  61   energy =     -16.991457907916       residual = 1.61e+00           smallest_sin_value = 9.94e-01
davidson iteration   61 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         61 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+12 is 1.546224e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.277593 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0002e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8229
    reference variance = 0.254888
====================================================
  Execution time = 2.1231e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3981e-01
  Total weights = 1.9518e+06
  Execution time = 1.9120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325970328670
                                         uncertainty =       0.002974558138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325970328670
                                         uncertainty =       0.002974558138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403695934
  error estimate for blocks of size 2^( 2) =       0.000416288165
  error estimate for blocks of size 2^( 3) =       0.000429280428
  error estimate for blocks of size 2^( 4) =       0.000442277495
  error estimate for blocks of size 2^( 5) =       0.000452953283
  error estimate for blocks of size 2^( 6) =       0.000462214584
  error estimate for blocks of size 2^( 7) =       0.000467736469

      target function =                  N/A
              le_mean =     -16.906424179656
             les_mean =     286.166986469435
             stat err =       0.000456295458
             autocorr =       1.277566573694
              std dev =       0.570912264911
             le_variance =       0.325940814226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325970328670
                                         uncertainty =       0.002974558138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325970328670
                                         uncertainty =       0.002974558138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403695934
  error estimate for blocks of size 2^( 2) =       0.000416288165
  error estimate for blocks of size 2^( 3) =       0.000429280428
  error estimate for blocks of size 2^( 4) =       0.000442277495
  error estimate for blocks of size 2^( 5) =       0.000452953283
  error estimate for blocks of size 2^( 6) =       0.000462214584
  error estimate for blocks of size 2^( 7) =       0.000467736469

      target function =                  N/A
              le_mean =     -16.906424179656
             les_mean =     286.166986469435
             stat err =       0.000456295458
             autocorr =       1.277566573694
              std dev =       0.570912264911
             le_variance =       0.325940814226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325970328670
                                         uncertainty =       0.002974558138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325970328670
                                         uncertainty =       0.002974558138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403695934
  error estimate for blocks of size 2^( 2) =       0.000416288165
  error estimate for blocks of size 2^( 3) =       0.000429280428
  error estimate for blocks of size 2^( 4) =       0.000442277495
  error estimate for blocks of size 2^( 5) =       0.000452953283
  error estimate for blocks of size 2^( 6) =       0.000462214584
  error estimate for blocks of size 2^( 7) =       0.000467736469

      target function =                  N/A
              le_mean =     -16.906424179656
             les_mean =     286.166986469435
             stat err =       0.000456295458
             autocorr =       1.277566573694
              std dev =       0.570912264911
             le_variance =       0.325940814226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325970328670
                                         uncertainty =       0.002974558138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325970328670
                                         uncertainty =       0.002974558138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403695934
  error estimate for blocks of size 2^( 2) =       0.000416288165
  error estimate for blocks of size 2^( 3) =       0.000429280428
  error estimate for blocks of size 2^( 4) =       0.000442277495
  error estimate for blocks of size 2^( 5) =       0.000452953283
  error estimate for blocks of size 2^( 6) =       0.000462214584
  error estimate for blocks of size 2^( 7) =       0.000467736469

      target function =                  N/A
              le_mean =     -16.906424179656
             les_mean =     286.166986469435
             stat err =       0.000456295458
             autocorr =       1.277566573694
              std dev =       0.570912264911
             le_variance =       0.325940814226


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906424179656        initial  <--
     1.4901e+11     1.4901e+12             2.6521e-15       -16.906424179656
     5.9605e+11     5.9605e+12             6.1889e-16       -16.906424179656
     2.3842e+12     2.3842e+13             1.5462e-16       -16.906424179656

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8993
  </log>
  <optVariables href="H2O.s036.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0909e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8619
    reference variance = 0.198624
====================================================
  Execution time = 2.1326e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3396e-01
  Total weights = 1.951697084e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321777554125
                                         uncertainty =       0.002136903067

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321777554125
                                         uncertainty =       0.002136903067

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401112999
  error estimate for blocks of size 2^( 2) =       0.000413913194
  error estimate for blocks of size 2^( 3) =       0.000426858812
  error estimate for blocks of size 2^( 4) =       0.000439391937
  error estimate for blocks of size 2^( 5) =       0.000449156998
  error estimate for blocks of size 2^( 6) =       0.000455079307
  error estimate for blocks of size 2^( 7) =       0.000456356652

      target function =                  N/A
              le_mean =     -16.906807511843
             les_mean =     286.174105071916
             stat err =       0.000449996224
             autocorr =       1.258589968713
              std dev =       0.567259442633
             le_variance =       0.321783275257


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690680751184e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906807511860       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906807511860       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906807511860       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906807511860       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906807511860       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906730237960       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907197082738       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905756881235       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.899272676400       residual = 7.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909940615476       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905943569558       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.901716461173       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.912362023171       residual = 3.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.922727342906       residual = 3.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911544341459       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.882083156955       residual = 8.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.874553351903       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.927192572811       residual = 5.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.923981356374       residual = 4.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.890072998977       residual = 4.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907806349328       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.901891165998       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.923820703958       residual = 3.79e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.927984655425       residual = 7.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.871539459861       residual = 1.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.897139867935       residual = 1.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.870280936663       residual = 2.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.923635670037       residual = 5.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.929765742931       residual = 7.43e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.677372728003       residual = 7.10e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.086306202886       residual = 4.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -17.272340463358       residual = 1.78e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.949157308137       residual = 3.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.933102225000       residual = 2.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.760641508941       residual = 2.41e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   energy =     -17.219594208484       residual = 1.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   energy =     -17.111349012846       residual = 6.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   energy =     -16.702842680699       residual = 5.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   energy =     -17.190640387037       residual = 1.08e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   energy =     -16.755005849717       residual = 3.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   energy =     -16.883717132737       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   energy =     -16.834194331739       residual = 1.51e+00           smallest_sin_value = 1.00e+00
davidson iteration   42:   krylov dim =  43   energy =     -17.179823137878       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   43:   krylov dim =  44   energy =     -16.771007097372       residual = 2.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   44:   krylov dim =  45   energy =     -16.626434336876       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   45:   krylov dim =  46   energy =     -16.777969828783       residual = 2.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   46:   krylov dim =  47   energy =     -16.551453690598       residual = 1.68e+01           smallest_sin_value = 1.00e+00
davidson iteration   47:   krylov dim =  48   energy =     -16.774895123658       residual = 2.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   48:   krylov dim =  49   energy =     -16.645231523113       residual = 8.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   49:   krylov dim =  50   energy =     -16.908578936505       residual = 7.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   50:   krylov dim =  51   energy =     -16.727783252982       residual = 4.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   51:   krylov dim =  52   energy =     -16.602417417996       residual = 1.20e+01           smallest_sin_value = 1.00e+00
davidson iteration   52:   krylov dim =  53   energy =     -16.803268577206       residual = 2.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   53:   krylov dim =  54   energy =     -16.577166294367       residual = 1.49e+01           smallest_sin_value = 1.00e+00
davidson iteration   54:   krylov dim =  55   energy =     -16.944495661945       residual = 5.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   55:   krylov dim =  56   energy =     -16.922596967073       residual = 2.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   56:   krylov dim =  57   energy =     -16.965519896130       residual = 8.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   57:   krylov dim =  58   energy =     -17.014043971203       residual = 1.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   58:   krylov dim =  59   energy =     -16.746874012371       residual = 3.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   59:   krylov dim =  60   energy =     -16.954326328777       residual = 7.83e-01           smallest_sin_value = 9.99e-01
davidson iteration   60:   krylov dim =  61   energy =     -17.094164356303       residual = 4.80e+00           smallest_sin_value = 9.99e-01
davidson iteration   61:   krylov dim =  62   energy =     -16.838541502493       residual = 1.07e+00           smallest_sin_value = 9.99e-01
davidson iteration   62:   krylov dim =  63   energy =     -17.062267977022       residual = 4.72e+00           smallest_sin_value = 9.98e-01
davidson iteration   63:   krylov dim =  64   energy =     -16.894210632192       residual = 4.79e-01           smallest_sin_value = 9.92e-01
davidson iteration   64:   krylov dim =  65   energy =     -16.620232303403       residual = 1.25e+01           smallest_sin_value = 9.92e-01
davidson iteration   65:   krylov dim =  66   energy =     -16.621689838364       residual = 1.16e+01           smallest_sin_value = 9.91e-01
davidson iteration   66 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         66 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+12 is 2.115092e-16

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906807511860       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906807511860       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.24e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+13, overlap shift 2.3842e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906807511860       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906807511860       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.23e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.390215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7541e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.0751
    reference variance = 0.682359
====================================================
  Execution time = 2.1190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3934e-01
  Total weights = 1.9515e+06
  Execution time = 1.9072e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326367812376
                                         uncertainty =       0.002867373886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326367812376
                                         uncertainty =       0.002867373886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403981679
  error estimate for blocks of size 2^( 2) =       0.000416867136
  error estimate for blocks of size 2^( 3) =       0.000430027981
  error estimate for blocks of size 2^( 4) =       0.000443026315
  error estimate for blocks of size 2^( 5) =       0.000453622129
  error estimate for blocks of size 2^( 6) =       0.000460986327
  error estimate for blocks of size 2^( 7) =       0.000466077428

      target function =                  N/A
              le_mean =     -16.906144162389
             les_mean =     286.157049712069
             stat err =       0.000455928050
             autocorr =       1.273706262679
              std dev =       0.571316369619
             le_variance =       0.326402394195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326367812376
                                         uncertainty =       0.002867373886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326367812376
                                         uncertainty =       0.002867373886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403981679
  error estimate for blocks of size 2^( 2) =       0.000416867136
  error estimate for blocks of size 2^( 3) =       0.000430027981
  error estimate for blocks of size 2^( 4) =       0.000443026315
  error estimate for blocks of size 2^( 5) =       0.000453622129
  error estimate for blocks of size 2^( 6) =       0.000460986327
  error estimate for blocks of size 2^( 7) =       0.000466077428

      target function =                  N/A
              le_mean =     -16.906144162389
             les_mean =     286.157049712069
             stat err =       0.000455928050
             autocorr =       1.273706262679
              std dev =       0.571316369619
             le_variance =       0.326402394195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326367812376
                                         uncertainty =       0.002867373886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326367812376
                                         uncertainty =       0.002867373886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403981679
  error estimate for blocks of size 2^( 2) =       0.000416867136
  error estimate for blocks of size 2^( 3) =       0.000430027981
  error estimate for blocks of size 2^( 4) =       0.000443026315
  error estimate for blocks of size 2^( 5) =       0.000453622129
  error estimate for blocks of size 2^( 6) =       0.000460986327
  error estimate for blocks of size 2^( 7) =       0.000466077428

      target function =                  N/A
              le_mean =     -16.906144162389
             les_mean =     286.157049712069
             stat err =       0.000455928050
             autocorr =       1.273706262679
              std dev =       0.571316369619
             le_variance =       0.326402394195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326367812376
                                         uncertainty =       0.002867373886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326367812376
                                         uncertainty =       0.002867373886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403981679
  error estimate for blocks of size 2^( 2) =       0.000416867136
  error estimate for blocks of size 2^( 3) =       0.000430027981
  error estimate for blocks of size 2^( 4) =       0.000443026315
  error estimate for blocks of size 2^( 5) =       0.000453622129
  error estimate for blocks of size 2^( 6) =       0.000460986327
  error estimate for blocks of size 2^( 7) =       0.000466077428

      target function =                  N/A
              le_mean =     -16.906144162389
             les_mean =     286.157049712069
             stat err =       0.000455928050
             autocorr =       1.273706262679
              std dev =       0.571316369619
             le_variance =       0.326402394195


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906144162389        initial  <--
     1.4901e+12     1.4901e+13             2.1151e-16       -16.906144162389
     5.9605e+12     5.9605e+13             0.0000e+00       -16.906144162389
     2.3842e+13     2.3842e+14             0.0000e+00       -16.906144162389

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8378
  </log>
  <optVariables href="H2O.s037.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8385e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8988
    reference variance = 0.254863
====================================================
  Execution time = 2.1380e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3809e-01
  Total weights = 1.951804995e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0572e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324847892788
                                         uncertainty =       0.002665282861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324847892788
                                         uncertainty =       0.002665282861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403003942
  error estimate for blocks of size 2^( 2) =       0.000415714340
  error estimate for blocks of size 2^( 3) =       0.000428077775
  error estimate for blocks of size 2^( 4) =       0.000439295153
  error estimate for blocks of size 2^( 5) =       0.000448643507
  error estimate for blocks of size 2^( 6) =       0.000453874938
  error estimate for blocks of size 2^( 7) =       0.000456510203

      target function =                  N/A
              le_mean =     -16.906980915966
             les_mean =     286.184094893225
             stat err =       0.000449580950
             autocorr =       1.244506625823
              std dev =       0.569933640402
             le_variance =       0.324824354461


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690698091597e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906980915979       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906980915979       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.54e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906980915979       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906980915979       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.54e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+14, overlap shift 2.3842e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906980915979       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906980915979       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 7.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.391359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7447e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8321
    reference variance = 0.297977
====================================================
  Execution time = 2.0866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3452e-01
  Total weights = 1.9513e+06
  Execution time = 1.9099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322365080411
                                         uncertainty =       0.003022789113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322365080411
                                         uncertainty =       0.003022789113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401442575
  error estimate for blocks of size 2^( 2) =       0.000413779815
  error estimate for blocks of size 2^( 3) =       0.000426248124
  error estimate for blocks of size 2^( 4) =       0.000438566044
  error estimate for blocks of size 2^( 5) =       0.000448770260
  error estimate for blocks of size 2^( 6) =       0.000455976298
  error estimate for blocks of size 2^( 7) =       0.000461300045

      target function =                  N/A
              le_mean =     -16.905790044986
             les_mean =     286.140257576944
             stat err =       0.000451153162
             autocorr =       1.262993602983
              std dev =       0.567725534550
             le_variance =       0.322312282580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322365080411
                                         uncertainty =       0.003022789113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322365080411
                                         uncertainty =       0.003022789113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401442575
  error estimate for blocks of size 2^( 2) =       0.000413779815
  error estimate for blocks of size 2^( 3) =       0.000426248124
  error estimate for blocks of size 2^( 4) =       0.000438566044
  error estimate for blocks of size 2^( 5) =       0.000448770260
  error estimate for blocks of size 2^( 6) =       0.000455976298
  error estimate for blocks of size 2^( 7) =       0.000461300045

      target function =                  N/A
              le_mean =     -16.905790044986
             les_mean =     286.140257576944
             stat err =       0.000451153162
             autocorr =       1.262993602983
              std dev =       0.567725534550
             le_variance =       0.322312282580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322365080411
                                         uncertainty =       0.003022789113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322365080411
                                         uncertainty =       0.003022789113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401442575
  error estimate for blocks of size 2^( 2) =       0.000413779815
  error estimate for blocks of size 2^( 3) =       0.000426248124
  error estimate for blocks of size 2^( 4) =       0.000438566044
  error estimate for blocks of size 2^( 5) =       0.000448770260
  error estimate for blocks of size 2^( 6) =       0.000455976298
  error estimate for blocks of size 2^( 7) =       0.000461300045

      target function =                  N/A
              le_mean =     -16.905790044986
             les_mean =     286.140257576944
             stat err =       0.000451153162
             autocorr =       1.262993602983
              std dev =       0.567725534550
             le_variance =       0.322312282580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322365080411
                                         uncertainty =       0.003022789113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322365080411
                                         uncertainty =       0.003022789113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401442575
  error estimate for blocks of size 2^( 2) =       0.000413779815
  error estimate for blocks of size 2^( 3) =       0.000426248124
  error estimate for blocks of size 2^( 4) =       0.000438566044
  error estimate for blocks of size 2^( 5) =       0.000448770260
  error estimate for blocks of size 2^( 6) =       0.000455976298
  error estimate for blocks of size 2^( 7) =       0.000461300045

      target function =                  N/A
              le_mean =     -16.905790044986
             les_mean =     286.140257576944
             stat err =       0.000451153162
             autocorr =       1.262993602983
              std dev =       0.567725534550
             le_variance =       0.322312282580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905790044986        initial  <--
     1.4901e+13     1.4901e+14             0.0000e+00       -16.905790044986
     5.9605e+13     5.9605e+14             0.0000e+00       -16.905790044986
     2.3842e+14     2.3842e+15             0.0000e+00       -16.905790044986

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5265
  </log>
  <optVariables href="H2O.s038.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9197
    reference variance = 0.75624
====================================================
  Execution time = 2.1362e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3779e-01
  Total weights = 1.951496311e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0357e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326289420391
                                         uncertainty =       0.004722396796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326289420391
                                         uncertainty =       0.004722396796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403868647
  error estimate for blocks of size 2^( 2) =       0.000416548230
  error estimate for blocks of size 2^( 3) =       0.000429270062
  error estimate for blocks of size 2^( 4) =       0.000441779119
  error estimate for blocks of size 2^( 5) =       0.000452471644
  error estimate for blocks of size 2^( 6) =       0.000457742647
  error estimate for blocks of size 2^( 7) =       0.000459271415

      target function =                  N/A
              le_mean =     -16.905104552557
             les_mean =     286.120351484785
             stat err =       0.000452816206
             autocorr =       1.257082102513
              std dev =       0.571156518622
             le_variance =       0.326219768764


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690510455256e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905104552523       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905104552523       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.61e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905104552523       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905104552523       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.61e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+15, overlap shift 2.3842e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905104552523       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905104552523       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905104552523       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.862474537647       residual = 1.91e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -15.093185424805       residual = 4.74e+02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.795645237175       residual = 1.97e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -24.258096756889       residual = 7.63e+03           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+15 is 1.526715e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.393154 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7408e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9009
    reference variance = 0.167134
====================================================
  Execution time = 2.1039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3482e-01
  Total weights = 1.9515e+06
  Execution time = 1.9085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320406219410
                                         uncertainty =       0.002361931199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320406219410
                                         uncertainty =       0.002361931199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400226467
  error estimate for blocks of size 2^( 2) =       0.000413037014
  error estimate for blocks of size 2^( 3) =       0.000426544703
  error estimate for blocks of size 2^( 4) =       0.000438961420
  error estimate for blocks of size 2^( 5) =       0.000449779520
  error estimate for blocks of size 2^( 6) =       0.000456746439
  error estimate for blocks of size 2^( 7) =       0.000461039576

      target function =                  N/A
              le_mean =     -16.905274029387
             les_mean =     286.123108939366
             stat err =       0.000451631739
             autocorr =       1.273377876330
              std dev =       0.566005697010
             le_variance =       0.320362449048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320406219410
                                         uncertainty =       0.002361931199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320406219410
                                         uncertainty =       0.002361931199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400226467
  error estimate for blocks of size 2^( 2) =       0.000413037014
  error estimate for blocks of size 2^( 3) =       0.000426544703
  error estimate for blocks of size 2^( 4) =       0.000438961420
  error estimate for blocks of size 2^( 5) =       0.000449779520
  error estimate for blocks of size 2^( 6) =       0.000456746439
  error estimate for blocks of size 2^( 7) =       0.000461039576

      target function =                  N/A
              le_mean =     -16.905274029387
             les_mean =     286.123108939366
             stat err =       0.000451631739
             autocorr =       1.273377876330
              std dev =       0.566005697010
             le_variance =       0.320362449048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320406219410
                                         uncertainty =       0.002361931199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320406219410
                                         uncertainty =       0.002361931199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400226467
  error estimate for blocks of size 2^( 2) =       0.000413037014
  error estimate for blocks of size 2^( 3) =       0.000426544703
  error estimate for blocks of size 2^( 4) =       0.000438961420
  error estimate for blocks of size 2^( 5) =       0.000449779520
  error estimate for blocks of size 2^( 6) =       0.000456746439
  error estimate for blocks of size 2^( 7) =       0.000461039576

      target function =                  N/A
              le_mean =     -16.905274029387
             les_mean =     286.123108939366
             stat err =       0.000451631739
             autocorr =       1.273377876330
              std dev =       0.566005697010
             le_variance =       0.320362449048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320406219410
                                         uncertainty =       0.002361931199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320406219410
                                         uncertainty =       0.002361931199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400226467
  error estimate for blocks of size 2^( 2) =       0.000413037014
  error estimate for blocks of size 2^( 3) =       0.000426544703
  error estimate for blocks of size 2^( 4) =       0.000438961420
  error estimate for blocks of size 2^( 5) =       0.000449779520
  error estimate for blocks of size 2^( 6) =       0.000456746439
  error estimate for blocks of size 2^( 7) =       0.000461039576

      target function =                  N/A
              le_mean =     -16.905274029387
             les_mean =     286.123108939366
             stat err =       0.000451631739
             autocorr =       1.273377876330
              std dev =       0.566005697010
             le_variance =       0.320362449048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905274029387        initial  <--
     1.4901e+14     1.4901e+15             0.0000e+00       -16.905274029387
     5.9605e+14     5.9605e+15             0.0000e+00       -16.905274029387
     2.3842e+15     2.3842e+16             1.5267e-19       -16.905274029387

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7068
  </log>
  <optVariables href="H2O.s039.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8122e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.913
    reference variance = 0.196312
====================================================
  Execution time = 2.1445e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5245e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3504e-01
  Total weights = 1.951721594e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321493263235
                                         uncertainty =       0.002016255293

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321493263235
                                         uncertainty =       0.002016255293

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400912943
  error estimate for blocks of size 2^( 2) =       0.000413785035
  error estimate for blocks of size 2^( 3) =       0.000426521668
  error estimate for blocks of size 2^( 4) =       0.000438535790
  error estimate for blocks of size 2^( 5) =       0.000448565991
  error estimate for blocks of size 2^( 6) =       0.000457904994
  error estimate for blocks of size 2^( 7) =       0.000461636689

      target function =                  N/A
              le_mean =     -16.906774372118
             les_mean =     286.174054848462
             stat err =       0.000451660866
             autocorr =       1.269184533153
              std dev =       0.566976521764
             le_variance =       0.321462376232


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690677437212e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+15, overlap shift 1.4901e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906774372110       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906774372110       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.62e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+15, overlap shift 5.9605e+16 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906774372110       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906774372110       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.62e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+16, overlap shift 2.3842e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906774372110       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906774372110       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.394260 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7523e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -16.8341
    reference variance = 0.292976
====================================================
  Execution time = 2.1277e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3486e-01
  Total weights = 1.9518e+06
  Execution time = 1.9032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322040811102
                                         uncertainty =       0.002091748736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322040811102
                                         uncertainty =       0.002091748736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401295382
  error estimate for blocks of size 2^( 2) =       0.000414064403
  error estimate for blocks of size 2^( 3) =       0.000426702528
  error estimate for blocks of size 2^( 4) =       0.000439390114
  error estimate for blocks of size 2^( 5) =       0.000451406544
  error estimate for blocks of size 2^( 6) =       0.000460929890
  error estimate for blocks of size 2^( 7) =       0.000466269607

      target function =                  N/A
              le_mean =     -16.906565935162
             les_mean =     286.166832508379
             stat err =       0.000454499039
             autocorr =       1.282736976073
              std dev =       0.567517371767
             le_variance =       0.322075967257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322040811102
                                         uncertainty =       0.002091748736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322040811102
                                         uncertainty =       0.002091748736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401295382
  error estimate for blocks of size 2^( 2) =       0.000414064403
  error estimate for blocks of size 2^( 3) =       0.000426702528
  error estimate for blocks of size 2^( 4) =       0.000439390114
  error estimate for blocks of size 2^( 5) =       0.000451406544
  error estimate for blocks of size 2^( 6) =       0.000460929890
  error estimate for blocks of size 2^( 7) =       0.000466269607

      target function =                  N/A
              le_mean =     -16.906565935162
             les_mean =     286.166832508379
             stat err =       0.000454499039
             autocorr =       1.282736976073
              std dev =       0.567517371767
             le_variance =       0.322075967257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322040811102
                                         uncertainty =       0.002091748736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322040811102
                                         uncertainty =       0.002091748736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401295382
  error estimate for blocks of size 2^( 2) =       0.000414064403
  error estimate for blocks of size 2^( 3) =       0.000426702528
  error estimate for blocks of size 2^( 4) =       0.000439390114
  error estimate for blocks of size 2^( 5) =       0.000451406544
  error estimate for blocks of size 2^( 6) =       0.000460929890
  error estimate for blocks of size 2^( 7) =       0.000466269607

      target function =                  N/A
              le_mean =     -16.906565935162
             les_mean =     286.166832508379
             stat err =       0.000454499039
             autocorr =       1.282736976073
              std dev =       0.567517371767
             le_variance =       0.322075967257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322040811102
                                         uncertainty =       0.002091748736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322040811102
                                         uncertainty =       0.002091748736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401295382
  error estimate for blocks of size 2^( 2) =       0.000414064403
  error estimate for blocks of size 2^( 3) =       0.000426702528
  error estimate for blocks of size 2^( 4) =       0.000439390114
  error estimate for blocks of size 2^( 5) =       0.000451406544
  error estimate for blocks of size 2^( 6) =       0.000460929890
  error estimate for blocks of size 2^( 7) =       0.000466269607

      target function =                  N/A
              le_mean =     -16.906565935162
             les_mean =     286.166832508379
             stat err =       0.000454499039
             autocorr =       1.282736976073
              std dev =       0.567517371767
             le_variance =       0.322075967257


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906565935162        initial  <--
     1.4901e+15     1.4901e+16             0.0000e+00       -16.906565935162
     5.9605e+15     5.9605e+16             0.0000e+00       -16.906565935162
     2.3842e+16     2.3842e+17             0.0000e+00       -16.906565935162

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9038
  </log>
  <optVariables href="H2O.s040.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8434e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.9098
    reference variance = 0.256385
====================================================
  Execution time = 2.1319e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3752e-01
  Total weights = 1.951894282e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.6929e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322344856248
                                         uncertainty =       0.002742949801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322344856248
                                         uncertainty =       0.002742949801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401461998
  error estimate for blocks of size 2^( 2) =       0.000414412016
  error estimate for blocks of size 2^( 3) =       0.000427460879
  error estimate for blocks of size 2^( 4) =       0.000439178139
  error estimate for blocks of size 2^( 5) =       0.000449262494
  error estimate for blocks of size 2^( 6) =       0.000456184714
  error estimate for blocks of size 2^( 7) =       0.000458700899

      target function =                  N/A
              le_mean =     -16.906141029477
             les_mean =     286.155123272731
             stat err =       0.000450831562
             autocorr =       1.261071589645
              std dev =       0.567753001968
             le_variance =       0.322343471244


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690614102948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+16, overlap shift 1.4901e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141029441       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141029441       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+16, overlap shift 5.9605e+17 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141029441       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141029441       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.30e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+16 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+17, overlap shift 2.3842e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906141029441       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906141029441       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.395397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8022e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -16.8495
    reference variance = 0.18628
====================================================
  Execution time = 2.0962e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3642e-01
  Total weights = 1.9517e+06
  Execution time = 1.9068e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323462671102
                                         uncertainty =       0.003244268135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323462671102
                                         uncertainty =       0.003244268135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402155459
  error estimate for blocks of size 2^( 2) =       0.000414677776
  error estimate for blocks of size 2^( 3) =       0.000427994201
  error estimate for blocks of size 2^( 4) =       0.000440173350
  error estimate for blocks of size 2^( 5) =       0.000450490112
  error estimate for blocks of size 2^( 6) =       0.000456520870
  error estimate for blocks of size 2^( 7) =       0.000461437239

      target function =                  N/A
              le_mean =     -16.906134686935
             les_mean =     286.153810805833
             stat err =       0.000452155393
             autocorr =       1.264117645734
              std dev =       0.568733703880
             le_variance =       0.323458025929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323462671102
                                         uncertainty =       0.003244268135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323462671102
                                         uncertainty =       0.003244268135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402155459
  error estimate for blocks of size 2^( 2) =       0.000414677776
  error estimate for blocks of size 2^( 3) =       0.000427994201
  error estimate for blocks of size 2^( 4) =       0.000440173350
  error estimate for blocks of size 2^( 5) =       0.000450490112
  error estimate for blocks of size 2^( 6) =       0.000456520870
  error estimate for blocks of size 2^( 7) =       0.000461437239

      target function =                  N/A
              le_mean =     -16.906134686935
             les_mean =     286.153810805833
             stat err =       0.000452155393
             autocorr =       1.264117645734
              std dev =       0.568733703880
             le_variance =       0.323458025929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323462671102
                                         uncertainty =       0.003244268135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323462671102
                                         uncertainty =       0.003244268135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402155459
  error estimate for blocks of size 2^( 2) =       0.000414677776
  error estimate for blocks of size 2^( 3) =       0.000427994201
  error estimate for blocks of size 2^( 4) =       0.000440173350
  error estimate for blocks of size 2^( 5) =       0.000450490112
  error estimate for blocks of size 2^( 6) =       0.000456520870
  error estimate for blocks of size 2^( 7) =       0.000461437239

      target function =                  N/A
              le_mean =     -16.906134686935
             les_mean =     286.153810805833
             stat err =       0.000452155393
             autocorr =       1.264117645734
              std dev =       0.568733703880
             le_variance =       0.323458025929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323462671102
                                         uncertainty =       0.003244268135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323462671102
                                         uncertainty =       0.003244268135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402155459
  error estimate for blocks of size 2^( 2) =       0.000414677776
  error estimate for blocks of size 2^( 3) =       0.000427994201
  error estimate for blocks of size 2^( 4) =       0.000440173350
  error estimate for blocks of size 2^( 5) =       0.000450490112
  error estimate for blocks of size 2^( 6) =       0.000456520870
  error estimate for blocks of size 2^( 7) =       0.000461437239

      target function =                  N/A
              le_mean =     -16.906134686935
             les_mean =     286.153810805833
             stat err =       0.000452155393
             autocorr =       1.264117645734
              std dev =       0.568733703880
             le_variance =       0.323458025929


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906134686935        initial  <--
     1.4901e+16     1.4901e+17             0.0000e+00       -16.906134686935
     5.9605e+16     5.9605e+17             0.0000e+00       -16.906134686935
     2.3842e+17     2.3842e+18             0.0000e+00       -16.906134686935

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6134
  </log>
  <optVariables href="H2O.s041.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8643e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.8669
    reference variance = 0.35504
====================================================
  Execution time = 2.1111e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5234e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3492e-01
  Total weights = 1.951883954e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1508e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322594178465
                                         uncertainty =       0.002363798751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322594178465
                                         uncertainty =       0.002363798751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401788379
  error estimate for blocks of size 2^( 2) =       0.000414725602
  error estimate for blocks of size 2^( 3) =       0.000428583098
  error estimate for blocks of size 2^( 4) =       0.000440090005
  error estimate for blocks of size 2^( 5) =       0.000450058210
  error estimate for blocks of size 2^( 6) =       0.000457430440
  error estimate for blocks of size 2^( 7) =       0.000460032016

      target function =                  N/A
              le_mean =     -16.906494037667
             les_mean =     286.164459048552
             stat err =       0.000451902668
             autocorr =       1.265013233293
              std dev =       0.568214574213
             le_variance =       0.322867802348


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649403767e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+17, overlap shift 1.4901e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906494037653       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906494037653       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906494037653       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -14.585138576660       residual = 9.59e+02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -24.344067702288       residual = 7.37e+03           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+17 is 2.159605e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+17, overlap shift 5.9605e+18 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906494037653       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906494037653       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906494037653       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906494037653       residual = 3.84e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+17 is 5.399013e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+18, overlap shift 2.3842e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906494037653       residual = 1.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906494037653       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906494037653       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+18 is 1.349753e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.397171 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7272e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -16.9872
    reference variance = 0.199336
====================================================
  Execution time = 2.1049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3778e-01
  Total weights = 1.9516e+06
  Execution time = 1.8979e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325448300177
                                         uncertainty =       0.002207577935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325448300177
                                         uncertainty =       0.002207577935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403331498
  error estimate for blocks of size 2^( 2) =       0.000415560994
  error estimate for blocks of size 2^( 3) =       0.000428597208
  error estimate for blocks of size 2^( 4) =       0.000440306820
  error estimate for blocks of size 2^( 5) =       0.000451279809
  error estimate for blocks of size 2^( 6) =       0.000459376993
  error estimate for blocks of size 2^( 7) =       0.000466444890

      target function =                  N/A
              le_mean =     -16.905672762793
             les_mean =     286.139553161892
             stat err =       0.000454352128
             autocorr =       1.268997755772
              std dev =       0.570396874641
             le_variance =       0.325352594600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325448300177
                                         uncertainty =       0.002207577935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325448300177
                                         uncertainty =       0.002207577935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403331498
  error estimate for blocks of size 2^( 2) =       0.000415560994
  error estimate for blocks of size 2^( 3) =       0.000428597208
  error estimate for blocks of size 2^( 4) =       0.000440306820
  error estimate for blocks of size 2^( 5) =       0.000451279809
  error estimate for blocks of size 2^( 6) =       0.000459376993
  error estimate for blocks of size 2^( 7) =       0.000466444890

      target function =                  N/A
              le_mean =     -16.905672762793
             les_mean =     286.139553161892
             stat err =       0.000454352128
             autocorr =       1.268997755772
              std dev =       0.570396874641
             le_variance =       0.325352594600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325448300177
                                         uncertainty =       0.002207577935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325448300177
                                         uncertainty =       0.002207577935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403331498
  error estimate for blocks of size 2^( 2) =       0.000415560994
  error estimate for blocks of size 2^( 3) =       0.000428597208
  error estimate for blocks of size 2^( 4) =       0.000440306820
  error estimate for blocks of size 2^( 5) =       0.000451279809
  error estimate for blocks of size 2^( 6) =       0.000459376993
  error estimate for blocks of size 2^( 7) =       0.000466444890

      target function =                  N/A
              le_mean =     -16.905672762793
             les_mean =     286.139553161892
             stat err =       0.000454352128
             autocorr =       1.268997755772
              std dev =       0.570396874641
             le_variance =       0.325352594600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325448300177
                                         uncertainty =       0.002207577935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325448300177
                                         uncertainty =       0.002207577935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403331498
  error estimate for blocks of size 2^( 2) =       0.000415560994
  error estimate for blocks of size 2^( 3) =       0.000428597208
  error estimate for blocks of size 2^( 4) =       0.000440306820
  error estimate for blocks of size 2^( 5) =       0.000451279809
  error estimate for blocks of size 2^( 6) =       0.000459376993
  error estimate for blocks of size 2^( 7) =       0.000466444890

      target function =                  N/A
              le_mean =     -16.905672762793
             les_mean =     286.139553161892
             stat err =       0.000454352128
             autocorr =       1.268997755772
              std dev =       0.570396874641
             le_variance =       0.325352594600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905672762793        initial  <--
     1.4901e+17     1.4901e+18             2.1596e-21       -16.905672762793
     5.9605e+17     5.9605e+18             5.3990e-22       -16.905672762793
     2.3842e+18     2.3842e+19             1.3498e-22       -16.905672762793

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6472
  </log>
  <optVariables href="H2O.s042.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.9551
    reference variance = 0.32273
====================================================
  Execution time = 2.1336e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3945e-01
  Total weights = 1.951441678e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0987e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326426549280
                                         uncertainty =       0.002737450614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326426549280
                                         uncertainty =       0.002737450614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403968443
  error estimate for blocks of size 2^( 2) =       0.000416975113
  error estimate for blocks of size 2^( 3) =       0.000430088149
  error estimate for blocks of size 2^( 4) =       0.000442461048
  error estimate for blocks of size 2^( 5) =       0.000453772037
  error estimate for blocks of size 2^( 6) =       0.000460407361
  error estimate for blocks of size 2^( 7) =       0.000468602319

      target function =                  N/A
              le_mean =     -16.905661759972
             les_mean =     286.140848579786
             stat err =       0.000456310691
             autocorr =       1.275928705517
              std dev =       0.571297650626
             le_variance =       0.326381005611


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690566175997e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+18, overlap shift 1.4901e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905661759964       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905661759964       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+18, overlap shift 5.9605e+19 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905661759964       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905661759964       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+19, overlap shift 2.3842e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905661759964       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905661759964       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.398359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7445e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -16.885
    reference variance = 0.258165
====================================================
  Execution time = 2.1183e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3530e-01
  Total weights = 1.9519e+06
  Execution time = 1.9043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324005345574
                                         uncertainty =       0.002771614830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324005345574
                                         uncertainty =       0.002771614830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402583162
  error estimate for blocks of size 2^( 2) =       0.000414803244
  error estimate for blocks of size 2^( 3) =       0.000427184461
  error estimate for blocks of size 2^( 4) =       0.000439254378
  error estimate for blocks of size 2^( 5) =       0.000449602782
  error estimate for blocks of size 2^( 6) =       0.000455893840
  error estimate for blocks of size 2^( 7) =       0.000459095123

      target function =                  N/A
              le_mean =     -16.906228881588
             les_mean =     286.155872767971
             stat err =       0.000450961531
             autocorr =       1.254780551955
              std dev =       0.569338567738
             le_variance =       0.324146404714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324005345574
                                         uncertainty =       0.002771614830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324005345574
                                         uncertainty =       0.002771614830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402583162
  error estimate for blocks of size 2^( 2) =       0.000414803244
  error estimate for blocks of size 2^( 3) =       0.000427184461
  error estimate for blocks of size 2^( 4) =       0.000439254378
  error estimate for blocks of size 2^( 5) =       0.000449602782
  error estimate for blocks of size 2^( 6) =       0.000455893840
  error estimate for blocks of size 2^( 7) =       0.000459095123

      target function =                  N/A
              le_mean =     -16.906228881588
             les_mean =     286.155872767971
             stat err =       0.000450961531
             autocorr =       1.254780551955
              std dev =       0.569338567738
             le_variance =       0.324146404714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324005345574
                                         uncertainty =       0.002771614830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324005345574
                                         uncertainty =       0.002771614830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402583162
  error estimate for blocks of size 2^( 2) =       0.000414803244
  error estimate for blocks of size 2^( 3) =       0.000427184461
  error estimate for blocks of size 2^( 4) =       0.000439254378
  error estimate for blocks of size 2^( 5) =       0.000449602782
  error estimate for blocks of size 2^( 6) =       0.000455893840
  error estimate for blocks of size 2^( 7) =       0.000459095123

      target function =                  N/A
              le_mean =     -16.906228881588
             les_mean =     286.155872767971
             stat err =       0.000450961531
             autocorr =       1.254780551955
              std dev =       0.569338567738
             le_variance =       0.324146404714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324005345574
                                         uncertainty =       0.002771614830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324005345574
                                         uncertainty =       0.002771614830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402583162
  error estimate for blocks of size 2^( 2) =       0.000414803244
  error estimate for blocks of size 2^( 3) =       0.000427184461
  error estimate for blocks of size 2^( 4) =       0.000439254378
  error estimate for blocks of size 2^( 5) =       0.000449602782
  error estimate for blocks of size 2^( 6) =       0.000455893840
  error estimate for blocks of size 2^( 7) =       0.000459095123

      target function =                  N/A
              le_mean =     -16.906228881588
             les_mean =     286.155872767971
             stat err =       0.000450961531
             autocorr =       1.254780551955
              std dev =       0.569338567738
             le_variance =       0.324146404714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906228881588        initial  <--
     1.4901e+18     1.4901e+19             0.0000e+00       -16.906228881588
     5.9605e+18     5.9605e+19             0.0000e+00       -16.906228881588
     2.3842e+19     2.3842e+20             0.0000e+00       -16.906228881588

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8188
  </log>
  <optVariables href="H2O.s043.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8272e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.8847
    reference variance = 0.181407
====================================================
  Execution time = 2.1346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3553e-01
  Total weights = 1.951368442e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323242907691
                                         uncertainty =       0.002626533284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323242907691
                                         uncertainty =       0.002626533284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401972106
  error estimate for blocks of size 2^( 2) =       0.000414674758
  error estimate for blocks of size 2^( 3) =       0.000427002342
  error estimate for blocks of size 2^( 4) =       0.000439035900
  error estimate for blocks of size 2^( 5) =       0.000448130968
  error estimate for blocks of size 2^( 6) =       0.000455690531
  error estimate for blocks of size 2^( 7) =       0.000459562391

      target function =                  N/A
              le_mean =     -16.906591016123
             les_mean =     286.168348527118
             stat err =       0.000450604948
             autocorr =       1.256608743727
              std dev =       0.568474404115
             le_variance =       0.323163148134


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690659101612e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+19, overlap shift 1.4901e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906591016122       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906591016122       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+19, overlap shift 5.9605e+20 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906591016122       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906591016122       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+20, overlap shift 2.3842e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906591016122       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906591016122       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.399556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7423e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -16.905
    reference variance = 0.17041
====================================================
  Execution time = 2.1205e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3479e-01
  Total weights = 1.9514e+06
  Execution time = 1.8959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321931300161
                                         uncertainty =       0.001796738804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321931300161
                                         uncertainty =       0.001796738804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401189525
  error estimate for blocks of size 2^( 2) =       0.000413685271
  error estimate for blocks of size 2^( 3) =       0.000426228194
  error estimate for blocks of size 2^( 4) =       0.000438807687
  error estimate for blocks of size 2^( 5) =       0.000448996890
  error estimate for blocks of size 2^( 6) =       0.000456512156
  error estimate for blocks of size 2^( 7) =       0.000462208142

      target function =                  N/A
              le_mean =     -16.905822790494
             les_mean =     286.141630231127
             stat err =       0.000451631219
             autocorr =       1.267268788468
              std dev =       0.567367667212
             le_variance =       0.321906069797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321931300161
                                         uncertainty =       0.001796738804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321931300161
                                         uncertainty =       0.001796738804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401189525
  error estimate for blocks of size 2^( 2) =       0.000413685271
  error estimate for blocks of size 2^( 3) =       0.000426228194
  error estimate for blocks of size 2^( 4) =       0.000438807687
  error estimate for blocks of size 2^( 5) =       0.000448996890
  error estimate for blocks of size 2^( 6) =       0.000456512156
  error estimate for blocks of size 2^( 7) =       0.000462208142

      target function =                  N/A
              le_mean =     -16.905822790494
             les_mean =     286.141630231127
             stat err =       0.000451631219
             autocorr =       1.267268788468
              std dev =       0.567367667212
             le_variance =       0.321906069797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321931300161
                                         uncertainty =       0.001796738804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321931300161
                                         uncertainty =       0.001796738804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401189525
  error estimate for blocks of size 2^( 2) =       0.000413685271
  error estimate for blocks of size 2^( 3) =       0.000426228194
  error estimate for blocks of size 2^( 4) =       0.000438807687
  error estimate for blocks of size 2^( 5) =       0.000448996890
  error estimate for blocks of size 2^( 6) =       0.000456512156
  error estimate for blocks of size 2^( 7) =       0.000462208142

      target function =                  N/A
              le_mean =     -16.905822790494
             les_mean =     286.141630231127
             stat err =       0.000451631219
             autocorr =       1.267268788468
              std dev =       0.567367667212
             le_variance =       0.321906069797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321931300161
                                         uncertainty =       0.001796738804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321931300161
                                         uncertainty =       0.001796738804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401189525
  error estimate for blocks of size 2^( 2) =       0.000413685271
  error estimate for blocks of size 2^( 3) =       0.000426228194
  error estimate for blocks of size 2^( 4) =       0.000438807687
  error estimate for blocks of size 2^( 5) =       0.000448996890
  error estimate for blocks of size 2^( 6) =       0.000456512156
  error estimate for blocks of size 2^( 7) =       0.000462208142

      target function =                  N/A
              le_mean =     -16.905822790494
             les_mean =     286.141630231127
             stat err =       0.000451631219
             autocorr =       1.267268788468
              std dev =       0.567367667212
             le_variance =       0.321906069797


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905822790494        initial  <--
     1.4901e+19     1.4901e+20             0.0000e+00       -16.905822790494
     5.9605e+19     5.9605e+20             0.0000e+00       -16.905822790494
     2.3842e+20     2.3842e+21             0.0000e+00       -16.905822790494

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7910
  </log>
  <optVariables href="H2O.s044.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8222e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.32923
====================================================
  Execution time = 2.1165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3680e-01
  Total weights = 1.951501748e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1464e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322952818399
                                         uncertainty =       0.002266972677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322952818399
                                         uncertainty =       0.002266972677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401820051
  error estimate for blocks of size 2^( 2) =       0.000414461015
  error estimate for blocks of size 2^( 3) =       0.000426959121
  error estimate for blocks of size 2^( 4) =       0.000439723833
  error estimate for blocks of size 2^( 5) =       0.000450235405
  error estimate for blocks of size 2^( 6) =       0.000456831939
  error estimate for blocks of size 2^( 7) =       0.000461350840

      target function =                  N/A
              le_mean =     -16.904835032619
             les_mean =     286.110243598093
             stat err =       0.000452035504
             autocorr =       1.265557512529
              std dev =       0.568259365132
             le_variance =       0.322918706060


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690483503262e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+20, overlap shift 1.4901e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904835032612       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904835032612       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904835032612       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904835032612       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904835032598       residual = 5.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.480533823774       residual = 2.35e+01           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+20 is 2.534364e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+20, overlap shift 5.9605e+21 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904835032612       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904835032612       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904835032612       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904835032612       residual = 3.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+20 is 6.335909e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+21, overlap shift 2.3842e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904835032612       residual = 1.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904835032612       residual = 5.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.904835032612       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.904835032612       residual = 3.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+21 is 1.583977e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.401606 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7322e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -16.8713
    reference variance = 0.174685
====================================================
  Execution time = 2.0894e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3633e-01
  Total weights = 1.9517e+06
  Execution time = 1.9077e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323049938560
                                         uncertainty =       0.002427538352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323049938560
                                         uncertainty =       0.002427538352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401854811
  error estimate for blocks of size 2^( 2) =       0.000414992686
  error estimate for blocks of size 2^( 3) =       0.000428055736
  error estimate for blocks of size 2^( 4) =       0.000439955778
  error estimate for blocks of size 2^( 5) =       0.000450042420
  error estimate for blocks of size 2^( 6) =       0.000456403147
  error estimate for blocks of size 2^( 7) =       0.000461536084

      target function =                  N/A
              le_mean =     -16.906778740065
             les_mean =     286.175494776134
             stat err =       0.000451984357
             autocorr =       1.265052252659
              std dev =       0.568308524505
             le_variance =       0.322974579025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323049938560
                                         uncertainty =       0.002427538352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323049938560
                                         uncertainty =       0.002427538352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401854811
  error estimate for blocks of size 2^( 2) =       0.000414992686
  error estimate for blocks of size 2^( 3) =       0.000428055736
  error estimate for blocks of size 2^( 4) =       0.000439955778
  error estimate for blocks of size 2^( 5) =       0.000450042420
  error estimate for blocks of size 2^( 6) =       0.000456403147
  error estimate for blocks of size 2^( 7) =       0.000461536084

      target function =                  N/A
              le_mean =     -16.906778740065
             les_mean =     286.175494776134
             stat err =       0.000451984357
             autocorr =       1.265052252659
              std dev =       0.568308524505
             le_variance =       0.322974579025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323049938560
                                         uncertainty =       0.002427538352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323049938560
                                         uncertainty =       0.002427538352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401854811
  error estimate for blocks of size 2^( 2) =       0.000414992686
  error estimate for blocks of size 2^( 3) =       0.000428055736
  error estimate for blocks of size 2^( 4) =       0.000439955778
  error estimate for blocks of size 2^( 5) =       0.000450042420
  error estimate for blocks of size 2^( 6) =       0.000456403147
  error estimate for blocks of size 2^( 7) =       0.000461536084

      target function =                  N/A
              le_mean =     -16.906778740065
             les_mean =     286.175494776134
             stat err =       0.000451984357
             autocorr =       1.265052252659
              std dev =       0.568308524505
             le_variance =       0.322974579025

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323049938560
                                         uncertainty =       0.002427538352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323049938560
                                         uncertainty =       0.002427538352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401854811
  error estimate for blocks of size 2^( 2) =       0.000414992686
  error estimate for blocks of size 2^( 3) =       0.000428055736
  error estimate for blocks of size 2^( 4) =       0.000439955778
  error estimate for blocks of size 2^( 5) =       0.000450042420
  error estimate for blocks of size 2^( 6) =       0.000456403147
  error estimate for blocks of size 2^( 7) =       0.000461536084

      target function =                  N/A
              le_mean =     -16.906778740065
             les_mean =     286.175494776134
             stat err =       0.000451984357
             autocorr =       1.265052252659
              std dev =       0.568308524505
             le_variance =       0.322974579025


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906778740065        initial  <--
     1.4901e+20     1.4901e+21             2.5344e-24       -16.906778740065
     5.9605e+20     5.9605e+21             6.3359e-25       -16.906778740065
     2.3842e+21     2.3842e+22             1.5840e-25       -16.906778740065

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5367
  </log>
  <optVariables href="H2O.s045.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7866e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.949
    reference variance = 0.215718
====================================================
  Execution time = 2.1508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.4518e-01
  Total weights = 1.951746075e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325374028970
                                         uncertainty =       0.002452792471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325374028970
                                         uncertainty =       0.002452792471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403357512
  error estimate for blocks of size 2^( 2) =       0.000415684963
  error estimate for blocks of size 2^( 3) =       0.000428548294
  error estimate for blocks of size 2^( 4) =       0.000440656853
  error estimate for blocks of size 2^( 5) =       0.000452042184
  error estimate for blocks of size 2^( 6) =       0.000460023854
  error estimate for blocks of size 2^( 7) =       0.000467297025

      target function =                  N/A
              le_mean =     -16.907519780057
             les_mean =     286.209400605193
             stat err =       0.000455004979
             autocorr =       1.272483029899
              std dev =       0.570433663768
             le_variance =       0.325394564759


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690751978006e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+21, overlap shift 1.4901e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907519780059       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907519780059       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+21, overlap shift 5.9605e+22 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907519780059       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907519780059       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+22, overlap shift 2.3842e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907519780059       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907519780059       residual = 4.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.402786 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7608e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -16.9368
    reference variance = 0.28339
====================================================
  Execution time = 2.3118e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3753e-01
  Total weights = 1.9518e+06
  Execution time = 1.9004e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325314005514
                                         uncertainty =       0.002779042720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325314005514
                                         uncertainty =       0.002779042720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403347554
  error estimate for blocks of size 2^( 2) =       0.000416503668
  error estimate for blocks of size 2^( 3) =       0.000430323077
  error estimate for blocks of size 2^( 4) =       0.000441815178
  error estimate for blocks of size 2^( 5) =       0.000453139180
  error estimate for blocks of size 2^( 6) =       0.000462938088
  error estimate for blocks of size 2^( 7) =       0.000469436414

      target function =                  N/A
              le_mean =     -16.906430617783
             les_mean =     286.164924257866
             stat err =       0.000456832215
             autocorr =       1.282787112677
              std dev =       0.570419581782
             le_variance =       0.325378499281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325314005514
                                         uncertainty =       0.002779042720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325314005514
                                         uncertainty =       0.002779042720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403347554
  error estimate for blocks of size 2^( 2) =       0.000416503668
  error estimate for blocks of size 2^( 3) =       0.000430323077
  error estimate for blocks of size 2^( 4) =       0.000441815178
  error estimate for blocks of size 2^( 5) =       0.000453139180
  error estimate for blocks of size 2^( 6) =       0.000462938088
  error estimate for blocks of size 2^( 7) =       0.000469436414

      target function =                  N/A
              le_mean =     -16.906430617783
             les_mean =     286.164924257866
             stat err =       0.000456832215
             autocorr =       1.282787112677
              std dev =       0.570419581782
             le_variance =       0.325378499281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325314005514
                                         uncertainty =       0.002779042720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325314005514
                                         uncertainty =       0.002779042720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403347554
  error estimate for blocks of size 2^( 2) =       0.000416503668
  error estimate for blocks of size 2^( 3) =       0.000430323077
  error estimate for blocks of size 2^( 4) =       0.000441815178
  error estimate for blocks of size 2^( 5) =       0.000453139180
  error estimate for blocks of size 2^( 6) =       0.000462938088
  error estimate for blocks of size 2^( 7) =       0.000469436414

      target function =                  N/A
              le_mean =     -16.906430617783
             les_mean =     286.164924257866
             stat err =       0.000456832215
             autocorr =       1.282787112677
              std dev =       0.570419581782
             le_variance =       0.325378499281

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325314005514
                                         uncertainty =       0.002779042720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325314005514
                                         uncertainty =       0.002779042720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403347554
  error estimate for blocks of size 2^( 2) =       0.000416503668
  error estimate for blocks of size 2^( 3) =       0.000430323077
  error estimate for blocks of size 2^( 4) =       0.000441815178
  error estimate for blocks of size 2^( 5) =       0.000453139180
  error estimate for blocks of size 2^( 6) =       0.000462938088
  error estimate for blocks of size 2^( 7) =       0.000469436414

      target function =                  N/A
              le_mean =     -16.906430617783
             les_mean =     286.164924257866
             stat err =       0.000456832215
             autocorr =       1.282787112677
              std dev =       0.570419581782
             le_variance =       0.325378499281


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906430617783        initial  <--
     1.4901e+21     1.4901e+22             0.0000e+00       -16.906430617783
     5.9605e+21     5.9605e+22             0.0000e+00       -16.906430617783
     2.3842e+22     2.3842e+23             0.0000e+00       -16.906430617783

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.7295
  </log>
  <optVariables href="H2O.s046.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9391
    reference variance = 0.502567
====================================================
  Execution time = 2.1401e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3996e-01
  Total weights = 1.951689456e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325688745606
                                         uncertainty =       0.002887584639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325688745606
                                         uncertainty =       0.002887584639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403580612
  error estimate for blocks of size 2^( 2) =       0.000416473991
  error estimate for blocks of size 2^( 3) =       0.000430335724
  error estimate for blocks of size 2^( 4) =       0.000443818965
  error estimate for blocks of size 2^( 5) =       0.000456503164
  error estimate for blocks of size 2^( 6) =       0.000466652651
  error estimate for blocks of size 2^( 7) =       0.000470912261

      target function =                  N/A
              le_mean =     -16.905581370885
             les_mean =     286.138637793419
             stat err =       0.000459471760
             autocorr =       1.296155358357
              std dev =       0.570749174736
             le_variance =       0.325754620461


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690558137088e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+22, overlap shift 1.4901e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905581370881       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905581370881       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905581370881       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905581370881       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+22 is 2.521760e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+22, overlap shift 5.9605e+23 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905581370881       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905581370881       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905581370881       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905581370881       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905581370869       residual = 2.21e+00           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+22 is 6.534574e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+23, overlap shift 2.3842e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905581370881       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905581370881       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905581370881       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905581370881       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+23 is 1.576100e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.404686 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7547e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -16.9573
    reference variance = 0.245378
====================================================
  Execution time = 2.1999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3629e-01
  Total weights = 1.9515e+06
  Execution time = 1.9035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322746962169
                                         uncertainty =       0.002283604059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322746962169
                                         uncertainty =       0.002283604059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401699277
  error estimate for blocks of size 2^( 2) =       0.000414064809
  error estimate for blocks of size 2^( 3) =       0.000427753764
  error estimate for blocks of size 2^( 4) =       0.000440030692
  error estimate for blocks of size 2^( 5) =       0.000450760517
  error estimate for blocks of size 2^( 6) =       0.000457642992
  error estimate for blocks of size 2^( 7) =       0.000464401362

      target function =                  N/A
              le_mean =     -16.905444830558
             les_mean =     286.130359109738
             stat err =       0.000453208891
             autocorr =       1.272901333272
              std dev =       0.568088565749
             le_variance =       0.322724618535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322746962169
                                         uncertainty =       0.002283604059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322746962169
                                         uncertainty =       0.002283604059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401699277
  error estimate for blocks of size 2^( 2) =       0.000414064809
  error estimate for blocks of size 2^( 3) =       0.000427753764
  error estimate for blocks of size 2^( 4) =       0.000440030692
  error estimate for blocks of size 2^( 5) =       0.000450760517
  error estimate for blocks of size 2^( 6) =       0.000457642992
  error estimate for blocks of size 2^( 7) =       0.000464401362

      target function =                  N/A
              le_mean =     -16.905444830558
             les_mean =     286.130359109738
             stat err =       0.000453208891
             autocorr =       1.272901333272
              std dev =       0.568088565749
             le_variance =       0.322724618535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322746962169
                                         uncertainty =       0.002283604059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322746962169
                                         uncertainty =       0.002283604059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401699277
  error estimate for blocks of size 2^( 2) =       0.000414064809
  error estimate for blocks of size 2^( 3) =       0.000427753764
  error estimate for blocks of size 2^( 4) =       0.000440030692
  error estimate for blocks of size 2^( 5) =       0.000450760517
  error estimate for blocks of size 2^( 6) =       0.000457642992
  error estimate for blocks of size 2^( 7) =       0.000464401362

      target function =                  N/A
              le_mean =     -16.905444830558
             les_mean =     286.130359109738
             stat err =       0.000453208891
             autocorr =       1.272901333272
              std dev =       0.568088565749
             le_variance =       0.322724618535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322746962169
                                         uncertainty =       0.002283604059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322746962169
                                         uncertainty =       0.002283604059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401699277
  error estimate for blocks of size 2^( 2) =       0.000414064809
  error estimate for blocks of size 2^( 3) =       0.000427753764
  error estimate for blocks of size 2^( 4) =       0.000440030692
  error estimate for blocks of size 2^( 5) =       0.000450760517
  error estimate for blocks of size 2^( 6) =       0.000457642992
  error estimate for blocks of size 2^( 7) =       0.000464401362

      target function =                  N/A
              le_mean =     -16.905444830558
             les_mean =     286.130359109738
             stat err =       0.000453208891
             autocorr =       1.272901333272
              std dev =       0.568088565749
             le_variance =       0.322724618535


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905444830558        initial  <--
     1.4901e+22     1.4901e+23             2.5218e-26       -16.905444830558
     5.9605e+22     5.9605e+23             6.5346e-27       -16.905444830558
     2.3842e+23     2.3842e+24             1.5761e-27       -16.905444830558

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6234
  </log>
  <optVariables href="H2O.s047.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9178e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6907e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.8291
    reference variance = 0.25274
====================================================
  Execution time = 2.1143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3292e-01
  Total weights = 1.951941653e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1083e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321202897617
                                         uncertainty =       0.001836068825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321202897617
                                         uncertainty =       0.001836068825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400723138
  error estimate for blocks of size 2^( 2) =       0.000413412237
  error estimate for blocks of size 2^( 3) =       0.000426606061
  error estimate for blocks of size 2^( 4) =       0.000438544041
  error estimate for blocks of size 2^( 5) =       0.000447809340
  error estimate for blocks of size 2^( 6) =       0.000454768774
  error estimate for blocks of size 2^( 7) =       0.000462063798

      target function =                  N/A
              le_mean =     -16.906861356678
             les_mean =     286.174884059953
             stat err =       0.000450796488
             autocorr =       1.265529313419
              std dev =       0.566708096592
             le_variance =       0.321158066743


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690686135668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+23, overlap shift 1.4901e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906861356638       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906861356638       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+23, overlap shift 5.9605e+24 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906861356638       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906861356638       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+24, overlap shift 2.3842e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906861356638       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906861356638       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.405882 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7262e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -16.8214
    reference variance = 0.369316
====================================================
  Execution time = 2.2156e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3221e-01
  Total weights = 1.9516e+06
  Execution time = 1.9069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320021108750
                                         uncertainty =       0.002063556861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320021108750
                                         uncertainty =       0.002063556861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400048726
  error estimate for blocks of size 2^( 2) =       0.000413309748
  error estimate for blocks of size 2^( 3) =       0.000425994383
  error estimate for blocks of size 2^( 4) =       0.000438505811
  error estimate for blocks of size 2^( 5) =       0.000447629833
  error estimate for blocks of size 2^( 6) =       0.000455176405
  error estimate for blocks of size 2^( 7) =       0.000460519413

      target function =                  N/A
              le_mean =     -16.906280389352
             les_mean =     286.154524670802
             stat err =       0.000450457866
             autocorr =       1.267892892279
              std dev =       0.565754333302
             le_variance =       0.320077965650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320021108750
                                         uncertainty =       0.002063556861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320021108750
                                         uncertainty =       0.002063556861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400048726
  error estimate for blocks of size 2^( 2) =       0.000413309748
  error estimate for blocks of size 2^( 3) =       0.000425994383
  error estimate for blocks of size 2^( 4) =       0.000438505811
  error estimate for blocks of size 2^( 5) =       0.000447629833
  error estimate for blocks of size 2^( 6) =       0.000455176405
  error estimate for blocks of size 2^( 7) =       0.000460519413

      target function =                  N/A
              le_mean =     -16.906280389352
             les_mean =     286.154524670802
             stat err =       0.000450457866
             autocorr =       1.267892892279
              std dev =       0.565754333302
             le_variance =       0.320077965650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320021108750
                                         uncertainty =       0.002063556861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320021108750
                                         uncertainty =       0.002063556861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400048726
  error estimate for blocks of size 2^( 2) =       0.000413309748
  error estimate for blocks of size 2^( 3) =       0.000425994383
  error estimate for blocks of size 2^( 4) =       0.000438505811
  error estimate for blocks of size 2^( 5) =       0.000447629833
  error estimate for blocks of size 2^( 6) =       0.000455176405
  error estimate for blocks of size 2^( 7) =       0.000460519413

      target function =                  N/A
              le_mean =     -16.906280389352
             les_mean =     286.154524670802
             stat err =       0.000450457866
             autocorr =       1.267892892279
              std dev =       0.565754333302
             le_variance =       0.320077965650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320021108750
                                         uncertainty =       0.002063556861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320021108750
                                         uncertainty =       0.002063556861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400048726
  error estimate for blocks of size 2^( 2) =       0.000413309748
  error estimate for blocks of size 2^( 3) =       0.000425994383
  error estimate for blocks of size 2^( 4) =       0.000438505811
  error estimate for blocks of size 2^( 5) =       0.000447629833
  error estimate for blocks of size 2^( 6) =       0.000455176405
  error estimate for blocks of size 2^( 7) =       0.000460519413

      target function =                  N/A
              le_mean =     -16.906280389352
             les_mean =     286.154524670802
             stat err =       0.000450457866
             autocorr =       1.267892892279
              std dev =       0.565754333302
             le_variance =       0.320077965650


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906280389352        initial  <--
     1.4901e+23     1.4901e+24             0.0000e+00       -16.906280389352
     5.9605e+23     5.9605e+24             0.0000e+00       -16.906280389352
     2.3842e+24     2.3842e+25             0.0000e+00       -16.906280389352

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7995
  </log>
  <optVariables href="H2O.s048.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9069e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.9792
    reference variance = 0.272827
====================================================
  Execution time = 2.1581e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5221e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3140e-01
  Total weights = 1.951225305e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1546e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321330508293
                                         uncertainty =       0.002064878291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321330508293
                                         uncertainty =       0.002064878291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400786579
  error estimate for blocks of size 2^( 2) =       0.000413573959
  error estimate for blocks of size 2^( 3) =       0.000426825738
  error estimate for blocks of size 2^( 4) =       0.000438671563
  error estimate for blocks of size 2^( 5) =       0.000448369448
  error estimate for blocks of size 2^( 6) =       0.000456067620
  error estimate for blocks of size 2^( 7) =       0.000460010658

      target function =                  N/A
              le_mean =     -16.907133792049
             les_mean =     286.182568920167
             stat err =       0.000450779822
             autocorr =       1.265035159183
              std dev =       0.566797815750
             le_variance =       0.321259763939


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690713379205e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+24, overlap shift 1.4901e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907133792033       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907133792033       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+24, overlap shift 5.9605e+25 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907133792033       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907133792033       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+25, overlap shift 2.3842e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907133792033       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907133792033       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.407071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7746e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -16.8397
    reference variance = 0.207247
====================================================
  Execution time = 2.1139e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3535e-01
  Total weights = 1.9516e+06
  Execution time = 1.9065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324963205820
                                         uncertainty =       0.002276443100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324963205820
                                         uncertainty =       0.002276443100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403098272
  error estimate for blocks of size 2^( 2) =       0.000415734212
  error estimate for blocks of size 2^( 3) =       0.000429137592
  error estimate for blocks of size 2^( 4) =       0.000440969219
  error estimate for blocks of size 2^( 5) =       0.000451652567
  error estimate for blocks of size 2^( 6) =       0.000458059277
  error estimate for blocks of size 2^( 7) =       0.000462078511

      target function =                  N/A
              le_mean =     -16.906582026219
             les_mean =     286.167866542938
             stat err =       0.000453189893
             autocorr =       1.263975218063
              std dev =       0.570067043356
             le_variance =       0.324976433920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324963205820
                                         uncertainty =       0.002276443100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324963205820
                                         uncertainty =       0.002276443100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403098272
  error estimate for blocks of size 2^( 2) =       0.000415734212
  error estimate for blocks of size 2^( 3) =       0.000429137592
  error estimate for blocks of size 2^( 4) =       0.000440969219
  error estimate for blocks of size 2^( 5) =       0.000451652567
  error estimate for blocks of size 2^( 6) =       0.000458059277
  error estimate for blocks of size 2^( 7) =       0.000462078511

      target function =                  N/A
              le_mean =     -16.906582026219
             les_mean =     286.167866542938
             stat err =       0.000453189893
             autocorr =       1.263975218063
              std dev =       0.570067043356
             le_variance =       0.324976433920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324963205820
                                         uncertainty =       0.002276443100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324963205820
                                         uncertainty =       0.002276443100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403098272
  error estimate for blocks of size 2^( 2) =       0.000415734212
  error estimate for blocks of size 2^( 3) =       0.000429137592
  error estimate for blocks of size 2^( 4) =       0.000440969219
  error estimate for blocks of size 2^( 5) =       0.000451652567
  error estimate for blocks of size 2^( 6) =       0.000458059277
  error estimate for blocks of size 2^( 7) =       0.000462078511

      target function =                  N/A
              le_mean =     -16.906582026219
             les_mean =     286.167866542938
             stat err =       0.000453189893
             autocorr =       1.263975218063
              std dev =       0.570067043356
             le_variance =       0.324976433920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324963205820
                                         uncertainty =       0.002276443100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324963205820
                                         uncertainty =       0.002276443100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403098272
  error estimate for blocks of size 2^( 2) =       0.000415734212
  error estimate for blocks of size 2^( 3) =       0.000429137592
  error estimate for blocks of size 2^( 4) =       0.000440969219
  error estimate for blocks of size 2^( 5) =       0.000451652567
  error estimate for blocks of size 2^( 6) =       0.000458059277
  error estimate for blocks of size 2^( 7) =       0.000462078511

      target function =                  N/A
              le_mean =     -16.906582026219
             les_mean =     286.167866542938
             stat err =       0.000453189893
             autocorr =       1.263975218063
              std dev =       0.570067043356
             le_variance =       0.324976433920


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906582026219        initial  <--
     1.4901e+24     1.4901e+25             0.0000e+00       -16.906582026219
     5.9605e+24     5.9605e+25             0.0000e+00       -16.906582026219
     2.3842e+25     2.3842e+26             0.0000e+00       -16.906582026219

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7966
  </log>
  <optVariables href="H2O.s049.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8550e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -16.8763
    reference variance = 0.275995
====================================================
  Execution time = 2.1202e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5260e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3581e-01
  Total weights = 1.951970569e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681546774
                                         uncertainty =       0.002570050110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323681546774
                                         uncertainty =       0.002570050110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402280686
  error estimate for blocks of size 2^( 2) =       0.000415112885
  error estimate for blocks of size 2^( 3) =       0.000428719399
  error estimate for blocks of size 2^( 4) =       0.000441349526
  error estimate for blocks of size 2^( 5) =       0.000451887258
  error estimate for blocks of size 2^( 6) =       0.000460001984
  error estimate for blocks of size 2^( 7) =       0.000462672992

      target function =                  N/A
              le_mean =     -16.905733140652
             les_mean =     286.139621495673
             stat err =       0.000453977940
             autocorr =       1.273535735602
              std dev =       0.568910801896
             le_variance =       0.323659500514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573314065e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+25, overlap shift 1.4901e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733140687       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905733140687       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+25, overlap shift 5.9605e+26 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733140687       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905733140687       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+26, overlap shift 2.3842e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733140687       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905733140687       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.408256 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7301e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.0027
    reference variance = 0.247053
====================================================
  Execution time = 2.1030e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3661e-01
  Total weights = 1.9518e+06
  Execution time = 1.8965e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820453899
                                         uncertainty =       0.002306615644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820453899
                                         uncertainty =       0.002306615644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400497758
  error estimate for blocks of size 2^( 2) =       0.000413285321
  error estimate for blocks of size 2^( 3) =       0.000426923866
  error estimate for blocks of size 2^( 4) =       0.000438801015
  error estimate for blocks of size 2^( 5) =       0.000449500932
  error estimate for blocks of size 2^( 6) =       0.000456917984
  error estimate for blocks of size 2^( 7) =       0.000460574488

      target function =                  N/A
              le_mean =     -16.906756699930
             les_mean =     286.175036488571
             stat err =       0.000451448605
             autocorr =       1.270622236937
              std dev =       0.566389361076
             le_variance =       0.320796908340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820453899
                                         uncertainty =       0.002306615644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820453899
                                         uncertainty =       0.002306615644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400497758
  error estimate for blocks of size 2^( 2) =       0.000413285321
  error estimate for blocks of size 2^( 3) =       0.000426923866
  error estimate for blocks of size 2^( 4) =       0.000438801015
  error estimate for blocks of size 2^( 5) =       0.000449500932
  error estimate for blocks of size 2^( 6) =       0.000456917984
  error estimate for blocks of size 2^( 7) =       0.000460574488

      target function =                  N/A
              le_mean =     -16.906756699930
             les_mean =     286.175036488571
             stat err =       0.000451448605
             autocorr =       1.270622236937
              std dev =       0.566389361076
             le_variance =       0.320796908340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820453899
                                         uncertainty =       0.002306615644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820453899
                                         uncertainty =       0.002306615644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400497758
  error estimate for blocks of size 2^( 2) =       0.000413285321
  error estimate for blocks of size 2^( 3) =       0.000426923866
  error estimate for blocks of size 2^( 4) =       0.000438801015
  error estimate for blocks of size 2^( 5) =       0.000449500932
  error estimate for blocks of size 2^( 6) =       0.000456917984
  error estimate for blocks of size 2^( 7) =       0.000460574488

      target function =                  N/A
              le_mean =     -16.906756699930
             les_mean =     286.175036488571
             stat err =       0.000451448605
             autocorr =       1.270622236937
              std dev =       0.566389361076
             le_variance =       0.320796908340

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820453899
                                         uncertainty =       0.002306615644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320820453899
                                         uncertainty =       0.002306615644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400497758
  error estimate for blocks of size 2^( 2) =       0.000413285321
  error estimate for blocks of size 2^( 3) =       0.000426923866
  error estimate for blocks of size 2^( 4) =       0.000438801015
  error estimate for blocks of size 2^( 5) =       0.000449500932
  error estimate for blocks of size 2^( 6) =       0.000456917984
  error estimate for blocks of size 2^( 7) =       0.000460574488

      target function =                  N/A
              le_mean =     -16.906756699930
             les_mean =     286.175036488571
             stat err =       0.000451448605
             autocorr =       1.270622236937
              std dev =       0.566389361076
             le_variance =       0.320796908340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906756699930        initial  <--
     1.4901e+25     1.4901e+26             0.0000e+00       -16.906756699930
     5.9605e+25     5.9605e+26             0.0000e+00       -16.906756699930
     2.3842e+26     2.3842e+27             0.0000e+00       -16.906756699930

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6232
  </log>
  <optVariables href="H2O.s050.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7931e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9144
    reference variance = 0.316712
====================================================
  Execution time = 2.1271e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4020e-01
  Total weights = 1.951641239e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327606710521
                                         uncertainty =       0.003361253172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327606710521
                                         uncertainty =       0.003361253172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404686702
  error estimate for blocks of size 2^( 2) =       0.000417419158
  error estimate for blocks of size 2^( 3) =       0.000430584019
  error estimate for blocks of size 2^( 4) =       0.000443067239
  error estimate for blocks of size 2^( 5) =       0.000452890258
  error estimate for blocks of size 2^( 6) =       0.000460933890
  error estimate for blocks of size 2^( 7) =       0.000465528371

      target function =                  N/A
              le_mean =     -16.905735539408
             les_mean =     286.144096487564
             stat err =       0.000455604940
             autocorr =       1.267473771018
              std dev =       0.572313422184
             le_variance =       0.327542653212


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573553941e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+26, overlap shift 1.4901e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905735539385       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905735539385       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+26, overlap shift 5.9605e+27 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905735539385       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905735539385       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+27, overlap shift 2.3842e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905735539385       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905735539385       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.409450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7360e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -16.9182
    reference variance = 0.225943
====================================================
  Execution time = 2.3190e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3339e-01
  Total weights = 1.9518e+06
  Execution time = 1.9099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323208210676
                                         uncertainty =       0.002124544036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323208210676
                                         uncertainty =       0.002124544036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401955913
  error estimate for blocks of size 2^( 2) =       0.000414782241
  error estimate for blocks of size 2^( 3) =       0.000428841591
  error estimate for blocks of size 2^( 4) =       0.000441892157
  error estimate for blocks of size 2^( 5) =       0.000454508639
  error estimate for blocks of size 2^( 6) =       0.000462449823
  error estimate for blocks of size 2^( 7) =       0.000467119235

      target function =                  N/A
              le_mean =     -16.906146287119
             les_mean =     286.151170593332
             stat err =       0.000456492463
             autocorr =       1.289764386837
              std dev =       0.568451503085
             le_variance =       0.323137111359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323208210676
                                         uncertainty =       0.002124544036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323208210676
                                         uncertainty =       0.002124544036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401955913
  error estimate for blocks of size 2^( 2) =       0.000414782241
  error estimate for blocks of size 2^( 3) =       0.000428841591
  error estimate for blocks of size 2^( 4) =       0.000441892157
  error estimate for blocks of size 2^( 5) =       0.000454508639
  error estimate for blocks of size 2^( 6) =       0.000462449823
  error estimate for blocks of size 2^( 7) =       0.000467119235

      target function =                  N/A
              le_mean =     -16.906146287119
             les_mean =     286.151170593332
             stat err =       0.000456492463
             autocorr =       1.289764386837
              std dev =       0.568451503085
             le_variance =       0.323137111359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323208210676
                                         uncertainty =       0.002124544036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323208210676
                                         uncertainty =       0.002124544036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401955913
  error estimate for blocks of size 2^( 2) =       0.000414782241
  error estimate for blocks of size 2^( 3) =       0.000428841591
  error estimate for blocks of size 2^( 4) =       0.000441892157
  error estimate for blocks of size 2^( 5) =       0.000454508639
  error estimate for blocks of size 2^( 6) =       0.000462449823
  error estimate for blocks of size 2^( 7) =       0.000467119235

      target function =                  N/A
              le_mean =     -16.906146287119
             les_mean =     286.151170593332
             stat err =       0.000456492463
             autocorr =       1.289764386837
              std dev =       0.568451503085
             le_variance =       0.323137111359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323208210676
                                         uncertainty =       0.002124544036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323208210676
                                         uncertainty =       0.002124544036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401955913
  error estimate for blocks of size 2^( 2) =       0.000414782241
  error estimate for blocks of size 2^( 3) =       0.000428841591
  error estimate for blocks of size 2^( 4) =       0.000441892157
  error estimate for blocks of size 2^( 5) =       0.000454508639
  error estimate for blocks of size 2^( 6) =       0.000462449823
  error estimate for blocks of size 2^( 7) =       0.000467119235

      target function =                  N/A
              le_mean =     -16.906146287119
             les_mean =     286.151170593332
             stat err =       0.000456492463
             autocorr =       1.289764386837
              std dev =       0.568451503085
             le_variance =       0.323137111359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906146287119        initial  <--
     1.4901e+26     1.4901e+27             0.0000e+00       -16.906146287119
     5.9605e+26     5.9605e+27             0.0000e+00       -16.906146287119
     2.3842e+27     2.3842e+28             0.0000e+00       -16.906146287119

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.8466
  </log>
  <optVariables href="H2O.s051.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0215e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.8969
    reference variance = 0.21167
====================================================
  Execution time = 2.1326e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5186e-01
  Total weights = 1.951595250e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332454150050
                                         uncertainty =       0.007522372175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332454150050
                                         uncertainty =       0.007522372175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407738510
  error estimate for blocks of size 2^( 2) =       0.000420460381
  error estimate for blocks of size 2^( 3) =       0.000433196904
  error estimate for blocks of size 2^( 4) =       0.000443630292
  error estimate for blocks of size 2^( 5) =       0.000452672625
  error estimate for blocks of size 2^( 6) =       0.000459505212
  error estimate for blocks of size 2^( 7) =       0.000462233252

      target function =                  N/A
              le_mean =     -16.906744166061
             les_mean =     286.189862215641
             stat err =       0.000454510345
             autocorr =       1.242579209421
              std dev =       0.576629330362
             le_variance =       0.332501384633


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690674416606e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+27, overlap shift 1.4901e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906744166052       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906744166052       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906744166045       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+27 is 4.197894e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+27, overlap shift 5.9605e+28 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906744166052       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906744166052       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906744166045       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+27 is 1.049474e-31

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+28, overlap shift 2.3842e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906744166052       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906744166052       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907379517622       residual = 5.72e+10           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+28 is 2.623684e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.410939 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7451e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -16.876
    reference variance = 1.04248
====================================================
  Execution time = 2.0725e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4186e-01
  Total weights = 1.9518e+06
  Execution time = 1.9093e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325035349256
                                         uncertainty =       0.003474780562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325035349256
                                         uncertainty =       0.003474780562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403174882
  error estimate for blocks of size 2^( 2) =       0.000415680644
  error estimate for blocks of size 2^( 3) =       0.000428605969
  error estimate for blocks of size 2^( 4) =       0.000440681230
  error estimate for blocks of size 2^( 5) =       0.000450096535
  error estimate for blocks of size 2^( 6) =       0.000456504828
  error estimate for blocks of size 2^( 7) =       0.000458746681

      target function =                  N/A
              le_mean =     -16.907186211754
             les_mean =     286.194802534102
             stat err =       0.000451507319
             autocorr =       1.254130278658
              std dev =       0.570175386408
             le_variance =       0.325099971265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325035349256
                                         uncertainty =       0.003474780562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325035349256
                                         uncertainty =       0.003474780562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403174882
  error estimate for blocks of size 2^( 2) =       0.000415680644
  error estimate for blocks of size 2^( 3) =       0.000428605969
  error estimate for blocks of size 2^( 4) =       0.000440681230
  error estimate for blocks of size 2^( 5) =       0.000450096535
  error estimate for blocks of size 2^( 6) =       0.000456504828
  error estimate for blocks of size 2^( 7) =       0.000458746681

      target function =                  N/A
              le_mean =     -16.907186211754
             les_mean =     286.194802534102
             stat err =       0.000451507319
             autocorr =       1.254130278658
              std dev =       0.570175386408
             le_variance =       0.325099971265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325035349256
                                         uncertainty =       0.003474780562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325035349256
                                         uncertainty =       0.003474780562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403174882
  error estimate for blocks of size 2^( 2) =       0.000415680644
  error estimate for blocks of size 2^( 3) =       0.000428605969
  error estimate for blocks of size 2^( 4) =       0.000440681230
  error estimate for blocks of size 2^( 5) =       0.000450096535
  error estimate for blocks of size 2^( 6) =       0.000456504828
  error estimate for blocks of size 2^( 7) =       0.000458746681

      target function =                  N/A
              le_mean =     -16.907186211754
             les_mean =     286.194802534102
             stat err =       0.000451507319
             autocorr =       1.254130278658
              std dev =       0.570175386408
             le_variance =       0.325099971265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325035349256
                                         uncertainty =       0.003474780562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325035349256
                                         uncertainty =       0.003474780562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403174882
  error estimate for blocks of size 2^( 2) =       0.000415680644
  error estimate for blocks of size 2^( 3) =       0.000428605969
  error estimate for blocks of size 2^( 4) =       0.000440681230
  error estimate for blocks of size 2^( 5) =       0.000450096535
  error estimate for blocks of size 2^( 6) =       0.000456504828
  error estimate for blocks of size 2^( 7) =       0.000458746681

      target function =                  N/A
              le_mean =     -16.907186211754
             les_mean =     286.194802534102
             stat err =       0.000451507319
             autocorr =       1.254130278658
              std dev =       0.570175386408
             le_variance =       0.325099971265


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907186211754        initial  <--
     1.4901e+27     1.4901e+28             4.1979e-31       -16.907186211754
     5.9605e+27     5.9605e+28             1.0495e-31       -16.907186211754
     2.3842e+28     2.3842e+29             2.6237e-32       -16.907186211754

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4398
  </log>
  <optVariables href="H2O.s052.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7898e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.8666
    reference variance = 0.680576
====================================================
  Execution time = 2.1174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3477e-01
  Total weights = 1.951346862e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323471085442
                                         uncertainty =       0.002132484736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323471085442
                                         uncertainty =       0.002132484736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402151490
  error estimate for blocks of size 2^( 2) =       0.000415310362
  error estimate for blocks of size 2^( 3) =       0.000429209574
  error estimate for blocks of size 2^( 4) =       0.000442075101
  error estimate for blocks of size 2^( 5) =       0.000454015446
  error estimate for blocks of size 2^( 6) =       0.000461399635
  error estimate for blocks of size 2^( 7) =       0.000465851408

      target function =                  N/A
              le_mean =     -16.906535352067
             les_mean =     286.165709211027
             stat err =       0.000455835397
             autocorr =       1.284803552705
              std dev =       0.568728091622
             le_variance =       0.323451642201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653535207e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+28, overlap shift 1.4901e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906535352072       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906535352072       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906535352115       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+28 is 2.410376e-32

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+28, overlap shift 5.9605e+29 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906535352072       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906535352072       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906535352115       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+28 is 6.025940e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+29, overlap shift 2.3842e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906535352072       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906535352072       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906535352115       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+29 is 1.506485e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.412420 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7361e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -16.9893
    reference variance = 0.965143
====================================================
  Execution time = 2.0816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3873e-01
  Total weights = 1.9516e+06
  Execution time = 1.9111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321488519872
                                         uncertainty =       0.001960125588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321488519872
                                         uncertainty =       0.001960125588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400911040
  error estimate for blocks of size 2^( 2) =       0.000413793762
  error estimate for blocks of size 2^( 3) =       0.000426953127
  error estimate for blocks of size 2^( 4) =       0.000438522163
  error estimate for blocks of size 2^( 5) =       0.000449098833
  error estimate for blocks of size 2^( 6) =       0.000456926444
  error estimate for blocks of size 2^( 7) =       0.000458733175

      target function =                  N/A
              le_mean =     -16.906598970330
             les_mean =     286.171817407509
             stat err =       0.000450820154
             autocorr =       1.264476066115
              std dev =       0.566973830383
             le_variance =       0.321459324339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321488519872
                                         uncertainty =       0.001960125588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321488519872
                                         uncertainty =       0.001960125588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400911040
  error estimate for blocks of size 2^( 2) =       0.000413793762
  error estimate for blocks of size 2^( 3) =       0.000426953127
  error estimate for blocks of size 2^( 4) =       0.000438522163
  error estimate for blocks of size 2^( 5) =       0.000449098833
  error estimate for blocks of size 2^( 6) =       0.000456926444
  error estimate for blocks of size 2^( 7) =       0.000458733175

      target function =                  N/A
              le_mean =     -16.906598970330
             les_mean =     286.171817407509
             stat err =       0.000450820154
             autocorr =       1.264476066115
              std dev =       0.566973830383
             le_variance =       0.321459324339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321488519872
                                         uncertainty =       0.001960125588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321488519872
                                         uncertainty =       0.001960125588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400911040
  error estimate for blocks of size 2^( 2) =       0.000413793762
  error estimate for blocks of size 2^( 3) =       0.000426953127
  error estimate for blocks of size 2^( 4) =       0.000438522163
  error estimate for blocks of size 2^( 5) =       0.000449098833
  error estimate for blocks of size 2^( 6) =       0.000456926444
  error estimate for blocks of size 2^( 7) =       0.000458733175

      target function =                  N/A
              le_mean =     -16.906598970330
             les_mean =     286.171817407509
             stat err =       0.000450820154
             autocorr =       1.264476066115
              std dev =       0.566973830383
             le_variance =       0.321459324339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321488519872
                                         uncertainty =       0.001960125588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321488519872
                                         uncertainty =       0.001960125588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400911040
  error estimate for blocks of size 2^( 2) =       0.000413793762
  error estimate for blocks of size 2^( 3) =       0.000426953127
  error estimate for blocks of size 2^( 4) =       0.000438522163
  error estimate for blocks of size 2^( 5) =       0.000449098833
  error estimate for blocks of size 2^( 6) =       0.000456926444
  error estimate for blocks of size 2^( 7) =       0.000458733175

      target function =                  N/A
              le_mean =     -16.906598970330
             les_mean =     286.171817407509
             stat err =       0.000450820154
             autocorr =       1.264476066115
              std dev =       0.566973830383
             le_variance =       0.321459324339


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906598970330        initial  <--
     1.4901e+28     1.4901e+29             2.4104e-32       -16.906598970330
     5.9605e+28     5.9605e+29             6.0259e-33       -16.906598970330
     2.3842e+29     2.3842e+30             1.5065e-33       -16.906598970330

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4777
  </log>
  <optVariables href="H2O.s053.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7849e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8668
    reference variance = 0.241986
====================================================
  Execution time = 2.1280e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3454e-01
  Total weights = 1.951183636e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319825836383
                                         uncertainty =       0.001971550219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319825836383
                                         uncertainty =       0.001971550219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399885424
  error estimate for blocks of size 2^( 2) =       0.000412692523
  error estimate for blocks of size 2^( 3) =       0.000425978456
  error estimate for blocks of size 2^( 4) =       0.000438520243
  error estimate for blocks of size 2^( 5) =       0.000449842503
  error estimate for blocks of size 2^( 6) =       0.000455751535
  error estimate for blocks of size 2^( 7) =       0.000464231034

      target function =                  N/A
              le_mean =     -16.906247033706
             les_mean =     286.155729628924
             stat err =       0.000452086329
             autocorr =       1.278119907239
              std dev =       0.565523390022
             le_variance =       0.319816704662


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690624703371e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+29, overlap shift 1.4901e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906247033704       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906247033704       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+29, overlap shift 5.9605e+30 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906247033704       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906247033704       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+30, overlap shift 2.3842e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906247033704       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906247033704       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.413613 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7385e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -16.8273
    reference variance = 0.234861
====================================================
  Execution time = 2.1021e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3809e-01
  Total weights = 1.9519e+06
  Execution time = 1.9043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325354396551
                                         uncertainty =       0.002742519358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325354396551
                                         uncertainty =       0.002742519358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403302894
  error estimate for blocks of size 2^( 2) =       0.000416194193
  error estimate for blocks of size 2^( 3) =       0.000429948323
  error estimate for blocks of size 2^( 4) =       0.000442942385
  error estimate for blocks of size 2^( 5) =       0.000454810308
  error estimate for blocks of size 2^( 6) =       0.000464239398
  error estimate for blocks of size 2^( 7) =       0.000467680176

      target function =                  N/A
              le_mean =     -16.906194898842
             les_mean =     286.157519190492
             stat err =       0.000457418067
             autocorr =       1.286364219731
              std dev =       0.570356422225
             le_variance =       0.325306448373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325354396551
                                         uncertainty =       0.002742519358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325354396551
                                         uncertainty =       0.002742519358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403302894
  error estimate for blocks of size 2^( 2) =       0.000416194193
  error estimate for blocks of size 2^( 3) =       0.000429948323
  error estimate for blocks of size 2^( 4) =       0.000442942385
  error estimate for blocks of size 2^( 5) =       0.000454810308
  error estimate for blocks of size 2^( 6) =       0.000464239398
  error estimate for blocks of size 2^( 7) =       0.000467680176

      target function =                  N/A
              le_mean =     -16.906194898842
             les_mean =     286.157519190492
             stat err =       0.000457418067
             autocorr =       1.286364219731
              std dev =       0.570356422225
             le_variance =       0.325306448373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325354396551
                                         uncertainty =       0.002742519358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325354396551
                                         uncertainty =       0.002742519358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403302894
  error estimate for blocks of size 2^( 2) =       0.000416194193
  error estimate for blocks of size 2^( 3) =       0.000429948323
  error estimate for blocks of size 2^( 4) =       0.000442942385
  error estimate for blocks of size 2^( 5) =       0.000454810308
  error estimate for blocks of size 2^( 6) =       0.000464239398
  error estimate for blocks of size 2^( 7) =       0.000467680176

      target function =                  N/A
              le_mean =     -16.906194898842
             les_mean =     286.157519190492
             stat err =       0.000457418067
             autocorr =       1.286364219731
              std dev =       0.570356422225
             le_variance =       0.325306448373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325354396551
                                         uncertainty =       0.002742519358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325354396551
                                         uncertainty =       0.002742519358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403302894
  error estimate for blocks of size 2^( 2) =       0.000416194193
  error estimate for blocks of size 2^( 3) =       0.000429948323
  error estimate for blocks of size 2^( 4) =       0.000442942385
  error estimate for blocks of size 2^( 5) =       0.000454810308
  error estimate for blocks of size 2^( 6) =       0.000464239398
  error estimate for blocks of size 2^( 7) =       0.000467680176

      target function =                  N/A
              le_mean =     -16.906194898842
             les_mean =     286.157519190492
             stat err =       0.000457418067
             autocorr =       1.286364219731
              std dev =       0.570356422225
             le_variance =       0.325306448373


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906194898842        initial  <--
     1.4901e+29     1.4901e+30             0.0000e+00       -16.906194898842
     5.9605e+29     5.9605e+30             0.0000e+00       -16.906194898842
     2.3842e+30     2.3842e+31             0.0000e+00       -16.906194898842

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6454
  </log>
  <optVariables href="H2O.s054.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8038e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.9133
    reference variance = 0.191031
====================================================
  Execution time = 2.1423e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3609e-01
  Total weights = 1.951771395e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324670145841
                                         uncertainty =       0.002253651819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324670145841
                                         uncertainty =       0.002253651819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402994817
  error estimate for blocks of size 2^( 2) =       0.000415711967
  error estimate for blocks of size 2^( 3) =       0.000429287137
  error estimate for blocks of size 2^( 4) =       0.000441595081
  error estimate for blocks of size 2^( 5) =       0.000452226282
  error estimate for blocks of size 2^( 6) =       0.000461773251
  error estimate for blocks of size 2^( 7) =       0.000466432053

      target function =                  N/A
              le_mean =     -16.905995621249
             les_mean =     286.148774520749
             stat err =       0.000455506667
             autocorr =       1.277587205615
              std dev =       0.569920735760
             le_variance =       0.324809645049


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599562125e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+30, overlap shift 1.4901e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905995621213       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905995621213       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+30, overlap shift 5.9605e+31 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905995621213       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905995621213       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+31, overlap shift 2.3842e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905995621213       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905995621213       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.414784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7523e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -16.9703
    reference variance = 0.39044
====================================================
  Execution time = 2.0746e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3240e-01
  Total weights = 1.9517e+06
  Execution time = 1.8975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320441995853
                                         uncertainty =       0.001960762714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320441995853
                                         uncertainty =       0.001960762714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400346693
  error estimate for blocks of size 2^( 2) =       0.000413644445
  error estimate for blocks of size 2^( 3) =       0.000427407255
  error estimate for blocks of size 2^( 4) =       0.000440818009
  error estimate for blocks of size 2^( 5) =       0.000451556413
  error estimate for blocks of size 2^( 6) =       0.000462003671
  error estimate for blocks of size 2^( 7) =       0.000468615004

      target function =                  N/A
              le_mean =     -16.906765742794
             les_mean =     286.171132091648
             stat err =       0.000455748274
             autocorr =       1.295918157221
              std dev =       0.566175722812
             le_variance =       0.320554949102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320441995853
                                         uncertainty =       0.001960762714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320441995853
                                         uncertainty =       0.001960762714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400346693
  error estimate for blocks of size 2^( 2) =       0.000413644445
  error estimate for blocks of size 2^( 3) =       0.000427407255
  error estimate for blocks of size 2^( 4) =       0.000440818009
  error estimate for blocks of size 2^( 5) =       0.000451556413
  error estimate for blocks of size 2^( 6) =       0.000462003671
  error estimate for blocks of size 2^( 7) =       0.000468615004

      target function =                  N/A
              le_mean =     -16.906765742794
             les_mean =     286.171132091648
             stat err =       0.000455748274
             autocorr =       1.295918157221
              std dev =       0.566175722812
             le_variance =       0.320554949102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320441995853
                                         uncertainty =       0.001960762714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320441995853
                                         uncertainty =       0.001960762714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400346693
  error estimate for blocks of size 2^( 2) =       0.000413644445
  error estimate for blocks of size 2^( 3) =       0.000427407255
  error estimate for blocks of size 2^( 4) =       0.000440818009
  error estimate for blocks of size 2^( 5) =       0.000451556413
  error estimate for blocks of size 2^( 6) =       0.000462003671
  error estimate for blocks of size 2^( 7) =       0.000468615004

      target function =                  N/A
              le_mean =     -16.906765742794
             les_mean =     286.171132091648
             stat err =       0.000455748274
             autocorr =       1.295918157221
              std dev =       0.566175722812
             le_variance =       0.320554949102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320441995853
                                         uncertainty =       0.001960762714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320441995853
                                         uncertainty =       0.001960762714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400346693
  error estimate for blocks of size 2^( 2) =       0.000413644445
  error estimate for blocks of size 2^( 3) =       0.000427407255
  error estimate for blocks of size 2^( 4) =       0.000440818009
  error estimate for blocks of size 2^( 5) =       0.000451556413
  error estimate for blocks of size 2^( 6) =       0.000462003671
  error estimate for blocks of size 2^( 7) =       0.000468615004

      target function =                  N/A
              le_mean =     -16.906765742794
             les_mean =     286.171132091648
             stat err =       0.000455748274
             autocorr =       1.295918157221
              std dev =       0.566175722812
             le_variance =       0.320554949102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906765742794        initial  <--
     1.4901e+30     1.4901e+31             0.0000e+00       -16.906765742794
     5.9605e+30     5.9605e+31             0.0000e+00       -16.906765742794
     2.3842e+31     2.3842e+32             0.0000e+00       -16.906765742794

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3495
  </log>
  <optVariables href="H2O.s055.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.812
    reference variance = 0.193288
====================================================
  Execution time = 2.1124e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5235e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3095e-01
  Total weights = 1.951974194e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0472e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321323020348
                                         uncertainty =       0.002189934687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321323020348
                                         uncertainty =       0.002189934687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400803872
  error estimate for blocks of size 2^( 2) =       0.000413956663
  error estimate for blocks of size 2^( 3) =       0.000427119621
  error estimate for blocks of size 2^( 4) =       0.000439954332
  error estimate for blocks of size 2^( 5) =       0.000450851529
  error estimate for blocks of size 2^( 6) =       0.000459036813
  error estimate for blocks of size 2^( 7) =       0.000467103062

      target function =                  N/A
              le_mean =     -16.906471110226
             les_mean =     286.159718835549
             stat err =       0.000454236434
             autocorr =       1.284399461478
              std dev =       0.566822271716
             le_variance =       0.321287487714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647111023e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+31, overlap shift 1.4901e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906471110226       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906471110226       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+31, overlap shift 5.9605e+32 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906471110226       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906471110226       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+32, overlap shift 2.3842e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906471110226       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906471110226       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.415973 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7185e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -16.9123
    reference variance = 0.232799
====================================================
  Execution time = 2.2611e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3386e-01
  Total weights = 1.9518e+06
  Execution time = 1.9047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324171267644
                                         uncertainty =       0.003072032580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324171267644
                                         uncertainty =       0.003072032580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402560493
  error estimate for blocks of size 2^( 2) =       0.000415746215
  error estimate for blocks of size 2^( 3) =       0.000429644172
  error estimate for blocks of size 2^( 4) =       0.000442726356
  error estimate for blocks of size 2^( 5) =       0.000453642389
  error estimate for blocks of size 2^( 6) =       0.000461823082
  error estimate for blocks of size 2^( 7) =       0.000467587248

      target function =                  N/A
              le_mean =     -16.905582021206
             les_mean =     286.132560913209
             stat err =       0.000456444769
             autocorr =       1.285624573374
              std dev =       0.569306509452
             le_variance =       0.324109901704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324171267644
                                         uncertainty =       0.003072032580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324171267644
                                         uncertainty =       0.003072032580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402560493
  error estimate for blocks of size 2^( 2) =       0.000415746215
  error estimate for blocks of size 2^( 3) =       0.000429644172
  error estimate for blocks of size 2^( 4) =       0.000442726356
  error estimate for blocks of size 2^( 5) =       0.000453642389
  error estimate for blocks of size 2^( 6) =       0.000461823082
  error estimate for blocks of size 2^( 7) =       0.000467587248

      target function =                  N/A
              le_mean =     -16.905582021206
             les_mean =     286.132560913209
             stat err =       0.000456444769
             autocorr =       1.285624573374
              std dev =       0.569306509452
             le_variance =       0.324109901704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324171267644
                                         uncertainty =       0.003072032580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324171267644
                                         uncertainty =       0.003072032580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402560493
  error estimate for blocks of size 2^( 2) =       0.000415746215
  error estimate for blocks of size 2^( 3) =       0.000429644172
  error estimate for blocks of size 2^( 4) =       0.000442726356
  error estimate for blocks of size 2^( 5) =       0.000453642389
  error estimate for blocks of size 2^( 6) =       0.000461823082
  error estimate for blocks of size 2^( 7) =       0.000467587248

      target function =                  N/A
              le_mean =     -16.905582021206
             les_mean =     286.132560913209
             stat err =       0.000456444769
             autocorr =       1.285624573374
              std dev =       0.569306509452
             le_variance =       0.324109901704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324171267644
                                         uncertainty =       0.003072032580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324171267644
                                         uncertainty =       0.003072032580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402560493
  error estimate for blocks of size 2^( 2) =       0.000415746215
  error estimate for blocks of size 2^( 3) =       0.000429644172
  error estimate for blocks of size 2^( 4) =       0.000442726356
  error estimate for blocks of size 2^( 5) =       0.000453642389
  error estimate for blocks of size 2^( 6) =       0.000461823082
  error estimate for blocks of size 2^( 7) =       0.000467587248

      target function =                  N/A
              le_mean =     -16.905582021206
             les_mean =     286.132560913209
             stat err =       0.000456444769
             autocorr =       1.285624573374
              std dev =       0.569306509452
             le_variance =       0.324109901704


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905582021206        initial  <--
     1.4901e+31     1.4901e+32             0.0000e+00       -16.905582021206
     5.9605e+31     5.9605e+32             0.0000e+00       -16.905582021206
     2.3842e+32     2.3842e+33             0.0000e+00       -16.905582021206

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2441
  </log>
  <optVariables href="H2O.s056.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9436e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.0321
    reference variance = 0.287068
====================================================
  Execution time = 2.1087e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3783e-01
  Total weights = 1.951696334e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324932552436
                                         uncertainty =       0.003186028303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324932552436
                                         uncertainty =       0.003186028303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403093834
  error estimate for blocks of size 2^( 2) =       0.000415847257
  error estimate for blocks of size 2^( 3) =       0.000429018409
  error estimate for blocks of size 2^( 4) =       0.000441317352
  error estimate for blocks of size 2^( 5) =       0.000451997298
  error estimate for blocks of size 2^( 6) =       0.000458921270
  error estimate for blocks of size 2^( 7) =       0.000464526740

      target function =                  N/A
              le_mean =     -16.905898351074
             les_mean =     286.147230405920
             stat err =       0.000454190665
             autocorr =       1.269591769918
              std dev =       0.570060766743
             le_variance =       0.324969277780


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589835107e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+32, overlap shift 1.4901e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898351025       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898351025       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+32, overlap shift 5.9605e+33 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898351025       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898351025       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+33, overlap shift 2.3842e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898351025       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898351025       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.417147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7199e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -16.9629
    reference variance = 0.260979
====================================================
  Execution time = 2.0913e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3708e-01
  Total weights = 1.9519e+06
  Execution time = 1.9092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323985833237
                                         uncertainty =       0.002659837149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323985833237
                                         uncertainty =       0.002659837149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402484764
  error estimate for blocks of size 2^( 2) =       0.000414944994
  error estimate for blocks of size 2^( 3) =       0.000427299322
  error estimate for blocks of size 2^( 4) =       0.000439236362
  error estimate for blocks of size 2^( 5) =       0.000449832798
  error estimate for blocks of size 2^( 6) =       0.000457404394
  error estimate for blocks of size 2^( 7) =       0.000464181644

      target function =                  N/A
              le_mean =     -16.905269246975
             les_mean =     286.125203994085
             stat err =       0.000452663799
             autocorr =       1.264889648869
              std dev =       0.569199411968
             le_variance =       0.323987970585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323985833237
                                         uncertainty =       0.002659837149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323985833237
                                         uncertainty =       0.002659837149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402484764
  error estimate for blocks of size 2^( 2) =       0.000414944994
  error estimate for blocks of size 2^( 3) =       0.000427299322
  error estimate for blocks of size 2^( 4) =       0.000439236362
  error estimate for blocks of size 2^( 5) =       0.000449832798
  error estimate for blocks of size 2^( 6) =       0.000457404394
  error estimate for blocks of size 2^( 7) =       0.000464181644

      target function =                  N/A
              le_mean =     -16.905269246975
             les_mean =     286.125203994085
             stat err =       0.000452663799
             autocorr =       1.264889648869
              std dev =       0.569199411968
             le_variance =       0.323987970585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323985833237
                                         uncertainty =       0.002659837149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323985833237
                                         uncertainty =       0.002659837149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402484764
  error estimate for blocks of size 2^( 2) =       0.000414944994
  error estimate for blocks of size 2^( 3) =       0.000427299322
  error estimate for blocks of size 2^( 4) =       0.000439236362
  error estimate for blocks of size 2^( 5) =       0.000449832798
  error estimate for blocks of size 2^( 6) =       0.000457404394
  error estimate for blocks of size 2^( 7) =       0.000464181644

      target function =                  N/A
              le_mean =     -16.905269246975
             les_mean =     286.125203994085
             stat err =       0.000452663799
             autocorr =       1.264889648869
              std dev =       0.569199411968
             le_variance =       0.323987970585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323985833237
                                         uncertainty =       0.002659837149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323985833237
                                         uncertainty =       0.002659837149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402484764
  error estimate for blocks of size 2^( 2) =       0.000414944994
  error estimate for blocks of size 2^( 3) =       0.000427299322
  error estimate for blocks of size 2^( 4) =       0.000439236362
  error estimate for blocks of size 2^( 5) =       0.000449832798
  error estimate for blocks of size 2^( 6) =       0.000457404394
  error estimate for blocks of size 2^( 7) =       0.000464181644

      target function =                  N/A
              le_mean =     -16.905269246975
             les_mean =     286.125203994085
             stat err =       0.000452663799
             autocorr =       1.264889648869
              std dev =       0.569199411968
             le_variance =       0.323987970585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905269246975        initial  <--
     1.4901e+32     1.4901e+33             0.0000e+00       -16.905269246975
     5.9605e+32     5.9605e+33             0.0000e+00       -16.905269246975
     2.3842e+33     2.3842e+34             0.0000e+00       -16.905269246975

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5475
  </log>
  <optVariables href="H2O.s057.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7754e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9
    reference variance = 0.20849
====================================================
  Execution time = 2.1370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3627e-01
  Total weights = 1.951843793e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323020890057
                                         uncertainty =       0.002220704031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323020890057
                                         uncertainty =       0.002220704031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401830468
  error estimate for blocks of size 2^( 2) =       0.000414536838
  error estimate for blocks of size 2^( 3) =       0.000427215530
  error estimate for blocks of size 2^( 4) =       0.000438730783
  error estimate for blocks of size 2^( 5) =       0.000448546764
  error estimate for blocks of size 2^( 6) =       0.000455697108
  error estimate for blocks of size 2^( 7) =       0.000457093284

      target function =                  N/A
              le_mean =     -16.906132331366
             les_mean =     286.153580483650
             stat err =       0.000450016985
             autocorr =       1.254215271906
              std dev =       0.568274097524
             le_variance =       0.322935449917


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613233137e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+33, overlap shift 1.4901e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906132331364       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132331364       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132331364       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+33 is 3.105539e-37

solving harmonic davidson linear method for identity shift 5.9605e+33, overlap shift 5.9605e+34 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906132331364       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132331364       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906132331364       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+33 is 7.763848e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+34, overlap shift 2.3842e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906132331364       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906132331364       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.418518 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7500e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -16.9129
    reference variance = 0.192681
====================================================
  Execution time = 2.0606e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3538e-01
  Total weights = 1.9516e+06
  Execution time = 1.8936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647018324
                                         uncertainty =       0.003469988197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647018324
                                         uncertainty =       0.003469988197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401049081
  error estimate for blocks of size 2^( 2) =       0.000413845235
  error estimate for blocks of size 2^( 3) =       0.000426774129
  error estimate for blocks of size 2^( 4) =       0.000438435500
  error estimate for blocks of size 2^( 5) =       0.000449314458
  error estimate for blocks of size 2^( 6) =       0.000457997353
  error estimate for blocks of size 2^( 7) =       0.000461423879

      target function =                  N/A
              le_mean =     -16.906515648276
             les_mean =     286.165651668802
             stat err =       0.000451792798
             autocorr =       1.269064092946
              std dev =       0.567169048881
             le_variance =       0.321680730008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647018324
                                         uncertainty =       0.003469988197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647018324
                                         uncertainty =       0.003469988197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401049081
  error estimate for blocks of size 2^( 2) =       0.000413845235
  error estimate for blocks of size 2^( 3) =       0.000426774129
  error estimate for blocks of size 2^( 4) =       0.000438435500
  error estimate for blocks of size 2^( 5) =       0.000449314458
  error estimate for blocks of size 2^( 6) =       0.000457997353
  error estimate for blocks of size 2^( 7) =       0.000461423879

      target function =                  N/A
              le_mean =     -16.906515648276
             les_mean =     286.165651668802
             stat err =       0.000451792798
             autocorr =       1.269064092946
              std dev =       0.567169048881
             le_variance =       0.321680730008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647018324
                                         uncertainty =       0.003469988197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647018324
                                         uncertainty =       0.003469988197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401049081
  error estimate for blocks of size 2^( 2) =       0.000413845235
  error estimate for blocks of size 2^( 3) =       0.000426774129
  error estimate for blocks of size 2^( 4) =       0.000438435500
  error estimate for blocks of size 2^( 5) =       0.000449314458
  error estimate for blocks of size 2^( 6) =       0.000457997353
  error estimate for blocks of size 2^( 7) =       0.000461423879

      target function =                  N/A
              le_mean =     -16.906515648276
             les_mean =     286.165651668802
             stat err =       0.000451792798
             autocorr =       1.269064092946
              std dev =       0.567169048881
             le_variance =       0.321680730008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647018324
                                         uncertainty =       0.003469988197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321647018324
                                         uncertainty =       0.003469988197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401049081
  error estimate for blocks of size 2^( 2) =       0.000413845235
  error estimate for blocks of size 2^( 3) =       0.000426774129
  error estimate for blocks of size 2^( 4) =       0.000438435500
  error estimate for blocks of size 2^( 5) =       0.000449314458
  error estimate for blocks of size 2^( 6) =       0.000457997353
  error estimate for blocks of size 2^( 7) =       0.000461423879

      target function =                  N/A
              le_mean =     -16.906515648276
             les_mean =     286.165651668802
             stat err =       0.000451792798
             autocorr =       1.269064092946
              std dev =       0.567169048881
             le_variance =       0.321680730008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906515648276        initial  <--
     1.4901e+33     1.4901e+34             3.1055e-37       -16.906515648276
     5.9605e+33     5.9605e+34             7.7638e-38       -16.906515648276
     2.3842e+34     2.3842e+35             0.0000e+00       -16.906515648276

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1922
  </log>
  <optVariables href="H2O.s058.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7699e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.884
    reference variance = 0.212919
====================================================
  Execution time = 2.1281e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5227e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3914e-01
  Total weights = 1.951538281e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0606e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325241161477
                                         uncertainty =       0.003321927029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325241161477
                                         uncertainty =       0.003321927029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403233700
  error estimate for blocks of size 2^( 2) =       0.000416133280
  error estimate for blocks of size 2^( 3) =       0.000429384872
  error estimate for blocks of size 2^( 4) =       0.000441718941
  error estimate for blocks of size 2^( 5) =       0.000452731411
  error estimate for blocks of size 2^( 6) =       0.000460951617
  error estimate for blocks of size 2^( 7) =       0.000466909847

      target function =                  N/A
              le_mean =     -16.906957338254
             les_mean =     286.184343772903
             stat err =       0.000455577954
             autocorr =       1.276473368059
              std dev =       0.570258567320
             le_variance =       0.325194833602


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690695733825e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+34, overlap shift 1.4901e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906957338268       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906957338268       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906957338268       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+34 is 3.149743e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+34, overlap shift 5.9605e+35 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906957338268       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906957338268       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906957338268       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+34 is 7.874357e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+35, overlap shift 2.3842e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906957338268       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906957338268       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906957338268       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+35 is 1.968589e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.419961 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7353e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -16.9245
    reference variance = 0.205941
====================================================
  Execution time = 2.0775e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3700e-01
  Total weights = 1.9515e+06
  Execution time = 1.9042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323200588950
                                         uncertainty =       0.002326231509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323200588950
                                         uncertainty =       0.002326231509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401960110
  error estimate for blocks of size 2^( 2) =       0.000414789465
  error estimate for blocks of size 2^( 3) =       0.000428390130
  error estimate for blocks of size 2^( 4) =       0.000441264481
  error estimate for blocks of size 2^( 5) =       0.000451647507
  error estimate for blocks of size 2^( 6) =       0.000462139674
  error estimate for blocks of size 2^( 7) =       0.000469019024

      target function =                  N/A
              le_mean =     -16.906460600562
             les_mean =     286.165410494012
             stat err =       0.000456017671
             autocorr =       1.287055969789
              std dev =       0.568457438523
             le_variance =       0.323143859413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323200588950
                                         uncertainty =       0.002326231509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323200588950
                                         uncertainty =       0.002326231509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401960110
  error estimate for blocks of size 2^( 2) =       0.000414789465
  error estimate for blocks of size 2^( 3) =       0.000428390130
  error estimate for blocks of size 2^( 4) =       0.000441264481
  error estimate for blocks of size 2^( 5) =       0.000451647507
  error estimate for blocks of size 2^( 6) =       0.000462139674
  error estimate for blocks of size 2^( 7) =       0.000469019024

      target function =                  N/A
              le_mean =     -16.906460600562
             les_mean =     286.165410494012
             stat err =       0.000456017671
             autocorr =       1.287055969789
              std dev =       0.568457438523
             le_variance =       0.323143859413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323200588950
                                         uncertainty =       0.002326231509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323200588950
                                         uncertainty =       0.002326231509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401960110
  error estimate for blocks of size 2^( 2) =       0.000414789465
  error estimate for blocks of size 2^( 3) =       0.000428390130
  error estimate for blocks of size 2^( 4) =       0.000441264481
  error estimate for blocks of size 2^( 5) =       0.000451647507
  error estimate for blocks of size 2^( 6) =       0.000462139674
  error estimate for blocks of size 2^( 7) =       0.000469019024

      target function =                  N/A
              le_mean =     -16.906460600562
             les_mean =     286.165410494012
             stat err =       0.000456017671
             autocorr =       1.287055969789
              std dev =       0.568457438523
             le_variance =       0.323143859413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323200588950
                                         uncertainty =       0.002326231509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323200588950
                                         uncertainty =       0.002326231509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401960110
  error estimate for blocks of size 2^( 2) =       0.000414789465
  error estimate for blocks of size 2^( 3) =       0.000428390130
  error estimate for blocks of size 2^( 4) =       0.000441264481
  error estimate for blocks of size 2^( 5) =       0.000451647507
  error estimate for blocks of size 2^( 6) =       0.000462139674
  error estimate for blocks of size 2^( 7) =       0.000469019024

      target function =                  N/A
              le_mean =     -16.906460600562
             les_mean =     286.165410494012
             stat err =       0.000456017671
             autocorr =       1.287055969789
              std dev =       0.568457438523
             le_variance =       0.323143859413


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906460600562        initial  <--
     1.4901e+34     1.4901e+35             3.1497e-38       -16.906460600562
     5.9605e+34     5.9605e+35             7.8744e-39       -16.906460600562
     2.3842e+35     2.3842e+36             1.9686e-39       -16.906460600562

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4088
  </log>
  <optVariables href="H2O.s059.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7769e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.8709
    reference variance = 0.265661
====================================================
  Execution time = 2.1184e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3944e-01
  Total weights = 1.951658177e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326363336298
                                         uncertainty =       0.003096766187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326363336298
                                         uncertainty =       0.003096766187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403935421
  error estimate for blocks of size 2^( 2) =       0.000417266883
  error estimate for blocks of size 2^( 3) =       0.000430715581
  error estimate for blocks of size 2^( 4) =       0.000443371155
  error estimate for blocks of size 2^( 5) =       0.000454974710
  error estimate for blocks of size 2^( 6) =       0.000462496303
  error estimate for blocks of size 2^( 7) =       0.000468601546

      target function =                  N/A
              le_mean =     -16.905760355991
             les_mean =     286.144170643656
             stat err =       0.000457360928
             autocorr =       1.282018362935
              std dev =       0.571250950298
             le_variance =       0.326327648216


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690576035599e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+35, overlap shift 1.4901e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760355984       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760355984       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905760355984       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+35 is 2.156567e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+35, overlap shift 5.9605e+36 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760355984       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760355984       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+36, overlap shift 2.3842e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905760355984       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905760355984       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.421261 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7172e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -16.8156
    reference variance = 0.326048
====================================================
  Execution time = 2.0741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3342e-01
  Total weights = 1.9521e+06
  Execution time = 1.9058e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320754293529
                                         uncertainty =       0.002041405870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320754293529
                                         uncertainty =       0.002041405870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400459425
  error estimate for blocks of size 2^( 2) =       0.000413063841
  error estimate for blocks of size 2^( 3) =       0.000426135164
  error estimate for blocks of size 2^( 4) =       0.000438821813
  error estimate for blocks of size 2^( 5) =       0.000448495818
  error estimate for blocks of size 2^( 6) =       0.000455484856
  error estimate for blocks of size 2^( 7) =       0.000458440632

      target function =                  N/A
              le_mean =     -16.906132784582
             les_mean =     286.150743960068
             stat err =       0.000450310779
             autocorr =       1.264467432339
              std dev =       0.566335149600
             le_variance =       0.320735501673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320754293529
                                         uncertainty =       0.002041405870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320754293529
                                         uncertainty =       0.002041405870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400459425
  error estimate for blocks of size 2^( 2) =       0.000413063841
  error estimate for blocks of size 2^( 3) =       0.000426135164
  error estimate for blocks of size 2^( 4) =       0.000438821813
  error estimate for blocks of size 2^( 5) =       0.000448495818
  error estimate for blocks of size 2^( 6) =       0.000455484856
  error estimate for blocks of size 2^( 7) =       0.000458440632

      target function =                  N/A
              le_mean =     -16.906132784582
             les_mean =     286.150743960068
             stat err =       0.000450310779
             autocorr =       1.264467432339
              std dev =       0.566335149600
             le_variance =       0.320735501673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320754293529
                                         uncertainty =       0.002041405870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320754293529
                                         uncertainty =       0.002041405870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400459425
  error estimate for blocks of size 2^( 2) =       0.000413063841
  error estimate for blocks of size 2^( 3) =       0.000426135164
  error estimate for blocks of size 2^( 4) =       0.000438821813
  error estimate for blocks of size 2^( 5) =       0.000448495818
  error estimate for blocks of size 2^( 6) =       0.000455484856
  error estimate for blocks of size 2^( 7) =       0.000458440632

      target function =                  N/A
              le_mean =     -16.906132784582
             les_mean =     286.150743960068
             stat err =       0.000450310779
             autocorr =       1.264467432339
              std dev =       0.566335149600
             le_variance =       0.320735501673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320754293529
                                         uncertainty =       0.002041405870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320754293529
                                         uncertainty =       0.002041405870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400459425
  error estimate for blocks of size 2^( 2) =       0.000413063841
  error estimate for blocks of size 2^( 3) =       0.000426135164
  error estimate for blocks of size 2^( 4) =       0.000438821813
  error estimate for blocks of size 2^( 5) =       0.000448495818
  error estimate for blocks of size 2^( 6) =       0.000455484856
  error estimate for blocks of size 2^( 7) =       0.000458440632

      target function =                  N/A
              le_mean =     -16.906132784582
             les_mean =     286.150743960068
             stat err =       0.000450310779
             autocorr =       1.264467432339
              std dev =       0.566335149600
             le_variance =       0.320735501673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906132784582        initial  <--
     1.4901e+35     1.4901e+36             2.1566e-39       -16.906132784582
     5.9605e+35     5.9605e+36             0.0000e+00       -16.906132784582
     2.3842e+36     2.3842e+37             0.0000e+00       -16.906132784582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3791
  </log>
  <optVariables href="H2O.s060.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7559e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.0043
    reference variance = 0.227604
====================================================
  Execution time = 2.1247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5239e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5104e-01
  Total weights = 1.951375422e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0396e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332263258691
                                         uncertainty =       0.003735304240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332263258691
                                         uncertainty =       0.003735304240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407557235
  error estimate for blocks of size 2^( 2) =       0.000420457987
  error estimate for blocks of size 2^( 3) =       0.000433622181
  error estimate for blocks of size 2^( 4) =       0.000446428679
  error estimate for blocks of size 2^( 5) =       0.000457160091
  error estimate for blocks of size 2^( 6) =       0.000466644437
  error estimate for blocks of size 2^( 7) =       0.000472599149

      target function =                  N/A
              le_mean =     -16.905894443185
             les_mean =     286.160309565349
             stat err =       0.000460708089
             autocorr =       1.277834062538
              std dev =       0.576372969235
             le_variance =       0.332205799665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589444319e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+36, overlap shift 1.4901e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905894443146       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905894443146       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905894443146       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905895233154       residual = 1.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+36 is 4.444403e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+36, overlap shift 5.9605e+37 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905894443146       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905894443146       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905895233154       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+36 is 1.089463e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+37, overlap shift 2.3842e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905894443146       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905894443146       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905894443146       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905899047852       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905883789062       residual = 1.48e-01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+37 is 2.777752e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.423064 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7297e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -16.8565
    reference variance = 0.593921
====================================================
  Execution time = 2.0737e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3508e-01
  Total weights = 1.9519e+06
  Execution time = 1.9012e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320628162310
                                         uncertainty =       0.001954015292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320628162310
                                         uncertainty =       0.001954015292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400365588
  error estimate for blocks of size 2^( 2) =       0.000413417451
  error estimate for blocks of size 2^( 3) =       0.000427183331
  error estimate for blocks of size 2^( 4) =       0.000440462734
  error estimate for blocks of size 2^( 5) =       0.000451212220
  error estimate for blocks of size 2^( 6) =       0.000458445509
  error estimate for blocks of size 2^( 7) =       0.000464515303

      target function =                  N/A
              le_mean =     -16.905805219402
             les_mean =     286.141325686957
             stat err =       0.000453658942
             autocorr =       1.283942177101
              std dev =       0.566202444775
             le_variance =       0.320585208469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320628162310
                                         uncertainty =       0.001954015292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320628162310
                                         uncertainty =       0.001954015292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400365588
  error estimate for blocks of size 2^( 2) =       0.000413417451
  error estimate for blocks of size 2^( 3) =       0.000427183331
  error estimate for blocks of size 2^( 4) =       0.000440462734
  error estimate for blocks of size 2^( 5) =       0.000451212220
  error estimate for blocks of size 2^( 6) =       0.000458445509
  error estimate for blocks of size 2^( 7) =       0.000464515303

      target function =                  N/A
              le_mean =     -16.905805219402
             les_mean =     286.141325686957
             stat err =       0.000453658942
             autocorr =       1.283942177101
              std dev =       0.566202444775
             le_variance =       0.320585208469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320628162310
                                         uncertainty =       0.001954015292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320628162310
                                         uncertainty =       0.001954015292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400365588
  error estimate for blocks of size 2^( 2) =       0.000413417451
  error estimate for blocks of size 2^( 3) =       0.000427183331
  error estimate for blocks of size 2^( 4) =       0.000440462734
  error estimate for blocks of size 2^( 5) =       0.000451212220
  error estimate for blocks of size 2^( 6) =       0.000458445509
  error estimate for blocks of size 2^( 7) =       0.000464515303

      target function =                  N/A
              le_mean =     -16.905805219402
             les_mean =     286.141325686957
             stat err =       0.000453658942
             autocorr =       1.283942177101
              std dev =       0.566202444775
             le_variance =       0.320585208469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320628162310
                                         uncertainty =       0.001954015292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320628162310
                                         uncertainty =       0.001954015292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400365588
  error estimate for blocks of size 2^( 2) =       0.000413417451
  error estimate for blocks of size 2^( 3) =       0.000427183331
  error estimate for blocks of size 2^( 4) =       0.000440462734
  error estimate for blocks of size 2^( 5) =       0.000451212220
  error estimate for blocks of size 2^( 6) =       0.000458445509
  error estimate for blocks of size 2^( 7) =       0.000464515303

      target function =                  N/A
              le_mean =     -16.905805219402
             les_mean =     286.141325686957
             stat err =       0.000453658942
             autocorr =       1.283942177101
              std dev =       0.566202444775
             le_variance =       0.320585208469


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905805219402        initial  <--
     1.4901e+36     1.4901e+37             4.4444e-40       -16.905805219402
     5.9605e+36     5.9605e+37             1.0895e-40       -16.905805219402
     2.3842e+37     2.3842e+38             2.7778e-41       -16.905805219402

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.7469
  </log>
  <optVariables href="H2O.s061.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0051e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.9551
    reference variance = 0.34021
====================================================
  Execution time = 2.1085e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3612e-01
  Total weights = 1.951762504e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0647e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596403274
                                         uncertainty =       0.002237000642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323596403274
                                         uncertainty =       0.002237000642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402269773
  error estimate for blocks of size 2^( 2) =       0.000415068614
  error estimate for blocks of size 2^( 3) =       0.000427736294
  error estimate for blocks of size 2^( 4) =       0.000440032170
  error estimate for blocks of size 2^( 5) =       0.000450552228
  error estimate for blocks of size 2^( 6) =       0.000456017196
  error estimate for blocks of size 2^( 7) =       0.000458390276

      target function =                  N/A
              le_mean =     -16.905312037836
             les_mean =     286.125691897695
             stat err =       0.000451247967
             autocorr =       1.258333380708
              std dev =       0.568895368046
             le_variance =       0.323641939785


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690531203784e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+37, overlap shift 1.4901e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905312037825       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905312037825       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905311584473       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+37 is 3.054587e-41

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+37, overlap shift 5.9605e+38 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905312037825       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905312037825       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905312037825       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905312037825       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905312037825       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+37 is 7.900905e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+38, overlap shift 2.3842e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905312037825       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905312037825       residual = 6.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905311584473       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+38 is 1.909117e-42

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.424799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7160e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -16.9465
    reference variance = 0.305578
====================================================
  Execution time = 2.1199e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4601e-01
  Total weights = 1.9518e+06
  Execution time = 1.9103e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328390236473
                                         uncertainty =       0.004594861944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328390236473
                                         uncertainty =       0.004594861944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405162305
  error estimate for blocks of size 2^( 2) =       0.000417889548
  error estimate for blocks of size 2^( 3) =       0.000430980918
  error estimate for blocks of size 2^( 4) =       0.000443705382
  error estimate for blocks of size 2^( 5) =       0.000454741525
  error estimate for blocks of size 2^( 6) =       0.000464026998
  error estimate for blocks of size 2^( 7) =       0.000471125652

      target function =                  N/A
              le_mean =     -16.905486613799
             les_mean =     286.141489935017
             stat err =       0.000458399889
             autocorr =       1.280061810616
              std dev =       0.572986026879
             le_variance =       0.328312986999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328390236473
                                         uncertainty =       0.004594861944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328390236473
                                         uncertainty =       0.004594861944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405162305
  error estimate for blocks of size 2^( 2) =       0.000417889548
  error estimate for blocks of size 2^( 3) =       0.000430980918
  error estimate for blocks of size 2^( 4) =       0.000443705382
  error estimate for blocks of size 2^( 5) =       0.000454741525
  error estimate for blocks of size 2^( 6) =       0.000464026998
  error estimate for blocks of size 2^( 7) =       0.000471125652

      target function =                  N/A
              le_mean =     -16.905486613799
             les_mean =     286.141489935017
             stat err =       0.000458399889
             autocorr =       1.280061810616
              std dev =       0.572986026879
             le_variance =       0.328312986999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328390236473
                                         uncertainty =       0.004594861944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328390236473
                                         uncertainty =       0.004594861944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405162305
  error estimate for blocks of size 2^( 2) =       0.000417889548
  error estimate for blocks of size 2^( 3) =       0.000430980918
  error estimate for blocks of size 2^( 4) =       0.000443705382
  error estimate for blocks of size 2^( 5) =       0.000454741525
  error estimate for blocks of size 2^( 6) =       0.000464026998
  error estimate for blocks of size 2^( 7) =       0.000471125652

      target function =                  N/A
              le_mean =     -16.905486613799
             les_mean =     286.141489935017
             stat err =       0.000458399889
             autocorr =       1.280061810616
              std dev =       0.572986026879
             le_variance =       0.328312986999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328390236473
                                         uncertainty =       0.004594861944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328390236473
                                         uncertainty =       0.004594861944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405162305
  error estimate for blocks of size 2^( 2) =       0.000417889548
  error estimate for blocks of size 2^( 3) =       0.000430980918
  error estimate for blocks of size 2^( 4) =       0.000443705382
  error estimate for blocks of size 2^( 5) =       0.000454741525
  error estimate for blocks of size 2^( 6) =       0.000464026998
  error estimate for blocks of size 2^( 7) =       0.000471125652

      target function =                  N/A
              le_mean =     -16.905486613799
             les_mean =     286.141489935017
             stat err =       0.000458399889
             autocorr =       1.280061810616
              std dev =       0.572986026879
             le_variance =       0.328312986999


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905486613799        initial  <--
     1.4901e+37     1.4901e+38             3.0546e-41       -16.905486613799
     5.9605e+37     5.9605e+38             7.9009e-42       -16.905486613799
     2.3842e+38     2.3842e+39             1.9091e-42       -16.905486613799

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8614
  </log>
  <optVariables href="H2O.s062.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.9138
    reference variance = 1.08183
====================================================
  Execution time = 2.1259e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4220e-01
  Total weights = 1.951900085e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325158453276
                                         uncertainty =       0.003228334509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325158453276
                                         uncertainty =       0.003228334509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403413192
  error estimate for blocks of size 2^( 2) =       0.000416243605
  error estimate for blocks of size 2^( 3) =       0.000429286075
  error estimate for blocks of size 2^( 4) =       0.000441271636
  error estimate for blocks of size 2^( 5) =       0.000452089596
  error estimate for blocks of size 2^( 6) =       0.000462737455
  error estimate for blocks of size 2^( 7) =       0.000471953318

      target function =                  N/A
              le_mean =     -16.905880210423
             les_mean =     286.150981334005
             stat err =       0.000457013001
             autocorr =       1.283384880467
              std dev =       0.570512406954
             le_variance =       0.325484406488


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690588021042e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+38, overlap shift 1.4901e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905880210426       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905880210426       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+38, overlap shift 5.9605e+39 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905880210426       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905880210426       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+38 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+39, overlap shift 2.3842e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905880210426       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905880210426       residual = 4.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.425998 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7369e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -16.8721
    reference variance = 0.339619
====================================================
  Execution time = 2.0920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4340e-01
  Total weights = 1.9515e+06
  Execution time = 1.9085e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325339731379
                                         uncertainty =       0.002875814615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325339731379
                                         uncertainty =       0.002875814615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403348185
  error estimate for blocks of size 2^( 2) =       0.000416332718
  error estimate for blocks of size 2^( 3) =       0.000429750967
  error estimate for blocks of size 2^( 4) =       0.000443290214
  error estimate for blocks of size 2^( 5) =       0.000455864450
  error estimate for blocks of size 2^( 6) =       0.000464349589
  error estimate for blocks of size 2^( 7) =       0.000470983926

      target function =                  N/A
              le_mean =     -16.905744986791
             les_mean =     286.147616997728
             stat err =       0.000458622045
             autocorr =       1.292854458222
              std dev =       0.570420474194
             le_variance =       0.325379517380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325339731379
                                         uncertainty =       0.002875814615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325339731379
                                         uncertainty =       0.002875814615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403348185
  error estimate for blocks of size 2^( 2) =       0.000416332718
  error estimate for blocks of size 2^( 3) =       0.000429750967
  error estimate for blocks of size 2^( 4) =       0.000443290214
  error estimate for blocks of size 2^( 5) =       0.000455864450
  error estimate for blocks of size 2^( 6) =       0.000464349589
  error estimate for blocks of size 2^( 7) =       0.000470983926

      target function =                  N/A
              le_mean =     -16.905744986791
             les_mean =     286.147616997728
             stat err =       0.000458622045
             autocorr =       1.292854458222
              std dev =       0.570420474194
             le_variance =       0.325379517380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325339731379
                                         uncertainty =       0.002875814615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325339731379
                                         uncertainty =       0.002875814615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403348185
  error estimate for blocks of size 2^( 2) =       0.000416332718
  error estimate for blocks of size 2^( 3) =       0.000429750967
  error estimate for blocks of size 2^( 4) =       0.000443290214
  error estimate for blocks of size 2^( 5) =       0.000455864450
  error estimate for blocks of size 2^( 6) =       0.000464349589
  error estimate for blocks of size 2^( 7) =       0.000470983926

      target function =                  N/A
              le_mean =     -16.905744986791
             les_mean =     286.147616997728
             stat err =       0.000458622045
             autocorr =       1.292854458222
              std dev =       0.570420474194
             le_variance =       0.325379517380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325339731379
                                         uncertainty =       0.002875814615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325339731379
                                         uncertainty =       0.002875814615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403348185
  error estimate for blocks of size 2^( 2) =       0.000416332718
  error estimate for blocks of size 2^( 3) =       0.000429750967
  error estimate for blocks of size 2^( 4) =       0.000443290214
  error estimate for blocks of size 2^( 5) =       0.000455864450
  error estimate for blocks of size 2^( 6) =       0.000464349589
  error estimate for blocks of size 2^( 7) =       0.000470983926

      target function =                  N/A
              le_mean =     -16.905744986791
             les_mean =     286.147616997728
             stat err =       0.000458622045
             autocorr =       1.292854458222
              std dev =       0.570420474194
             le_variance =       0.325379517380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905744986791        initial  <--
     1.4901e+38     1.4901e+39             0.0000e+00       -16.905744986791
     5.9605e+38     5.9605e+39             0.0000e+00       -16.905744986791
     2.3842e+39     2.3842e+40             0.0000e+00       -16.905744986791

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5609
  </log>
  <optVariables href="H2O.s063.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.8854
    reference variance = 0.866095
====================================================
  Execution time = 2.1145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3780e-01
  Total weights = 1.951687391e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323203212346
                                         uncertainty =       0.002587744402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323203212346
                                         uncertainty =       0.002587744402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402017876
  error estimate for blocks of size 2^( 2) =       0.000414617457
  error estimate for blocks of size 2^( 3) =       0.000427699506
  error estimate for blocks of size 2^( 4) =       0.000440105897
  error estimate for blocks of size 2^( 5) =       0.000450397912
  error estimate for blocks of size 2^( 6) =       0.000457641882
  error estimate for blocks of size 2^( 7) =       0.000463209694

      target function =                  N/A
              le_mean =     -16.906179270134
             les_mean =     286.156693826590
             stat err =       0.000452838846
             autocorr =       1.268810086315
              std dev =       0.568539131940
             le_variance =       0.323236744547


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617927013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+39, overlap shift 1.4901e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179270130       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179270130       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+39, overlap shift 5.9605e+40 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179270130       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179270130       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+39 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+40, overlap shift 2.3842e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179270130       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179270130       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.427189 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7219e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -16.9155
    reference variance = 0.399117
====================================================
  Execution time = 2.1174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3030e-01
  Total weights = 1.9517e+06
  Execution time = 1.8997e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319115248684
                                         uncertainty =       0.001884455504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319115248684
                                         uncertainty =       0.001884455504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399446429
  error estimate for blocks of size 2^( 2) =       0.000412619649
  error estimate for blocks of size 2^( 3) =       0.000426652501
  error estimate for blocks of size 2^( 4) =       0.000439453950
  error estimate for blocks of size 2^( 5) =       0.000449972345
  error estimate for blocks of size 2^( 6) =       0.000458112988
  error estimate for blocks of size 2^( 7) =       0.000465694989

      target function =                  N/A
              le_mean =     -16.906148600218
             les_mean =     286.148165273214
             stat err =       0.000453308568
             autocorr =       1.287866272581
              std dev =       0.564902557039
             le_variance =       0.319114898949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319115248684
                                         uncertainty =       0.001884455504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319115248684
                                         uncertainty =       0.001884455504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399446429
  error estimate for blocks of size 2^( 2) =       0.000412619649
  error estimate for blocks of size 2^( 3) =       0.000426652501
  error estimate for blocks of size 2^( 4) =       0.000439453950
  error estimate for blocks of size 2^( 5) =       0.000449972345
  error estimate for blocks of size 2^( 6) =       0.000458112988
  error estimate for blocks of size 2^( 7) =       0.000465694989

      target function =                  N/A
              le_mean =     -16.906148600218
             les_mean =     286.148165273214
             stat err =       0.000453308568
             autocorr =       1.287866272581
              std dev =       0.564902557039
             le_variance =       0.319114898949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319115248684
                                         uncertainty =       0.001884455504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319115248684
                                         uncertainty =       0.001884455504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399446429
  error estimate for blocks of size 2^( 2) =       0.000412619649
  error estimate for blocks of size 2^( 3) =       0.000426652501
  error estimate for blocks of size 2^( 4) =       0.000439453950
  error estimate for blocks of size 2^( 5) =       0.000449972345
  error estimate for blocks of size 2^( 6) =       0.000458112988
  error estimate for blocks of size 2^( 7) =       0.000465694989

      target function =                  N/A
              le_mean =     -16.906148600218
             les_mean =     286.148165273214
             stat err =       0.000453308568
             autocorr =       1.287866272581
              std dev =       0.564902557039
             le_variance =       0.319114898949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319115248684
                                         uncertainty =       0.001884455504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319115248684
                                         uncertainty =       0.001884455504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399446429
  error estimate for blocks of size 2^( 2) =       0.000412619649
  error estimate for blocks of size 2^( 3) =       0.000426652501
  error estimate for blocks of size 2^( 4) =       0.000439453950
  error estimate for blocks of size 2^( 5) =       0.000449972345
  error estimate for blocks of size 2^( 6) =       0.000458112988
  error estimate for blocks of size 2^( 7) =       0.000465694989

      target function =                  N/A
              le_mean =     -16.906148600218
             les_mean =     286.148165273214
             stat err =       0.000453308568
             autocorr =       1.287866272581
              std dev =       0.564902557039
             le_variance =       0.319114898949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906148600218        initial  <--
     1.4901e+39     1.4901e+40             0.0000e+00       -16.906148600218
     5.9605e+39     5.9605e+40             0.0000e+00       -16.906148600218
     2.3842e+40     2.3842e+41             0.0000e+00       -16.906148600218

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7880
  </log>
  <optVariables href="H2O.s064.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8029e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.8958
    reference variance = 0.247557
====================================================
  Execution time = 2.1305e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3845e-01
  Total weights = 1.951877222e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0681e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326555106211
                                         uncertainty =       0.003260934023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326555106211
                                         uncertainty =       0.003260934023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404086982
  error estimate for blocks of size 2^( 2) =       0.000416762913
  error estimate for blocks of size 2^( 3) =       0.000429594758
  error estimate for blocks of size 2^( 4) =       0.000442127958
  error estimate for blocks of size 2^( 5) =       0.000452122262
  error estimate for blocks of size 2^( 6) =       0.000461233723
  error estimate for blocks of size 2^( 7) =       0.000466842206

      target function =                  N/A
              le_mean =     -16.905999418574
             les_mean =     286.151263907098
             stat err =       0.000455581537
             autocorr =       1.271108173337
              std dev =       0.571465291007
             le_variance =       0.326572578826


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599941857e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+40, overlap shift 1.4901e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905999418564       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905999418564       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+40, overlap shift 5.9605e+41 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905999418564       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905999418564       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+40 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+41, overlap shift 2.3842e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905999418564       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905999418564       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+41 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.428400 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7383e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -16.8246
    reference variance = 0.259377
====================================================
  Execution time = 2.1386e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4214e-01
  Total weights = 1.9521e+06
  Execution time = 1.9035e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327460452986
                                         uncertainty =       0.004239190988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327460452986
                                         uncertainty =       0.004239190988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404628284
  error estimate for blocks of size 2^( 2) =       0.000417277116
  error estimate for blocks of size 2^( 3) =       0.000430612879
  error estimate for blocks of size 2^( 4) =       0.000442861963
  error estimate for blocks of size 2^( 5) =       0.000453746287
  error estimate for blocks of size 2^( 6) =       0.000461905255
  error estimate for blocks of size 2^( 7) =       0.000463627448

      target function =                  N/A
              le_mean =     -16.906251850727
             les_mean =     286.163496259811
             stat err =       0.000455535238
             autocorr =       1.267451881643
              std dev =       0.572230807528
             le_variance =       0.327448097084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327460452986
                                         uncertainty =       0.004239190988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327460452986
                                         uncertainty =       0.004239190988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404628284
  error estimate for blocks of size 2^( 2) =       0.000417277116
  error estimate for blocks of size 2^( 3) =       0.000430612879
  error estimate for blocks of size 2^( 4) =       0.000442861963
  error estimate for blocks of size 2^( 5) =       0.000453746287
  error estimate for blocks of size 2^( 6) =       0.000461905255
  error estimate for blocks of size 2^( 7) =       0.000463627448

      target function =                  N/A
              le_mean =     -16.906251850727
             les_mean =     286.163496259811
             stat err =       0.000455535238
             autocorr =       1.267451881643
              std dev =       0.572230807528
             le_variance =       0.327448097084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327460452986
                                         uncertainty =       0.004239190988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327460452986
                                         uncertainty =       0.004239190988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404628284
  error estimate for blocks of size 2^( 2) =       0.000417277116
  error estimate for blocks of size 2^( 3) =       0.000430612879
  error estimate for blocks of size 2^( 4) =       0.000442861963
  error estimate for blocks of size 2^( 5) =       0.000453746287
  error estimate for blocks of size 2^( 6) =       0.000461905255
  error estimate for blocks of size 2^( 7) =       0.000463627448

      target function =                  N/A
              le_mean =     -16.906251850727
             les_mean =     286.163496259811
             stat err =       0.000455535238
             autocorr =       1.267451881643
              std dev =       0.572230807528
             le_variance =       0.327448097084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327460452986
                                         uncertainty =       0.004239190988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327460452986
                                         uncertainty =       0.004239190988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404628284
  error estimate for blocks of size 2^( 2) =       0.000417277116
  error estimate for blocks of size 2^( 3) =       0.000430612879
  error estimate for blocks of size 2^( 4) =       0.000442861963
  error estimate for blocks of size 2^( 5) =       0.000453746287
  error estimate for blocks of size 2^( 6) =       0.000461905255
  error estimate for blocks of size 2^( 7) =       0.000463627448

      target function =                  N/A
              le_mean =     -16.906251850727
             les_mean =     286.163496259811
             stat err =       0.000455535238
             autocorr =       1.267451881643
              std dev =       0.572230807528
             le_variance =       0.327448097084


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906251850727        initial  <--
     1.4901e+40     1.4901e+41             0.0000e+00       -16.906251850727
     5.9605e+40     5.9605e+41             0.0000e+00       -16.906251850727
     2.3842e+41     2.3842e+42             0.0000e+00       -16.906251850727

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0112
  </log>
  <optVariables href="H2O.s065.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8400e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.8103
    reference variance = 0.396853
====================================================
  Execution time = 2.1356e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3459e-01
  Total weights = 1.951573324e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321013122893
                                         uncertainty =       0.002097644036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321013122893
                                         uncertainty =       0.002097644036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400590152
  error estimate for blocks of size 2^( 2) =       0.000414073876
  error estimate for blocks of size 2^( 3) =       0.000427792082
  error estimate for blocks of size 2^( 4) =       0.000439806732
  error estimate for blocks of size 2^( 5) =       0.000450345909
  error estimate for blocks of size 2^( 6) =       0.000459632958
  error estimate for blocks of size 2^( 7) =       0.000466382705

      target function =                  N/A
              le_mean =     -16.906135055113
             les_mean =     286.151993433677
             stat err =       0.000454042076
             autocorr =       1.284670240124
              std dev =       0.566520026225
             le_variance =       0.320944940114


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613505511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+41, overlap shift 1.4901e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906135055102       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906135055102       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906135055102       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250000000       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -17.000000000000       residual = 6.47e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+41 is 2.754998e-45

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+41, overlap shift 5.9605e+42 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906135055102       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906135055102       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906135055102       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250000000       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906250000000       residual = 5.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+41 is 6.887494e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+42, overlap shift 2.3842e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906135055102       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906135055102       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906135055102       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906250000000       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906250000000       residual = 5.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+42 is 1.721874e-46

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.430544 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7465e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -16.8803
    reference variance = 0.144977
====================================================
  Execution time = 2.0774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3793e-01
  Total weights = 1.9513e+06
  Execution time = 1.9078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323766817039
                                         uncertainty =       0.002210464160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323766817039
                                         uncertainty =       0.002210464160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402300080
  error estimate for blocks of size 2^( 2) =       0.000415469220
  error estimate for blocks of size 2^( 3) =       0.000429538281
  error estimate for blocks of size 2^( 4) =       0.000442713184
  error estimate for blocks of size 2^( 5) =       0.000453290484
  error estimate for blocks of size 2^( 6) =       0.000461020079
  error estimate for blocks of size 2^( 7) =       0.000464320553

      target function =                  N/A
              le_mean =     -16.906002887184
             les_mean =     286.150862410621
             stat err =       0.000455336075
             autocorr =       1.281043512919
              std dev =       0.568938228958
             le_variance =       0.323690708369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323766817039
                                         uncertainty =       0.002210464160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323766817039
                                         uncertainty =       0.002210464160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402300080
  error estimate for blocks of size 2^( 2) =       0.000415469220
  error estimate for blocks of size 2^( 3) =       0.000429538281
  error estimate for blocks of size 2^( 4) =       0.000442713184
  error estimate for blocks of size 2^( 5) =       0.000453290484
  error estimate for blocks of size 2^( 6) =       0.000461020079
  error estimate for blocks of size 2^( 7) =       0.000464320553

      target function =                  N/A
              le_mean =     -16.906002887184
             les_mean =     286.150862410621
             stat err =       0.000455336075
             autocorr =       1.281043512919
              std dev =       0.568938228958
             le_variance =       0.323690708369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323766817039
                                         uncertainty =       0.002210464160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323766817039
                                         uncertainty =       0.002210464160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402300080
  error estimate for blocks of size 2^( 2) =       0.000415469220
  error estimate for blocks of size 2^( 3) =       0.000429538281
  error estimate for blocks of size 2^( 4) =       0.000442713184
  error estimate for blocks of size 2^( 5) =       0.000453290484
  error estimate for blocks of size 2^( 6) =       0.000461020079
  error estimate for blocks of size 2^( 7) =       0.000464320553

      target function =                  N/A
              le_mean =     -16.906002887184
             les_mean =     286.150862410621
             stat err =       0.000455336075
             autocorr =       1.281043512919
              std dev =       0.568938228958
             le_variance =       0.323690708369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323766817039
                                         uncertainty =       0.002210464160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323766817039
                                         uncertainty =       0.002210464160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402300080
  error estimate for blocks of size 2^( 2) =       0.000415469220
  error estimate for blocks of size 2^( 3) =       0.000429538281
  error estimate for blocks of size 2^( 4) =       0.000442713184
  error estimate for blocks of size 2^( 5) =       0.000453290484
  error estimate for blocks of size 2^( 6) =       0.000461020079
  error estimate for blocks of size 2^( 7) =       0.000464320553

      target function =                  N/A
              le_mean =     -16.906002887184
             les_mean =     286.150862410621
             stat err =       0.000455336075
             autocorr =       1.281043512919
              std dev =       0.568938228958
             le_variance =       0.323690708369


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906002887184        initial  <--
     1.4901e+41     1.4901e+42             2.7550e-45       -16.906002887184
     5.9605e+41     5.9605e+42             6.8875e-46       -16.906002887184
     2.3842e+42     2.3842e+43             1.7219e-46       -16.906002887184

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5506
  </log>
  <optVariables href="H2O.s066.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8025e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.8845
    reference variance = 0.228185
====================================================
  Execution time = 2.3119e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3780e-01
  Total weights = 1.952012131e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0479e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325088286887
                                         uncertainty =       0.003387247174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325088286887
                                         uncertainty =       0.003387247174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403171781
  error estimate for blocks of size 2^( 2) =       0.000415887042
  error estimate for blocks of size 2^( 3) =       0.000428825417
  error estimate for blocks of size 2^( 4) =       0.000442070714
  error estimate for blocks of size 2^( 5) =       0.000453735858
  error estimate for blocks of size 2^( 6) =       0.000462640517
  error estimate for blocks of size 2^( 7) =       0.000467361192

      target function =                  N/A
              le_mean =     -16.905895241645
             les_mean =     286.147091543461
             stat err =       0.000456452070
             autocorr =       1.281770018178
              std dev =       0.570171000220
             le_variance =       0.325094969492


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589524164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+42, overlap shift 1.4901e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895241656       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895241656       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+42, overlap shift 5.9605e+43 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895241656       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895241656       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+42 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+43, overlap shift 2.3842e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905895241656       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905895241656       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.431929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9178e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -16.9372
    reference variance = 0.502847
====================================================
  Execution time = 2.1034e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3143e-01
  Total weights = 1.9514e+06
  Execution time = 1.9104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321739495676
                                         uncertainty =       0.002019926508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321739495676
                                         uncertainty =       0.002019926508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401035844
  error estimate for blocks of size 2^( 2) =       0.000414059305
  error estimate for blocks of size 2^( 3) =       0.000426835062
  error estimate for blocks of size 2^( 4) =       0.000439466422
  error estimate for blocks of size 2^( 5) =       0.000449598231
  error estimate for blocks of size 2^( 6) =       0.000455958052
  error estimate for blocks of size 2^( 7) =       0.000461865217

      target function =                  N/A
              le_mean =     -16.906371839828
             les_mean =     286.156841495645
             stat err =       0.000451721981
             autocorr =       1.268750028493
              std dev =       0.567150329840
             le_variance =       0.321659496637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321739495676
                                         uncertainty =       0.002019926508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321739495676
                                         uncertainty =       0.002019926508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401035844
  error estimate for blocks of size 2^( 2) =       0.000414059305
  error estimate for blocks of size 2^( 3) =       0.000426835062
  error estimate for blocks of size 2^( 4) =       0.000439466422
  error estimate for blocks of size 2^( 5) =       0.000449598231
  error estimate for blocks of size 2^( 6) =       0.000455958052
  error estimate for blocks of size 2^( 7) =       0.000461865217

      target function =                  N/A
              le_mean =     -16.906371839828
             les_mean =     286.156841495645
             stat err =       0.000451721981
             autocorr =       1.268750028493
              std dev =       0.567150329840
             le_variance =       0.321659496637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321739495676
                                         uncertainty =       0.002019926508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321739495676
                                         uncertainty =       0.002019926508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401035844
  error estimate for blocks of size 2^( 2) =       0.000414059305
  error estimate for blocks of size 2^( 3) =       0.000426835062
  error estimate for blocks of size 2^( 4) =       0.000439466422
  error estimate for blocks of size 2^( 5) =       0.000449598231
  error estimate for blocks of size 2^( 6) =       0.000455958052
  error estimate for blocks of size 2^( 7) =       0.000461865217

      target function =                  N/A
              le_mean =     -16.906371839828
             les_mean =     286.156841495645
             stat err =       0.000451721981
             autocorr =       1.268750028493
              std dev =       0.567150329840
             le_variance =       0.321659496637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321739495676
                                         uncertainty =       0.002019926508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321739495676
                                         uncertainty =       0.002019926508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401035844
  error estimate for blocks of size 2^( 2) =       0.000414059305
  error estimate for blocks of size 2^( 3) =       0.000426835062
  error estimate for blocks of size 2^( 4) =       0.000439466422
  error estimate for blocks of size 2^( 5) =       0.000449598231
  error estimate for blocks of size 2^( 6) =       0.000455958052
  error estimate for blocks of size 2^( 7) =       0.000461865217

      target function =                  N/A
              le_mean =     -16.906371839828
             les_mean =     286.156841495645
             stat err =       0.000451721981
             autocorr =       1.268750028493
              std dev =       0.567150329840
             le_variance =       0.321659496637


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906371839828        initial  <--
     1.4901e+42     1.4901e+43             0.0000e+00       -16.906371839828
     5.9605e+42     5.9605e+43             0.0000e+00       -16.906371839828
     2.3842e+43     2.3842e+44             0.0000e+00       -16.906371839828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7017
  </log>
  <optVariables href="H2O.s067.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9885e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.8615
    reference variance = 0.256537
====================================================
  Execution time = 2.1222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5248e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4222e-01
  Total weights = 1.951575463e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1262e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328379392893
                                         uncertainty =       0.004655933484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328379392893
                                         uncertainty =       0.004655933484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405169290
  error estimate for blocks of size 2^( 2) =       0.000418030797
  error estimate for blocks of size 2^( 3) =       0.000431081356
  error estimate for blocks of size 2^( 4) =       0.000443635214
  error estimate for blocks of size 2^( 5) =       0.000454911127
  error estimate for blocks of size 2^( 6) =       0.000463670378
  error estimate for blocks of size 2^( 7) =       0.000471063870

      target function =                  N/A
              le_mean =     -16.905386186548
             les_mean =     286.134302556886
             stat err =       0.000458320147
             autocorr =       1.279572378407
              std dev =       0.572995905155
             le_variance =       0.328324307324


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690538618655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+43, overlap shift 1.4901e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905386186546       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905386186546       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+43, overlap shift 5.9605e+44 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905386186546       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905386186546       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+43 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+44, overlap shift 2.3842e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905386186546       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905386186546       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.433134 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7358e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -16.9718
    reference variance = 0.302261
====================================================
  Execution time = 2.1411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3823e-01
  Total weights = 1.9518e+06
  Execution time = 1.9032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323759408866
                                         uncertainty =       0.002429776578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323759408866
                                         uncertainty =       0.002429776578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402350219
  error estimate for blocks of size 2^( 2) =       0.000415292276
  error estimate for blocks of size 2^( 3) =       0.000428189293
  error estimate for blocks of size 2^( 4) =       0.000439971053
  error estimate for blocks of size 2^( 5) =       0.000449668839
  error estimate for blocks of size 2^( 6) =       0.000456308220
  error estimate for blocks of size 2^( 7) =       0.000459704478

      target function =                  N/A
              le_mean =     -16.906462362029
             les_mean =     286.166697603503
             stat err =       0.000451413147
             autocorr =       1.258751272281
              std dev =       0.569009136887
             le_variance =       0.323771397861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323759408866
                                         uncertainty =       0.002429776578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323759408866
                                         uncertainty =       0.002429776578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402350219
  error estimate for blocks of size 2^( 2) =       0.000415292276
  error estimate for blocks of size 2^( 3) =       0.000428189293
  error estimate for blocks of size 2^( 4) =       0.000439971053
  error estimate for blocks of size 2^( 5) =       0.000449668839
  error estimate for blocks of size 2^( 6) =       0.000456308220
  error estimate for blocks of size 2^( 7) =       0.000459704478

      target function =                  N/A
              le_mean =     -16.906462362029
             les_mean =     286.166697603503
             stat err =       0.000451413147
             autocorr =       1.258751272281
              std dev =       0.569009136887
             le_variance =       0.323771397861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323759408866
                                         uncertainty =       0.002429776578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323759408866
                                         uncertainty =       0.002429776578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402350219
  error estimate for blocks of size 2^( 2) =       0.000415292276
  error estimate for blocks of size 2^( 3) =       0.000428189293
  error estimate for blocks of size 2^( 4) =       0.000439971053
  error estimate for blocks of size 2^( 5) =       0.000449668839
  error estimate for blocks of size 2^( 6) =       0.000456308220
  error estimate for blocks of size 2^( 7) =       0.000459704478

      target function =                  N/A
              le_mean =     -16.906462362029
             les_mean =     286.166697603503
             stat err =       0.000451413147
             autocorr =       1.258751272281
              std dev =       0.569009136887
             le_variance =       0.323771397861

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323759408866
                                         uncertainty =       0.002429776578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323759408866
                                         uncertainty =       0.002429776578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402350219
  error estimate for blocks of size 2^( 2) =       0.000415292276
  error estimate for blocks of size 2^( 3) =       0.000428189293
  error estimate for blocks of size 2^( 4) =       0.000439971053
  error estimate for blocks of size 2^( 5) =       0.000449668839
  error estimate for blocks of size 2^( 6) =       0.000456308220
  error estimate for blocks of size 2^( 7) =       0.000459704478

      target function =                  N/A
              le_mean =     -16.906462362029
             les_mean =     286.166697603503
             stat err =       0.000451413147
             autocorr =       1.258751272281
              std dev =       0.569009136887
             le_variance =       0.323771397861


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906462362029        initial  <--
     1.4901e+43     1.4901e+44             0.0000e+00       -16.906462362029
     5.9605e+43     5.9605e+44             0.0000e+00       -16.906462362029
     2.3842e+44     2.3842e+45             0.0000e+00       -16.906462362029

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0352
  </log>
  <optVariables href="H2O.s068.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8400e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9425
    reference variance = 0.355108
====================================================
  Execution time = 2.1291e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4890e-01
  Total weights = 1.951780160e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1784e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326604519028
                                         uncertainty =       0.003489130194

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326604519028
                                         uncertainty =       0.003489130194

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404067504
  error estimate for blocks of size 2^( 2) =       0.000416970191
  error estimate for blocks of size 2^( 3) =       0.000429622687
  error estimate for blocks of size 2^( 4) =       0.000442013346
  error estimate for blocks of size 2^( 5) =       0.000452855077
  error estimate for blocks of size 2^( 6) =       0.000460038546
  error estimate for blocks of size 2^( 7) =       0.000467050201

      target function =                  N/A
              le_mean =     -16.906161750313
             les_mean =     286.167205848061
             stat err =       0.000455489293
             autocorr =       1.270715989179
              std dev =       0.571437744212
             le_variance =       0.326541095510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616175031e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+44, overlap shift 1.4901e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906161750313       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906161750313       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+44, overlap shift 5.9605e+45 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906161750313       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906161750313       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+44 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+45, overlap shift 2.3842e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906161750313       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906161750313       residual = 1.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.434334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7480e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -16.9054
    reference variance = 0.249142
====================================================
  Execution time = 2.1201e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3315e-01
  Total weights = 1.9518e+06
  Execution time = 1.9092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322644034773
                                         uncertainty =       0.002160205689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322644034773
                                         uncertainty =       0.002160205689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401782513
  error estimate for blocks of size 2^( 2) =       0.000414760117
  error estimate for blocks of size 2^( 3) =       0.000427849119
  error estimate for blocks of size 2^( 4) =       0.000440485708
  error estimate for blocks of size 2^( 5) =       0.000451744554
  error estimate for blocks of size 2^( 6) =       0.000460188586
  error estimate for blocks of size 2^( 7) =       0.000465109333

      target function =                  N/A
              le_mean =     -16.905790285024
             les_mean =     286.138893419070
             stat err =       0.000454382046
             autocorr =       1.278969721974
              std dev =       0.568206278971
             le_variance =       0.322858375462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322644034773
                                         uncertainty =       0.002160205689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322644034773
                                         uncertainty =       0.002160205689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401782513
  error estimate for blocks of size 2^( 2) =       0.000414760117
  error estimate for blocks of size 2^( 3) =       0.000427849119
  error estimate for blocks of size 2^( 4) =       0.000440485708
  error estimate for blocks of size 2^( 5) =       0.000451744554
  error estimate for blocks of size 2^( 6) =       0.000460188586
  error estimate for blocks of size 2^( 7) =       0.000465109333

      target function =                  N/A
              le_mean =     -16.905790285024
             les_mean =     286.138893419070
             stat err =       0.000454382046
             autocorr =       1.278969721974
              std dev =       0.568206278971
             le_variance =       0.322858375462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322644034773
                                         uncertainty =       0.002160205689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322644034773
                                         uncertainty =       0.002160205689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401782513
  error estimate for blocks of size 2^( 2) =       0.000414760117
  error estimate for blocks of size 2^( 3) =       0.000427849119
  error estimate for blocks of size 2^( 4) =       0.000440485708
  error estimate for blocks of size 2^( 5) =       0.000451744554
  error estimate for blocks of size 2^( 6) =       0.000460188586
  error estimate for blocks of size 2^( 7) =       0.000465109333

      target function =                  N/A
              le_mean =     -16.905790285024
             les_mean =     286.138893419070
             stat err =       0.000454382046
             autocorr =       1.278969721974
              std dev =       0.568206278971
             le_variance =       0.322858375462

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322644034773
                                         uncertainty =       0.002160205689

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322644034773
                                         uncertainty =       0.002160205689

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401782513
  error estimate for blocks of size 2^( 2) =       0.000414760117
  error estimate for blocks of size 2^( 3) =       0.000427849119
  error estimate for blocks of size 2^( 4) =       0.000440485708
  error estimate for blocks of size 2^( 5) =       0.000451744554
  error estimate for blocks of size 2^( 6) =       0.000460188586
  error estimate for blocks of size 2^( 7) =       0.000465109333

      target function =                  N/A
              le_mean =     -16.905790285024
             les_mean =     286.138893419070
             stat err =       0.000454382046
             autocorr =       1.278969721974
              std dev =       0.568206278971
             le_variance =       0.322858375462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905790285024        initial  <--
     1.4901e+44     1.4901e+45             0.0000e+00       -16.905790285024
     5.9605e+44     5.9605e+45             0.0000e+00       -16.905790285024
     2.3842e+45     2.3842e+46             0.0000e+00       -16.905790285024

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8618
  </log>
  <optVariables href="H2O.s069.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8347e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.9577
    reference variance = 0.266462
====================================================
  Execution time = 2.1170e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4624e-01
  Total weights = 1.951586048e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323876904383
                                         uncertainty =       0.003858387469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323876904383
                                         uncertainty =       0.003858387469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402406694
  error estimate for blocks of size 2^( 2) =       0.000414917439
  error estimate for blocks of size 2^( 3) =       0.000428246547
  error estimate for blocks of size 2^( 4) =       0.000440571502
  error estimate for blocks of size 2^( 5) =       0.000451260985
  error estimate for blocks of size 2^( 6) =       0.000458695287
  error estimate for blocks of size 2^( 7) =       0.000465443003

      target function =                  N/A
              le_mean =     -16.906375167294
             les_mean =     286.171765461089
             stat err =       0.000453992694
             autocorr =       1.272821012160
              std dev =       0.569089003620
             le_variance =       0.323862294041


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637516729e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+45, overlap shift 1.4901e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906375167296       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906375167296       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+45, overlap shift 5.9605e+46 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906375167296       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906375167296       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+45 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+46, overlap shift 2.3842e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906375167296       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906375167296       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+46 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.435504 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7292e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -16.8877
    reference variance = 0.154708
====================================================
  Execution time = 2.0969e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3596e-01
  Total weights = 1.9516e+06
  Execution time = 1.8926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325040143161
                                         uncertainty =       0.003001580133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325040143161
                                         uncertainty =       0.003001580133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403124925
  error estimate for blocks of size 2^( 2) =       0.000416208498
  error estimate for blocks of size 2^( 3) =       0.000429373010
  error estimate for blocks of size 2^( 4) =       0.000441914792
  error estimate for blocks of size 2^( 5) =       0.000452868257
  error estimate for blocks of size 2^( 6) =       0.000461099859
  error estimate for blocks of size 2^( 7) =       0.000467965988

      target function =                  N/A
              le_mean =     -16.906063216879
             les_mean =     286.150929591384
             stat err =       0.000455962224
             autocorr =       1.279317746214
              std dev =       0.570104736291
             le_variance =       0.325019410341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325040143161
                                         uncertainty =       0.003001580133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325040143161
                                         uncertainty =       0.003001580133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403124925
  error estimate for blocks of size 2^( 2) =       0.000416208498
  error estimate for blocks of size 2^( 3) =       0.000429373010
  error estimate for blocks of size 2^( 4) =       0.000441914792
  error estimate for blocks of size 2^( 5) =       0.000452868257
  error estimate for blocks of size 2^( 6) =       0.000461099859
  error estimate for blocks of size 2^( 7) =       0.000467965988

      target function =                  N/A
              le_mean =     -16.906063216879
             les_mean =     286.150929591384
             stat err =       0.000455962224
             autocorr =       1.279317746214
              std dev =       0.570104736291
             le_variance =       0.325019410341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325040143161
                                         uncertainty =       0.003001580133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325040143161
                                         uncertainty =       0.003001580133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403124925
  error estimate for blocks of size 2^( 2) =       0.000416208498
  error estimate for blocks of size 2^( 3) =       0.000429373010
  error estimate for blocks of size 2^( 4) =       0.000441914792
  error estimate for blocks of size 2^( 5) =       0.000452868257
  error estimate for blocks of size 2^( 6) =       0.000461099859
  error estimate for blocks of size 2^( 7) =       0.000467965988

      target function =                  N/A
              le_mean =     -16.906063216879
             les_mean =     286.150929591384
             stat err =       0.000455962224
             autocorr =       1.279317746214
              std dev =       0.570104736291
             le_variance =       0.325019410341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325040143161
                                         uncertainty =       0.003001580133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325040143161
                                         uncertainty =       0.003001580133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403124925
  error estimate for blocks of size 2^( 2) =       0.000416208498
  error estimate for blocks of size 2^( 3) =       0.000429373010
  error estimate for blocks of size 2^( 4) =       0.000441914792
  error estimate for blocks of size 2^( 5) =       0.000452868257
  error estimate for blocks of size 2^( 6) =       0.000461099859
  error estimate for blocks of size 2^( 7) =       0.000467965988

      target function =                  N/A
              le_mean =     -16.906063216879
             les_mean =     286.150929591384
             stat err =       0.000455962224
             autocorr =       1.279317746214
              std dev =       0.570104736291
             le_variance =       0.325019410341


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906063216879        initial  <--
     1.4901e+45     1.4901e+46             0.0000e+00       -16.906063216879
     5.9605e+45     5.9605e+46             0.0000e+00       -16.906063216879
     2.3842e+46     2.3842e+47             0.0000e+00       -16.906063216879

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5485
  </log>
  <optVariables href="H2O.s070.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7847e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.8591
    reference variance = 0.174666
====================================================
  Execution time = 2.1232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3250e-01
  Total weights = 1.951955717e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320404121138
                                         uncertainty =       0.001934896773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320404121138
                                         uncertainty =       0.001934896773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400225724
  error estimate for blocks of size 2^( 2) =       0.000413193210
  error estimate for blocks of size 2^( 3) =       0.000426340897
  error estimate for blocks of size 2^( 4) =       0.000437838352
  error estimate for blocks of size 2^( 5) =       0.000449077737
  error estimate for blocks of size 2^( 6) =       0.000457149566
  error estimate for blocks of size 2^( 7) =       0.000464792203

      target function =                  N/A
              le_mean =     -16.906180999425
             les_mean =     286.151453636544
             stat err =       0.000452214465
             autocorr =       1.276670730882
              std dev =       0.566004646902
             le_variance =       0.320361260315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690618099942e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+46, overlap shift 1.4901e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906180999417       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906180999417       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906180999417       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+46 is 3.151957e-50

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+46, overlap shift 5.9605e+47 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906180999417       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906180999417       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -17.000000000000       residual = 1.17e+00           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+46 is 7.879892e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+47, overlap shift 2.3842e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906180999417       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906180999417       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906180999417       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+47 is 1.969973e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.436938 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7322e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -16.9063
    reference variance = 0.195287
====================================================
  Execution time = 2.0956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3875e-01
  Total weights = 1.9519e+06
  Execution time = 1.9042e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323129221855
                                         uncertainty =       0.002899785594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323129221855
                                         uncertainty =       0.002899785594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401945616
  error estimate for blocks of size 2^( 2) =       0.000414559189
  error estimate for blocks of size 2^( 3) =       0.000427142987
  error estimate for blocks of size 2^( 4) =       0.000439002941
  error estimate for blocks of size 2^( 5) =       0.000449038959
  error estimate for blocks of size 2^( 6) =       0.000455782077
  error estimate for blocks of size 2^( 7) =       0.000461794374

      target function =                  N/A
              le_mean =     -16.906197437816
             les_mean =     286.158261730705
             stat err =       0.000451404588
             autocorr =       1.261238864704
              std dev =       0.568436941278
             le_variance =       0.323120556210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323129221855
                                         uncertainty =       0.002899785594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323129221855
                                         uncertainty =       0.002899785594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401945616
  error estimate for blocks of size 2^( 2) =       0.000414559189
  error estimate for blocks of size 2^( 3) =       0.000427142987
  error estimate for blocks of size 2^( 4) =       0.000439002941
  error estimate for blocks of size 2^( 5) =       0.000449038959
  error estimate for blocks of size 2^( 6) =       0.000455782077
  error estimate for blocks of size 2^( 7) =       0.000461794374

      target function =                  N/A
              le_mean =     -16.906197437816
             les_mean =     286.158261730705
             stat err =       0.000451404588
             autocorr =       1.261238864704
              std dev =       0.568436941278
             le_variance =       0.323120556210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323129221855
                                         uncertainty =       0.002899785594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323129221855
                                         uncertainty =       0.002899785594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401945616
  error estimate for blocks of size 2^( 2) =       0.000414559189
  error estimate for blocks of size 2^( 3) =       0.000427142987
  error estimate for blocks of size 2^( 4) =       0.000439002941
  error estimate for blocks of size 2^( 5) =       0.000449038959
  error estimate for blocks of size 2^( 6) =       0.000455782077
  error estimate for blocks of size 2^( 7) =       0.000461794374

      target function =                  N/A
              le_mean =     -16.906197437816
             les_mean =     286.158261730705
             stat err =       0.000451404588
             autocorr =       1.261238864704
              std dev =       0.568436941278
             le_variance =       0.323120556210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323129221855
                                         uncertainty =       0.002899785594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323129221855
                                         uncertainty =       0.002899785594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401945616
  error estimate for blocks of size 2^( 2) =       0.000414559189
  error estimate for blocks of size 2^( 3) =       0.000427142987
  error estimate for blocks of size 2^( 4) =       0.000439002941
  error estimate for blocks of size 2^( 5) =       0.000449038959
  error estimate for blocks of size 2^( 6) =       0.000455782077
  error estimate for blocks of size 2^( 7) =       0.000461794374

      target function =                  N/A
              le_mean =     -16.906197437816
             les_mean =     286.158261730705
             stat err =       0.000451404588
             autocorr =       1.261238864704
              std dev =       0.568436941278
             le_variance =       0.323120556210


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906197437816        initial  <--
     1.4901e+46     1.4901e+47             3.1520e-50       -16.906197437816
     5.9605e+46     5.9605e+47             7.8799e-51       -16.906197437816
     2.3842e+47     2.3842e+48             1.9700e-51       -16.906197437816

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5851
  </log>
  <optVariables href="H2O.s071.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7913e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.8369
    reference variance = 0.290681
====================================================
  Execution time = 2.3215e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3540e-01
  Total weights = 1.951354641e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1610e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321741013165
                                         uncertainty =       0.001934103030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321741013165
                                         uncertainty =       0.001934103030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401042028
  error estimate for blocks of size 2^( 2) =       0.000413915344
  error estimate for blocks of size 2^( 3) =       0.000427419669
  error estimate for blocks of size 2^( 4) =       0.000439723942
  error estimate for blocks of size 2^( 5) =       0.000451243576
  error estimate for blocks of size 2^( 6) =       0.000460038150
  error estimate for blocks of size 2^( 7) =       0.000466041167

      target function =                  N/A
              le_mean =     -16.905625131567
             les_mean =     286.135557695523
             stat err =       0.000454261709
             autocorr =       1.283017221521
              std dev =       0.567159074636
             le_variance =       0.321669415942


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690562513157e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+47, overlap shift 1.4901e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905625131555       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905625131555       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906250000000       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+47 is 2.492876e-51

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+47, overlap shift 5.9605e+48 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905625131555       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905625131555       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906250000000       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+47 is 6.232189e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+48, overlap shift 2.3842e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905625131555       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905625131555       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+48 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.438318 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9386e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -16.8971
    reference variance = 0.232233
====================================================
  Execution time = 2.0735e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3909e-01
  Total weights = 1.9516e+06
  Execution time = 1.8956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328048505569
                                         uncertainty =       0.004102360325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328048505569
                                         uncertainty =       0.004102360325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404989838
  error estimate for blocks of size 2^( 2) =       0.000417669689
  error estimate for blocks of size 2^( 3) =       0.000431560841
  error estimate for blocks of size 2^( 4) =       0.000444237377
  error estimate for blocks of size 2^( 5) =       0.000454887096
  error estimate for blocks of size 2^( 6) =       0.000463122062
  error estimate for blocks of size 2^( 7) =       0.000469731337

      target function =                  N/A
              le_mean =     -16.905691965142
             les_mean =     286.141508308415
             stat err =       0.000457994468
             autocorr =       1.278887116138
              std dev =       0.572742121864
             le_variance =       0.328033538157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328048505569
                                         uncertainty =       0.004102360325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328048505569
                                         uncertainty =       0.004102360325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404989838
  error estimate for blocks of size 2^( 2) =       0.000417669689
  error estimate for blocks of size 2^( 3) =       0.000431560841
  error estimate for blocks of size 2^( 4) =       0.000444237377
  error estimate for blocks of size 2^( 5) =       0.000454887096
  error estimate for blocks of size 2^( 6) =       0.000463122062
  error estimate for blocks of size 2^( 7) =       0.000469731337

      target function =                  N/A
              le_mean =     -16.905691965142
             les_mean =     286.141508308415
             stat err =       0.000457994468
             autocorr =       1.278887116138
              std dev =       0.572742121864
             le_variance =       0.328033538157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328048505569
                                         uncertainty =       0.004102360325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328048505569
                                         uncertainty =       0.004102360325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404989838
  error estimate for blocks of size 2^( 2) =       0.000417669689
  error estimate for blocks of size 2^( 3) =       0.000431560841
  error estimate for blocks of size 2^( 4) =       0.000444237377
  error estimate for blocks of size 2^( 5) =       0.000454887096
  error estimate for blocks of size 2^( 6) =       0.000463122062
  error estimate for blocks of size 2^( 7) =       0.000469731337

      target function =                  N/A
              le_mean =     -16.905691965142
             les_mean =     286.141508308415
             stat err =       0.000457994468
             autocorr =       1.278887116138
              std dev =       0.572742121864
             le_variance =       0.328033538157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328048505569
                                         uncertainty =       0.004102360325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328048505569
                                         uncertainty =       0.004102360325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404989838
  error estimate for blocks of size 2^( 2) =       0.000417669689
  error estimate for blocks of size 2^( 3) =       0.000431560841
  error estimate for blocks of size 2^( 4) =       0.000444237377
  error estimate for blocks of size 2^( 5) =       0.000454887096
  error estimate for blocks of size 2^( 6) =       0.000463122062
  error estimate for blocks of size 2^( 7) =       0.000469731337

      target function =                  N/A
              le_mean =     -16.905691965142
             les_mean =     286.141508308415
             stat err =       0.000457994468
             autocorr =       1.278887116138
              std dev =       0.572742121864
             le_variance =       0.328033538157


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905691965142        initial  <--
     1.4901e+47     1.4901e+48             2.4929e-51       -16.905691965142
     5.9605e+47     5.9605e+48             6.2322e-52       -16.905691965142
     2.3842e+48     2.3842e+49             0.0000e+00       -16.905691965142

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3251
  </log>
  <optVariables href="H2O.s072.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9717e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.8836
    reference variance = 0.177823
====================================================
  Execution time = 2.1272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5247e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3167e-01
  Total weights = 1.951781734e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320152988435
                                         uncertainty =       0.001949260584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320152988435
                                         uncertainty =       0.001949260584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400075695
  error estimate for blocks of size 2^( 2) =       0.000413200582
  error estimate for blocks of size 2^( 3) =       0.000426748101
  error estimate for blocks of size 2^( 4) =       0.000438843723
  error estimate for blocks of size 2^( 5) =       0.000448434763
  error estimate for blocks of size 2^( 6) =       0.000455393129
  error estimate for blocks of size 2^( 7) =       0.000458590714

      target function =                  N/A
              le_mean =     -16.906763686393
             les_mean =     286.170326990138
             stat err =       0.000450315582
             autocorr =       1.266921229625
              std dev =       0.565792473763
             le_variance =       0.320121123367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690676368639e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+48, overlap shift 1.4901e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906763686390       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906763686390       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+48, overlap shift 5.9605e+49 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906763686390       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906763686390       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+48 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+49, overlap shift 2.3842e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906763686390       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906763686390       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+49 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.439504 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7390e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -16.9003
    reference variance = 0.267169
====================================================
  Execution time = 2.1042e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3745e-01
  Total weights = 1.9523e+06
  Execution time = 1.9120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361966918
                                         uncertainty =       0.001972362742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361966918
                                         uncertainty =       0.001972362742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402702552
  error estimate for blocks of size 2^( 2) =       0.000415057550
  error estimate for blocks of size 2^( 3) =       0.000428305116
  error estimate for blocks of size 2^( 4) =       0.000440680972
  error estimate for blocks of size 2^( 5) =       0.000450549292
  error estimate for blocks of size 2^( 6) =       0.000456146087
  error estimate for blocks of size 2^( 7) =       0.000460437741

      target function =                  N/A
              le_mean =     -16.907000565594
             les_mean =     286.184116619609
             stat err =       0.000451953523
             autocorr =       1.259559794440
              std dev =       0.569507409956
             le_variance =       0.324338689995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361966918
                                         uncertainty =       0.001972362742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361966918
                                         uncertainty =       0.001972362742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402702552
  error estimate for blocks of size 2^( 2) =       0.000415057550
  error estimate for blocks of size 2^( 3) =       0.000428305116
  error estimate for blocks of size 2^( 4) =       0.000440680972
  error estimate for blocks of size 2^( 5) =       0.000450549292
  error estimate for blocks of size 2^( 6) =       0.000456146087
  error estimate for blocks of size 2^( 7) =       0.000460437741

      target function =                  N/A
              le_mean =     -16.907000565594
             les_mean =     286.184116619609
             stat err =       0.000451953523
             autocorr =       1.259559794440
              std dev =       0.569507409956
             le_variance =       0.324338689995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361966918
                                         uncertainty =       0.001972362742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361966918
                                         uncertainty =       0.001972362742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402702552
  error estimate for blocks of size 2^( 2) =       0.000415057550
  error estimate for blocks of size 2^( 3) =       0.000428305116
  error estimate for blocks of size 2^( 4) =       0.000440680972
  error estimate for blocks of size 2^( 5) =       0.000450549292
  error estimate for blocks of size 2^( 6) =       0.000456146087
  error estimate for blocks of size 2^( 7) =       0.000460437741

      target function =                  N/A
              le_mean =     -16.907000565594
             les_mean =     286.184116619609
             stat err =       0.000451953523
             autocorr =       1.259559794440
              std dev =       0.569507409956
             le_variance =       0.324338689995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361966918
                                         uncertainty =       0.001972362742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324361966918
                                         uncertainty =       0.001972362742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402702552
  error estimate for blocks of size 2^( 2) =       0.000415057550
  error estimate for blocks of size 2^( 3) =       0.000428305116
  error estimate for blocks of size 2^( 4) =       0.000440680972
  error estimate for blocks of size 2^( 5) =       0.000450549292
  error estimate for blocks of size 2^( 6) =       0.000456146087
  error estimate for blocks of size 2^( 7) =       0.000460437741

      target function =                  N/A
              le_mean =     -16.907000565594
             les_mean =     286.184116619609
             stat err =       0.000451953523
             autocorr =       1.259559794440
              std dev =       0.569507409956
             le_variance =       0.324338689995


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907000565594        initial  <--
     1.4901e+48     1.4901e+49             0.0000e+00       -16.907000565594
     5.9605e+48     5.9605e+49             0.0000e+00       -16.907000565594
     2.3842e+49     2.3842e+50             0.0000e+00       -16.907000565594

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7129
  </log>
  <optVariables href="H2O.s073.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8109e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.9253
    reference variance = 0.462264
====================================================
  Execution time = 2.1378e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5229e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3864e-01
  Total weights = 1.951483442e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1044e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325321480780
                                         uncertainty =       0.003601981277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325321480780
                                         uncertainty =       0.003601981277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403322051
  error estimate for blocks of size 2^( 2) =       0.000415867729
  error estimate for blocks of size 2^( 3) =       0.000429360248
  error estimate for blocks of size 2^( 4) =       0.000440967613
  error estimate for blocks of size 2^( 5) =       0.000451046718
  error estimate for blocks of size 2^( 6) =       0.000459817905
  error estimate for blocks of size 2^( 7) =       0.000464756145

      target function =                  N/A
              le_mean =     -16.905444218814
             les_mean =     286.132688638609
             stat err =       0.000454147096
             autocorr =       1.267912103092
              std dev =       0.570383514893
             le_variance =       0.325337354062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690544421881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+49, overlap shift 1.4901e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905444218804       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905444218804       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 1.09e+02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905444218804       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+49 is 1.134554e-52

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+49, overlap shift 5.9605e+50 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905444218804       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905444218804       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 1.09e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+49 is 2.836384e-53

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+50, overlap shift 2.3842e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905444218804       residual = 4.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905444218804       residual = 6.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.000000000000       residual = 1.09e+02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+50 is 7.090960e-54

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.441082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7493e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -16.9013
    reference variance = 0.179766
====================================================
  Execution time = 2.0817e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3591e-01
  Total weights = 1.9519e+06
  Execution time = 1.9006e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323671910211
                                         uncertainty =       0.002679778781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323671910211
                                         uncertainty =       0.002679778781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402223851
  error estimate for blocks of size 2^( 2) =       0.000415419513
  error estimate for blocks of size 2^( 3) =       0.000428287167
  error estimate for blocks of size 2^( 4) =       0.000440963329
  error estimate for blocks of size 2^( 5) =       0.000452584234
  error estimate for blocks of size 2^( 6) =       0.000460901784
  error estimate for blocks of size 2^( 7) =       0.000464285470

      target function =                  N/A
              le_mean =     -16.905495663782
             les_mean =     286.131692044419
             stat err =       0.000454683704
             autocorr =       1.277859599613
              std dev =       0.568830424831
             le_variance =       0.323568052214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323671910211
                                         uncertainty =       0.002679778781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323671910211
                                         uncertainty =       0.002679778781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402223851
  error estimate for blocks of size 2^( 2) =       0.000415419513
  error estimate for blocks of size 2^( 3) =       0.000428287167
  error estimate for blocks of size 2^( 4) =       0.000440963329
  error estimate for blocks of size 2^( 5) =       0.000452584234
  error estimate for blocks of size 2^( 6) =       0.000460901784
  error estimate for blocks of size 2^( 7) =       0.000464285470

      target function =                  N/A
              le_mean =     -16.905495663782
             les_mean =     286.131692044419
             stat err =       0.000454683704
             autocorr =       1.277859599613
              std dev =       0.568830424831
             le_variance =       0.323568052214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323671910211
                                         uncertainty =       0.002679778781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323671910211
                                         uncertainty =       0.002679778781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402223851
  error estimate for blocks of size 2^( 2) =       0.000415419513
  error estimate for blocks of size 2^( 3) =       0.000428287167
  error estimate for blocks of size 2^( 4) =       0.000440963329
  error estimate for blocks of size 2^( 5) =       0.000452584234
  error estimate for blocks of size 2^( 6) =       0.000460901784
  error estimate for blocks of size 2^( 7) =       0.000464285470

      target function =                  N/A
              le_mean =     -16.905495663782
             les_mean =     286.131692044419
             stat err =       0.000454683704
             autocorr =       1.277859599613
              std dev =       0.568830424831
             le_variance =       0.323568052214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323671910211
                                         uncertainty =       0.002679778781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323671910211
                                         uncertainty =       0.002679778781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402223851
  error estimate for blocks of size 2^( 2) =       0.000415419513
  error estimate for blocks of size 2^( 3) =       0.000428287167
  error estimate for blocks of size 2^( 4) =       0.000440963329
  error estimate for blocks of size 2^( 5) =       0.000452584234
  error estimate for blocks of size 2^( 6) =       0.000460901784
  error estimate for blocks of size 2^( 7) =       0.000464285470

      target function =                  N/A
              le_mean =     -16.905495663782
             les_mean =     286.131692044419
             stat err =       0.000454683704
             autocorr =       1.277859599613
              std dev =       0.568830424831
             le_variance =       0.323568052214


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905495663782        initial  <--
     1.4901e+49     1.4901e+50             1.1346e-52       -16.905495663782
     5.9605e+49     5.9605e+50             2.8364e-53       -16.905495663782
     2.3842e+50     2.3842e+51             7.0910e-54       -16.905495663782

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4352
  </log>
  <optVariables href="H2O.s074.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7934e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.8853
    reference variance = 0.216545
====================================================
  Execution time = 2.1101e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3915e-01
  Total weights = 1.951800331e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324584327770
                                         uncertainty =       0.002691473582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324584327770
                                         uncertainty =       0.002691473582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402855838
  error estimate for blocks of size 2^( 2) =       0.000415323927
  error estimate for blocks of size 2^( 3) =       0.000427998611
  error estimate for blocks of size 2^( 4) =       0.000440143159
  error estimate for blocks of size 2^( 5) =       0.000450511362
  error estimate for blocks of size 2^( 6) =       0.000457358226
  error estimate for blocks of size 2^( 7) =       0.000459488515

      target function =                  N/A
              le_mean =     -16.905644008910
             les_mean =     286.139947026017
             stat err =       0.000451875316
             autocorr =       1.258165907872
              std dev =       0.569724189495
             le_variance =       0.324585652096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690564400891e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+50, overlap shift 1.4901e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905644008917       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905644008917       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+50, overlap shift 5.9605e+51 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905644008917       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905644008917       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+50 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+51, overlap shift 2.3842e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905644008917       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905644008917       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.442290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7201e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -16.9365
    reference variance = 0.217536
====================================================
  Execution time = 2.1046e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3535e-01
  Total weights = 1.9515e+06
  Execution time = 1.8783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321632651815
                                         uncertainty =       0.002170043361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321632651815
                                         uncertainty =       0.002170043361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401029992
  error estimate for blocks of size 2^( 2) =       0.000413786575
  error estimate for blocks of size 2^( 3) =       0.000426955725
  error estimate for blocks of size 2^( 4) =       0.000439084250
  error estimate for blocks of size 2^( 5) =       0.000449251547
  error estimate for blocks of size 2^( 6) =       0.000456647465
  error estimate for blocks of size 2^( 7) =       0.000461068434

      target function =                  N/A
              le_mean =     -16.905901193715
             les_mean =     286.144841867993
             stat err =       0.000451512924
             autocorr =       1.267612939445
              std dev =       0.567142054121
             le_variance =       0.321650109553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321632651815
                                         uncertainty =       0.002170043361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321632651815
                                         uncertainty =       0.002170043361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401029992
  error estimate for blocks of size 2^( 2) =       0.000413786575
  error estimate for blocks of size 2^( 3) =       0.000426955725
  error estimate for blocks of size 2^( 4) =       0.000439084250
  error estimate for blocks of size 2^( 5) =       0.000449251547
  error estimate for blocks of size 2^( 6) =       0.000456647465
  error estimate for blocks of size 2^( 7) =       0.000461068434

      target function =                  N/A
              le_mean =     -16.905901193715
             les_mean =     286.144841867993
             stat err =       0.000451512924
             autocorr =       1.267612939445
              std dev =       0.567142054121
             le_variance =       0.321650109553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321632651815
                                         uncertainty =       0.002170043361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321632651815
                                         uncertainty =       0.002170043361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401029992
  error estimate for blocks of size 2^( 2) =       0.000413786575
  error estimate for blocks of size 2^( 3) =       0.000426955725
  error estimate for blocks of size 2^( 4) =       0.000439084250
  error estimate for blocks of size 2^( 5) =       0.000449251547
  error estimate for blocks of size 2^( 6) =       0.000456647465
  error estimate for blocks of size 2^( 7) =       0.000461068434

      target function =                  N/A
              le_mean =     -16.905901193715
             les_mean =     286.144841867993
             stat err =       0.000451512924
             autocorr =       1.267612939445
              std dev =       0.567142054121
             le_variance =       0.321650109553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321632651815
                                         uncertainty =       0.002170043361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321632651815
                                         uncertainty =       0.002170043361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401029992
  error estimate for blocks of size 2^( 2) =       0.000413786575
  error estimate for blocks of size 2^( 3) =       0.000426955725
  error estimate for blocks of size 2^( 4) =       0.000439084250
  error estimate for blocks of size 2^( 5) =       0.000449251547
  error estimate for blocks of size 2^( 6) =       0.000456647465
  error estimate for blocks of size 2^( 7) =       0.000461068434

      target function =                  N/A
              le_mean =     -16.905901193715
             les_mean =     286.144841867993
             stat err =       0.000451512924
             autocorr =       1.267612939445
              std dev =       0.567142054121
             le_variance =       0.321650109553


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905901193715        initial  <--
     1.4901e+50     1.4901e+51             0.0000e+00       -16.905901193715
     5.9605e+50     5.9605e+51             0.0000e+00       -16.905901193715
     2.3842e+51     2.3842e+52             0.0000e+00       -16.905901193715

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5474
  </log>
  <optVariables href="H2O.s075.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7754e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.8522
    reference variance = 0.185656
====================================================
  Execution time = 2.1064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3336e-01
  Total weights = 1.951511882e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0837e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320150605536
                                         uncertainty =       0.002331568235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320150605536
                                         uncertainty =       0.002331568235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400102959
  error estimate for blocks of size 2^( 2) =       0.000413206555
  error estimate for blocks of size 2^( 3) =       0.000426879193
  error estimate for blocks of size 2^( 4) =       0.000438955052
  error estimate for blocks of size 2^( 5) =       0.000449577019
  error estimate for blocks of size 2^( 6) =       0.000456290325
  error estimate for blocks of size 2^( 7) =       0.000457790502

      target function =                  N/A
              le_mean =     -16.905700322211
             les_mean =     286.136066713555
             stat err =       0.000450653225
             autocorr =       1.268648878769
              std dev =       0.565831030544
             le_variance =       0.320164755126


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570032221e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+51, overlap shift 1.4901e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905700322191       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905700322191       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+51, overlap shift 5.9605e+52 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905700322191       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905700322191       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+51 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+52, overlap shift 2.3842e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905700322191       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905700322191       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.443462 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7157e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -16.9191
    reference variance = 0.273744
====================================================
  Execution time = 2.1105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3079e-01
  Total weights = 1.9512e+06
  Execution time = 1.8791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320091732185
                                         uncertainty =       0.001880869479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320091732185
                                         uncertainty =       0.001880869479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400065797
  error estimate for blocks of size 2^( 2) =       0.000412939108
  error estimate for blocks of size 2^( 3) =       0.000426165602
  error estimate for blocks of size 2^( 4) =       0.000438484043
  error estimate for blocks of size 2^( 5) =       0.000449218305
  error estimate for blocks of size 2^( 6) =       0.000458126473
  error estimate for blocks of size 2^( 7) =       0.000461488821

      target function =                  N/A
              le_mean =     -16.906130715118
             les_mean =     286.148040850838
             stat err =       0.000451829410
             autocorr =       1.275516691534
              std dev =       0.565778475788
             le_variance =       0.320105283665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320091732185
                                         uncertainty =       0.001880869479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320091732185
                                         uncertainty =       0.001880869479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400065797
  error estimate for blocks of size 2^( 2) =       0.000412939108
  error estimate for blocks of size 2^( 3) =       0.000426165602
  error estimate for blocks of size 2^( 4) =       0.000438484043
  error estimate for blocks of size 2^( 5) =       0.000449218305
  error estimate for blocks of size 2^( 6) =       0.000458126473
  error estimate for blocks of size 2^( 7) =       0.000461488821

      target function =                  N/A
              le_mean =     -16.906130715118
             les_mean =     286.148040850838
             stat err =       0.000451829410
             autocorr =       1.275516691534
              std dev =       0.565778475788
             le_variance =       0.320105283665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320091732185
                                         uncertainty =       0.001880869479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320091732185
                                         uncertainty =       0.001880869479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400065797
  error estimate for blocks of size 2^( 2) =       0.000412939108
  error estimate for blocks of size 2^( 3) =       0.000426165602
  error estimate for blocks of size 2^( 4) =       0.000438484043
  error estimate for blocks of size 2^( 5) =       0.000449218305
  error estimate for blocks of size 2^( 6) =       0.000458126473
  error estimate for blocks of size 2^( 7) =       0.000461488821

      target function =                  N/A
              le_mean =     -16.906130715118
             les_mean =     286.148040850838
             stat err =       0.000451829410
             autocorr =       1.275516691534
              std dev =       0.565778475788
             le_variance =       0.320105283665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320091732185
                                         uncertainty =       0.001880869479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320091732185
                                         uncertainty =       0.001880869479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400065797
  error estimate for blocks of size 2^( 2) =       0.000412939108
  error estimate for blocks of size 2^( 3) =       0.000426165602
  error estimate for blocks of size 2^( 4) =       0.000438484043
  error estimate for blocks of size 2^( 5) =       0.000449218305
  error estimate for blocks of size 2^( 6) =       0.000458126473
  error estimate for blocks of size 2^( 7) =       0.000461488821

      target function =                  N/A
              le_mean =     -16.906130715118
             les_mean =     286.148040850838
             stat err =       0.000451829410
             autocorr =       1.275516691534
              std dev =       0.565778475788
             le_variance =       0.320105283665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906130715118        initial  <--
     1.4901e+51     1.4901e+52             0.0000e+00       -16.906130715118
     5.9605e+51     5.9605e+52             0.0000e+00       -16.906130715118
     2.3842e+52     2.3842e+53             0.0000e+00       -16.906130715118

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6119
  </log>
  <optVariables href="H2O.s076.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7775e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.9294
    reference variance = 0.452845
====================================================
  Execution time = 2.1074e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3637e-01
  Total weights = 1.952099214e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.5682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323085341863
                                         uncertainty =       0.002350082012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323085341863
                                         uncertainty =       0.002350082012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401911757
  error estimate for blocks of size 2^( 2) =       0.000415195802
  error estimate for blocks of size 2^( 3) =       0.000429043000
  error estimate for blocks of size 2^( 4) =       0.000441864355
  error estimate for blocks of size 2^( 5) =       0.000453278999
  error estimate for blocks of size 2^( 6) =       0.000462017322
  error estimate for blocks of size 2^( 7) =       0.000469369368

      target function =                  N/A
              le_mean =     -16.905673719488
             les_mean =     286.138170452379
             stat err =       0.000456632511
             autocorr =       1.290839473848
              std dev =       0.568389057103
             le_variance =       0.323066120235


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690567371949e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+52, overlap shift 1.4901e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905673719481       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905673719481       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+52, overlap shift 5.9605e+53 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905673719481       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905673719481       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+52 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+53, overlap shift 2.3842e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905673719481       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905673719481       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.444663 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7652e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -16.9116
    reference variance = 0.327622
====================================================
  Execution time = 2.0909e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3300e-01
  Total weights = 1.9516e+06
  Execution time = 1.8718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321243700927
                                         uncertainty =       0.001870412688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321243700927
                                         uncertainty =       0.001870412688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400944633
  error estimate for blocks of size 2^( 2) =       0.000414271738
  error estimate for blocks of size 2^( 3) =       0.000428682360
  error estimate for blocks of size 2^( 4) =       0.000442371902
  error estimate for blocks of size 2^( 5) =       0.000454293592
  error estimate for blocks of size 2^( 6) =       0.000464557306
  error estimate for blocks of size 2^( 7) =       0.000470928487

      target function =                  N/A
              le_mean =     -16.905664969205
             les_mean =     286.134510384807
             stat err =       0.000458037822
             autocorr =       1.305070196396
              std dev =       0.567021338061
             le_variance =       0.321513197816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321243700927
                                         uncertainty =       0.001870412688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321243700927
                                         uncertainty =       0.001870412688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400944633
  error estimate for blocks of size 2^( 2) =       0.000414271738
  error estimate for blocks of size 2^( 3) =       0.000428682360
  error estimate for blocks of size 2^( 4) =       0.000442371902
  error estimate for blocks of size 2^( 5) =       0.000454293592
  error estimate for blocks of size 2^( 6) =       0.000464557306
  error estimate for blocks of size 2^( 7) =       0.000470928487

      target function =                  N/A
              le_mean =     -16.905664969205
             les_mean =     286.134510384807
             stat err =       0.000458037822
             autocorr =       1.305070196396
              std dev =       0.567021338061
             le_variance =       0.321513197816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321243700927
                                         uncertainty =       0.001870412688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321243700927
                                         uncertainty =       0.001870412688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400944633
  error estimate for blocks of size 2^( 2) =       0.000414271738
  error estimate for blocks of size 2^( 3) =       0.000428682360
  error estimate for blocks of size 2^( 4) =       0.000442371902
  error estimate for blocks of size 2^( 5) =       0.000454293592
  error estimate for blocks of size 2^( 6) =       0.000464557306
  error estimate for blocks of size 2^( 7) =       0.000470928487

      target function =                  N/A
              le_mean =     -16.905664969205
             les_mean =     286.134510384807
             stat err =       0.000458037822
             autocorr =       1.305070196396
              std dev =       0.567021338061
             le_variance =       0.321513197816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321243700927
                                         uncertainty =       0.001870412688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321243700927
                                         uncertainty =       0.001870412688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400944633
  error estimate for blocks of size 2^( 2) =       0.000414271738
  error estimate for blocks of size 2^( 3) =       0.000428682360
  error estimate for blocks of size 2^( 4) =       0.000442371902
  error estimate for blocks of size 2^( 5) =       0.000454293592
  error estimate for blocks of size 2^( 6) =       0.000464557306
  error estimate for blocks of size 2^( 7) =       0.000470928487

      target function =                  N/A
              le_mean =     -16.905664969205
             les_mean =     286.134510384807
             stat err =       0.000458037822
             autocorr =       1.305070196396
              std dev =       0.567021338061
             le_variance =       0.321513197816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905664969205        initial  <--
     1.4901e+52     1.4901e+53             0.0000e+00       -16.905664969205
     5.9605e+52     5.9605e+53             0.0000e+00       -16.905664969205
     2.3842e+53     2.3842e+54             0.0000e+00       -16.905664969205

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3757
  </log>
  <optVariables href="H2O.s077.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8034e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.927
    reference variance = 0.378173
====================================================
  Execution time = 2.1052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3918e-01
  Total weights = 1.951472985e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1967e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325761756699
                                         uncertainty =       0.002428543710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325761756699
                                         uncertainty =       0.002428543710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403579811
  error estimate for blocks of size 2^( 2) =       0.000416319326
  error estimate for blocks of size 2^( 3) =       0.000429466287
  error estimate for blocks of size 2^( 4) =       0.000442747674
  error estimate for blocks of size 2^( 5) =       0.000452952591
  error estimate for blocks of size 2^( 6) =       0.000460521464
  error estimate for blocks of size 2^( 7) =       0.000467076325

      target function =                  N/A
              le_mean =     -16.905906231293
             les_mean =     286.148841915232
             stat err =       0.000455824513
             autocorr =       1.275664555080
              std dev =       0.570748042222
             le_variance =       0.325753327700


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690590623129e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+53, overlap shift 1.4901e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906231345       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906231345       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+53, overlap shift 5.9605e+54 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906231345       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906231345       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+53 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+54, overlap shift 2.3842e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905906231345       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905906231345       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.446099 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7259e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -16.9106
    reference variance = 0.246591
====================================================
  Execution time = 2.0789e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3263e-01
  Total weights = 1.9518e+06
  Execution time = 1.9119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321199013491
                                         uncertainty =       0.002028372406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321199013491
                                         uncertainty =       0.002028372406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400750662
  error estimate for blocks of size 2^( 2) =       0.000413380336
  error estimate for blocks of size 2^( 3) =       0.000425998646
  error estimate for blocks of size 2^( 4) =       0.000437682684
  error estimate for blocks of size 2^( 5) =       0.000447840006
  error estimate for blocks of size 2^( 6) =       0.000453691097
  error estimate for blocks of size 2^( 7) =       0.000458459092

      target function =                  N/A
              le_mean =     -16.907055692162
             les_mean =     286.181165100949
             stat err =       0.000449418220
             autocorr =       1.257629896764
              std dev =       0.566747021583
             le_variance =       0.321202186473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321199013491
                                         uncertainty =       0.002028372406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321199013491
                                         uncertainty =       0.002028372406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400750662
  error estimate for blocks of size 2^( 2) =       0.000413380336
  error estimate for blocks of size 2^( 3) =       0.000425998646
  error estimate for blocks of size 2^( 4) =       0.000437682684
  error estimate for blocks of size 2^( 5) =       0.000447840006
  error estimate for blocks of size 2^( 6) =       0.000453691097
  error estimate for blocks of size 2^( 7) =       0.000458459092

      target function =                  N/A
              le_mean =     -16.907055692162
             les_mean =     286.181165100949
             stat err =       0.000449418220
             autocorr =       1.257629896764
              std dev =       0.566747021583
             le_variance =       0.321202186473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321199013491
                                         uncertainty =       0.002028372406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321199013491
                                         uncertainty =       0.002028372406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400750662
  error estimate for blocks of size 2^( 2) =       0.000413380336
  error estimate for blocks of size 2^( 3) =       0.000425998646
  error estimate for blocks of size 2^( 4) =       0.000437682684
  error estimate for blocks of size 2^( 5) =       0.000447840006
  error estimate for blocks of size 2^( 6) =       0.000453691097
  error estimate for blocks of size 2^( 7) =       0.000458459092

      target function =                  N/A
              le_mean =     -16.907055692162
             les_mean =     286.181165100949
             stat err =       0.000449418220
             autocorr =       1.257629896764
              std dev =       0.566747021583
             le_variance =       0.321202186473

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321199013491
                                         uncertainty =       0.002028372406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321199013491
                                         uncertainty =       0.002028372406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400750662
  error estimate for blocks of size 2^( 2) =       0.000413380336
  error estimate for blocks of size 2^( 3) =       0.000425998646
  error estimate for blocks of size 2^( 4) =       0.000437682684
  error estimate for blocks of size 2^( 5) =       0.000447840006
  error estimate for blocks of size 2^( 6) =       0.000453691097
  error estimate for blocks of size 2^( 7) =       0.000458459092

      target function =                  N/A
              le_mean =     -16.907055692162
             les_mean =     286.181165100949
             stat err =       0.000449418220
             autocorr =       1.257629896764
              std dev =       0.566747021583
             le_variance =       0.321202186473


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907055692162        initial  <--
     1.4901e+53     1.4901e+54             0.0000e+00       -16.907055692162
     5.9605e+53     5.9605e+54             0.0000e+00       -16.907055692162
     2.3842e+54     2.3842e+55             0.0000e+00       -16.907055692162

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3738
  </log>
  <optVariables href="H2O.s078.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7640e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.9367
    reference variance = 0.335516
====================================================
  Execution time = 2.1018e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5258e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3796e-01
  Total weights = 1.951511148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423386595
                                         uncertainty =       0.002930498193

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324423386595
                                         uncertainty =       0.002930498193

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402715687
  error estimate for blocks of size 2^( 2) =       0.000416151699
  error estimate for blocks of size 2^( 3) =       0.000429751473
  error estimate for blocks of size 2^( 4) =       0.000442185651
  error estimate for blocks of size 2^( 5) =       0.000452946941
  error estimate for blocks of size 2^( 6) =       0.000462237153
  error estimate for blocks of size 2^( 7) =       0.000464128706

      target function =                  N/A
              le_mean =     -16.905450624941
             les_mean =     286.132221248490
             stat err =       0.000455374612
             autocorr =       1.278617177050
              std dev =       0.569525986850
             le_variance =       0.324359849698


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690545062494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+54, overlap shift 1.4901e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905450624920       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905450624920       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+54, overlap shift 5.9605e+55 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905450624920       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905450624920       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+54 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+55, overlap shift 2.3842e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905450624920       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905450624920       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.447287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7163e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -16.9008
    reference variance = 0.169493
====================================================
  Execution time = 2.0990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3592e-01
  Total weights = 1.9515e+06
  Execution time = 1.8751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324656897870
                                         uncertainty =       0.002835257421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324656897870
                                         uncertainty =       0.002835257421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402999806
  error estimate for blocks of size 2^( 2) =       0.000416080071
  error estimate for blocks of size 2^( 3) =       0.000429400209
  error estimate for blocks of size 2^( 4) =       0.000442115146
  error estimate for blocks of size 2^( 5) =       0.000453922547
  error estimate for blocks of size 2^( 6) =       0.000461385879
  error estimate for blocks of size 2^( 7) =       0.000464867839

      target function =                  N/A
              le_mean =     -16.905784370937
             les_mean =     286.141466260814
             stat err =       0.000455572853
             autocorr =       1.277926861201
              std dev =       0.569927791815
             le_variance =       0.324817687884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324656897870
                                         uncertainty =       0.002835257421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324656897870
                                         uncertainty =       0.002835257421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402999806
  error estimate for blocks of size 2^( 2) =       0.000416080071
  error estimate for blocks of size 2^( 3) =       0.000429400209
  error estimate for blocks of size 2^( 4) =       0.000442115146
  error estimate for blocks of size 2^( 5) =       0.000453922547
  error estimate for blocks of size 2^( 6) =       0.000461385879
  error estimate for blocks of size 2^( 7) =       0.000464867839

      target function =                  N/A
              le_mean =     -16.905784370937
             les_mean =     286.141466260814
             stat err =       0.000455572853
             autocorr =       1.277926861201
              std dev =       0.569927791815
             le_variance =       0.324817687884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324656897870
                                         uncertainty =       0.002835257421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324656897870
                                         uncertainty =       0.002835257421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402999806
  error estimate for blocks of size 2^( 2) =       0.000416080071
  error estimate for blocks of size 2^( 3) =       0.000429400209
  error estimate for blocks of size 2^( 4) =       0.000442115146
  error estimate for blocks of size 2^( 5) =       0.000453922547
  error estimate for blocks of size 2^( 6) =       0.000461385879
  error estimate for blocks of size 2^( 7) =       0.000464867839

      target function =                  N/A
              le_mean =     -16.905784370937
             les_mean =     286.141466260814
             stat err =       0.000455572853
             autocorr =       1.277926861201
              std dev =       0.569927791815
             le_variance =       0.324817687884

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324656897870
                                         uncertainty =       0.002835257421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324656897870
                                         uncertainty =       0.002835257421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402999806
  error estimate for blocks of size 2^( 2) =       0.000416080071
  error estimate for blocks of size 2^( 3) =       0.000429400209
  error estimate for blocks of size 2^( 4) =       0.000442115146
  error estimate for blocks of size 2^( 5) =       0.000453922547
  error estimate for blocks of size 2^( 6) =       0.000461385879
  error estimate for blocks of size 2^( 7) =       0.000464867839

      target function =                  N/A
              le_mean =     -16.905784370937
             les_mean =     286.141466260814
             stat err =       0.000455572853
             autocorr =       1.277926861201
              std dev =       0.569927791815
             le_variance =       0.324817687884


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905784370937        initial  <--
     1.4901e+54     1.4901e+55             0.0000e+00       -16.905784370937
     5.9605e+54     5.9605e+55             0.0000e+00       -16.905784370937
     2.3842e+55     2.3842e+56             0.0000e+00       -16.905784370937

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4787
  </log>
  <optVariables href="H2O.s079.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7648e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.0021
    reference variance = 0.244162
====================================================
  Execution time = 2.1138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.5326e-01
  Total weights = 1.951461619e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326980241189
                                         uncertainty =       0.003555112125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326980241189
                                         uncertainty =       0.003555112125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404298545
  error estimate for blocks of size 2^( 2) =       0.000417519321
  error estimate for blocks of size 2^( 3) =       0.000430583010
  error estimate for blocks of size 2^( 4) =       0.000442991445
  error estimate for blocks of size 2^( 5) =       0.000454426152
  error estimate for blocks of size 2^( 6) =       0.000463662917
  error estimate for blocks of size 2^( 7) =       0.000471955618

      target function =                  N/A
              le_mean =     -16.905295595168
             les_mean =     286.142283056432
             stat err =       0.000458259033
             autocorr =       1.284747294057
              std dev =       0.571764485757
             le_variance =       0.326914627173


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690529559517e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+55, overlap shift 1.4901e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905295595135       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905295595135       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+55, overlap shift 5.9605e+56 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905295595135       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905295595135       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+55 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+56, overlap shift 2.3842e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905295595135       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905295595135       residual = 2.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+56 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.448458 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7306e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -16.8672
    reference variance = 0.244971
====================================================
  Execution time = 2.1198e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3294e-01
  Total weights = 1.9515e+06
  Execution time = 1.8734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321078968057
                                         uncertainty =       0.002131962326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321078968057
                                         uncertainty =       0.002131962326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400606412
  error estimate for blocks of size 2^( 2) =       0.000413477004
  error estimate for blocks of size 2^( 3) =       0.000426707990
  error estimate for blocks of size 2^( 4) =       0.000439161027
  error estimate for blocks of size 2^( 5) =       0.000448738382
  error estimate for blocks of size 2^( 6) =       0.000456549708
  error estimate for blocks of size 2^( 7) =       0.000462685121

      target function =                  N/A
              le_mean =     -16.906063217976
             les_mean =     286.147914367342
             stat err =       0.000451783560
             autocorr =       1.271818250719
              std dev =       0.566543021389
             le_variance =       0.320970995084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321078968057
                                         uncertainty =       0.002131962326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321078968057
                                         uncertainty =       0.002131962326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400606412
  error estimate for blocks of size 2^( 2) =       0.000413477004
  error estimate for blocks of size 2^( 3) =       0.000426707990
  error estimate for blocks of size 2^( 4) =       0.000439161027
  error estimate for blocks of size 2^( 5) =       0.000448738382
  error estimate for blocks of size 2^( 6) =       0.000456549708
  error estimate for blocks of size 2^( 7) =       0.000462685121

      target function =                  N/A
              le_mean =     -16.906063217976
             les_mean =     286.147914367342
             stat err =       0.000451783560
             autocorr =       1.271818250719
              std dev =       0.566543021389
             le_variance =       0.320970995084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321078968057
                                         uncertainty =       0.002131962326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321078968057
                                         uncertainty =       0.002131962326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400606412
  error estimate for blocks of size 2^( 2) =       0.000413477004
  error estimate for blocks of size 2^( 3) =       0.000426707990
  error estimate for blocks of size 2^( 4) =       0.000439161027
  error estimate for blocks of size 2^( 5) =       0.000448738382
  error estimate for blocks of size 2^( 6) =       0.000456549708
  error estimate for blocks of size 2^( 7) =       0.000462685121

      target function =                  N/A
              le_mean =     -16.906063217976
             les_mean =     286.147914367342
             stat err =       0.000451783560
             autocorr =       1.271818250719
              std dev =       0.566543021389
             le_variance =       0.320970995084

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321078968057
                                         uncertainty =       0.002131962326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321078968057
                                         uncertainty =       0.002131962326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400606412
  error estimate for blocks of size 2^( 2) =       0.000413477004
  error estimate for blocks of size 2^( 3) =       0.000426707990
  error estimate for blocks of size 2^( 4) =       0.000439161027
  error estimate for blocks of size 2^( 5) =       0.000448738382
  error estimate for blocks of size 2^( 6) =       0.000456549708
  error estimate for blocks of size 2^( 7) =       0.000462685121

      target function =                  N/A
              le_mean =     -16.906063217976
             les_mean =     286.147914367342
             stat err =       0.000451783560
             autocorr =       1.271818250719
              std dev =       0.566543021389
             le_variance =       0.320970995084


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906063217976        initial  <--
     1.4901e+55     1.4901e+56             0.0000e+00       -16.906063217976
     5.9605e+55     5.9605e+56             0.0000e+00       -16.906063217976
     2.3842e+56     2.3842e+57             0.0000e+00       -16.906063217976

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6764
  </log>
  <optVariables href="H2O.s080.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7988e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.8695
    reference variance = 0.18354
====================================================
  Execution time = 2.1196e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5226e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3757e-01
  Total weights = 1.951525358e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0796e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326077128935
                                         uncertainty =       0.003692983901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326077128935
                                         uncertainty =       0.003692983901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403736989
  error estimate for blocks of size 2^( 2) =       0.000416910880
  error estimate for blocks of size 2^( 3) =       0.000429547785
  error estimate for blocks of size 2^( 4) =       0.000441649856
  error estimate for blocks of size 2^( 5) =       0.000453148522
  error estimate for blocks of size 2^( 6) =       0.000462344001
  error estimate for blocks of size 2^( 7) =       0.000469868462

      target function =                  N/A
              le_mean =     -16.906063779918
             les_mean =     286.152566253412
             stat err =       0.000456752710
             autocorr =       1.279868018308
              std dev =       0.570970325219
             le_variance =       0.326007112281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690606377992e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+56, overlap shift 1.4901e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906063779928       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906063779928       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+56 is 3.079467e-60

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+56, overlap shift 5.9605e+57 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906063779928       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906063779928       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+56 is 7.698668e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+57, overlap shift 2.3842e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906063779928       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906063779928       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+57 is 1.924667e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.449601 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7286e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -16.9026
    reference variance = 0.233699
====================================================
  Execution time = 2.0873e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3855e-01
  Total weights = 1.9515e+06
  Execution time = 1.8730e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324517434543
                                         uncertainty =       0.002402139214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324517434543
                                         uncertainty =       0.002402139214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402852204
  error estimate for blocks of size 2^( 2) =       0.000415422965
  error estimate for blocks of size 2^( 3) =       0.000429578594
  error estimate for blocks of size 2^( 4) =       0.000443208850
  error estimate for blocks of size 2^( 5) =       0.000454833750
  error estimate for blocks of size 2^( 6) =       0.000463705497
  error estimate for blocks of size 2^( 7) =       0.000473193668

      target function =                  N/A
              le_mean =     -16.905634070484
             les_mean =     286.139010497561
             stat err =       0.000458735441
             autocorr =       1.296680860006
              std dev =       0.569719050945
             le_variance =       0.324579797009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324517434543
                                         uncertainty =       0.002402139214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324517434543
                                         uncertainty =       0.002402139214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402852204
  error estimate for blocks of size 2^( 2) =       0.000415422965
  error estimate for blocks of size 2^( 3) =       0.000429578594
  error estimate for blocks of size 2^( 4) =       0.000443208850
  error estimate for blocks of size 2^( 5) =       0.000454833750
  error estimate for blocks of size 2^( 6) =       0.000463705497
  error estimate for blocks of size 2^( 7) =       0.000473193668

      target function =                  N/A
              le_mean =     -16.905634070484
             les_mean =     286.139010497561
             stat err =       0.000458735441
             autocorr =       1.296680860006
              std dev =       0.569719050945
             le_variance =       0.324579797009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324517434543
                                         uncertainty =       0.002402139214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324517434543
                                         uncertainty =       0.002402139214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402852204
  error estimate for blocks of size 2^( 2) =       0.000415422965
  error estimate for blocks of size 2^( 3) =       0.000429578594
  error estimate for blocks of size 2^( 4) =       0.000443208850
  error estimate for blocks of size 2^( 5) =       0.000454833750
  error estimate for blocks of size 2^( 6) =       0.000463705497
  error estimate for blocks of size 2^( 7) =       0.000473193668

      target function =                  N/A
              le_mean =     -16.905634070484
             les_mean =     286.139010497561
             stat err =       0.000458735441
             autocorr =       1.296680860006
              std dev =       0.569719050945
             le_variance =       0.324579797009

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324517434543
                                         uncertainty =       0.002402139214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324517434543
                                         uncertainty =       0.002402139214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402852204
  error estimate for blocks of size 2^( 2) =       0.000415422965
  error estimate for blocks of size 2^( 3) =       0.000429578594
  error estimate for blocks of size 2^( 4) =       0.000443208850
  error estimate for blocks of size 2^( 5) =       0.000454833750
  error estimate for blocks of size 2^( 6) =       0.000463705497
  error estimate for blocks of size 2^( 7) =       0.000473193668

      target function =                  N/A
              le_mean =     -16.905634070484
             les_mean =     286.139010497561
             stat err =       0.000458735441
             autocorr =       1.296680860006
              std dev =       0.569719050945
             le_variance =       0.324579797009


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905634070484        initial  <--
     1.4901e+56     1.4901e+57             3.0795e-60       -16.905634070484
     5.9605e+56     5.9605e+57             7.6987e-61       -16.905634070484
     2.3842e+57     2.3842e+58             1.9247e-61       -16.905634070484

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3589
  </log>
  <optVariables href="H2O.s081.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7651e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.9737
    reference variance = 0.616865
====================================================
  Execution time = 2.1395e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5231e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4635e-01
  Total weights = 1.951551510e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325463328925
                                         uncertainty =       0.002483667722

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325463328925
                                         uncertainty =       0.002483667722

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403413055
  error estimate for blocks of size 2^( 2) =       0.000415841874
  error estimate for blocks of size 2^( 3) =       0.000429001243
  error estimate for blocks of size 2^( 4) =       0.000441065452
  error estimate for blocks of size 2^( 5) =       0.000450989868
  error estimate for blocks of size 2^( 6) =       0.000459733872
  error estimate for blocks of size 2^( 7) =       0.000464638955

      target function =                  N/A
              le_mean =     -16.906423259235
             les_mean =     286.173502339673
             stat err =       0.000454107037
             autocorr =       1.267116559261
              std dev =       0.570512213501
             le_variance =       0.325484185753


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642325924e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+57, overlap shift 1.4901e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906423259205       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906423259205       residual = 6.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+57 is 2.047520e-61

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+57, overlap shift 5.9605e+58 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906423259205       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906423259205       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+57 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+58, overlap shift 2.3842e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906423259205       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906423259205       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.450782 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7600e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -16.8318
    reference variance = 0.346561
====================================================
  Execution time = 2.2717e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5451e-01
  Total weights = 1.9515e+06
  Execution time = 1.8753e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327142858968
                                         uncertainty =       0.003401689393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327142858968
                                         uncertainty =       0.003401689393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404490649
  error estimate for blocks of size 2^( 2) =       0.000417506452
  error estimate for blocks of size 2^( 3) =       0.000430178659
  error estimate for blocks of size 2^( 4) =       0.000441823777
  error estimate for blocks of size 2^( 5) =       0.000450306238
  error estimate for blocks of size 2^( 6) =       0.000458583637
  error estimate for blocks of size 2^( 7) =       0.000462475882

      target function =                  N/A
              le_mean =     -16.906170832131
             les_mean =     286.173122850353
             stat err =       0.000453297384
             autocorr =       1.255883781004
              std dev =       0.572036162237
             le_variance =       0.327225370907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327142858968
                                         uncertainty =       0.003401689393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327142858968
                                         uncertainty =       0.003401689393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404490649
  error estimate for blocks of size 2^( 2) =       0.000417506452
  error estimate for blocks of size 2^( 3) =       0.000430178659
  error estimate for blocks of size 2^( 4) =       0.000441823777
  error estimate for blocks of size 2^( 5) =       0.000450306238
  error estimate for blocks of size 2^( 6) =       0.000458583637
  error estimate for blocks of size 2^( 7) =       0.000462475882

      target function =                  N/A
              le_mean =     -16.906170832131
             les_mean =     286.173122850353
             stat err =       0.000453297384
             autocorr =       1.255883781004
              std dev =       0.572036162237
             le_variance =       0.327225370907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327142858968
                                         uncertainty =       0.003401689393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327142858968
                                         uncertainty =       0.003401689393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404490649
  error estimate for blocks of size 2^( 2) =       0.000417506452
  error estimate for blocks of size 2^( 3) =       0.000430178659
  error estimate for blocks of size 2^( 4) =       0.000441823777
  error estimate for blocks of size 2^( 5) =       0.000450306238
  error estimate for blocks of size 2^( 6) =       0.000458583637
  error estimate for blocks of size 2^( 7) =       0.000462475882

      target function =                  N/A
              le_mean =     -16.906170832131
             les_mean =     286.173122850353
             stat err =       0.000453297384
             autocorr =       1.255883781004
              std dev =       0.572036162237
             le_variance =       0.327225370907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327142858968
                                         uncertainty =       0.003401689393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327142858968
                                         uncertainty =       0.003401689393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404490649
  error estimate for blocks of size 2^( 2) =       0.000417506452
  error estimate for blocks of size 2^( 3) =       0.000430178659
  error estimate for blocks of size 2^( 4) =       0.000441823777
  error estimate for blocks of size 2^( 5) =       0.000450306238
  error estimate for blocks of size 2^( 6) =       0.000458583637
  error estimate for blocks of size 2^( 7) =       0.000462475882

      target function =                  N/A
              le_mean =     -16.906170832131
             les_mean =     286.173122850353
             stat err =       0.000453297384
             autocorr =       1.255883781004
              std dev =       0.572036162237
             le_variance =       0.327225370907


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906170832131        initial  <--
     1.4901e+57     1.4901e+58             2.0475e-61       -16.906170832131
     5.9605e+57     5.9605e+58             0.0000e+00       -16.906170832131
     2.3842e+58     2.3842e+59             0.0000e+00       -16.906170832131

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2084
  </log>
  <optVariables href="H2O.s082.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9815e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.8657
    reference variance = 0.450888
====================================================
  Execution time = 2.1216e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5216e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3171e-01
  Total weights = 1.951886883e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1005e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320268121677
                                         uncertainty =       0.001953907279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320268121677
                                         uncertainty =       0.001953907279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400118129
  error estimate for blocks of size 2^( 2) =       0.000412831685
  error estimate for blocks of size 2^( 3) =       0.000426659639
  error estimate for blocks of size 2^( 4) =       0.000439686810
  error estimate for blocks of size 2^( 5) =       0.000451014555
  error estimate for blocks of size 2^( 6) =       0.000458841733
  error estimate for blocks of size 2^( 7) =       0.000462649005

      target function =                  N/A
              le_mean =     -16.904918086538
             les_mean =     286.107960748361
             stat err =       0.000453048026
             autocorr =       1.282070852130
              std dev =       0.565852484055
             le_variance =       0.320189033711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690491808654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+58, overlap shift 1.4901e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904918086511       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904918086511       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+58, overlap shift 5.9605e+59 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904918086511       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904918086511       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+58 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+59, overlap shift 2.3842e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.904918086511       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.904918086511       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+59 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.452002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7329e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -16.8299
    reference variance = 0.198886
====================================================
  Execution time = 2.0976e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4184e-01
  Total weights = 1.9518e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326890871848
                                         uncertainty =       0.002632324097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326890871848
                                         uncertainty =       0.002632324097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404265011
  error estimate for blocks of size 2^( 2) =       0.000416767126
  error estimate for blocks of size 2^( 3) =       0.000430283560
  error estimate for blocks of size 2^( 4) =       0.000442682439
  error estimate for blocks of size 2^( 5) =       0.000453113473
  error estimate for blocks of size 2^( 6) =       0.000461164664
  error estimate for blocks of size 2^( 7) =       0.000466680100

      target function =                  N/A
              le_mean =     -16.906511489085
             les_mean =     286.171968372387
             stat err =       0.000455910169
             autocorr =       1.271821748273
              std dev =       0.571717062035
             le_variance =       0.326860399022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326890871848
                                         uncertainty =       0.002632324097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326890871848
                                         uncertainty =       0.002632324097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404265011
  error estimate for blocks of size 2^( 2) =       0.000416767126
  error estimate for blocks of size 2^( 3) =       0.000430283560
  error estimate for blocks of size 2^( 4) =       0.000442682439
  error estimate for blocks of size 2^( 5) =       0.000453113473
  error estimate for blocks of size 2^( 6) =       0.000461164664
  error estimate for blocks of size 2^( 7) =       0.000466680100

      target function =                  N/A
              le_mean =     -16.906511489085
             les_mean =     286.171968372387
             stat err =       0.000455910169
             autocorr =       1.271821748273
              std dev =       0.571717062035
             le_variance =       0.326860399022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326890871848
                                         uncertainty =       0.002632324097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326890871848
                                         uncertainty =       0.002632324097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404265011
  error estimate for blocks of size 2^( 2) =       0.000416767126
  error estimate for blocks of size 2^( 3) =       0.000430283560
  error estimate for blocks of size 2^( 4) =       0.000442682439
  error estimate for blocks of size 2^( 5) =       0.000453113473
  error estimate for blocks of size 2^( 6) =       0.000461164664
  error estimate for blocks of size 2^( 7) =       0.000466680100

      target function =                  N/A
              le_mean =     -16.906511489085
             les_mean =     286.171968372387
             stat err =       0.000455910169
             autocorr =       1.271821748273
              std dev =       0.571717062035
             le_variance =       0.326860399022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326890871848
                                         uncertainty =       0.002632324097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326890871848
                                         uncertainty =       0.002632324097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404265011
  error estimate for blocks of size 2^( 2) =       0.000416767126
  error estimate for blocks of size 2^( 3) =       0.000430283560
  error estimate for blocks of size 2^( 4) =       0.000442682439
  error estimate for blocks of size 2^( 5) =       0.000453113473
  error estimate for blocks of size 2^( 6) =       0.000461164664
  error estimate for blocks of size 2^( 7) =       0.000466680100

      target function =                  N/A
              le_mean =     -16.906511489085
             les_mean =     286.171968372387
             stat err =       0.000455910169
             autocorr =       1.271821748273
              std dev =       0.571717062035
             le_variance =       0.326860399022


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906511489085        initial  <--
     1.4901e+58     1.4901e+59             0.0000e+00       -16.906511489085
     5.9605e+58     5.9605e+59             0.0000e+00       -16.906511489085
     2.3842e+59     2.3842e+60             0.0000e+00       -16.906511489085

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5730
  </log>
  <optVariables href="H2O.s083.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7908e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.8991
    reference variance = 0.299925
====================================================
  Execution time = 2.1052e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3764e-01
  Total weights = 1.952083767e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1088e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319582860372
                                         uncertainty =       0.001968570152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319582860372
                                         uncertainty =       0.001968570152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399742404
  error estimate for blocks of size 2^( 2) =       0.000412708470
  error estimate for blocks of size 2^( 3) =       0.000425892710
  error estimate for blocks of size 2^( 4) =       0.000438972714
  error estimate for blocks of size 2^( 5) =       0.000450916242
  error estimate for blocks of size 2^( 6) =       0.000460839085
  error estimate for blocks of size 2^( 7) =       0.000466726853

      target function =                  N/A
              le_mean =     -16.905288730590
             les_mean =     286.126423434915
             stat err =       0.000454363724
             autocorr =       1.291953432249
              std dev =       0.565321129318
             le_variance =       0.319587979254


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690528873059e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+59, overlap shift 1.4901e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905288730584       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905288730584       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905288730584       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+59 is 3.370224e-63

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+59, overlap shift 5.9605e+60 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905288730584       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905288730584       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905288730584       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+59 is 8.425560e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+60, overlap shift 2.3842e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905288730584       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905288730584       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905288730584       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+60 is 2.106390e-64

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.453457 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7172e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -16.917
    reference variance = 0.412883
====================================================
  Execution time = 2.0884e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3955e-01
  Total weights = 1.9516e+06
  Execution time = 1.8785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326118865915
                                         uncertainty =       0.002708131091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326118865915
                                         uncertainty =       0.002708131091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403790675
  error estimate for blocks of size 2^( 2) =       0.000416728108
  error estimate for blocks of size 2^( 3) =       0.000429865730
  error estimate for blocks of size 2^( 4) =       0.000442374298
  error estimate for blocks of size 2^( 5) =       0.000454075378
  error estimate for blocks of size 2^( 6) =       0.000462498077
  error estimate for blocks of size 2^( 7) =       0.000466539416

      target function =                  N/A
              le_mean =     -16.905848694929
             les_mean =     286.147272045468
             stat err =       0.000456371792
             autocorr =       1.277394427368
              std dev =       0.571046248306
             le_variance =       0.326093817705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326118865915
                                         uncertainty =       0.002708131091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326118865915
                                         uncertainty =       0.002708131091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403790675
  error estimate for blocks of size 2^( 2) =       0.000416728108
  error estimate for blocks of size 2^( 3) =       0.000429865730
  error estimate for blocks of size 2^( 4) =       0.000442374298
  error estimate for blocks of size 2^( 5) =       0.000454075378
  error estimate for blocks of size 2^( 6) =       0.000462498077
  error estimate for blocks of size 2^( 7) =       0.000466539416

      target function =                  N/A
              le_mean =     -16.905848694929
             les_mean =     286.147272045468
             stat err =       0.000456371792
             autocorr =       1.277394427368
              std dev =       0.571046248306
             le_variance =       0.326093817705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326118865915
                                         uncertainty =       0.002708131091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326118865915
                                         uncertainty =       0.002708131091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403790675
  error estimate for blocks of size 2^( 2) =       0.000416728108
  error estimate for blocks of size 2^( 3) =       0.000429865730
  error estimate for blocks of size 2^( 4) =       0.000442374298
  error estimate for blocks of size 2^( 5) =       0.000454075378
  error estimate for blocks of size 2^( 6) =       0.000462498077
  error estimate for blocks of size 2^( 7) =       0.000466539416

      target function =                  N/A
              le_mean =     -16.905848694929
             les_mean =     286.147272045468
             stat err =       0.000456371792
             autocorr =       1.277394427368
              std dev =       0.571046248306
             le_variance =       0.326093817705

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326118865915
                                         uncertainty =       0.002708131091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326118865915
                                         uncertainty =       0.002708131091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403790675
  error estimate for blocks of size 2^( 2) =       0.000416728108
  error estimate for blocks of size 2^( 3) =       0.000429865730
  error estimate for blocks of size 2^( 4) =       0.000442374298
  error estimate for blocks of size 2^( 5) =       0.000454075378
  error estimate for blocks of size 2^( 6) =       0.000462498077
  error estimate for blocks of size 2^( 7) =       0.000466539416

      target function =                  N/A
              le_mean =     -16.905848694929
             les_mean =     286.147272045468
             stat err =       0.000456371792
             autocorr =       1.277394427368
              std dev =       0.571046248306
             le_variance =       0.326093817705


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905848694929        initial  <--
     1.4901e+59     1.4901e+60             3.3702e-63       -16.905848694929
     5.9605e+59     5.9605e+60             8.4256e-64       -16.905848694929
     2.3842e+60     2.3842e+61             2.1064e-64       -16.905848694929

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3923
  </log>
  <optVariables href="H2O.s084.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7570e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.9486
    reference variance = 0.281609
====================================================
  Execution time = 2.1171e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5224e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3483e-01
  Total weights = 1.951352425e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0306e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321529987076
                                         uncertainty =       0.002262523924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321529987076
                                         uncertainty =       0.002262523924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400910496
  error estimate for blocks of size 2^( 2) =       0.000414156020
  error estimate for blocks of size 2^( 3) =       0.000427676448
  error estimate for blocks of size 2^( 4) =       0.000440990661
  error estimate for blocks of size 2^( 5) =       0.000452501018
  error estimate for blocks of size 2^( 6) =       0.000462957007
  error estimate for blocks of size 2^( 7) =       0.000467888945

      target function =                  N/A
              le_mean =     -16.906313108057
             les_mean =     286.158251655086
             stat err =       0.000456084408
             autocorr =       1.294182721631
              std dev =       0.566973060669
             le_variance =       0.321458451524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631310806e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+60, overlap shift 1.4901e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313108065       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313108065       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+60 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+60, overlap shift 5.9605e+61 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313108065       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313108065       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+60 is 5.869166e-65

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+61, overlap shift 2.3842e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906313108065       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906313108065       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.454656 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7212e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -16.8922
    reference variance = 0.175605
====================================================
  Execution time = 2.1390e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3823e-01
  Total weights = 1.9514e+06
  Execution time = 1.8838e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323579458843
                                         uncertainty =       0.002500728183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323579458843
                                         uncertainty =       0.002500728183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402256925
  error estimate for blocks of size 2^( 2) =       0.000414759977
  error estimate for blocks of size 2^( 3) =       0.000427858768
  error estimate for blocks of size 2^( 4) =       0.000439719350
  error estimate for blocks of size 2^( 5) =       0.000447848942
  error estimate for blocks of size 2^( 6) =       0.000455193454
  error estimate for blocks of size 2^( 7) =       0.000458748872

      target function =                  N/A
              le_mean =     -16.906012526246
             les_mean =     286.151488042017
             stat err =       0.000450377654
             autocorr =       1.253564285934
              std dev =       0.568877199046
             le_variance =       0.323621267595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323579458843
                                         uncertainty =       0.002500728183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323579458843
                                         uncertainty =       0.002500728183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402256925
  error estimate for blocks of size 2^( 2) =       0.000414759977
  error estimate for blocks of size 2^( 3) =       0.000427858768
  error estimate for blocks of size 2^( 4) =       0.000439719350
  error estimate for blocks of size 2^( 5) =       0.000447848942
  error estimate for blocks of size 2^( 6) =       0.000455193454
  error estimate for blocks of size 2^( 7) =       0.000458748872

      target function =                  N/A
              le_mean =     -16.906012526246
             les_mean =     286.151488042017
             stat err =       0.000450377654
             autocorr =       1.253564285934
              std dev =       0.568877199046
             le_variance =       0.323621267595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323579458843
                                         uncertainty =       0.002500728183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323579458843
                                         uncertainty =       0.002500728183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402256925
  error estimate for blocks of size 2^( 2) =       0.000414759977
  error estimate for blocks of size 2^( 3) =       0.000427858768
  error estimate for blocks of size 2^( 4) =       0.000439719350
  error estimate for blocks of size 2^( 5) =       0.000447848942
  error estimate for blocks of size 2^( 6) =       0.000455193454
  error estimate for blocks of size 2^( 7) =       0.000458748872

      target function =                  N/A
              le_mean =     -16.906012526246
             les_mean =     286.151488042017
             stat err =       0.000450377654
             autocorr =       1.253564285934
              std dev =       0.568877199046
             le_variance =       0.323621267595

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323579458843
                                         uncertainty =       0.002500728183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323579458843
                                         uncertainty =       0.002500728183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402256925
  error estimate for blocks of size 2^( 2) =       0.000414759977
  error estimate for blocks of size 2^( 3) =       0.000427858768
  error estimate for blocks of size 2^( 4) =       0.000439719350
  error estimate for blocks of size 2^( 5) =       0.000447848942
  error estimate for blocks of size 2^( 6) =       0.000455193454
  error estimate for blocks of size 2^( 7) =       0.000458748872

      target function =                  N/A
              le_mean =     -16.906012526246
             les_mean =     286.151488042017
             stat err =       0.000450377654
             autocorr =       1.253564285934
              std dev =       0.568877199046
             le_variance =       0.323621267595


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906012526246        initial  <--
     1.4901e+60     1.4901e+61             0.0000e+00       -16.906012526246
     5.9605e+60     5.9605e+61             5.8692e-65       -16.906012526246
     2.3842e+61     2.3842e+62             0.0000e+00       -16.906012526246

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9214
  </log>
  <optVariables href="H2O.s085.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8139e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.8907
    reference variance = 0.51709
====================================================
  Execution time = 2.1256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3653e-01
  Total weights = 1.951371682e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322003843523
                                         uncertainty =       0.002389643666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322003843523
                                         uncertainty =       0.002389643666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401268317
  error estimate for blocks of size 2^( 2) =       0.000414376208
  error estimate for blocks of size 2^( 3) =       0.000427598494
  error estimate for blocks of size 2^( 4) =       0.000439721256
  error estimate for blocks of size 2^( 5) =       0.000450630293
  error estimate for blocks of size 2^( 6) =       0.000457698707
  error estimate for blocks of size 2^( 7) =       0.000463481777

      target function =                  N/A
              le_mean =     -16.906302749895
             les_mean =     286.159604230940
             stat err =       0.000452883008
             autocorr =       1.273803130989
              std dev =       0.567479096215
             le_variance =       0.322032524641


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630274990e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+61, overlap shift 1.4901e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302749867       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906302749867       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+61, overlap shift 5.9605e+62 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302749867       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906302749867       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+61 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+62, overlap shift 2.3842e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302749867       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906302749867       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.455852 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7308e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -16.9617
    reference variance = 0.212663
====================================================
  Execution time = 2.0881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3283e-01
  Total weights = 1.9518e+06
  Execution time = 1.8857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321092883632
                                         uncertainty =       0.002094764577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321092883632
                                         uncertainty =       0.002094764577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400737489
  error estimate for blocks of size 2^( 2) =       0.000413510381
  error estimate for blocks of size 2^( 3) =       0.000426301714
  error estimate for blocks of size 2^( 4) =       0.000438747248
  error estimate for blocks of size 2^( 5) =       0.000449167052
  error estimate for blocks of size 2^( 6) =       0.000455355282
  error estimate for blocks of size 2^( 7) =       0.000457499989

      target function =                  N/A
              le_mean =     -16.905598418270
             les_mean =     286.132092026578
             stat err =       0.000450192392
             autocorr =       1.262049411052
              std dev =       0.566728391909
             le_variance =       0.321181070196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321092883632
                                         uncertainty =       0.002094764577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321092883632
                                         uncertainty =       0.002094764577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400737489
  error estimate for blocks of size 2^( 2) =       0.000413510381
  error estimate for blocks of size 2^( 3) =       0.000426301714
  error estimate for blocks of size 2^( 4) =       0.000438747248
  error estimate for blocks of size 2^( 5) =       0.000449167052
  error estimate for blocks of size 2^( 6) =       0.000455355282
  error estimate for blocks of size 2^( 7) =       0.000457499989

      target function =                  N/A
              le_mean =     -16.905598418270
             les_mean =     286.132092026578
             stat err =       0.000450192392
             autocorr =       1.262049411052
              std dev =       0.566728391909
             le_variance =       0.321181070196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321092883632
                                         uncertainty =       0.002094764577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321092883632
                                         uncertainty =       0.002094764577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400737489
  error estimate for blocks of size 2^( 2) =       0.000413510381
  error estimate for blocks of size 2^( 3) =       0.000426301714
  error estimate for blocks of size 2^( 4) =       0.000438747248
  error estimate for blocks of size 2^( 5) =       0.000449167052
  error estimate for blocks of size 2^( 6) =       0.000455355282
  error estimate for blocks of size 2^( 7) =       0.000457499989

      target function =                  N/A
              le_mean =     -16.905598418270
             les_mean =     286.132092026578
             stat err =       0.000450192392
             autocorr =       1.262049411052
              std dev =       0.566728391909
             le_variance =       0.321181070196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321092883632
                                         uncertainty =       0.002094764577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321092883632
                                         uncertainty =       0.002094764577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400737489
  error estimate for blocks of size 2^( 2) =       0.000413510381
  error estimate for blocks of size 2^( 3) =       0.000426301714
  error estimate for blocks of size 2^( 4) =       0.000438747248
  error estimate for blocks of size 2^( 5) =       0.000449167052
  error estimate for blocks of size 2^( 6) =       0.000455355282
  error estimate for blocks of size 2^( 7) =       0.000457499989

      target function =                  N/A
              le_mean =     -16.905598418270
             les_mean =     286.132092026578
             stat err =       0.000450192392
             autocorr =       1.262049411052
              std dev =       0.566728391909
             le_variance =       0.321181070196


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905598418270        initial  <--
     1.4901e+61     1.4901e+62             0.0000e+00       -16.905598418270
     5.9605e+61     5.9605e+62             0.0000e+00       -16.905598418270
     2.3842e+62     2.3842e+63             0.0000e+00       -16.905598418270

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4176
  </log>
  <optVariables href="H2O.s086.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7731e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.8684
    reference variance = 0.129588
====================================================
  Execution time = 2.1304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3728e-01
  Total weights = 1.951744654e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0676e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322898676114
                                         uncertainty =       0.002083194568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322898676114
                                         uncertainty =       0.002083194568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401800880
  error estimate for blocks of size 2^( 2) =       0.000414634881
  error estimate for blocks of size 2^( 3) =       0.000428314094
  error estimate for blocks of size 2^( 4) =       0.000441589305
  error estimate for blocks of size 2^( 5) =       0.000452418732
  error estimate for blocks of size 2^( 6) =       0.000462315766
  error estimate for blocks of size 2^( 7) =       0.000467096921

      target function =                  N/A
              le_mean =     -16.906255166835
             les_mean =     286.158746919067
             stat err =       0.000455855181
             autocorr =       1.287158484534
              std dev =       0.568232253424
             le_variance =       0.322887893831


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690625516683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+62, overlap shift 1.4901e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906255166818       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906255166818       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+62, overlap shift 5.9605e+63 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906255166818       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906255166818       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+62 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+63, overlap shift 2.3842e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906255166818       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906255166818       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.457038 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7382e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -16.7667
    reference variance = 2.8219
====================================================
  Execution time = 2.2781e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3254e-01
  Total weights = 1.9521e+06
  Execution time = 1.8780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321354392693
                                         uncertainty =       0.002152200286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321354392693
                                         uncertainty =       0.002152200286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400835019
  error estimate for blocks of size 2^( 2) =       0.000414126319
  error estimate for blocks of size 2^( 3) =       0.000427261731
  error estimate for blocks of size 2^( 4) =       0.000439464056
  error estimate for blocks of size 2^( 5) =       0.000450399088
  error estimate for blocks of size 2^( 6) =       0.000458199549
  error estimate for blocks of size 2^( 7) =       0.000463142254

      target function =                  N/A
              le_mean =     -16.905337002723
             les_mean =     286.122958207333
             stat err =       0.000452801237
             autocorr =       1.276097610008
              std dev =       0.566866319977
             le_variance =       0.321337424725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321354392693
                                         uncertainty =       0.002152200286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321354392693
                                         uncertainty =       0.002152200286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400835019
  error estimate for blocks of size 2^( 2) =       0.000414126319
  error estimate for blocks of size 2^( 3) =       0.000427261731
  error estimate for blocks of size 2^( 4) =       0.000439464056
  error estimate for blocks of size 2^( 5) =       0.000450399088
  error estimate for blocks of size 2^( 6) =       0.000458199549
  error estimate for blocks of size 2^( 7) =       0.000463142254

      target function =                  N/A
              le_mean =     -16.905337002723
             les_mean =     286.122958207333
             stat err =       0.000452801237
             autocorr =       1.276097610008
              std dev =       0.566866319977
             le_variance =       0.321337424725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321354392693
                                         uncertainty =       0.002152200286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321354392693
                                         uncertainty =       0.002152200286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400835019
  error estimate for blocks of size 2^( 2) =       0.000414126319
  error estimate for blocks of size 2^( 3) =       0.000427261731
  error estimate for blocks of size 2^( 4) =       0.000439464056
  error estimate for blocks of size 2^( 5) =       0.000450399088
  error estimate for blocks of size 2^( 6) =       0.000458199549
  error estimate for blocks of size 2^( 7) =       0.000463142254

      target function =                  N/A
              le_mean =     -16.905337002723
             les_mean =     286.122958207333
             stat err =       0.000452801237
             autocorr =       1.276097610008
              std dev =       0.566866319977
             le_variance =       0.321337424725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321354392693
                                         uncertainty =       0.002152200286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321354392693
                                         uncertainty =       0.002152200286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400835019
  error estimate for blocks of size 2^( 2) =       0.000414126319
  error estimate for blocks of size 2^( 3) =       0.000427261731
  error estimate for blocks of size 2^( 4) =       0.000439464056
  error estimate for blocks of size 2^( 5) =       0.000450399088
  error estimate for blocks of size 2^( 6) =       0.000458199549
  error estimate for blocks of size 2^( 7) =       0.000463142254

      target function =                  N/A
              le_mean =     -16.905337002723
             les_mean =     286.122958207333
             stat err =       0.000452801237
             autocorr =       1.276097610008
              std dev =       0.566866319977
             le_variance =       0.321337424725


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905337002723        initial  <--
     1.4901e+62     1.4901e+63             0.0000e+00       -16.905337002723
     5.9605e+62     5.9605e+63             0.0000e+00       -16.905337002723
     2.3842e+63     2.3842e+64             0.0000e+00       -16.905337002723

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.3425
  </log>
  <optVariables href="H2O.s087.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9731e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.9604
    reference variance = 0.232544
====================================================
  Execution time = 2.1065e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3527e-01
  Total weights = 1.951592526e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323152137151
                                         uncertainty =       0.002342633748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323152137151
                                         uncertainty =       0.002342633748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401951668
  error estimate for blocks of size 2^( 2) =       0.000414921508
  error estimate for blocks of size 2^( 3) =       0.000427814212
  error estimate for blocks of size 2^( 4) =       0.000440385746
  error estimate for blocks of size 2^( 5) =       0.000451453707
  error estimate for blocks of size 2^( 6) =       0.000459703784
  error estimate for blocks of size 2^( 7) =       0.000465837194

      target function =                  N/A
              le_mean =     -16.906433000039
             les_mean =     286.162748438364
             stat err =       0.000454345108
             autocorr =       1.277685723626
              std dev =       0.568445499841
             le_variance =       0.323130286290


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690643300004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+63, overlap shift 1.4901e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906433000044       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906433000044       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+63, overlap shift 5.9605e+64 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906433000044       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906433000044       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+63 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+64, overlap shift 2.3842e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906433000044       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906433000044       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.458223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7159e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -16.8545
    reference variance = 0.208557
====================================================
  Execution time = 2.0877e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3602e-01
  Total weights = 1.9516e+06
  Execution time = 1.8792e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322782040779
                                         uncertainty =       0.002520242347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322782040779
                                         uncertainty =       0.002520242347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401707928
  error estimate for blocks of size 2^( 2) =       0.000414723835
  error estimate for blocks of size 2^( 3) =       0.000427683873
  error estimate for blocks of size 2^( 4) =       0.000439340424
  error estimate for blocks of size 2^( 5) =       0.000450725665
  error estimate for blocks of size 2^( 6) =       0.000459455548
  error estimate for blocks of size 2^( 7) =       0.000463930082

      target function =                  N/A
              le_mean =     -16.905736080949
             les_mean =     286.139931872777
             stat err =       0.000453362930
             autocorr =       1.273711899902
              std dev =       0.568100799756
             le_variance =       0.322738518683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322782040779
                                         uncertainty =       0.002520242347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322782040779
                                         uncertainty =       0.002520242347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401707928
  error estimate for blocks of size 2^( 2) =       0.000414723835
  error estimate for blocks of size 2^( 3) =       0.000427683873
  error estimate for blocks of size 2^( 4) =       0.000439340424
  error estimate for blocks of size 2^( 5) =       0.000450725665
  error estimate for blocks of size 2^( 6) =       0.000459455548
  error estimate for blocks of size 2^( 7) =       0.000463930082

      target function =                  N/A
              le_mean =     -16.905736080949
             les_mean =     286.139931872777
             stat err =       0.000453362930
             autocorr =       1.273711899902
              std dev =       0.568100799756
             le_variance =       0.322738518683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322782040779
                                         uncertainty =       0.002520242347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322782040779
                                         uncertainty =       0.002520242347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401707928
  error estimate for blocks of size 2^( 2) =       0.000414723835
  error estimate for blocks of size 2^( 3) =       0.000427683873
  error estimate for blocks of size 2^( 4) =       0.000439340424
  error estimate for blocks of size 2^( 5) =       0.000450725665
  error estimate for blocks of size 2^( 6) =       0.000459455548
  error estimate for blocks of size 2^( 7) =       0.000463930082

      target function =                  N/A
              le_mean =     -16.905736080949
             les_mean =     286.139931872777
             stat err =       0.000453362930
             autocorr =       1.273711899902
              std dev =       0.568100799756
             le_variance =       0.322738518683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322782040779
                                         uncertainty =       0.002520242347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322782040779
                                         uncertainty =       0.002520242347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401707928
  error estimate for blocks of size 2^( 2) =       0.000414723835
  error estimate for blocks of size 2^( 3) =       0.000427683873
  error estimate for blocks of size 2^( 4) =       0.000439340424
  error estimate for blocks of size 2^( 5) =       0.000450725665
  error estimate for blocks of size 2^( 6) =       0.000459455548
  error estimate for blocks of size 2^( 7) =       0.000463930082

      target function =                  N/A
              le_mean =     -16.905736080949
             les_mean =     286.139931872777
             stat err =       0.000453362930
             autocorr =       1.273711899902
              std dev =       0.568100799756
             le_variance =       0.322738518683


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905736080949        initial  <--
     1.4901e+63     1.4901e+64             0.0000e+00       -16.905736080949
     5.9605e+63     5.9605e+64             0.0000e+00       -16.905736080949
     2.3842e+64     2.3842e+65             0.0000e+00       -16.905736080949

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3840
  </log>
  <optVariables href="H2O.s088.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.8624
    reference variance = 0.307152
====================================================
  Execution time = 2.1319e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3799e-01
  Total weights = 1.951765448e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0366e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323627622729
                                         uncertainty =       0.002266081707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323627622729
                                         uncertainty =       0.002266081707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402231502
  error estimate for blocks of size 2^( 2) =       0.000415100754
  error estimate for blocks of size 2^( 3) =       0.000428116494
  error estimate for blocks of size 2^( 4) =       0.000439321091
  error estimate for blocks of size 2^( 5) =       0.000449782424
  error estimate for blocks of size 2^( 6) =       0.000457929964
  error estimate for blocks of size 2^( 7) =       0.000461949621

      target function =                  N/A
              le_mean =     -16.906027553754
             les_mean =     286.151759786467
             stat err =       0.000452245775
             autocorr =       1.264144948694
              std dev =       0.568841246011
             le_variance =       0.323580363163


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602755375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+64, overlap shift 1.4901e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027553771       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027553771       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+64, overlap shift 5.9605e+65 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027553771       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027553771       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+64 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+65, overlap shift 2.3842e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906027553771       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906027553771       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.459436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7365e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -16.997
    reference variance = 0.391562
====================================================
  Execution time = 2.0907e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3223e-01
  Total weights = 1.9520e+06
  Execution time = 1.8739e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321972099500
                                         uncertainty =       0.002412678682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321972099500
                                         uncertainty =       0.002412678682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401219760
  error estimate for blocks of size 2^( 2) =       0.000413879363
  error estimate for blocks of size 2^( 3) =       0.000426767608
  error estimate for blocks of size 2^( 4) =       0.000438581216
  error estimate for blocks of size 2^( 5) =       0.000449098152
  error estimate for blocks of size 2^( 6) =       0.000455680721
  error estimate for blocks of size 2^( 7) =       0.000464349567

      target function =                  N/A
              le_mean =     -16.905756409569
             les_mean =     286.136829602004
             stat err =       0.000451927414
             autocorr =       1.268740329161
              std dev =       0.567410426360
             le_variance =       0.321954591942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321972099500
                                         uncertainty =       0.002412678682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321972099500
                                         uncertainty =       0.002412678682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401219760
  error estimate for blocks of size 2^( 2) =       0.000413879363
  error estimate for blocks of size 2^( 3) =       0.000426767608
  error estimate for blocks of size 2^( 4) =       0.000438581216
  error estimate for blocks of size 2^( 5) =       0.000449098152
  error estimate for blocks of size 2^( 6) =       0.000455680721
  error estimate for blocks of size 2^( 7) =       0.000464349567

      target function =                  N/A
              le_mean =     -16.905756409569
             les_mean =     286.136829602004
             stat err =       0.000451927414
             autocorr =       1.268740329161
              std dev =       0.567410426360
             le_variance =       0.321954591942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321972099500
                                         uncertainty =       0.002412678682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321972099500
                                         uncertainty =       0.002412678682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401219760
  error estimate for blocks of size 2^( 2) =       0.000413879363
  error estimate for blocks of size 2^( 3) =       0.000426767608
  error estimate for blocks of size 2^( 4) =       0.000438581216
  error estimate for blocks of size 2^( 5) =       0.000449098152
  error estimate for blocks of size 2^( 6) =       0.000455680721
  error estimate for blocks of size 2^( 7) =       0.000464349567

      target function =                  N/A
              le_mean =     -16.905756409569
             les_mean =     286.136829602004
             stat err =       0.000451927414
             autocorr =       1.268740329161
              std dev =       0.567410426360
             le_variance =       0.321954591942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321972099500
                                         uncertainty =       0.002412678682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321972099500
                                         uncertainty =       0.002412678682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401219760
  error estimate for blocks of size 2^( 2) =       0.000413879363
  error estimate for blocks of size 2^( 3) =       0.000426767608
  error estimate for blocks of size 2^( 4) =       0.000438581216
  error estimate for blocks of size 2^( 5) =       0.000449098152
  error estimate for blocks of size 2^( 6) =       0.000455680721
  error estimate for blocks of size 2^( 7) =       0.000464349567

      target function =                  N/A
              le_mean =     -16.905756409569
             les_mean =     286.136829602004
             stat err =       0.000451927414
             autocorr =       1.268740329161
              std dev =       0.567410426360
             le_variance =       0.321954591942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905756409569        initial  <--
     1.4901e+64     1.4901e+65             0.0000e+00       -16.905756409569
     5.9605e+64     5.9605e+65             0.0000e+00       -16.905756409569
     2.3842e+65     2.3842e+66             0.0000e+00       -16.905756409569

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3853
  </log>
  <optVariables href="H2O.s089.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7757e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.9537
    reference variance = 0.787354
====================================================
  Execution time = 2.1064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3566e-01
  Total weights = 1.951532926e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322589412810
                                         uncertainty =       0.003159823429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322589412810
                                         uncertainty =       0.003159823429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401655913
  error estimate for blocks of size 2^( 2) =       0.000414368587
  error estimate for blocks of size 2^( 3) =       0.000426953046
  error estimate for blocks of size 2^( 4) =       0.000438361856
  error estimate for blocks of size 2^( 5) =       0.000449272519
  error estimate for blocks of size 2^( 6) =       0.000455960943
  error estimate for blocks of size 2^( 7) =       0.000459969483

      target function =                  N/A
              le_mean =     -16.905800859916
             les_mean =     286.141765516662
             stat err =       0.000450891200
             autocorr =       1.260187565467
              std dev =       0.568027239188
             le_variance =       0.322654944459


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580085992e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+65, overlap shift 1.4901e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800859929       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800859929       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+65, overlap shift 5.9605e+66 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800859929       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800859929       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+65 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+66, overlap shift 2.3842e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905800859929       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905800859929       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+66 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.460626 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7127e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -16.9394
    reference variance = 0.2172
====================================================
  Execution time = 2.0765e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3252e-01
  Total weights = 1.9519e+06
  Execution time = 1.8731e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321993935425
                                         uncertainty =       0.001977748133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321993935425
                                         uncertainty =       0.001977748133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401238429
  error estimate for blocks of size 2^( 2) =       0.000414189509
  error estimate for blocks of size 2^( 3) =       0.000428185004
  error estimate for blocks of size 2^( 4) =       0.000441387508
  error estimate for blocks of size 2^( 5) =       0.000453460577
  error estimate for blocks of size 2^( 6) =       0.000463456658
  error estimate for blocks of size 2^( 7) =       0.000472427620

      target function =                  N/A
              le_mean =     -16.905767282374
             les_mean =     286.137486084386
             stat err =       0.000457683091
             autocorr =       1.301141987742
              std dev =       0.567436828504
             le_variance =       0.321984554343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321993935425
                                         uncertainty =       0.001977748133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321993935425
                                         uncertainty =       0.001977748133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401238429
  error estimate for blocks of size 2^( 2) =       0.000414189509
  error estimate for blocks of size 2^( 3) =       0.000428185004
  error estimate for blocks of size 2^( 4) =       0.000441387508
  error estimate for blocks of size 2^( 5) =       0.000453460577
  error estimate for blocks of size 2^( 6) =       0.000463456658
  error estimate for blocks of size 2^( 7) =       0.000472427620

      target function =                  N/A
              le_mean =     -16.905767282374
             les_mean =     286.137486084386
             stat err =       0.000457683091
             autocorr =       1.301141987742
              std dev =       0.567436828504
             le_variance =       0.321984554343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321993935425
                                         uncertainty =       0.001977748133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321993935425
                                         uncertainty =       0.001977748133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401238429
  error estimate for blocks of size 2^( 2) =       0.000414189509
  error estimate for blocks of size 2^( 3) =       0.000428185004
  error estimate for blocks of size 2^( 4) =       0.000441387508
  error estimate for blocks of size 2^( 5) =       0.000453460577
  error estimate for blocks of size 2^( 6) =       0.000463456658
  error estimate for blocks of size 2^( 7) =       0.000472427620

      target function =                  N/A
              le_mean =     -16.905767282374
             les_mean =     286.137486084386
             stat err =       0.000457683091
             autocorr =       1.301141987742
              std dev =       0.567436828504
             le_variance =       0.321984554343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321993935425
                                         uncertainty =       0.001977748133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321993935425
                                         uncertainty =       0.001977748133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401238429
  error estimate for blocks of size 2^( 2) =       0.000414189509
  error estimate for blocks of size 2^( 3) =       0.000428185004
  error estimate for blocks of size 2^( 4) =       0.000441387508
  error estimate for blocks of size 2^( 5) =       0.000453460577
  error estimate for blocks of size 2^( 6) =       0.000463456658
  error estimate for blocks of size 2^( 7) =       0.000472427620

      target function =                  N/A
              le_mean =     -16.905767282374
             les_mean =     286.137486084386
             stat err =       0.000457683091
             autocorr =       1.301141987742
              std dev =       0.567436828504
             le_variance =       0.321984554343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905767282374        initial  <--
     1.4901e+65     1.4901e+66             0.0000e+00       -16.905767282374
     5.9605e+65     5.9605e+66             0.0000e+00       -16.905767282374
     2.3842e+66     2.3842e+67             0.0000e+00       -16.905767282374

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2352
  </log>
  <optVariables href="H2O.s090.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7368e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.8362
    reference variance = 0.237061
====================================================
  Execution time = 2.0878e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5238e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3730e-01
  Total weights = 1.951573830e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0975e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324150723809
                                         uncertainty =       0.001940874491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324150723809
                                         uncertainty =       0.001940874491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402561157
  error estimate for blocks of size 2^( 2) =       0.000415323151
  error estimate for blocks of size 2^( 3) =       0.000427883474
  error estimate for blocks of size 2^( 4) =       0.000440300534
  error estimate for blocks of size 2^( 5) =       0.000449474529
  error estimate for blocks of size 2^( 6) =       0.000456654730
  error estimate for blocks of size 2^( 7) =       0.000460644227

      target function =                  N/A
              le_mean =     -16.906057949112
             les_mean =     286.152098448190
             stat err =       0.000451768505
             autocorr =       1.259412979845
              std dev =       0.569307448443
             le_variance =       0.324110970853


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690605794911e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+66, overlap shift 1.4901e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906057949101       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906057949101       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+66 is 2.793281e-70

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+66, overlap shift 5.9605e+67 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906057949101       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906057949101       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906057949101       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+66 is 6.746050e-71

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+67, overlap shift 2.3842e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906057949101       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906057949101       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906057949101       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+67 is 1.686513e-71

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.462011 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6986e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -16.9051
    reference variance = 0.274175
====================================================
  Execution time = 2.0827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3491e-01
  Total weights = 1.9518e+06
  Execution time = 1.8762e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745303078
                                         uncertainty =       0.002387298603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745303078
                                         uncertainty =       0.002387298603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401653158
  error estimate for blocks of size 2^( 2) =       0.000414491033
  error estimate for blocks of size 2^( 3) =       0.000427407966
  error estimate for blocks of size 2^( 4) =       0.000439348528
  error estimate for blocks of size 2^( 5) =       0.000449699895
  error estimate for blocks of size 2^( 6) =       0.000457239367
  error estimate for blocks of size 2^( 7) =       0.000463074561

      target function =                  N/A
              le_mean =     -16.905744981553
             les_mean =     286.139125292525
             stat err =       0.000452340588
             autocorr =       1.268319719815
              std dev =       0.568023342882
             le_variance =       0.322650518059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745303078
                                         uncertainty =       0.002387298603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745303078
                                         uncertainty =       0.002387298603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401653158
  error estimate for blocks of size 2^( 2) =       0.000414491033
  error estimate for blocks of size 2^( 3) =       0.000427407966
  error estimate for blocks of size 2^( 4) =       0.000439348528
  error estimate for blocks of size 2^( 5) =       0.000449699895
  error estimate for blocks of size 2^( 6) =       0.000457239367
  error estimate for blocks of size 2^( 7) =       0.000463074561

      target function =                  N/A
              le_mean =     -16.905744981553
             les_mean =     286.139125292525
             stat err =       0.000452340588
             autocorr =       1.268319719815
              std dev =       0.568023342882
             le_variance =       0.322650518059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745303078
                                         uncertainty =       0.002387298603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745303078
                                         uncertainty =       0.002387298603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401653158
  error estimate for blocks of size 2^( 2) =       0.000414491033
  error estimate for blocks of size 2^( 3) =       0.000427407966
  error estimate for blocks of size 2^( 4) =       0.000439348528
  error estimate for blocks of size 2^( 5) =       0.000449699895
  error estimate for blocks of size 2^( 6) =       0.000457239367
  error estimate for blocks of size 2^( 7) =       0.000463074561

      target function =                  N/A
              le_mean =     -16.905744981553
             les_mean =     286.139125292525
             stat err =       0.000452340588
             autocorr =       1.268319719815
              std dev =       0.568023342882
             le_variance =       0.322650518059

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745303078
                                         uncertainty =       0.002387298603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322745303078
                                         uncertainty =       0.002387298603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401653158
  error estimate for blocks of size 2^( 2) =       0.000414491033
  error estimate for blocks of size 2^( 3) =       0.000427407966
  error estimate for blocks of size 2^( 4) =       0.000439348528
  error estimate for blocks of size 2^( 5) =       0.000449699895
  error estimate for blocks of size 2^( 6) =       0.000457239367
  error estimate for blocks of size 2^( 7) =       0.000463074561

      target function =                  N/A
              le_mean =     -16.905744981553
             les_mean =     286.139125292525
             stat err =       0.000452340588
             autocorr =       1.268319719815
              std dev =       0.568023342882
             le_variance =       0.322650518059


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905744981553        initial  <--
     1.4901e+66     1.4901e+67             2.7933e-70       -16.905744981553
     5.9605e+66     5.9605e+67             6.7461e-71       -16.905744981553
     2.3842e+67     2.3842e+68             1.6865e-71       -16.905744981553

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3203
  </log>
  <optVariables href="H2O.s091.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7312e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.9294
    reference variance = 0.374933
====================================================
  Execution time = 2.1056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5243e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4014e-01
  Total weights = 1.951813086e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325330094015
                                         uncertainty =       0.002648582492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325330094015
                                         uncertainty =       0.002648582492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403356138
  error estimate for blocks of size 2^( 2) =       0.000415866559
  error estimate for blocks of size 2^( 3) =       0.000428877784
  error estimate for blocks of size 2^( 4) =       0.000440386120
  error estimate for blocks of size 2^( 5) =       0.000449845141
  error estimate for blocks of size 2^( 6) =       0.000457295016
  error estimate for blocks of size 2^( 7) =       0.000460970460

      target function =                  N/A
              le_mean =     -16.906883303033
             les_mean =     286.182840372922
             stat err =       0.000452124184
             autocorr =       1.256429534566
              std dev =       0.570431720188
             le_variance =       0.325392347397


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690688330303e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+67, overlap shift 1.4901e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906883303033       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906883303033       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+67 is 0.000000e+00

solving harmonic davidson linear method for identity shift 5.9605e+67, overlap shift 5.9605e+68 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906883303033       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906883303033       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+67 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3842e+68, overlap shift 2.3842e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906883303033       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906883303033       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2: stopping due to imaginary component in cost function
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+68 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.463151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7150e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -16.8428
    reference variance = 0.378961
====================================================
  Execution time = 2.0743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3611e-01
  Total weights = 1.9515e+06
  Execution time = 1.8724e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323644913798
                                         uncertainty =       0.002291480748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323644913798
                                         uncertainty =       0.002291480748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402254845
  error estimate for blocks of size 2^( 2) =       0.000415095333
  error estimate for blocks of size 2^( 3) =       0.000428830630
  error estimate for blocks of size 2^( 4) =       0.000442477060
  error estimate for blocks of size 2^( 5) =       0.000454166608
  error estimate for blocks of size 2^( 6) =       0.000463363951
  error estimate for blocks of size 2^( 7) =       0.000470219354

      target function =                  N/A
              le_mean =     -16.906284384337
             les_mean =     286.158557171342
             stat err =       0.000457556743
             autocorr =       1.293860198314
              std dev =       0.568874256899
             le_variance =       0.323617920163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323644913798
                                         uncertainty =       0.002291480748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323644913798
                                         uncertainty =       0.002291480748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402254845
  error estimate for blocks of size 2^( 2) =       0.000415095333
  error estimate for blocks of size 2^( 3) =       0.000428830630
  error estimate for blocks of size 2^( 4) =       0.000442477060
  error estimate for blocks of size 2^( 5) =       0.000454166608
  error estimate for blocks of size 2^( 6) =       0.000463363951
  error estimate for blocks of size 2^( 7) =       0.000470219354

      target function =                  N/A
              le_mean =     -16.906284384337
             les_mean =     286.158557171342
             stat err =       0.000457556743
             autocorr =       1.293860198314
              std dev =       0.568874256899
             le_variance =       0.323617920163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323644913798
                                         uncertainty =       0.002291480748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323644913798
                                         uncertainty =       0.002291480748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402254845
  error estimate for blocks of size 2^( 2) =       0.000415095333
  error estimate for blocks of size 2^( 3) =       0.000428830630
  error estimate for blocks of size 2^( 4) =       0.000442477060
  error estimate for blocks of size 2^( 5) =       0.000454166608
  error estimate for blocks of size 2^( 6) =       0.000463363951
  error estimate for blocks of size 2^( 7) =       0.000470219354

      target function =                  N/A
              le_mean =     -16.906284384337
             les_mean =     286.158557171342
             stat err =       0.000457556743
             autocorr =       1.293860198314
              std dev =       0.568874256899
             le_variance =       0.323617920163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323644913798
                                         uncertainty =       0.002291480748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323644913798
                                         uncertainty =       0.002291480748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402254845
  error estimate for blocks of size 2^( 2) =       0.000415095333
  error estimate for blocks of size 2^( 3) =       0.000428830630
  error estimate for blocks of size 2^( 4) =       0.000442477060
  error estimate for blocks of size 2^( 5) =       0.000454166608
  error estimate for blocks of size 2^( 6) =       0.000463363951
  error estimate for blocks of size 2^( 7) =       0.000470219354

      target function =                  N/A
              le_mean =     -16.906284384337
             les_mean =     286.158557171342
             stat err =       0.000457556743
             autocorr =       1.293860198314
              std dev =       0.568874256899
             le_variance =       0.323617920163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906284384337        initial  <--
     1.4901e+67     1.4901e+68             0.0000e+00       -16.906284384337
     5.9605e+67     5.9605e+68             0.0000e+00       -16.906284384337
     2.3842e+68     2.3842e+69             0.0000e+00       -16.906284384337

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.8409
  </log>
  <optVariables href="H2O.s092.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.1014e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17
    reference variance = 0.313813
====================================================
  Execution time = 2.1142e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5222e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3990e-01
  Total weights = 1.951370495e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1327e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325673205656
                                         uncertainty =       0.002463724292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325673205656
                                         uncertainty =       0.002463724292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403660332
  error estimate for blocks of size 2^( 2) =       0.000416860723
  error estimate for blocks of size 2^( 3) =       0.000430144974
  error estimate for blocks of size 2^( 4) =       0.000441209262
  error estimate for blocks of size 2^( 5) =       0.000451769330
  error estimate for blocks of size 2^( 6) =       0.000459832135
  error estimate for blocks of size 2^( 7) =       0.000464400911

      target function =                  N/A
              le_mean =     -16.906565070287
             les_mean =     286.171845421156
             stat err =       0.000454302910
             autocorr =       1.266656601375
              std dev =       0.570861915871
             le_variance =       0.325883326992


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690656507029e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+68, overlap shift 1.4901e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906565070267       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906565070267       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906565070267       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+68 is 3.545296e-72

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+68, overlap shift 5.9605e+69 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906565070267       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906565070267       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906565070267       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+68 is 8.863241e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+69, overlap shift 2.3842e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906565070267       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906565070267       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906565070267       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+69 is 2.215810e-73

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.464609 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7286e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -16.9748
    reference variance = 0.243044
====================================================
  Execution time = 2.1191e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3981e-01
  Total weights = 1.9520e+06
  Execution time = 1.8829e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324749353310
                                         uncertainty =       0.002206356345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324749353310
                                         uncertainty =       0.002206356345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402916078
  error estimate for blocks of size 2^( 2) =       0.000415956746
  error estimate for blocks of size 2^( 3) =       0.000429869525
  error estimate for blocks of size 2^( 4) =       0.000443238018
  error estimate for blocks of size 2^( 5) =       0.000454901722
  error estimate for blocks of size 2^( 6) =       0.000465883093
  error estimate for blocks of size 2^( 7) =       0.000471373752

      target function =                  N/A
              le_mean =     -16.905565660422
             les_mean =     286.137958983717
             stat err =       0.000458849146
             autocorr =       1.296912453801
              std dev =       0.569809381808
             le_variance =       0.324682731596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324749353310
                                         uncertainty =       0.002206356345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324749353310
                                         uncertainty =       0.002206356345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402916078
  error estimate for blocks of size 2^( 2) =       0.000415956746
  error estimate for blocks of size 2^( 3) =       0.000429869525
  error estimate for blocks of size 2^( 4) =       0.000443238018
  error estimate for blocks of size 2^( 5) =       0.000454901722
  error estimate for blocks of size 2^( 6) =       0.000465883093
  error estimate for blocks of size 2^( 7) =       0.000471373752

      target function =                  N/A
              le_mean =     -16.905565660422
             les_mean =     286.137958983717
             stat err =       0.000458849146
             autocorr =       1.296912453801
              std dev =       0.569809381808
             le_variance =       0.324682731596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324749353310
                                         uncertainty =       0.002206356345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324749353310
                                         uncertainty =       0.002206356345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402916078
  error estimate for blocks of size 2^( 2) =       0.000415956746
  error estimate for blocks of size 2^( 3) =       0.000429869525
  error estimate for blocks of size 2^( 4) =       0.000443238018
  error estimate for blocks of size 2^( 5) =       0.000454901722
  error estimate for blocks of size 2^( 6) =       0.000465883093
  error estimate for blocks of size 2^( 7) =       0.000471373752

      target function =                  N/A
              le_mean =     -16.905565660422
             les_mean =     286.137958983717
             stat err =       0.000458849146
             autocorr =       1.296912453801
              std dev =       0.569809381808
             le_variance =       0.324682731596

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324749353310
                                         uncertainty =       0.002206356345

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324749353310
                                         uncertainty =       0.002206356345

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402916078
  error estimate for blocks of size 2^( 2) =       0.000415956746
  error estimate for blocks of size 2^( 3) =       0.000429869525
  error estimate for blocks of size 2^( 4) =       0.000443238018
  error estimate for blocks of size 2^( 5) =       0.000454901722
  error estimate for blocks of size 2^( 6) =       0.000465883093
  error estimate for blocks of size 2^( 7) =       0.000471373752

      target function =                  N/A
              le_mean =     -16.905565660422
             les_mean =     286.137958983717
             stat err =       0.000458849146
             autocorr =       1.296912453801
              std dev =       0.569809381808
             le_variance =       0.324682731596


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905565660422        initial  <--
     1.4901e+68     1.4901e+69             3.5453e-72       -16.905565660422
     5.9605e+68     5.9605e+69             8.8632e-73       -16.905565660422
     2.3842e+69     2.3842e+70             2.2158e-73       -16.905565660422

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7068
  </log>
  <optVariables href="H2O.s093.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7999e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.955
    reference variance = 0.253662
====================================================
  Execution time = 2.1301e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5225e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3722e-01
  Total weights = 1.951589486e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322835607755
                                         uncertainty =       0.002140287541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322835607755
                                         uncertainty =       0.002140287541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401766497
  error estimate for blocks of size 2^( 2) =       0.000414466010
  error estimate for blocks of size 2^( 3) =       0.000427337278
  error estimate for blocks of size 2^( 4) =       0.000440113999
  error estimate for blocks of size 2^( 5) =       0.000451086600
  error estimate for blocks of size 2^( 6) =       0.000458515661
  error estimate for blocks of size 2^( 7) =       0.000464366210

      target function =                  N/A
              le_mean =     -16.906738040810
             les_mean =     286.175009068644
             stat err =       0.000453520617
             autocorr =       1.274226503714
              std dev =       0.568183628303
             le_variance =       0.322832635472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690673804081e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+69, overlap shift 1.4901e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906738040841       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906738040841       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+69, overlap shift 5.9605e+70 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906738040841       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906738040841       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+69 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+70, overlap shift 2.3842e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906738040841       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906738040841       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+70 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.465796 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7407e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -16.9382
    reference variance = 0.255644
====================================================
  Execution time = 2.0744e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3716e-01
  Total weights = 1.9519e+06
  Execution time = 1.9161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325705350624
                                         uncertainty =       0.004037427064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325705350624
                                         uncertainty =       0.004037427064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403524327
  error estimate for blocks of size 2^( 2) =       0.000416336464
  error estimate for blocks of size 2^( 3) =       0.000429657246
  error estimate for blocks of size 2^( 4) =       0.000442372736
  error estimate for blocks of size 2^( 5) =       0.000452931334
  error estimate for blocks of size 2^( 6) =       0.000460233665
  error estimate for blocks of size 2^( 7) =       0.000466104834

      target function =                  N/A
              le_mean =     -16.905976008555
             les_mean =     286.149182182576
             stat err =       0.000455410642
             autocorr =       1.273699290429
              std dev =       0.570669575822
             le_variance =       0.325663764769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325705350624
                                         uncertainty =       0.004037427064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325705350624
                                         uncertainty =       0.004037427064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403524327
  error estimate for blocks of size 2^( 2) =       0.000416336464
  error estimate for blocks of size 2^( 3) =       0.000429657246
  error estimate for blocks of size 2^( 4) =       0.000442372736
  error estimate for blocks of size 2^( 5) =       0.000452931334
  error estimate for blocks of size 2^( 6) =       0.000460233665
  error estimate for blocks of size 2^( 7) =       0.000466104834

      target function =                  N/A
              le_mean =     -16.905976008555
             les_mean =     286.149182182576
             stat err =       0.000455410642
             autocorr =       1.273699290429
              std dev =       0.570669575822
             le_variance =       0.325663764769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325705350624
                                         uncertainty =       0.004037427064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325705350624
                                         uncertainty =       0.004037427064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403524327
  error estimate for blocks of size 2^( 2) =       0.000416336464
  error estimate for blocks of size 2^( 3) =       0.000429657246
  error estimate for blocks of size 2^( 4) =       0.000442372736
  error estimate for blocks of size 2^( 5) =       0.000452931334
  error estimate for blocks of size 2^( 6) =       0.000460233665
  error estimate for blocks of size 2^( 7) =       0.000466104834

      target function =                  N/A
              le_mean =     -16.905976008555
             les_mean =     286.149182182576
             stat err =       0.000455410642
             autocorr =       1.273699290429
              std dev =       0.570669575822
             le_variance =       0.325663764769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325705350624
                                         uncertainty =       0.004037427064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325705350624
                                         uncertainty =       0.004037427064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403524327
  error estimate for blocks of size 2^( 2) =       0.000416336464
  error estimate for blocks of size 2^( 3) =       0.000429657246
  error estimate for blocks of size 2^( 4) =       0.000442372736
  error estimate for blocks of size 2^( 5) =       0.000452931334
  error estimate for blocks of size 2^( 6) =       0.000460233665
  error estimate for blocks of size 2^( 7) =       0.000466104834

      target function =                  N/A
              le_mean =     -16.905976008555
             les_mean =     286.149182182576
             stat err =       0.000455410642
             autocorr =       1.273699290429
              std dev =       0.570669575822
             le_variance =       0.325663764769


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905976008555        initial  <--
     1.4901e+69     1.4901e+70             0.0000e+00       -16.905976008555
     5.9605e+69     5.9605e+70             0.0000e+00       -16.905976008555
     2.3842e+70     2.3842e+71             0.0000e+00       -16.905976008555

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2754
  </log>
  <optVariables href="H2O.s094.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7688e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.9781
    reference variance = 0.440878
====================================================
  Execution time = 2.1351e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5232e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4515e-01
  Total weights = 1.952051137e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330097456740
                                         uncertainty =       0.003496175181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330097456740
                                         uncertainty =       0.003496175181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406227825
  error estimate for blocks of size 2^( 2) =       0.000418881371
  error estimate for blocks of size 2^( 3) =       0.000432219729
  error estimate for blocks of size 2^( 4) =       0.000443413238
  error estimate for blocks of size 2^( 5) =       0.000453359887
  error estimate for blocks of size 2^( 6) =       0.000460653283
  error estimate for blocks of size 2^( 7) =       0.000466770783

      target function =                  N/A
              le_mean =     -16.906336653431
             les_mean =     286.169367692835
             stat err =       0.000456049298
             autocorr =       1.260329920629
              std dev =       0.574492900152
             le_variance =       0.330042092325


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690633665343e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+70, overlap shift 1.4901e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906336653433       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906336653433       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906336653433       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+70 is 3.951774e-74

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+70, overlap shift 5.9605e+71 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906336653433       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906336653433       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906336653433       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+70 is 9.879435e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+71, overlap shift 2.3842e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906336653433       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906336653433       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906336653433       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906336653433       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906336653433       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+71 is 2.727167e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.467464 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7400e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -16.8571
    reference variance = 0.207041
====================================================
  Execution time = 2.0800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4105e-01
  Total weights = 1.9516e+06
  Execution time = 1.8828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328143465955
                                         uncertainty =       0.003745010602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328143465955
                                         uncertainty =       0.003745010602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405056677
  error estimate for blocks of size 2^( 2) =       0.000417719337
  error estimate for blocks of size 2^( 3) =       0.000430101126
  error estimate for blocks of size 2^( 4) =       0.000441657311
  error estimate for blocks of size 2^( 5) =       0.000450661350
  error estimate for blocks of size 2^( 6) =       0.000457038655
  error estimate for blocks of size 2^( 7) =       0.000461006635

      target function =                  N/A
              le_mean =     -16.906430435336
             les_mean =     286.168444165308
             stat err =       0.000452590988
             autocorr =       1.248476041880
              std dev =       0.572836645846
             le_variance =       0.328141822824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328143465955
                                         uncertainty =       0.003745010602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328143465955
                                         uncertainty =       0.003745010602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405056677
  error estimate for blocks of size 2^( 2) =       0.000417719337
  error estimate for blocks of size 2^( 3) =       0.000430101126
  error estimate for blocks of size 2^( 4) =       0.000441657311
  error estimate for blocks of size 2^( 5) =       0.000450661350
  error estimate for blocks of size 2^( 6) =       0.000457038655
  error estimate for blocks of size 2^( 7) =       0.000461006635

      target function =                  N/A
              le_mean =     -16.906430435336
             les_mean =     286.168444165308
             stat err =       0.000452590988
             autocorr =       1.248476041880
              std dev =       0.572836645846
             le_variance =       0.328141822824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328143465955
                                         uncertainty =       0.003745010602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328143465955
                                         uncertainty =       0.003745010602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405056677
  error estimate for blocks of size 2^( 2) =       0.000417719337
  error estimate for blocks of size 2^( 3) =       0.000430101126
  error estimate for blocks of size 2^( 4) =       0.000441657311
  error estimate for blocks of size 2^( 5) =       0.000450661350
  error estimate for blocks of size 2^( 6) =       0.000457038655
  error estimate for blocks of size 2^( 7) =       0.000461006635

      target function =                  N/A
              le_mean =     -16.906430435336
             les_mean =     286.168444165308
             stat err =       0.000452590988
             autocorr =       1.248476041880
              std dev =       0.572836645846
             le_variance =       0.328141822824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328143465955
                                         uncertainty =       0.003745010602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328143465955
                                         uncertainty =       0.003745010602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405056677
  error estimate for blocks of size 2^( 2) =       0.000417719337
  error estimate for blocks of size 2^( 3) =       0.000430101126
  error estimate for blocks of size 2^( 4) =       0.000441657311
  error estimate for blocks of size 2^( 5) =       0.000450661350
  error estimate for blocks of size 2^( 6) =       0.000457038655
  error estimate for blocks of size 2^( 7) =       0.000461006635

      target function =                  N/A
              le_mean =     -16.906430435336
             les_mean =     286.168444165308
             stat err =       0.000452590988
             autocorr =       1.248476041880
              std dev =       0.572836645846
             le_variance =       0.328141822824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906430435336        initial  <--
     1.4901e+70     1.4901e+71             3.9518e-74       -16.906430435336
     5.9605e+70     5.9605e+71             9.8794e-75       -16.906430435336
     2.3842e+71     2.3842e+72             2.7272e-75       -16.906430435336

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.3353
  </log>
  <optVariables href="H2O.s095.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9502
    reference variance = 0.355016
====================================================
  Execution time = 2.1159e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5236e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3847e-01
  Total weights = 1.951687397e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0664e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325042611090
                                         uncertainty =       0.002387386295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325042611090
                                         uncertainty =       0.002387386295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403149682
  error estimate for blocks of size 2^( 2) =       0.000416063934
  error estimate for blocks of size 2^( 3) =       0.000429708604
  error estimate for blocks of size 2^( 4) =       0.000441458832
  error estimate for blocks of size 2^( 5) =       0.000451450485
  error estimate for blocks of size 2^( 6) =       0.000460583548
  error estimate for blocks of size 2^( 7) =       0.000466730459

      target function =                  N/A
              le_mean =     -16.905986959647
             les_mean =     286.150861692612
             stat err =       0.000455055831
             autocorr =       1.274080072105
              std dev =       0.570139748512
             le_variance =       0.325059332834


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598695965e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+71, overlap shift 1.4901e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905986959625       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905986959625       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905986959625       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+71 is 2.340098e-75

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+71, overlap shift 5.9605e+72 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905986959625       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905986959625       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905986959625       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+71 is 5.850244e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+72, overlap shift 2.3842e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905986959625       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905986959625       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905986959625       residual = 1.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+72 is 1.462561e-76

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.468958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7235e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -16.9006
    reference variance = 0.205561
====================================================
  Execution time = 2.1136e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4162e-01
  Total weights = 1.9517e+06
  Execution time = 1.8809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328612420464
                                         uncertainty =       0.002627644314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328612420464
                                         uncertainty =       0.002627644314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405388594
  error estimate for blocks of size 2^( 2) =       0.000417876208
  error estimate for blocks of size 2^( 3) =       0.000430975167
  error estimate for blocks of size 2^( 4) =       0.000443311440
  error estimate for blocks of size 2^( 5) =       0.000453891454
  error estimate for blocks of size 2^( 6) =       0.000462469244
  error estimate for blocks of size 2^( 7) =       0.000466893377

      target function =                  N/A
              le_mean =     -16.905988467127
             les_mean =     286.154070723769
             stat err =       0.000456641379
             autocorr =       1.268841795122
              std dev =       0.573306047045
             le_variance =       0.328679823578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328612420464
                                         uncertainty =       0.002627644314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328612420464
                                         uncertainty =       0.002627644314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405388594
  error estimate for blocks of size 2^( 2) =       0.000417876208
  error estimate for blocks of size 2^( 3) =       0.000430975167
  error estimate for blocks of size 2^( 4) =       0.000443311440
  error estimate for blocks of size 2^( 5) =       0.000453891454
  error estimate for blocks of size 2^( 6) =       0.000462469244
  error estimate for blocks of size 2^( 7) =       0.000466893377

      target function =                  N/A
              le_mean =     -16.905988467127
             les_mean =     286.154070723769
             stat err =       0.000456641379
             autocorr =       1.268841795122
              std dev =       0.573306047045
             le_variance =       0.328679823578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328612420464
                                         uncertainty =       0.002627644314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328612420464
                                         uncertainty =       0.002627644314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405388594
  error estimate for blocks of size 2^( 2) =       0.000417876208
  error estimate for blocks of size 2^( 3) =       0.000430975167
  error estimate for blocks of size 2^( 4) =       0.000443311440
  error estimate for blocks of size 2^( 5) =       0.000453891454
  error estimate for blocks of size 2^( 6) =       0.000462469244
  error estimate for blocks of size 2^( 7) =       0.000466893377

      target function =                  N/A
              le_mean =     -16.905988467127
             les_mean =     286.154070723769
             stat err =       0.000456641379
             autocorr =       1.268841795122
              std dev =       0.573306047045
             le_variance =       0.328679823578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328612420464
                                         uncertainty =       0.002627644314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328612420464
                                         uncertainty =       0.002627644314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405388594
  error estimate for blocks of size 2^( 2) =       0.000417876208
  error estimate for blocks of size 2^( 3) =       0.000430975167
  error estimate for blocks of size 2^( 4) =       0.000443311440
  error estimate for blocks of size 2^( 5) =       0.000453891454
  error estimate for blocks of size 2^( 6) =       0.000462469244
  error estimate for blocks of size 2^( 7) =       0.000466893377

      target function =                  N/A
              le_mean =     -16.905988467127
             les_mean =     286.154070723769
             stat err =       0.000456641379
             autocorr =       1.268841795122
              std dev =       0.573306047045
             le_variance =       0.328679823578


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905988467127        initial  <--
     1.4901e+71     1.4901e+72             2.3401e-75       -16.905988467127
     5.9605e+71     5.9605e+72             5.8502e-76       -16.905988467127
     2.3842e+72     2.3842e+73             1.4626e-76       -16.905988467127

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6721
  </log>
  <optVariables href="H2O.s096.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7914e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.9037
    reference variance = 0.224315
====================================================
  Execution time = 2.1143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3563e-01
  Total weights = 1.951684705e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323981504663
                                         uncertainty =       0.003047761528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323981504663
                                         uncertainty =       0.003047761528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402425738
  error estimate for blocks of size 2^( 2) =       0.000415213428
  error estimate for blocks of size 2^( 3) =       0.000428275996
  error estimate for blocks of size 2^( 4) =       0.000440765823
  error estimate for blocks of size 2^( 5) =       0.000451191122
  error estimate for blocks of size 2^( 6) =       0.000459804683
  error estimate for blocks of size 2^( 7) =       0.000464329522

      target function =                  N/A
              le_mean =     -16.906636157340
             les_mean =     286.169974676765
             stat err =       0.000454022787
             autocorr =       1.272869272185
              std dev =       0.569115936833
             le_variance =       0.323892949557


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663615734e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+72, overlap shift 1.4901e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906636157334       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906636157334       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+72, overlap shift 5.9605e+73 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906636157334       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906636157334       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+72 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+73, overlap shift 2.3842e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906636157334       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906636157334       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+73 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.470156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7314e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -16.869
    reference variance = 0.218574
====================================================
  Execution time = 2.1001e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3257e-01
  Total weights = 1.9516e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321776517259
                                         uncertainty =       0.001978576804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321776517259
                                         uncertainty =       0.001978576804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401079514
  error estimate for blocks of size 2^( 2) =       0.000414309093
  error estimate for blocks of size 2^( 3) =       0.000427812289
  error estimate for blocks of size 2^( 4) =       0.000440670122
  error estimate for blocks of size 2^( 5) =       0.000451628533
  error estimate for blocks of size 2^( 6) =       0.000462915104
  error estimate for blocks of size 2^( 7) =       0.000468484154

      target function =                  N/A
              le_mean =     -16.906346356447
             les_mean =     286.157114691251
             stat err =       0.000455924478
             autocorr =       1.292185489373
              std dev =       0.567212087790
             le_variance =       0.321729552535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321776517259
                                         uncertainty =       0.001978576804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321776517259
                                         uncertainty =       0.001978576804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401079514
  error estimate for blocks of size 2^( 2) =       0.000414309093
  error estimate for blocks of size 2^( 3) =       0.000427812289
  error estimate for blocks of size 2^( 4) =       0.000440670122
  error estimate for blocks of size 2^( 5) =       0.000451628533
  error estimate for blocks of size 2^( 6) =       0.000462915104
  error estimate for blocks of size 2^( 7) =       0.000468484154

      target function =                  N/A
              le_mean =     -16.906346356447
             les_mean =     286.157114691251
             stat err =       0.000455924478
             autocorr =       1.292185489373
              std dev =       0.567212087790
             le_variance =       0.321729552535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321776517259
                                         uncertainty =       0.001978576804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321776517259
                                         uncertainty =       0.001978576804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401079514
  error estimate for blocks of size 2^( 2) =       0.000414309093
  error estimate for blocks of size 2^( 3) =       0.000427812289
  error estimate for blocks of size 2^( 4) =       0.000440670122
  error estimate for blocks of size 2^( 5) =       0.000451628533
  error estimate for blocks of size 2^( 6) =       0.000462915104
  error estimate for blocks of size 2^( 7) =       0.000468484154

      target function =                  N/A
              le_mean =     -16.906346356447
             les_mean =     286.157114691251
             stat err =       0.000455924478
             autocorr =       1.292185489373
              std dev =       0.567212087790
             le_variance =       0.321729552535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321776517259
                                         uncertainty =       0.001978576804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321776517259
                                         uncertainty =       0.001978576804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401079514
  error estimate for blocks of size 2^( 2) =       0.000414309093
  error estimate for blocks of size 2^( 3) =       0.000427812289
  error estimate for blocks of size 2^( 4) =       0.000440670122
  error estimate for blocks of size 2^( 5) =       0.000451628533
  error estimate for blocks of size 2^( 6) =       0.000462915104
  error estimate for blocks of size 2^( 7) =       0.000468484154

      target function =                  N/A
              le_mean =     -16.906346356447
             les_mean =     286.157114691251
             stat err =       0.000455924478
             autocorr =       1.292185489373
              std dev =       0.567212087790
             le_variance =       0.321729552535


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906346356447        initial  <--
     1.4901e+72     1.4901e+73             0.0000e+00       -16.906346356447
     5.9605e+72     5.9605e+73             0.0000e+00       -16.906346356447
     2.3842e+73     2.3842e+74             0.0000e+00       -16.906346356447

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5194
  </log>
  <optVariables href="H2O.s097.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.9631
    reference variance = 0.356156
====================================================
  Execution time = 2.3941e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5259e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3740e-01
  Total weights = 1.952049475e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.1697e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492495978
                                         uncertainty =       0.002086532138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324492495978
                                         uncertainty =       0.002086532138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402802835
  error estimate for blocks of size 2^( 2) =       0.000415777547
  error estimate for blocks of size 2^( 3) =       0.000429385809
  error estimate for blocks of size 2^( 4) =       0.000442746182
  error estimate for blocks of size 2^( 5) =       0.000454142827
  error estimate for blocks of size 2^( 6) =       0.000462711103
  error estimate for blocks of size 2^( 7) =       0.000469134292

      target function =                  N/A
              le_mean =     -16.905680589597
             les_mean =     286.139441159426
             stat err =       0.000457183601
             autocorr =       1.288238430396
              std dev =       0.569649231968
             le_variance =       0.324500247482


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568058960e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+73, overlap shift 1.4901e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905680589581       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905680589581       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+73 is 1.829026e-77

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+73, overlap shift 5.9605e+74 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905680589581       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905680589581       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+73 is 4.572566e-78

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+74, overlap shift 2.3842e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905680589581       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905680589581       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+74 is 1.143141e-78

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.471331 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 3.0121e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -16.8605
    reference variance = 0.217209
====================================================
  Execution time = 2.0800e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3879e-01
  Total weights = 1.9514e+06
  Execution time = 1.8794e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324837465936
                                         uncertainty =       0.002651396285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324837465936
                                         uncertainty =       0.002651396285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402968214
  error estimate for blocks of size 2^( 2) =       0.000415619765
  error estimate for blocks of size 2^( 3) =       0.000428725021
  error estimate for blocks of size 2^( 4) =       0.000440814579
  error estimate for blocks of size 2^( 5) =       0.000449915653
  error estimate for blocks of size 2^( 6) =       0.000459904390
  error estimate for blocks of size 2^( 7) =       0.000466071690

      target function =                  N/A
              le_mean =     -16.905437184730
             les_mean =     286.132596137340
             stat err =       0.000454176578
             autocorr =       1.270304647436
              std dev =       0.569883113079
             le_variance =       0.324766762572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324837465936
                                         uncertainty =       0.002651396285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324837465936
                                         uncertainty =       0.002651396285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402968214
  error estimate for blocks of size 2^( 2) =       0.000415619765
  error estimate for blocks of size 2^( 3) =       0.000428725021
  error estimate for blocks of size 2^( 4) =       0.000440814579
  error estimate for blocks of size 2^( 5) =       0.000449915653
  error estimate for blocks of size 2^( 6) =       0.000459904390
  error estimate for blocks of size 2^( 7) =       0.000466071690

      target function =                  N/A
              le_mean =     -16.905437184730
             les_mean =     286.132596137340
             stat err =       0.000454176578
             autocorr =       1.270304647436
              std dev =       0.569883113079
             le_variance =       0.324766762572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324837465936
                                         uncertainty =       0.002651396285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324837465936
                                         uncertainty =       0.002651396285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402968214
  error estimate for blocks of size 2^( 2) =       0.000415619765
  error estimate for blocks of size 2^( 3) =       0.000428725021
  error estimate for blocks of size 2^( 4) =       0.000440814579
  error estimate for blocks of size 2^( 5) =       0.000449915653
  error estimate for blocks of size 2^( 6) =       0.000459904390
  error estimate for blocks of size 2^( 7) =       0.000466071690

      target function =                  N/A
              le_mean =     -16.905437184730
             les_mean =     286.132596137340
             stat err =       0.000454176578
             autocorr =       1.270304647436
              std dev =       0.569883113079
             le_variance =       0.324766762572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324837465936
                                         uncertainty =       0.002651396285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.324837465936
                                         uncertainty =       0.002651396285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402968214
  error estimate for blocks of size 2^( 2) =       0.000415619765
  error estimate for blocks of size 2^( 3) =       0.000428725021
  error estimate for blocks of size 2^( 4) =       0.000440814579
  error estimate for blocks of size 2^( 5) =       0.000449915653
  error estimate for blocks of size 2^( 6) =       0.000459904390
  error estimate for blocks of size 2^( 7) =       0.000466071690

      target function =                  N/A
              le_mean =     -16.905437184730
             les_mean =     286.132596137340
             stat err =       0.000454176578
             autocorr =       1.270304647436
              std dev =       0.569883113079
             le_variance =       0.324766762572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905437184730        initial  <--
     1.4901e+73     1.4901e+74             1.8290e-77       -16.905437184730
     5.9605e+73     5.9605e+74             4.5726e-78       -16.905437184730
     2.3842e+74     2.3842e+75             1.1431e-78       -16.905437184730

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2824
  </log>
  <optVariables href="H2O.s098.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 6.0409e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.8675
    reference variance = 0.237826
====================================================
  Execution time = 2.1143e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5266e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3639e-01
  Total weights = 1.952081902e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320363705225
                                         uncertainty =       0.002121374259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320363705225
                                         uncertainty =       0.002121374259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400232553
  error estimate for blocks of size 2^( 2) =       0.000413262341
  error estimate for blocks of size 2^( 3) =       0.000426227325
  error estimate for blocks of size 2^( 4) =       0.000438561592
  error estimate for blocks of size 2^( 5) =       0.000447851566
  error estimate for blocks of size 2^( 6) =       0.000454792265
  error estimate for blocks of size 2^( 7) =       0.000459992826

      target function =                  N/A
              le_mean =     -16.907093086385
             les_mean =     286.186187716635
             stat err =       0.000450299562
             autocorr =       1.265838297993
              std dev =       0.566014304788
             le_variance =       0.320372193224


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690709308638e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 124
Check correct_vf_var_size: 375, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+74, overlap shift 1.4901e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907093086365       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907093086365       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907093086365       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 1.4901e+74 is 2.779787e-78

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+74, overlap shift 5.9605e+75 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907093086365       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907093086365       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907093086365       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 5.9605e+74 is 6.949469e-79

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3842e+75, overlap shift 2.3842e+76 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907093086365       residual = 2.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907093086365       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 125 and evec_eigen.size(): 125
The largest weight on the derivative vector for shift 2.3842e+75 is 1.737367e-79

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.472705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 125 and numParams is: 124

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7201e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -16.9006
    reference variance = 0.290968
====================================================
  Execution time = 2.1189e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3499e-01
  Total weights = 1.9518e+06
  Execution time = 1.8781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320939000368
                                         uncertainty =       0.002056773314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320939000368
                                         uncertainty =       0.002056773314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400616592
  error estimate for blocks of size 2^( 2) =       0.000413571741
  error estimate for blocks of size 2^( 3) =       0.000426645143
  error estimate for blocks of size 2^( 4) =       0.000438940459
  error estimate for blocks of size 2^( 5) =       0.000449202501
  error estimate for blocks of size 2^( 6) =       0.000456051504
  error estimate for blocks of size 2^( 7) =       0.000459782460

      target function =                  N/A
              le_mean =     -16.906432592970
             les_mean =     286.162449167908
             stat err =       0.000450994231
             autocorr =       1.267313635848
              std dev =       0.566557418092
             le_variance =       0.320987307995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320939000368
                                         uncertainty =       0.002056773314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320939000368
                                         uncertainty =       0.002056773314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400616592
  error estimate for blocks of size 2^( 2) =       0.000413571741
  error estimate for blocks of size 2^( 3) =       0.000426645143
  error estimate for blocks of size 2^( 4) =       0.000438940459
  error estimate for blocks of size 2^( 5) =       0.000449202501
  error estimate for blocks of size 2^( 6) =       0.000456051504
  error estimate for blocks of size 2^( 7) =       0.000459782460

      target function =                  N/A
              le_mean =     -16.906432592970
             les_mean =     286.162449167908
             stat err =       0.000450994231
             autocorr =       1.267313635848
              std dev =       0.566557418092
             le_variance =       0.320987307995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320939000368
                                         uncertainty =       0.002056773314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320939000368
                                         uncertainty =       0.002056773314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400616592
  error estimate for blocks of size 2^( 2) =       0.000413571741
  error estimate for blocks of size 2^( 3) =       0.000426645143
  error estimate for blocks of size 2^( 4) =       0.000438940459
  error estimate for blocks of size 2^( 5) =       0.000449202501
  error estimate for blocks of size 2^( 6) =       0.000456051504
  error estimate for blocks of size 2^( 7) =       0.000459782460

      target function =                  N/A
              le_mean =     -16.906432592970
             les_mean =     286.162449167908
             stat err =       0.000450994231
             autocorr =       1.267313635848
              std dev =       0.566557418092
             le_variance =       0.320987307995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320939000368
                                         uncertainty =       0.002056773314

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.320939000368
                                         uncertainty =       0.002056773314

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400616592
  error estimate for blocks of size 2^( 2) =       0.000413571741
  error estimate for blocks of size 2^( 3) =       0.000426645143
  error estimate for blocks of size 2^( 4) =       0.000438940459
  error estimate for blocks of size 2^( 5) =       0.000449202501
  error estimate for blocks of size 2^( 6) =       0.000456051504
  error estimate for blocks of size 2^( 7) =       0.000459782460

      target function =                  N/A
              le_mean =     -16.906432592970
             les_mean =     286.162449167908
             stat err =       0.000450994231
             autocorr =       1.267313635848
              std dev =       0.566557418092
             le_variance =       0.320987307995


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906432592970        initial  <--
     1.4901e+74     1.4901e+75             2.7798e-78       -16.906432592970
     5.9605e+74     5.9605e+75             6.9495e-79       -16.906432592970
     2.3842e+75     2.3842e+76             1.7374e-79       -16.906432592970

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6867
  </log>
  <optVariables href="H2O.s099.opt.xml">
   uu_0                 3.123012e-01 1 1  ON 0
   uu_1                 1.451246e-01 1 1  ON 1
   uu_2                 4.323384e-02 1 1  ON 2
   uu_3                -1.931156e-02 1 1  ON 3
   uu_4                -6.504874e-02 1 1  ON 4
   uu_5                -1.000818e-01 1 1  ON 5
   uu_6                -1.276646e-01 1 1  ON 6
   uu_7                -1.411859e-01 1 1  ON 7
   uu_8                -1.339686e-01 1 1  ON 8
   uu_9                -1.024297e-01 1 1  ON 9
   ud_0                 4.467481e-01 1 1  ON 10
   ud_1                 1.810944e-01 1 1  ON 11
   ud_2                 6.077585e-02 1 1  ON 12
   ud_3                -1.007794e-02 1 1  ON 13
   ud_4                -6.682635e-02 1 1  ON 14
   ud_5                -1.082279e-01 1 1  ON 15
   ud_6                -1.350234e-01 1 1  ON 16
   ud_7                -1.508640e-01 1 1  ON 17
   ud_8                -1.511156e-01 1 1  ON 18
   ud_9                -1.401974e-01 1 1  ON 19
   eO_0                -7.496821e-01 1 1  ON 20
   eO_1                -4.292632e-01 1 1  ON 21
   eO_2                -1.980893e-02 1 1  ON 22
   eO_3                 2.911379e-01 1 1  ON 23
   eO_4                 5.151693e-01 1 1  ON 24
   eO_5                 4.767251e-01 1 1  ON 25
   eO_6                 2.500538e-01 1 1  ON 26
   eO_7                -4.636961e-02 1 1  ON 27
   eO_8                -2.141809e-01 1 1  ON 28
   eO_9                -7.452792e-02 1 1  ON 29
  eH1_0                -2.521366e-01 1 1  ON 30
  eH1_1                -1.455463e-01 1 1  ON 31
  eH1_2                -9.554946e-02 1 1  ON 32
  eH1_3                -4.022421e-02 1 1  ON 33
  eH1_4                 8.953759e-03 1 1  ON 34
  eH1_5                 4.366640e-02 1 1  ON 35
  eH1_6                 1.011305e-01 1 1  ON 36
  eH1_7                 1.543277e-01 1 1  ON 37
  eH1_8                 1.715913e-01 1 1  ON 38
  eH1_9                 5.705223e-02 1 1  ON 39
  eH2_0                -2.497609e-01 1 1  ON 40
  eH2_1                -1.422525e-01 1 1  ON 41
  eH2_2                -9.244371e-02 1 1  ON 42
  eH2_3                -3.694097e-02 1 1  ON 43
  eH2_4                 1.246861e-02 1 1  ON 44
  eH2_5                 4.746844e-02 1 1  ON 45
  eH2_6                 1.043273e-01 1 1  ON 46
  eH2_7                 1.546907e-01 1 1  ON 47
  eH2_8                 1.751962e-01 1 1  ON 48
  eH2_9                 4.361230e-02 1 1  ON 49
ci_0001                 7.012144e-01 3 1  ON 50
ci_0002                 7.005373e-01 3 1  ON 51
ci_0003                -2.733058e-02 3 1  ON 52
ci_0004                -2.710841e-02 3 1  ON 53
ci_0005                -3.623378e-02 3 1  ON 54
ci_0006                -3.638887e-02 3 1  ON 55
ci_0007                -2.130799e-02 3 1  ON 56
ci_0008                -2.160518e-02 3 1  ON 57
ci_0009                -1.736140e-02 3 1  ON 58
ci_0010                -1.725864e-02 3 1  ON 59
ci_0011                -1.138254e-02 3 1  ON 60
ci_0012                -1.252634e-02 3 1  ON 61
ci_0013                 1.300328e-02 3 1  ON 62
ci_0014                 1.381532e-02 3 1  ON 63
ci_0015                 1.310141e-02 3 1  ON 64
ci_0016                 1.318530e-02 3 1  ON 65
ci_0017                 1.144897e-02 3 1  ON 66
ci_0018                 1.079218e-02 3 1  ON 67
ci_0019                 1.224395e-02 3 1  ON 68
ci_0020                 1.108327e-02 3 1  ON 69
ci_0021                -1.618593e-03 3 1  ON 70
ci_0022                -8.320186e-04 3 1  ON 71
ci_0023                -1.069834e-02 3 1  ON 72
ci_0024                -1.039590e-02 3 1  ON 73
ci_0025                -1.084948e-02 3 1  ON 74
ci_0026                -1.092518e-02 3 1  ON 75
ci_0027                -1.151258e-02 3 1  ON 76
ci_0028                -1.175368e-02 3 1  ON 77
ci_0029                -1.087467e-02 3 1  ON 78
ci_0030                -1.047138e-02 3 1  ON 79
ci_0031                 2.056726e-02 3 1  ON 80
ci_0032                 2.122217e-02 3 1  ON 81
ci_0033                 1.050420e-02 3 1  ON 82
ci_0034                 9.991774e-03 3 1  ON 83
ci_0035                 7.434396e-03 3 1  ON 84
ci_0036                 7.272297e-03 3 1  ON 85
ci_0037                -1.005928e-02 3 1  ON 86
ci_0038                -1.106069e-02 3 1  ON 87
ci_0039                -2.556386e-03 3 1  ON 88
ci_0040                -2.593759e-03 3 1  ON 89
ci_0041                 6.528329e-03 3 1  ON 90
ci_0042                 7.350894e-03 3 1  ON 91
ci_0043                -1.841439e-02 3 1  ON 92
ci_0044                -1.926462e-02 3 1  ON 93
ci_0045                 7.894040e-03 3 1  ON 94
ci_0046                 8.891809e-03 3 1  ON 95
ci_0047                -1.864948e-03 3 1  ON 96
ci_0048                -1.939927e-03 3 1  ON 97
ci_0049                -5.836101e-03 3 1  ON 98
ci_0050                -5.975173e-03 3 1  ON 99
ci_0051                -3.323579e-03 3 1  ON 100
ci_0052                -3.557431e-03 3 1  ON 101
ci_0053                -4.467078e-03 3 1  ON 102
ci_0054                -4.780390e-03 3 1  ON 103
ci_0055                 5.579926e-03 3 1  ON 104
ci_0056                 6.544847e-03 3 1  ON 105
ci_0057                 4.392885e-03 3 1  ON 106
ci_0058                 5.181283e-03 3 1  ON 107
ci_0059                -4.829203e-03 3 1  ON 108
ci_0060                -4.388235e-03 3 1  ON 109
ci_0061                -4.735413e-03 3 1  ON 110
ci_0062                -3.928743e-03 3 1  ON 111
ci_0063                -8.115234e-03 3 1  ON 112
ci_0064                -8.944092e-03 3 1  ON 113
ci_0065                -5.327625e-03 3 1  ON 114
ci_0066                -5.391197e-03 3 1  ON 115
ci_0067                -4.626618e-03 3 1  ON 116
ci_0068                -5.053515e-03 3 1  ON 117
ci_0069                 4.727120e-03 3 1  ON 118
ci_0070                 4.299139e-03 3 1  ON 119
ci_0071                 5.847582e-04 3 1  ON 120
ci_0072                -5.203963e-04 3 1  ON 121
ci_0073                 4.116028e-03 3 1  ON 122
ci_0074                 4.122665e-03 3 1  ON 123
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7913e+01 secs
  Total Execution time = 5.8527e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
