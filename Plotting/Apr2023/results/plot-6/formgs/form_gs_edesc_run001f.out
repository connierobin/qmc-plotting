Rank =    0  Free Memory = 87533 MB
Rank =    1  Free Memory = 87533 MB
Rank =    2  Free Memory = 87533 MB
Rank =    3  Free Memory = 87533 MB
Rank =    4  Free Memory = 87533 MB
Rank =    5  Free Memory = 87532 MB
Rank =    6  Free Memory = 87532 MB
Rank =    7  Free Memory = 87532 MB
Rank =    8  Free Memory = 87532 MB
Rank =    9  Free Memory = 87532 MB
Rank =   10  Free Memory = 87532 MB
Rank =   11  Free Memory = 87531 MB
Rank =   12  Free Memory = 87531 MB
Rank =   13  Free Memory = 87531 MB
Rank =   14  Free Memory = 87530 MB
Rank =   15  Free Memory = 87518 MB
Rank =   16  Free Memory = 87518 MB
Rank =   17  Free Memory = 87518 MB
Rank =   18  Free Memory = 87518 MB
Rank =   19  Free Memory = 87518 MB
Rank =   20  Free Memory = 87518 MB
Rank =   21  Free Memory = 87518 MB
Rank =   22  Free Memory = 87518 MB
Rank =   23  Free Memory = 87518 MB
Rank =   24  Free Memory = 87518 MB
Rank =   25  Free Memory = 87518 MB
Rank =   26  Free Memory = 87518 MB
Rank =   27  Free Memory = 87518 MB
Rank =   28  Free Memory = 87518 MB
Rank =   29  Free Memory = 87517 MB
Rank =   30  Free Memory = 87517 MB
Rank =   31  Free Memory = 87517 MB
Rank =   32  Free Memory = 88285 MB
Rank =   33  Free Memory = 88285 MB
Rank =   34  Free Memory = 88285 MB
Rank =   35  Free Memory = 88285 MB
Rank =   36  Free Memory = 88285 MB
Rank =   37  Free Memory = 88285 MB
Rank =   38  Free Memory = 88285 MB
Rank =   39  Free Memory = 88285 MB
Rank =   40  Free Memory = 88285 MB
Rank =   41  Free Memory = 88285 MB
Rank =   42  Free Memory = 88285 MB
Rank =   43  Free Memory = 88285 MB
Rank =   44  Free Memory = 88285 MB
Rank =   45  Free Memory = 88285 MB
Rank =   46  Free Memory = 88285 MB
Rank =   47  Free Memory = 88285 MB
Rank =   48  Free Memory = 88285 MB
Rank =   49  Free Memory = 88285 MB
Rank =   50  Free Memory = 88285 MB
Rank =   51  Free Memory = 88285 MB
Rank =   52  Free Memory = 88285 MB
Rank =   53  Free Memory = 88285 MB
Rank =   54  Free Memory = 88285 MB
Rank =   55  Free Memory = 88285 MB
Rank =   56  Free Memory = 88285 MB
Rank =   57  Free Memory = 88285 MB
Rank =   58  Free Memory = 88285 MB
Rank =   59  Free Memory = 88285 MB
Rank =   60  Free Memory = 88285 MB
Rank =   61  Free Memory = 88285 MB
Rank =   62  Free Memory = 88285 MB
Rank =   63  Free Memory = 88285 MB
Rank =   64  Free Memory = 90020 MB
Rank =   65  Free Memory = 90019 MB
Rank =   66  Free Memory = 90019 MB
Rank =   67  Free Memory = 90018 MB
Rank =   68  Free Memory = 90018 MB
Rank =   69  Free Memory = 90018 MB
Rank =   70  Free Memory = 90018 MB
Rank =   71  Free Memory = 90018 MB
Rank =   72  Free Memory = 90018 MB
Rank =   73  Free Memory = 90018 MB
Rank =   74  Free Memory = 90018 MB
Rank =   75  Free Memory = 90018 MB
Rank =   76  Free Memory = 90018 MB
Rank =   77  Free Memory = 90018 MB
Rank =   78  Free Memory = 90018 MB
Rank =   79  Free Memory = 90018 MB
Rank =   80  Free Memory = 90018 MB
Rank =   81  Free Memory = 90018 MB
Rank =   82  Free Memory = 90018 MB
Rank =   83  Free Memory = 90018 MB
Rank =   84  Free Memory = 90018 MB
Rank =   85  Free Memory = 90017 MB
Rank =   86  Free Memory = 90017 MB
Rank =   87  Free Memory = 90017 MB
Rank =   88  Free Memory = 90017 MB
Rank =   89  Free Memory = 90017 MB
Rank =   90  Free Memory = 90017 MB
Rank =   91  Free Memory = 90017 MB
Rank =   92  Free Memory = 90017 MB
Rank =   93  Free Memory = 90017 MB
Rank =   94  Free Memory = 90017 MB
Rank =   95  Free Memory = 90017 MB
Rank =   96  Free Memory = 86550 MB
Rank =   97  Free Memory = 86550 MB
Rank =   98  Free Memory = 86550 MB
Rank =   99  Free Memory = 86550 MB
Rank =  100  Free Memory = 86550 MB
Rank =  101  Free Memory = 86550 MB
Rank =  102  Free Memory = 86550 MB
Rank =  103  Free Memory = 86550 MB
Rank =  104  Free Memory = 86550 MB
Rank =  105  Free Memory = 86550 MB
Rank =  106  Free Memory = 86550 MB
Rank =  107  Free Memory = 86550 MB
Rank =  108  Free Memory = 86550 MB
Rank =  109  Free Memory = 86550 MB
Rank =  110  Free Memory = 86550 MB
Rank =  111  Free Memory = 86550 MB
Rank =  112  Free Memory = 86550 MB
Rank =  113  Free Memory = 86550 MB
Rank =  114  Free Memory = 86550 MB
Rank =  115  Free Memory = 86550 MB
Rank =  116  Free Memory = 86550 MB
Rank =  117  Free Memory = 86550 MB
Rank =  118  Free Memory = 86550 MB
Rank =  119  Free Memory = 86550 MB
Rank =  120  Free Memory = 86550 MB
Rank =  121  Free Memory = 86550 MB
Rank =  122  Free Memory = 86550 MB
Rank =  123  Free Memory = 86550 MB
Rank =  124  Free Memory = 86550 MB
Rank =  125  Free Memory = 86550 MB
Rank =  126  Free Memory = 86550 MB
Rank =  127  Free Memory = 86550 MB
  Input file(s): opt_form_gs_edesc_run001f.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_form_gs_edesc_run001f.xml

  Project = FORM
  date    = 2023-03-22 15:07:25 PDT
  host    = n0117.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 29

  Range of prime numbers to use as seeds over processors and threads = 127-937


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 12

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 4

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 2.651612e-01    1         1  ON     0
     uu_1                 9.105835e-02    1         1  ON     1
     uu_2                -1.970486e-02    1         1  ON     2
     uu_3                -8.435550e-02    1         1  ON     3
     uu_4                -1.207382e-01    1         1  ON     4
     uu_5                -1.420158e-01    1         1  ON     5
     uu_6                -1.526085e-01    1         1  ON     6
     uu_7                -1.507275e-01    1         1  ON     7
     uu_8                -1.324206e-01    1         1  ON     8
     uu_9                -8.332005e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.265271e-01    1         1  ON     0
     ud_1                 1.442636e-01    1         1  ON     1
     ud_2                -1.360556e-03    1         1  ON     2
     ud_3                -8.072828e-02    1         1  ON     3
     ud_4                -1.266031e-01    1         1  ON     4
     ud_5                -1.544045e-01    1         1  ON     5
     ud_6                -1.697236e-01    1         1  ON     6
     ud_7                -1.708319e-01    1         1  ON     7
     ud_8                -1.543405e-01    1         1  ON     8
     ud_9                -1.062495e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: C
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eC_0                -5.499041e-01    1         1  ON     0
     eC_1                -3.934967e-01    1         1  ON     1
     eC_2                -1.387428e-01    1         1  ON     2
     eC_3                 1.667224e-02    1         1  ON     3
     eC_4                 7.618129e-02    1         1  ON     4
     eC_5                 1.725660e-01    1         1  ON     5
     eC_6                 2.812280e-01    1         1  ON     6
     eC_7                 3.489827e-01    1         1  ON     7
     eC_8                 1.532669e-01    1         1  ON     8
     eC_9                 2.925882e-02    1         1  ON     9

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -1.166834e+00    1         1  ON     0
     eO_1                -7.904649e-01    1         1  ON     1
     eO_2                -3.158560e-01    1         1  ON     2
     eO_3                 2.071153e-02    1         1  ON     3
     eO_4                 2.372582e-01    1         1  ON     4
     eO_5                 4.036297e-01    1         1  ON     5
     eO_6                 4.686140e-01    1         1  ON     6
     eO_7                 4.912130e-01    1         1  ON     7
     eO_8                 3.797319e-01    1         1  ON     8
     eO_9                 1.906483e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.702273e-01    1         1  ON     0
     eH1_1                -8.290076e-02    1         1  ON     1
     eH1_2                -5.256400e-02    1         1  ON     2
     eH1_3                -4.088434e-02    1         1  ON     3
     eH1_4                 1.311827e-02    1         1  ON     4
     eH1_5                 6.088815e-02    1         1  ON     5
     eH1_6                 1.062672e-01    1         1  ON     6
     eH1_7                 7.026131e-02    1         1  ON     7
     eH1_8                -5.049623e-03    1         1  ON     8
     eH1_9                 4.783012e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.696417e-01    1         1  ON     0
     eH2_1                -8.288474e-02    1         1  ON     1
     eH2_2                -5.225661e-02    1         1  ON     2
     eH2_3                -4.123279e-02    1         1  ON     3
     eH2_4                 1.273435e-02    1         1  ON     4
     eH2_5                 6.049856e-02    1         1  ON     5
     eH2_6                 1.066265e-01    1         1  ON     6
     eH2_7                 7.288709e-02    1         1  ON     7
     eH2_8                -4.723932e-03    1         1  ON     8
     eH2_9                 4.873234e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for C
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.712448e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 20 unique up determinants.
Found 20 unique down determinants.
Number of terms in pairs array: 12
Number of terms in pairs array: 12
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for C
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.405000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.405000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.4050000000e+00

  Adding pseudopotential for O
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0750000000e+00
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0750000000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 3.3425e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 12 particles :  u(6) d(6)

    u  1.0776882035e+00  1.1858078688e-01 -1.1228966320e+00
    u  5.2623637829e-01  1.7541589896e-01 -1.3337143393e+00
    u -2.1907738776e-01  1.2604145828e+00  7.3980442540e-01
    u  5.1104917034e-03  1.4830329441e-01  1.8508537617e+00
    u  2.0319189978e-01  5.3211297520e-02  1.1096632188e+00
    u -7.1114543523e-01  2.3194667600e+00 -1.9120363364e+00
    d  4.5386831405e-01  7.4543549121e-01 -1.7781369559e+00
    d -5.3250436761e-01  5.6773482298e-01 -1.4296151151e+00
    d -8.5149149983e-02 -4.7335234687e-01  1.2151269463e+00
    d -1.3341711209e-02  5.3976693736e-01  8.3781480332e-01
    (... and 2 more particle positions ...)

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 4 particles :  C(1) O(1) H1(1) H2(1)

    C  0.0000000000e+00  0.0000000000e+00 -1.1394765782e+00
    O  0.0000000000e+00  0.0000000000e+00  1.1440287480e+00
    H1  0.0000000000e+00  1.7662761033e+00 -2.2339863698e+00
    H2  0.0000000000e+00 -1.7662761033e+00 -2.2339863698e+00

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root FORM.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 60
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.8389
    reference variance = 0.421323
====================================================
  Execution time = 4.4674e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9910e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5254e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499047637694
                                         uncertainty =       0.003244499406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499047637694
                                         uncertainty =       0.003244499406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499552004
  error estimate for blocks of size 2^( 2) =       0.000517324678
  error estimate for blocks of size 2^( 3) =       0.000533370164
  error estimate for blocks of size 2^( 4) =       0.000544238483
  error estimate for blocks of size 2^( 5) =       0.000551292390
  error estimate for blocks of size 2^( 6) =       0.000554832079
  error estimate for blocks of size 2^( 7) =       0.000557252845

      target function =                  N/A
              le_mean =     -22.825137785344
             les_mean =     521.486019079001
             stat err =       0.000551903949
             autocorr =       1.220578156153
              std dev =       0.706473218596
             le_variance =       0.499104408593


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-2.282513778534e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825137785344       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825139736441       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825142019906       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825144006096       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825144822137       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825144797213       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825143958073       residual = 7.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825143280139       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825143267927       residual = 2.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825143574773       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825143983343       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825144036810       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825144008646       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825144077423       residual = 3.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 9.718859e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825137785344       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825138511230       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825139487393       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825140103138       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825140398851       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825140469931       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825140172837       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825140146848       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825140160728       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825140178886       residual = 3.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825140240907       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825140236618       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 3.105011e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825137785344       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825137992041       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825138295861       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825138459319       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825138535472       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825138562783       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825138493138       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825138513495       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825138516129       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825138519501       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825138531092       residual = 6.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 8.642859e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.228660 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0161e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
uu_0  2.651151e-01                 1 1 ON  0
uu_1  9.120377e-02                 1 1 ON  1
uu_2  -1.964379e-02                1 1 ON  2
uu_3  -8.435582e-02                1 1 ON  3
uu_4  -1.207810e-01                1 1 ON  4
uu_5  -1.419484e-01                1 1 ON  5
uu_6  -1.526068e-01                1 1 ON  6
uu_7  -1.507206e-01                1 1 ON  7
uu_8  -1.325187e-01                1 1 ON  8
uu_9  -8.346017e-02                1 1 ON  9
ud_0  4.264880e-01                 1 1 ON  10
ud_1  1.442769e-01                 1 1 ON  11
ud_2  -1.292284e-03                1 1 ON  12
ud_3  -8.062940e-02                1 1 ON  13
ud_4  -1.265671e-01                1 1 ON  14
ud_5  -1.543502e-01                1 1 ON  15
ud_6  -1.696982e-01                1 1 ON  16
ud_7  -1.708922e-01                1 1 ON  17
ud_8  -1.543341e-01                1 1 ON  18
ud_9  -1.063572e-01                1 1 ON  19
eC_0  -5.499599e-01                1 1 ON  20
eC_1  -3.935904e-01                1 1 ON  21
eC_2  -1.388080e-01                1 1 ON  22
eC_3  1.659288e-02                 1 1 ON  23
eC_4  7.626235e-02                 1 1 ON  24
eC_5  1.725253e-01                 1 1 ON  25
eC_6  2.812065e-01                 1 1 ON  26
eC_7  3.490815e-01                 1 1 ON  27
eC_8  1.534164e-01                 1 1 ON  28
eC_9  2.929213e-02                 1 1 ON  29
eO_0  -1.167144e+00                1 1 ON  30
eO_1  -7.905142e-01                1 1 ON  31
eO_2  -3.159049e-01                1 1 ON  32
eO_3  2.065204e-02                 1 1 ON  33
eO_4  2.371804e-01                 1 1 ON  34
eO_5  4.036311e-01                 1 1 ON  35
eO_6  4.685646e-01                 1 1 ON  36
eO_7  4.913360e-01                 1 1 ON  37
eO_8  3.799467e-01                 1 1 ON  38
eO_9  1.908457e-01                 1 1 ON  39
eH1_0 -1.702136e-01                1 1 ON  40
eH1_1 -8.287087e-02                1 1 ON  41
eH1_2 -5.262031e-02                1 1 ON  42
eH1_3 -4.093826e-02                1 1 ON  43
eH1_4 1.318906e-02                 1 1 ON  44
eH1_5 6.084954e-02                 1 1 ON  45
eH1_6 1.062698e-01                 1 1 ON  46
eH1_7 7.040616e-02                 1 1 ON  47
eH1_8 -5.092692e-03                1 1 ON  48
eH1_9 4.773051e-02                 1 1 ON  49
eH2_0 -1.697249e-01                1 1 ON  50
eH2_1 -8.306006e-02                1 1 ON  51
eH2_2 -5.226562e-02                1 1 ON  52
eH2_3 -4.118630e-02                1 1 ON  53
eH2_4 1.283776e-02                 1 1 ON  54
eH2_5 6.049020e-02                 1 1 ON  55
eH2_6 1.066666e-01                 1 1 ON  56
eH2_7 7.295367e-02                 1 1 ON  57
eH2_8 -4.703382e-03                1 1 ON  58
eH2_9 4.868519e-02                 1 1 ON  59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -22.9055
    reference variance = 0.856841
====================================================
  Execution time = 4.3095e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0592e-01
  Total weights = 2.0000e+06
  Execution time = 3.5574e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506017427865
                                         uncertainty =       0.004778027157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506017427865
                                         uncertainty =       0.004778027157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502991730
  error estimate for blocks of size 2^( 2) =       0.000520832374
  error estimate for blocks of size 2^( 3) =       0.000536701228
  error estimate for blocks of size 2^( 4) =       0.000548032696
  error estimate for blocks of size 2^( 5) =       0.000553577253
  error estimate for blocks of size 2^( 6) =       0.000556587418
  error estimate for blocks of size 2^( 7) =       0.000559741504

      target function =                  N/A
              le_mean =     -22.824294192499
             les_mean =     521.454406493185
             stat err =       0.000554484718
             autocorr =       1.215227176538
              std dev =       0.711337726019
             le_variance =       0.506001360458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505902741297
                                         uncertainty =       0.004774644351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505902741297
                                         uncertainty =       0.004774644351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502934775
  error estimate for blocks of size 2^( 2) =       0.000520778705
  error estimate for blocks of size 2^( 3) =       0.000536651147
  error estimate for blocks of size 2^( 4) =       0.000547986137
  error estimate for blocks of size 2^( 5) =       0.000553544100
  error estimate for blocks of size 2^( 6) =       0.000556554459
  error estimate for blocks of size 2^( 7) =       0.000559716743

      target function =                  N/A
              le_mean =     -22.824294588485
             les_mean =     521.454309984162
             stat err =       0.000554450360
             autocorr =       1.215351800390
              std dev =       0.711257179330
             le_variance =       0.505886775148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505858698636
                                         uncertainty =       0.004774498472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505858698636
                                         uncertainty =       0.004774498472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502912887
  error estimate for blocks of size 2^( 2) =       0.000520757942
  error estimate for blocks of size 2^( 3) =       0.000536631875
  error estimate for blocks of size 2^( 4) =       0.000547967126
  error estimate for blocks of size 2^( 5) =       0.000553524407
  error estimate for blocks of size 2^( 6) =       0.000556533785
  error estimate for blocks of size 2^( 7) =       0.000559692769

      target function =                  N/A
              le_mean =     -22.824295250950
             les_mean =     521.454296193901
             stat err =       0.000554429521
             autocorr =       1.215366229079
              std dev =       0.711226225799
             le_variance =       0.505842744265

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505986556317
                                         uncertainty =       0.004777393962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505986556317
                                         uncertainty =       0.004777393962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502976395
  error estimate for blocks of size 2^( 2) =       0.000520817825
  error estimate for blocks of size 2^( 3) =       0.000536687590
  error estimate for blocks of size 2^( 4) =       0.000548019713
  error estimate for blocks of size 2^( 5) =       0.000553566337
  error estimate for blocks of size 2^( 6) =       0.000556576371
  error estimate for blocks of size 2^( 7) =       0.000559731041

      target function =                  N/A
              le_mean =     -22.824294310138
             les_mean =     521.454381011482
             stat err =       0.000554473365
             autocorr =       1.215251512291
              std dev =       0.711316039928
             le_variance =       0.505970508659


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824294192499        initial
     2.5000e-01     2.5000e+00             9.7189e-04       -22.824294588485
     1.0000e+00     1.0000e+01             3.1050e-04       -22.824295250950  <--
     4.0000e+00     4.0000e+01             8.6429e-05       -22.824294310138

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 6.4766e+01
  </log>
  <optVariables href="FORM.s000.opt.xml">
 uu_0                 2.651151e-01 1 1  ON 0
 uu_1                 9.120377e-02 1 1  ON 1
 uu_2                -1.964379e-02 1 1  ON 2
 uu_3                -8.435582e-02 1 1  ON 3
 uu_4                -1.207810e-01 1 1  ON 4
 uu_5                -1.419484e-01 1 1  ON 5
 uu_6                -1.526068e-01 1 1  ON 6
 uu_7                -1.507206e-01 1 1  ON 7
 uu_8                -1.325187e-01 1 1  ON 8
 uu_9                -8.346017e-02 1 1  ON 9
 ud_0                 4.264880e-01 1 1  ON 10
 ud_1                 1.442769e-01 1 1  ON 11
 ud_2                -1.292284e-03 1 1  ON 12
 ud_3                -8.062940e-02 1 1  ON 13
 ud_4                -1.265671e-01 1 1  ON 14
 ud_5                -1.543502e-01 1 1  ON 15
 ud_6                -1.696982e-01 1 1  ON 16
 ud_7                -1.708922e-01 1 1  ON 17
 ud_8                -1.543341e-01 1 1  ON 18
 ud_9                -1.063572e-01 1 1  ON 19
 eC_0                -5.499599e-01 1 1  ON 20
 eC_1                -3.935904e-01 1 1  ON 21
 eC_2                -1.388080e-01 1 1  ON 22
 eC_3                 1.659288e-02 1 1  ON 23
 eC_4                 7.626235e-02 1 1  ON 24
 eC_5                 1.725253e-01 1 1  ON 25
 eC_6                 2.812065e-01 1 1  ON 26
 eC_7                 3.490815e-01 1 1  ON 27
 eC_8                 1.534164e-01 1 1  ON 28
 eC_9                 2.929213e-02 1 1  ON 29
 eO_0                -1.167144e+00 1 1  ON 30
 eO_1                -7.905142e-01 1 1  ON 31
 eO_2                -3.159049e-01 1 1  ON 32
 eO_3                 2.065204e-02 1 1  ON 33
 eO_4                 2.371804e-01 1 1  ON 34
 eO_5                 4.036311e-01 1 1  ON 35
 eO_6                 4.685646e-01 1 1  ON 36
 eO_7                 4.913360e-01 1 1  ON 37
 eO_8                 3.799467e-01 1 1  ON 38
 eO_9                 1.908457e-01 1 1  ON 39
eH1_0                -1.702136e-01 1 1  ON 40
eH1_1                -8.287087e-02 1 1  ON 41
eH1_2                -5.262031e-02 1 1  ON 42
eH1_3                -4.093826e-02 1 1  ON 43
eH1_4                 1.318906e-02 1 1  ON 44
eH1_5                 6.084954e-02 1 1  ON 45
eH1_6                 1.062698e-01 1 1  ON 46
eH1_7                 7.040616e-02 1 1  ON 47
eH1_8                -5.092692e-03 1 1  ON 48
eH1_9                 4.773051e-02 1 1  ON 49
eH2_0                -1.697249e-01 1 1  ON 50
eH2_1                -8.306006e-02 1 1  ON 51
eH2_2                -5.226562e-02 1 1  ON 52
eH2_3                -4.118630e-02 1 1  ON 53
eH2_4                 1.283776e-02 1 1  ON 54
eH2_5                 6.049020e-02 1 1  ON 55
eH2_6                 1.066666e-01 1 1  ON 56
eH2_7                 7.295367e-02 1 1  ON 57
eH2_8                -4.703382e-03 1 1  ON 58
eH2_9                 4.868519e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2495e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2872e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8647
    reference variance = 0.385805
====================================================
  Execution time = 4.3883e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9919e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5237e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499198375445
                                         uncertainty =       0.003016540476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499198375445
                                         uncertainty =       0.003016540476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499594702
  error estimate for blocks of size 2^( 2) =       0.000517906785
  error estimate for blocks of size 2^( 3) =       0.000533971867
  error estimate for blocks of size 2^( 4) =       0.000545319489
  error estimate for blocks of size 2^( 5) =       0.000550956029
  error estimate for blocks of size 2^( 6) =       0.000555362873
  error estimate for blocks of size 2^( 7) =       0.000557430868

      target function =                  N/A
              le_mean =     -22.826003631673
             les_mean =     521.525631275633
             stat err =       0.000552267315
             autocorr =       1.221977005670
              std dev =       0.706533602948
             le_variance =       0.499189732095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282600363167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826003631673       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826005111211       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826004357496       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826003059187       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826003615058       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826003878792       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826004020522       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826005855388       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826004891164       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826005390079       residual = 9.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826005402170       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.826005349280       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.826005435826       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 8.104682e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826003631673       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826004193153       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826003905356       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826003006839       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826003092029       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826003533359       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826003640716       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826004075288       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826003786694       residual = 6.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826003863213       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.826003946318       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 1.980711e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826003631673       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826003792924       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826003709995       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826003393360       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826003387455       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826003538861       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826003603000       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826003690286       residual = 7.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826003629074       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826003635109       residual = 7.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 4.0000e+00 is 4.948536e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.233468 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9129e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.650099e-01 1 1  ON 0
 uu_1                 9.121231e-02 1 1  ON 1
 uu_2                -1.962592e-02 1 1  ON 2
 uu_3                -8.431972e-02 1 1  ON 3
 uu_4                -1.207705e-01 1 1  ON 4
 uu_5                -1.419294e-01 1 1  ON 5
 uu_6                -1.526690e-01 1 1  ON 6
 uu_7                -1.507581e-01 1 1  ON 7
 uu_8                -1.324993e-01 1 1  ON 8
 uu_9                -8.354330e-02 1 1  ON 9
 ud_0                 4.264400e-01 1 1  ON 10
 ud_1                 1.442726e-01 1 1  ON 11
 ud_2                -1.305525e-03 1 1  ON 12
 ud_3                -8.056193e-02 1 1  ON 13
 ud_4                -1.264921e-01 1 1  ON 14
 ud_5                -1.543419e-01 1 1  ON 15
 ud_6                -1.696832e-01 1 1  ON 16
 ud_7                -1.709014e-01 1 1  ON 17
 ud_8                -1.543580e-01 1 1  ON 18
 ud_9                -1.064670e-01 1 1  ON 19
 eC_0                -5.500184e-01 1 1  ON 20
 eC_1                -3.936195e-01 1 1  ON 21
 eC_2                -1.388113e-01 1 1  ON 22
 eC_3                 1.651473e-02 1 1  ON 23
 eC_4                 7.611267e-02 1 1  ON 24
 eC_5                 1.725073e-01 1 1  ON 25
 eC_6                 2.811848e-01 1 1  ON 26
 eC_7                 3.491906e-01 1 1  ON 27
 eC_8                 1.536145e-01 1 1  ON 28
 eC_9                 2.934513e-02 1 1  ON 29
 eO_0                -1.167234e+00 1 1  ON 30
 eO_1                -7.906732e-01 1 1  ON 31
 eO_2                -3.159832e-01 1 1  ON 32
 eO_3                 2.048816e-02 1 1  ON 33
 eO_4                 2.371103e-01 1 1  ON 34
 eO_5                 4.036338e-01 1 1  ON 35
 eO_6                 4.685288e-01 1 1  ON 36
 eO_7                 4.914753e-01 1 1  ON 37
 eO_8                 3.801185e-01 1 1  ON 38
 eO_9                 1.910257e-01 1 1  ON 39
eH1_0                -1.701312e-01 1 1  ON 40
eH1_1                -8.284929e-02 1 1  ON 41
eH1_2                -5.258871e-02 1 1  ON 42
eH1_3                -4.101387e-02 1 1  ON 43
eH1_4                 1.309998e-02 1 1  ON 44
eH1_5                 6.089303e-02 1 1  ON 45
eH1_6                 1.062014e-01 1 1  ON 46
eH1_7                 7.044776e-02 1 1  ON 47
eH1_8                -5.112239e-03 1 1  ON 48
eH1_9                 4.768026e-02 1 1  ON 49
eH2_0                -1.697944e-01 1 1  ON 50
eH2_1                -8.318096e-02 1 1  ON 51
eH2_2                -5.239016e-02 1 1  ON 52
eH2_3                -4.121735e-02 1 1  ON 53
eH2_4                 1.283042e-02 1 1  ON 54
eH2_5                 6.062430e-02 1 1  ON 55
eH2_6                 1.067381e-01 1 1  ON 56
eH2_7                 7.309420e-02 1 1  ON 57
eH2_8                -4.694440e-03 1 1  ON 58
eH2_9                 4.863853e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -22.8521
    reference variance = 0.410498
====================================================
  Execution time = 4.3585e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0444e-01
  Total weights = 2.0000e+06
  Execution time = 3.5476e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504552191801
                                         uncertainty =       0.004320228385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504552191801
                                         uncertainty =       0.004320228385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502285545
  error estimate for blocks of size 2^( 2) =       0.000519881232
  error estimate for blocks of size 2^( 3) =       0.000535110110
  error estimate for blocks of size 2^( 4) =       0.000545760097
  error estimate for blocks of size 2^( 5) =       0.000551766224
  error estimate for blocks of size 2^( 6) =       0.000554594561
  error estimate for blocks of size 2^( 7) =       0.000557055720

      target function =                  N/A
              le_mean =     -22.825383513003
             les_mean =     521.502713801720
             stat err =       0.000552294150
             autocorr =       1.209036817494
              std dev =       0.710339030548
             le_variance =       0.504581538320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504197147001
                                         uncertainty =       0.004315338529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504197147001
                                         uncertainty =       0.004315338529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502108773
  error estimate for blocks of size 2^( 2) =       0.000519709808
  error estimate for blocks of size 2^( 3) =       0.000534947994
  error estimate for blocks of size 2^( 4) =       0.000545609018
  error estimate for blocks of size 2^( 5) =       0.000551622029
  error estimate for blocks of size 2^( 6) =       0.000554439378
  error estimate for blocks of size 2^( 7) =       0.000556895003

      target function =                  N/A
              le_mean =     -22.825387394411
             les_mean =     521.502535893612
             stat err =       0.000552141357
             autocorr =       1.209218928712
              std dev =       0.710089037224
             le_variance =       0.504226440786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504272556655
                                         uncertainty =       0.004316011018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504272556655
                                         uncertainty =       0.004316011018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502146338
  error estimate for blocks of size 2^( 2) =       0.000519746068
  error estimate for blocks of size 2^( 3) =       0.000534982386
  error estimate for blocks of size 2^( 4) =       0.000545641452
  error estimate for blocks of size 2^( 5) =       0.000551652564
  error estimate for blocks of size 2^( 6) =       0.000554472573
  error estimate for blocks of size 2^( 7) =       0.000556929817

      target function =                  N/A
              le_mean =     -22.825386497820
             les_mean =     521.502570413058
             stat err =       0.000552174102
             autocorr =       1.209181421834
              std dev =       0.710142162076
             le_variance =       0.504301890358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504512452600
                                         uncertainty =       0.004319579517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504512452600
                                         uncertainty =       0.004319579517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502265767
  error estimate for blocks of size 2^( 2) =       0.000519861918
  error estimate for blocks of size 2^( 3) =       0.000535091798
  error estimate for blocks of size 2^( 4) =       0.000545743072
  error estimate for blocks of size 2^( 5) =       0.000551749876
  error estimate for blocks of size 2^( 6) =       0.000554576845
  error estimate for blocks of size 2^( 7) =       0.000557037479

      target function =                  N/A
              le_mean =     -22.825383931233
             les_mean =     521.502693158040
             stat err =       0.000552276818
             autocorr =       1.209056146474
              std dev =       0.710311060120
             le_variance =       0.504541802129


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825383513003        initial
     2.5000e-01     2.5000e+00             8.1047e-04       -22.825387394411  <--
     1.0000e+00     1.0000e+01             1.9807e-04       -22.825386497820
     4.0000e+00     4.0000e+01             4.9485e-05       -22.825383931233

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.1375e+01
  </log>
  <optVariables href="FORM.s001.opt.xml">
 uu_0                 2.648774e-01 1 1  ON 0
 uu_1                 9.122121e-02 1 1  ON 1
 uu_2                -1.960591e-02 1 1  ON 2
 uu_3                -8.426923e-02 1 1  ON 3
 uu_4                -1.207596e-01 1 1  ON 4
 uu_5                -1.419388e-01 1 1  ON 5
 uu_6                -1.527850e-01 1 1  ON 6
 uu_7                -1.508785e-01 1 1  ON 7
 uu_8                -1.324990e-01 1 1  ON 8
 uu_9                -8.379907e-02 1 1  ON 9
 ud_0                 4.264008e-01 1 1  ON 10
 ud_1                 1.442770e-01 1 1  ON 11
 ud_2                -1.278303e-03 1 1  ON 12
 ud_3                -8.043416e-02 1 1  ON 13
 ud_4                -1.263468e-01 1 1  ON 14
 ud_5                -1.542786e-01 1 1  ON 15
 ud_6                -1.696624e-01 1 1  ON 16
 ud_7                -1.709495e-01 1 1  ON 17
 ud_8                -1.544519e-01 1 1  ON 18
 ud_9                -1.068017e-01 1 1  ON 19
 eC_0                -5.501447e-01 1 1  ON 20
 eC_1                -3.937021e-01 1 1  ON 21
 eC_2                -1.388919e-01 1 1  ON 22
 eC_3                 1.625923e-02 1 1  ON 23
 eC_4                 7.576971e-02 1 1  ON 24
 eC_5                 1.723655e-01 1 1  ON 25
 eC_6                 2.811038e-01 1 1  ON 26
 eC_7                 3.495307e-01 1 1  ON 27
 eC_8                 1.542269e-01 1 1  ON 28
 eC_9                 2.950907e-02 1 1  ON 29
 eO_0                -1.167562e+00 1 1  ON 30
 eO_1                -7.911127e-01 1 1  ON 31
 eO_2                -3.163092e-01 1 1  ON 32
 eO_3                 2.009908e-02 1 1  ON 33
 eO_4                 2.368855e-01 1 1  ON 34
 eO_5                 4.036279e-01 1 1  ON 35
 eO_6                 4.684468e-01 1 1  ON 36
 eO_7                 4.918705e-01 1 1  ON 37
 eO_8                 3.806424e-01 1 1  ON 38
 eO_9                 1.915820e-01 1 1  ON 39
eH1_0                -1.699525e-01 1 1  ON 40
eH1_1                -8.284318e-02 1 1  ON 41
eH1_2                -5.255455e-02 1 1  ON 42
eH1_3                -4.117140e-02 1 1  ON 43
eH1_4                 1.295902e-02 1 1  ON 44
eH1_5                 6.093236e-02 1 1  ON 45
eH1_6                 1.061036e-01 1 1  ON 46
eH1_7                 7.054373e-02 1 1  ON 47
eH1_8                -5.170988e-03 1 1  ON 48
eH1_9                 4.752688e-02 1 1  ON 49
eH2_0                -1.700201e-01 1 1  ON 50
eH2_1                -8.348448e-02 1 1  ON 51
eH2_2                -5.267765e-02 1 1  ON 52
eH2_3                -4.130031e-02 1 1  ON 53
eH2_4                 1.283039e-02 1 1  ON 54
eH2_5                 6.090963e-02 1 1  ON 55
eH2_6                 1.069360e-01 1 1  ON 56
eH2_7                 7.348135e-02 1 1  ON 57
eH2_8                -4.661257e-03 1 1  ON 58
eH2_9                 4.849617e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2051e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2865e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.7536
    reference variance = 0.542748
====================================================
  Execution time = 4.3831e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1285e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5022e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512923735133
                                         uncertainty =       0.006071928084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.512923735133
                                         uncertainty =       0.006071928084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506382191
  error estimate for blocks of size 2^( 2) =       0.000523819147
  error estimate for blocks of size 2^( 3) =       0.000539351135
  error estimate for blocks of size 2^( 4) =       0.000551128769
  error estimate for blocks of size 2^( 5) =       0.000558266975
  error estimate for blocks of size 2^( 6) =       0.000559790297
  error estimate for blocks of size 2^( 7) =       0.000559136624

      target function =                  N/A
              le_mean =     -22.825552867698
             les_mean =     521.518709305805
             stat err =       0.000557080666
             autocorr =       1.210261800365
              std dev =       0.716132561869
             le_variance =       0.512845846168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282555286770e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825552867698       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825555471801       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825559932907       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825561066203       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825559277119       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825558909682       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825562110402       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825561121991       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825562270726       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825563144289       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825563478356       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825564174354       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825564014929       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825564889470       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825564598398       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825564461787       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825564286224       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 3.378891e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825552867698       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825554220684       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825557236065       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825558558358       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825557625774       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825556619772       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825558114173       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825557584462       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825558039137       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825558281011       residual = 9.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825558205807       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825558374103       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825558500061       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825558416014       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 8.695451e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825552867698       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825553330769       residual = 4.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825554641877       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825555490089       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825555291200       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825554534623       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825554910937       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825554775394       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825554979383       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825554999695       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825554965867       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.573139e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.240562 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8865e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.651144e-01 1 1  ON 0
 uu_1                 9.113756e-02 1 1  ON 1
 uu_2                -1.963186e-02 1 1  ON 2
 uu_3                -8.431339e-02 1 1  ON 3
 uu_4                -1.208775e-01 1 1  ON 4
 uu_5                -1.419846e-01 1 1  ON 5
 uu_6                -1.526409e-01 1 1  ON 6
 uu_7                -1.510431e-01 1 1  ON 7
 uu_8                -1.326816e-01 1 1  ON 8
 uu_9                -8.402975e-02 1 1  ON 9
 ud_0                 4.265746e-01 1 1  ON 10
 ud_1                 1.445168e-01 1 1  ON 11
 ud_2                -1.033183e-03 1 1  ON 12
 ud_3                -8.029377e-02 1 1  ON 13
 ud_4                -1.263130e-01 1 1  ON 14
 ud_5                -1.542471e-01 1 1  ON 15
 ud_6                -1.697847e-01 1 1  ON 16
 ud_7                -1.713412e-01 1 1  ON 17
 ud_8                -1.543411e-01 1 1  ON 18
 ud_9                -1.071861e-01 1 1  ON 19
 eC_0                -5.503600e-01 1 1  ON 20
 eC_1                -3.940802e-01 1 1  ON 21
 eC_2                -1.389588e-01 1 1  ON 22
 eC_3                 1.608264e-02 1 1  ON 23
 eC_4                 7.575724e-02 1 1  ON 24
 eC_5                 1.718667e-01 1 1  ON 25
 eC_6                 2.810433e-01 1 1  ON 26
 eC_7                 3.500360e-01 1 1  ON 27
 eC_8                 1.549531e-01 1 1  ON 28
 eC_9                 2.968881e-02 1 1  ON 29
 eO_0                -1.168004e+00 1 1  ON 30
 eO_1                -7.916390e-01 1 1  ON 31
 eO_2                -3.171079e-01 1 1  ON 32
 eO_3                 2.006419e-02 1 1  ON 33
 eO_4                 2.365492e-01 1 1  ON 34
 eO_5                 4.038298e-01 1 1  ON 35
 eO_6                 4.682204e-01 1 1  ON 36
 eO_7                 4.920559e-01 1 1  ON 37
 eO_8                 3.815119e-01 1 1  ON 38
 eO_9                 1.923364e-01 1 1  ON 39
eH1_0                -1.703290e-01 1 1  ON 40
eH1_1                -8.310849e-02 1 1  ON 41
eH1_2                -5.259524e-02 1 1  ON 42
eH1_3                -4.129239e-02 1 1  ON 43
eH1_4                 1.291673e-02 1 1  ON 44
eH1_5                 6.077092e-02 1 1  ON 45
eH1_6                 1.063926e-01 1 1  ON 46
eH1_7                 7.102822e-02 1 1  ON 47
eH1_8                -5.038235e-03 1 1  ON 48
eH1_9                 4.733724e-02 1 1  ON 49
eH2_0                -1.700819e-01 1 1  ON 50
eH2_1                -8.356167e-02 1 1  ON 51
eH2_2                -5.266055e-02 1 1  ON 52
eH2_3                -4.138966e-02 1 1  ON 53
eH2_4                 1.294211e-02 1 1  ON 54
eH2_5                 6.094293e-02 1 1  ON 55
eH2_6                 1.070134e-01 1 1  ON 56
eH2_7                 7.362767e-02 1 1  ON 57
eH2_8                -4.857108e-03 1 1  ON 58
eH2_9                 4.832121e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -22.8241
    reference variance = 0.494441
====================================================
  Execution time = 4.3411e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.2591e-01
  Total weights = 2.0000e+06
  Execution time = 3.5541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525951727965
                                         uncertainty =       0.013123779233

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525951727965
                                         uncertainty =       0.013123779233

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512797186
  error estimate for blocks of size 2^( 2) =       0.000530394969
  error estimate for blocks of size 2^( 3) =       0.000546032225
  error estimate for blocks of size 2^( 4) =       0.000556313902
  error estimate for blocks of size 2^( 5) =       0.000561854436
  error estimate for blocks of size 2^( 6) =       0.000565727199
  error estimate for blocks of size 2^( 7) =       0.000571023726

      target function =                  N/A
              le_mean =     -22.825903501166
             les_mean =     521.547792290112
             stat err =       0.000563729816
             autocorr =       1.208511378392
              std dev =       0.725204735596
             le_variance =       0.525921908532

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526076999738
                                         uncertainty =       0.013128725707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.526076999738
                                         uncertainty =       0.013128725707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512858190
  error estimate for blocks of size 2^( 2) =       0.000530451738
  error estimate for blocks of size 2^( 3) =       0.000546085207
  error estimate for blocks of size 2^( 4) =       0.000556357513
  error estimate for blocks of size 2^( 5) =       0.000561909382
  error estimate for blocks of size 2^( 6) =       0.000565786710
  error estimate for blocks of size 2^( 7) =       0.000571090560

      target function =                  N/A
              le_mean =     -22.825906045553
             les_mean =     521.548033583889
             stat err =       0.000563786041
             autocorr =       1.208464918523
              std dev =       0.725291008143
             le_variance =       0.526047046494

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525932370178
                                         uncertainty =       0.013126143871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525932370178
                                         uncertainty =       0.013126143871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512787650
  error estimate for blocks of size 2^( 2) =       0.000530386516
  error estimate for blocks of size 2^( 3) =       0.000546027108
  error estimate for blocks of size 2^( 4) =       0.000556304141
  error estimate for blocks of size 2^( 5) =       0.000561862933
  error estimate for blocks of size 2^( 6) =       0.000565744600
  error estimate for blocks of size 2^( 7) =       0.000571047627

      target function =                  N/A
              le_mean =     -22.825906096882
             les_mean =     521.547891228949
             stat err =       0.000563739825
             autocorr =       1.208599245044
              std dev =       0.725191249420
             le_variance =       0.525902348236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525934419433
                                         uncertainty =       0.013124475962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.525934419433
                                         uncertainty =       0.013124475962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000512788727
  error estimate for blocks of size 2^( 2) =       0.000530387075
  error estimate for blocks of size 2^( 3) =       0.000546025629
  error estimate for blocks of size 2^( 4) =       0.000556306792
  error estimate for blocks of size 2^( 5) =       0.000561851452
  error estimate for blocks of size 2^( 6) =       0.000565726621
  error estimate for blocks of size 2^( 7) =       0.000571023824

      target function =                  N/A
              le_mean =     -22.825903443968
             les_mean =     521.547772327608
             stat err =       0.000563727172
             autocorr =       1.208539916859
              std dev =       0.725192772436
             le_variance =       0.525904557193


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825903501166        initial
     6.2500e-02     6.2500e-01             3.3789e-03       -22.825906045553
     2.5000e-01     2.5000e+00             8.6955e-04       -22.825906096882  <--
     1.0000e+00     1.0000e+01             2.5731e-04       -22.825903443968

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.1176e+01
  </log>
  <optVariables href="FORM.s002.opt.xml">
 uu_0                 2.651144e-01 1 1  ON 0
 uu_1                 9.113756e-02 1 1  ON 1
 uu_2                -1.963186e-02 1 1  ON 2
 uu_3                -8.431339e-02 1 1  ON 3
 uu_4                -1.208775e-01 1 1  ON 4
 uu_5                -1.419846e-01 1 1  ON 5
 uu_6                -1.526409e-01 1 1  ON 6
 uu_7                -1.510431e-01 1 1  ON 7
 uu_8                -1.326816e-01 1 1  ON 8
 uu_9                -8.402975e-02 1 1  ON 9
 ud_0                 4.265746e-01 1 1  ON 10
 ud_1                 1.445168e-01 1 1  ON 11
 ud_2                -1.033183e-03 1 1  ON 12
 ud_3                -8.029377e-02 1 1  ON 13
 ud_4                -1.263130e-01 1 1  ON 14
 ud_5                -1.542471e-01 1 1  ON 15
 ud_6                -1.697847e-01 1 1  ON 16
 ud_7                -1.713412e-01 1 1  ON 17
 ud_8                -1.543411e-01 1 1  ON 18
 ud_9                -1.071861e-01 1 1  ON 19
 eC_0                -5.503600e-01 1 1  ON 20
 eC_1                -3.940802e-01 1 1  ON 21
 eC_2                -1.389588e-01 1 1  ON 22
 eC_3                 1.608264e-02 1 1  ON 23
 eC_4                 7.575724e-02 1 1  ON 24
 eC_5                 1.718667e-01 1 1  ON 25
 eC_6                 2.810433e-01 1 1  ON 26
 eC_7                 3.500360e-01 1 1  ON 27
 eC_8                 1.549531e-01 1 1  ON 28
 eC_9                 2.968881e-02 1 1  ON 29
 eO_0                -1.168004e+00 1 1  ON 30
 eO_1                -7.916390e-01 1 1  ON 31
 eO_2                -3.171079e-01 1 1  ON 32
 eO_3                 2.006419e-02 1 1  ON 33
 eO_4                 2.365492e-01 1 1  ON 34
 eO_5                 4.038298e-01 1 1  ON 35
 eO_6                 4.682204e-01 1 1  ON 36
 eO_7                 4.920559e-01 1 1  ON 37
 eO_8                 3.815119e-01 1 1  ON 38
 eO_9                 1.923364e-01 1 1  ON 39
eH1_0                -1.703290e-01 1 1  ON 40
eH1_1                -8.310849e-02 1 1  ON 41
eH1_2                -5.259524e-02 1 1  ON 42
eH1_3                -4.129239e-02 1 1  ON 43
eH1_4                 1.291673e-02 1 1  ON 44
eH1_5                 6.077092e-02 1 1  ON 45
eH1_6                 1.063926e-01 1 1  ON 46
eH1_7                 7.102822e-02 1 1  ON 47
eH1_8                -5.038235e-03 1 1  ON 48
eH1_9                 4.733724e-02 1 1  ON 49
eH2_0                -1.700819e-01 1 1  ON 50
eH2_1                -8.356167e-02 1 1  ON 51
eH2_2                -5.266055e-02 1 1  ON 52
eH2_3                -4.138966e-02 1 1  ON 53
eH2_4                 1.294211e-02 1 1  ON 54
eH2_5                 6.094293e-02 1 1  ON 55
eH2_6                 1.070134e-01 1 1  ON 56
eH2_7                 7.362767e-02 1 1  ON 57
eH2_8                -4.857108e-03 1 1  ON 58
eH2_9                 4.832121e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2005e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2840e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8747
    reference variance = 0.596029
====================================================
  Execution time = 4.3564e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0192e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5767e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501993928349
                                         uncertainty =       0.004092922953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501993928349
                                         uncertainty =       0.004092922953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500960233
  error estimate for blocks of size 2^( 2) =       0.000518929140
  error estimate for blocks of size 2^( 3) =       0.000534657862
  error estimate for blocks of size 2^( 4) =       0.000546290146
  error estimate for blocks of size 2^( 5) =       0.000553511375
  error estimate for blocks of size 2^( 6) =       0.000558477858
  error estimate for blocks of size 2^( 7) =       0.000559838002

      target function =                  N/A
              le_mean =     -22.825568543642
             les_mean =     521.508501399434
             stat err =       0.000554529345
             autocorr =       1.225300365054
              std dev =       0.708464755590
             le_variance =       0.501922309914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282556854364e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825568543642       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825569391108       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825566676025       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825567677097       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825569681291       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825569170306       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825569846077       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825571773498       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825570836733       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825572364285       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825571619940       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825571911571       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825572248182       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825573008068       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825572686866       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825573713151       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825573367647       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 3.366116e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825568543642       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825569024775       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825567424304       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825567332198       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825568574473       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825569205929       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825568883305       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825569693240       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825569453066       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825569914780       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825569641773       residual = 5.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825569644445       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825569722194       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825569672058       residual = 2.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 8.336500e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825568543642       residual = 9.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825568719941       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825568116062       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825567871197       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825568183220       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825568605751       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825568664820       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825568759586       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825568666106       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825568757916       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825568719254       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.091666e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9358e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.652753e-01 1 1  ON 0
 uu_1                 9.118736e-02 1 1  ON 1
 uu_2                -1.971923e-02 1 1  ON 2
 uu_3                -8.445685e-02 1 1  ON 3
 uu_4                -1.210082e-01 1 1  ON 4
 uu_5                -1.420838e-01 1 1  ON 5
 uu_6                -1.527405e-01 1 1  ON 6
 uu_7                -1.510138e-01 1 1  ON 7
 uu_8                -1.327343e-01 1 1  ON 8
 uu_9                -8.440554e-02 1 1  ON 9
 ud_0                 4.267396e-01 1 1  ON 10
 ud_1                 1.445625e-01 1 1  ON 11
 ud_2                -9.422053e-04 1 1  ON 12
 ud_3                -8.019874e-02 1 1  ON 13
 ud_4                -1.263370e-01 1 1  ON 14
 ud_5                -1.541212e-01 1 1  ON 15
 ud_6                -1.696452e-01 1 1  ON 16
 ud_7                -1.714019e-01 1 1  ON 17
 ud_8                -1.544630e-01 1 1  ON 18
 ud_9                -1.077966e-01 1 1  ON 19
 eC_0                -5.502167e-01 1 1  ON 20
 eC_1                -3.940381e-01 1 1  ON 21
 eC_2                -1.392231e-01 1 1  ON 22
 eC_3                 1.587812e-02 1 1  ON 23
 eC_4                 7.523805e-02 1 1  ON 24
 eC_5                 1.714479e-01 1 1  ON 25
 eC_6                 2.809306e-01 1 1  ON 26
 eC_7                 3.503890e-01 1 1  ON 27
 eC_8                 1.557181e-01 1 1  ON 28
 eC_9                 2.990385e-02 1 1  ON 29
 eO_0                -1.168716e+00 1 1  ON 30
 eO_1                -7.920674e-01 1 1  ON 31
 eO_2                -3.175809e-01 1 1  ON 32
 eO_3                 1.980289e-02 1 1  ON 33
 eO_4                 2.363455e-01 1 1  ON 34
 eO_5                 4.033641e-01 1 1  ON 35
 eO_6                 4.682835e-01 1 1  ON 36
 eO_7                 4.924259e-01 1 1  ON 37
 eO_8                 3.823456e-01 1 1  ON 38
 eO_9                 1.931625e-01 1 1  ON 39
eH1_0                -1.701226e-01 1 1  ON 40
eH1_1                -8.314844e-02 1 1  ON 41
eH1_2                -5.249551e-02 1 1  ON 42
eH1_3                -4.136939e-02 1 1  ON 43
eH1_4                 1.297462e-02 1 1  ON 44
eH1_5                 6.048568e-02 1 1  ON 45
eH1_6                 1.062345e-01 1 1  ON 46
eH1_7                 7.131640e-02 1 1  ON 47
eH1_8                -5.061408e-03 1 1  ON 48
eH1_9                 4.708687e-02 1 1  ON 49
eH2_0                -1.703123e-01 1 1  ON 50
eH2_1                -8.350505e-02 1 1  ON 51
eH2_2                -5.288678e-02 1 1  ON 52
eH2_3                -4.141089e-02 1 1  ON 53
eH2_4                 1.292849e-02 1 1  ON 54
eH2_5                 6.139973e-02 1 1  ON 55
eH2_6                 1.073231e-01 1 1  ON 56
eH2_7                 7.334032e-02 1 1  ON 57
eH2_8                -4.961482e-03 1 1  ON 58
eH2_9                 4.812697e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -22.8537
    reference variance = 0.272072
====================================================
  Execution time = 4.3437e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0423e-01
  Total weights = 2.0000e+06
  Execution time = 3.5467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504129076919
                                         uncertainty =       0.003398525893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504129076919
                                         uncertainty =       0.003398525893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501978167
  error estimate for blocks of size 2^( 2) =       0.000519863451
  error estimate for blocks of size 2^( 3) =       0.000535275721
  error estimate for blocks of size 2^( 4) =       0.000545883264
  error estimate for blocks of size 2^( 5) =       0.000552708197
  error estimate for blocks of size 2^( 6) =       0.000556821820
  error estimate for blocks of size 2^( 7) =       0.000558338014

      target function =                  N/A
              le_mean =     -22.825526783586
             les_mean =     521.508636855972
             stat err =       0.000553437824
             autocorr =       1.215536538323
              std dev =       0.709904331417
             le_variance =       0.503964159764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504576595877
                                         uncertainty =       0.003400887967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504576595877
                                         uncertainty =       0.003400887967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502200759
  error estimate for blocks of size 2^( 2) =       0.000520071982
  error estimate for blocks of size 2^( 3) =       0.000535466653
  error estimate for blocks of size 2^( 4) =       0.000546062821
  error estimate for blocks of size 2^( 5) =       0.000552878370
  error estimate for blocks of size 2^( 6) =       0.000556988264
  error estimate for blocks of size 2^( 7) =       0.000558507865

      target function =                  N/A
              le_mean =     -22.825530788890
             les_mean =     521.509266746071
             stat err =       0.000553609330
             autocorr =       1.215212065577
              std dev =       0.710219123742
             le_variance =       0.504411203729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504667348534
                                         uncertainty =       0.003401361945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504667348534
                                         uncertainty =       0.003401361945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502245916
  error estimate for blocks of size 2^( 2) =       0.000520115265
  error estimate for blocks of size 2^( 3) =       0.000535508281
  error estimate for blocks of size 2^( 4) =       0.000546105219
  error estimate for blocks of size 2^( 5) =       0.000552920599
  error estimate for blocks of size 2^( 6) =       0.000557031285
  error estimate for blocks of size 2^( 7) =       0.000558548838

      target function =                  N/A
              le_mean =     -22.825530976506
             les_mean =     521.509366026580
             stat err =       0.000553651485
             autocorr =       1.215178595634
              std dev =       0.710282985435
             le_variance =       0.504501919398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504246103155
                                         uncertainty =       0.003399145217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504246103155
                                         uncertainty =       0.003399145217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502036395
  error estimate for blocks of size 2^( 2) =       0.000519917981
  error estimate for blocks of size 2^( 3) =       0.000535326009
  error estimate for blocks of size 2^( 4) =       0.000545931481
  error estimate for blocks of size 2^( 5) =       0.000552754472
  error estimate for blocks of size 2^( 6) =       0.000556867764
  error estimate for blocks of size 2^( 7) =       0.000558384027

      target function =                  N/A
              le_mean =     -22.825527026595
             les_mean =     521.508764873307
             stat err =       0.000553484436
             autocorr =       1.215459301994
              std dev =       0.709986678412
             le_variance =       0.504081083522


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825526783586        initial
     6.2500e-02     6.2500e-01             3.3661e-03       -22.825530788890
     2.5000e-01     2.5000e+00             8.3365e-04       -22.825530976506  <--
     1.0000e+00     1.0000e+01             2.0917e-04       -22.825527026595

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.1210e+01
  </log>
  <optVariables href="FORM.s003.opt.xml">
 uu_0                 2.652753e-01 1 1  ON 0
 uu_1                 9.118736e-02 1 1  ON 1
 uu_2                -1.971923e-02 1 1  ON 2
 uu_3                -8.445685e-02 1 1  ON 3
 uu_4                -1.210082e-01 1 1  ON 4
 uu_5                -1.420838e-01 1 1  ON 5
 uu_6                -1.527405e-01 1 1  ON 6
 uu_7                -1.510138e-01 1 1  ON 7
 uu_8                -1.327343e-01 1 1  ON 8
 uu_9                -8.440554e-02 1 1  ON 9
 ud_0                 4.267396e-01 1 1  ON 10
 ud_1                 1.445625e-01 1 1  ON 11
 ud_2                -9.422053e-04 1 1  ON 12
 ud_3                -8.019874e-02 1 1  ON 13
 ud_4                -1.263370e-01 1 1  ON 14
 ud_5                -1.541212e-01 1 1  ON 15
 ud_6                -1.696452e-01 1 1  ON 16
 ud_7                -1.714019e-01 1 1  ON 17
 ud_8                -1.544630e-01 1 1  ON 18
 ud_9                -1.077966e-01 1 1  ON 19
 eC_0                -5.502167e-01 1 1  ON 20
 eC_1                -3.940381e-01 1 1  ON 21
 eC_2                -1.392231e-01 1 1  ON 22
 eC_3                 1.587812e-02 1 1  ON 23
 eC_4                 7.523805e-02 1 1  ON 24
 eC_5                 1.714479e-01 1 1  ON 25
 eC_6                 2.809306e-01 1 1  ON 26
 eC_7                 3.503890e-01 1 1  ON 27
 eC_8                 1.557181e-01 1 1  ON 28
 eC_9                 2.990385e-02 1 1  ON 29
 eO_0                -1.168716e+00 1 1  ON 30
 eO_1                -7.920674e-01 1 1  ON 31
 eO_2                -3.175809e-01 1 1  ON 32
 eO_3                 1.980289e-02 1 1  ON 33
 eO_4                 2.363455e-01 1 1  ON 34
 eO_5                 4.033641e-01 1 1  ON 35
 eO_6                 4.682835e-01 1 1  ON 36
 eO_7                 4.924259e-01 1 1  ON 37
 eO_8                 3.823456e-01 1 1  ON 38
 eO_9                 1.931625e-01 1 1  ON 39
eH1_0                -1.701226e-01 1 1  ON 40
eH1_1                -8.314844e-02 1 1  ON 41
eH1_2                -5.249551e-02 1 1  ON 42
eH1_3                -4.136939e-02 1 1  ON 43
eH1_4                 1.297462e-02 1 1  ON 44
eH1_5                 6.048568e-02 1 1  ON 45
eH1_6                 1.062345e-01 1 1  ON 46
eH1_7                 7.131640e-02 1 1  ON 47
eH1_8                -5.061408e-03 1 1  ON 48
eH1_9                 4.708687e-02 1 1  ON 49
eH2_0                -1.703123e-01 1 1  ON 50
eH2_1                -8.350505e-02 1 1  ON 51
eH2_2                -5.288678e-02 1 1  ON 52
eH2_3                -4.141089e-02 1 1  ON 53
eH2_4                 1.292849e-02 1 1  ON 54
eH2_5                 6.139973e-02 1 1  ON 55
eH2_6                 1.073231e-01 1 1  ON 56
eH2_7                 7.334032e-02 1 1  ON 57
eH2_8                -4.961482e-03 1 1  ON 58
eH2_9                 4.812697e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2058e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2846e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.8049
    reference variance = 0.380212
====================================================
  Execution time = 4.4494e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0553e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5175e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505598045857
                                         uncertainty =       0.007103970436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505598045857
                                         uncertainty =       0.007103970436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502759097
  error estimate for blocks of size 2^( 2) =       0.000520794973
  error estimate for blocks of size 2^( 3) =       0.000536677281
  error estimate for blocks of size 2^( 4) =       0.000548396105
  error estimate for blocks of size 2^( 5) =       0.000555059749
  error estimate for blocks of size 2^( 6) =       0.000559948933
  error estimate for blocks of size 2^( 7) =       0.000561180781

      target function =                  N/A
              le_mean =     -22.825325216527
             les_mean =     521.501004407263
             stat err =       0.000556146392
             autocorr =       1.223653261940
              std dev =       0.711008733984
             le_variance =       0.505533419801


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282532521653e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825325216527       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825327166684       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825328518237       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825326663147       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825327453113       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825328568147       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825327344527       residual = 1.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825328473889       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825330797464       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825329304667       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825330798667       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825331386498       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825332030135       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825331819154       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825331396581       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825331502752       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825331319049       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825331507303       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 4.115768e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825325216527       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825326479221       residual = 9.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825327371697       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825326323778       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825326331757       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825327143600       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825326639825       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825327122048       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825327751796       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825326993669       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825327369439       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825327521534       residual = 3.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825327527147       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 1.002262e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825325216527       residual = 7.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825325740452       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825326173321       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825325886943       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825325727241       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825326001513       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825325847657       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825326068062       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825326159619       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825325944175       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825326022747       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825326036775       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.493553e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254980 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9680e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.651728e-01 1 1  ON 0
 uu_1                 9.133534e-02 1 1  ON 1
 uu_2                -1.969692e-02 1 1  ON 2
 uu_3                -8.437703e-02 1 1  ON 3
 uu_4                -1.208747e-01 1 1  ON 4
 uu_5                -1.420883e-01 1 1  ON 5
 uu_6                -1.529563e-01 1 1  ON 6
 uu_7                -1.512286e-01 1 1  ON 7
 uu_8                -1.329951e-01 1 1  ON 8
 uu_9                -8.455600e-02 1 1  ON 9
 ud_0                 4.269383e-01 1 1  ON 10
 ud_1                 1.444186e-01 1 1  ON 11
 ud_2                -8.616554e-04 1 1  ON 12
 ud_3                -8.033983e-02 1 1  ON 13
 ud_4                -1.263067e-01 1 1  ON 14
 ud_5                -1.542292e-01 1 1  ON 15
 ud_6                -1.697155e-01 1 1  ON 16
 ud_7                -1.710753e-01 1 1  ON 17
 ud_8                -1.541623e-01 1 1  ON 18
 ud_9                -1.080145e-01 1 1  ON 19
 eC_0                -5.505595e-01 1 1  ON 20
 eC_1                -3.940973e-01 1 1  ON 21
 eC_2                -1.394595e-01 1 1  ON 22
 eC_3                 1.596162e-02 1 1  ON 23
 eC_4                 7.531169e-02 1 1  ON 24
 eC_5                 1.711144e-01 1 1  ON 25
 eC_6                 2.803946e-01 1 1  ON 26
 eC_7                 3.507742e-01 1 1  ON 27
 eC_8                 1.564818e-01 1 1  ON 28
 eC_9                 3.011682e-02 1 1  ON 29
 eO_0                -1.169100e+00 1 1  ON 30
 eO_1                -7.927707e-01 1 1  ON 31
 eO_2                -3.177687e-01 1 1  ON 32
 eO_3                 1.914806e-02 1 1  ON 33
 eO_4                 2.356413e-01 1 1  ON 34
 eO_5                 4.030614e-01 1 1  ON 35
 eO_6                 4.686973e-01 1 1  ON 36
 eO_7                 4.928466e-01 1 1  ON 37
 eO_8                 3.833478e-01 1 1  ON 38
 eO_9                 1.939777e-01 1 1  ON 39
eH1_0                -1.699508e-01 1 1  ON 40
eH1_1                -8.297955e-02 1 1  ON 41
eH1_2                -5.283001e-02 1 1  ON 42
eH1_3                -4.150098e-02 1 1  ON 43
eH1_4                 1.281546e-02 1 1  ON 44
eH1_5                 6.050943e-02 1 1  ON 45
eH1_6                 1.066186e-01 1 1  ON 46
eH1_7                 7.151035e-02 1 1  ON 47
eH1_8                -5.355413e-03 1 1  ON 48
eH1_9                 4.682810e-02 1 1  ON 49
eH2_0                -1.704920e-01 1 1  ON 50
eH2_1                -8.320684e-02 1 1  ON 51
eH2_2                -5.303611e-02 1 1  ON 52
eH2_3                -4.131119e-02 1 1  ON 53
eH2_4                 1.318311e-02 1 1  ON 54
eH2_5                 6.126540e-02 1 1  ON 55
eH2_6                 1.072282e-01 1 1  ON 56
eH2_7                 7.326997e-02 1 1  ON 57
eH2_8                -5.139096e-03 1 1  ON 58
eH2_9                 4.796735e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -22.7203
    reference variance = 0.388165
====================================================
  Execution time = 4.3841e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1992e-01
  Total weights = 2.0000e+06
  Execution time = 3.5273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519837837928
                                         uncertainty =       0.007737272243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519837837928
                                         uncertainty =       0.007737272243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509800313
  error estimate for blocks of size 2^( 2) =       0.000527243969
  error estimate for blocks of size 2^( 3) =       0.000542176568
  error estimate for blocks of size 2^( 4) =       0.000553074799
  error estimate for blocks of size 2^( 5) =       0.000558416078
  error estimate for blocks of size 2^( 6) =       0.000561696071
  error estimate for blocks of size 2^( 7) =       0.000562822549

      target function =                  N/A
              le_mean =     -22.825303674408
             les_mean =     521.514280287761
             stat err =       0.000559002374
             autocorr =       1.202339484193
              std dev =       0.720966517043
             le_variance =       0.519792718698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520046987731
                                         uncertainty =       0.007742639127

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520046987731
                                         uncertainty =       0.007742639127

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509902702
  error estimate for blocks of size 2^( 2) =       0.000527341553
  error estimate for blocks of size 2^( 3) =       0.000542269019
  error estimate for blocks of size 2^( 4) =       0.000553155657
  error estimate for blocks of size 2^( 5) =       0.000558494814
  error estimate for blocks of size 2^( 6) =       0.000561761218
  error estimate for blocks of size 2^( 7) =       0.000562893441

      target function =                  N/A
              le_mean =     -22.825310756895
             les_mean =     521.514812419877
             stat err =       0.000559076282
             autocorr =       1.202174497044
              std dev =       0.721111316694
             le_variance =       0.520001531064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520116986818
                                         uncertainty =       0.007740920823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520116986818
                                         uncertainty =       0.007740920823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509936959
  error estimate for blocks of size 2^( 2) =       0.000527375814
  error estimate for blocks of size 2^( 3) =       0.000542305405
  error estimate for blocks of size 2^( 4) =       0.000553191670
  error estimate for blocks of size 2^( 5) =       0.000558535945
  error estimate for blocks of size 2^( 6) =       0.000561801231
  error estimate for blocks of size 2^( 7) =       0.000562934605

      target function =                  N/A
              le_mean =     -22.825312737403
             les_mean =     521.514972704436
             stat err =       0.000559115862
             autocorr =       1.202183181561
              std dev =       0.721159763318
             le_variance =       0.520071404229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519903906226
                                         uncertainty =       0.007737419808

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519903906226
                                         uncertainty =       0.007737419808

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509832653
  error estimate for blocks of size 2^( 2) =       0.000527275097
  error estimate for blocks of size 2^( 3) =       0.000542206843
  error estimate for blocks of size 2^( 4) =       0.000553102211
  error estimate for blocks of size 2^( 5) =       0.000558444908
  error estimate for blocks of size 2^( 6) =       0.000561721451
  error estimate for blocks of size 2^( 7) =       0.000562849887

      target function =                  N/A
              le_mean =     -22.825305334255
             les_mean =     521.514422009339
             stat err =       0.000559029614
             autocorr =       1.202304123315
              std dev =       0.721012251841
             le_variance =       0.519858667305


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825303674408        initial
     6.2500e-02     6.2500e-01             4.1158e-03       -22.825310756895
     2.5000e-01     2.5000e+00             1.0023e-03       -22.825312737403  <--
     1.0000e+00     1.0000e+01             2.4936e-04       -22.825305334255

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.1499e+01
  </log>
  <optVariables href="FORM.s004.opt.xml">
 uu_0                 2.651728e-01 1 1  ON 0
 uu_1                 9.133534e-02 1 1  ON 1
 uu_2                -1.969692e-02 1 1  ON 2
 uu_3                -8.437703e-02 1 1  ON 3
 uu_4                -1.208747e-01 1 1  ON 4
 uu_5                -1.420883e-01 1 1  ON 5
 uu_6                -1.529563e-01 1 1  ON 6
 uu_7                -1.512286e-01 1 1  ON 7
 uu_8                -1.329951e-01 1 1  ON 8
 uu_9                -8.455600e-02 1 1  ON 9
 ud_0                 4.269383e-01 1 1  ON 10
 ud_1                 1.444186e-01 1 1  ON 11
 ud_2                -8.616554e-04 1 1  ON 12
 ud_3                -8.033983e-02 1 1  ON 13
 ud_4                -1.263067e-01 1 1  ON 14
 ud_5                -1.542292e-01 1 1  ON 15
 ud_6                -1.697155e-01 1 1  ON 16
 ud_7                -1.710753e-01 1 1  ON 17
 ud_8                -1.541623e-01 1 1  ON 18
 ud_9                -1.080145e-01 1 1  ON 19
 eC_0                -5.505595e-01 1 1  ON 20
 eC_1                -3.940973e-01 1 1  ON 21
 eC_2                -1.394595e-01 1 1  ON 22
 eC_3                 1.596162e-02 1 1  ON 23
 eC_4                 7.531169e-02 1 1  ON 24
 eC_5                 1.711144e-01 1 1  ON 25
 eC_6                 2.803946e-01 1 1  ON 26
 eC_7                 3.507742e-01 1 1  ON 27
 eC_8                 1.564818e-01 1 1  ON 28
 eC_9                 3.011682e-02 1 1  ON 29
 eO_0                -1.169100e+00 1 1  ON 30
 eO_1                -7.927707e-01 1 1  ON 31
 eO_2                -3.177687e-01 1 1  ON 32
 eO_3                 1.914806e-02 1 1  ON 33
 eO_4                 2.356413e-01 1 1  ON 34
 eO_5                 4.030614e-01 1 1  ON 35
 eO_6                 4.686973e-01 1 1  ON 36
 eO_7                 4.928466e-01 1 1  ON 37
 eO_8                 3.833478e-01 1 1  ON 38
 eO_9                 1.939777e-01 1 1  ON 39
eH1_0                -1.699508e-01 1 1  ON 40
eH1_1                -8.297955e-02 1 1  ON 41
eH1_2                -5.283001e-02 1 1  ON 42
eH1_3                -4.150098e-02 1 1  ON 43
eH1_4                 1.281546e-02 1 1  ON 44
eH1_5                 6.050943e-02 1 1  ON 45
eH1_6                 1.066186e-01 1 1  ON 46
eH1_7                 7.151035e-02 1 1  ON 47
eH1_8                -5.355413e-03 1 1  ON 48
eH1_9                 4.682810e-02 1 1  ON 49
eH2_0                -1.704920e-01 1 1  ON 50
eH2_1                -8.320684e-02 1 1  ON 51
eH2_2                -5.303611e-02 1 1  ON 52
eH2_3                -4.131119e-02 1 1  ON 53
eH2_4                 1.318311e-02 1 1  ON 54
eH2_5                 6.126540e-02 1 1  ON 55
eH2_6                 1.072282e-01 1 1  ON 56
eH2_7                 7.326997e-02 1 1  ON 57
eH2_8                -5.139096e-03 1 1  ON 58
eH2_9                 4.796735e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2119e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2829e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7932
    reference variance = 0.434936
====================================================
  Execution time = 4.4282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9765e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5313e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497470782611
                                         uncertainty =       0.002952419584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.497470782611
                                         uncertainty =       0.002952419584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498823355
  error estimate for blocks of size 2^( 2) =       0.000517059384
  error estimate for blocks of size 2^( 3) =       0.000533115614
  error estimate for blocks of size 2^( 4) =       0.000543978287
  error estimate for blocks of size 2^( 5) =       0.000551230541
  error estimate for blocks of size 2^( 6) =       0.000557075146
  error estimate for blocks of size 2^( 7) =       0.000559557752

      target function =                  N/A
              le_mean =     -22.825305336130
             les_mean =     521.492212917406
             stat err =       0.000552960431
             autocorr =       1.228837773800
              std dev =       0.705442753641
             le_variance =       0.497649478664


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282530533613e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825305336130       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825308931130       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825309951303       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825310824685       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825312382498       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825309561930       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825306823815       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825310666606       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825310741963       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825311512664       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825312274489       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825313033160       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825313742276       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825313109064       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825313341512       residual = 7.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825313747109       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825313856600       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825313813241       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 3.757076e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825305336130       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825307530261       residual = 5.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825308219405       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825308338381       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825309253179       residual = 9.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825307912767       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825307530764       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825307134409       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825308696945       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825308264010       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825308660111       residual = 3.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825308622757       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825308766913       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825308749404       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 9.393203e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825305336130       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825306193652       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825306515996       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825306535616       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825306847600       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825306524319       residual = 9.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825306576521       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825306328377       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825306649137       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825306604082       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825306531091       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825306614176       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.349579e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9606e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.651764e-01 1 1  ON 0
 uu_1                 9.129305e-02 1 1  ON 1
 uu_2                -1.962580e-02 1 1  ON 2
 uu_3                -8.433567e-02 1 1  ON 3
 uu_4                -1.209409e-01 1 1  ON 4
 uu_5                -1.421081e-01 1 1  ON 5
 uu_6                -1.529178e-01 1 1  ON 6
 uu_7                -1.516056e-01 1 1  ON 7
 uu_8                -1.332909e-01 1 1  ON 8
 uu_9                -8.472529e-02 1 1  ON 9
 ud_0                 4.266364e-01 1 1  ON 10
 ud_1                 1.445368e-01 1 1  ON 11
 ud_2                -9.925302e-04 1 1  ON 12
 ud_3                -8.031356e-02 1 1  ON 13
 ud_4                -1.262391e-01 1 1  ON 14
 ud_5                -1.541376e-01 1 1  ON 15
 ud_6                -1.698684e-01 1 1  ON 16
 ud_7                -1.710208e-01 1 1  ON 17
 ud_8                -1.540569e-01 1 1  ON 18
 ud_9                -1.081775e-01 1 1  ON 19
 eC_0                -5.505292e-01 1 1  ON 20
 eC_1                -3.941788e-01 1 1  ON 21
 eC_2                -1.397664e-01 1 1  ON 22
 eC_3                 1.543112e-02 1 1  ON 23
 eC_4                 7.512817e-02 1 1  ON 24
 eC_5                 1.707816e-01 1 1  ON 25
 eC_6                 2.802877e-01 1 1  ON 26
 eC_7                 3.512956e-01 1 1  ON 27
 eC_8                 1.572562e-01 1 1  ON 28
 eC_9                 3.032102e-02 1 1  ON 29
 eO_0                -1.169649e+00 1 1  ON 30
 eO_1                -7.932911e-01 1 1  ON 31
 eO_2                -3.181631e-01 1 1  ON 32
 eO_3                 1.875490e-02 1 1  ON 33
 eO_4                 2.355464e-01 1 1  ON 34
 eO_5                 4.029771e-01 1 1  ON 35
 eO_6                 4.684543e-01 1 1  ON 36
 eO_7                 4.929520e-01 1 1  ON 37
 eO_8                 3.842871e-01 1 1  ON 38
 eO_9                 1.947918e-01 1 1  ON 39
eH1_0                -1.704356e-01 1 1  ON 40
eH1_1                -8.266614e-02 1 1  ON 41
eH1_2                -5.304375e-02 1 1  ON 42
eH1_3                -4.159689e-02 1 1  ON 43
eH1_4                 1.268444e-02 1 1  ON 44
eH1_5                 6.055302e-02 1 1  ON 45
eH1_6                 1.068899e-01 1 1  ON 46
eH1_7                 7.185661e-02 1 1  ON 47
eH1_8                -5.470353e-03 1 1  ON 48
eH1_9                 4.660790e-02 1 1  ON 49
eH2_0                -1.703932e-01 1 1  ON 50
eH2_1                -8.363029e-02 1 1  ON 51
eH2_2                -5.308486e-02 1 1  ON 52
eH2_3                -4.143500e-02 1 1  ON 53
eH2_4                 1.328884e-02 1 1  ON 54
eH2_5                 6.120322e-02 1 1  ON 55
eH2_6                 1.069578e-01 1 1  ON 56
eH2_7                 7.376792e-02 1 1  ON 57
eH2_8                -4.889791e-03 1 1  ON 58
eH2_9                 4.775526e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -22.7918
    reference variance = 0.502417
====================================================
  Execution time = 4.3344e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2824e+01
  VMC Evar = 4.9883e-01
  Total weights = 2.0000e+06
  Execution time = 3.5321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499054770730
                                         uncertainty =       0.003480440371

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499054770730
                                         uncertainty =       0.003480440371

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499526493
  error estimate for blocks of size 2^( 2) =       0.000517471431
  error estimate for blocks of size 2^( 3) =       0.000533342056
  error estimate for blocks of size 2^( 4) =       0.000543584535
  error estimate for blocks of size 2^( 5) =       0.000549865493
  error estimate for blocks of size 2^( 6) =       0.000553594040
  error estimate for blocks of size 2^( 7) =       0.000552551731

      target function =                  N/A
              le_mean =     -22.824255337214
             les_mean =     521.445684883269
             stat err =       0.000549898950
             autocorr =       1.211849609586
              std dev =       0.706437141190
             le_variance =       0.499053434452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498772390278
                                         uncertainty =       0.003480787564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498772390278
                                         uncertainty =       0.003480787564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499385246
  error estimate for blocks of size 2^( 2) =       0.000517329750
  error estimate for blocks of size 2^( 3) =       0.000533199732
  error estimate for blocks of size 2^( 4) =       0.000543439265
  error estimate for blocks of size 2^( 5) =       0.000549714336
  error estimate for blocks of size 2^( 6) =       0.000553452662
  error estimate for blocks of size 2^( 7) =       0.000552391280

      target function =                  N/A
              le_mean =     -22.824259131243
             les_mean =     521.445575889487
             stat err =       0.000549749386
             autocorr =       1.211875735420
              std dev =       0.706237388388
             le_variance =       0.498771248758

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498612446531
                                         uncertainty =       0.003480530912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498612446531
                                         uncertainty =       0.003480530912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499305189
  error estimate for blocks of size 2^( 2) =       0.000517252659
  error estimate for blocks of size 2^( 3) =       0.000533126208
  error estimate for blocks of size 2^( 4) =       0.000543366680
  error estimate for blocks of size 2^( 5) =       0.000549644370
  error estimate for blocks of size 2^( 6) =       0.000553389030
  error estimate for blocks of size 2^( 7) =       0.000552325396

      target function =                  N/A
              le_mean =     -22.824262251486
             les_mean =     521.445558419524
             stat err =       0.000549681369
             autocorr =       1.211964432605
              std dev =       0.706124170532
             le_variance =       0.498611344209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498942025020
                                         uncertainty =       0.003480408923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498942025020
                                         uncertainty =       0.003480408923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499470089
  error estimate for blocks of size 2^( 2) =       0.000517415505
  error estimate for blocks of size 2^( 3) =       0.000533286756
  error estimate for blocks of size 2^( 4) =       0.000543528564
  error estimate for blocks of size 2^( 5) =       0.000549808623
  error estimate for blocks of size 2^( 6) =       0.000553541223
  error estimate for blocks of size 2^( 7) =       0.000552494037

      target function =                  N/A
              le_mean =     -22.824256384306
             les_mean =     521.445619987007
             stat err =       0.000549843112
             autocorr =       1.211877176804
              std dev =       0.706357374097
             le_variance =       0.498940739942


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824255337214        initial
     6.2500e-02     6.2500e-01             3.7571e-03       -22.824259131243
     2.5000e-01     2.5000e+00             9.3932e-04       -22.824262251486  <--
     1.0000e+00     1.0000e+01             2.3496e-04       -22.824256384306

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 6.4924e+01
  </log>
  <optVariables href="FORM.s005.opt.xml">
 uu_0                 2.651764e-01 1 1  ON 0
 uu_1                 9.129305e-02 1 1  ON 1
 uu_2                -1.962580e-02 1 1  ON 2
 uu_3                -8.433567e-02 1 1  ON 3
 uu_4                -1.209409e-01 1 1  ON 4
 uu_5                -1.421081e-01 1 1  ON 5
 uu_6                -1.529178e-01 1 1  ON 6
 uu_7                -1.516056e-01 1 1  ON 7
 uu_8                -1.332909e-01 1 1  ON 8
 uu_9                -8.472529e-02 1 1  ON 9
 ud_0                 4.266364e-01 1 1  ON 10
 ud_1                 1.445368e-01 1 1  ON 11
 ud_2                -9.925302e-04 1 1  ON 12
 ud_3                -8.031356e-02 1 1  ON 13
 ud_4                -1.262391e-01 1 1  ON 14
 ud_5                -1.541376e-01 1 1  ON 15
 ud_6                -1.698684e-01 1 1  ON 16
 ud_7                -1.710208e-01 1 1  ON 17
 ud_8                -1.540569e-01 1 1  ON 18
 ud_9                -1.081775e-01 1 1  ON 19
 eC_0                -5.505292e-01 1 1  ON 20
 eC_1                -3.941788e-01 1 1  ON 21
 eC_2                -1.397664e-01 1 1  ON 22
 eC_3                 1.543112e-02 1 1  ON 23
 eC_4                 7.512817e-02 1 1  ON 24
 eC_5                 1.707816e-01 1 1  ON 25
 eC_6                 2.802877e-01 1 1  ON 26
 eC_7                 3.512956e-01 1 1  ON 27
 eC_8                 1.572562e-01 1 1  ON 28
 eC_9                 3.032102e-02 1 1  ON 29
 eO_0                -1.169649e+00 1 1  ON 30
 eO_1                -7.932911e-01 1 1  ON 31
 eO_2                -3.181631e-01 1 1  ON 32
 eO_3                 1.875490e-02 1 1  ON 33
 eO_4                 2.355464e-01 1 1  ON 34
 eO_5                 4.029771e-01 1 1  ON 35
 eO_6                 4.684543e-01 1 1  ON 36
 eO_7                 4.929520e-01 1 1  ON 37
 eO_8                 3.842871e-01 1 1  ON 38
 eO_9                 1.947918e-01 1 1  ON 39
eH1_0                -1.704356e-01 1 1  ON 40
eH1_1                -8.266614e-02 1 1  ON 41
eH1_2                -5.304375e-02 1 1  ON 42
eH1_3                -4.159689e-02 1 1  ON 43
eH1_4                 1.268444e-02 1 1  ON 44
eH1_5                 6.055302e-02 1 1  ON 45
eH1_6                 1.068899e-01 1 1  ON 46
eH1_7                 7.185661e-02 1 1  ON 47
eH1_8                -5.470353e-03 1 1  ON 48
eH1_9                 4.660790e-02 1 1  ON 49
eH2_0                -1.703932e-01 1 1  ON 50
eH2_1                -8.363029e-02 1 1  ON 51
eH2_2                -5.308486e-02 1 1  ON 52
eH2_3                -4.143500e-02 1 1  ON 53
eH2_4                 1.328884e-02 1 1  ON 54
eH2_5                 6.120322e-02 1 1  ON 55
eH2_6                 1.069578e-01 1 1  ON 56
eH2_7                 7.376792e-02 1 1  ON 57
eH2_8                -4.889791e-03 1 1  ON 58
eH2_9                 4.775526e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2455e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2823e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7897
    reference variance = 0.405954
====================================================
  Execution time = 4.4080e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0785e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5547e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507899939747
                                         uncertainty =       0.007233553267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507899939747
                                         uncertainty =       0.007233553267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503911091
  error estimate for blocks of size 2^( 2) =       0.000521676179
  error estimate for blocks of size 2^( 3) =       0.000537288057
  error estimate for blocks of size 2^( 4) =       0.000548642183
  error estimate for blocks of size 2^( 5) =       0.000555404606
  error estimate for blocks of size 2^( 6) =       0.000557341340
  error estimate for blocks of size 2^( 7) =       0.000558685171

      target function =                  N/A
              le_mean =     -22.825161487491
             les_mean =     521.495849450611
             stat err =       0.000555018325
             autocorr =       1.213128515080
              std dev =       0.712637898588
             le_variance =       0.507852774504


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282516148749e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825161487491       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825162365235       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825161429382       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825159896269       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825161569168       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825162302874       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825162720625       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825165870323       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825164330541       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825165042425       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825166666469       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825167328007       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825165404716       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825165035518       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825165998399       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825166113087       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825165874227       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825165857306       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-02 is 3.161633e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825161487491       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825161973045       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825161611211       residual = 4.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825160469748       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825161155815       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825162341154       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825162055424       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825162966690       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825162433463       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825162772574       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825162902961       residual = 4.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825162857000       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825162666169       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e-01 is 7.678235e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825161487491       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825161661696       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825161564927       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825161122524       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825161275308       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825161763698       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825161791091       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825161823182       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825161808273       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825161785218       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825161831946       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825161790708       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+00 is 2.088706e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270086 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9638e+01
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.651036e-01 1 1  ON 0
 uu_1                 9.130334e-02 1 1  ON 1
 uu_2                -1.956717e-02 1 1  ON 2
 uu_3                -8.439906e-02 1 1  ON 3
 uu_4                -1.210657e-01 1 1  ON 4
 uu_5                -1.423592e-01 1 1  ON 5
 uu_6                -1.530325e-01 1 1  ON 6
 uu_7                -1.514719e-01 1 1  ON 7
 uu_8                -1.331989e-01 1 1  ON 8
 uu_9                -8.507633e-02 1 1  ON 9
 ud_0                 4.267277e-01 1 1  ON 10
 ud_1                 1.446486e-01 1 1  ON 11
 ud_2                -8.980286e-04 1 1  ON 12
 ud_3                -8.020605e-02 1 1  ON 13
 ud_4                -1.262145e-01 1 1  ON 14
 ud_5                -1.540827e-01 1 1  ON 15
 ud_6                -1.698551e-01 1 1  ON 16
 ud_7                -1.713460e-01 1 1  ON 17
 ud_8                -1.543622e-01 1 1  ON 18
 ud_9                -1.083497e-01 1 1  ON 19
 eC_0                -5.507297e-01 1 1  ON 20
 eC_1                -3.945554e-01 1 1  ON 21
 eC_2                -1.399082e-01 1 1  ON 22
 eC_3                 1.537905e-02 1 1  ON 23
 eC_4                 7.458138e-02 1 1  ON 24
 eC_5                 1.707768e-01 1 1  ON 25
 eC_6                 2.802958e-01 1 1  ON 26
 eC_7                 3.516122e-01 1 1  ON 27
 eC_8                 1.579905e-01 1 1  ON 28
 eC_9                 3.056546e-02 1 1  ON 29
 eO_0                -1.170328e+00 1 1  ON 30
 eO_1                -7.935627e-01 1 1  ON 31
 eO_2                -3.185568e-01 1 1  ON 32
 eO_3                 1.823459e-02 1 1  ON 33
 eO_4                 2.351835e-01 1 1  ON 34
 eO_5                 4.031877e-01 1 1  ON 35
 eO_6                 4.680936e-01 1 1  ON 36
 eO_7                 4.933797e-01 1 1  ON 37
 eO_8                 3.850351e-01 1 1  ON 38
 eO_9                 1.955596e-01 1 1  ON 39
eH1_0                -1.703949e-01 1 1  ON 40
eH1_1                -8.316933e-02 1 1  ON 41
eH1_2                -5.289772e-02 1 1  ON 42
eH1_3                -4.182148e-02 1 1  ON 43
eH1_4                 1.252147e-02 1 1  ON 44
eH1_5                 6.042772e-02 1 1  ON 45
eH1_6                 1.069317e-01 1 1  ON 46
eH1_7                 7.260023e-02 1 1  ON 47
eH1_8                -5.492269e-03 1 1  ON 48
eH1_9                 4.636497e-02 1 1  ON 49
eH2_0                -1.706217e-01 1 1  ON 50
eH2_1                -8.397573e-02 1 1  ON 51
eH2_2                -5.310764e-02 1 1  ON 52
eH2_3                -4.149252e-02 1 1  ON 53
eH2_4                 1.325294e-02 1 1  ON 54
eH2_5                 6.131316e-02 1 1  ON 55
eH2_6                 1.075761e-01 1 1  ON 56
eH2_7                 7.371315e-02 1 1  ON 57
eH2_8                -4.861588e-03 1 1  ON 58
eH2_9                 4.752680e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -22.7658
    reference variance = 0.355956
====================================================
  Execution time = 4.3490e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9466e-01
  Total weights = 2.0000e+06
  Execution time = 3.5285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494709292906
                                         uncertainty =       0.003190209325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494709292906
                                         uncertainty =       0.003190209325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497313034
  error estimate for blocks of size 2^( 2) =       0.000515168333
  error estimate for blocks of size 2^( 3) =       0.000530445137
  error estimate for blocks of size 2^( 4) =       0.000542910582
  error estimate for blocks of size 2^( 5) =       0.000548598342
  error estimate for blocks of size 2^( 6) =       0.000552208397
  error estimate for blocks of size 2^( 7) =       0.000553866929

      target function =                  N/A
              le_mean =     -22.824903976041
             les_mean =     521.470881775234
             stat err =       0.000549396062
             autocorr =       1.220425861447
              std dev =       0.703306837052
             le_variance =       0.494640507044

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494908369391
                                         uncertainty =       0.003190243996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494908369391
                                         uncertainty =       0.003190243996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497413081
  error estimate for blocks of size 2^( 2) =       0.000515263332
  error estimate for blocks of size 2^( 3) =       0.000530527201
  error estimate for blocks of size 2^( 4) =       0.000542982380
  error estimate for blocks of size 2^( 5) =       0.000548663451
  error estimate for blocks of size 2^( 6) =       0.000552273649
  error estimate for blocks of size 2^( 7) =       0.000553920764

      target function =                  N/A
              le_mean =     -22.824903572356
             les_mean =     521.471062386951
             stat err =       0.000549460061
             autocorr =       1.220219203161
              std dev =       0.703448325751
             le_variance =       0.494839547002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494755600749
                                         uncertainty =       0.003189964710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494755600749
                                         uncertainty =       0.003189964710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497336352
  error estimate for blocks of size 2^( 2) =       0.000515192993
  error estimate for blocks of size 2^( 3) =       0.000530463708
  error estimate for blocks of size 2^( 4) =       0.000542924168
  error estimate for blocks of size 2^( 5) =       0.000548609263
  error estimate for blocks of size 2^( 6) =       0.000552222267
  error estimate for blocks of size 2^( 7) =       0.000553868048

      target function =                  N/A
              le_mean =     -22.824903235485
             les_mean =     521.470894355246
             stat err =       0.000549405936
             autocorr =       1.220355286837
              std dev =       0.703339813552
             le_variance =       0.494686893327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494705113634
                                         uncertainty =       0.003190175837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.494705113634
                                         uncertainty =       0.003190175837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497310945
  error estimate for blocks of size 2^( 2) =       0.000515166806
  error estimate for blocks of size 2^( 3) =       0.000530442660
  error estimate for blocks of size 2^( 4) =       0.000542907348
  error estimate for blocks of size 2^( 5) =       0.000548594843
  error estimate for blocks of size 2^( 6) =       0.000552205261
  error estimate for blocks of size 2^( 7) =       0.000553861040

      target function =                  N/A
              le_mean =     -22.824903120223
             les_mean =     521.470838553038
             stat err =       0.000549392123
             autocorr =       1.220418609060
              std dev =       0.703303883658
             le_variance =       0.494636352768


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824903976041        initial  <--
     6.2500e-02     6.2500e-01             3.1616e-03       -22.824903572356
     2.5000e-01     2.5000e+00             7.6782e-04       -22.824903235485
     1.0000e+00     1.0000e+01             2.0887e-04       -22.824903120223

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.1844
  </log>
  <optVariables href="FORM.s006.opt.xml">
 uu_0                 2.651764e-01 1 1  ON 0
 uu_1                 9.129305e-02 1 1  ON 1
 uu_2                -1.962580e-02 1 1  ON 2
 uu_3                -8.433567e-02 1 1  ON 3
 uu_4                -1.209409e-01 1 1  ON 4
 uu_5                -1.421081e-01 1 1  ON 5
 uu_6                -1.529178e-01 1 1  ON 6
 uu_7                -1.516056e-01 1 1  ON 7
 uu_8                -1.332909e-01 1 1  ON 8
 uu_9                -8.472529e-02 1 1  ON 9
 ud_0                 4.266364e-01 1 1  ON 10
 ud_1                 1.445368e-01 1 1  ON 11
 ud_2                -9.925302e-04 1 1  ON 12
 ud_3                -8.031356e-02 1 1  ON 13
 ud_4                -1.262391e-01 1 1  ON 14
 ud_5                -1.541376e-01 1 1  ON 15
 ud_6                -1.698684e-01 1 1  ON 16
 ud_7                -1.710208e-01 1 1  ON 17
 ud_8                -1.540569e-01 1 1  ON 18
 ud_9                -1.081775e-01 1 1  ON 19
 eC_0                -5.505292e-01 1 1  ON 20
 eC_1                -3.941788e-01 1 1  ON 21
 eC_2                -1.397664e-01 1 1  ON 22
 eC_3                 1.543112e-02 1 1  ON 23
 eC_4                 7.512817e-02 1 1  ON 24
 eC_5                 1.707816e-01 1 1  ON 25
 eC_6                 2.802877e-01 1 1  ON 26
 eC_7                 3.512956e-01 1 1  ON 27
 eC_8                 1.572562e-01 1 1  ON 28
 eC_9                 3.032102e-02 1 1  ON 29
 eO_0                -1.169649e+00 1 1  ON 30
 eO_1                -7.932911e-01 1 1  ON 31
 eO_2                -3.181631e-01 1 1  ON 32
 eO_3                 1.875490e-02 1 1  ON 33
 eO_4                 2.355464e-01 1 1  ON 34
 eO_5                 4.029771e-01 1 1  ON 35
 eO_6                 4.684543e-01 1 1  ON 36
 eO_7                 4.929520e-01 1 1  ON 37
 eO_8                 3.842871e-01 1 1  ON 38
 eO_9                 1.947918e-01 1 1  ON 39
eH1_0                -1.704356e-01 1 1  ON 40
eH1_1                -8.266614e-02 1 1  ON 41
eH1_2                -5.304375e-02 1 1  ON 42
eH1_3                -4.159689e-02 1 1  ON 43
eH1_4                 1.268444e-02 1 1  ON 44
eH1_5                 6.055302e-02 1 1  ON 45
eH1_6                 1.068899e-01 1 1  ON 46
eH1_7                 7.185661e-02 1 1  ON 47
eH1_8                -5.470353e-03 1 1  ON 48
eH1_9                 4.660790e-02 1 1  ON 49
eH2_0                -1.703932e-01 1 1  ON 50
eH2_1                -8.363029e-02 1 1  ON 51
eH2_2                -5.308486e-02 1 1  ON 52
eH2_3                -4.143500e-02 1 1  ON 53
eH2_4                 1.328884e-02 1 1  ON 54
eH2_5                 6.120322e-02 1 1  ON 55
eH2_6                 1.069578e-01 1 1  ON 56
eH2_7                 7.376792e-02 1 1  ON 57
eH2_8                -4.889791e-03 1 1  ON 58
eH2_9                 4.775526e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2083e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2817e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7911
    reference variance = 0.289553
====================================================
  Execution time = 4.3869e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0499e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4919e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505040019491
                                         uncertainty =       0.003564516392

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505040019491
                                         uncertainty =       0.003564516392

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502488599
  error estimate for blocks of size 2^( 2) =       0.000520623284
  error estimate for blocks of size 2^( 3) =       0.000536676242
  error estimate for blocks of size 2^( 4) =       0.000547936630
  error estimate for blocks of size 2^( 5) =       0.000555675508
  error estimate for blocks of size 2^( 6) =       0.000559183891
  error estimate for blocks of size 2^( 7) =       0.000560783053

      target function =                  N/A
              le_mean =     -22.825328019385
             les_mean =     521.500588523366
             stat err =       0.000555894770
             autocorr =       1.223862851182
              std dev =       0.710626191009
             le_variance =       0.504989583347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282532801938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825328019385       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825328808261       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825328720137       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825329570212       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825329749593       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825328147972       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825328130608       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825328562554       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825328571511       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825328903739       residual = 4.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825328894773       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825328928559       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 3.479579e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825328019385       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825328259386       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825328219860       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825328456365       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825328566935       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825328013591       residual = 7.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825327961067       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825328068948       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825328086579       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825328175857       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825328175770       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 9.578633e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825328019385       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825328082825       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825328071481       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825328131488       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825328165240       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825328014446       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825327996973       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825328021776       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825328025593       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825328047530       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.0000e+01 is 2.498372e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274485 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8796e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.651250e-01 1 1  ON 0
 uu_1                 9.130483e-02 1 1  ON 1
 uu_2                -1.962867e-02 1 1  ON 2
 uu_3                -8.436522e-02 1 1  ON 3
 uu_4                -1.209514e-01 1 1  ON 4
 uu_5                -1.421253e-01 1 1  ON 5
 uu_6                -1.529465e-01 1 1  ON 6
 uu_7                -1.515704e-01 1 1  ON 7
 uu_8                -1.332885e-01 1 1  ON 8
 uu_9                -8.474733e-02 1 1  ON 9
 ud_0                 4.267223e-01 1 1  ON 10
 ud_1                 1.445319e-01 1 1  ON 11
 ud_2                -9.790337e-04 1 1  ON 12
 ud_3                -8.031793e-02 1 1  ON 13
 ud_4                -1.262476e-01 1 1  ON 14
 ud_5                -1.541808e-01 1 1  ON 15
 ud_6                -1.698342e-01 1 1  ON 16
 ud_7                -1.711129e-01 1 1  ON 17
 ud_8                -1.540742e-01 1 1  ON 18
 ud_9                -1.081804e-01 1 1  ON 19
 eC_0                -5.504869e-01 1 1  ON 20
 eC_1                -3.942601e-01 1 1  ON 21
 eC_2                -1.397999e-01 1 1  ON 22
 eC_3                 1.540109e-02 1 1  ON 23
 eC_4                 7.509565e-02 1 1  ON 24
 eC_5                 1.708211e-01 1 1  ON 25
 eC_6                 2.802529e-01 1 1  ON 26
 eC_7                 3.513332e-01 1 1  ON 27
 eC_8                 1.573238e-01 1 1  ON 28
 eC_9                 3.034249e-02 1 1  ON 29
 eO_0                -1.169745e+00 1 1  ON 30
 eO_1                -7.933357e-01 1 1  ON 31
 eO_2                -3.182197e-01 1 1  ON 32
 eO_3                 1.873993e-02 1 1  ON 33
 eO_4                 2.355255e-01 1 1  ON 34
 eO_5                 4.029384e-01 1 1  ON 35
 eO_6                 4.684666e-01 1 1  ON 36
 eO_7                 4.930119e-01 1 1  ON 37
 eO_8                 3.843607e-01 1 1  ON 38
 eO_9                 1.948661e-01 1 1  ON 39
eH1_0                -1.703936e-01 1 1  ON 40
eH1_1                -8.273422e-02 1 1  ON 41
eH1_2                -5.302342e-02 1 1  ON 42
eH1_3                -4.162963e-02 1 1  ON 43
eH1_4                 1.264963e-02 1 1  ON 44
eH1_5                 6.057665e-02 1 1  ON 45
eH1_6                 1.069045e-01 1 1  ON 46
eH1_7                 7.189127e-02 1 1  ON 47
eH1_8                -5.480262e-03 1 1  ON 48
eH1_9                 4.658950e-02 1 1  ON 49
eH2_0                -1.703930e-01 1 1  ON 50
eH2_1                -8.360417e-02 1 1  ON 51
eH2_2                -5.310847e-02 1 1  ON 52
eH2_3                -4.142058e-02 1 1  ON 53
eH2_4                 1.322889e-02 1 1  ON 54
eH2_5                 6.118778e-02 1 1  ON 55
eH2_6                 1.069944e-01 1 1  ON 56
eH2_7                 7.381687e-02 1 1  ON 57
eH2_8                -4.897718e-03 1 1  ON 58
eH2_9                 4.772115e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -22.7911
    reference variance = 0.30116
====================================================
  Execution time = 4.3417e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0949e-01
  Total weights = 2.0000e+06
  Execution time = 3.5399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509458099287
                                         uncertainty =       0.005143184245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509458099287
                                         uncertainty =       0.005143184245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504675239
  error estimate for blocks of size 2^( 2) =       0.000522751342
  error estimate for blocks of size 2^( 3) =       0.000538602576
  error estimate for blocks of size 2^( 4) =       0.000548775219
  error estimate for blocks of size 2^( 5) =       0.000556006906
  error estimate for blocks of size 2^( 6) =       0.000561095417
  error estimate for blocks of size 2^( 7) =       0.000564013945

      target function =                  N/A
              le_mean =     -22.825838370704
             les_mean =     521.528291264642
             stat err =       0.000557472872
             autocorr =       1.220178817747
              std dev =       0.713718567662
             le_variance =       0.509394193825

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509726272285
                                         uncertainty =       0.005144288270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509726272285
                                         uncertainty =       0.005144288270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504808089
  error estimate for blocks of size 2^( 2) =       0.000522876181
  error estimate for blocks of size 2^( 3) =       0.000538719052
  error estimate for blocks of size 2^( 4) =       0.000548882080
  error estimate for blocks of size 2^( 5) =       0.000556108658
  error estimate for blocks of size 2^( 6) =       0.000561188666
  error estimate for blocks of size 2^( 7) =       0.000564098210

      target function =                  N/A
              le_mean =     -22.825838372224
             les_mean =     521.528559554298
             stat err =       0.000557569404
             autocorr =       1.219959059393
              std dev =       0.713906446403
             le_variance =       0.509662414216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509646454370
                                         uncertainty =       0.005144252211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509646454370
                                         uncertainty =       0.005144252211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504768557
  error estimate for blocks of size 2^( 2) =       0.000522839193
  error estimate for blocks of size 2^( 3) =       0.000538685078
  error estimate for blocks of size 2^( 4) =       0.000548851434
  error estimate for blocks of size 2^( 5) =       0.000556080069
  error estimate for blocks of size 2^( 6) =       0.000561163090
  error estimate for blocks of size 2^( 7) =       0.000564075737

      target function =                  N/A
              le_mean =     -22.825838316622
             les_mean =     521.528477193685
             stat err =       0.000557542583
             autocorr =       1.220032773697
              std dev =       0.713850538915
             le_variance =       0.509582591910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509485571297
                                         uncertainty =       0.005143371910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509485571297
                                         uncertainty =       0.005143371910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504688850
  error estimate for blocks of size 2^( 2) =       0.000522764150
  error estimate for blocks of size 2^( 3) =       0.000538614625
  error estimate for blocks of size 2^( 4) =       0.000548786386
  error estimate for blocks of size 2^( 5) =       0.000556017642
  error estimate for blocks of size 2^( 6) =       0.000561105380
  error estimate for blocks of size 2^( 7) =       0.000564023091

      target function =                  N/A
              le_mean =     -22.825838349128
             les_mean =     521.528317757291
             stat err =       0.000557483125
             autocorr =       1.220157884178
              std dev =       0.713737817043
             le_variance =       0.509421671477


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825838370704        initial
     6.2500e-01     6.2500e+00             3.4796e-04       -22.825838372224  <--
     2.5000e+00     2.5000e+01             9.5786e-05       -22.825838316622
     1.0000e+01     1.0000e+02             2.4984e-05       -22.825838349128

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 6.1119e+01
  </log>
  <optVariables href="FORM.s007.opt.xml">
 uu_0                 2.650227e-01 1 1  ON 0
 uu_1                 9.131391e-02 1 1  ON 1
 uu_2                -1.965488e-02 1 1  ON 2
 uu_3                -8.443101e-02 1 1  ON 3
 uu_4                -1.210042e-01 1 1  ON 4
 uu_5                -1.421746e-01 1 1  ON 5
 uu_6                -1.530221e-01 1 1  ON 6
 uu_7                -1.515073e-01 1 1  ON 7
 uu_8                -1.332752e-01 1 1  ON 8
 uu_9                -8.480910e-02 1 1  ON 9
 ud_0                 4.268816e-01 1 1  ON 10
 ud_1                 1.445548e-01 1 1  ON 11
 ud_2                -9.465578e-04 1 1  ON 12
 ud_3                -8.031466e-02 1 1  ON 13
 ud_4                -1.262693e-01 1 1  ON 14
 ud_5                -1.542591e-01 1 1  ON 15
 ud_6                -1.697951e-01 1 1  ON 16
 ud_7                -1.713160e-01 1 1  ON 17
 ud_8                -1.541358e-01 1 1  ON 18
 ud_9                -1.081953e-01 1 1  ON 19
 eC_0                -5.504182e-01 1 1  ON 20
 eC_1                -3.944605e-01 1 1  ON 21
 eC_2                -1.398959e-01 1 1  ON 22
 eC_3                 1.531506e-02 1 1  ON 23
 eC_4                 7.500790e-02 1 1  ON 24
 eC_5                 1.709185e-01 1 1  ON 25
 eC_6                 2.801532e-01 1 1  ON 26
 eC_7                 3.514509e-01 1 1  ON 27
 eC_8                 1.575320e-01 1 1  ON 28
 eC_9                 3.040861e-02 1 1  ON 29
 eO_0                -1.169997e+00 1 1  ON 30
 eO_1                -7.934910e-01 1 1  ON 31
 eO_2                -3.183947e-01 1 1  ON 32
 eO_3                 1.866752e-02 1 1  ON 33
 eO_4                 2.354487e-01 1 1  ON 34
 eO_5                 4.028289e-01 1 1  ON 35
 eO_6                 4.685098e-01 1 1  ON 36
 eO_7                 4.931957e-01 1 1  ON 37
 eO_8                 3.845874e-01 1 1  ON 38
 eO_9                 1.950949e-01 1 1  ON 39
eH1_0                -1.702998e-01 1 1  ON 40
eH1_1                -8.290471e-02 1 1  ON 41
eH1_2                -5.298909e-02 1 1  ON 42
eH1_3                -4.171364e-02 1 1  ON 43
eH1_4                 1.256847e-02 1 1  ON 44
eH1_5                 6.063072e-02 1 1  ON 45
eH1_6                 1.069536e-01 1 1  ON 46
eH1_7                 7.199018e-02 1 1  ON 47
eH1_8                -5.506817e-03 1 1  ON 48
eH1_9                 4.653339e-02 1 1  ON 49
eH2_0                -1.703983e-01 1 1  ON 50
eH2_1                -8.354301e-02 1 1  ON 51
eH2_2                -5.316527e-02 1 1  ON 52
eH2_3                -4.140805e-02 1 1  ON 53
eH2_4                 1.309211e-02 1 1  ON 54
eH2_5                 6.115367e-02 1 1  ON 55
eH2_6                 1.070858e-01 1 1  ON 56
eH2_7                 7.396295e-02 1 1  ON 57
eH2_8                -4.917248e-03 1 1  ON 58
eH2_9                 4.761679e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1992e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8609
    reference variance = 0.26395
====================================================
  Execution time = 4.3837e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0755e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5310e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507542440593
                                         uncertainty =       0.005096297649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507542440593
                                         uncertainty =       0.005096297649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503758998
  error estimate for blocks of size 2^( 2) =       0.000521393785
  error estimate for blocks of size 2^( 3) =       0.000536701858
  error estimate for blocks of size 2^( 4) =       0.000547398213
  error estimate for blocks of size 2^( 5) =       0.000554484981
  error estimate for blocks of size 2^( 6) =       0.000558572910
  error estimate for blocks of size 2^( 7) =       0.000558723754

      target function =                  N/A
              le_mean =     -22.825264812140
             les_mean =     521.500259747656
             stat err =       0.000554794964
             autocorr =       1.212884335345
              std dev =       0.712422807831
             le_variance =       0.507546257118


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282526481214e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825264812140       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825266791548       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825264259052       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825264381765       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825265470168       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825266207110       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825265465648       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825267308229       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825266721448       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825266317664       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825266467893       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825266581473       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825266519895       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825266992044       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 1.411665e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825264812140       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825265615441       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825264747805       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825264303097       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825265128271       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825265422246       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825265222154       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825265658461       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825265477766       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825265424409       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825265384093       residual = 1.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825265397864       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 3.629113e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825264812140       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825265050036       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825264817685       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825264609973       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825264918181       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825264890247       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825265007607       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825265034935       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825265003863       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825265004224       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825264991871       residual = 6.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 9.870824e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.279929 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9156e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.651002e-01 1 1  ON 0
 uu_1                 9.136543e-02 1 1  ON 1
 uu_2                -1.961812e-02 1 1  ON 2
 uu_3                -8.450510e-02 1 1  ON 3
 uu_4                -1.211060e-01 1 1  ON 4
 uu_5                -1.422642e-01 1 1  ON 5
 uu_6                -1.530496e-01 1 1  ON 6
 uu_7                -1.516177e-01 1 1  ON 7
 uu_8                -1.332539e-01 1 1  ON 8
 uu_9                -8.488385e-02 1 1  ON 9
 ud_0                 4.267584e-01 1 1  ON 10
 ud_1                 1.445600e-01 1 1  ON 11
 ud_2                -9.329128e-04 1 1  ON 12
 ud_3                -8.027215e-02 1 1  ON 13
 ud_4                -1.262446e-01 1 1  ON 14
 ud_5                -1.542074e-01 1 1  ON 15
 ud_6                -1.697245e-01 1 1  ON 16
 ud_7                -1.712419e-01 1 1  ON 17
 ud_8                -1.542089e-01 1 1  ON 18
 ud_9                -1.082468e-01 1 1  ON 19
 eC_0                -5.505090e-01 1 1  ON 20
 eC_1                -3.944541e-01 1 1  ON 21
 eC_2                -1.398911e-01 1 1  ON 22
 eC_3                 1.529284e-02 1 1  ON 23
 eC_4                 7.480521e-02 1 1  ON 24
 eC_5                 1.707195e-01 1 1  ON 25
 eC_6                 2.801104e-01 1 1  ON 26
 eC_7                 3.516184e-01 1 1  ON 27
 eC_8                 1.578275e-01 1 1  ON 28
 eC_9                 3.049254e-02 1 1  ON 29
 eO_0                -1.170360e+00 1 1  ON 30
 eO_1                -7.936867e-01 1 1  ON 31
 eO_2                -3.185769e-01 1 1  ON 32
 eO_3                 1.863212e-02 1 1  ON 33
 eO_4                 2.354257e-01 1 1  ON 34
 eO_5                 4.026476e-01 1 1  ON 35
 eO_6                 4.685384e-01 1 1  ON 36
 eO_7                 4.933364e-01 1 1  ON 37
 eO_8                 3.848968e-01 1 1  ON 38
 eO_9                 1.954440e-01 1 1  ON 39
eH1_0                -1.702397e-01 1 1  ON 40
eH1_1                -8.295734e-02 1 1  ON 41
eH1_2                -5.291973e-02 1 1  ON 42
eH1_3                -4.184487e-02 1 1  ON 43
eH1_4                 1.255719e-02 1 1  ON 44
eH1_5                 6.062849e-02 1 1  ON 45
eH1_6                 1.069211e-01 1 1  ON 46
eH1_7                 7.215430e-02 1 1  ON 47
eH1_8                -5.509671e-03 1 1  ON 48
eH1_9                 4.639402e-02 1 1  ON 49
eH2_0                -1.704840e-01 1 1  ON 50
eH2_1                -8.343996e-02 1 1  ON 51
eH2_2                -5.306126e-02 1 1  ON 52
eH2_3                -4.160314e-02 1 1  ON 53
eH2_4                 1.304238e-02 1 1  ON 54
eH2_5                 6.123313e-02 1 1  ON 55
eH2_6                 1.070672e-01 1 1  ON 56
eH2_7                 7.403715e-02 1 1  ON 57
eH2_8                -4.941573e-03 1 1  ON 58
eH2_9                 4.750637e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -22.8566
    reference variance = 0.244746
====================================================
  Execution time = 4.3096e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0101e-01
  Total weights = 2.0000e+06
  Execution time = 3.5381e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501157815234
                                         uncertainty =       0.004395256516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501157815234
                                         uncertainty =       0.004395256516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500567672
  error estimate for blocks of size 2^( 2) =       0.000518695036
  error estimate for blocks of size 2^( 3) =       0.000534089464
  error estimate for blocks of size 2^( 4) =       0.000545181811
  error estimate for blocks of size 2^( 5) =       0.000551764291
  error estimate for blocks of size 2^( 6) =       0.000554559753
  error estimate for blocks of size 2^( 7) =       0.000556752726

      target function =                  N/A
              le_mean =     -22.824175385683
             les_mean =     521.444117773774
             stat err =       0.000552064645
             autocorr =       1.216337998738
              std dev =       0.707909590206
             le_variance =       0.501135987906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500977154627
                                         uncertainty =       0.004390894900

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500977154627
                                         uncertainty =       0.004390894900

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500477307
  error estimate for blocks of size 2^( 2) =       0.000518607573
  error estimate for blocks of size 2^( 3) =       0.000534005508
  error estimate for blocks of size 2^( 4) =       0.000545102344
  error estimate for blocks of size 2^( 5) =       0.000551683905
  error estimate for blocks of size 2^( 6) =       0.000554466671
  error estimate for blocks of size 2^( 7) =       0.000556665955

      target function =                  N/A
              le_mean =     -22.824177400029
             les_mean =     521.444028806652
             stat err =       0.000551979719
             autocorr =       1.216402941671
              std dev =       0.707781794860
             le_variance =       0.500955069136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500914847058
                                         uncertainty =       0.004390755887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500914847058
                                         uncertainty =       0.004390755887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500446185
  error estimate for blocks of size 2^( 2) =       0.000518578267
  error estimate for blocks of size 2^( 3) =       0.000533978610
  error estimate for blocks of size 2^( 4) =       0.000545076748
  error estimate for blocks of size 2^( 5) =       0.000551659478
  error estimate for blocks of size 2^( 6) =       0.000554443702
  error estimate for blocks of size 2^( 7) =       0.000556642622

      target function =                  N/A
              le_mean =     -22.824177449436
             les_mean =     521.443968760099
             stat err =       0.000551955637
             autocorr =       1.216448093069
              std dev =       0.707737781378
             le_variance =       0.500892767190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501099284518
                                         uncertainty =       0.004394346507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501099284518
                                         uncertainty =       0.004394346507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500538417
  error estimate for blocks of size 2^( 2) =       0.000518667024
  error estimate for blocks of size 2^( 3) =       0.000534062940
  error estimate for blocks of size 2^( 4) =       0.000545156551
  error estimate for blocks of size 2^( 5) =       0.000551739243
  error estimate for blocks of size 2^( 6) =       0.000554532960
  error estimate for blocks of size 2^( 7) =       0.000556726762

      target function =                  N/A
              le_mean =     -22.824175651989
             les_mean =     521.444071356799
             stat err =       0.000552038879
             autocorr =       1.216366634458
              std dev =       0.707868218316
             le_variance =       0.501077414502


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824175385683        initial
     1.5625e-01     1.5625e+00             1.4117e-03       -22.824177400029
     6.2500e-01     6.2500e+00             3.6291e-04       -22.824177449436  <--
     2.5000e+00     2.5000e+01             9.8708e-05       -22.824175651989

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 6.0769e+01
  </log>
  <optVariables href="FORM.s008.opt.xml">
 uu_0                 2.651002e-01 1 1  ON 0
 uu_1                 9.136543e-02 1 1  ON 1
 uu_2                -1.961812e-02 1 1  ON 2
 uu_3                -8.450510e-02 1 1  ON 3
 uu_4                -1.211060e-01 1 1  ON 4
 uu_5                -1.422642e-01 1 1  ON 5
 uu_6                -1.530496e-01 1 1  ON 6
 uu_7                -1.516177e-01 1 1  ON 7
 uu_8                -1.332539e-01 1 1  ON 8
 uu_9                -8.488385e-02 1 1  ON 9
 ud_0                 4.267584e-01 1 1  ON 10
 ud_1                 1.445600e-01 1 1  ON 11
 ud_2                -9.329128e-04 1 1  ON 12
 ud_3                -8.027215e-02 1 1  ON 13
 ud_4                -1.262446e-01 1 1  ON 14
 ud_5                -1.542074e-01 1 1  ON 15
 ud_6                -1.697245e-01 1 1  ON 16
 ud_7                -1.712419e-01 1 1  ON 17
 ud_8                -1.542089e-01 1 1  ON 18
 ud_9                -1.082468e-01 1 1  ON 19
 eC_0                -5.505090e-01 1 1  ON 20
 eC_1                -3.944541e-01 1 1  ON 21
 eC_2                -1.398911e-01 1 1  ON 22
 eC_3                 1.529284e-02 1 1  ON 23
 eC_4                 7.480521e-02 1 1  ON 24
 eC_5                 1.707195e-01 1 1  ON 25
 eC_6                 2.801104e-01 1 1  ON 26
 eC_7                 3.516184e-01 1 1  ON 27
 eC_8                 1.578275e-01 1 1  ON 28
 eC_9                 3.049254e-02 1 1  ON 29
 eO_0                -1.170360e+00 1 1  ON 30
 eO_1                -7.936867e-01 1 1  ON 31
 eO_2                -3.185769e-01 1 1  ON 32
 eO_3                 1.863212e-02 1 1  ON 33
 eO_4                 2.354257e-01 1 1  ON 34
 eO_5                 4.026476e-01 1 1  ON 35
 eO_6                 4.685384e-01 1 1  ON 36
 eO_7                 4.933364e-01 1 1  ON 37
 eO_8                 3.848968e-01 1 1  ON 38
 eO_9                 1.954440e-01 1 1  ON 39
eH1_0                -1.702397e-01 1 1  ON 40
eH1_1                -8.295734e-02 1 1  ON 41
eH1_2                -5.291973e-02 1 1  ON 42
eH1_3                -4.184487e-02 1 1  ON 43
eH1_4                 1.255719e-02 1 1  ON 44
eH1_5                 6.062849e-02 1 1  ON 45
eH1_6                 1.069211e-01 1 1  ON 46
eH1_7                 7.215430e-02 1 1  ON 47
eH1_8                -5.509671e-03 1 1  ON 48
eH1_9                 4.639402e-02 1 1  ON 49
eH2_0                -1.704840e-01 1 1  ON 50
eH2_1                -8.343996e-02 1 1  ON 51
eH2_2                -5.306126e-02 1 1  ON 52
eH2_3                -4.160314e-02 1 1  ON 53
eH2_4                 1.304238e-02 1 1  ON 54
eH2_5                 6.123313e-02 1 1  ON 55
eH2_6                 1.070672e-01 1 1  ON 56
eH2_7                 7.403715e-02 1 1  ON 57
eH2_8                -4.941573e-03 1 1  ON 58
eH2_9                 4.750637e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1994e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2818e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.8251
    reference variance = 0.460522
====================================================
  Execution time = 4.3623e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.3332e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4992e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.533335816522
                                         uncertainty =       0.028264330581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.533335816522
                                         uncertainty =       0.028264330581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000516391654
  error estimate for blocks of size 2^( 2) =       0.000534150159
  error estimate for blocks of size 2^( 3) =       0.000550026556
  error estimate for blocks of size 2^( 4) =       0.000561743292
  error estimate for blocks of size 2^( 5) =       0.000568972268
  error estimate for blocks of size 2^( 6) =       0.000574028016
  error estimate for blocks of size 2^( 7) =       0.000575695914

      target function =                  N/A
              le_mean =     -22.825715600561
             les_mean =     521.546613091969
             stat err =       0.000570109873
             autocorr =       1.218873666161
              std dev =       0.730288080784
             le_variance =       0.533320680935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282571560056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825715600561       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825718540526       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825716380065       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825715672367       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825715410331       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825717308713       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825718480119       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825717914245       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825718023973       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825718930683       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825719127878       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825719241434       residual = 9.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825719080373       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825718795747       residual = 6.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 1.392129e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825715600561       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825716737910       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825715831657       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825715512282       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825715289278       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825715897270       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825716305845       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825716371112       residual = 1.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825716212944       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825716354866       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825716376316       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 3.431751e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825715600561       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825715929982       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825715666938       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825715573289       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825715482209       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825715609373       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825715762456       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825715753136       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825715721654       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825715749967       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.5000e+00 is 8.596458e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284912 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8624e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.651107e-01 1 1  ON 0
 uu_1                 9.134326e-02 1 1  ON 1
 uu_2                -1.961902e-02 1 1  ON 2
 uu_3                -8.445576e-02 1 1  ON 3
 uu_4                -1.210973e-01 1 1  ON 4
 uu_5                -1.422829e-01 1 1  ON 5
 uu_6                -1.531215e-01 1 1  ON 6
 uu_7                -1.515349e-01 1 1  ON 7
 uu_8                -1.334450e-01 1 1  ON 8
 uu_9                -8.502250e-02 1 1  ON 9
 ud_0                 4.268479e-01 1 1  ON 10
 ud_1                 1.445476e-01 1 1  ON 11
 ud_2                -8.926166e-04 1 1  ON 12
 ud_3                -8.027173e-02 1 1  ON 13
 ud_4                -1.262173e-01 1 1  ON 14
 ud_5                -1.541867e-01 1 1  ON 15
 ud_6                -1.696815e-01 1 1  ON 16
 ud_7                -1.712230e-01 1 1  ON 17
 ud_8                -1.542229e-01 1 1  ON 18
 ud_9                -1.083928e-01 1 1  ON 19
 eC_0                -5.507633e-01 1 1  ON 20
 eC_1                -3.944636e-01 1 1  ON 21
 eC_2                -1.399338e-01 1 1  ON 22
 eC_3                 1.519728e-02 1 1  ON 23
 eC_4                 7.462480e-02 1 1  ON 24
 eC_5                 1.707716e-01 1 1  ON 25
 eC_6                 2.801391e-01 1 1  ON 26
 eC_7                 3.517864e-01 1 1  ON 27
 eC_8                 1.580927e-01 1 1  ON 28
 eC_9                 3.056380e-02 1 1  ON 29
 eO_0                -1.170594e+00 1 1  ON 30
 eO_1                -7.938460e-01 1 1  ON 31
 eO_2                -3.188433e-01 1 1  ON 32
 eO_3                 1.844198e-02 1 1  ON 33
 eO_4                 2.353562e-01 1 1  ON 34
 eO_5                 4.028345e-01 1 1  ON 35
 eO_6                 4.684138e-01 1 1  ON 36
 eO_7                 4.934115e-01 1 1  ON 37
 eO_8                 3.852400e-01 1 1  ON 38
 eO_9                 1.957498e-01 1 1  ON 39
eH1_0                -1.703331e-01 1 1  ON 40
eH1_1                -8.316499e-02 1 1  ON 41
eH1_2                -5.303739e-02 1 1  ON 42
eH1_3                -4.191630e-02 1 1  ON 43
eH1_4                 1.270915e-02 1 1  ON 44
eH1_5                 6.070638e-02 1 1  ON 45
eH1_6                 1.070120e-01 1 1  ON 46
eH1_7                 7.238034e-02 1 1  ON 47
eH1_8                -5.547214e-03 1 1  ON 48
eH1_9                 4.628851e-02 1 1  ON 49
eH2_0                -1.706004e-01 1 1  ON 50
eH2_1                -8.361397e-02 1 1  ON 51
eH2_2                -5.302133e-02 1 1  ON 52
eH2_3                -4.159772e-02 1 1  ON 53
eH2_4                 1.302797e-02 1 1  ON 54
eH2_5                 6.125306e-02 1 1  ON 55
eH2_6                 1.072723e-01 1 1  ON 56
eH2_7                 7.403036e-02 1 1  ON 57
eH2_8                -4.919863e-03 1 1  ON 58
eH2_9                 4.742384e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -22.7429
    reference variance = 0.317103
====================================================
  Execution time = 4.3297e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2827e+01
  VMC Evar = 5.0753e-01
  Total weights = 2.0000e+06
  Execution time = 3.5303e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507541114252
                                         uncertainty =       0.004750344742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507541114252
                                         uncertainty =       0.004750344742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503730655
  error estimate for blocks of size 2^( 2) =       0.000521381075
  error estimate for blocks of size 2^( 3) =       0.000537129960
  error estimate for blocks of size 2^( 4) =       0.000548302079
  error estimate for blocks of size 2^( 5) =       0.000555512929
  error estimate for blocks of size 2^( 6) =       0.000560682793
  error estimate for blocks of size 2^( 7) =       0.000560901847

      target function =                  N/A
              le_mean =     -22.826613310843
             les_mean =     521.561764133856
             stat err =       0.000556349912
             autocorr =       1.219829931811
              std dev =       0.712382723557
             le_variance =       0.507489144823

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507653998363
                                         uncertainty =       0.004753375639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507653998363
                                         uncertainty =       0.004753375639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503786711
  error estimate for blocks of size 2^( 2) =       0.000521434791
  error estimate for blocks of size 2^( 3) =       0.000537182262
  error estimate for blocks of size 2^( 4) =       0.000548357096
  error estimate for blocks of size 2^( 5) =       0.000555570419
  error estimate for blocks of size 2^( 6) =       0.000560738915
  error estimate for blocks of size 2^( 7) =       0.000560952981

      target function =                  N/A
              le_mean =     -22.826614460740
             les_mean =     521.561929584909
             stat err =       0.000556404853
             autocorr =       1.219799368081
              std dev =       0.712461998607
             le_variance =       0.507602099458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507626775139
                                         uncertainty =       0.004752806898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507626775139
                                         uncertainty =       0.004752806898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503773198
  error estimate for blocks of size 2^( 2) =       0.000521422207
  error estimate for blocks of size 2^( 3) =       0.000537170849
  error estimate for blocks of size 2^( 4) =       0.000548346761
  error estimate for blocks of size 2^( 5) =       0.000555560491
  error estimate for blocks of size 2^( 6) =       0.000560729061
  error estimate for blocks of size 2^( 7) =       0.000560943542

      target function =                  N/A
              le_mean =     -22.826614370284
             les_mean =     521.561898226251
             stat err =       0.000556394964
             autocorr =       1.219821443237
              std dev =       0.712442889199
             le_variance =       0.507574870371

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507563000797
                                         uncertainty =       0.004750886733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507563000797
                                         uncertainty =       0.004750886733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503741523
  error estimate for blocks of size 2^( 2) =       0.000521391524
  error estimate for blocks of size 2^( 3) =       0.000537140211
  error estimate for blocks of size 2^( 4) =       0.000548312894
  error estimate for blocks of size 2^( 5) =       0.000555524268
  error estimate for blocks of size 2^( 6) =       0.000560693997
  error estimate for blocks of size 2^( 7) =       0.000560912192

      target function =                  N/A
              le_mean =     -22.826613470010
             les_mean =     521.561793300129
             stat err =       0.000556360838
             autocorr =       1.219825204031
              std dev =       0.712398094218
             le_variance =       0.507511044645


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826613310843        initial
     1.5625e-01     1.5625e+00             1.3921e-03       -22.826614460740  <--
     6.2500e-01     6.2500e+00             3.4318e-04       -22.826614370284
     2.5000e+00     2.5000e+01             8.5965e-05       -22.826613470010

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 6.0970e+01
  </log>
  <optVariables href="FORM.s009.opt.xml">
 uu_0                 2.651337e-01 1 1  ON 0
 uu_1                 9.135646e-02 1 1  ON 1
 uu_2                -1.959007e-02 1 1  ON 2
 uu_3                -8.440354e-02 1 1  ON 3
 uu_4                -1.211019e-01 1 1  ON 4
 uu_5                -1.423534e-01 1 1  ON 5
 uu_6                -1.532750e-01 1 1  ON 6
 uu_7                -1.515129e-01 1 1  ON 7
 uu_8                -1.338596e-01 1 1  ON 8
 uu_9                -8.540925e-02 1 1  ON 9
 ud_0                 4.269980e-01 1 1  ON 10
 ud_1                 1.446051e-01 1 1  ON 11
 ud_2                -8.092781e-04 1 1  ON 12
 ud_3                -8.022277e-02 1 1  ON 13
 ud_4                -1.261547e-01 1 1  ON 14
 ud_5                -1.541335e-01 1 1  ON 15
 ud_6                -1.695797e-01 1 1  ON 16
 ud_7                -1.711558e-01 1 1  ON 17
 ud_8                -1.542374e-01 1 1  ON 18
 ud_9                -1.087975e-01 1 1  ON 19
 eC_0                -5.512291e-01 1 1  ON 20
 eC_1                -3.945806e-01 1 1  ON 21
 eC_2                -1.401541e-01 1 1  ON 22
 eC_3                 1.482790e-02 1 1  ON 23
 eC_4                 7.418343e-02 1 1  ON 24
 eC_5                 1.707205e-01 1 1  ON 25
 eC_6                 2.802432e-01 1 1  ON 26
 eC_7                 3.523204e-01 1 1  ON 27
 eC_8                 1.589094e-01 1 1  ON 28
 eC_9                 3.078289e-02 1 1  ON 29
 eO_0                -1.171368e+00 1 1  ON 30
 eO_1                -7.945131e-01 1 1  ON 31
 eO_2                -3.195551e-01 1 1  ON 32
 eO_3                 1.795055e-02 1 1  ON 33
 eO_4                 2.352019e-01 1 1  ON 34
 eO_5                 4.031590e-01 1 1  ON 35
 eO_6                 4.682444e-01 1 1  ON 36
 eO_7                 4.936554e-01 1 1  ON 37
 eO_8                 3.862890e-01 1 1  ON 38
 eO_9                 1.966900e-01 1 1  ON 39
eH1_0                -1.706575e-01 1 1  ON 40
eH1_1                -8.363699e-02 1 1  ON 41
eH1_2                -5.332261e-02 1 1  ON 42
eH1_3                -4.199667e-02 1 1  ON 43
eH1_4                 1.293272e-02 1 1  ON 44
eH1_5                 6.099927e-02 1 1  ON 45
eH1_6                 1.072498e-01 1 1  ON 46
eH1_7                 7.292653e-02 1 1  ON 47
eH1_8                -5.637247e-03 1 1  ON 48
eH1_9                 4.597425e-02 1 1  ON 49
eH2_0                -1.709046e-01 1 1  ON 50
eH2_1                -8.396639e-02 1 1  ON 51
eH2_2                -5.303382e-02 1 1  ON 52
eH2_3                -4.161539e-02 1 1  ON 53
eH2_4                 1.308128e-02 1 1  ON 54
eH2_5                 6.140973e-02 1 1  ON 55
eH2_6                 1.076297e-01 1 1  ON 56
eH2_7                 7.399926e-02 1 1  ON 57
eH2_8                -4.834723e-03 1 1  ON 58
eH2_9                 4.717512e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1974e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.7732
    reference variance = 0.80651
====================================================
  Execution time = 4.3573e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0942e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5087e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509410169386
                                         uncertainty =       0.003805766376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509410169386
                                         uncertainty =       0.003805766376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504689309
  error estimate for blocks of size 2^( 2) =       0.000522106179
  error estimate for blocks of size 2^( 3) =       0.000537721264
  error estimate for blocks of size 2^( 4) =       0.000548923634
  error estimate for blocks of size 2^( 5) =       0.000555477686
  error estimate for blocks of size 2^( 6) =       0.000558303000
  error estimate for blocks of size 2^( 7) =       0.000557303168

      target function =                  N/A
              le_mean =     -22.825550863025
             les_mean =     521.515194542650
             stat err =       0.000555001872
             autocorr =       1.209318470365
              std dev =       0.713738465293
             le_variance =       0.509422596839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282555086302e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825550863025       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825552890561       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825555843180       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825554955743       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825556496042       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825557900994       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825559494132       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825559706244       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825562521331       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825564568483       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825563410289       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825563126945       residual = 8.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825561985279       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825563091853       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825563629369       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825563738073       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825562913892       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825563317161       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         17 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 5.883770e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825550863025       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825552141231       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825554565269       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825554431640       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825554624198       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825555498855       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825556035136       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825556334248       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825556568449       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825558115171       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825557369954       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825557233582       residual = 9.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825556955916       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825557066088       residual = 6.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 1.447354e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825550863025       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825551378782       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825552640207       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825553139866       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825553030750       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825553021002       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825553156686       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825553281734       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825553289352       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825553617318       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825553559613       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825553532692       residual = 8.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 3.607216e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.292617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8672e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.649821e-01 1 1  ON 0
 uu_1                 9.126094e-02 1 1  ON 1
 uu_2                -1.962911e-02 1 1  ON 2
 uu_3                -8.458066e-02 1 1  ON 3
 uu_4                -1.212152e-01 1 1  ON 4
 uu_5                -1.425148e-01 1 1  ON 5
 uu_6                -1.533807e-01 1 1  ON 6
 uu_7                -1.523769e-01 1 1  ON 7
 uu_8                -1.335835e-01 1 1  ON 8
 uu_9                -8.539790e-02 1 1  ON 9
 ud_0                 4.266765e-01 1 1  ON 10
 ud_1                 1.447503e-01 1 1  ON 11
 ud_2                -7.193191e-04 1 1  ON 12
 ud_3                -8.008757e-02 1 1  ON 13
 ud_4                -1.260169e-01 1 1  ON 14
 ud_5                -1.542653e-01 1 1  ON 15
 ud_6                -1.695096e-01 1 1  ON 16
 ud_7                -1.712029e-01 1 1  ON 17
 ud_8                -1.547333e-01 1 1  ON 18
 ud_9                -1.089884e-01 1 1  ON 19
 eC_0                -5.513112e-01 1 1  ON 20
 eC_1                -3.948560e-01 1 1  ON 21
 eC_2                -1.407169e-01 1 1  ON 22
 eC_3                 1.429311e-02 1 1  ON 23
 eC_4                 7.411616e-02 1 1  ON 24
 eC_5                 1.705818e-01 1 1  ON 25
 eC_6                 2.798224e-01 1 1  ON 26
 eC_7                 3.527348e-01 1 1  ON 27
 eC_8                 1.601237e-01 1 1  ON 28
 eC_9                 3.119390e-02 1 1  ON 29
 eO_0                -1.172299e+00 1 1  ON 30
 eO_1                -7.952685e-01 1 1  ON 31
 eO_2                -3.204181e-01 1 1  ON 32
 eO_3                 1.738814e-02 1 1  ON 33
 eO_4                 2.345134e-01 1 1  ON 34
 eO_5                 4.027450e-01 1 1  ON 35
 eO_6                 4.686060e-01 1 1  ON 36
 eO_7                 4.940465e-01 1 1  ON 37
 eO_8                 3.877363e-01 1 1  ON 38
 eO_9                 1.979860e-01 1 1  ON 39
eH1_0                -1.704951e-01 1 1  ON 40
eH1_1                -8.408849e-02 1 1  ON 41
eH1_2                -5.350173e-02 1 1  ON 42
eH1_3                -4.183352e-02 1 1  ON 43
eH1_4                 1.304136e-02 1 1  ON 44
eH1_5                 6.127355e-02 1 1  ON 45
eH1_6                 1.071911e-01 1 1  ON 46
eH1_7                 7.331546e-02 1 1  ON 47
eH1_8                -5.731521e-03 1 1  ON 48
eH1_9                 4.539683e-02 1 1  ON 49
eH2_0                -1.714137e-01 1 1  ON 50
eH2_1                -8.405881e-02 1 1  ON 51
eH2_2                -5.317129e-02 1 1  ON 52
eH2_3                -4.160062e-02 1 1  ON 53
eH2_4                 1.337072e-02 1 1  ON 54
eH2_5                 6.136049e-02 1 1  ON 55
eH2_6                 1.076936e-01 1 1  ON 56
eH2_7                 7.387340e-02 1 1  ON 57
eH2_8                -4.741630e-03 1 1  ON 58
eH2_9                 4.703658e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -22.8229
    reference variance = 0.396373
====================================================
  Execution time = 4.3394e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1844e-01
  Total weights = 2.0000e+06
  Execution time = 3.5411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518890871520
                                         uncertainty =       0.012075609422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518890871520
                                         uncertainty =       0.012075609422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509374116
  error estimate for blocks of size 2^( 2) =       0.000526988358
  error estimate for blocks of size 2^( 3) =       0.000542458183
  error estimate for blocks of size 2^( 4) =       0.000553855050
  error estimate for blocks of size 2^( 5) =       0.000561005896
  error estimate for blocks of size 2^( 6) =       0.000562147708
  error estimate for blocks of size 2^( 7) =       0.000561247370

      target function =                  N/A
              le_mean =     -22.825127891039
             les_mean =     521.505386963456
             stat err =       0.000559564006
             autocorr =       1.206773587234
              std dev =       0.720363783550
             le_variance =       0.518923980651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518332241367
                                         uncertainty =       0.012052411874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518332241367
                                         uncertainty =       0.012052411874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509099687
  error estimate for blocks of size 2^( 2) =       0.000526727757
  error estimate for blocks of size 2^( 3) =       0.000542206728
  error estimate for blocks of size 2^( 4) =       0.000553607869
  error estimate for blocks of size 2^( 5) =       0.000560764774
  error estimate for blocks of size 2^( 6) =       0.000561911585
  error estimate for blocks of size 2^( 7) =       0.000561015523

      target function =                  N/A
              le_mean =     -22.825131202091
             les_mean =     521.504979115570
             stat err =       0.000559324938
             autocorr =       1.207042901412
              std dev =       0.719975681590
             le_variance =       0.518364982081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517945200415
                                         uncertainty =       0.012046982928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.517945200415
                                         uncertainty =       0.012046982928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508909503
  error estimate for blocks of size 2^( 2) =       0.000526549153
  error estimate for blocks of size 2^( 3) =       0.000542040735
  error estimate for blocks of size 2^( 4) =       0.000553453609
  error estimate for blocks of size 2^( 5) =       0.000560623705
  error estimate for blocks of size 2^( 6) =       0.000561779544
  error estimate for blocks of size 2^( 7) =       0.000560886982

      target function =                  N/A
              le_mean =     -22.825132007946
             les_mean =     521.504628684831
             stat err =       0.000559185960
             autocorr =       1.207345023758
              std dev =       0.719706720580
             le_variance =       0.517977763649

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518627686137
                                         uncertainty =       0.012068456916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.518627686137
                                         uncertainty =       0.012068456916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509244853
  error estimate for blocks of size 2^( 2) =       0.000526865675
  error estimate for blocks of size 2^( 3) =       0.000542341307
  error estimate for blocks of size 2^( 4) =       0.000553742774
  error estimate for blocks of size 2^( 5) =       0.000560899166
  error estimate for blocks of size 2^( 6) =       0.000562044590
  error estimate for blocks of size 2^( 7) =       0.000561147234

      target function =                  N/A
              le_mean =     -22.825127915893
             les_mean =     521.505124757799
             stat err =       0.000559458441
             autocorr =       1.206930786536
              std dev =       0.720180977444
             le_variance =       0.518660640272


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825127891039        initial
     3.9062e-02     3.9062e-01             5.8838e-03       -22.825131202091
     1.5625e-01     1.5625e+00             1.4474e-03       -22.825132007946  <--
     6.2500e-01     6.2500e+00             3.6072e-04       -22.825127915893

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 6.3916e+01
  </log>
  <optVariables href="FORM.s010.opt.xml">
 uu_0                 2.649821e-01 1 1  ON 0
 uu_1                 9.126094e-02 1 1  ON 1
 uu_2                -1.962911e-02 1 1  ON 2
 uu_3                -8.458066e-02 1 1  ON 3
 uu_4                -1.212152e-01 1 1  ON 4
 uu_5                -1.425148e-01 1 1  ON 5
 uu_6                -1.533807e-01 1 1  ON 6
 uu_7                -1.523769e-01 1 1  ON 7
 uu_8                -1.335835e-01 1 1  ON 8
 uu_9                -8.539790e-02 1 1  ON 9
 ud_0                 4.266765e-01 1 1  ON 10
 ud_1                 1.447503e-01 1 1  ON 11
 ud_2                -7.193191e-04 1 1  ON 12
 ud_3                -8.008757e-02 1 1  ON 13
 ud_4                -1.260169e-01 1 1  ON 14
 ud_5                -1.542653e-01 1 1  ON 15
 ud_6                -1.695096e-01 1 1  ON 16
 ud_7                -1.712029e-01 1 1  ON 17
 ud_8                -1.547333e-01 1 1  ON 18
 ud_9                -1.089884e-01 1 1  ON 19
 eC_0                -5.513112e-01 1 1  ON 20
 eC_1                -3.948560e-01 1 1  ON 21
 eC_2                -1.407169e-01 1 1  ON 22
 eC_3                 1.429311e-02 1 1  ON 23
 eC_4                 7.411616e-02 1 1  ON 24
 eC_5                 1.705818e-01 1 1  ON 25
 eC_6                 2.798224e-01 1 1  ON 26
 eC_7                 3.527348e-01 1 1  ON 27
 eC_8                 1.601237e-01 1 1  ON 28
 eC_9                 3.119390e-02 1 1  ON 29
 eO_0                -1.172299e+00 1 1  ON 30
 eO_1                -7.952685e-01 1 1  ON 31
 eO_2                -3.204181e-01 1 1  ON 32
 eO_3                 1.738814e-02 1 1  ON 33
 eO_4                 2.345134e-01 1 1  ON 34
 eO_5                 4.027450e-01 1 1  ON 35
 eO_6                 4.686060e-01 1 1  ON 36
 eO_7                 4.940465e-01 1 1  ON 37
 eO_8                 3.877363e-01 1 1  ON 38
 eO_9                 1.979860e-01 1 1  ON 39
eH1_0                -1.704951e-01 1 1  ON 40
eH1_1                -8.408849e-02 1 1  ON 41
eH1_2                -5.350173e-02 1 1  ON 42
eH1_3                -4.183352e-02 1 1  ON 43
eH1_4                 1.304136e-02 1 1  ON 44
eH1_5                 6.127355e-02 1 1  ON 45
eH1_6                 1.071911e-01 1 1  ON 46
eH1_7                 7.331546e-02 1 1  ON 47
eH1_8                -5.731521e-03 1 1  ON 48
eH1_9                 4.539683e-02 1 1  ON 49
eH2_0                -1.714137e-01 1 1  ON 50
eH2_1                -8.405881e-02 1 1  ON 51
eH2_2                -5.317129e-02 1 1  ON 52
eH2_3                -4.160062e-02 1 1  ON 53
eH2_4                 1.337072e-02 1 1  ON 54
eH2_5                 6.136049e-02 1 1  ON 55
eH2_6                 1.076936e-01 1 1  ON 56
eH2_7                 7.387340e-02 1 1  ON 57
eH2_8                -4.741630e-03 1 1  ON 58
eH2_9                 4.703658e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2259e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2813e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.7829
    reference variance = 0.607662
====================================================
  Execution time = 4.3685e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1052e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4928e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510555617779
                                         uncertainty =       0.008143868575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510555617779
                                         uncertainty =       0.008143868575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505234252
  error estimate for blocks of size 2^( 2) =       0.000523457400
  error estimate for blocks of size 2^( 3) =       0.000540061407
  error estimate for blocks of size 2^( 4) =       0.000551269510
  error estimate for blocks of size 2^( 5) =       0.000557885584
  error estimate for blocks of size 2^( 6) =       0.000561728533
  error estimate for blocks of size 2^( 7) =       0.000564566279

      target function =                  N/A
              le_mean =     -22.825503030555
             les_mean =     521.514111640505
             stat err =       0.000558862476
             autocorr =       1.223557352908
              std dev =       0.714509130723
             le_variance =       0.510523297886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282550303056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825503030555       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825509927861       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825513663211       residual = 5.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825514619900       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825517317949       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825518179695       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825519150410       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825520778937       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825520690880       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825520649879       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825522900552       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825522950683       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825522071233       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825522325879       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825521420333       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -22.825522917389       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -22.825523278473       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -22.825523592894       residual = 1.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -22.825523819541       residual = 7.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         18 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-02 is 5.580395e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825503030555       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825507095578       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825509714364       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825510202110       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825511691284       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825512361173       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825512832430       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825513379538       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825513134613       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825512953673       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825513508542       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825513398757       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.825513073915       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -22.825513058928       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -22.825513057341       residual = 6.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e-01 is 1.374307e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825503030555       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825504568852       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825505826616       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825506046558       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825506627897       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825507034340       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825507085613       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825506970094       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825506943043       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825506969003       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825506974240       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.825506922887       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e-01 is 3.318397e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.301757 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8626e+01
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.647704e-01 1 1  ON 0
 uu_1                 9.107610e-02 1 1  ON 1
 uu_2                -1.973998e-02 1 1  ON 2
 uu_3                -8.475645e-02 1 1  ON 3
 uu_4                -1.213871e-01 1 1  ON 4
 uu_5                -1.426761e-01 1 1  ON 5
 uu_6                -1.535964e-01 1 1  ON 6
 uu_7                -1.522635e-01 1 1  ON 7
 uu_8                -1.335790e-01 1 1  ON 8
 uu_9                -8.544401e-02 1 1  ON 9
 ud_0                 4.271931e-01 1 1  ON 10
 ud_1                 1.449657e-01 1 1  ON 11
 ud_2                -5.353847e-04 1 1  ON 12
 ud_3                -7.983531e-02 1 1  ON 13
 ud_4                -1.261260e-01 1 1  ON 14
 ud_5                -1.543143e-01 1 1  ON 15
 ud_6                -1.701491e-01 1 1  ON 16
 ud_7                -1.717554e-01 1 1  ON 17
 ud_8                -1.547675e-01 1 1  ON 18
 ud_9                -1.089479e-01 1 1  ON 19
 eC_0                -5.518130e-01 1 1  ON 20
 eC_1                -3.951639e-01 1 1  ON 21
 eC_2                -1.407039e-01 1 1  ON 22
 eC_3                 1.385277e-02 1 1  ON 23
 eC_4                 7.371492e-02 1 1  ON 24
 eC_5                 1.701121e-01 1 1  ON 25
 eC_6                 2.795488e-01 1 1  ON 26
 eC_7                 3.535388e-01 1 1  ON 27
 eC_8                 1.613433e-01 1 1  ON 28
 eC_9                 3.154949e-02 1 1  ON 29
 eO_0                -1.173115e+00 1 1  ON 30
 eO_1                -7.962434e-01 1 1  ON 31
 eO_2                -3.211095e-01 1 1  ON 32
 eO_3                 1.651439e-02 1 1  ON 33
 eO_4                 2.340266e-01 1 1  ON 34
 eO_5                 4.027253e-01 1 1  ON 35
 eO_6                 4.688703e-01 1 1  ON 36
 eO_7                 4.944774e-01 1 1  ON 37
 eO_8                 3.889211e-01 1 1  ON 38
 eO_9                 1.993603e-01 1 1  ON 39
eH1_0                -1.708308e-01 1 1  ON 40
eH1_1                -8.418282e-02 1 1  ON 41
eH1_2                -5.343809e-02 1 1  ON 42
eH1_3                -4.183922e-02 1 1  ON 43
eH1_4                 1.313569e-02 1 1  ON 44
eH1_5                 6.156736e-02 1 1  ON 45
eH1_6                 1.076130e-01 1 1  ON 46
eH1_7                 7.343526e-02 1 1  ON 47
eH1_8                -6.075887e-03 1 1  ON 48
eH1_9                 4.478812e-02 1 1  ON 49
eH2_0                -1.709736e-01 1 1  ON 50
eH2_1                -8.487480e-02 1 1  ON 51
eH2_2                -5.372341e-02 1 1  ON 52
eH2_3                -4.214424e-02 1 1  ON 53
eH2_4                 1.338391e-02 1 1  ON 54
eH2_5                 6.191072e-02 1 1  ON 55
eH2_6                 1.073532e-01 1 1  ON 56
eH2_7                 7.424468e-02 1 1  ON 57
eH2_8                -4.344943e-03 1 1  ON 58
eH2_9                 4.702926e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -22.874
    reference variance = 0.466753
====================================================
  Execution time = 4.3285e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0508e-01
  Total weights = 2.0000e+06
  Execution time = 3.5448e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504872905193
                                         uncertainty =       0.004593506203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504872905193
                                         uncertainty =       0.004593506203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502385373
  error estimate for blocks of size 2^( 2) =       0.000519932969
  error estimate for blocks of size 2^( 3) =       0.000536465217
  error estimate for blocks of size 2^( 4) =       0.000547656261
  error estimate for blocks of size 2^( 5) =       0.000554759612
  error estimate for blocks of size 2^( 6) =       0.000560790183
  error estimate for blocks of size 2^( 7) =       0.000564624679

      target function =                  N/A
              le_mean =     -22.825046763000
             les_mean =     521.487541606194
             stat err =       0.000556957684
             autocorr =       1.229052479697
              std dev =       0.710480207634
             le_variance =       0.504782125440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505413521867
                                         uncertainty =       0.004595487102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505413521867
                                         uncertainty =       0.004595487102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502654319
  error estimate for blocks of size 2^( 2) =       0.000520194207
  error estimate for blocks of size 2^( 3) =       0.000536709149
  error estimate for blocks of size 2^( 4) =       0.000547876537
  error estimate for blocks of size 2^( 5) =       0.000554972248
  error estimate for blocks of size 2^( 6) =       0.000560985829
  error estimate for blocks of size 2^( 7) =       0.000564838852

      target function =                  N/A
              le_mean =     -22.825044679553
             les_mean =     521.487987099960
             stat err =       0.000557168367
             autocorr =       1.228666635573
              std dev =       0.710860555270
             le_variance =       0.505322729038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505483862693
                                         uncertainty =       0.004596125521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505483862693
                                         uncertainty =       0.004596125521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502689264
  error estimate for blocks of size 2^( 2) =       0.000520228837
  error estimate for blocks of size 2^( 3) =       0.000536746624
  error estimate for blocks of size 2^( 4) =       0.000547921903
  error estimate for blocks of size 2^( 5) =       0.000555028129
  error estimate for blocks of size 2^( 6) =       0.000561040858
  error estimate for blocks of size 2^( 7) =       0.000564904485

      target function =                  N/A
              le_mean =     -22.825045059661
             les_mean =     521.488074715464
             stat err =       0.000557223844
             autocorr =       1.228740470962
              std dev =       0.710909975040
             le_variance =       0.505392992612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505020044843
                                         uncertainty =       0.004594409184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505020044843
                                         uncertainty =       0.004594409184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502458569
  error estimate for blocks of size 2^( 2) =       0.000520003344
  error estimate for blocks of size 2^( 3) =       0.000536532247
  error estimate for blocks of size 2^( 4) =       0.000547720343
  error estimate for blocks of size 2^( 5) =       0.000554825867
  error estimate for blocks of size 2^( 6) =       0.000560852606
  error estimate for blocks of size 2^( 7) =       0.000564695011

      target function =                  N/A
              le_mean =     -22.825044780866
             les_mean =     521.487598223430
             stat err =       0.000557023457
             autocorr =       1.228984636598
              std dev =       0.710583722967
             le_variance =       0.504929227345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825046763000        initial  <--
     3.9062e-02     3.9062e-01             5.5804e-03       -22.825044679553
     1.5625e-01     1.5625e+00             1.3743e-03       -22.825045059661
     6.2500e-01     6.2500e+00             3.3184e-04       -22.825044780866

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0766
  </log>
  <optVariables href="FORM.s011.opt.xml">
 uu_0                 2.649821e-01 1 1  ON 0
 uu_1                 9.126094e-02 1 1  ON 1
 uu_2                -1.962911e-02 1 1  ON 2
 uu_3                -8.458066e-02 1 1  ON 3
 uu_4                -1.212152e-01 1 1  ON 4
 uu_5                -1.425148e-01 1 1  ON 5
 uu_6                -1.533807e-01 1 1  ON 6
 uu_7                -1.523769e-01 1 1  ON 7
 uu_8                -1.335835e-01 1 1  ON 8
 uu_9                -8.539790e-02 1 1  ON 9
 ud_0                 4.266765e-01 1 1  ON 10
 ud_1                 1.447503e-01 1 1  ON 11
 ud_2                -7.193191e-04 1 1  ON 12
 ud_3                -8.008757e-02 1 1  ON 13
 ud_4                -1.260169e-01 1 1  ON 14
 ud_5                -1.542653e-01 1 1  ON 15
 ud_6                -1.695096e-01 1 1  ON 16
 ud_7                -1.712029e-01 1 1  ON 17
 ud_8                -1.547333e-01 1 1  ON 18
 ud_9                -1.089884e-01 1 1  ON 19
 eC_0                -5.513112e-01 1 1  ON 20
 eC_1                -3.948560e-01 1 1  ON 21
 eC_2                -1.407169e-01 1 1  ON 22
 eC_3                 1.429311e-02 1 1  ON 23
 eC_4                 7.411616e-02 1 1  ON 24
 eC_5                 1.705818e-01 1 1  ON 25
 eC_6                 2.798224e-01 1 1  ON 26
 eC_7                 3.527348e-01 1 1  ON 27
 eC_8                 1.601237e-01 1 1  ON 28
 eC_9                 3.119390e-02 1 1  ON 29
 eO_0                -1.172299e+00 1 1  ON 30
 eO_1                -7.952685e-01 1 1  ON 31
 eO_2                -3.204181e-01 1 1  ON 32
 eO_3                 1.738814e-02 1 1  ON 33
 eO_4                 2.345134e-01 1 1  ON 34
 eO_5                 4.027450e-01 1 1  ON 35
 eO_6                 4.686060e-01 1 1  ON 36
 eO_7                 4.940465e-01 1 1  ON 37
 eO_8                 3.877363e-01 1 1  ON 38
 eO_9                 1.979860e-01 1 1  ON 39
eH1_0                -1.704951e-01 1 1  ON 40
eH1_1                -8.408849e-02 1 1  ON 41
eH1_2                -5.350173e-02 1 1  ON 42
eH1_3                -4.183352e-02 1 1  ON 43
eH1_4                 1.304136e-02 1 1  ON 44
eH1_5                 6.127355e-02 1 1  ON 45
eH1_6                 1.071911e-01 1 1  ON 46
eH1_7                 7.331546e-02 1 1  ON 47
eH1_8                -5.731521e-03 1 1  ON 48
eH1_9                 4.539683e-02 1 1  ON 49
eH2_0                -1.714137e-01 1 1  ON 50
eH2_1                -8.405881e-02 1 1  ON 51
eH2_2                -5.317129e-02 1 1  ON 52
eH2_3                -4.160062e-02 1 1  ON 53
eH2_4                 1.337072e-02 1 1  ON 54
eH2_5                 6.136049e-02 1 1  ON 55
eH2_6                 1.076936e-01 1 1  ON 56
eH2_7                 7.387340e-02 1 1  ON 57
eH2_8                -4.741630e-03 1 1  ON 58
eH2_9                 4.703658e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1971e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2815e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.8058
    reference variance = 0.314099
====================================================
  Execution time = 4.4301e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1669e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4867e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516460711538
                                         uncertainty =       0.011398390362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516460711538
                                         uncertainty =       0.011398390362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508277592
  error estimate for blocks of size 2^( 2) =       0.000525961696
  error estimate for blocks of size 2^( 3) =       0.000541826641
  error estimate for blocks of size 2^( 4) =       0.000552400404
  error estimate for blocks of size 2^( 5) =       0.000557651569
  error estimate for blocks of size 2^( 6) =       0.000562247577
  error estimate for blocks of size 2^( 7) =       0.000561799703

      target function =                  N/A
              le_mean =     -22.824825255757
             les_mean =     521.489339917955
             stat err =       0.000558524813
             autocorr =       1.207488537978
              std dev =       0.718813063627
             le_variance =       0.516692220441


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282482525576e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824825255757       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824826285820       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824825903327       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824826088526       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824826232243       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824826170036       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824826115274       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824826261342       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824825932164       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824826101299       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824826434217       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824826474473       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -22.824826502960       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e-01 is 5.506729e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824825255757       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824825575158       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824825433870       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824825480617       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824825544058       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824825515090       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824825351415       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824825359658       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824825279678       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824825292315       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824825351158       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+00 is 1.471236e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824825255757       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824825340711       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824825300438       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824825312004       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824825330939       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824825324263       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824825264453       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824825261147       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824825241665       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824825241010       residual = 7.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+00 is 4.291303e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306418 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9177e+01
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.651292e-01 1 1  ON 0
 uu_1                 9.121111e-02 1 1  ON 1
 uu_2                -1.966307e-02 1 1  ON 2
 uu_3                -8.461056e-02 1 1  ON 3
 uu_4                -1.212462e-01 1 1  ON 4
 uu_5                -1.425454e-01 1 1  ON 5
 uu_6                -1.533253e-01 1 1  ON 6
 uu_7                -1.523572e-01 1 1  ON 7
 uu_8                -1.336597e-01 1 1  ON 8
 uu_9                -8.544609e-02 1 1  ON 9
 ud_0                 4.267741e-01 1 1  ON 10
 ud_1                 1.447717e-01 1 1  ON 11
 ud_2                -6.957791e-04 1 1  ON 12
 ud_3                -8.003241e-02 1 1  ON 13
 ud_4                -1.260728e-01 1 1  ON 14
 ud_5                -1.541958e-01 1 1  ON 15
 ud_6                -1.694992e-01 1 1  ON 16
 ud_7                -1.712469e-01 1 1  ON 17
 ud_8                -1.548095e-01 1 1  ON 18
 ud_9                -1.090618e-01 1 1  ON 19
 eC_0                -5.513206e-01 1 1  ON 20
 eC_1                -3.949183e-01 1 1  ON 21
 eC_2                -1.407313e-01 1 1  ON 22
 eC_3                 1.424176e-02 1 1  ON 23
 eC_4                 7.406024e-02 1 1  ON 24
 eC_5                 1.705494e-01 1 1  ON 25
 eC_6                 2.798427e-01 1 1  ON 26
 eC_7                 3.528095e-01 1 1  ON 27
 eC_8                 1.602296e-01 1 1  ON 28
 eC_9                 3.121957e-02 1 1  ON 29
 eO_0                -1.172369e+00 1 1  ON 30
 eO_1                -7.953661e-01 1 1  ON 31
 eO_2                -3.204756e-01 1 1  ON 32
 eO_3                 1.737748e-02 1 1  ON 33
 eO_4                 2.344919e-01 1 1  ON 34
 eO_5                 4.026434e-01 1 1  ON 35
 eO_6                 4.686301e-01 1 1  ON 36
 eO_7                 4.940674e-01 1 1  ON 37
 eO_8                 3.878710e-01 1 1  ON 38
 eO_9                 1.981118e-01 1 1  ON 39
eH1_0                -1.705260e-01 1 1  ON 40
eH1_1                -8.406825e-02 1 1  ON 41
eH1_2                -5.357515e-02 1 1  ON 42
eH1_3                -4.189956e-02 1 1  ON 43
eH1_4                 1.305123e-02 1 1  ON 44
eH1_5                 6.130529e-02 1 1  ON 45
eH1_6                 1.071687e-01 1 1  ON 46
eH1_7                 7.340727e-02 1 1  ON 47
eH1_8                -5.695524e-03 1 1  ON 48
eH1_9                 4.536847e-02 1 1  ON 49
eH2_0                -1.714640e-01 1 1  ON 50
eH2_1                -8.408047e-02 1 1  ON 51
eH2_2                -5.322027e-02 1 1  ON 52
eH2_3                -4.158457e-02 1 1  ON 53
eH2_4                 1.340236e-02 1 1  ON 54
eH2_5                 6.139939e-02 1 1  ON 55
eH2_6                 1.076950e-01 1 1  ON 56
eH2_7                 7.392588e-02 1 1  ON 57
eH2_8                -4.737344e-03 1 1  ON 58
eH2_9                 4.698247e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -22.7937
    reference variance = 0.510543
====================================================
  Execution time = 4.3409e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0116e-01
  Total weights = 2.0000e+06
  Execution time = 3.5265e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500607140658
                                         uncertainty =       0.003002714706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500607140658
                                         uncertainty =       0.003002714706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500526168
  error estimate for blocks of size 2^( 2) =       0.000518778418
  error estimate for blocks of size 2^( 3) =       0.000534095647
  error estimate for blocks of size 2^( 4) =       0.000546378212
  error estimate for blocks of size 2^( 5) =       0.000552552543
  error estimate for blocks of size 2^( 6) =       0.000555496364
  error estimate for blocks of size 2^( 7) =       0.000556693300

      target function =                  N/A
              le_mean =     -22.824282848140
             les_mean =     521.448940170318
             stat err =       0.000552780105
             autocorr =       1.219694969612
              std dev =       0.707850894565
             le_variance =       0.501052888936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500875811482
                                         uncertainty =       0.003005185396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500875811482
                                         uncertainty =       0.003005185396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500660509
  error estimate for blocks of size 2^( 2) =       0.000518908065
  error estimate for blocks of size 2^( 3) =       0.000534217900
  error estimate for blocks of size 2^( 4) =       0.000546498813
  error estimate for blocks of size 2^( 5) =       0.000552671644
  error estimate for blocks of size 2^( 6) =       0.000555623964
  error estimate for blocks of size 2^( 7) =       0.000556806882

      target function =                  N/A
              le_mean =     -22.824280346035
             les_mean =     521.449094954082
             stat err =       0.000552900326
             autocorr =       1.219570802743
              std dev =       0.708040881844
             le_variance =       0.501321890362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500830746142
                                         uncertainty =       0.003004854699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500830746142
                                         uncertainty =       0.003004854699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500638019
  error estimate for blocks of size 2^( 2) =       0.000518886281
  error estimate for blocks of size 2^( 3) =       0.000534197736
  error estimate for blocks of size 2^( 4) =       0.000546480512
  error estimate for blocks of size 2^( 5) =       0.000552653409
  error estimate for blocks of size 2^( 6) =       0.000555604319
  error estimate for blocks of size 2^( 7) =       0.000556790781

      target function =                  N/A
              le_mean =     -22.824280872606
             les_mean =     521.449073952501
             stat err =       0.000552882255
             autocorr =       1.219600655092
              std dev =       0.708009075879
             le_variance =       0.501276851527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500641778914
                                         uncertainty =       0.003003046360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500641778914
                                         uncertainty =       0.003003046360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500543499
  error estimate for blocks of size 2^( 2) =       0.000518795078
  error estimate for blocks of size 2^( 3) =       0.000534111393
  error estimate for blocks of size 2^( 4) =       0.000546394057
  error estimate for blocks of size 2^( 5) =       0.000552568116
  error estimate for blocks of size 2^( 6) =       0.000555513040
  error estimate for blocks of size 2^( 7) =       0.000556708462

      target function =                  N/A
              le_mean =     -22.824282492163
             les_mean =     521.448958621267
             stat err =       0.000552795919
             autocorr =       1.219680287488
              std dev =       0.707875405524
             le_variance =       0.501087589746


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824282848140        initial  <--
     3.9062e-01     3.9062e+00             5.5067e-04       -22.824280346035
     1.5625e+00     1.5625e+01             1.4712e-04       -22.824280872606
     6.2500e+00     6.2500e+01             4.2913e-05       -22.824282492163

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0952
  </log>
  <optVariables href="FORM.s012.opt.xml">
 uu_0                 2.649821e-01 1 1  ON 0
 uu_1                 9.126094e-02 1 1  ON 1
 uu_2                -1.962911e-02 1 1  ON 2
 uu_3                -8.458066e-02 1 1  ON 3
 uu_4                -1.212152e-01 1 1  ON 4
 uu_5                -1.425148e-01 1 1  ON 5
 uu_6                -1.533807e-01 1 1  ON 6
 uu_7                -1.523769e-01 1 1  ON 7
 uu_8                -1.335835e-01 1 1  ON 8
 uu_9                -8.539790e-02 1 1  ON 9
 ud_0                 4.266765e-01 1 1  ON 10
 ud_1                 1.447503e-01 1 1  ON 11
 ud_2                -7.193191e-04 1 1  ON 12
 ud_3                -8.008757e-02 1 1  ON 13
 ud_4                -1.260169e-01 1 1  ON 14
 ud_5                -1.542653e-01 1 1  ON 15
 ud_6                -1.695096e-01 1 1  ON 16
 ud_7                -1.712029e-01 1 1  ON 17
 ud_8                -1.547333e-01 1 1  ON 18
 ud_9                -1.089884e-01 1 1  ON 19
 eC_0                -5.513112e-01 1 1  ON 20
 eC_1                -3.948560e-01 1 1  ON 21
 eC_2                -1.407169e-01 1 1  ON 22
 eC_3                 1.429311e-02 1 1  ON 23
 eC_4                 7.411616e-02 1 1  ON 24
 eC_5                 1.705818e-01 1 1  ON 25
 eC_6                 2.798224e-01 1 1  ON 26
 eC_7                 3.527348e-01 1 1  ON 27
 eC_8                 1.601237e-01 1 1  ON 28
 eC_9                 3.119390e-02 1 1  ON 29
 eO_0                -1.172299e+00 1 1  ON 30
 eO_1                -7.952685e-01 1 1  ON 31
 eO_2                -3.204181e-01 1 1  ON 32
 eO_3                 1.738814e-02 1 1  ON 33
 eO_4                 2.345134e-01 1 1  ON 34
 eO_5                 4.027450e-01 1 1  ON 35
 eO_6                 4.686060e-01 1 1  ON 36
 eO_7                 4.940465e-01 1 1  ON 37
 eO_8                 3.877363e-01 1 1  ON 38
 eO_9                 1.979860e-01 1 1  ON 39
eH1_0                -1.704951e-01 1 1  ON 40
eH1_1                -8.408849e-02 1 1  ON 41
eH1_2                -5.350173e-02 1 1  ON 42
eH1_3                -4.183352e-02 1 1  ON 43
eH1_4                 1.304136e-02 1 1  ON 44
eH1_5                 6.127355e-02 1 1  ON 45
eH1_6                 1.071911e-01 1 1  ON 46
eH1_7                 7.331546e-02 1 1  ON 47
eH1_8                -5.731521e-03 1 1  ON 48
eH1_9                 4.539683e-02 1 1  ON 49
eH2_0                -1.714137e-01 1 1  ON 50
eH2_1                -8.405881e-02 1 1  ON 51
eH2_2                -5.317129e-02 1 1  ON 52
eH2_3                -4.160062e-02 1 1  ON 53
eH2_4                 1.337072e-02 1 1  ON 54
eH2_5                 6.136049e-02 1 1  ON 55
eH2_6                 1.076936e-01 1 1  ON 56
eH2_7                 7.387340e-02 1 1  ON 57
eH2_8                -4.741630e-03 1 1  ON 58
eH2_9                 4.703658e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2028e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2814e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.9414
    reference variance = 0.582553
====================================================
  Execution time = 4.3262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0481e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5438e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504870243053
                                         uncertainty =       0.004420237880

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504870243053
                                         uncertainty =       0.004420237880

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502400539
  error estimate for blocks of size 2^( 2) =       0.000520298717
  error estimate for blocks of size 2^( 3) =       0.000536502353
  error estimate for blocks of size 2^( 4) =       0.000548683085
  error estimate for blocks of size 2^( 5) =       0.000555260642
  error estimate for blocks of size 2^( 6) =       0.000562249384
  error estimate for blocks of size 2^( 7) =       0.000564336621

      target function =                  N/A
              le_mean =     -22.824417013341
             les_mean =     521.458824349696
             stat err =       0.000557632433
             autocorr =       1.231957871861
              std dev =       0.710501656019
             le_variance =       0.504812603206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282441701334e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824417013341       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824417068026       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824417101475       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824417065442       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824417042699       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824417057514       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824417040180       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824417084490       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824417050721       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824417065313       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824417063949       residual = 9.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 8.219193e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824417013341       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824417027468       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824417036746       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824417028070       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824417023794       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824417028183       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824417021598       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824417032199       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824417023424       residual = 5.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824417026910       residual = 8.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 2.308544e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824417013341       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824417016903       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824417019286       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824417017138       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824417016181       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824417017342       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824417015548       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824417018163       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824417015937       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824417016787       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.2500e+01 is 5.917983e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310342 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8708e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.649884e-01 1 1  ON 0
 uu_1                 9.125707e-02 1 1  ON 1
 uu_2                -1.963709e-02 1 1  ON 2
 uu_3                -8.457835e-02 1 1  ON 3
 uu_4                -1.212203e-01 1 1  ON 4
 uu_5                -1.425188e-01 1 1  ON 5
 uu_6                -1.533794e-01 1 1  ON 6
 uu_7                -1.523647e-01 1 1  ON 7
 uu_8                -1.335938e-01 1 1  ON 8
 uu_9                -8.540345e-02 1 1  ON 9
 ud_0                 4.266996e-01 1 1  ON 10
 ud_1                 1.447442e-01 1 1  ON 11
 ud_2                -7.201707e-04 1 1  ON 12
 ud_3                -8.008656e-02 1 1  ON 13
 ud_4                -1.260240e-01 1 1  ON 14
 ud_5                -1.542631e-01 1 1  ON 15
 ud_6                -1.695229e-01 1 1  ON 16
 ud_7                -1.712012e-01 1 1  ON 17
 ud_8                -1.547382e-01 1 1  ON 18
 ud_9                -1.089884e-01 1 1  ON 19
 eC_0                -5.513116e-01 1 1  ON 20
 eC_1                -3.948629e-01 1 1  ON 21
 eC_2                -1.407195e-01 1 1  ON 22
 eC_3                 1.429396e-02 1 1  ON 23
 eC_4                 7.411081e-02 1 1  ON 24
 eC_5                 1.705738e-01 1 1  ON 25
 eC_6                 2.798178e-01 1 1  ON 26
 eC_7                 3.527453e-01 1 1  ON 27
 eC_8                 1.601364e-01 1 1  ON 28
 eC_9                 3.119742e-02 1 1  ON 29
 eO_0                -1.172300e+00 1 1  ON 30
 eO_1                -7.952771e-01 1 1  ON 31
 eO_2                -3.204277e-01 1 1  ON 32
 eO_3                 1.738015e-02 1 1  ON 33
 eO_4                 2.345065e-01 1 1  ON 34
 eO_5                 4.027403e-01 1 1  ON 35
 eO_6                 4.686152e-01 1 1  ON 36
 eO_7                 4.940467e-01 1 1  ON 37
 eO_8                 3.877465e-01 1 1  ON 38
 eO_9                 1.979998e-01 1 1  ON 39
eH1_0                -1.704975e-01 1 1  ON 40
eH1_1                -8.408976e-02 1 1  ON 41
eH1_2                -5.349736e-02 1 1  ON 42
eH1_3                -4.183306e-02 1 1  ON 43
eH1_4                 1.303979e-02 1 1  ON 44
eH1_5                 6.126533e-02 1 1  ON 45
eH1_6                 1.071863e-01 1 1  ON 46
eH1_7                 7.331838e-02 1 1  ON 47
eH1_8                -5.727561e-03 1 1  ON 48
eH1_9                 4.539751e-02 1 1  ON 49
eH2_0                -1.714150e-01 1 1  ON 50
eH2_1                -8.406424e-02 1 1  ON 51
eH2_2                -5.317809e-02 1 1  ON 52
eH2_3                -4.160104e-02 1 1  ON 53
eH2_4                 1.337395e-02 1 1  ON 54
eH2_5                 6.135972e-02 1 1  ON 55
eH2_6                 1.077054e-01 1 1  ON 56
eH2_7                 7.387463e-02 1 1  ON 57
eH2_8                -4.743199e-03 1 1  ON 58
eH2_9                 4.703284e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -22.8834
    reference variance = 1.0065
====================================================
  Execution time = 4.5514e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2827e+01
  VMC Evar = 5.1081e-01
  Total weights = 2.0000e+06
  Execution time = 3.9623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510789616401
                                         uncertainty =       0.004891922897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510789616401
                                         uncertainty =       0.004891922897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505364381
  error estimate for blocks of size 2^( 2) =       0.000523299909
  error estimate for blocks of size 2^( 3) =       0.000538727834
  error estimate for blocks of size 2^( 4) =       0.000549595006
  error estimate for blocks of size 2^( 5) =       0.000557104806
  error estimate for blocks of size 2^( 6) =       0.000564459739
  error estimate for blocks of size 2^( 7) =       0.000565497358

      target function =                  N/A
              le_mean =     -22.826804560376
             les_mean =     521.573792497395
             stat err =       0.000559164227
             autocorr =       1.224248277350
              std dev =       0.714693161561
             le_variance =       0.510786315183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510889338176
                                         uncertainty =       0.004893176092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510889338176
                                         uncertainty =       0.004893176092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505413685
  error estimate for blocks of size 2^( 2) =       0.000523347544
  error estimate for blocks of size 2^( 3) =       0.000538773520
  error estimate for blocks of size 2^( 4) =       0.000549639746
  error estimate for blocks of size 2^( 5) =       0.000557148514
  error estimate for blocks of size 2^( 6) =       0.000564505182
  error estimate for blocks of size 2^( 7) =       0.000565546625

      target function =                  N/A
              le_mean =     -22.826804831311
             les_mean =     521.573904537344
             stat err =       0.000559210017
             autocorr =       1.224209907490
              std dev =       0.714762887982
             le_variance =       0.510885986036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510846009488
                                         uncertainty =       0.004892631354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510846009488
                                         uncertainty =       0.004892631354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505392263
  error estimate for blocks of size 2^( 2) =       0.000523326833
  error estimate for blocks of size 2^( 3) =       0.000538753654
  error estimate for blocks of size 2^( 4) =       0.000549620297
  error estimate for blocks of size 2^( 5) =       0.000557129519
  error estimate for blocks of size 2^( 6) =       0.000564485448
  error estimate for blocks of size 2^( 7) =       0.000565525233

      target function =                  N/A
              le_mean =     -22.826804709247
             les_mean =     521.573855658465
             stat err =       0.000559190124
             autocorr =       1.224226585945
              std dev =       0.714732593206
             le_variance =       0.510842679791

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510796846295
                                         uncertainty =       0.004892013650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510796846295
                                         uncertainty =       0.004892013650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505367956
  error estimate for blocks of size 2^( 2) =       0.000523303361
  error estimate for blocks of size 2^( 3) =       0.000538731144
  error estimate for blocks of size 2^( 4) =       0.000549598249
  error estimate for blocks of size 2^( 5) =       0.000557107974
  error estimate for blocks of size 2^( 6) =       0.000564463035
  error estimate for blocks of size 2^( 7) =       0.000565500934

      target function =                  N/A
              le_mean =     -22.826804578509
             les_mean =     521.573800551473
             stat err =       0.000559167548
             autocorr =       1.224245498193
              std dev =       0.714698217026
             le_variance =       0.510793541420


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826804560376        initial
     3.9062e+00     3.9062e+01             8.2192e-05       -22.826804831311  <--
     1.5625e+01     1.5625e+02             2.3085e-05       -22.826804709247
     6.2500e+01     6.2500e+02             5.9180e-06       -22.826804578509

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 6.3674e+01
  </log>
  <optVariables href="FORM.s013.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124434e-02 1 1  ON 1
 uu_2                -1.965912e-02 1 1  ON 2
 uu_3                -8.457334e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336234e-01 1 1  ON 8
 uu_9                -8.541980e-02 1 1  ON 9
 ud_0                 4.267587e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214262e-04 1 1  ON 12
 ud_3                -8.008423e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711977e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513134e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429611e-02 1 1  ON 23
 eC_4                 7.409426e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527776e-01 1 1  ON 27
 eC_8                 1.601755e-01 1 1  ON 28
 eC_9                 3.120830e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953028e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735675e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027260e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940475e-01 1 1  ON 37
 eO_8                 3.877782e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705046e-01 1 1  ON 40
eH1_1                -8.409341e-02 1 1  ON 41
eH1_2                -5.348539e-02 1 1  ON 42
eH1_3                -4.183180e-02 1 1  ON 43
eH1_4                 1.303348e-02 1 1  ON 44
eH1_5                 6.124134e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332748e-02 1 1  ON 47
eH1_8                -5.715281e-03 1 1  ON 48
eH1_9                 4.539961e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408036e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160243e-02 1 1  ON 53
eH2_4                 1.338292e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387878e-02 1 1  ON 57
eH2_8                -4.747736e-03 1 1  ON 58
eH2_9                 4.702135e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2239e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.839
    reference variance = 0.494324
====================================================
  Execution time = 4.4822e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1956e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5325e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519363484846
                                         uncertainty =       0.009495521802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519363484846
                                         uncertainty =       0.009495521802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509685153
  error estimate for blocks of size 2^( 2) =       0.000527377932
  error estimate for blocks of size 2^( 3) =       0.000542398000
  error estimate for blocks of size 2^( 4) =       0.000554152406
  error estimate for blocks of size 2^( 5) =       0.000561352851
  error estimate for blocks of size 2^( 6) =       0.000564007861
  error estimate for blocks of size 2^( 7) =       0.000565887644

      target function =                  N/A
              le_mean =     -22.824719900922
             les_mean =     521.487396207031
             stat err =       0.000561350191
             autocorr =       1.213008327402
              std dev =       0.720803656544
             le_variance =       0.519557911287


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282471990092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824719900922       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824720822065       residual = 8.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824720813561       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824720971554       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824720952014       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824721667813       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824721683437       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824721663352       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824721614029       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824721577726       residual = 3.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824721626897       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -22.824721596574       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e-01 is 2.103592e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824719900922       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824720175158       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824720177910       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824720220082       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824720188395       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824720357006       residual = 6.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824720370767       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824720392407       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824720384969       residual = 4.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824720364387       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.824720380286       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+00 is 5.948809e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824719900922       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824719972916       residual = 9.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824719974067       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824719984950       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824719974642       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824720014086       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824720017301       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824720025494       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824720025372       residual = 3.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824720020114       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+01 is 1.555934e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.314749 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0156e+01
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.650019e-01 1 1  ON 0
 uu_1                 9.126174e-02 1 1  ON 1
 uu_2                -1.965985e-02 1 1  ON 2
 uu_3                -8.458803e-02 1 1  ON 3
 uu_4                -1.212277e-01 1 1  ON 4
 uu_5                -1.425236e-01 1 1  ON 5
 uu_6                -1.534048e-01 1 1  ON 6
 uu_7                -1.523293e-01 1 1  ON 7
 uu_8                -1.336425e-01 1 1  ON 8
 uu_9                -8.543005e-02 1 1  ON 9
 ud_0                 4.268036e-01 1 1  ON 10
 ud_1                 1.447397e-01 1 1  ON 11
 ud_2                -7.273166e-04 1 1  ON 12
 ud_3                -8.008107e-02 1 1  ON 13
 ud_4                -1.260427e-01 1 1  ON 14
 ud_5                -1.542440e-01 1 1  ON 15
 ud_6                -1.695620e-01 1 1  ON 16
 ud_7                -1.712115e-01 1 1  ON 17
 ud_8                -1.547779e-01 1 1  ON 18
 ud_9                -1.090098e-01 1 1  ON 19
 eC_0                -5.513022e-01 1 1  ON 20
 eC_1                -3.949108e-01 1 1  ON 21
 eC_2                -1.407372e-01 1 1  ON 22
 eC_3                 1.430828e-02 1 1  ON 23
 eC_4                 7.407750e-02 1 1  ON 24
 eC_5                 1.705110e-01 1 1  ON 25
 eC_6                 2.797935e-01 1 1  ON 26
 eC_7                 3.528017e-01 1 1  ON 27
 eC_8                 1.602184e-01 1 1  ON 28
 eC_9                 3.122041e-02 1 1  ON 29
 eO_0                -1.172312e+00 1 1  ON 30
 eO_1                -7.953623e-01 1 1  ON 31
 eO_2                -3.204864e-01 1 1  ON 32
 eO_3                 1.733074e-02 1 1  ON 33
 eO_4                 2.344665e-01 1 1  ON 34
 eO_5                 4.027005e-01 1 1  ON 35
 eO_6                 4.686574e-01 1 1  ON 36
 eO_7                 4.940705e-01 1 1  ON 37
 eO_8                 3.878263e-01 1 1  ON 38
 eO_9                 1.980949e-01 1 1  ON 39
eH1_0                -1.705366e-01 1 1  ON 40
eH1_1                -8.411846e-02 1 1  ON 41
eH1_2                -5.346962e-02 1 1  ON 42
eH1_3                -4.181580e-02 1 1  ON 43
eH1_4                 1.302563e-02 1 1  ON 44
eH1_5                 6.123602e-02 1 1  ON 45
eH1_6                 1.071908e-01 1 1  ON 46
eH1_7                 7.333386e-02 1 1  ON 47
eH1_8                -5.706915e-03 1 1  ON 48
eH1_9                 4.538839e-02 1 1  ON 49
eH2_0                -1.713726e-01 1 1  ON 50
eH2_1                -8.408124e-02 1 1  ON 51
eH2_2                -5.318055e-02 1 1  ON 52
eH2_3                -4.161606e-02 1 1  ON 53
eH2_4                 1.336136e-02 1 1  ON 54
eH2_5                 6.138032e-02 1 1  ON 55
eH2_6                 1.077172e-01 1 1  ON 56
eH2_7                 7.386724e-02 1 1  ON 57
eH2_8                -4.753428e-03 1 1  ON 58
eH2_9                 4.699675e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -22.7765
    reference variance = 0.285453
====================================================
  Execution time = 4.4037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0720e-01
  Total weights = 2.0000e+06
  Execution time = 3.6548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507242154207
                                         uncertainty =       0.006132291897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507242154207
                                         uncertainty =       0.006132291897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503558944
  error estimate for blocks of size 2^( 2) =       0.000521281893
  error estimate for blocks of size 2^( 3) =       0.000537558906
  error estimate for blocks of size 2^( 4) =       0.000549201573
  error estimate for blocks of size 2^( 5) =       0.000557100469
  error estimate for blocks of size 2^( 6) =       0.000560142541
  error estimate for blocks of size 2^( 7) =       0.000560688323

      target function =                  N/A
              le_mean =     -22.825164008608
             les_mean =     521.495254985852
             stat err =       0.000556783226
             autocorr =       1.222564156238
              std dev =       0.712139887653
             le_variance =       0.507143219587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507403622688
                                         uncertainty =       0.006134060809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507403622688
                                         uncertainty =       0.006134060809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503639087
  error estimate for blocks of size 2^( 2) =       0.000521356873
  error estimate for blocks of size 2^( 3) =       0.000537627815
  error estimate for blocks of size 2^( 4) =       0.000549267332
  error estimate for blocks of size 2^( 5) =       0.000557164375
  error estimate for blocks of size 2^( 6) =       0.000560208412
  error estimate for blocks of size 2^( 7) =       0.000560758040

      target function =                  N/A
              le_mean =     -22.825163617659
             les_mean =     521.495398579012
             stat err =       0.000556849540
             autocorr =       1.222466239740
              std dev =       0.712253227282
             le_variance =       0.507304659773

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507354441258
                                         uncertainty =       0.006133581747

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507354441258
                                         uncertainty =       0.006133581747

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503614673
  error estimate for blocks of size 2^( 2) =       0.000521334077
  error estimate for blocks of size 2^( 3) =       0.000537607085
  error estimate for blocks of size 2^( 4) =       0.000549247659
  error estimate for blocks of size 2^( 5) =       0.000557145449
  error estimate for blocks of size 2^( 6) =       0.000560188802
  error estimate for blocks of size 2^( 7) =       0.000560737025

      target function =                  N/A
              le_mean =     -22.825163685924
             les_mean =     521.495352512885
             stat err =       0.000556829734
             autocorr =       1.222497798978
              std dev =       0.712218700461
             le_variance =       0.507255477286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507257791604
                                         uncertainty =       0.006132467064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507257791604
                                         uncertainty =       0.006132467064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503566705
  error estimate for blocks of size 2^( 2) =       0.000521289166
  error estimate for blocks of size 2^( 3) =       0.000537565631
  error estimate for blocks of size 2^( 4) =       0.000549208014
  error estimate for blocks of size 2^( 5) =       0.000557106765
  error estimate for blocks of size 2^( 6) =       0.000560149013
  error estimate for blocks of size 2^( 7) =       0.000560695128

      target function =                  N/A
              le_mean =     -22.825163955582
             les_mean =     521.495268197800
             stat err =       0.000556789730
             autocorr =       1.222555031539
              std dev =       0.712150863370
             le_variance =       0.507158852199


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825164008608        initial  <--
     9.7656e-01     9.7656e+00             2.1036e-04       -22.825163617659
     3.9062e+00     3.9062e+01             5.9488e-05       -22.825163685924
     1.5625e+01     1.5625e+02             1.5559e-05       -22.825163955582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.8411
  </log>
  <optVariables href="FORM.s014.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124434e-02 1 1  ON 1
 uu_2                -1.965912e-02 1 1  ON 2
 uu_3                -8.457334e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336234e-01 1 1  ON 8
 uu_9                -8.541980e-02 1 1  ON 9
 ud_0                 4.267587e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214262e-04 1 1  ON 12
 ud_3                -8.008423e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711977e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513134e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429611e-02 1 1  ON 23
 eC_4                 7.409426e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527776e-01 1 1  ON 27
 eC_8                 1.601755e-01 1 1  ON 28
 eC_9                 3.120830e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953028e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735675e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027260e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940475e-01 1 1  ON 37
 eO_8                 3.877782e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705046e-01 1 1  ON 40
eH1_1                -8.409341e-02 1 1  ON 41
eH1_2                -5.348539e-02 1 1  ON 42
eH1_3                -4.183180e-02 1 1  ON 43
eH1_4                 1.303348e-02 1 1  ON 44
eH1_5                 6.124134e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332748e-02 1 1  ON 47
eH1_8                -5.715281e-03 1 1  ON 48
eH1_9                 4.539961e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408036e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160243e-02 1 1  ON 53
eH2_4                 1.338292e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387878e-02 1 1  ON 57
eH2_8                -4.747736e-03 1 1  ON 58
eH2_9                 4.702135e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2200e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8309
    reference variance = 0.510658
====================================================
  Execution time = 4.3804e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0104e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4920e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501010208182
                                         uncertainty =       0.003410850874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501010208182
                                         uncertainty =       0.003410850874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500518596
  error estimate for blocks of size 2^( 2) =       0.000518260458
  error estimate for blocks of size 2^( 3) =       0.000534294397
  error estimate for blocks of size 2^( 4) =       0.000545772095
  error estimate for blocks of size 2^( 5) =       0.000551307183
  error estimate for blocks of size 2^( 6) =       0.000555934819
  error estimate for blocks of size 2^( 7) =       0.000558524728

      target function =                  N/A
              le_mean =     -22.825674421556
             les_mean =     521.512450278457
             stat err =       0.000552884706
             autocorr =       1.220193530076
              std dev =       0.707840186829
             le_variance =       0.501037730089


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282567442156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825674421556       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825674463133       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825674512014       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825674499500       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825674466239       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825674508187       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825674522800       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825674517905       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825674520560       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825674511899       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825674518645       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+00 is 2.135503e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825674421556       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825674432111       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825674444736       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825674441672       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825674432874       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825674443311       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825674446643       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825674445480       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825674446527       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825674444566       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825674446128       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+01 is 5.433495e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825674421556       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825674424205       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825674427388       residual = 4.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825674426626       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825674424395       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825674427002       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825674427813       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825674427524       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825674427811       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825674427335       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825674427718       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+02 is 1.364484e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.319029 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8733e+01
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.650044e-01 1 1  ON 0
 uu_1                 9.123946e-02 1 1  ON 1
 uu_2                -1.966067e-02 1 1  ON 2
 uu_3                -8.457453e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425322e-01 1 1  ON 5
 uu_6                -1.533777e-01 1 1  ON 6
 uu_7                -1.523253e-01 1 1  ON 7
 uu_8                -1.336239e-01 1 1  ON 8
 uu_9                -8.542028e-02 1 1  ON 9
 ud_0                 4.267635e-01 1 1  ON 10
 ud_1                 1.447327e-01 1 1  ON 11
 ud_2                -7.215441e-04 1 1  ON 12
 ud_3                -8.008507e-02 1 1  ON 13
 ud_4                -1.260427e-01 1 1  ON 14
 ud_5                -1.542591e-01 1 1  ON 15
 ud_6                -1.695613e-01 1 1  ON 16
 ud_7                -1.711994e-01 1 1  ON 17
 ud_8                -1.547546e-01 1 1  ON 18
 ud_9                -1.089883e-01 1 1  ON 19
 eC_0                -5.513133e-01 1 1  ON 20
 eC_1                -3.948863e-01 1 1  ON 21
 eC_2                -1.407268e-01 1 1  ON 22
 eC_3                 1.429068e-02 1 1  ON 23
 eC_4                 7.409818e-02 1 1  ON 24
 eC_5                 1.705472e-01 1 1  ON 25
 eC_6                 2.798013e-01 1 1  ON 26
 eC_7                 3.527802e-01 1 1  ON 27
 eC_8                 1.601800e-01 1 1  ON 28
 eC_9                 3.120957e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953062e-01 1 1  ON 31
 eO_2                -3.204581e-01 1 1  ON 32
 eO_3                 1.735156e-02 1 1  ON 33
 eO_4                 2.344824e-01 1 1  ON 34
 eO_5                 4.027248e-01 1 1  ON 35
 eO_6                 4.686409e-01 1 1  ON 36
 eO_7                 4.940511e-01 1 1  ON 37
 eO_8                 3.877829e-01 1 1  ON 38
 eO_9                 1.980479e-01 1 1  ON 39
eH1_0                -1.705084e-01 1 1  ON 40
eH1_1                -8.409470e-02 1 1  ON 41
eH1_2                -5.348361e-02 1 1  ON 42
eH1_3                -4.183434e-02 1 1  ON 43
eH1_4                 1.303760e-02 1 1  ON 44
eH1_5                 6.124100e-02 1 1  ON 45
eH1_6                 1.071755e-01 1 1  ON 46
eH1_7                 7.332836e-02 1 1  ON 47
eH1_8                -5.716119e-03 1 1  ON 48
eH1_9                 4.539746e-02 1 1  ON 49
eH2_0                -1.714200e-01 1 1  ON 50
eH2_1                -8.408084e-02 1 1  ON 51
eH2_2                -5.319646e-02 1 1  ON 52
eH2_3                -4.160560e-02 1 1  ON 53
eH2_4                 1.338280e-02 1 1  ON 54
eH2_5                 6.135993e-02 1 1  ON 55
eH2_6                 1.077412e-01 1 1  ON 56
eH2_7                 7.387859e-02 1 1  ON 57
eH2_8                -4.747326e-03 1 1  ON 58
eH2_9                 4.701969e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -22.8119
    reference variance = 0.50945
====================================================
  Execution time = 4.4549e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0829e-01
  Total weights = 2.0000e+06
  Execution time = 3.5383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508240923248
                                         uncertainty =       0.005208154831

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508240923248
                                         uncertainty =       0.005208154831

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504125183
  error estimate for blocks of size 2^( 2) =       0.000521751160
  error estimate for blocks of size 2^( 3) =       0.000538326648
  error estimate for blocks of size 2^( 4) =       0.000548711942
  error estimate for blocks of size 2^( 5) =       0.000554699887
  error estimate for blocks of size 2^( 6) =       0.000557028009
  error estimate for blocks of size 2^( 7) =       0.000559678202

      target function =                  N/A
              le_mean =     -22.824369576918
             les_mean =     521.460130729246
             stat err =       0.000555029510
             autocorr =       1.212147203167
              std dev =       0.712940670494
             le_variance =       0.508284399644

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508258893089
                                         uncertainty =       0.005208365740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508258893089
                                         uncertainty =       0.005208365740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504134093
  error estimate for blocks of size 2^( 2) =       0.000521759403
  error estimate for blocks of size 2^( 3) =       0.000538334443
  error estimate for blocks of size 2^( 4) =       0.000548719326
  error estimate for blocks of size 2^( 5) =       0.000554707138
  error estimate for blocks of size 2^( 6) =       0.000557034779
  error estimate for blocks of size 2^( 7) =       0.000559685162

      target function =                  N/A
              le_mean =     -22.824369499925
             les_mean =     521.460145182081
             stat err =       0.000555036601
             autocorr =       1.212135330227
              std dev =       0.712953271332
             le_variance =       0.508302367104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508250180751
                                         uncertainty =       0.005208263287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508250180751
                                         uncertainty =       0.005208263287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504129773
  error estimate for blocks of size 2^( 2) =       0.000521755407
  error estimate for blocks of size 2^( 3) =       0.000538330665
  error estimate for blocks of size 2^( 4) =       0.000548715748
  error estimate for blocks of size 2^( 5) =       0.000554703626
  error estimate for blocks of size 2^( 6) =       0.000557031500
  error estimate for blocks of size 2^( 7) =       0.000559681789

      target function =                  N/A
              le_mean =     -22.824369538172
             les_mean =     521.460138216803
             stat err =       0.000555033166
             autocorr =       1.212141097880
              std dev =       0.712947162075
             le_variance =       0.508293655911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508242088664
                                         uncertainty =       0.005208168482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508242088664
                                         uncertainty =       0.005208168482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504125761
  error estimate for blocks of size 2^( 2) =       0.000521751694
  error estimate for blocks of size 2^( 3) =       0.000538327153
  error estimate for blocks of size 2^( 4) =       0.000548712421
  error estimate for blocks of size 2^( 5) =       0.000554700357
  error estimate for blocks of size 2^( 6) =       0.000557028449
  error estimate for blocks of size 2^( 7) =       0.000559678653

      target function =                  N/A
              le_mean =     -22.824369572006
             les_mean =     521.460131670281
             stat err =       0.000555029970
             autocorr =       1.212146434546
              std dev =       0.712941487714
             le_variance =       0.508285564904


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824369576918        initial  <--
     9.7656e+00     9.7656e+01             2.1355e-05       -22.824369499925
     3.9062e+01     3.9062e+02             5.4335e-06       -22.824369538172
     1.5625e+02     1.5625e+03             1.3645e-06       -22.824369572006

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 62.2478
  </log>
  <optVariables href="FORM.s015.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124434e-02 1 1  ON 1
 uu_2                -1.965912e-02 1 1  ON 2
 uu_3                -8.457334e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336234e-01 1 1  ON 8
 uu_9                -8.541980e-02 1 1  ON 9
 ud_0                 4.267587e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214262e-04 1 1  ON 12
 ud_3                -8.008423e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711977e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513134e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429611e-02 1 1  ON 23
 eC_4                 7.409426e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527776e-01 1 1  ON 27
 eC_8                 1.601755e-01 1 1  ON 28
 eC_9                 3.120830e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953028e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735675e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027260e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940475e-01 1 1  ON 37
 eO_8                 3.877782e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705046e-01 1 1  ON 40
eH1_1                -8.409341e-02 1 1  ON 41
eH1_2                -5.348539e-02 1 1  ON 42
eH1_3                -4.183180e-02 1 1  ON 43
eH1_4                 1.303348e-02 1 1  ON 44
eH1_5                 6.124134e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332748e-02 1 1  ON 47
eH1_8                -5.715281e-03 1 1  ON 48
eH1_9                 4.539961e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408036e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160243e-02 1 1  ON 53
eH2_4                 1.338292e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387878e-02 1 1  ON 57
eH2_8                -4.747736e-03 1 1  ON 58
eH2_9                 4.702135e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2099e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.8169
    reference variance = 0.323116
====================================================
  Execution time = 4.5441e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0582e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4964e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505984612189
                                         uncertainty =       0.008276689083

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505984612189
                                         uncertainty =       0.008276689083

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502902343
  error estimate for blocks of size 2^( 2) =       0.000520506514
  error estimate for blocks of size 2^( 3) =       0.000536695480
  error estimate for blocks of size 2^( 4) =       0.000548404340
  error estimate for blocks of size 2^( 5) =       0.000555837397
  error estimate for blocks of size 2^( 6) =       0.000558448456
  error estimate for blocks of size 2^( 7) =       0.000561247806

      target function =                  N/A
              le_mean =     -22.825731268050
             les_mean =     521.519829201206
             stat err =       0.000555984500
             autocorr =       1.222244383737
              std dev =       0.711211313796
             le_variance =       0.505821532872


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282573126805e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825731268050       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825731263995       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825731257870       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825731258899       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825731257201       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825731261789       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825731262775       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825731264893       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825731262898       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825731264328       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+01 is 2.122959e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825731268050       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825731267035       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825731265499       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825731265760       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825731265337       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825731266489       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825731266738       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825731267261       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825731266762       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825731267118       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+02 is 5.310630e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825731268050       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825731267796       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825731267412       residual = 3.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825731267478       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825731267373       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825731267659       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825731267721       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825731267853       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825731267728       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825731267816       residual = 6.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+03 is 1.327860e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.322692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0413e+01
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.650048e-01 1 1  ON 0
 uu_1                 9.124416e-02 1 1  ON 1
 uu_2                -1.965926e-02 1 1  ON 2
 uu_3                -8.457318e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533763e-01 1 1  ON 6
 uu_7                -1.523296e-01 1 1  ON 7
 uu_8                -1.336240e-01 1 1  ON 8
 uu_9                -8.541991e-02 1 1  ON 9
 ud_0                 4.267589e-01 1 1  ON 10
 ud_1                 1.447307e-01 1 1  ON 11
 ud_2                -7.212238e-04 1 1  ON 12
 ud_3                -8.008419e-02 1 1  ON 13
 ud_4                -1.260436e-01 1 1  ON 14
 ud_5                -1.542577e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711977e-01 1 1  ON 17
 ud_8                -1.547524e-01 1 1  ON 18
 ud_9                -1.089880e-01 1 1  ON 19
 eC_0                -5.513134e-01 1 1  ON 20
 eC_1                -3.948837e-01 1 1  ON 21
 eC_2                -1.407274e-01 1 1  ON 22
 eC_3                 1.429596e-02 1 1  ON 23
 eC_4                 7.409431e-02 1 1  ON 24
 eC_5                 1.705488e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527780e-01 1 1  ON 27
 eC_8                 1.601760e-01 1 1  ON 28
 eC_9                 3.120841e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953032e-01 1 1  ON 31
 eO_2                -3.204570e-01 1 1  ON 32
 eO_3                 1.735642e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027260e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877786e-01 1 1  ON 38
 eO_9                 1.980431e-01 1 1  ON 39
eH1_0                -1.705050e-01 1 1  ON 40
eH1_1                -8.409391e-02 1 1  ON 41
eH1_2                -5.348529e-02 1 1  ON 42
eH1_3                -4.183142e-02 1 1  ON 43
eH1_4                 1.303358e-02 1 1  ON 44
eH1_5                 6.124132e-02 1 1  ON 45
eH1_6                 1.071728e-01 1 1  ON 46
eH1_7                 7.332753e-02 1 1  ON 47
eH1_8                -5.715251e-03 1 1  ON 48
eH1_9                 4.539950e-02 1 1  ON 49
eH2_0                -1.714190e-01 1 1  ON 50
eH2_1                -8.408035e-02 1 1  ON 51
eH2_2                -5.319879e-02 1 1  ON 52
eH2_3                -4.160267e-02 1 1  ON 53
eH2_4                 1.338287e-02 1 1  ON 54
eH2_5                 6.135858e-02 1 1  ON 55
eH2_6                 1.077395e-01 1 1  ON 56
eH2_7                 7.387906e-02 1 1  ON 57
eH2_8                -4.747623e-03 1 1  ON 58
eH2_9                 4.702122e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -22.7784
    reference variance = 5.55498
====================================================
  Execution time = 4.3236e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0715e-01
  Total weights = 2.0000e+06
  Execution time = 3.5412e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506728788064
                                         uncertainty =       0.005821413116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506728788064
                                         uncertainty =       0.005821413116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503562101
  error estimate for blocks of size 2^( 2) =       0.000520918369
  error estimate for blocks of size 2^( 3) =       0.000536314950
  error estimate for blocks of size 2^( 4) =       0.000547323264
  error estimate for blocks of size 2^( 5) =       0.000554257305
  error estimate for blocks of size 2^( 6) =       0.000556766602
  error estimate for blocks of size 2^( 7) =       0.000560203405

      target function =                  N/A
              le_mean =     -22.824706988695
             les_mean =     521.474398445973
             stat err =       0.000554637644
             autocorr =       1.213144715382
              std dev =       0.712144353187
             le_variance =       0.507149579776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506728727233
                                         uncertainty =       0.005821400785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506728727233
                                         uncertainty =       0.005821400785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503562071
  error estimate for blocks of size 2^( 2) =       0.000520918366
  error estimate for blocks of size 2^( 3) =       0.000536314986
  error estimate for blocks of size 2^( 4) =       0.000547323301
  error estimate for blocks of size 2^( 5) =       0.000554257340
  error estimate for blocks of size 2^( 6) =       0.000556766645
  error estimate for blocks of size 2^( 7) =       0.000560203421

      target function =                  N/A
              le_mean =     -22.824706975368
             les_mean =     521.474397776149
             stat err =       0.000554637677
             autocorr =       1.213145004132
              std dev =       0.712144310021
             le_variance =       0.507149518295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506728757410
                                         uncertainty =       0.005821406919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506728757410
                                         uncertainty =       0.005821406919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503562086
  error estimate for blocks of size 2^( 2) =       0.000520918367
  error estimate for blocks of size 2^( 3) =       0.000536314968
  error estimate for blocks of size 2^( 4) =       0.000547323283
  error estimate for blocks of size 2^( 5) =       0.000554257322
  error estimate for blocks of size 2^( 6) =       0.000556766624
  error estimate for blocks of size 2^( 7) =       0.000560203413

      target function =                  N/A
              le_mean =     -22.824706981993
             les_mean =     521.474398109082
             stat err =       0.000554637660
             autocorr =       1.213144860499
              std dev =       0.712144331436
             le_variance =       0.507149548797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506728784222
                                         uncertainty =       0.005821412341

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506728784222
                                         uncertainty =       0.005821412341

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503562099
  error estimate for blocks of size 2^( 2) =       0.000520918369
  error estimate for blocks of size 2^( 3) =       0.000536314952
  error estimate for blocks of size 2^( 4) =       0.000547323267
  error estimate for blocks of size 2^( 5) =       0.000554257307
  error estimate for blocks of size 2^( 6) =       0.000556766605
  error estimate for blocks of size 2^( 7) =       0.000560203406

      target function =                  N/A
              le_mean =     -22.824706987855
             les_mean =     521.474398403775
             stat err =       0.000554637646
             autocorr =       1.213144733546
              std dev =       0.712144350461
             le_variance =       0.507149575893


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824706988695        initial  <--
     9.7656e+01     9.7656e+02             2.1230e-06       -22.824706975368
     3.9062e+02     3.9062e+03             5.3106e-07       -22.824706981993
     1.5625e+03     1.5625e+04             1.3279e-07       -22.824706987855

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.9530
  </log>
  <optVariables href="FORM.s016.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124434e-02 1 1  ON 1
 uu_2                -1.965912e-02 1 1  ON 2
 uu_3                -8.457334e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336234e-01 1 1  ON 8
 uu_9                -8.541980e-02 1 1  ON 9
 ud_0                 4.267587e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214262e-04 1 1  ON 12
 ud_3                -8.008423e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711977e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513134e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429611e-02 1 1  ON 23
 eC_4                 7.409426e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527776e-01 1 1  ON 27
 eC_8                 1.601755e-01 1 1  ON 28
 eC_9                 3.120830e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953028e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735675e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027260e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940475e-01 1 1  ON 37
 eO_8                 3.877782e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705046e-01 1 1  ON 40
eH1_1                -8.409341e-02 1 1  ON 41
eH1_2                -5.348539e-02 1 1  ON 42
eH1_3                -4.183180e-02 1 1  ON 43
eH1_4                 1.303348e-02 1 1  ON 44
eH1_5                 6.124134e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332748e-02 1 1  ON 47
eH1_8                -5.715281e-03 1 1  ON 48
eH1_9                 4.539961e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408036e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160243e-02 1 1  ON 53
eH2_4                 1.338292e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387878e-02 1 1  ON 57
eH2_8                -4.747736e-03 1 1  ON 58
eH2_9                 4.702135e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2137e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.8514
    reference variance = 0.321257
====================================================
  Execution time = 4.3367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0403e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4916e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502405774526
                                         uncertainty =       0.003985418255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502405774526
                                         uncertainty =       0.003985418255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502008633
  error estimate for blocks of size 2^( 2) =       0.000519782757
  error estimate for blocks of size 2^( 3) =       0.000535817029
  error estimate for blocks of size 2^( 4) =       0.000548112234
  error estimate for blocks of size 2^( 5) =       0.000553962855
  error estimate for blocks of size 2^( 6) =       0.000556572472
  error estimate for blocks of size 2^( 7) =       0.000560099776

      target function =                  N/A
              le_mean =     -22.825481143028
             les_mean =     521.506614494834
             stat err =       0.000554686834
             autocorr =       1.220881023653
              std dev =       0.709947417857
             le_variance =       0.504025336122


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282548114303e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825481143028       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825481143276       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825481144040       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825481143352       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825481142978       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825481143040       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825481143445       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825481143674       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825481143943       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825481143852       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825481143912       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+02 is 2.938584e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825481143028       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825481143090       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825481143281       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825481143108       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825481143014       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825481143029       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825481143127       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825481143187       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825481143247       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825481143230       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825481143247       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+03 is 7.347609e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825481143028       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825481143043       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825481143091       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825481143048       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825481143030       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825481143028       residual = 8.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825481143071       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825481143032       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825481143085       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825481143124       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825481143091       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+04 is 1.836974e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326958 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8291e+01
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124434e-02 1 1  ON 1
 uu_2                -1.965911e-02 1 1  ON 2
 uu_3                -8.457334e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533765e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214184e-04 1 1  ON 12
 ud_3                -8.008423e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711977e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513134e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429611e-02 1 1  ON 23
 eC_4                 7.409425e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120831e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735675e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940475e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409340e-02 1 1  ON 41
eH1_2                -5.348540e-02 1 1  ON 42
eH1_3                -4.183180e-02 1 1  ON 43
eH1_4                 1.303346e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332749e-02 1 1  ON 47
eH1_8                -5.715282e-03 1 1  ON 48
eH1_9                 4.539960e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408039e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160244e-02 1 1  ON 53
eH2_4                 1.338289e-02 1 1  ON 54
eH2_5                 6.135872e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387878e-02 1 1  ON 57
eH2_8                -4.747722e-03 1 1  ON 58
eH2_9                 4.702134e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -22.7888
    reference variance = 0.51526
====================================================
  Execution time = 4.2885e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1655e-01
  Total weights = 2.0000e+06
  Execution time = 3.5349e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516560580351
                                         uncertainty =       0.016024828959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516560580351
                                         uncertainty =       0.016024828959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508209901
  error estimate for blocks of size 2^( 2) =       0.000525735879
  error estimate for blocks of size 2^( 3) =       0.000541475059
  error estimate for blocks of size 2^( 4) =       0.000552090726
  error estimate for blocks of size 2^( 5) =       0.000560206075
  error estimate for blocks of size 2^( 6) =       0.000561973864
  error estimate for blocks of size 2^( 7) =       0.000561830576

      target function =                  N/A
              le_mean =     -22.825222424071
             les_mean =     521.507333057971
             stat err =       0.000559025310
             autocorr =       1.209975839467
              std dev =       0.718717335215
             le_variance =       0.516554607939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516560766612
                                         uncertainty =       0.016024900393

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516560766612
                                         uncertainty =       0.016024900393

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508209993
  error estimate for blocks of size 2^( 2) =       0.000525735964
  error estimate for blocks of size 2^( 3) =       0.000541475142
  error estimate for blocks of size 2^( 4) =       0.000552090807
  error estimate for blocks of size 2^( 5) =       0.000560206157
  error estimate for blocks of size 2^( 6) =       0.000561973948
  error estimate for blocks of size 2^( 7) =       0.000561830658

      target function =                  N/A
              le_mean =     -22.825222422930
             les_mean =     521.507333191890
             stat err =       0.000559025392
             autocorr =       1.209975758774
              std dev =       0.718717464620
             le_variance =       0.516554793949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516560673509
                                         uncertainty =       0.016024864687

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516560673509
                                         uncertainty =       0.016024864687

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508209947
  error estimate for blocks of size 2^( 2) =       0.000525735922
  error estimate for blocks of size 2^( 3) =       0.000541475101
  error estimate for blocks of size 2^( 4) =       0.000552090766
  error estimate for blocks of size 2^( 5) =       0.000560206116
  error estimate for blocks of size 2^( 6) =       0.000561973906
  error estimate for blocks of size 2^( 7) =       0.000561830617

      target function =                  N/A
              le_mean =     -22.825222423500
             les_mean =     521.507333124951
             stat err =       0.000559025351
             autocorr =       1.209975799114
              std dev =       0.718717399936
             le_variance =       0.516554700971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516560591997
                                         uncertainty =       0.016024833425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.516560591997
                                         uncertainty =       0.016024833425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000508209907
  error estimate for blocks of size 2^( 2) =       0.000525735884
  error estimate for blocks of size 2^( 3) =       0.000541475064
  error estimate for blocks of size 2^( 4) =       0.000552090731
  error estimate for blocks of size 2^( 5) =       0.000560206081
  error estimate for blocks of size 2^( 6) =       0.000561973870
  error estimate for blocks of size 2^( 7) =       0.000561830581

      target function =                  N/A
              le_mean =     -22.825222424000
             les_mean =     521.507333066344
             stat err =       0.000559025316
             autocorr =       1.209975834431
              std dev =       0.718717343306
             le_variance =       0.516554619569


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825222424071        initial  <--
     9.7656e+02     9.7656e+03             2.9386e-07       -22.825222422930
     3.9062e+03     3.9062e+04             7.3476e-08       -22.825222423500
     1.5625e+04     1.5625e+05             1.8370e-08       -22.825222424000

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.5716
  </log>
  <optVariables href="FORM.s017.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124434e-02 1 1  ON 1
 uu_2                -1.965912e-02 1 1  ON 2
 uu_3                -8.457334e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336234e-01 1 1  ON 8
 uu_9                -8.541980e-02 1 1  ON 9
 ud_0                 4.267587e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214262e-04 1 1  ON 12
 ud_3                -8.008423e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711977e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513134e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429611e-02 1 1  ON 23
 eC_4                 7.409426e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527776e-01 1 1  ON 27
 eC_8                 1.601755e-01 1 1  ON 28
 eC_9                 3.120830e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953028e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735675e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027260e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940475e-01 1 1  ON 37
 eO_8                 3.877782e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705046e-01 1 1  ON 40
eH1_1                -8.409341e-02 1 1  ON 41
eH1_2                -5.348539e-02 1 1  ON 42
eH1_3                -4.183180e-02 1 1  ON 43
eH1_4                 1.303348e-02 1 1  ON 44
eH1_5                 6.124134e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332748e-02 1 1  ON 47
eH1_8                -5.715281e-03 1 1  ON 48
eH1_9                 4.539961e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408036e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160243e-02 1 1  ON 53
eH2_4                 1.338292e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387878e-02 1 1  ON 57
eH2_8                -4.747736e-03 1 1  ON 58
eH2_9                 4.702135e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1887e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.8624
    reference variance = 0.317409
====================================================
  Execution time = 4.5610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0234e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4872e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502389939038
                                         uncertainty =       0.003393888692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502389939038
                                         uncertainty =       0.003393888692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501166905
  error estimate for blocks of size 2^( 2) =       0.000518890298
  error estimate for blocks of size 2^( 3) =       0.000535108358
  error estimate for blocks of size 2^( 4) =       0.000547732637
  error estimate for blocks of size 2^( 5) =       0.000554778640
  error estimate for blocks of size 2^( 6) =       0.000557982647
  error estimate for blocks of size 2^( 7) =       0.000558879133

      target function =                  N/A
              le_mean =     -22.824601097904
             les_mean =     521.464751561167
             stat err =       0.000554843264
             autocorr =       1.225676521458
              std dev =       0.708757034444
             le_variance =       0.502336533874


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282460109790e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824601097904       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824601097964       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824601097984       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824601098021       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824601098049       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824601098071       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824601098127       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824601098170       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824601098129       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824601098146       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+03 is 2.257016e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824601097904       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824601097919       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824601097924       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824601097940       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824601097920       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824601097953       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824601097966       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824601098041       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824601097980       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824601097937       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+04 is 5.642553e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824601097904       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824601097908       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824601097909       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824601097912       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824601097955       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824601097941       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824601098035       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824601097861       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824601098046       residual = 2.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824601098585       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5625e+05 is 1.410639e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.330647 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0490e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124434e-02 1 1  ON 1
 uu_2                -1.965912e-02 1 1  ON 2
 uu_3                -8.457334e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336234e-01 1 1  ON 8
 uu_9                -8.541980e-02 1 1  ON 9
 ud_0                 4.267587e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214261e-04 1 1  ON 12
 ud_3                -8.008423e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711977e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513134e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429611e-02 1 1  ON 23
 eC_4                 7.409426e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527776e-01 1 1  ON 27
 eC_8                 1.601755e-01 1 1  ON 28
 eC_9                 3.120830e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953028e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735674e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027260e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940475e-01 1 1  ON 37
 eO_8                 3.877782e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705046e-01 1 1  ON 40
eH1_1                -8.409341e-02 1 1  ON 41
eH1_2                -5.348539e-02 1 1  ON 42
eH1_3                -4.183180e-02 1 1  ON 43
eH1_4                 1.303348e-02 1 1  ON 44
eH1_5                 6.124134e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332748e-02 1 1  ON 47
eH1_8                -5.715280e-03 1 1  ON 48
eH1_9                 4.539961e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408037e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160244e-02 1 1  ON 53
eH2_4                 1.338292e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387879e-02 1 1  ON 57
eH2_8                -4.747735e-03 1 1  ON 58
eH2_9                 4.702135e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -22.885
    reference variance = 0.377283
====================================================
  Execution time = 4.5173e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0482e-01
  Total weights = 2.0000e+06
  Execution time = 3.5207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504621415751
                                         uncertainty =       0.003913229818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504621415751
                                         uncertainty =       0.003913229818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502402318
  error estimate for blocks of size 2^( 2) =       0.000519897338
  error estimate for blocks of size 2^( 3) =       0.000535716008
  error estimate for blocks of size 2^( 4) =       0.000547468353
  error estimate for blocks of size 2^( 5) =       0.000554263839
  error estimate for blocks of size 2^( 6) =       0.000558680745
  error estimate for blocks of size 2^( 7) =       0.000564129927

      target function =                  N/A
              le_mean =     -22.825456210195
             les_mean =     521.506267128829
             stat err =       0.000556135716
             autocorr =       1.225344782703
              std dev =       0.710504171499
             le_variance =       0.504816177718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504621428389
                                         uncertainty =       0.003913229853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504621428389
                                         uncertainty =       0.003913229853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502402324
  error estimate for blocks of size 2^( 2) =       0.000519897344
  error estimate for blocks of size 2^( 3) =       0.000535716014
  error estimate for blocks of size 2^( 4) =       0.000547468359
  error estimate for blocks of size 2^( 5) =       0.000554263844
  error estimate for blocks of size 2^( 6) =       0.000558680751
  error estimate for blocks of size 2^( 7) =       0.000564129933

      target function =                  N/A
              le_mean =     -22.825456210199
             les_mean =     521.506267141662
             stat err =       0.000556135722
             autocorr =       1.225344776755
              std dev =       0.710504180390
             le_variance =       0.504816190352

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504621422070
                                         uncertainty =       0.003913229835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504621422070
                                         uncertainty =       0.003913229835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502402321
  error estimate for blocks of size 2^( 2) =       0.000519897341
  error estimate for blocks of size 2^( 3) =       0.000535716011
  error estimate for blocks of size 2^( 4) =       0.000547468356
  error estimate for blocks of size 2^( 5) =       0.000554263842
  error estimate for blocks of size 2^( 6) =       0.000558680748
  error estimate for blocks of size 2^( 7) =       0.000564129930

      target function =                  N/A
              le_mean =     -22.825456210197
             les_mean =     521.506267135246
             stat err =       0.000556135719
             autocorr =       1.225344779732
              std dev =       0.710504175945
             le_variance =       0.504816184035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504621416541
                                         uncertainty =       0.003913229820

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504621416541
                                         uncertainty =       0.003913229820

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502402318
  error estimate for blocks of size 2^( 2) =       0.000519897338
  error estimate for blocks of size 2^( 3) =       0.000535716008
  error estimate for blocks of size 2^( 4) =       0.000547468354
  error estimate for blocks of size 2^( 5) =       0.000554263839
  error estimate for blocks of size 2^( 6) =       0.000558680746
  error estimate for blocks of size 2^( 7) =       0.000564129927

      target function =                  N/A
              le_mean =     -22.825456210195
             les_mean =     521.506267129631
             stat err =       0.000556135717
             autocorr =       1.225344782336
              std dev =       0.710504172055
             le_variance =       0.504816178507


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825456210195        initial
     9.7656e+03     9.7656e+04             2.2570e-08       -22.825456210199  <--
     3.9062e+04     3.9062e+05             5.6426e-09       -22.825456210197
     1.5625e+05     1.5625e+06             1.4106e-09       -22.825456210195

*****************************************************************************
Applying the update for shift_i =   9.7656e+03     and shift_s =   9.7656e+04
*****************************************************************************

  Execution time = 6.2823e+01
  </log>
  <optVariables href="FORM.s018.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124434e-02 1 1  ON 1
 uu_2                -1.965913e-02 1 1  ON 2
 uu_3                -8.457334e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336234e-01 1 1  ON 8
 uu_9                -8.541980e-02 1 1  ON 9
 ud_0                 4.267587e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214259e-04 1 1  ON 12
 ud_3                -8.008422e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711977e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513134e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429610e-02 1 1  ON 23
 eC_4                 7.409426e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120831e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953028e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735673e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027260e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940475e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705046e-01 1 1  ON 40
eH1_1                -8.409341e-02 1 1  ON 41
eH1_2                -5.348540e-02 1 1  ON 42
eH1_3                -4.183180e-02 1 1  ON 43
eH1_4                 1.303348e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332749e-02 1 1  ON 47
eH1_8                -5.715278e-03 1 1  ON 48
eH1_9                 4.539960e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408037e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160245e-02 1 1  ON 53
eH2_4                 1.338292e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387880e-02 1 1  ON 57
eH2_8                -4.747729e-03 1 1  ON 58
eH2_9                 4.702135e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2332e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.763
    reference variance = 0.423641
====================================================
  Execution time = 4.4036e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1045e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5155e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510565286407
                                         uncertainty =       0.004787402212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510565286407
                                         uncertainty =       0.004787402212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505199157
  error estimate for blocks of size 2^( 2) =       0.000522994575
  error estimate for blocks of size 2^( 3) =       0.000538993241
  error estimate for blocks of size 2^( 4) =       0.000549558181
  error estimate for blocks of size 2^( 5) =       0.000557559847
  error estimate for blocks of size 2^( 6) =       0.000560545625
  error estimate for blocks of size 2^( 7) =       0.000559651898

      target function =                  N/A
              le_mean =     -22.826056714923
             les_mean =     521.539317274037
             stat err =       0.000556828888
             autocorr =       1.214837757140
              std dev =       0.714459499483
             le_variance =       0.510452376401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282605671492e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826056714923       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826056715047       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826056715317       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826056715524       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826056715742       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826056715711       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826056715844       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826056715955       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826056715904       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826056715866       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 8.133658e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826056714923       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826056714954       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826056715021       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826056715075       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826056715127       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826056715131       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826056715149       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826056715192       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826056715141       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826056715158       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+03 is 2.033581e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826056714923       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826056714930       residual = 5.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826056714947       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826056714991       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826056714974       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826056714962       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826056714963       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826056715013       residual = 6.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826056714947       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826056715009       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.9062e+04 is 5.084056e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334284 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9199e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124435e-02 1 1  ON 1
 uu_2                -1.965913e-02 1 1  ON 2
 uu_3                -8.457334e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541981e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214222e-04 1 1  ON 12
 ud_3                -8.008422e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711977e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513134e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429610e-02 1 1  ON 23
 eC_4                 7.409425e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120831e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953028e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735672e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940475e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409341e-02 1 1  ON 41
eH1_2                -5.348538e-02 1 1  ON 42
eH1_3                -4.183180e-02 1 1  ON 43
eH1_4                 1.303348e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332749e-02 1 1  ON 47
eH1_8                -5.715282e-03 1 1  ON 48
eH1_9                 4.539960e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408038e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160245e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387881e-02 1 1  ON 57
eH2_8                -4.747731e-03 1 1  ON 58
eH2_9                 4.702134e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -22.7593
    reference variance = 0.282403
====================================================
  Execution time = 4.3533e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0102e-01
  Total weights = 2.0000e+06
  Execution time = 3.5289e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501003664489
                                         uncertainty =       0.003356322834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501003664489
                                         uncertainty =       0.003356322834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500511957
  error estimate for blocks of size 2^( 2) =       0.000518171760
  error estimate for blocks of size 2^( 3) =       0.000534125065
  error estimate for blocks of size 2^( 4) =       0.000544128180
  error estimate for blocks of size 2^( 5) =       0.000551269560
  error estimate for blocks of size 2^( 6) =       0.000554249922
  error estimate for blocks of size 2^( 7) =       0.000557891577

      target function =                  N/A
              le_mean =     -22.824848611389
             les_mean =     521.474738321207
             stat err =       0.000551884810
             autocorr =       1.215816314204
              std dev =       0.707830798199
             le_variance =       0.501024438879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501003752582
                                         uncertainty =       0.003356323292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501003752582
                                         uncertainty =       0.003356323292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500512001
  error estimate for blocks of size 2^( 2) =       0.000518171801
  error estimate for blocks of size 2^( 3) =       0.000534125103
  error estimate for blocks of size 2^( 4) =       0.000544128217
  error estimate for blocks of size 2^( 5) =       0.000551269595
  error estimate for blocks of size 2^( 6) =       0.000554249955
  error estimate for blocks of size 2^( 7) =       0.000557891613

      target function =                  N/A
              le_mean =     -22.824848611509
             les_mean =     521.474738414646
             stat err =       0.000551884845
             autocorr =       1.215816256157
              std dev =       0.707830860359
             le_variance =       0.501024526876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501003708541
                                         uncertainty =       0.003356323063

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501003708541
                                         uncertainty =       0.003356323063

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500511979
  error estimate for blocks of size 2^( 2) =       0.000518171781
  error estimate for blocks of size 2^( 3) =       0.000534125084
  error estimate for blocks of size 2^( 4) =       0.000544128199
  error estimate for blocks of size 2^( 5) =       0.000551269578
  error estimate for blocks of size 2^( 6) =       0.000554249938
  error estimate for blocks of size 2^( 7) =       0.000557891595

      target function =                  N/A
              le_mean =     -22.824848611449
             les_mean =     521.474738367930
             stat err =       0.000551884827
             autocorr =       1.215816285178
              std dev =       0.707830829282
             le_variance =       0.501024482882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501003669996
                                         uncertainty =       0.003356322862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501003669996
                                         uncertainty =       0.003356322862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500511960
  error estimate for blocks of size 2^( 2) =       0.000518171763
  error estimate for blocks of size 2^( 3) =       0.000534125068
  error estimate for blocks of size 2^( 4) =       0.000544128183
  error estimate for blocks of size 2^( 5) =       0.000551269562
  error estimate for blocks of size 2^( 6) =       0.000554249924
  error estimate for blocks of size 2^( 7) =       0.000557891580

      target function =                  N/A
              le_mean =     -22.824848611397
             les_mean =     521.474738327047
             stat err =       0.000551884812
             autocorr =       1.215816310571
              std dev =       0.707830802085
             le_variance =       0.501024444380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824848611389        initial
     2.4414e+03     2.4414e+04             8.1337e-08       -22.824848611509  <--
     9.7656e+03     9.7656e+04             2.0336e-08       -22.824848611449
     3.9062e+04     3.9062e+05             5.0841e-09       -22.824848611397

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 6.1217e+01
  </log>
  <optVariables href="FORM.s019.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214113e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429609e-02 1 1  ON 23
 eC_4                 7.409423e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183178e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124136e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715292e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747735e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2042e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8755
    reference variance = 0.409427
====================================================
  Execution time = 4.3764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1891e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4937e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519023693370
                                         uncertainty =       0.017944137286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.519023693370
                                         uncertainty =       0.017944137286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000509366029
  error estimate for blocks of size 2^( 2) =       0.000527125915
  error estimate for blocks of size 2^( 3) =       0.000542210285
  error estimate for blocks of size 2^( 4) =       0.000553205526
  error estimate for blocks of size 2^( 5) =       0.000558976806
  error estimate for blocks of size 2^( 6) =       0.000563816961
  error estimate for blocks of size 2^( 7) =       0.000565902767

      target function =                  N/A
              le_mean =     -22.826068596465
             les_mean =     521.548314814180
             stat err =       0.000560475515
             autocorr =       1.210746813864
              std dev =       0.720352346500
             le_variance =       0.518907503108


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282606859647e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826068596465       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826068597507       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826068597285       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826068595335       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826068593828       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826068593855       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826068594135       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826068594393       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826068594645       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826068594500       residual = 3.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+02 is 3.729198e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826068596465       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826068596726       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826068596670       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826068596182       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826068595806       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826068595810       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826068595880       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826068595944       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826068596015       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826068595968       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+03 is 9.324460e-08

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826068596465       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826068596530       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826068596516       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826068596394       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826068596299       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826068596296       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826068596326       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826068596333       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826068596370       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826068596319       residual = 3.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+03 is 2.331207e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337922 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8709e+01
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124430e-02 1 1  ON 1
 uu_2                -1.965917e-02 1 1  ON 2
 uu_3                -8.457334e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523296e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541989e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214046e-04 1 1  ON 12
 ud_3                -8.008418e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089880e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948834e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409420e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601757e-01 1 1  ON 28
 eC_9                 3.120834e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204568e-01 1 1  ON 32
 eO_3                 1.735663e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027258e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877784e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409348e-02 1 1  ON 41
eH1_2                -5.348535e-02 1 1  ON 42
eH1_3                -4.183182e-02 1 1  ON 43
eH1_4                 1.303351e-02 1 1  ON 44
eH1_5                 6.124134e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332755e-02 1 1  ON 47
eH1_8                -5.715284e-03 1 1  ON 48
eH1_9                 4.539954e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319878e-02 1 1  ON 52
eH2_3                -4.160247e-02 1 1  ON 53
eH2_4                 1.338290e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387886e-02 1 1  ON 57
eH2_8                -4.747721e-03 1 1  ON 58
eH2_9                 4.702129e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -22.8926
    reference variance = 0.594321
====================================================
  Execution time = 4.5090e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1083e-01
  Total weights = 2.0000e+06
  Execution time = 3.5356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510735576792
                                         uncertainty =       0.004341085280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510735576792
                                         uncertainty =       0.004341085280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505384008
  error estimate for blocks of size 2^( 2) =       0.000522788518
  error estimate for blocks of size 2^( 3) =       0.000538301153
  error estimate for blocks of size 2^( 4) =       0.000548884677
  error estimate for blocks of size 2^( 5) =       0.000555909804
  error estimate for blocks of size 2^( 6) =       0.000559617379
  error estimate for blocks of size 2^( 7) =       0.000561701436

      target function =                  N/A
              le_mean =     -22.825856754530
             les_mean =     521.530562314306
             stat err =       0.000556528324
             autocorr =       1.212639061357
              std dev =       0.714720918532
             le_variance =       0.510825991387

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510735529069
                                         uncertainty =       0.004341086215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510735529069
                                         uncertainty =       0.004341086215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505383985
  error estimate for blocks of size 2^( 2) =       0.000522788497
  error estimate for blocks of size 2^( 3) =       0.000538301135
  error estimate for blocks of size 2^( 4) =       0.000548884659
  error estimate for blocks of size 2^( 5) =       0.000555909788
  error estimate for blocks of size 2^( 6) =       0.000559617359
  error estimate for blocks of size 2^( 7) =       0.000561701409

      target function =                  N/A
              le_mean =     -22.825856753161
             les_mean =     521.530562204111
             stat err =       0.000556528304
             autocorr =       1.212639086397
              std dev =       0.714720885181
             le_variance =       0.510825943714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510735552927
                                         uncertainty =       0.004341085748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510735552927
                                         uncertainty =       0.004341085748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505383996
  error estimate for blocks of size 2^( 2) =       0.000522788507
  error estimate for blocks of size 2^( 3) =       0.000538301144
  error estimate for blocks of size 2^( 4) =       0.000548884668
  error estimate for blocks of size 2^( 5) =       0.000555909796
  error estimate for blocks of size 2^( 6) =       0.000559617369
  error estimate for blocks of size 2^( 7) =       0.000561701422

      target function =                  N/A
              le_mean =     -22.825856753845
             les_mean =     521.530562259173
             stat err =       0.000556528314
             autocorr =       1.212639073876
              std dev =       0.714720901855
             le_variance =       0.510825967548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510735573809
                                         uncertainty =       0.004341085338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510735573809
                                         uncertainty =       0.004341085338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505384007
  error estimate for blocks of size 2^( 2) =       0.000522788517
  error estimate for blocks of size 2^( 3) =       0.000538301152
  error estimate for blocks of size 2^( 4) =       0.000548884675
  error estimate for blocks of size 2^( 5) =       0.000555909803
  error estimate for blocks of size 2^( 6) =       0.000559617378
  error estimate for blocks of size 2^( 7) =       0.000561701434

      target function =                  N/A
              le_mean =     -22.825856754444
             les_mean =     521.530562307413
             stat err =       0.000556528323
             autocorr =       1.212639062927
              std dev =       0.714720916447
             le_variance =       0.510825988407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825856754530        initial  <--
     6.1035e+02     6.1035e+03             3.7292e-07       -22.825856753161
     2.4414e+03     2.4414e+04             9.3245e-08       -22.825856753845
     9.7656e+03     9.7656e+04             2.3312e-08       -22.825856754444

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 66.5337
  </log>
  <optVariables href="FORM.s020.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214113e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429609e-02 1 1  ON 23
 eC_4                 7.409423e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183178e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124136e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715292e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747735e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2525e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.9448
    reference variance = 0.560014
====================================================
  Execution time = 4.4680e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0563e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4963e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505379560003
                                         uncertainty =       0.003211273921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505379560003
                                         uncertainty =       0.003211273921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502805759
  error estimate for blocks of size 2^( 2) =       0.000520711407
  error estimate for blocks of size 2^( 3) =       0.000537156301
  error estimate for blocks of size 2^( 4) =       0.000548629136
  error estimate for blocks of size 2^( 5) =       0.000555393256
  error estimate for blocks of size 2^( 6) =       0.000557543153
  error estimate for blocks of size 2^( 7) =       0.000562207947

      target function =                  N/A
              le_mean =     -22.825335593782
             les_mean =     521.501571979208
             stat err =       0.000555943373
             autocorr =       1.222533104814
              std dev =       0.711074724101
             le_variance =       0.505627263255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282533559378e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825335593782       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825335593751       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825335593825       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825335593818       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825335593861       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825335593850       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825335593900       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825335593897       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825335593887       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825335593907       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+03 is 4.605291e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825335593782       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825335593774       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825335593793       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825335593791       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825335593804       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825335593816       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825335593831       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825335593766       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825335593777       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825335593813       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+04 is 1.151357e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825335593782       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825335593780       residual = 9.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825335593785       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825335593784       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825335593748       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825335593761       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825335593782       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825335593764       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825335593852       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825335593874       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+04 is 2.878413e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.341588 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9651e+01
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214121e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332751e-02 1 1  ON 47
eH1_8                -5.715287e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319876e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747734e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -22.8915
    reference variance = 0.366586
====================================================
  Execution time = 4.3558e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0702e-01
  Total weights = 2.0000e+06
  Execution time = 3.5393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507202487870
                                         uncertainty =       0.004176267556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507202487870
                                         uncertainty =       0.004176267556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503500114
  error estimate for blocks of size 2^( 2) =       0.000521299698
  error estimate for blocks of size 2^( 3) =       0.000536705588
  error estimate for blocks of size 2^( 4) =       0.000547082728
  error estimate for blocks of size 2^( 5) =       0.000554381731
  error estimate for blocks of size 2^( 6) =       0.000557647779
  error estimate for blocks of size 2^( 7) =       0.000559908210

      target function =                  N/A
              le_mean =     -22.825992234864
             les_mean =     521.532945982087
             stat err =       0.000554755112
             autocorr =       1.213957490033
              std dev =       0.712056689838
             le_variance =       0.507024729543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507202540521
                                         uncertainty =       0.004176268104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507202540521
                                         uncertainty =       0.004176268104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503500140
  error estimate for blocks of size 2^( 2) =       0.000521299723
  error estimate for blocks of size 2^( 3) =       0.000536705611
  error estimate for blocks of size 2^( 4) =       0.000547082750
  error estimate for blocks of size 2^( 5) =       0.000554381752
  error estimate for blocks of size 2^( 6) =       0.000557647800
  error estimate for blocks of size 2^( 7) =       0.000559908230

      target function =                  N/A
              le_mean =     -22.825992234755
             les_mean =     521.532946029737
             stat err =       0.000554755133
             autocorr =       1.213957457055
              std dev =       0.712056726791
             le_variance =       0.507024782168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507202514197
                                         uncertainty =       0.004176267830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507202514197
                                         uncertainty =       0.004176267830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503500127
  error estimate for blocks of size 2^( 2) =       0.000521299711
  error estimate for blocks of size 2^( 3) =       0.000536705599
  error estimate for blocks of size 2^( 4) =       0.000547082739
  error estimate for blocks of size 2^( 5) =       0.000554381741
  error estimate for blocks of size 2^( 6) =       0.000557647790
  error estimate for blocks of size 2^( 7) =       0.000559908220

      target function =                  N/A
              le_mean =     -22.825992234809
             les_mean =     521.532946005913
             stat err =       0.000554755122
             autocorr =       1.213957473544
              std dev =       0.712056708315
             le_variance =       0.507024755857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507202491161
                                         uncertainty =       0.004176267590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507202491161
                                         uncertainty =       0.004176267590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503500116
  error estimate for blocks of size 2^( 2) =       0.000521299700
  error estimate for blocks of size 2^( 3) =       0.000536705590
  error estimate for blocks of size 2^( 4) =       0.000547082729
  error estimate for blocks of size 2^( 5) =       0.000554381732
  error estimate for blocks of size 2^( 6) =       0.000557647780
  error estimate for blocks of size 2^( 7) =       0.000559908211

      target function =                  N/A
              le_mean =     -22.825992234857
             les_mean =     521.532945985065
             stat err =       0.000554755113
             autocorr =       1.213957487968
              std dev =       0.712056692148
             le_variance =       0.507024732833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825992234864        initial  <--
     6.1035e+03     6.1035e+04             4.6053e-08       -22.825992234755
     2.4414e+04     2.4414e+05             1.1514e-08       -22.825992234809
     9.7656e+04     9.7656e+05             2.8784e-09       -22.825992234857

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.2356
  </log>
  <optVariables href="FORM.s021.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214113e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429609e-02 1 1  ON 23
 eC_4                 7.409423e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183178e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124136e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715292e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747735e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2089e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.7492
    reference variance = 0.624153
====================================================
  Execution time = 4.4326e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9847e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4938e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498574185653
                                         uncertainty =       0.004226943848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.498574185653
                                         uncertainty =       0.004226943848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499236373
  error estimate for blocks of size 2^( 2) =       0.000517627869
  error estimate for blocks of size 2^( 3) =       0.000533270650
  error estimate for blocks of size 2^( 4) =       0.000544743422
  error estimate for blocks of size 2^( 5) =       0.000552212322
  error estimate for blocks of size 2^( 6) =       0.000555219838
  error estimate for blocks of size 2^( 7) =       0.000555268542

      target function =                  N/A
              le_mean =     -22.825550752748
             les_mean =     521.504240830159
             stat err =       0.000551861031
             autocorr =       1.221931938583
              std dev =       0.706026850126
             le_variance =       0.498473913100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282555075275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825550752748       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825550752746       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825550752744       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825550752733       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825550752728       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825550752789       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825550752750       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825550752719       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825550752770       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825550752772       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+04 is 3.059532e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825550752748       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825550752748       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825550752747       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825550752710       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825550752747       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825550752756       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825550752747       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825550752684       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825550752913       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825550753093       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+05 is 7.648833e-10

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825550752748       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825550752748       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825550752748       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825550753353       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825550752775       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825550752226       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825550752881       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825550752911       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825550754094       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825550753972       residual = 5.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.7656e+05 is 1.912213e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9271e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214112e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429609e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980426e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124136e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715292e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747735e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -22.856
    reference variance = 0.7449
====================================================
  Execution time = 4.3320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0682e-01
  Total weights = 2.0000e+06
  Execution time = 3.5430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506914106870
                                         uncertainty =       0.006051513940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506914106870
                                         uncertainty =       0.006051513940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503400915
  error estimate for blocks of size 2^( 2) =       0.000521291711
  error estimate for blocks of size 2^( 3) =       0.000537896161
  error estimate for blocks of size 2^( 4) =       0.000548786549
  error estimate for blocks of size 2^( 5) =       0.000556217308
  error estimate for blocks of size 2^( 6) =       0.000559634519
  error estimate for blocks of size 2^( 7) =       0.000559902526

      target function =                  N/A
              le_mean =     -22.825674403551
             les_mean =     521.518236685719
             stat err =       0.000556135225
             autocorr =       1.220486014292
              std dev =       0.711916401128
             le_variance =       0.506824962194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506914109353
                                         uncertainty =       0.006051514024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506914109353
                                         uncertainty =       0.006051514024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503400916
  error estimate for blocks of size 2^( 2) =       0.000521291712
  error estimate for blocks of size 2^( 3) =       0.000537896162
  error estimate for blocks of size 2^( 4) =       0.000548786550
  error estimate for blocks of size 2^( 5) =       0.000556217309
  error estimate for blocks of size 2^( 6) =       0.000559634520
  error estimate for blocks of size 2^( 7) =       0.000559902527

      target function =                  N/A
              le_mean =     -22.825674403552
             les_mean =     521.518236688219
             stat err =       0.000556135226
             autocorr =       1.220486012506
              std dev =       0.711916402870
             le_variance =       0.506824964675

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506914108112
                                         uncertainty =       0.006051513982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506914108112
                                         uncertainty =       0.006051513982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503400915
  error estimate for blocks of size 2^( 2) =       0.000521291711
  error estimate for blocks of size 2^( 3) =       0.000537896162
  error estimate for blocks of size 2^( 4) =       0.000548786549
  error estimate for blocks of size 2^( 5) =       0.000556217308
  error estimate for blocks of size 2^( 6) =       0.000559634519
  error estimate for blocks of size 2^( 7) =       0.000559902527

      target function =                  N/A
              le_mean =     -22.825674403552
             les_mean =     521.518236686969
             stat err =       0.000556135226
             autocorr =       1.220486013396
              std dev =       0.711916401999
             le_variance =       0.506824963435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506914107026
                                         uncertainty =       0.006051513945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506914107026
                                         uncertainty =       0.006051513945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503400915
  error estimate for blocks of size 2^( 2) =       0.000521291711
  error estimate for blocks of size 2^( 3) =       0.000537896161
  error estimate for blocks of size 2^( 4) =       0.000548786549
  error estimate for blocks of size 2^( 5) =       0.000556217308
  error estimate for blocks of size 2^( 6) =       0.000559634519
  error estimate for blocks of size 2^( 7) =       0.000559902526

      target function =                  N/A
              le_mean =     -22.825674403551
             les_mean =     521.518236685875
             stat err =       0.000556135226
             autocorr =       1.220486014177
              std dev =       0.711916401236
             le_variance =       0.506824962349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825674403551        initial
     6.1035e+04     6.1035e+05             3.0595e-09       -22.825674403552  <--
     2.4414e+05     2.4414e+06             7.6488e-10       -22.825674403552
     9.7656e+05     9.7656e+06             1.9122e-10       -22.825674403551

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 6.1078e+01
  </log>
  <optVariables href="FORM.s022.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214111e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124136e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747735e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2036e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2825e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8413
    reference variance = 0.256749
====================================================
  Execution time = 4.5776e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0841e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5720e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508479070382
                                         uncertainty =       0.004074994797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508479070382
                                         uncertainty =       0.004074994797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504185322
  error estimate for blocks of size 2^( 2) =       0.000521871085
  error estimate for blocks of size 2^( 3) =       0.000537575315
  error estimate for blocks of size 2^( 4) =       0.000549155853
  error estimate for blocks of size 2^( 5) =       0.000554626172
  error estimate for blocks of size 2^( 6) =       0.000558155584
  error estimate for blocks of size 2^( 7) =       0.000561190145

      target function =                  N/A
              le_mean =     -22.825254005138
             les_mean =     521.500625823682
             stat err =       0.000555781939
             autocorr =       1.215146000417
              std dev =       0.713025721009
             le_variance =       0.508405678820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282525400514e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825254005138       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825254005178       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825254005201       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825254005226       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825254005210       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825254005201       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825254005227       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825254005210       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825254005175       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825254005180       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+04 is 1.703839e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825254005138       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825254005148       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825254005154       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825254005142       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825254005138       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825254005128       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825254005163       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825254005217       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825254005215       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825254004912       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+04 is 4.259638e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825254005138       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825254005140       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825254005142       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825254005143       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825254005141       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825254005075       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825254005335       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825254005226       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825254004752       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825254004917       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+05 is 1.064912e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.348858 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1504e+01
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214113e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409343e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124136e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332751e-02 1 1  ON 47
eH1_8                -5.715290e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747734e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -22.8775
    reference variance = 0.652017
====================================================
  Execution time = 4.3359e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.2732e-01
  Total weights = 2.0000e+06
  Execution time = 3.5266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527417476992
                                         uncertainty =       0.014326492898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527417476992
                                         uncertainty =       0.014326492898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513478741
  error estimate for blocks of size 2^( 2) =       0.000531237040
  error estimate for blocks of size 2^( 3) =       0.000546910417
  error estimate for blocks of size 2^( 4) =       0.000557765660
  error estimate for blocks of size 2^( 5) =       0.000565839092
  error estimate for blocks of size 2^( 6) =       0.000570583362
  error estimate for blocks of size 2^( 7) =       0.000574018157

      target function =                  N/A
              le_mean =     -22.825526516400
             les_mean =     521.531981322957
             stat err =       0.000567051567
             autocorr =       1.219551583798
              std dev =       0.726168600071
             le_variance =       0.527320835729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527417484503
                                         uncertainty =       0.014326492947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527417484503
                                         uncertainty =       0.014326492947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513478745
  error estimate for blocks of size 2^( 2) =       0.000531237044
  error estimate for blocks of size 2^( 3) =       0.000546910420
  error estimate for blocks of size 2^( 4) =       0.000557765662
  error estimate for blocks of size 2^( 5) =       0.000565839095
  error estimate for blocks of size 2^( 6) =       0.000570583365
  error estimate for blocks of size 2^( 7) =       0.000574018160

      target function =                  N/A
              le_mean =     -22.825526516391
             les_mean =     521.531981330057
             stat err =       0.000567051570
             autocorr =       1.219551578819
              std dev =       0.726168605244
             le_variance =       0.527320843241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527417480748
                                         uncertainty =       0.014326492922

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527417480748
                                         uncertainty =       0.014326492922

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513478743
  error estimate for blocks of size 2^( 2) =       0.000531237042
  error estimate for blocks of size 2^( 3) =       0.000546910419
  error estimate for blocks of size 2^( 4) =       0.000557765661
  error estimate for blocks of size 2^( 5) =       0.000565839093
  error estimate for blocks of size 2^( 6) =       0.000570583363
  error estimate for blocks of size 2^( 7) =       0.000574018158

      target function =                  N/A
              le_mean =     -22.825526516396
             les_mean =     521.531981326507
             stat err =       0.000567051569
             autocorr =       1.219551581310
              std dev =       0.726168602657
             le_variance =       0.527320839485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527417477462
                                         uncertainty =       0.014326492901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.527417477462
                                         uncertainty =       0.014326492901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000513478742
  error estimate for blocks of size 2^( 2) =       0.000531237040
  error estimate for blocks of size 2^( 3) =       0.000546910417
  error estimate for blocks of size 2^( 4) =       0.000557765660
  error estimate for blocks of size 2^( 5) =       0.000565839092
  error estimate for blocks of size 2^( 6) =       0.000570583362
  error estimate for blocks of size 2^( 7) =       0.000574018157

      target function =                  N/A
              le_mean =     -22.825526516400
             les_mean =     521.531981323401
             stat err =       0.000567051568
             autocorr =       1.219551583483
              std dev =       0.726168600394
             le_variance =       0.527320836198


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825526516400        initial  <--
     1.5259e+04     1.5259e+05             1.7038e-08       -22.825526516391
     6.1035e+04     6.1035e+05             4.2596e-09       -22.825526516396
     2.4414e+05     2.4414e+06             1.0649e-09       -22.825526516400

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 61.0341
  </log>
  <optVariables href="FORM.s023.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214111e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124136e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747735e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2254e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.7627
    reference variance = 0.374059
====================================================
  Execution time = 4.3741e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0473e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5288e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504785106428
                                         uncertainty =       0.004733687889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504785106428
                                         uncertainty =       0.004733687889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502360761
  error estimate for blocks of size 2^( 2) =       0.000520191858
  error estimate for blocks of size 2^( 3) =       0.000536561845
  error estimate for blocks of size 2^( 4) =       0.000547467015
  error estimate for blocks of size 2^( 5) =       0.000554294169
  error estimate for blocks of size 2^( 6) =       0.000559996725
  error estimate for blocks of size 2^( 7) =       0.000558772496

      target function =                  N/A
              le_mean =     -22.825857683958
             les_mean =     521.524511423894
             stat err =       0.000555132601
             autocorr =       1.221130409735
              std dev =       0.710445401092
             le_variance =       0.504732667933


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282585768396e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825857683958       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825857683964       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825857683968       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825857683968       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825857683975       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825857683967       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825857684060       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825857683866       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825857683625       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825857683543       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+05 is 1.289076e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825857683958       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825857683960       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825857683961       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825857683961       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825857683961       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825857683961       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825857683647       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825857683994       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825857683533       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825857683260       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+05 is 3.222698e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825857683958       residual = 8.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825857683959       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825857683959       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825857683818       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825857682837       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825857682424       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825857683279       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825857682971       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825857679763       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825857691311       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.4414e+06 is 8.056863e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.352558 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9038e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214111e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747734e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -22.8655
    reference variance = 0.611909
====================================================
  Execution time = 4.3191e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0679e-01
  Total weights = 2.0000e+06
  Execution time = 3.5227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506658777124
                                         uncertainty =       0.005020815479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506658777124
                                         uncertainty =       0.005020815479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503385645
  error estimate for blocks of size 2^( 2) =       0.000521047022
  error estimate for blocks of size 2^( 3) =       0.000536449257
  error estimate for blocks of size 2^( 4) =       0.000547171228
  error estimate for blocks of size 2^( 5) =       0.000553297167
  error estimate for blocks of size 2^( 6) =       0.000555345035
  error estimate for blocks of size 2^( 7) =       0.000560134625

      target function =                  N/A
              le_mean =     -22.825259318699
             les_mean =     521.499256927813
             stat err =       0.000553987014
             autocorr =       1.211148833501
              std dev =       0.711894806386
             le_variance =       0.506794215360

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506658778033
                                         uncertainty =       0.005020815482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506658778033
                                         uncertainty =       0.005020815482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503385646
  error estimate for blocks of size 2^( 2) =       0.000521047023
  error estimate for blocks of size 2^( 3) =       0.000536449258
  error estimate for blocks of size 2^( 4) =       0.000547171228
  error estimate for blocks of size 2^( 5) =       0.000553297168
  error estimate for blocks of size 2^( 6) =       0.000555345035
  error estimate for blocks of size 2^( 7) =       0.000560134626

      target function =                  N/A
              le_mean =     -22.825259318699
             les_mean =     521.499256928725
             stat err =       0.000553987014
             autocorr =       1.211148833001
              std dev =       0.711894807024
             le_variance =       0.506794216268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506658777578
                                         uncertainty =       0.005020815481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506658777578
                                         uncertainty =       0.005020815481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503385645
  error estimate for blocks of size 2^( 2) =       0.000521047022
  error estimate for blocks of size 2^( 3) =       0.000536449257
  error estimate for blocks of size 2^( 4) =       0.000547171228
  error estimate for blocks of size 2^( 5) =       0.000553297168
  error estimate for blocks of size 2^( 6) =       0.000555345035
  error estimate for blocks of size 2^( 7) =       0.000560134625

      target function =                  N/A
              le_mean =     -22.825259318699
             les_mean =     521.499256928269
             stat err =       0.000553987014
             autocorr =       1.211148833247
              std dev =       0.711894806705
             le_variance =       0.506794215814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506658777181
                                         uncertainty =       0.005020815479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.506658777181
                                         uncertainty =       0.005020815479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000503385645
  error estimate for blocks of size 2^( 2) =       0.000521047022
  error estimate for blocks of size 2^( 3) =       0.000536449257
  error estimate for blocks of size 2^( 4) =       0.000547171228
  error estimate for blocks of size 2^( 5) =       0.000553297167
  error estimate for blocks of size 2^( 6) =       0.000555345035
  error estimate for blocks of size 2^( 7) =       0.000560134625

      target function =                  N/A
              le_mean =     -22.825259318699
             les_mean =     521.499256927870
             stat err =       0.000553987014
             autocorr =       1.211148833466
              std dev =       0.711894806426
             le_variance =       0.506794215416


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825259318699        initial
     1.5259e+05     1.5259e+06             1.2891e-09       -22.825259318699  <--
     6.1035e+05     6.1035e+06             3.2227e-10       -22.825259318699
     2.4414e+06     2.4414e+07             8.0569e-11       -22.825259318699

*****************************************************************************
Applying the update for shift_i =   1.5259e+05     and shift_s =   1.5259e+06
*****************************************************************************

  Execution time = 6.0850e+01
  </log>
  <optVariables href="FORM.s024.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214110e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747734e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1990e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.9224
    reference variance = 0.375511
====================================================
  Execution time = 4.4032e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0000e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4914e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499991155621
                                         uncertainty =       0.003131940587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499991155621
                                         uncertainty =       0.003131940587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500001198
  error estimate for blocks of size 2^( 2) =       0.000518049532
  error estimate for blocks of size 2^( 3) =       0.000533907673
  error estimate for blocks of size 2^( 4) =       0.000545785828
  error estimate for blocks of size 2^( 5) =       0.000551483372
  error estimate for blocks of size 2^( 6) =       0.000554967563
  error estimate for blocks of size 2^( 7) =       0.000555765478

      target function =                  N/A
              le_mean =     -22.825162324322
             les_mean =     521.488037278474
             stat err =       0.000552000560
             autocorr =       1.218812631179
              std dev =       0.707108476004
             le_variance =       0.500002396837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282516232432e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825162324322       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825162324358       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825162324356       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825162324357       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825162324328       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825162324342       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825162324325       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825162324296       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825162324400       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825162324469       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+04 is 8.866074e-09

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825162324322       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825162324331       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825162324330       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825162324326       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825162324325       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825162324289       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825162324188       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825162324262       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825162323771       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825162324081       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+05 is 2.216532e-09

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825162324322       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825162324324       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825162324324       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825162324316       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825162324531       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825162324284       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825162324341       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825162324511       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825162324394       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825162324171       residual = 5.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+05 is 5.541333e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356178 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8954e+01
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214113e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747733e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -22.8378
    reference variance = 0.435093
====================================================
  Execution time = 4.4799e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0955e-01
  Total weights = 2.0000e+06
  Execution time = 3.5240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509435927790
                                         uncertainty =       0.012325593721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509435927790
                                         uncertainty =       0.012325593721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504750643
  error estimate for blocks of size 2^( 2) =       0.000522556094
  error estimate for blocks of size 2^( 3) =       0.000538467607
  error estimate for blocks of size 2^( 4) =       0.000549284126
  error estimate for blocks of size 2^( 5) =       0.000555860121
  error estimate for blocks of size 2^( 6) =       0.000557186491
  error estimate for blocks of size 2^( 7) =       0.000558900193

      target function =                  N/A
              le_mean =     -22.825120721924
             les_mean =     521.495682138800
             stat err =       0.000555307733
             autocorr =       1.210357541942
              std dev =       0.713825204925
             le_variance =       0.509546423186

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509435936201
                                         uncertainty =       0.012325593837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509435936201
                                         uncertainty =       0.012325593837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504750647
  error estimate for blocks of size 2^( 2) =       0.000522556098
  error estimate for blocks of size 2^( 3) =       0.000538467611
  error estimate for blocks of size 2^( 4) =       0.000549284129
  error estimate for blocks of size 2^( 5) =       0.000555860124
  error estimate for blocks of size 2^( 6) =       0.000557186494
  error estimate for blocks of size 2^( 7) =       0.000558900196

      target function =                  N/A
              le_mean =     -22.825120721832
             les_mean =     521.495682143025
             stat err =       0.000555307736
             autocorr =       1.210357536324
              std dev =       0.713825210819
             le_variance =       0.509546431600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509435931995
                                         uncertainty =       0.012325593779

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509435931995
                                         uncertainty =       0.012325593779

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504750645
  error estimate for blocks of size 2^( 2) =       0.000522556096
  error estimate for blocks of size 2^( 3) =       0.000538467609
  error estimate for blocks of size 2^( 4) =       0.000549284128
  error estimate for blocks of size 2^( 5) =       0.000555860123
  error estimate for blocks of size 2^( 6) =       0.000557186493
  error estimate for blocks of size 2^( 7) =       0.000558900195

      target function =                  N/A
              le_mean =     -22.825120721878
             les_mean =     521.495682140913
             stat err =       0.000555307734
             autocorr =       1.210357539133
              std dev =       0.713825207872
             le_variance =       0.509546427393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509435928315
                                         uncertainty =       0.012325593729

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509435928315
                                         uncertainty =       0.012325593729

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504750643
  error estimate for blocks of size 2^( 2) =       0.000522556094
  error estimate for blocks of size 2^( 3) =       0.000538467607
  error estimate for blocks of size 2^( 4) =       0.000549284126
  error estimate for blocks of size 2^( 5) =       0.000555860121
  error estimate for blocks of size 2^( 6) =       0.000557186491
  error estimate for blocks of size 2^( 7) =       0.000558900193

      target function =                  N/A
              le_mean =     -22.825120721918
             les_mean =     521.495682139064
             stat err =       0.000555307733
             autocorr =       1.210357541586
              std dev =       0.713825205293
             le_variance =       0.509546423712


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825120721924        initial  <--
     3.8147e+04     3.8147e+05             8.8661e-09       -22.825120721832
     1.5259e+05     1.5259e+06             2.2165e-09       -22.825120721878
     6.1035e+05     6.1035e+06             5.5413e-10       -22.825120721918

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 65.4928
  </log>
  <optVariables href="FORM.s025.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214110e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747734e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2445e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.733
    reference variance = 0.443819
====================================================
  Execution time = 4.3527e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0138e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4851e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501387918940
                                         uncertainty =       0.004382335888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501387918940
                                         uncertainty =       0.004382335888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500688147
  error estimate for blocks of size 2^( 2) =       0.000518671952
  error estimate for blocks of size 2^( 3) =       0.000534353815
  error estimate for blocks of size 2^( 4) =       0.000545120659
  error estimate for blocks of size 2^( 5) =       0.000551608839
  error estimate for blocks of size 2^( 6) =       0.000556271833
  error estimate for blocks of size 2^( 7) =       0.000558169790

      target function =                  N/A
              le_mean =     -22.824613026552
             les_mean =     521.464336801433
             stat err =       0.000552792780
             autocorr =       1.218961825655
              std dev =       0.708079967425
             le_variance =       0.501377240268


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282461302655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824613026552       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824613026554       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824613026556       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824613026530       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824613026287       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824613026845       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824613026346       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824613026881       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824613026680       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824613027806       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+05 is 8.077847e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824613026552       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824613026553       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824613026553       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824613026553       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824613026540       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824613026778       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824613026205       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824613025555       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824613026573       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824613025579       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+06 is 2.019468e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824613026552       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824613026552       residual = 6.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824613026552       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824613025692       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824613026374       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824613028465       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824613023479       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824613026051       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824613030623       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824613026180       residual = 7.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 6.1035e+06 is 5.048648e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.359849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8386e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214110e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747734e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -22.7982
    reference variance = 0.468729
====================================================
  Execution time = 4.2815e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0160e-01
  Total weights = 2.0000e+06
  Execution time = 3.5302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501635720221
                                         uncertainty =       0.003688354875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501635720221
                                         uncertainty =       0.003688354875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500800067
  error estimate for blocks of size 2^( 2) =       0.000518997238
  error estimate for blocks of size 2^( 3) =       0.000534775834
  error estimate for blocks of size 2^( 4) =       0.000544992936
  error estimate for blocks of size 2^( 5) =       0.000552243770
  error estimate for blocks of size 2^( 6) =       0.000554724494
  error estimate for blocks of size 2^( 7) =       0.000556693457

      target function =                  N/A
              le_mean =     -22.825536409042
             les_mean =     521.506713524306
             stat err =       0.000552163664
             autocorr =       1.215645344020
              std dev =       0.708238247067
             le_variance =       0.501601414609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501635720521
                                         uncertainty =       0.003688354879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501635720521
                                         uncertainty =       0.003688354879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500800067
  error estimate for blocks of size 2^( 2) =       0.000518997238
  error estimate for blocks of size 2^( 3) =       0.000534775834
  error estimate for blocks of size 2^( 4) =       0.000544992936
  error estimate for blocks of size 2^( 5) =       0.000552243770
  error estimate for blocks of size 2^( 6) =       0.000554724495
  error estimate for blocks of size 2^( 7) =       0.000556693457

      target function =                  N/A
              le_mean =     -22.825536409045
             les_mean =     521.506713524741
             stat err =       0.000552163664
             autocorr =       1.215645343880
              std dev =       0.708238247279
             le_variance =       0.501601414909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501635720371
                                         uncertainty =       0.003688354877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501635720371
                                         uncertainty =       0.003688354877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500800067
  error estimate for blocks of size 2^( 2) =       0.000518997238
  error estimate for blocks of size 2^( 3) =       0.000534775834
  error estimate for blocks of size 2^( 4) =       0.000544992936
  error estimate for blocks of size 2^( 5) =       0.000552243770
  error estimate for blocks of size 2^( 6) =       0.000554724494
  error estimate for blocks of size 2^( 7) =       0.000556693457

      target function =                  N/A
              le_mean =     -22.825536409043
             les_mean =     521.506713524524
             stat err =       0.000552163664
             autocorr =       1.215645343950
              std dev =       0.708238247173
             le_variance =       0.501601414759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501635720240
                                         uncertainty =       0.003688354875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.501635720240
                                         uncertainty =       0.003688354875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500800067
  error estimate for blocks of size 2^( 2) =       0.000518997238
  error estimate for blocks of size 2^( 3) =       0.000534775834
  error estimate for blocks of size 2^( 4) =       0.000544992936
  error estimate for blocks of size 2^( 5) =       0.000552243770
  error estimate for blocks of size 2^( 6) =       0.000554724494
  error estimate for blocks of size 2^( 7) =       0.000556693457

      target function =                  N/A
              le_mean =     -22.825536409042
             les_mean =     521.506713524334
             stat err =       0.000552163664
             autocorr =       1.215645344021
              std dev =       0.708238247081
             le_variance =       0.501601414628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825536409042        initial
     3.8147e+05     3.8147e+06             8.0778e-10       -22.825536409045  <--
     1.5259e+06     1.5259e+07             2.0195e-10       -22.825536409043
     6.1035e+06     6.1035e+07             5.0486e-11       -22.825536409042

*****************************************************************************
Applying the update for shift_i =   3.8147e+05     and shift_s =   3.8147e+06
*****************************************************************************

  Execution time = 6.0482e+01
  </log>
  <optVariables href="FORM.s026.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214109e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747734e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1888e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.7778
    reference variance = 0.276321
====================================================
  Execution time = 4.3590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0329e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5085e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503324571603
                                         uncertainty =       0.004499445714

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503324571603
                                         uncertainty =       0.004499445714

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501640765
  error estimate for blocks of size 2^( 2) =       0.000519699827
  error estimate for blocks of size 2^( 3) =       0.000535433774
  error estimate for blocks of size 2^( 4) =       0.000547043548
  error estimate for blocks of size 2^( 5) =       0.000554164852
  error estimate for blocks of size 2^( 6) =       0.000559287210
  error estimate for blocks of size 2^( 7) =       0.000559817784

      target function =                  N/A
              le_mean =     -22.825650389555
             les_mean =     521.513602368228
             stat err =       0.000555078348
             autocorr =       1.224398904623
              std dev =       0.709427172924
             le_variance =       0.503286913684


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282565038955e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825650389555       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825650389552       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825650389546       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825650389542       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825650389535       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825650389528       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825650389563       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825650389570       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825650389471       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825650389536       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+04 is 2.577086e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825650389555       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825650389554       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825650389553       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825650389552       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825650389554       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825650389622       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825650389509       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825650390008       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825650389783       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825650390253       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+05 is 6.442718e-10

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825650389555       residual = 9.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825650389555       residual = 7.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825650389554       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825650389200       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825650389893       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825650389755       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825650388522       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825650389254       residual = 7.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825650388975       residual = 4.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825650389370       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.5259e+06 is 1.610684e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.363516 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8683e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214110e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735670e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747734e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -22.9364
    reference variance = 0.315847
====================================================
  Execution time = 4.3020e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0574e-01
  Total weights = 2.0000e+06
  Execution time = 3.5290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505831213746
                                         uncertainty =       0.006218736214

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505831213746
                                         uncertainty =       0.006218736214

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502864010
  error estimate for blocks of size 2^( 2) =       0.000520643074
  error estimate for blocks of size 2^( 3) =       0.000536405743
  error estimate for blocks of size 2^( 4) =       0.000547425841
  error estimate for blocks of size 2^( 5) =       0.000554319495
  error estimate for blocks of size 2^( 6) =       0.000558399216
  error estimate for blocks of size 2^( 7) =       0.000557368463

      target function =                  N/A
              le_mean =     -22.825422606515
             les_mean =     521.505661338247
             stat err =       0.000554378254
             autocorr =       1.215377701174
              std dev =       0.711157102982
             le_variance =       0.505744425121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505831215071
                                         uncertainty =       0.006218736219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505831215071
                                         uncertainty =       0.006218736219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502864011
  error estimate for blocks of size 2^( 2) =       0.000520643074
  error estimate for blocks of size 2^( 3) =       0.000536405743
  error estimate for blocks of size 2^( 4) =       0.000547425842
  error estimate for blocks of size 2^( 5) =       0.000554319495
  error estimate for blocks of size 2^( 6) =       0.000558399216
  error estimate for blocks of size 2^( 7) =       0.000557368464

      target function =                  N/A
              le_mean =     -22.825422606517
             les_mean =     521.505661339679
             stat err =       0.000554378254
             autocorr =       1.215377700385
              std dev =       0.711157103913
             le_variance =       0.505744426446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505831214409
                                         uncertainty =       0.006218736217

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505831214409
                                         uncertainty =       0.006218736217

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502864010
  error estimate for blocks of size 2^( 2) =       0.000520643074
  error estimate for blocks of size 2^( 3) =       0.000536405743
  error estimate for blocks of size 2^( 4) =       0.000547425842
  error estimate for blocks of size 2^( 5) =       0.000554319495
  error estimate for blocks of size 2^( 6) =       0.000558399216
  error estimate for blocks of size 2^( 7) =       0.000557368464

      target function =                  N/A
              le_mean =     -22.825422606516
             les_mean =     521.505661338963
             stat err =       0.000554378254
             autocorr =       1.215377700775
              std dev =       0.711157103447
             le_variance =       0.505744425783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505831213829
                                         uncertainty =       0.006218736215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505831213829
                                         uncertainty =       0.006218736215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502864010
  error estimate for blocks of size 2^( 2) =       0.000520643074
  error estimate for blocks of size 2^( 3) =       0.000536405743
  error estimate for blocks of size 2^( 4) =       0.000547425841
  error estimate for blocks of size 2^( 5) =       0.000554319495
  error estimate for blocks of size 2^( 6) =       0.000558399216
  error estimate for blocks of size 2^( 7) =       0.000557368463

      target function =                  N/A
              le_mean =     -22.825422606515
             les_mean =     521.505661338336
             stat err =       0.000554378254
             autocorr =       1.215377701113
              std dev =       0.711157103040
             le_variance =       0.505744425204


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825422606515        initial
     9.5367e+04     9.5367e+05             2.5771e-09       -22.825422606517  <--
     3.8147e+05     3.8147e+06             6.4427e-10       -22.825422606516
     1.5259e+06     1.5259e+07             1.6107e-10       -22.825422606515

*****************************************************************************
Applying the update for shift_i =   9.5367e+04     and shift_s =   9.5367e+05
*****************************************************************************

  Execution time = 6.0743e+01
  </log>
  <optVariables href="FORM.s027.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965915e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214115e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735669e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332750e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747734e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1943e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2827e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.8665
    reference variance = 0.321572
====================================================
  Execution time = 4.5534e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0267e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5771e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502776984085
                                         uncertainty =       0.003752277974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502776984085
                                         uncertainty =       0.003752277974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501332555
  error estimate for blocks of size 2^( 2) =       0.000519212227
  error estimate for blocks of size 2^( 3) =       0.000535128874
  error estimate for blocks of size 2^( 4) =       0.000545798477
  error estimate for blocks of size 2^( 5) =       0.000552434211
  error estimate for blocks of size 2^( 6) =       0.000556470114
  error estimate for blocks of size 2^( 7) =       0.000560491515

      target function =                  N/A
              le_mean =     -22.824873802643
             les_mean =     521.477532517395
             stat err =       0.000553798579
             autocorr =       1.220258550078
              std dev =       0.708991299050
             le_variance =       0.502668662128


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282487380264e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824873802643       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824873802639       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824873802650       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824873802624       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824873802651       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824873802712       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824873802647       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824873802688       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824873802628       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824873802682       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+04 is 1.149996e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824873802643       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824873802642       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824873802645       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824873802639       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824873802638       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824873802633       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824873802528       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824873802735       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824873802605       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824873802824       residual = 7.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+04 is 2.875010e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824873802643       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824873802643       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824873802644       residual = 4.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824873802642       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824873802644       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824873802488       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824873802793       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824873802606       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824873802657       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824873802581       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.8147e+05 is 7.187537e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.367149 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1313e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965916e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214113e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735669e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124135e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332751e-02 1 1  ON 47
eH1_8                -5.715291e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747733e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -22.7532
    reference variance = 0.340509
====================================================
  Execution time = 4.3538e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 4.9920e-01
  Total weights = 2.0000e+06
  Execution time = 3.5266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499262172334
                                         uncertainty =       0.002900429337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499262172334
                                         uncertainty =       0.002900429337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499602306
  error estimate for blocks of size 2^( 2) =       0.000517706352
  error estimate for blocks of size 2^( 3) =       0.000533109485
  error estimate for blocks of size 2^( 4) =       0.000543540335
  error estimate for blocks of size 2^( 5) =       0.000551578159
  error estimate for blocks of size 2^( 6) =       0.000555085010
  error estimate for blocks of size 2^( 7) =       0.000559847673

      target function =                  N/A
              le_mean =     -22.826009147722
             les_mean =     521.525898290436
             stat err =       0.000552512794
             autocorr =       1.223026339301
              std dev =       0.706544356802
             le_variance =       0.499204928129

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499262184234
                                         uncertainty =       0.002900429315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499262184234
                                         uncertainty =       0.002900429315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499602312
  error estimate for blocks of size 2^( 2) =       0.000517706358
  error estimate for blocks of size 2^( 3) =       0.000533109490
  error estimate for blocks of size 2^( 4) =       0.000543540340
  error estimate for blocks of size 2^( 5) =       0.000551578164
  error estimate for blocks of size 2^( 6) =       0.000555085014
  error estimate for blocks of size 2^( 7) =       0.000559847678

      target function =                  N/A
              le_mean =     -22.826009147763
             les_mean =     521.525898304205
             stat err =       0.000552512799
             autocorr =       1.223026332028
              std dev =       0.706544365223
             le_variance =       0.499204940028

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499262178284
                                         uncertainty =       0.002900429326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499262178284
                                         uncertainty =       0.002900429326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499602309
  error estimate for blocks of size 2^( 2) =       0.000517706355
  error estimate for blocks of size 2^( 3) =       0.000533109487
  error estimate for blocks of size 2^( 4) =       0.000543540337
  error estimate for blocks of size 2^( 5) =       0.000551578162
  error estimate for blocks of size 2^( 6) =       0.000555085012
  error estimate for blocks of size 2^( 7) =       0.000559847676

      target function =                  N/A
              le_mean =     -22.826009147743
             les_mean =     521.525898297321
             stat err =       0.000552512797
             autocorr =       1.223026335661
              std dev =       0.706544361013
             le_variance =       0.499204934079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499262173078
                                         uncertainty =       0.002900429336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.499262173078
                                         uncertainty =       0.002900429336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000499602306
  error estimate for blocks of size 2^( 2) =       0.000517706352
  error estimate for blocks of size 2^( 3) =       0.000533109485
  error estimate for blocks of size 2^( 4) =       0.000543540335
  error estimate for blocks of size 2^( 5) =       0.000551578160
  error estimate for blocks of size 2^( 6) =       0.000555085010
  error estimate for blocks of size 2^( 7) =       0.000559847674

      target function =                  N/A
              le_mean =     -22.826009147725
             les_mean =     521.525898291297
             stat err =       0.000552512795
             autocorr =       1.223026338845
              std dev =       0.706544357329
             le_variance =       0.499204928873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.826009147722        initial
     2.3842e+04     2.3842e+05             1.1500e-08       -22.826009147763  <--
     9.5367e+04     9.5367e+05             2.8750e-09       -22.826009147743
     3.8147e+05     3.8147e+06             7.1875e-10       -22.826009147725

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 6.1212e+01
  </log>
  <optVariables href="FORM.s028.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965916e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541984e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214108e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429609e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120832e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735669e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877783e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409342e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303348e-02 1 1  ON 44
eH1_5                 6.124136e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332751e-02 1 1  ON 47
eH1_8                -5.715289e-03 1 1  ON 48
eH1_9                 4.539958e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160247e-02 1 1  ON 53
eH2_4                 1.338291e-02 1 1  ON 54
eH2_5                 6.135866e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747732e-03 1 1  ON 58
eH2_9                 4.702132e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2253e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2826e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.9392
    reference variance = 0.628084
====================================================
  Execution time = 4.3624e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0581e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4759e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505706338639
                                         uncertainty =       0.004837633580

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505706338639
                                         uncertainty =       0.004837633580

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502896473
  error estimate for blocks of size 2^( 2) =       0.000520599338
  error estimate for blocks of size 2^( 3) =       0.000536512057
  error estimate for blocks of size 2^( 4) =       0.000546962857
  error estimate for blocks of size 2^( 5) =       0.000553420086
  error estimate for blocks of size 2^( 6) =       0.000557057819
  error estimate for blocks of size 2^( 7) =       0.000558045704

      target function =                  N/A
              le_mean =     -22.825427105931
             les_mean =     521.505932041191
             stat err =       0.000553871617
             autocorr =       1.213000667694
              std dev =       0.711203013157
             le_variance =       0.505809725924


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282542710593e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825427105931       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825427106078       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825427106151       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825427106102       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825427106161       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825427106192       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825427106235       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825427106223       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825427106270       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825427106243       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+03 is 4.217249e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825427105931       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825427105968       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825427105986       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825427105974       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825427105993       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825427105998       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825427106015       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825427106002       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825427105978       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825427106073       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+04 is 1.054367e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825427105931       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825427105940       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825427105945       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825427105942       residual = 4.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825427105853       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825427105947       residual = 6.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825427105985       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825427105981       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825427106257       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825427105845       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.5367e+04 is 2.635952e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.370795 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8391e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965916e-02 1 1  ON 2
 uu_3                -8.457336e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523297e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541985e-02 1 1  ON 9
 ud_0                 4.267588e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214083e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089879e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429608e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601756e-01 1 1  ON 28
 eC_9                 3.120833e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735668e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877784e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409343e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303349e-02 1 1  ON 44
eH1_5                 6.124136e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332751e-02 1 1  ON 47
eH1_8                -5.715292e-03 1 1  ON 48
eH1_9                 4.539957e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319875e-02 1 1  ON 52
eH2_3                -4.160248e-02 1 1  ON 53
eH2_4                 1.338290e-02 1 1  ON 54
eH2_5                 6.135867e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387882e-02 1 1  ON 57
eH2_8                -4.747730e-03 1 1  ON 58
eH2_9                 4.702131e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -22.8238
    reference variance = 0.398549
====================================================
  Execution time = 4.3101e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0277e-01
  Total weights = 2.0000e+06
  Execution time = 3.5417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502777345863
                                         uncertainty =       0.003306013655

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502777345863
                                         uncertainty =       0.003306013655

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501382579
  error estimate for blocks of size 2^( 2) =       0.000519054271
  error estimate for blocks of size 2^( 3) =       0.000535383141
  error estimate for blocks of size 2^( 4) =       0.000547373171
  error estimate for blocks of size 2^( 5) =       0.000554187874
  error estimate for blocks of size 2^( 6) =       0.000557051929
  error estimate for blocks of size 2^( 7) =       0.000560770563

      target function =                  N/A
              le_mean =     -22.825304345860
             les_mean =     521.497287209944
             stat err =       0.000554845884
             autocorr =       1.224633847120
              std dev =       0.709062042542
             le_variance =       0.502768980174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502777377697
                                         uncertainty =       0.003306013859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502777377697
                                         uncertainty =       0.003306013859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501382594
  error estimate for blocks of size 2^( 2) =       0.000519054286
  error estimate for blocks of size 2^( 3) =       0.000535383155
  error estimate for blocks of size 2^( 4) =       0.000547373185
  error estimate for blocks of size 2^( 5) =       0.000554187887
  error estimate for blocks of size 2^( 6) =       0.000557051941
  error estimate for blocks of size 2^( 7) =       0.000560770576

      target function =                  N/A
              le_mean =     -22.825304345946
             les_mean =     521.497287245627
             stat err =       0.000554845897
             autocorr =       1.224633826620
              std dev =       0.709062064964
             le_variance =       0.502769011971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502777361781
                                         uncertainty =       0.003306013757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502777361781
                                         uncertainty =       0.003306013757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501382586
  error estimate for blocks of size 2^( 2) =       0.000519054279
  error estimate for blocks of size 2^( 3) =       0.000535383148
  error estimate for blocks of size 2^( 4) =       0.000547373178
  error estimate for blocks of size 2^( 5) =       0.000554187880
  error estimate for blocks of size 2^( 6) =       0.000557051935
  error estimate for blocks of size 2^( 7) =       0.000560770570

      target function =                  N/A
              le_mean =     -22.825304345903
             les_mean =     521.497287227787
             stat err =       0.000554845891
             autocorr =       1.224633836871
              std dev =       0.709062053754
             le_variance =       0.502768996074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502777347853
                                         uncertainty =       0.003306013668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502777347853
                                         uncertainty =       0.003306013668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501382580
  error estimate for blocks of size 2^( 2) =       0.000519054272
  error estimate for blocks of size 2^( 3) =       0.000535383142
  error estimate for blocks of size 2^( 4) =       0.000547373172
  error estimate for blocks of size 2^( 5) =       0.000554187875
  error estimate for blocks of size 2^( 6) =       0.000557051929
  error estimate for blocks of size 2^( 7) =       0.000560770564

      target function =                  N/A
              le_mean =     -22.825304345866
             les_mean =     521.497287212174
             stat err =       0.000554845885
             autocorr =       1.224633845835
              std dev =       0.709062043944
             le_variance =       0.502768982162


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825304345860        initial
     5.9605e+03     5.9605e+04             4.2172e-08       -22.825304345946  <--
     2.3842e+04     2.3842e+05             1.0544e-08       -22.825304345903
     9.5367e+04     9.5367e+05             2.6360e-09       -22.825304345866

*****************************************************************************
Applying the update for shift_i =   5.9605e+03     and shift_s =   5.9605e+04
*****************************************************************************

  Execution time = 6.0856e+01
  </log>
  <optVariables href="FORM.s029.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124437e-02 1 1  ON 1
 uu_2                -1.965916e-02 1 1  ON 2
 uu_3                -8.457337e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523296e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541985e-02 1 1  ON 9
 ud_0                 4.267589e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.214007e-04 1 1  ON 12
 ud_3                -8.008420e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089880e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948833e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429607e-02 1 1  ON 23
 eC_4                 7.409422e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601757e-01 1 1  ON 28
 eC_9                 3.120833e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953029e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735665e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027259e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877784e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409343e-02 1 1  ON 41
eH1_2                -5.348534e-02 1 1  ON 42
eH1_3                -4.183180e-02 1 1  ON 43
eH1_4                 1.303351e-02 1 1  ON 44
eH1_5                 6.124136e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332751e-02 1 1  ON 47
eH1_8                -5.715300e-03 1 1  ON 48
eH1_9                 4.539956e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408041e-02 1 1  ON 51
eH2_2                -5.319876e-02 1 1  ON 52
eH2_3                -4.160250e-02 1 1  ON 53
eH2_4                 1.338288e-02 1 1  ON 54
eH2_5                 6.135869e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387884e-02 1 1  ON 57
eH2_8                -4.747725e-03 1 1  ON 58
eH2_9                 4.702130e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1925e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8144
    reference variance = 0.396955
====================================================
  Execution time = 4.4031e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0538e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4958e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505396889696
                                         uncertainty =       0.007393659201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.505396889696
                                         uncertainty =       0.007393659201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000502683959
  error estimate for blocks of size 2^( 2) =       0.000520338566
  error estimate for blocks of size 2^( 3) =       0.000536124120
  error estimate for blocks of size 2^( 4) =       0.000547110499
  error estimate for blocks of size 2^( 5) =       0.000554955444
  error estimate for blocks of size 2^( 6) =       0.000559042340
  error estimate for blocks of size 2^( 7) =       0.000562223368

      target function =                  N/A
              le_mean =     -22.825318383255
             les_mean =     521.500541368757
             stat err =       0.000555832913
             autocorr =       1.222639621880
              std dev =       0.710902471844
             le_variance =       0.505382324474


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282531838326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825318383255       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825318383426       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825318383588       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825318383631       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825318383710       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825318383630       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825318383687       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825318383430       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825318383593       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825318383547       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+03 is 1.286601e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825318383255       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825318383298       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825318383338       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825318383349       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825318383371       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825318383341       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825318383364       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825318383316       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825318383325       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825318383331       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+03 is 3.216714e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825318383255       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825318383266       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825318383276       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825318383279       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825318383289       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825318383255       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825318383288       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825318383258       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825318383273       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825318383198       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3842e+04 is 8.041919e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.374404 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8997e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124437e-02 1 1  ON 1
 uu_2                -1.965917e-02 1 1  ON 2
 uu_3                -8.457338e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523296e-01 1 1  ON 7
 uu_8                -1.336235e-01 1 1  ON 8
 uu_9                -8.541988e-02 1 1  ON 9
 ud_0                 4.267589e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.213893e-04 1 1  ON 12
 ud_3                -8.008420e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089880e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948834e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429606e-02 1 1  ON 23
 eC_4                 7.409421e-02 1 1  ON 24
 eC_5                 1.705493e-01 1 1  ON 25
 eC_6                 2.798039e-01 1 1  ON 26
 eC_7                 3.527777e-01 1 1  ON 27
 eC_8                 1.601757e-01 1 1  ON 28
 eC_9                 3.120834e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953030e-01 1 1  ON 31
 eO_2                -3.204567e-01 1 1  ON 32
 eO_3                 1.735664e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027258e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877784e-01 1 1  ON 38
 eO_9                 1.980427e-01 1 1  ON 39
eH1_0                -1.705047e-01 1 1  ON 40
eH1_1                -8.409346e-02 1 1  ON 41
eH1_2                -5.348533e-02 1 1  ON 42
eH1_3                -4.183178e-02 1 1  ON 43
eH1_4                 1.303351e-02 1 1  ON 44
eH1_5                 6.124138e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332752e-02 1 1  ON 47
eH1_8                -5.715298e-03 1 1  ON 48
eH1_9                 4.539955e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319878e-02 1 1  ON 52
eH2_3                -4.160251e-02 1 1  ON 53
eH2_4                 1.338286e-02 1 1  ON 54
eH2_5                 6.135871e-02 1 1  ON 55
eH2_6                 1.077398e-01 1 1  ON 56
eH2_7                 7.387886e-02 1 1  ON 57
eH2_8                -4.747720e-03 1 1  ON 58
eH2_9                 4.702129e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -22.8246
    reference variance = 0.611725
====================================================
  Execution time = 4.4691e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9677e-01
  Total weights = 2.0000e+06
  Execution time = 3.5315e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701393273
                                         uncertainty =       0.003049697830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701393273
                                         uncertainty =       0.003049697830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498382429
  error estimate for blocks of size 2^( 2) =       0.000516241066
  error estimate for blocks of size 2^( 3) =       0.000532543236
  error estimate for blocks of size 2^( 4) =       0.000543722564
  error estimate for blocks of size 2^( 5) =       0.000549448161
  error estimate for blocks of size 2^( 6) =       0.000551808168
  error estimate for blocks of size 2^( 7) =       0.000552119991

      target function =                  N/A
              le_mean =     -22.825217627766
             les_mean =     521.487329597494
             stat err =       0.000549274721
             autocorr =       1.214657342734
              std dev =       0.704819190282
             le_variance =       0.496770090990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701509280
                                         uncertainty =       0.003049698614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701509280
                                         uncertainty =       0.003049698614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498382487
  error estimate for blocks of size 2^( 2) =       0.000516241121
  error estimate for blocks of size 2^( 3) =       0.000532543289
  error estimate for blocks of size 2^( 4) =       0.000543722613
  error estimate for blocks of size 2^( 5) =       0.000549448210
  error estimate for blocks of size 2^( 6) =       0.000551808213
  error estimate for blocks of size 2^( 7) =       0.000552120037

      target function =                  N/A
              le_mean =     -22.825217627828
             les_mean =     521.487329716430
             stat err =       0.000549274768
             autocorr =       1.214657267281
              std dev =       0.704819272640
             le_variance =       0.496770207085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701451288
                                         uncertainty =       0.003049698222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701451288
                                         uncertainty =       0.003049698222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498382458
  error estimate for blocks of size 2^( 2) =       0.000516241094
  error estimate for blocks of size 2^( 3) =       0.000532543262
  error estimate for blocks of size 2^( 4) =       0.000543722589
  error estimate for blocks of size 2^( 5) =       0.000549448185
  error estimate for blocks of size 2^( 6) =       0.000551808191
  error estimate for blocks of size 2^( 7) =       0.000552120014

      target function =                  N/A
              le_mean =     -22.825217627797
             les_mean =     521.487329656973
             stat err =       0.000549274745
             autocorr =       1.214657305002
              std dev =       0.704819231470
             le_variance =       0.496770149049

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701400525
                                         uncertainty =       0.003049697879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.496701400525
                                         uncertainty =       0.003049697879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000498382433
  error estimate for blocks of size 2^( 2) =       0.000516241069
  error estimate for blocks of size 2^( 3) =       0.000532543239
  error estimate for blocks of size 2^( 4) =       0.000543722568
  error estimate for blocks of size 2^( 5) =       0.000549448164
  error estimate for blocks of size 2^( 6) =       0.000551808171
  error estimate for blocks of size 2^( 7) =       0.000552119994

      target function =                  N/A
              le_mean =     -22.825217627770
             les_mean =     521.487329604929
             stat err =       0.000549274724
             autocorr =       1.214657338021
              std dev =       0.704819195431
             le_variance =       0.496770098248


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825217627766        initial
     1.4901e+03     1.4901e+04             1.2866e-07       -22.825217627828  <--
     5.9605e+03     5.9605e+04             3.2167e-08       -22.825217627797
     2.3842e+04     2.3842e+05             8.0419e-09       -22.825217627770

*****************************************************************************
Applying the update for shift_i =   1.4901e+03     and shift_s =   1.4901e+04
*****************************************************************************

  Execution time = 6.4876e+01
  </log>
  <optVariables href="FORM.s030.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124437e-02 1 1  ON 1
 uu_2                -1.965918e-02 1 1  ON 2
 uu_3                -8.457341e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533765e-01 1 1  ON 6
 uu_7                -1.523296e-01 1 1  ON 7
 uu_8                -1.336236e-01 1 1  ON 8
 uu_9                -8.541996e-02 1 1  ON 9
 ud_0                 4.267590e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.213552e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547523e-01 1 1  ON 18
 ud_9                -1.089880e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948834e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429605e-02 1 1  ON 23
 eC_4                 7.409420e-02 1 1  ON 24
 eC_5                 1.705492e-01 1 1  ON 25
 eC_6                 2.798038e-01 1 1  ON 26
 eC_7                 3.527778e-01 1 1  ON 27
 eC_8                 1.601758e-01 1 1  ON 28
 eC_9                 3.120837e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953030e-01 1 1  ON 31
 eO_2                -3.204568e-01 1 1  ON 32
 eO_3                 1.735662e-02 1 1  ON 33
 eO_4                 2.344859e-01 1 1  ON 34
 eO_5                 4.027258e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877785e-01 1 1  ON 38
 eO_9                 1.980428e-01 1 1  ON 39
eH1_0                -1.705048e-01 1 1  ON 40
eH1_1                -8.409352e-02 1 1  ON 41
eH1_2                -5.348532e-02 1 1  ON 42
eH1_3                -4.183174e-02 1 1  ON 43
eH1_4                 1.303354e-02 1 1  ON 44
eH1_5                 6.124142e-02 1 1  ON 45
eH1_6                 1.071725e-01 1 1  ON 46
eH1_7                 7.332756e-02 1 1  ON 47
eH1_8                -5.715293e-03 1 1  ON 48
eH1_9                 4.539952e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408039e-02 1 1  ON 51
eH2_2                -5.319883e-02 1 1  ON 52
eH2_3                -4.160253e-02 1 1  ON 53
eH2_4                 1.338282e-02 1 1  ON 54
eH2_5                 6.135876e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387891e-02 1 1  ON 57
eH2_8                -4.747706e-03 1 1  ON 58
eH2_9                 4.702126e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2389e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2828e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.8223
    reference variance = 0.383215
====================================================
  Execution time = 4.3358e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0049e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4921e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500550921838
                                         uncertainty =       0.004784471158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500550921838
                                         uncertainty =       0.004784471158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500244519
  error estimate for blocks of size 2^( 2) =       0.000517904147
  error estimate for blocks of size 2^( 3) =       0.000533464152
  error estimate for blocks of size 2^( 4) =       0.000544304715
  error estimate for blocks of size 2^( 5) =       0.000550746350
  error estimate for blocks of size 2^( 6) =       0.000553484099
  error estimate for blocks of size 2^( 7) =       0.000557255958

      target function =                  N/A
              le_mean =     -22.824663272012
             les_mean =     521.465742387253
             stat err =       0.000551447781
             autocorr =       1.215189782888
              std dev =       0.707452582694
             le_variance =       0.500489156760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282466327201e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824663272012       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824663271322       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824663266123       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824663260678       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824663259938       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824663260675       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824663260861       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824663260906       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824663261425       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824663261425       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+02 is 6.502602e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824663272012       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824663271839       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824663270539       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824663269176       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824663268989       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824663269175       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824663269219       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824663269225       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824663269365       residual = 4.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824663269370       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+03 is 1.625866e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824663272012       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824663271969       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824663271644       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824663271303       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824663271257       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824663271303       residual = 5.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824663271314       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824663271309       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824663271350       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824663271372       residual = 7.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+03 is 4.064799e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.378079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8287e+01
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.650048e-01 1 1  ON 0
 uu_1                 9.124438e-02 1 1  ON 1
 uu_2                -1.965924e-02 1 1  ON 2
 uu_3                -8.457342e-02 1 1  ON 3
 uu_4                -1.212330e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523295e-01 1 1  ON 7
 uu_8                -1.336237e-01 1 1  ON 8
 uu_9                -8.542005e-02 1 1  ON 9
 ud_0                 4.267592e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.213803e-04 1 1  ON 12
 ud_3                -8.008423e-02 1 1  ON 13
 ud_4                -1.260436e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695588e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547523e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948835e-01 1 1  ON 21
 eC_2                -1.407274e-01 1 1  ON 22
 eC_3                 1.429602e-02 1 1  ON 23
 eC_4                 7.409419e-02 1 1  ON 24
 eC_5                 1.705492e-01 1 1  ON 25
 eC_6                 2.798038e-01 1 1  ON 26
 eC_7                 3.527779e-01 1 1  ON 27
 eC_8                 1.601759e-01 1 1  ON 28
 eC_9                 3.120839e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953032e-01 1 1  ON 31
 eO_2                -3.204568e-01 1 1  ON 32
 eO_3                 1.735664e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027257e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940477e-01 1 1  ON 37
 eO_8                 3.877786e-01 1 1  ON 38
 eO_9                 1.980429e-01 1 1  ON 39
eH1_0                -1.705050e-01 1 1  ON 40
eH1_1                -8.409357e-02 1 1  ON 41
eH1_2                -5.348526e-02 1 1  ON 42
eH1_3                -4.183172e-02 1 1  ON 43
eH1_4                 1.303357e-02 1 1  ON 44
eH1_5                 6.124145e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332757e-02 1 1  ON 47
eH1_8                -5.715288e-03 1 1  ON 48
eH1_9                 4.539948e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408033e-02 1 1  ON 51
eH2_2                -5.319885e-02 1 1  ON 52
eH2_3                -4.160249e-02 1 1  ON 53
eH2_4                 1.338282e-02 1 1  ON 54
eH2_5                 6.135868e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387892e-02 1 1  ON 57
eH2_8                -4.747722e-03 1 1  ON 58
eH2_9                 4.702123e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -22.4365
    reference variance = 7.74576
====================================================
  Execution time = 4.2791e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2824e+01
  VMC Evar = 5.0829e-01
  Total weights = 2.0000e+06
  Execution time = 3.5413e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507608141129
                                         uncertainty =       0.005721878030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507608141129
                                         uncertainty =       0.005721878030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504126854
  error estimate for blocks of size 2^( 2) =       0.000522190540
  error estimate for blocks of size 2^( 3) =       0.000538384487
  error estimate for blocks of size 2^( 4) =       0.000550511895
  error estimate for blocks of size 2^( 5) =       0.000556533027
  error estimate for blocks of size 2^( 6) =       0.000558293792
  error estimate for blocks of size 2^( 7) =       0.000560055368

      target function =                  N/A
              le_mean =     -22.824401804354
             les_mean =     521.461605242290
             stat err =       0.000556348520
             autocorr =       1.217907234445
              std dev =       0.712943034084
             le_variance =       0.508287769849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507609237837
                                         uncertainty =       0.005721871695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507609237837
                                         uncertainty =       0.005721871695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504127399
  error estimate for blocks of size 2^( 2) =       0.000522191059
  error estimate for blocks of size 2^( 3) =       0.000538384980
  error estimate for blocks of size 2^( 4) =       0.000550512376
  error estimate for blocks of size 2^( 5) =       0.000556533496
  error estimate for blocks of size 2^( 6) =       0.000558294235
  error estimate for blocks of size 2^( 7) =       0.000560055831

      target function =                  N/A
              le_mean =     -22.824401799595
             les_mean =     521.461606123195
             stat err =       0.000556348984
             autocorr =       1.217906634771
              std dev =       0.712943804235
             le_variance =       0.508288867997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507608689935
                                         uncertainty =       0.005721874855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507608689935
                                         uncertainty =       0.005721874855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504127127
  error estimate for blocks of size 2^( 2) =       0.000522190800
  error estimate for blocks of size 2^( 3) =       0.000538384734
  error estimate for blocks of size 2^( 4) =       0.000550512135
  error estimate for blocks of size 2^( 5) =       0.000556533261
  error estimate for blocks of size 2^( 6) =       0.000558294014
  error estimate for blocks of size 2^( 7) =       0.000560055600

      target function =                  N/A
              le_mean =     -22.824401801971
             les_mean =     521.461605683054
             stat err =       0.000556348753
             autocorr =       1.217906934385
              std dev =       0.712943419477
             le_variance =       0.508288319376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507608209743
                                         uncertainty =       0.005721877633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.507608209743
                                         uncertainty =       0.005721877633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504126888
  error estimate for blocks of size 2^( 2) =       0.000522190573
  error estimate for blocks of size 2^( 3) =       0.000538384518
  error estimate for blocks of size 2^( 4) =       0.000550511925
  error estimate for blocks of size 2^( 5) =       0.000556533056
  error estimate for blocks of size 2^( 6) =       0.000558293820
  error estimate for blocks of size 2^( 7) =       0.000560055397

      target function =                  N/A
              le_mean =     -22.824401804056
             les_mean =     521.461605297392
             stat err =       0.000556348549
             autocorr =       1.217907196935
              std dev =       0.712943082267
             le_variance =       0.508287838553


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824401804354        initial  <--
     3.7253e+02     3.7253e+03             6.5026e-07       -22.824401799595
     1.4901e+03     1.4901e+04             1.6259e-07       -22.824401801971
     5.9605e+03     5.9605e+04             4.0648e-08       -22.824401804056

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.4713
  </log>
  <optVariables href="FORM.s031.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124437e-02 1 1  ON 1
 uu_2                -1.965918e-02 1 1  ON 2
 uu_3                -8.457341e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533765e-01 1 1  ON 6
 uu_7                -1.523296e-01 1 1  ON 7
 uu_8                -1.336236e-01 1 1  ON 8
 uu_9                -8.541996e-02 1 1  ON 9
 ud_0                 4.267590e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.213552e-04 1 1  ON 12
 ud_3                -8.008421e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547523e-01 1 1  ON 18
 ud_9                -1.089880e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948834e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429605e-02 1 1  ON 23
 eC_4                 7.409420e-02 1 1  ON 24
 eC_5                 1.705492e-01 1 1  ON 25
 eC_6                 2.798038e-01 1 1  ON 26
 eC_7                 3.527778e-01 1 1  ON 27
 eC_8                 1.601758e-01 1 1  ON 28
 eC_9                 3.120837e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953030e-01 1 1  ON 31
 eO_2                -3.204568e-01 1 1  ON 32
 eO_3                 1.735662e-02 1 1  ON 33
 eO_4                 2.344859e-01 1 1  ON 34
 eO_5                 4.027258e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877785e-01 1 1  ON 38
 eO_9                 1.980428e-01 1 1  ON 39
eH1_0                -1.705048e-01 1 1  ON 40
eH1_1                -8.409352e-02 1 1  ON 41
eH1_2                -5.348532e-02 1 1  ON 42
eH1_3                -4.183174e-02 1 1  ON 43
eH1_4                 1.303354e-02 1 1  ON 44
eH1_5                 6.124142e-02 1 1  ON 45
eH1_6                 1.071725e-01 1 1  ON 46
eH1_7                 7.332756e-02 1 1  ON 47
eH1_8                -5.715293e-03 1 1  ON 48
eH1_9                 4.539952e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408039e-02 1 1  ON 51
eH2_2                -5.319883e-02 1 1  ON 52
eH2_3                -4.160253e-02 1 1  ON 53
eH2_4                 1.338282e-02 1 1  ON 54
eH2_5                 6.135876e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387891e-02 1 1  ON 57
eH2_8                -4.747706e-03 1 1  ON 58
eH2_9                 4.702126e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1876e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8572
    reference variance = 0.414911
====================================================
  Execution time = 4.3373e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.2041e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5205e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520544069259
                                         uncertainty =       0.012917130757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.520544069259
                                         uncertainty =       0.012917130757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000510103193
  error estimate for blocks of size 2^( 2) =       0.000528070619
  error estimate for blocks of size 2^( 3) =       0.000543644245
  error estimate for blocks of size 2^( 4) =       0.000555253146
  error estimate for blocks of size 2^( 5) =       0.000561102028
  error estimate for blocks of size 2^( 6) =       0.000562531498
  error estimate for blocks of size 2^( 7) =       0.000562577737

      target function =                  N/A
              le_mean =     -22.825275032473
             les_mean =     521.513590583830
             stat err =       0.000560366102
             autocorr =       1.206778675348
              std dev =       0.721394854442
             le_variance =       0.520410536015


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282527503247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825275032473       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825275032572       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825275032623       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825275032697       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825275032703       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825275032673       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825275032696       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825275032675       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825275032706       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825275032706       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825275032708       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+03 is 8.865842e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825275032473       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825275032497       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825275032510       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825275032527       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825275032531       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825275032523       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825275032512       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825275032533       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825275032607       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825275032540       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825275032553       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+04 is 2.216569e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825275032473       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825275032479       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825275032482       residual = 6.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825275032485       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825275032452       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825275032474       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825275032506       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825275032406       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825275032370       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825275032204       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825275031988       residual = 2.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.9605e+04 is 5.541494e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.382452 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8588e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124437e-02 1 1  ON 1
 uu_2                -1.965918e-02 1 1  ON 2
 uu_3                -8.457341e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533765e-01 1 1  ON 6
 uu_7                -1.523296e-01 1 1  ON 7
 uu_8                -1.336236e-01 1 1  ON 8
 uu_9                -8.541997e-02 1 1  ON 9
 ud_0                 4.267590e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.213524e-04 1 1  ON 12
 ud_3                -8.008420e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711978e-01 1 1  ON 17
 ud_8                -1.547523e-01 1 1  ON 18
 ud_9                -1.089880e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948834e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429604e-02 1 1  ON 23
 eC_4                 7.409420e-02 1 1  ON 24
 eC_5                 1.705492e-01 1 1  ON 25
 eC_6                 2.798038e-01 1 1  ON 26
 eC_7                 3.527778e-01 1 1  ON 27
 eC_8                 1.601758e-01 1 1  ON 28
 eC_9                 3.120837e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953031e-01 1 1  ON 31
 eO_2                -3.204568e-01 1 1  ON 32
 eO_3                 1.735660e-02 1 1  ON 33
 eO_4                 2.344859e-01 1 1  ON 34
 eO_5                 4.027257e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877785e-01 1 1  ON 38
 eO_9                 1.980428e-01 1 1  ON 39
eH1_0                -1.705048e-01 1 1  ON 40
eH1_1                -8.409353e-02 1 1  ON 41
eH1_2                -5.348531e-02 1 1  ON 42
eH1_3                -4.183173e-02 1 1  ON 43
eH1_4                 1.303354e-02 1 1  ON 44
eH1_5                 6.124142e-02 1 1  ON 45
eH1_6                 1.071725e-01 1 1  ON 46
eH1_7                 7.332757e-02 1 1  ON 47
eH1_8                -5.715293e-03 1 1  ON 48
eH1_9                 4.539951e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408039e-02 1 1  ON 51
eH2_2                -5.319883e-02 1 1  ON 52
eH2_3                -4.160254e-02 1 1  ON 53
eH2_4                 1.338282e-02 1 1  ON 54
eH2_5                 6.135877e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387891e-02 1 1  ON 57
eH2_8                -4.747707e-03 1 1  ON 58
eH2_9                 4.702126e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -22.8227
    reference variance = 0.587655
====================================================
  Execution time = 4.3211e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0079e-01
  Total weights = 2.0000e+06
  Execution time = 3.5307e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500788199356
                                         uncertainty =       0.003280935886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500788199356
                                         uncertainty =       0.003280935886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500396803
  error estimate for blocks of size 2^( 2) =       0.000518361645
  error estimate for blocks of size 2^( 3) =       0.000534016106
  error estimate for blocks of size 2^( 4) =       0.000545021361
  error estimate for blocks of size 2^( 5) =       0.000550670466
  error estimate for blocks of size 2^( 6) =       0.000552384855
  error estimate for blocks of size 2^( 7) =       0.000555910966

      target function =                  N/A
              le_mean =     -22.824581557037
             les_mean =     521.462316924563
             stat err =       0.000550996912
             autocorr =       1.212465184623
              std dev =       0.707667945515
             le_variance =       0.500793921109

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500788213323
                                         uncertainty =       0.003280936146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500788213323
                                         uncertainty =       0.003280936146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500396810
  error estimate for blocks of size 2^( 2) =       0.000518361651
  error estimate for blocks of size 2^( 3) =       0.000534016112
  error estimate for blocks of size 2^( 4) =       0.000545021366
  error estimate for blocks of size 2^( 5) =       0.000550670471
  error estimate for blocks of size 2^( 6) =       0.000552384859
  error estimate for blocks of size 2^( 7) =       0.000555910970

      target function =                  N/A
              le_mean =     -22.824581557379
             les_mean =     521.462316954164
             stat err =       0.000550996916
             autocorr =       1.212465170210
              std dev =       0.707667955405
             le_variance =       0.500793935107

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500788206341
                                         uncertainty =       0.003280936016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500788206341
                                         uncertainty =       0.003280936016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500396807
  error estimate for blocks of size 2^( 2) =       0.000518361648
  error estimate for blocks of size 2^( 3) =       0.000534016109
  error estimate for blocks of size 2^( 4) =       0.000545021363
  error estimate for blocks of size 2^( 5) =       0.000550670469
  error estimate for blocks of size 2^( 6) =       0.000552384857
  error estimate for blocks of size 2^( 7) =       0.000555910968

      target function =                  N/A
              le_mean =     -22.824581557208
             les_mean =     521.462316939365
             stat err =       0.000550996914
             autocorr =       1.212465177417
              std dev =       0.707667950461
             le_variance =       0.500793928110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500788200229
                                         uncertainty =       0.003280935902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.500788200229
                                         uncertainty =       0.003280935902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000500396804
  error estimate for blocks of size 2^( 2) =       0.000518361645
  error estimate for blocks of size 2^( 3) =       0.000534016106
  error estimate for blocks of size 2^( 4) =       0.000545021361
  error estimate for blocks of size 2^( 5) =       0.000550670467
  error estimate for blocks of size 2^( 6) =       0.000552384855
  error estimate for blocks of size 2^( 7) =       0.000555910966

      target function =                  N/A
              le_mean =     -22.824581557059
             les_mean =     521.462316926414
             stat err =       0.000550996912
             autocorr =       1.212465183723
              std dev =       0.707667946133
             le_variance =       0.500793921985


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824581557037        initial
     3.7253e+03     3.7253e+04             8.8658e-08       -22.824581557379  <--
     1.4901e+04     1.4901e+05             2.2166e-08       -22.824581557208
     5.9605e+04     5.9605e+05             5.5415e-09       -22.824581557059

*****************************************************************************
Applying the update for shift_i =   3.7253e+03     and shift_s =   3.7253e+04
*****************************************************************************

  Execution time = 6.0885e+01
  </log>
  <optVariables href="FORM.s032.opt.xml">
 uu_0                 2.650047e-01 1 1  ON 0
 uu_1                 9.124438e-02 1 1  ON 1
 uu_2                -1.965920e-02 1 1  ON 2
 uu_3                -8.457340e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533765e-01 1 1  ON 6
 uu_7                -1.523296e-01 1 1  ON 7
 uu_8                -1.336236e-01 1 1  ON 8
 uu_9                -8.541999e-02 1 1  ON 9
 ud_0                 4.267590e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.213441e-04 1 1  ON 12
 ud_3                -8.008418e-02 1 1  ON 13
 ud_4                -1.260435e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711979e-01 1 1  ON 17
 ud_8                -1.547523e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948834e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429602e-02 1 1  ON 23
 eC_4                 7.409421e-02 1 1  ON 24
 eC_5                 1.705492e-01 1 1  ON 25
 eC_6                 2.798038e-01 1 1  ON 26
 eC_7                 3.527778e-01 1 1  ON 27
 eC_8                 1.601758e-01 1 1  ON 28
 eC_9                 3.120838e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953031e-01 1 1  ON 31
 eO_2                -3.204568e-01 1 1  ON 32
 eO_3                 1.735653e-02 1 1  ON 33
 eO_4                 2.344859e-01 1 1  ON 34
 eO_5                 4.027257e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940476e-01 1 1  ON 37
 eO_8                 3.877785e-01 1 1  ON 38
 eO_9                 1.980429e-01 1 1  ON 39
eH1_0                -1.705049e-01 1 1  ON 40
eH1_1                -8.409355e-02 1 1  ON 41
eH1_2                -5.348530e-02 1 1  ON 42
eH1_3                -4.183173e-02 1 1  ON 43
eH1_4                 1.303353e-02 1 1  ON 44
eH1_5                 6.124142e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332760e-02 1 1  ON 47
eH1_8                -5.715293e-03 1 1  ON 48
eH1_9                 4.539950e-02 1 1  ON 49
eH2_0                -1.714191e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319883e-02 1 1  ON 52
eH2_3                -4.160256e-02 1 1  ON 53
eH2_4                 1.338281e-02 1 1  ON 54
eH2_5                 6.135879e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387891e-02 1 1  ON 57
eH2_8                -4.747712e-03 1 1  ON 58
eH2_9                 4.702125e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1948e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.7177
    reference variance = 0.946788
====================================================
  Execution time = 4.4929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 4.9533e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5398e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495170125084
                                         uncertainty =       0.003009929762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.495170125084
                                         uncertainty =       0.003009929762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000497657880
  error estimate for blocks of size 2^( 2) =       0.000515413952
  error estimate for blocks of size 2^( 3) =       0.000531661330
  error estimate for blocks of size 2^( 4) =       0.000541859469
  error estimate for blocks of size 2^( 5) =       0.000547696696
  error estimate for blocks of size 2^( 6) =       0.000550926136
  error estimate for blocks of size 2^( 7) =       0.000554976271

      target function =                  N/A
              le_mean =     -22.825007267538
             les_mean =     521.476283246459
             stat err =       0.000548864643
             autocorr =       1.216378513719
              std dev =       0.703794523263
             le_variance =       0.495326730975


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282500726754e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825007267538       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825007267575       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825007267064       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825007267433       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825007267914       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825007268289       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825007267903       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825007268135       residual = 6.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825007268225       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825007268182       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+02 is 2.718526e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825007267538       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825007267547       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825007267419       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825007267512       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825007267632       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825007267725       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825007267628       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825007267688       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825007267706       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825007267704       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+03 is 6.796905e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825007267538       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825007267540       residual = 3.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825007267508       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825007267531       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825007267571       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825007267584       residual = 3.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825007267562       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825007267585       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825007267614       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825007267642       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4901e+04 is 1.699263e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.386114 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.0334e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.650048e-01 1 1  ON 0
 uu_1                 9.124438e-02 1 1  ON 1
 uu_2                -1.965920e-02 1 1  ON 2
 uu_3                -8.457341e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533765e-01 1 1  ON 6
 uu_7                -1.523296e-01 1 1  ON 7
 uu_8                -1.336237e-01 1 1  ON 8
 uu_9                -8.542004e-02 1 1  ON 9
 ud_0                 4.267591e-01 1 1  ON 10
 ud_1                 1.447306e-01 1 1  ON 11
 ud_2                -7.213434e-04 1 1  ON 12
 ud_3                -8.008416e-02 1 1  ON 13
 ud_4                -1.260436e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711979e-01 1 1  ON 17
 ud_8                -1.547523e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948835e-01 1 1  ON 21
 eC_2                -1.407274e-01 1 1  ON 22
 eC_3                 1.429599e-02 1 1  ON 23
 eC_4                 7.409417e-02 1 1  ON 24
 eC_5                 1.705492e-01 1 1  ON 25
 eC_6                 2.798038e-01 1 1  ON 26
 eC_7                 3.527778e-01 1 1  ON 27
 eC_8                 1.601759e-01 1 1  ON 28
 eC_9                 3.120839e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953032e-01 1 1  ON 31
 eO_2                -3.204568e-01 1 1  ON 32
 eO_3                 1.735651e-02 1 1  ON 33
 eO_4                 2.344859e-01 1 1  ON 34
 eO_5                 4.027257e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940477e-01 1 1  ON 37
 eO_8                 3.877786e-01 1 1  ON 38
 eO_9                 1.980429e-01 1 1  ON 39
eH1_0                -1.705049e-01 1 1  ON 40
eH1_1                -8.409358e-02 1 1  ON 41
eH1_2                -5.348531e-02 1 1  ON 42
eH1_3                -4.183175e-02 1 1  ON 43
eH1_4                 1.303353e-02 1 1  ON 44
eH1_5                 6.124142e-02 1 1  ON 45
eH1_6                 1.071726e-01 1 1  ON 46
eH1_7                 7.332764e-02 1 1  ON 47
eH1_8                -5.715298e-03 1 1  ON 48
eH1_9                 4.539948e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408040e-02 1 1  ON 51
eH2_2                -5.319883e-02 1 1  ON 52
eH2_3                -4.160257e-02 1 1  ON 53
eH2_4                 1.338281e-02 1 1  ON 54
eH2_5                 6.135879e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387894e-02 1 1  ON 57
eH2_8                -4.747702e-03 1 1  ON 58
eH2_9                 4.702123e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -22.8419
    reference variance = 0.456978
====================================================
  Execution time = 4.3103e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.1468e-01
  Total weights = 2.0000e+06
  Execution time = 3.5285e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514715916119
                                         uncertainty =       0.006516817383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514715916119
                                         uncertainty =       0.006516817383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507289451
  error estimate for blocks of size 2^( 2) =       0.000525440314
  error estimate for blocks of size 2^( 3) =       0.000540907435
  error estimate for blocks of size 2^( 4) =       0.000551630859
  error estimate for blocks of size 2^( 5) =       0.000558088260
  error estimate for blocks of size 2^( 6) =       0.000562232114
  error estimate for blocks of size 2^( 7) =       0.000567804768

      target function =                  N/A
              le_mean =     -22.825699560021
             les_mean =     521.527245320871
             stat err =       0.000559939000
             autocorr =       1.218343561988
              std dev =       0.717415621423
             le_variance =       0.514685173862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514716177051
                                         uncertainty =       0.006516823008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514716177051
                                         uncertainty =       0.006516823008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507289579
  error estimate for blocks of size 2^( 2) =       0.000525440437
  error estimate for blocks of size 2^( 3) =       0.000540907552
  error estimate for blocks of size 2^( 4) =       0.000551630970
  error estimate for blocks of size 2^( 5) =       0.000558088372
  error estimate for blocks of size 2^( 6) =       0.000562232230
  error estimate for blocks of size 2^( 7) =       0.000567804887

      target function =                  N/A
              le_mean =     -22.825699561298
             les_mean =     521.527245640219
             stat err =       0.000559939115
             autocorr =       1.218343441611
              std dev =       0.717415803353
             le_variance =       0.514685434901

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514716046622
                                         uncertainty =       0.006516820197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514716046622
                                         uncertainty =       0.006516820197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507289515
  error estimate for blocks of size 2^( 2) =       0.000525440376
  error estimate for blocks of size 2^( 3) =       0.000540907494
  error estimate for blocks of size 2^( 4) =       0.000551630914
  error estimate for blocks of size 2^( 5) =       0.000558088316
  error estimate for blocks of size 2^( 6) =       0.000562232172
  error estimate for blocks of size 2^( 7) =       0.000567804828

      target function =                  N/A
              le_mean =     -22.825699560660
             les_mean =     521.527245480588
             stat err =       0.000559939057
             autocorr =       1.218343501783
              std dev =       0.717415712414
             le_variance =       0.514685304418

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514715932433
                                         uncertainty =       0.006516817735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.514715932433
                                         uncertainty =       0.006516817735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000507289459
  error estimate for blocks of size 2^( 2) =       0.000525440322
  error estimate for blocks of size 2^( 3) =       0.000540907442
  error estimate for blocks of size 2^( 4) =       0.000551630866
  error estimate for blocks of size 2^( 5) =       0.000558088267
  error estimate for blocks of size 2^( 6) =       0.000562232121
  error estimate for blocks of size 2^( 7) =       0.000567804776

      target function =                  N/A
              le_mean =     -22.825699560101
             les_mean =     521.527245340837
             stat err =       0.000559939007
             autocorr =       1.218343554456
              std dev =       0.717415632798
             le_variance =       0.514685190183


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825699560021        initial
     9.3132e+02     9.3132e+03             2.7185e-07       -22.825699561298  <--
     3.7253e+03     3.7253e+04             6.7969e-08       -22.825699560660
     1.4901e+04     1.4901e+05             1.6993e-08       -22.825699560101

*****************************************************************************
Applying the update for shift_i =   9.3132e+02     and shift_s =   9.3132e+03
*****************************************************************************

  Execution time = 6.0787e+01
  </log>
  <optVariables href="FORM.s033.opt.xml">
 uu_0                 2.650050e-01 1 1  ON 0
 uu_1                 9.124436e-02 1 1  ON 1
 uu_2                -1.965920e-02 1 1  ON 2
 uu_3                -8.457344e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425302e-01 1 1  ON 5
 uu_6                -1.533765e-01 1 1  ON 6
 uu_7                -1.523295e-01 1 1  ON 7
 uu_8                -1.336239e-01 1 1  ON 8
 uu_9                -8.542016e-02 1 1  ON 9
 ud_0                 4.267592e-01 1 1  ON 10
 ud_1                 1.447307e-01 1 1  ON 11
 ud_2                -7.213412e-04 1 1  ON 12
 ud_3                -8.008411e-02 1 1  ON 13
 ud_4                -1.260436e-01 1 1  ON 14
 ud_5                -1.542575e-01 1 1  ON 15
 ud_6                -1.695587e-01 1 1  ON 16
 ud_7                -1.711980e-01 1 1  ON 17
 ud_8                -1.547525e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948835e-01 1 1  ON 21
 eC_2                -1.407274e-01 1 1  ON 22
 eC_3                 1.429591e-02 1 1  ON 23
 eC_4                 7.409404e-02 1 1  ON 24
 eC_5                 1.705492e-01 1 1  ON 25
 eC_6                 2.798038e-01 1 1  ON 26
 eC_7                 3.527779e-01 1 1  ON 27
 eC_8                 1.601760e-01 1 1  ON 28
 eC_9                 3.120842e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953034e-01 1 1  ON 31
 eO_2                -3.204568e-01 1 1  ON 32
 eO_3                 1.735645e-02 1 1  ON 33
 eO_4                 2.344859e-01 1 1  ON 34
 eO_5                 4.027257e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940477e-01 1 1  ON 37
 eO_8                 3.877787e-01 1 1  ON 38
 eO_9                 1.980431e-01 1 1  ON 39
eH1_0                -1.705049e-01 1 1  ON 40
eH1_1                -8.409365e-02 1 1  ON 41
eH1_2                -5.348535e-02 1 1  ON 42
eH1_3                -4.183179e-02 1 1  ON 43
eH1_4                 1.303350e-02 1 1  ON 44
eH1_5                 6.124144e-02 1 1  ON 45
eH1_6                 1.071727e-01 1 1  ON 46
eH1_7                 7.332773e-02 1 1  ON 47
eH1_8                -5.715314e-03 1 1  ON 48
eH1_9                 4.539942e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408039e-02 1 1  ON 51
eH2_2                -5.319883e-02 1 1  ON 52
eH2_3                -4.160260e-02 1 1  ON 53
eH2_4                 1.338281e-02 1 1  ON 54
eH2_5                 6.135880e-02 1 1  ON 55
eH2_6                 1.077397e-01 1 1  ON 56
eH2_7                 7.387902e-02 1 1  ON 57
eH2_8                -4.747670e-03 1 1  ON 58
eH2_9                 4.702117e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2113e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.8096
    reference variance = 0.405127
====================================================
  Execution time = 4.3843e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0970e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4923e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509884919559
                                         uncertainty =       0.005770316174

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509884919559
                                         uncertainty =       0.005770316174

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504826337
  error estimate for blocks of size 2^( 2) =       0.000522891784
  error estimate for blocks of size 2^( 3) =       0.000538476808
  error estimate for blocks of size 2^( 4) =       0.000549174201
  error estimate for blocks of size 2^( 5) =       0.000556738084
  error estimate for blocks of size 2^( 6) =       0.000558447970
  error estimate for blocks of size 2^( 7) =       0.000562541907

      target function =                  N/A
              le_mean =     -22.825687518795
             les_mean =     521.521709711150
             stat err =       0.000556725540
             autocorr =       1.216181193586
              std dev =       0.713932251928
             le_variance =       0.509699260343


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282568751879e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825687518795       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825687519592       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825687519323       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825687522227       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825687523868       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825687524125       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825687522838       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825687523080       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825687523130       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825687523719       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+02 is 9.651224e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825687518795       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825687518994       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825687518927       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825687519653       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825687520064       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825687520130       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825687519805       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825687519868       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825687519881       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825687520025       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+02 is 2.412998e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825687518795       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825687518845       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825687518828       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825687519009       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825687519112       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825687519128       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825687519047       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825687519058       residual = 7.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825687519067       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825687519105       residual = 4.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.7253e+03 is 6.032614e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.389742 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8774e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.650048e-01 1 1  ON 0
 uu_1                 9.124432e-02 1 1  ON 1
 uu_2                -1.965920e-02 1 1  ON 2
 uu_3                -8.457344e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425302e-01 1 1  ON 5
 uu_6                -1.533765e-01 1 1  ON 6
 uu_7                -1.523294e-01 1 1  ON 7
 uu_8                -1.336239e-01 1 1  ON 8
 uu_9                -8.542021e-02 1 1  ON 9
 ud_0                 4.267593e-01 1 1  ON 10
 ud_1                 1.447307e-01 1 1  ON 11
 ud_2                -7.212893e-04 1 1  ON 12
 ud_3                -8.008405e-02 1 1  ON 13
 ud_4                -1.260437e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695588e-01 1 1  ON 16
 ud_7                -1.711981e-01 1 1  ON 17
 ud_8                -1.547523e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513136e-01 1 1  ON 20
 eC_1                -3.948837e-01 1 1  ON 21
 eC_2                -1.407273e-01 1 1  ON 22
 eC_3                 1.429581e-02 1 1  ON 23
 eC_4                 7.409401e-02 1 1  ON 24
 eC_5                 1.705492e-01 1 1  ON 25
 eC_6                 2.798038e-01 1 1  ON 26
 eC_7                 3.527780e-01 1 1  ON 27
 eC_8                 1.601762e-01 1 1  ON 28
 eC_9                 3.120847e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953036e-01 1 1  ON 31
 eO_2                -3.204570e-01 1 1  ON 32
 eO_3                 1.735625e-02 1 1  ON 33
 eO_4                 2.344859e-01 1 1  ON 34
 eO_5                 4.027257e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940477e-01 1 1  ON 37
 eO_8                 3.877789e-01 1 1  ON 38
 eO_9                 1.980433e-01 1 1  ON 39
eH1_0                -1.705049e-01 1 1  ON 40
eH1_1                -8.409362e-02 1 1  ON 41
eH1_2                -5.348526e-02 1 1  ON 42
eH1_3                -4.183183e-02 1 1  ON 43
eH1_4                 1.303351e-02 1 1  ON 44
eH1_5                 6.124139e-02 1 1  ON 45
eH1_6                 1.071727e-01 1 1  ON 46
eH1_7                 7.332779e-02 1 1  ON 47
eH1_8                -5.715357e-03 1 1  ON 48
eH1_9                 4.539934e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408061e-02 1 1  ON 51
eH2_2                -5.319882e-02 1 1  ON 52
eH2_3                -4.160245e-02 1 1  ON 53
eH2_4                 1.338268e-02 1 1  ON 54
eH2_5                 6.135897e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387909e-02 1 1  ON 57
eH2_8                -4.747648e-03 1 1  ON 58
eH2_9                 4.702111e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -22.9399
    reference variance = 0.32497
====================================================
  Execution time = 4.2967e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.5293e-01
  Total weights = 2.0000e+06
  Execution time = 3.5491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553079228761
                                         uncertainty =       0.048859447502

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553079228761
                                         uncertainty =       0.048859447502

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525800310
  error estimate for blocks of size 2^( 2) =       0.000542377374
  error estimate for blocks of size 2^( 3) =       0.000557424376
  error estimate for blocks of size 2^( 4) =       0.000568446283
  error estimate for blocks of size 2^( 5) =       0.000574247867
  error estimate for blocks of size 2^( 6) =       0.000578258278
  error estimate for blocks of size 2^( 7) =       0.000583066860

      target function =                  N/A
              le_mean =     -22.824861777514
             les_mean =     521.527246818592
             stat err =       0.000576004822
             autocorr =       1.200081006098
              std dev =       0.743593929816
             le_variance =       0.552931932460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553079073011
                                         uncertainty =       0.048859367598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553079073011
                                         uncertainty =       0.048859367598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525800236
  error estimate for blocks of size 2^( 2) =       0.000542377305
  error estimate for blocks of size 2^( 3) =       0.000557424309
  error estimate for blocks of size 2^( 4) =       0.000568446223
  error estimate for blocks of size 2^( 5) =       0.000574247804
  error estimate for blocks of size 2^( 6) =       0.000578258232
  error estimate for blocks of size 2^( 7) =       0.000583066822

      target function =                  N/A
              le_mean =     -22.824861781629
             les_mean =     521.527246850914
             stat err =       0.000576004770
             autocorr =       1.200081129292
              std dev =       0.743593825219
             le_variance =       0.552931776904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553079151126
                                         uncertainty =       0.048859407603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553079151126
                                         uncertainty =       0.048859407603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525800273
  error estimate for blocks of size 2^( 2) =       0.000542377339
  error estimate for blocks of size 2^( 3) =       0.000557424343
  error estimate for blocks of size 2^( 4) =       0.000568446253
  error estimate for blocks of size 2^( 5) =       0.000574247836
  error estimate for blocks of size 2^( 6) =       0.000578258256
  error estimate for blocks of size 2^( 7) =       0.000583066841

      target function =                  N/A
              le_mean =     -22.824861779572
             les_mean =     521.527246835007
             stat err =       0.000576004796
             autocorr =       1.200081067654
              std dev =       0.743593877679
             le_variance =       0.552931854921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553079219064
                                         uncertainty =       0.048859442517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.553079219064
                                         uncertainty =       0.048859442517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000525800306
  error estimate for blocks of size 2^( 2) =       0.000542377369
  error estimate for blocks of size 2^( 3) =       0.000557424372
  error estimate for blocks of size 2^( 4) =       0.000568446279
  error estimate for blocks of size 2^( 5) =       0.000574247863
  error estimate for blocks of size 2^( 6) =       0.000578258276
  error estimate for blocks of size 2^( 7) =       0.000583066857

      target function =                  N/A
              le_mean =     -22.824861777771
             les_mean =     521.527246820648
             stat err =       0.000576004819
             autocorr =       1.200081013787
              std dev =       0.743593923304
             le_variance =       0.552931922774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824861777514        initial
     2.3283e+02     2.3283e+03             9.6512e-07       -22.824861781629  <--
     9.3132e+02     9.3132e+03             2.4130e-07       -22.824861779572
     3.7253e+03     3.7253e+04             6.0326e-08       -22.824861777771

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 6.0715e+01
  </log>
  <optVariables href="FORM.s034.opt.xml">
 uu_0                 2.650044e-01 1 1  ON 0
 uu_1                 9.124419e-02 1 1  ON 1
 uu_2                -1.965920e-02 1 1  ON 2
 uu_3                -8.457347e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533763e-01 1 1  ON 6
 uu_7                -1.523290e-01 1 1  ON 7
 uu_8                -1.336241e-01 1 1  ON 8
 uu_9                -8.542034e-02 1 1  ON 9
 ud_0                 4.267596e-01 1 1  ON 10
 ud_1                 1.447307e-01 1 1  ON 11
 ud_2                -7.211339e-04 1 1  ON 12
 ud_3                -8.008387e-02 1 1  ON 13
 ud_4                -1.260439e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695590e-01 1 1  ON 16
 ud_7                -1.711985e-01 1 1  ON 17
 ud_8                -1.547520e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513137e-01 1 1  ON 20
 eC_1                -3.948841e-01 1 1  ON 21
 eC_2                -1.407271e-01 1 1  ON 22
 eC_3                 1.429553e-02 1 1  ON 23
 eC_4                 7.409392e-02 1 1  ON 24
 eC_5                 1.705491e-01 1 1  ON 25
 eC_6                 2.798037e-01 1 1  ON 26
 eC_7                 3.527784e-01 1 1  ON 27
 eC_8                 1.601767e-01 1 1  ON 28
 eC_9                 3.120862e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953043e-01 1 1  ON 31
 eO_2                -3.204573e-01 1 1  ON 32
 eO_3                 1.735565e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027256e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940480e-01 1 1  ON 37
 eO_8                 3.877797e-01 1 1  ON 38
 eO_9                 1.980439e-01 1 1  ON 39
eH1_0                -1.705052e-01 1 1  ON 40
eH1_1                -8.409350e-02 1 1  ON 41
eH1_2                -5.348498e-02 1 1  ON 42
eH1_3                -4.183196e-02 1 1  ON 43
eH1_4                 1.303354e-02 1 1  ON 44
eH1_5                 6.124121e-02 1 1  ON 45
eH1_6                 1.071729e-01 1 1  ON 46
eH1_7                 7.332795e-02 1 1  ON 47
eH1_8                -5.715485e-03 1 1  ON 48
eH1_9                 4.539911e-02 1 1  ON 49
eH2_0                -1.714194e-01 1 1  ON 50
eH2_1                -8.408128e-02 1 1  ON 51
eH2_2                -5.319877e-02 1 1  ON 52
eH2_3                -4.160198e-02 1 1  ON 53
eH2_4                 1.338230e-02 1 1  ON 54
eH2_5                 6.135947e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387928e-02 1 1  ON 57
eH2_8                -4.747582e-03 1 1  ON 58
eH2_9                 4.702095e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1950e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2822e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7979
    reference variance = 0.271854
====================================================
  Execution time = 4.4357e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1109e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4955e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510918388501
                                         uncertainty =       0.006145568276

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.510918388501
                                         uncertainty =       0.006145568276

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505516370
  error estimate for blocks of size 2^( 2) =       0.000523585022
  error estimate for blocks of size 2^( 3) =       0.000539507235
  error estimate for blocks of size 2^( 4) =       0.000551177968
  error estimate for blocks of size 2^( 5) =       0.000558823602
  error estimate for blocks of size 2^( 6) =       0.000563550577
  error estimate for blocks of size 2^( 7) =       0.000567279175

      target function =                  N/A
              le_mean =     -22.824947548965
             les_mean =     521.489323957826
             stat err =       0.000560207831
             autocorr =       1.228083518555
              std dev =       0.714908106241
             le_variance =       0.511093600369


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282494754896e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824947548965       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824947555176       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824947560664       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824947561233       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824947554425       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824947548564       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824947554895       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824947558009       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824947558357       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824947560508       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+01 is 4.451820e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824947548965       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824947550521       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824947551900       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824947552051       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824947550353       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824947548875       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824947550433       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824947551211       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824947551307       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824947551848       residual = 5.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+02 is 1.116538e-06

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824947548965       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824947549354       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824947549700       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824947549737       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824947549314       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824947548944       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824947549329       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824947549525       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824947549550       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824947549684       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+02 is 2.793599e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.9320e+01
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.650045e-01 1 1  ON 0
 uu_1                 9.124440e-02 1 1  ON 1
 uu_2                -1.965938e-02 1 1  ON 2
 uu_3                -8.457319e-02 1 1  ON 3
 uu_4                -1.212331e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533766e-01 1 1  ON 6
 uu_7                -1.523286e-01 1 1  ON 7
 uu_8                -1.336245e-01 1 1  ON 8
 uu_9                -8.542071e-02 1 1  ON 9
 ud_0                 4.267599e-01 1 1  ON 10
 ud_1                 1.447312e-01 1 1  ON 11
 ud_2                -7.208270e-04 1 1  ON 12
 ud_3                -8.008365e-02 1 1  ON 13
 ud_4                -1.260439e-01 1 1  ON 14
 ud_5                -1.542571e-01 1 1  ON 15
 ud_6                -1.695591e-01 1 1  ON 16
 ud_7                -1.711986e-01 1 1  ON 17
 ud_8                -1.547527e-01 1 1  ON 18
 ud_9                -1.089888e-01 1 1  ON 19
 eC_0                -5.513138e-01 1 1  ON 20
 eC_1                -3.948844e-01 1 1  ON 21
 eC_2                -1.407275e-01 1 1  ON 22
 eC_3                 1.429573e-02 1 1  ON 23
 eC_4                 7.409357e-02 1 1  ON 24
 eC_5                 1.705487e-01 1 1  ON 25
 eC_6                 2.798037e-01 1 1  ON 26
 eC_7                 3.527787e-01 1 1  ON 27
 eC_8                 1.601774e-01 1 1  ON 28
 eC_9                 3.120881e-02 1 1  ON 29
 eO_0                -1.172308e+00 1 1  ON 30
 eO_1                -7.953054e-01 1 1  ON 31
 eO_2                -3.204576e-01 1 1  ON 32
 eO_3                 1.735492e-02 1 1  ON 33
 eO_4                 2.344854e-01 1 1  ON 34
 eO_5                 4.027253e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940487e-01 1 1  ON 37
 eO_8                 3.877806e-01 1 1  ON 38
 eO_9                 1.980446e-01 1 1  ON 39
eH1_0                -1.705054e-01 1 1  ON 40
eH1_1                -8.409384e-02 1 1  ON 41
eH1_2                -5.348490e-02 1 1  ON 42
eH1_3                -4.183209e-02 1 1  ON 43
eH1_4                 1.303348e-02 1 1  ON 44
eH1_5                 6.124142e-02 1 1  ON 45
eH1_6                 1.071732e-01 1 1  ON 46
eH1_7                 7.332783e-02 1 1  ON 47
eH1_8                -5.715321e-03 1 1  ON 48
eH1_9                 4.539897e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408148e-02 1 1  ON 51
eH2_2                -5.319877e-02 1 1  ON 52
eH2_3                -4.160214e-02 1 1  ON 53
eH2_4                 1.338230e-02 1 1  ON 54
eH2_5                 6.135957e-02 1 1  ON 55
eH2_6                 1.077401e-01 1 1  ON 56
eH2_7                 7.387930e-02 1 1  ON 57
eH2_8                -4.747819e-03 1 1  ON 58
eH2_9                 4.702051e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -22.7312
    reference variance = 0.460937
====================================================
  Execution time = 4.4952e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0328e-01
  Total weights = 2.0000e+06
  Execution time = 4.2444e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503333029685
                                         uncertainty =       0.003306117738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503333029685
                                         uncertainty =       0.003306117738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501636661
  error estimate for blocks of size 2^( 2) =       0.000519089313
  error estimate for blocks of size 2^( 3) =       0.000535571868
  error estimate for blocks of size 2^( 4) =       0.000546569540
  error estimate for blocks of size 2^( 5) =       0.000553360250
  error estimate for blocks of size 2^( 6) =       0.000555950361
  error estimate for blocks of size 2^( 7) =       0.000553690183

      target function =                  N/A
              le_mean =     -22.824861588321
             les_mean =     521.477584954538
             stat err =       0.000552392583
             autocorr =       1.212598817577
              std dev =       0.709421369978
             le_variance =       0.503278680182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503332857093
                                         uncertainty =       0.003306115441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503332857093
                                         uncertainty =       0.003306115441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501636576
  error estimate for blocks of size 2^( 2) =       0.000519089255
  error estimate for blocks of size 2^( 3) =       0.000535571807
  error estimate for blocks of size 2^( 4) =       0.000546569466
  error estimate for blocks of size 2^( 5) =       0.000553360136
  error estimate for blocks of size 2^( 6) =       0.000555950256
  error estimate for blocks of size 2^( 7) =       0.000553690195

      target function =                  N/A
              le_mean =     -22.824861582622
             les_mean =     521.477584522712
             stat err =       0.000552392513
             autocorr =       1.212598921887
              std dev =       0.709421248966
             le_variance =       0.503278508484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503332942672
                                         uncertainty =       0.003306116600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503332942672
                                         uncertainty =       0.003306116600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501636618
  error estimate for blocks of size 2^( 2) =       0.000519089284
  error estimate for blocks of size 2^( 3) =       0.000535571838
  error estimate for blocks of size 2^( 4) =       0.000546569502
  error estimate for blocks of size 2^( 5) =       0.000553360192
  error estimate for blocks of size 2^( 6) =       0.000555950308
  error estimate for blocks of size 2^( 7) =       0.000553690188

      target function =                  N/A
              le_mean =     -22.824861585431
             les_mean =     521.477584736061
             stat err =       0.000552392548
             autocorr =       1.212598869532
              std dev =       0.709421308968
             le_variance =       0.503278593618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503333018776
                                         uncertainty =       0.003306117596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.503333018776
                                         uncertainty =       0.003306117596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501636656
  error estimate for blocks of size 2^( 2) =       0.000519089309
  error estimate for blocks of size 2^( 3) =       0.000535571865
  error estimate for blocks of size 2^( 4) =       0.000546569535
  error estimate for blocks of size 2^( 5) =       0.000553360243
  error estimate for blocks of size 2^( 6) =       0.000555950355
  error estimate for blocks of size 2^( 7) =       0.000553690183

      target function =                  N/A
              le_mean =     -22.824861587957
             les_mean =     521.477584927082
             stat err =       0.000552392579
             autocorr =       1.212598824062
              std dev =       0.709421362329
             le_variance =       0.503278669328


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824861588321        initial  <--
     5.8208e+01     5.8208e+02             4.4518e-06       -22.824861582622
     2.3283e+02     2.3283e+03             1.1165e-06       -22.824861585431
     9.3132e+02     9.3132e+03             2.7936e-07       -22.824861587957

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 63.6090
  </log>
  <optVariables href="FORM.s035.opt.xml">
 uu_0                 2.650044e-01 1 1  ON 0
 uu_1                 9.124419e-02 1 1  ON 1
 uu_2                -1.965920e-02 1 1  ON 2
 uu_3                -8.457347e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533763e-01 1 1  ON 6
 uu_7                -1.523290e-01 1 1  ON 7
 uu_8                -1.336241e-01 1 1  ON 8
 uu_9                -8.542034e-02 1 1  ON 9
 ud_0                 4.267596e-01 1 1  ON 10
 ud_1                 1.447307e-01 1 1  ON 11
 ud_2                -7.211339e-04 1 1  ON 12
 ud_3                -8.008387e-02 1 1  ON 13
 ud_4                -1.260439e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695590e-01 1 1  ON 16
 ud_7                -1.711985e-01 1 1  ON 17
 ud_8                -1.547520e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513137e-01 1 1  ON 20
 eC_1                -3.948841e-01 1 1  ON 21
 eC_2                -1.407271e-01 1 1  ON 22
 eC_3                 1.429553e-02 1 1  ON 23
 eC_4                 7.409392e-02 1 1  ON 24
 eC_5                 1.705491e-01 1 1  ON 25
 eC_6                 2.798037e-01 1 1  ON 26
 eC_7                 3.527784e-01 1 1  ON 27
 eC_8                 1.601767e-01 1 1  ON 28
 eC_9                 3.120862e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953043e-01 1 1  ON 31
 eO_2                -3.204573e-01 1 1  ON 32
 eO_3                 1.735565e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027256e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940480e-01 1 1  ON 37
 eO_8                 3.877797e-01 1 1  ON 38
 eO_9                 1.980439e-01 1 1  ON 39
eH1_0                -1.705052e-01 1 1  ON 40
eH1_1                -8.409350e-02 1 1  ON 41
eH1_2                -5.348498e-02 1 1  ON 42
eH1_3                -4.183196e-02 1 1  ON 43
eH1_4                 1.303354e-02 1 1  ON 44
eH1_5                 6.124121e-02 1 1  ON 45
eH1_6                 1.071729e-01 1 1  ON 46
eH1_7                 7.332795e-02 1 1  ON 47
eH1_8                -5.715485e-03 1 1  ON 48
eH1_9                 4.539911e-02 1 1  ON 49
eH2_0                -1.714194e-01 1 1  ON 50
eH2_1                -8.408128e-02 1 1  ON 51
eH2_2                -5.319877e-02 1 1  ON 52
eH2_3                -4.160198e-02 1 1  ON 53
eH2_4                 1.338230e-02 1 1  ON 54
eH2_5                 6.135947e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387928e-02 1 1  ON 57
eH2_8                -4.747582e-03 1 1  ON 58
eH2_9                 4.702095e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2294e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2821e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.7772
    reference variance = 0.325633
====================================================
  Execution time = 4.3537e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2827e+01
  VMC Evar = 5.0397e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4908e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504154007444
                                         uncertainty =       0.006879979154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504154007444
                                         uncertainty =       0.006879979154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501982452
  error estimate for blocks of size 2^( 2) =       0.000519693704
  error estimate for blocks of size 2^( 3) =       0.000535031463
  error estimate for blocks of size 2^( 4) =       0.000546472346
  error estimate for blocks of size 2^( 5) =       0.000552948909
  error estimate for blocks of size 2^( 6) =       0.000556821217
  error estimate for blocks of size 2^( 7) =       0.000559493690

      target function =                  N/A
              le_mean =     -22.826570901942
             les_mean =     521.556311653984
             stat err =       0.000553934040
             autocorr =       1.217696441791
              std dev =       0.709910391943
             le_variance =       0.503972764589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282657090194e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826570901942       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826570902951       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826570902692       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826570902074       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826570902688       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826570902249       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826570902029       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826570902848       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826570902812       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826570902753       residual = 5.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+02 is 4.341686e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826570901942       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826570902194       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826570902129       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826570901975       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826570902129       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826570902018       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826570901965       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826570902163       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826570902161       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826570902147       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+03 is 1.085657e-07

solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.826570901942       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.826570902005       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.826570901989       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.826570901950       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.826570901995       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.826570901962       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.826570901950       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.826570901984       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.826570901989       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.826570901977       residual = 5.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+03 is 2.714289e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8453e+01
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.650044e-01 1 1  ON 0
 uu_1                 9.124418e-02 1 1  ON 1
 uu_2                -1.965921e-02 1 1  ON 2
 uu_3                -8.457345e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533764e-01 1 1  ON 6
 uu_7                -1.523290e-01 1 1  ON 7
 uu_8                -1.336241e-01 1 1  ON 8
 uu_9                -8.542039e-02 1 1  ON 9
 ud_0                 4.267596e-01 1 1  ON 10
 ud_1                 1.447307e-01 1 1  ON 11
 ud_2                -7.211386e-04 1 1  ON 12
 ud_3                -8.008384e-02 1 1  ON 13
 ud_4                -1.260439e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695589e-01 1 1  ON 16
 ud_7                -1.711985e-01 1 1  ON 17
 ud_8                -1.547520e-01 1 1  ON 18
 ud_9                -1.089882e-01 1 1  ON 19
 eC_0                -5.513137e-01 1 1  ON 20
 eC_1                -3.948841e-01 1 1  ON 21
 eC_2                -1.407271e-01 1 1  ON 22
 eC_3                 1.429549e-02 1 1  ON 23
 eC_4                 7.409387e-02 1 1  ON 24
 eC_5                 1.705491e-01 1 1  ON 25
 eC_6                 2.798037e-01 1 1  ON 26
 eC_7                 3.527784e-01 1 1  ON 27
 eC_8                 1.601767e-01 1 1  ON 28
 eC_9                 3.120864e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953043e-01 1 1  ON 31
 eO_2                -3.204574e-01 1 1  ON 32
 eO_3                 1.735554e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027256e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940480e-01 1 1  ON 37
 eO_8                 3.877797e-01 1 1  ON 38
 eO_9                 1.980440e-01 1 1  ON 39
eH1_0                -1.705053e-01 1 1  ON 40
eH1_1                -8.409352e-02 1 1  ON 41
eH1_2                -5.348500e-02 1 1  ON 42
eH1_3                -4.183196e-02 1 1  ON 43
eH1_4                 1.303356e-02 1 1  ON 44
eH1_5                 6.124122e-02 1 1  ON 45
eH1_6                 1.071730e-01 1 1  ON 46
eH1_7                 7.332802e-02 1 1  ON 47
eH1_8                -5.715490e-03 1 1  ON 48
eH1_9                 4.539907e-02 1 1  ON 49
eH2_0                -1.714194e-01 1 1  ON 50
eH2_1                -8.408136e-02 1 1  ON 51
eH2_2                -5.319873e-02 1 1  ON 52
eH2_3                -4.160195e-02 1 1  ON 53
eH2_4                 1.338227e-02 1 1  ON 54
eH2_5                 6.135954e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387930e-02 1 1  ON 57
eH2_8                -4.747583e-03 1 1  ON 58
eH2_9                 4.702092e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -22.8008
    reference variance = 0.385857
====================================================
  Execution time = 4.3133e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0202e-01
  Total weights = 2.0000e+06
  Execution time = 3.5376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502143137262
                                         uncertainty =       0.005223216161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502143137262
                                         uncertainty =       0.005223216161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501008085
  error estimate for blocks of size 2^( 2) =       0.000519073616
  error estimate for blocks of size 2^( 3) =       0.000535848944
  error estimate for blocks of size 2^( 4) =       0.000546462962
  error estimate for blocks of size 2^( 5) =       0.000553739962
  error estimate for blocks of size 2^( 6) =       0.000555782263
  error estimate for blocks of size 2^( 7) =       0.000553873867

      target function =                  N/A
              le_mean =     -22.825022103397
             les_mean =     521.483651972412
             stat err =       0.000552464763
             autocorr =       1.215961146266
              std dev =       0.708532428951
             le_variance =       0.502018202875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502143277220
                                         uncertainty =       0.005223217932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502143277220
                                         uncertainty =       0.005223217932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501008155
  error estimate for blocks of size 2^( 2) =       0.000519073679
  error estimate for blocks of size 2^( 3) =       0.000535849000
  error estimate for blocks of size 2^( 4) =       0.000546463013
  error estimate for blocks of size 2^( 5) =       0.000553740006
  error estimate for blocks of size 2^( 6) =       0.000555782317
  error estimate for blocks of size 2^( 7) =       0.000553873919

      target function =                  N/A
              le_mean =     -22.825022100311
             les_mean =     521.483651971613
             stat err =       0.000552464814
             autocorr =       1.215961028679
              std dev =       0.708532527778
             le_variance =       0.502018342920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502143207244
                                         uncertainty =       0.005223217046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502143207244
                                         uncertainty =       0.005223217046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501008120
  error estimate for blocks of size 2^( 2) =       0.000519073647
  error estimate for blocks of size 2^( 3) =       0.000535848972
  error estimate for blocks of size 2^( 4) =       0.000546462987
  error estimate for blocks of size 2^( 5) =       0.000553739984
  error estimate for blocks of size 2^( 6) =       0.000555782290
  error estimate for blocks of size 2^( 7) =       0.000553873893

      target function =                  N/A
              le_mean =     -22.825022101853
             les_mean =     521.483651971975
             stat err =       0.000552464788
             autocorr =       1.215961087447
              std dev =       0.708532478366
             le_variance =       0.502018272900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502143146010
                                         uncertainty =       0.005223216272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.502143146010
                                         uncertainty =       0.005223216272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501008090
  error estimate for blocks of size 2^( 2) =       0.000519073620
  error estimate for blocks of size 2^( 3) =       0.000535848947
  error estimate for blocks of size 2^( 4) =       0.000546462965
  error estimate for blocks of size 2^( 5) =       0.000553739965
  error estimate for blocks of size 2^( 6) =       0.000555782266
  error estimate for blocks of size 2^( 7) =       0.000553873870

      target function =                  N/A
              le_mean =     -22.825022103204
             les_mean =     521.483651972356
             stat err =       0.000552464766
             autocorr =       1.215961138917
              std dev =       0.708532435128
             le_variance =       0.502018211628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825022103397        initial  <--
     5.8208e+02     5.8208e+03             4.3417e-07       -22.825022100311
     2.3283e+03     2.3283e+04             1.0857e-07       -22.825022101853
     9.3132e+03     9.3132e+04             2.7143e-08       -22.825022103204

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 60.8824
  </log>
  <optVariables href="FORM.s036.opt.xml">
 uu_0                 2.650044e-01 1 1  ON 0
 uu_1                 9.124419e-02 1 1  ON 1
 uu_2                -1.965920e-02 1 1  ON 2
 uu_3                -8.457347e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533763e-01 1 1  ON 6
 uu_7                -1.523290e-01 1 1  ON 7
 uu_8                -1.336241e-01 1 1  ON 8
 uu_9                -8.542034e-02 1 1  ON 9
 ud_0                 4.267596e-01 1 1  ON 10
 ud_1                 1.447307e-01 1 1  ON 11
 ud_2                -7.211339e-04 1 1  ON 12
 ud_3                -8.008387e-02 1 1  ON 13
 ud_4                -1.260439e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695590e-01 1 1  ON 16
 ud_7                -1.711985e-01 1 1  ON 17
 ud_8                -1.547520e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513137e-01 1 1  ON 20
 eC_1                -3.948841e-01 1 1  ON 21
 eC_2                -1.407271e-01 1 1  ON 22
 eC_3                 1.429553e-02 1 1  ON 23
 eC_4                 7.409392e-02 1 1  ON 24
 eC_5                 1.705491e-01 1 1  ON 25
 eC_6                 2.798037e-01 1 1  ON 26
 eC_7                 3.527784e-01 1 1  ON 27
 eC_8                 1.601767e-01 1 1  ON 28
 eC_9                 3.120862e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953043e-01 1 1  ON 31
 eO_2                -3.204573e-01 1 1  ON 32
 eO_3                 1.735565e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027256e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940480e-01 1 1  ON 37
 eO_8                 3.877797e-01 1 1  ON 38
 eO_9                 1.980439e-01 1 1  ON 39
eH1_0                -1.705052e-01 1 1  ON 40
eH1_1                -8.409350e-02 1 1  ON 41
eH1_2                -5.348498e-02 1 1  ON 42
eH1_3                -4.183196e-02 1 1  ON 43
eH1_4                 1.303354e-02 1 1  ON 44
eH1_5                 6.124121e-02 1 1  ON 45
eH1_6                 1.071729e-01 1 1  ON 46
eH1_7                 7.332795e-02 1 1  ON 47
eH1_8                -5.715485e-03 1 1  ON 48
eH1_9                 4.539911e-02 1 1  ON 49
eH2_0                -1.714194e-01 1 1  ON 50
eH2_1                -8.408128e-02 1 1  ON 51
eH2_2                -5.319877e-02 1 1  ON 52
eH2_3                -4.160198e-02 1 1  ON 53
eH2_4                 1.338230e-02 1 1  ON 54
eH2_5                 6.135947e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387928e-02 1 1  ON 57
eH2_8                -4.747582e-03 1 1  ON 58
eH2_9                 4.702095e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1934e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2820e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7666
    reference variance = 0.612251
====================================================
  Execution time = 4.3643e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2826e+01
  VMC Evar = 5.0970e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5170e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509805610272
                                         uncertainty =       0.006085030927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.509805610272
                                         uncertainty =       0.006085030927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504828676
  error estimate for blocks of size 2^( 2) =       0.000522381550
  error estimate for blocks of size 2^( 3) =       0.000538054776
  error estimate for blocks of size 2^( 4) =       0.000548234339
  error estimate for blocks of size 2^( 5) =       0.000554656390
  error estimate for blocks of size 2^( 6) =       0.000557982206
  error estimate for blocks of size 2^( 7) =       0.000561425720

      target function =                  N/A
              le_mean =     -22.825881508870
             les_mean =     521.530570386629
             stat err =       0.000555574664
             autocorr =       1.211146926540
              std dev =       0.713935560465
             le_variance =       0.509703984497


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282588150887e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825881508870       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825881508931       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825881508974       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825881509074       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825881509038       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825881509113       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825881509013       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825881509069       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825881509032       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825881509033       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+03 is 3.667295e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825881508870       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825881508886       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825881508896       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825881508934       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825881508911       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825881508922       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825881508917       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825881508873       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825881508934       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825881508898       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+04 is 9.168251e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825881508870       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825881508874       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825881508877       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825881508830       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825881508922       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825881508893       residual = 5.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825881508913       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825881508863       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825881508968       residual = 4.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825881508614       residual = 5.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 9.3132e+04 is 2.292064e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.400673 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8821e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.650044e-01 1 1  ON 0
 uu_1                 9.124419e-02 1 1  ON 1
 uu_2                -1.965920e-02 1 1  ON 2
 uu_3                -8.457347e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533763e-01 1 1  ON 6
 uu_7                -1.523290e-01 1 1  ON 7
 uu_8                -1.336241e-01 1 1  ON 8
 uu_9                -8.542035e-02 1 1  ON 9
 ud_0                 4.267596e-01 1 1  ON 10
 ud_1                 1.447307e-01 1 1  ON 11
 ud_2                -7.211296e-04 1 1  ON 12
 ud_3                -8.008387e-02 1 1  ON 13
 ud_4                -1.260439e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695590e-01 1 1  ON 16
 ud_7                -1.711985e-01 1 1  ON 17
 ud_8                -1.547520e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513137e-01 1 1  ON 20
 eC_1                -3.948841e-01 1 1  ON 21
 eC_2                -1.407271e-01 1 1  ON 22
 eC_3                 1.429553e-02 1 1  ON 23
 eC_4                 7.409392e-02 1 1  ON 24
 eC_5                 1.705491e-01 1 1  ON 25
 eC_6                 2.798037e-01 1 1  ON 26
 eC_7                 3.527784e-01 1 1  ON 27
 eC_8                 1.601767e-01 1 1  ON 28
 eC_9                 3.120862e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953043e-01 1 1  ON 31
 eO_2                -3.204573e-01 1 1  ON 32
 eO_3                 1.735565e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027256e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940480e-01 1 1  ON 37
 eO_8                 3.877797e-01 1 1  ON 38
 eO_9                 1.980439e-01 1 1  ON 39
eH1_0                -1.705052e-01 1 1  ON 40
eH1_1                -8.409350e-02 1 1  ON 41
eH1_2                -5.348498e-02 1 1  ON 42
eH1_3                -4.183196e-02 1 1  ON 43
eH1_4                 1.303354e-02 1 1  ON 44
eH1_5                 6.124122e-02 1 1  ON 45
eH1_6                 1.071729e-01 1 1  ON 46
eH1_7                 7.332795e-02 1 1  ON 47
eH1_8                -5.715486e-03 1 1  ON 48
eH1_9                 4.539911e-02 1 1  ON 49
eH2_0                -1.714194e-01 1 1  ON 50
eH2_1                -8.408129e-02 1 1  ON 51
eH2_2                -5.319876e-02 1 1  ON 52
eH2_3                -4.160198e-02 1 1  ON 53
eH2_4                 1.338230e-02 1 1  ON 54
eH2_5                 6.135948e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387928e-02 1 1  ON 57
eH2_8                -4.747585e-03 1 1  ON 58
eH2_9                 4.702095e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -22.7709
    reference variance = 0.33774
====================================================
  Execution time = 4.3119e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1342e-01
  Total weights = 2.0000e+06
  Execution time = 3.5268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513501075812
                                         uncertainty =       0.009973074970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513501075812
                                         uncertainty =       0.009973074970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506668011
  error estimate for blocks of size 2^( 2) =       0.000524602081
  error estimate for blocks of size 2^( 3) =       0.000540154900
  error estimate for blocks of size 2^( 4) =       0.000551373042
  error estimate for blocks of size 2^( 5) =       0.000556326865
  error estimate for blocks of size 2^( 6) =       0.000561216536
  error estimate for blocks of size 2^( 7) =       0.000561261423

      target function =                  N/A
              le_mean =     -22.825244761043
             les_mean =     521.505223092472
             stat err =       0.000557544466
             autocorr =       1.210910507734
              std dev =       0.716536773430
             le_variance =       0.513424947678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513501087077
                                         uncertainty =       0.009973074097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513501087077
                                         uncertainty =       0.009973074097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506668017
  error estimate for blocks of size 2^( 2) =       0.000524602086
  error estimate for blocks of size 2^( 3) =       0.000540154905
  error estimate for blocks of size 2^( 4) =       0.000551373047
  error estimate for blocks of size 2^( 5) =       0.000556326870
  error estimate for blocks of size 2^( 6) =       0.000561216542
  error estimate for blocks of size 2^( 7) =       0.000561261428

      target function =                  N/A
              le_mean =     -22.825244761120
             les_mean =     521.505223107260
             stat err =       0.000557544472
             autocorr =       1.210910504192
              std dev =       0.716536781292
             le_variance =       0.513424958944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513501081445
                                         uncertainty =       0.009973074533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513501081445
                                         uncertainty =       0.009973074533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506668014
  error estimate for blocks of size 2^( 2) =       0.000524602084
  error estimate for blocks of size 2^( 3) =       0.000540154903
  error estimate for blocks of size 2^( 4) =       0.000551373044
  error estimate for blocks of size 2^( 5) =       0.000556326867
  error estimate for blocks of size 2^( 6) =       0.000561216539
  error estimate for blocks of size 2^( 7) =       0.000561261426

      target function =                  N/A
              le_mean =     -22.825244761081
             les_mean =     521.505223099867
             stat err =       0.000557544469
             autocorr =       1.210910505963
              std dev =       0.716536777361
             le_variance =       0.513424953311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513501076516
                                         uncertainty =       0.009973074915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513501076516
                                         uncertainty =       0.009973074915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506668012
  error estimate for blocks of size 2^( 2) =       0.000524602081
  error estimate for blocks of size 2^( 3) =       0.000540154900
  error estimate for blocks of size 2^( 4) =       0.000551373042
  error estimate for blocks of size 2^( 5) =       0.000556326865
  error estimate for blocks of size 2^( 6) =       0.000561216536
  error estimate for blocks of size 2^( 7) =       0.000561261424

      target function =                  N/A
              le_mean =     -22.825244761048
             les_mean =     521.505223093396
             stat err =       0.000557544467
             autocorr =       1.210910507510
              std dev =       0.716536773922
             le_variance =       0.513424948382


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825244761043        initial
     5.8208e+03     5.8208e+04             3.6673e-08       -22.825244761120  <--
     2.3283e+04     2.3283e+05             9.1683e-09       -22.825244761081
     9.3132e+04     9.3132e+05             2.2921e-09       -22.825244761048

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 6.0814e+01
  </log>
  <optVariables href="FORM.s037.opt.xml">
 uu_0                 2.650044e-01 1 1  ON 0
 uu_1                 9.124420e-02 1 1  ON 1
 uu_2                -1.965921e-02 1 1  ON 2
 uu_3                -8.457346e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533763e-01 1 1  ON 6
 uu_7                -1.523290e-01 1 1  ON 7
 uu_8                -1.336241e-01 1 1  ON 8
 uu_9                -8.542037e-02 1 1  ON 9
 ud_0                 4.267597e-01 1 1  ON 10
 ud_1                 1.447307e-01 1 1  ON 11
 ud_2                -7.211167e-04 1 1  ON 12
 ud_3                -8.008386e-02 1 1  ON 13
 ud_4                -1.260439e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695590e-01 1 1  ON 16
 ud_7                -1.711985e-01 1 1  ON 17
 ud_8                -1.547520e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513137e-01 1 1  ON 20
 eC_1                -3.948841e-01 1 1  ON 21
 eC_2                -1.407271e-01 1 1  ON 22
 eC_3                 1.429552e-02 1 1  ON 23
 eC_4                 7.409392e-02 1 1  ON 24
 eC_5                 1.705490e-01 1 1  ON 25
 eC_6                 2.798037e-01 1 1  ON 26
 eC_7                 3.527784e-01 1 1  ON 27
 eC_8                 1.601767e-01 1 1  ON 28
 eC_9                 3.120863e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953043e-01 1 1  ON 31
 eO_2                -3.204573e-01 1 1  ON 32
 eO_3                 1.735563e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027256e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940480e-01 1 1  ON 37
 eO_8                 3.877797e-01 1 1  ON 38
 eO_9                 1.980439e-01 1 1  ON 39
eH1_0                -1.705052e-01 1 1  ON 40
eH1_1                -8.409350e-02 1 1  ON 41
eH1_2                -5.348497e-02 1 1  ON 42
eH1_3                -4.183197e-02 1 1  ON 43
eH1_4                 1.303355e-02 1 1  ON 44
eH1_5                 6.124123e-02 1 1  ON 45
eH1_6                 1.071729e-01 1 1  ON 46
eH1_7                 7.332796e-02 1 1  ON 47
eH1_8                -5.715487e-03 1 1  ON 48
eH1_9                 4.539910e-02 1 1  ON 49
eH2_0                -1.714194e-01 1 1  ON 50
eH2_1                -8.408130e-02 1 1  ON 51
eH2_2                -5.319874e-02 1 1  ON 52
eH2_3                -4.160199e-02 1 1  ON 53
eH2_4                 1.338230e-02 1 1  ON 54
eH2_5                 6.135948e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387928e-02 1 1  ON 57
eH2_8                -4.747594e-03 1 1  ON 58
eH2_9                 4.702094e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1964e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2819e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.6474
    reference variance = 0.847319
====================================================
  Execution time = 4.6792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0849e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.5138e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508590528629
                                         uncertainty =       0.004462827154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.508590528629
                                         uncertainty =       0.004462827154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000504228117
  error estimate for blocks of size 2^( 2) =       0.000522151300
  error estimate for blocks of size 2^( 3) =       0.000537530758
  error estimate for blocks of size 2^( 4) =       0.000549218236
  error estimate for blocks of size 2^( 5) =       0.000556034986
  error estimate for blocks of size 2^( 6) =       0.000560669370
  error estimate for blocks of size 2^( 7) =       0.000563866548

      target function =                  N/A
              le_mean =     -22.825269486756
             les_mean =     521.501418876581
             stat err =       0.000557447285
             autocorr =       1.222231551765
              std dev =       0.713086241488
             le_variance =       0.508491987799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282526948676e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825269486756       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825269486771       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825269486798       residual = 4.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825269487785       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825269487774       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825269488421       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825269488406       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825269488387       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825269488465       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825269488516       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825269488522       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+03 is 2.164710e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825269486756       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825269486760       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825269486766       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825269487013       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825269487010       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825269487175       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825269487174       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825269487164       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825269487174       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825269487192       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825269487202       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+03 is 5.412526e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.825269486756       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.825269486757       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.825269486759       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.825269486822       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.825269486802       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.825269486876       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.825269486854       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.825269486837       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.825269486877       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.825269486937       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -22.825269486874       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 2.3283e+04 is 1.353178e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.404970 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 6.1938e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.650044e-01 1 1  ON 0
 uu_1                 9.124418e-02 1 1  ON 1
 uu_2                -1.965921e-02 1 1  ON 2
 uu_3                -8.457348e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533764e-01 1 1  ON 6
 uu_7                -1.523290e-01 1 1  ON 7
 uu_8                -1.336241e-01 1 1  ON 8
 uu_9                -8.542037e-02 1 1  ON 9
 ud_0                 4.267597e-01 1 1  ON 10
 ud_1                 1.447307e-01 1 1  ON 11
 ud_2                -7.211186e-04 1 1  ON 12
 ud_3                -8.008385e-02 1 1  ON 13
 ud_4                -1.260439e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695590e-01 1 1  ON 16
 ud_7                -1.711985e-01 1 1  ON 17
 ud_8                -1.547520e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513137e-01 1 1  ON 20
 eC_1                -3.948842e-01 1 1  ON 21
 eC_2                -1.407271e-01 1 1  ON 22
 eC_3                 1.429551e-02 1 1  ON 23
 eC_4                 7.409389e-02 1 1  ON 24
 eC_5                 1.705490e-01 1 1  ON 25
 eC_6                 2.798036e-01 1 1  ON 26
 eC_7                 3.527784e-01 1 1  ON 27
 eC_8                 1.601767e-01 1 1  ON 28
 eC_9                 3.120864e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953044e-01 1 1  ON 31
 eO_2                -3.204573e-01 1 1  ON 32
 eO_3                 1.735561e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027256e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940480e-01 1 1  ON 37
 eO_8                 3.877797e-01 1 1  ON 38
 eO_9                 1.980440e-01 1 1  ON 39
eH1_0                -1.705052e-01 1 1  ON 40
eH1_1                -8.409352e-02 1 1  ON 41
eH1_2                -5.348497e-02 1 1  ON 42
eH1_3                -4.183197e-02 1 1  ON 43
eH1_4                 1.303355e-02 1 1  ON 44
eH1_5                 6.124124e-02 1 1  ON 45
eH1_6                 1.071729e-01 1 1  ON 46
eH1_7                 7.332795e-02 1 1  ON 47
eH1_8                -5.715481e-03 1 1  ON 48
eH1_9                 4.539910e-02 1 1  ON 49
eH2_0                -1.714194e-01 1 1  ON 50
eH2_1                -8.408133e-02 1 1  ON 51
eH2_2                -5.319876e-02 1 1  ON 52
eH2_3                -4.160199e-02 1 1  ON 53
eH2_4                 1.338230e-02 1 1  ON 54
eH2_5                 6.135949e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387931e-02 1 1  ON 57
eH2_8                -4.747586e-03 1 1  ON 58
eH2_9                 4.702093e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -22.7797
    reference variance = 0.427698
====================================================
  Execution time = 4.3202e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.3572e-01
  Total weights = 2.0000e+06
  Execution time = 3.5424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.535861480962
                                         uncertainty =       0.031402884529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.535861480962
                                         uncertainty =       0.031402884529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000517553212
  error estimate for blocks of size 2^( 2) =       0.000535675542
  error estimate for blocks of size 2^( 3) =       0.000551232894
  error estimate for blocks of size 2^( 4) =       0.000562161982
  error estimate for blocks of size 2^( 5) =       0.000568755324
  error estimate for blocks of size 2^( 6) =       0.000571656469
  error estimate for blocks of size 2^( 7) =       0.000571806491

      target function =                  N/A
              le_mean =     -22.825003249716
             les_mean =     521.516495736127
             stat err =       0.000568595067
             autocorr =       1.206969117456
              std dev =       0.731930771617
             le_variance =       0.535722654439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.535861506876
                                         uncertainty =       0.031402882449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.535861506876
                                         uncertainty =       0.031402882449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000517553224
  error estimate for blocks of size 2^( 2) =       0.000535675554
  error estimate for blocks of size 2^( 3) =       0.000551232905
  error estimate for blocks of size 2^( 4) =       0.000562161991
  error estimate for blocks of size 2^( 5) =       0.000568755330
  error estimate for blocks of size 2^( 6) =       0.000571656475
  error estimate for blocks of size 2^( 7) =       0.000571806494

      target function =                  N/A
              le_mean =     -22.825003250189
             les_mean =     521.516495783560
             stat err =       0.000568595072
             autocorr =       1.206969083833
              std dev =       0.731930789273
             le_variance =       0.535722680286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.535861493916
                                         uncertainty =       0.031402883488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.535861493916
                                         uncertainty =       0.031402883488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000517553218
  error estimate for blocks of size 2^( 2) =       0.000535675548
  error estimate for blocks of size 2^( 3) =       0.000551232900
  error estimate for blocks of size 2^( 4) =       0.000562161986
  error estimate for blocks of size 2^( 5) =       0.000568755327
  error estimate for blocks of size 2^( 6) =       0.000571656472
  error estimate for blocks of size 2^( 7) =       0.000571806492

      target function =                  N/A
              le_mean =     -22.825003249953
             les_mean =     521.516495759840
             stat err =       0.000568595069
             autocorr =       1.206969100641
              std dev =       0.731930780442
             le_variance =       0.535722667359

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.535861482581
                                         uncertainty =       0.031402884399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.535861482581
                                         uncertainty =       0.031402884399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000517553213
  error estimate for blocks of size 2^( 2) =       0.000535675542
  error estimate for blocks of size 2^( 3) =       0.000551232895
  error estimate for blocks of size 2^( 4) =       0.000562161982
  error estimate for blocks of size 2^( 5) =       0.000568755324
  error estimate for blocks of size 2^( 6) =       0.000571656469
  error estimate for blocks of size 2^( 7) =       0.000571806492

      target function =                  N/A
              le_mean =     -22.825003249746
             les_mean =     521.516495739091
             stat err =       0.000568595067
             autocorr =       1.206969115352
              std dev =       0.731930772720
             le_variance =       0.535722656054


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.825003249716        initial
     1.4552e+03     1.4552e+04             2.1647e-07       -22.825003250189  <--
     5.8208e+03     5.8208e+04             5.4125e-08       -22.825003249953
     2.3283e+04     2.3283e+05             1.3532e-08       -22.825003249746

*****************************************************************************
Applying the update for shift_i =   1.4552e+03     and shift_s =   1.4552e+04
*****************************************************************************

  Execution time = 6.0915e+01
  </log>
  <optVariables href="FORM.s038.opt.xml">
 uu_0                 2.650045e-01 1 1  ON 0
 uu_1                 9.124411e-02 1 1  ON 1
 uu_2                -1.965924e-02 1 1  ON 2
 uu_3                -8.457356e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533764e-01 1 1  ON 6
 uu_7                -1.523289e-01 1 1  ON 7
 uu_8                -1.336241e-01 1 1  ON 8
 uu_9                -8.542037e-02 1 1  ON 9
 ud_0                 4.267597e-01 1 1  ON 10
 ud_1                 1.447308e-01 1 1  ON 11
 ud_2                -7.211243e-04 1 1  ON 12
 ud_3                -8.008381e-02 1 1  ON 13
 ud_4                -1.260440e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695590e-01 1 1  ON 16
 ud_7                -1.711986e-01 1 1  ON 17
 ud_8                -1.547520e-01 1 1  ON 18
 ud_9                -1.089881e-01 1 1  ON 19
 eC_0                -5.513138e-01 1 1  ON 20
 eC_1                -3.948842e-01 1 1  ON 21
 eC_2                -1.407271e-01 1 1  ON 22
 eC_3                 1.429548e-02 1 1  ON 23
 eC_4                 7.409383e-02 1 1  ON 24
 eC_5                 1.705490e-01 1 1  ON 25
 eC_6                 2.798036e-01 1 1  ON 26
 eC_7                 3.527785e-01 1 1  ON 27
 eC_8                 1.601768e-01 1 1  ON 28
 eC_9                 3.120867e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953046e-01 1 1  ON 31
 eO_2                -3.204574e-01 1 1  ON 32
 eO_3                 1.735552e-02 1 1  ON 33
 eO_4                 2.344858e-01 1 1  ON 34
 eO_5                 4.027255e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940480e-01 1 1  ON 37
 eO_8                 3.877798e-01 1 1  ON 38
 eO_9                 1.980441e-01 1 1  ON 39
eH1_0                -1.705053e-01 1 1  ON 40
eH1_1                -8.409357e-02 1 1  ON 41
eH1_2                -5.348497e-02 1 1  ON 42
eH1_3                -4.183198e-02 1 1  ON 43
eH1_4                 1.303355e-02 1 1  ON 44
eH1_5                 6.124128e-02 1 1  ON 45
eH1_6                 1.071729e-01 1 1  ON 46
eH1_7                 7.332791e-02 1 1  ON 47
eH1_8                -5.715462e-03 1 1  ON 48
eH1_9                 4.539910e-02 1 1  ON 49
eH2_0                -1.714194e-01 1 1  ON 50
eH2_1                -8.408144e-02 1 1  ON 51
eH2_2                -5.319881e-02 1 1  ON 52
eH2_3                -4.160201e-02 1 1  ON 53
eH2_4                 1.338230e-02 1 1  ON 54
eH2_5                 6.135951e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387940e-02 1 1  ON 57
eH2_8                -4.747560e-03 1 1  ON 58
eH2_9                 4.702091e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.2286e+02 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root FORM.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root FORM.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -2.2816e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 27688 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.866
    reference variance = 0.254535
====================================================
  Execution time = 4.3565e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot FORM.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.1099e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 1.4977e+01
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511059872167
                                         uncertainty =       0.007332783390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.511059872167
                                         uncertainty =       0.007332783390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000505463223
  error estimate for blocks of size 2^( 2) =       0.000523664609
  error estimate for blocks of size 2^( 3) =       0.000540400875
  error estimate for blocks of size 2^( 4) =       0.000551406609
  error estimate for blocks of size 2^( 5) =       0.000558330348
  error estimate for blocks of size 2^( 6) =       0.000560601232
  error estimate for blocks of size 2^( 7) =       0.000564960131

      target function =                  N/A
              le_mean =     -22.824928593578
             les_mean =     521.488351186634
             stat err =       0.000558824580
             autocorr =       1.222283293821
              std dev =       0.714832945645
             le_variance =       0.510986140179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -2.282492859358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 60
Check correct_vf_var_size: 183, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824928593578       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824928595413       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824928596690       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824928597225       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824928598627       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824928597196       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824928598138       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824928598210       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824928597709       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824928598085       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 3.6380e+02 is 7.132763e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824928593578       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824928594037       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824928594357       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824928594490       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824928594840       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824928594482       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824928594718       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824928594739       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824928594611       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824928594705       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 1.4552e+03 is 1.784521e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -22.824928593578       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -22.824928593693       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -22.824928593773       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -22.824928593806       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -22.824928593894       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -22.824928593804       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -22.824928593870       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -22.824928593866       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -22.824928593852       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -22.824928593855       residual = 7.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 61 and evec_eigen.size(): 61
The largest weight on the derivative vector for shift 5.8208e+03 is 4.462136e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.408629 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 61 and numParams is: 60

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 5.8550e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.650045e-01 1 1  ON 0
 uu_1                 9.124413e-02 1 1  ON 1
 uu_2                -1.965928e-02 1 1  ON 2
 uu_3                -8.457349e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425301e-01 1 1  ON 5
 uu_6                -1.533764e-01 1 1  ON 6
 uu_7                -1.523288e-01 1 1  ON 7
 uu_8                -1.336242e-01 1 1  ON 8
 uu_9                -8.542047e-02 1 1  ON 9
 ud_0                 4.267598e-01 1 1  ON 10
 ud_1                 1.447308e-01 1 1  ON 11
 ud_2                -7.211151e-04 1 1  ON 12
 ud_3                -8.008378e-02 1 1  ON 13
 ud_4                -1.260440e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695591e-01 1 1  ON 16
 ud_7                -1.711986e-01 1 1  ON 17
 ud_8                -1.547521e-01 1 1  ON 18
 ud_9                -1.089882e-01 1 1  ON 19
 eC_0                -5.513137e-01 1 1  ON 20
 eC_1                -3.948843e-01 1 1  ON 21
 eC_2                -1.407271e-01 1 1  ON 22
 eC_3                 1.429544e-02 1 1  ON 23
 eC_4                 7.409382e-02 1 1  ON 24
 eC_5                 1.705490e-01 1 1  ON 25
 eC_6                 2.798036e-01 1 1  ON 26
 eC_7                 3.527786e-01 1 1  ON 27
 eC_8                 1.601769e-01 1 1  ON 28
 eC_9                 3.120869e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953046e-01 1 1  ON 31
 eO_2                -3.204574e-01 1 1  ON 32
 eO_3                 1.735535e-02 1 1  ON 33
 eO_4                 2.344857e-01 1 1  ON 34
 eO_5                 4.027255e-01 1 1  ON 35
 eO_6                 4.686427e-01 1 1  ON 36
 eO_7                 4.940481e-01 1 1  ON 37
 eO_8                 3.877799e-01 1 1  ON 38
 eO_9                 1.980442e-01 1 1  ON 39
eH1_0                -1.705054e-01 1 1  ON 40
eH1_1                -8.409359e-02 1 1  ON 41
eH1_2                -5.348493e-02 1 1  ON 42
eH1_3                -4.183200e-02 1 1  ON 43
eH1_4                 1.303359e-02 1 1  ON 44
eH1_5                 6.124134e-02 1 1  ON 45
eH1_6                 1.071730e-01 1 1  ON 46
eH1_7                 7.332790e-02 1 1  ON 47
eH1_8                -5.715472e-03 1 1  ON 48
eH1_9                 4.539906e-02 1 1  ON 49
eH2_0                -1.714194e-01 1 1  ON 50
eH2_1                -8.408146e-02 1 1  ON 51
eH2_2                -5.319879e-02 1 1  ON 52
eH2_3                -4.160207e-02 1 1  ON 53
eH2_4                 1.338228e-02 1 1  ON 54
eH2_5                 6.135953e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387945e-02 1 1  ON 57
eH2_8                -4.747570e-03 1 1  ON 58
eH2_9                 4.702087e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -22.8436
    reference variance = 0.453911
====================================================
  Execution time = 4.3102e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot FORM.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -2.2825e+01
  VMC Evar = 5.0388e-01
  Total weights = 2.0000e+06
  Execution time = 3.5312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504025672923
                                         uncertainty =       0.003864184962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504025672923
                                         uncertainty =       0.003864184962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501935907
  error estimate for blocks of size 2^( 2) =       0.000519676174
  error estimate for blocks of size 2^( 3) =       0.000535216080
  error estimate for blocks of size 2^( 4) =       0.000546314349
  error estimate for blocks of size 2^( 5) =       0.000552648909
  error estimate for blocks of size 2^( 6) =       0.000557702278
  error estimate for blocks of size 2^( 7) =       0.000560464006

      target function =                  N/A
              le_mean =     -22.824775138820
             les_mean =     521.474239195904
             stat err =       0.000554282386
             autocorr =       1.219454567016
              std dev =       0.709844567609
             le_variance =       0.503879310164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504026333469
                                         uncertainty =       0.003864189106

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504026333469
                                         uncertainty =       0.003864189106

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501936236
  error estimate for blocks of size 2^( 2) =       0.000519676481
  error estimate for blocks of size 2^( 3) =       0.000535216370
  error estimate for blocks of size 2^( 4) =       0.000546314634
  error estimate for blocks of size 2^( 5) =       0.000552649184
  error estimate for blocks of size 2^( 6) =       0.000557702554
  error estimate for blocks of size 2^( 7) =       0.000560464283

      target function =                  N/A
              le_mean =     -22.824775142722
             les_mean =     521.474240034478
             stat err =       0.000554282664
             autocorr =       1.219454192116
              std dev =       0.709845032800
             le_variance =       0.503879970591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504026003603
                                         uncertainty =       0.003864187036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504026003603
                                         uncertainty =       0.003864187036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501936072
  error estimate for blocks of size 2^( 2) =       0.000519676328
  error estimate for blocks of size 2^( 3) =       0.000535216225
  error estimate for blocks of size 2^( 4) =       0.000546314492
  error estimate for blocks of size 2^( 5) =       0.000552649047
  error estimate for blocks of size 2^( 6) =       0.000557702416
  error estimate for blocks of size 2^( 7) =       0.000560464145

      target function =                  N/A
              le_mean =     -22.824775140772
             les_mean =     521.474239615643
             stat err =       0.000554282525
             autocorr =       1.219454379359
              std dev =       0.709844800491
             le_variance =       0.503879640784

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504025714270
                                         uncertainty =       0.003864185221

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.504025714270
                                         uncertainty =       0.003864185221

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000501935928
  error estimate for blocks of size 2^( 2) =       0.000519676193
  error estimate for blocks of size 2^( 3) =       0.000535216098
  error estimate for blocks of size 2^( 4) =       0.000546314367
  error estimate for blocks of size 2^( 5) =       0.000552648926
  error estimate for blocks of size 2^( 6) =       0.000557702295
  error estimate for blocks of size 2^( 7) =       0.000560464024

      target function =                  N/A
              le_mean =     -22.824775139064
             les_mean =     521.474239248383
             stat err =       0.000554282403
             autocorr =       1.219454543544
              std dev =       0.709844596728
             le_variance =       0.503879351504


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -22.824775138820        initial
     3.6380e+02     3.6380e+03             7.1328e-07       -22.824775142722  <--
     1.4552e+03     1.4552e+04             1.7845e-07       -22.824775140772
     5.8208e+03     5.8208e+04             4.4621e-08       -22.824775139064

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 6.0770e+01
  </log>
  <optVariables href="FORM.s039.opt.xml">
 uu_0                 2.650044e-01 1 1  ON 0
 uu_1                 9.124420e-02 1 1  ON 1
 uu_2                -1.965940e-02 1 1  ON 2
 uu_3                -8.457327e-02 1 1  ON 3
 uu_4                -1.212329e-01 1 1  ON 4
 uu_5                -1.425300e-01 1 1  ON 5
 uu_6                -1.533765e-01 1 1  ON 6
 uu_7                -1.523287e-01 1 1  ON 7
 uu_8                -1.336246e-01 1 1  ON 8
 uu_9                -8.542074e-02 1 1  ON 9
 ud_0                 4.267604e-01 1 1  ON 10
 ud_1                 1.447309e-01 1 1  ON 11
 ud_2                -7.210874e-04 1 1  ON 12
 ud_3                -8.008369e-02 1 1  ON 13
 ud_4                -1.260441e-01 1 1  ON 14
 ud_5                -1.542576e-01 1 1  ON 15
 ud_6                -1.695592e-01 1 1  ON 16
 ud_7                -1.711989e-01 1 1  ON 17
 ud_8                -1.547522e-01 1 1  ON 18
 ud_9                -1.089883e-01 1 1  ON 19
 eC_0                -5.513135e-01 1 1  ON 20
 eC_1                -3.948845e-01 1 1  ON 21
 eC_2                -1.407274e-01 1 1  ON 22
 eC_3                 1.429533e-02 1 1  ON 23
 eC_4                 7.409378e-02 1 1  ON 24
 eC_5                 1.705488e-01 1 1  ON 25
 eC_6                 2.798035e-01 1 1  ON 26
 eC_7                 3.527789e-01 1 1  ON 27
 eC_8                 1.601773e-01 1 1  ON 28
 eC_9                 3.120877e-02 1 1  ON 29
 eO_0                -1.172309e+00 1 1  ON 30
 eO_1                -7.953048e-01 1 1  ON 31
 eO_2                -3.204576e-01 1 1  ON 32
 eO_3                 1.735485e-02 1 1  ON 33
 eO_4                 2.344855e-01 1 1  ON 34
 eO_5                 4.027253e-01 1 1  ON 35
 eO_6                 4.686428e-01 1 1  ON 36
 eO_7                 4.940484e-01 1 1  ON 37
 eO_8                 3.877803e-01 1 1  ON 38
 eO_9                 1.980446e-01 1 1  ON 39
eH1_0                -1.705057e-01 1 1  ON 40
eH1_1                -8.409366e-02 1 1  ON 41
eH1_2                -5.348482e-02 1 1  ON 42
eH1_3                -4.183206e-02 1 1  ON 43
eH1_4                 1.303372e-02 1 1  ON 44
eH1_5                 6.124154e-02 1 1  ON 45
eH1_6                 1.071731e-01 1 1  ON 46
eH1_7                 7.332786e-02 1 1  ON 47
eH1_8                -5.715504e-03 1 1  ON 48
eH1_9                 4.539894e-02 1 1  ON 49
eH2_0                -1.714192e-01 1 1  ON 50
eH2_1                -8.408155e-02 1 1  ON 51
eH2_2                -5.319871e-02 1 1  ON 52
eH2_3                -4.160228e-02 1 1  ON 53
eH2_4                 1.338222e-02 1 1  ON 54
eH2_5                 6.135958e-02 1 1  ON 55
eH2_6                 1.077396e-01 1 1  ON 56
eH2_7                 7.387961e-02 1 1  ON 57
eH2_8                -4.747597e-03 1 1  ON 58
eH2_9                 4.702077e-02 1 1  ON 59
  </optVariables>
eC
Array
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 1.1933e+02 secs
  Total Execution time = 4.8450e+03 secs

=========================================================
  A new xml input file : FORM.s039.cont.xml
