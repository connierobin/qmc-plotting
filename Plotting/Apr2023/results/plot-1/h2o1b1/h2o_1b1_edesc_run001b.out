Rank =    0  Free Memory = 74325 MB
Rank =    1  Free Memory = 74325 MB
Rank =    2  Free Memory = 74325 MB
Rank =    3  Free Memory = 74325 MB
Rank =    4  Free Memory = 74324 MB
Rank =    5  Free Memory = 74324 MB
Rank =    6  Free Memory = 74324 MB
Rank =    7  Free Memory = 74324 MB
Rank =    8  Free Memory = 74324 MB
Rank =    9  Free Memory = 74324 MB
Rank =   10  Free Memory = 74323 MB
Rank =   11  Free Memory = 74323 MB
Rank =   12  Free Memory = 74323 MB
Rank =   13  Free Memory = 74322 MB
Rank =   14  Free Memory = 74322 MB
Rank =   15  Free Memory = 74311 MB
Rank =   16  Free Memory = 74310 MB
Rank =   17  Free Memory = 74310 MB
Rank =   18  Free Memory = 74310 MB
Rank =   19  Free Memory = 74310 MB
Rank =   20  Free Memory = 74310 MB
Rank =   21  Free Memory = 74310 MB
Rank =   22  Free Memory = 74310 MB
Rank =   23  Free Memory = 74310 MB
Rank =   24  Free Memory = 74310 MB
Rank =   25  Free Memory = 74310 MB
Rank =   26  Free Memory = 74310 MB
Rank =   27  Free Memory = 74310 MB
Rank =   28  Free Memory = 74310 MB
Rank =   29  Free Memory = 74310 MB
Rank =   30  Free Memory = 74310 MB
Rank =   31  Free Memory = 74310 MB
Rank =   32  Free Memory = 72840 MB
Rank =   33  Free Memory = 72840 MB
Rank =   34  Free Memory = 72840 MB
Rank =   35  Free Memory = 72840 MB
Rank =   36  Free Memory = 72839 MB
Rank =   37  Free Memory = 72839 MB
Rank =   38  Free Memory = 72839 MB
Rank =   39  Free Memory = 72839 MB
Rank =   40  Free Memory = 72839 MB
Rank =   41  Free Memory = 72839 MB
Rank =   42  Free Memory = 72839 MB
Rank =   43  Free Memory = 72839 MB
Rank =   44  Free Memory = 72839 MB
Rank =   45  Free Memory = 72839 MB
Rank =   46  Free Memory = 72839 MB
Rank =   47  Free Memory = 72839 MB
Rank =   48  Free Memory = 72839 MB
Rank =   49  Free Memory = 72839 MB
Rank =   50  Free Memory = 72839 MB
Rank =   51  Free Memory = 72839 MB
Rank =   52  Free Memory = 72839 MB
Rank =   53  Free Memory = 72839 MB
Rank =   54  Free Memory = 72839 MB
Rank =   55  Free Memory = 72839 MB
Rank =   56  Free Memory = 72839 MB
Rank =   57  Free Memory = 72839 MB
Rank =   58  Free Memory = 72839 MB
Rank =   59  Free Memory = 72839 MB
Rank =   60  Free Memory = 72839 MB
Rank =   61  Free Memory = 72839 MB
Rank =   62  Free Memory = 72839 MB
Rank =   63  Free Memory = 72839 MB
Rank =   64  Free Memory = 86656 MB
Rank =   65  Free Memory = 86656 MB
Rank =   66  Free Memory = 86655 MB
Rank =   67  Free Memory = 86654 MB
Rank =   68  Free Memory = 86654 MB
Rank =   69  Free Memory = 86654 MB
Rank =   70  Free Memory = 86654 MB
Rank =   71  Free Memory = 86654 MB
Rank =   72  Free Memory = 86654 MB
Rank =   73  Free Memory = 86654 MB
Rank =   74  Free Memory = 86654 MB
Rank =   75  Free Memory = 86654 MB
Rank =   76  Free Memory = 86654 MB
Rank =   77  Free Memory = 86654 MB
Rank =   78  Free Memory = 86654 MB
Rank =   79  Free Memory = 86654 MB
Rank =   80  Free Memory = 86654 MB
Rank =   81  Free Memory = 86654 MB
Rank =   82  Free Memory = 86654 MB
Rank =   83  Free Memory = 86654 MB
Rank =   84  Free Memory = 86654 MB
Rank =   85  Free Memory = 86654 MB
Rank =   86  Free Memory = 86654 MB
Rank =   87  Free Memory = 86654 MB
Rank =   88  Free Memory = 86654 MB
Rank =   89  Free Memory = 86654 MB
Rank =   90  Free Memory = 86654 MB
Rank =   91  Free Memory = 86654 MB
Rank =   92  Free Memory = 86654 MB
Rank =   93  Free Memory = 86654 MB
Rank =   94  Free Memory = 86654 MB
Rank =   95  Free Memory = 86654 MB
Rank =   96  Free Memory = 71504 MB
Rank =   97  Free Memory = 71504 MB
Rank =   98  Free Memory = 71504 MB
Rank =   99  Free Memory = 71504 MB
Rank =  100  Free Memory = 71504 MB
Rank =  101  Free Memory = 71504 MB
Rank =  102  Free Memory = 71504 MB
Rank =  103  Free Memory = 71504 MB
Rank =  104  Free Memory = 71504 MB
Rank =  105  Free Memory = 71504 MB
Rank =  106  Free Memory = 71504 MB
Rank =  107  Free Memory = 71504 MB
Rank =  108  Free Memory = 71504 MB
Rank =  109  Free Memory = 71504 MB
Rank =  110  Free Memory = 71504 MB
Rank =  111  Free Memory = 71504 MB
Rank =  112  Free Memory = 71504 MB
Rank =  113  Free Memory = 71504 MB
Rank =  114  Free Memory = 71504 MB
Rank =  115  Free Memory = 71504 MB
Rank =  116  Free Memory = 71504 MB
Rank =  117  Free Memory = 71504 MB
Rank =  118  Free Memory = 71504 MB
Rank =  119  Free Memory = 71504 MB
Rank =  120  Free Memory = 71504 MB
Rank =  121  Free Memory = 71504 MB
Rank =  122  Free Memory = 71504 MB
Rank =  123  Free Memory = 71504 MB
Rank =  124  Free Memory = 71504 MB
Rank =  125  Free Memory = 71504 MB
Rank =  126  Free Memory = 71504 MB
Rank =  127  Free Memory = 71504 MB
  Input file(s): opt_h2o_1b1_edesc_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_edesc_run001b.xml

  Project = H2O
  date    = 2023-03-02 15:58:18 PST
  host    = n0090.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 26

  Range of prime numbers to use as seeds over processors and threads = 107-911


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.027108e-01    1         1  ON     0
     uu_1                 1.395499e-01    1         1  ON     1
     uu_2                 4.158458e-02    1         1  ON     2
     uu_3                -1.946409e-02    1         1  ON     3
     uu_4                -6.333239e-02    1         1  ON     4
     uu_5                -9.587524e-02    1         1  ON     5
     uu_6                -1.205706e-01    1         1  ON     6
     uu_7                -1.310580e-01    1         1  ON     7
     uu_8                -1.203232e-01    1         1  ON     8
     uu_9                -9.277332e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.114416e-01    1         1  ON     0
     ud_1                 1.583401e-01    1         1  ON     1
     ud_2                 6.092685e-02    1         1  ON     2
     ud_3                 2.699750e-03    1         1  ON     3
     ud_4                -5.713986e-02    1         1  ON     4
     ud_5                -1.014997e-01    1         1  ON     5
     ud_6                -1.286687e-01    1         1  ON     6
     ud_7                -1.435029e-01    1         1  ON     7
     ud_8                -1.424319e-01    1         1  ON     8
     ud_9                -1.344547e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.043100e-01    1         1  ON     0
     eO_1                -4.137154e-01    1         1  ON     1
     eO_2                -3.185752e-02    1         1  ON     2
     eO_3                 2.692030e-01    1         1  ON     3
     eO_4                 4.916456e-01    1         1  ON     4
     eO_5                 4.596091e-01    1         1  ON     5
     eO_6                 2.360353e-01    1         1  ON     6
     eO_7                -5.591968e-02    1         1  ON     7
     eO_8                -1.959242e-01    1         1  ON     8
     eO_9                -5.768884e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.099404e-01    1         1  ON     0
     eH1_1                -1.274877e-01    1         1  ON     1
     eH1_2                -8.838243e-02    1         1  ON     2
     eH1_3                -3.738645e-02    1         1  ON     3
     eH1_4                 1.159942e-02    1         1  ON     4
     eH1_5                 4.473069e-02    1         1  ON     5
     eH1_6                 9.476145e-02    1         1  ON     6
     eH1_7                 1.381756e-01    1         1  ON     7
     eH1_8                 1.456924e-01    1         1  ON     8
     eH1_9                 3.283823e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.088198e-01    1         1  ON     0
     eH2_1                -1.265485e-01    1         1  ON     1
     eH2_2                -8.741031e-02    1         1  ON     2
     eH2_3                -3.640778e-02    1         1  ON     3
     eH2_4                 1.289653e-02    1         1  ON     4
     eH2_5                 4.794967e-02    1         1  ON     5
     eH2_6                 1.006131e-01    1         1  ON     6
     eH2_7                 1.496008e-01    1         1  ON     7
     eH2_8                 1.537439e-01    1         1  ON     8
     eH2_9                 1.292423e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.073748e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.4266e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.86
    reference variance = 0.220026
====================================================
  Execution time = 2.2103e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.2230e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322277799451
                                         uncertainty =       0.003038233935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322277799451
                                         uncertainty =       0.003038233935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401434835
  error estimate for blocks of size 2^( 2) =       0.000415857601
  error estimate for blocks of size 2^( 3) =       0.000431178516
  error estimate for blocks of size 2^( 4) =       0.000445719388
  error estimate for blocks of size 2^( 5) =       0.000458081678
  error estimate for blocks of size 2^( 6) =       0.000468606281
  error estimate for blocks of size 2^( 7) =       0.000472527675

      target function =                  N/A
              le_mean =     -16.905017290980
             les_mean =     286.101909300961
             stat err =       0.000461233755
             autocorr =       1.320115877743
              std dev =       0.567714588309
             le_variance =       0.322299853779


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690501729098e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905017290980       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905271331757       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905400335968       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905464944236       residual = 2.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905551086976       residual = 5.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905577692032       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905583475615       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905596969713       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905598342429       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905598582993       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905598024628       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905598912835       residual = 4.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905598431457       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905598285314       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.267207e-02

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905017290980       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905124075155       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905182096870       residual = 3.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905202851187       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905240464433       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905244639450       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905247392686       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905247832669       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905249571364       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905249405157       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905249266782       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905249369931       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.348239e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905017290980       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905049467817       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905068003029       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905073819717       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905084667223       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905085661696       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905086557627       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905086577439       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905086905455       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905086845856       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905086848440       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.219945e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300303 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7892e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.025486e-01                 1 1 ON  0
uu_1  1.392721e-01                 1 1 ON  1
uu_2  4.119612e-02                 1 1 ON  2
uu_3  -1.919561e-02                1 1 ON  3
uu_4  -6.276764e-02                1 1 ON  4
uu_5  -9.572833e-02                1 1 ON  5
uu_6  -1.205671e-01                1 1 ON  6
uu_7  -1.311683e-01                1 1 ON  7
uu_8  -1.205968e-01                1 1 ON  8
uu_9  -9.282476e-02                1 1 ON  9
ud_0  4.149439e-01                 1 1 ON  10
ud_1  1.607698e-01                 1 1 ON  11
ud_2  5.907386e-02                 1 1 ON  12
ud_3  4.909265e-04                 1 1 ON  13
ud_4  -5.758033e-02                1 1 ON  14
ud_5  -1.016288e-01                1 1 ON  15
ud_6  -1.290333e-01                1 1 ON  16
ud_7  -1.439276e-01                1 1 ON  17
ud_8  -1.427828e-01                1 1 ON  18
ud_9  -1.345407e-01                1 1 ON  19
eO_0  -7.086582e-01                1 1 ON  20
eO_1  -4.143899e-01                1 1 ON  21
eO_2  -2.859376e-02                1 1 ON  22
eO_3  2.714602e-01                 1 1 ON  23
eO_4  4.920170e-01                 1 1 ON  24
eO_5  4.591606e-01                 1 1 ON  25
eO_6  2.359538e-01                 1 1 ON  26
eO_7  -5.591786e-02                1 1 ON  27
eO_8  -1.961201e-01                1 1 ON  28
eO_9  -5.781888e-02                1 1 ON  29
eH1_0 -2.111757e-01                1 1 ON  30
eH1_1 -1.274238e-01                1 1 ON  31
eH1_2 -8.822030e-02                1 1 ON  32
eH1_3 -3.701158e-02                1 1 ON  33
eH1_4 1.191280e-02                 1 1 ON  34
eH1_5 4.476326e-02                 1 1 ON  35
eH1_6 9.478132e-02                 1 1 ON  36
eH1_7 1.381911e-01                 1 1 ON  37
eH1_8 1.458092e-01                 1 1 ON  38
eH1_9 3.297988e-02                 1 1 ON  39
eH2_0 -2.100823e-01                1 1 ON  40
eH2_1 -1.265948e-01                1 1 ON  41
eH2_2 -8.721796e-02                1 1 ON  42
eH2_3 -3.588837e-02                1 1 ON  43
eH2_4 1.320076e-02                 1 1 ON  44
eH2_5 4.797783e-02                 1 1 ON  45
eH2_6 1.005645e-01                 1 1 ON  46
eH2_7 1.494748e-01                 1 1 ON  47
eH2_8 1.539486e-01                 1 1 ON  48
eH2_9 1.315195e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.856
    reference variance = 0.236242
====================================================
  Execution time = 2.0480e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2646e-01
  Total weights = 2.0000e+06
  Execution time = 1.9280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325618317317
                                         uncertainty =       0.003588123695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325618317317
                                         uncertainty =       0.003588123695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403434214
  error estimate for blocks of size 2^( 2) =       0.000418093527
  error estimate for blocks of size 2^( 3) =       0.000432643670
  error estimate for blocks of size 2^( 4) =       0.000446810692
  error estimate for blocks of size 2^( 5) =       0.000458135292
  error estimate for blocks of size 2^( 6) =       0.000465143128
  error estimate for blocks of size 2^( 7) =       0.000470852806

      target function =                  N/A
              le_mean =     -16.906072950337
             les_mean =     286.140820769166
             stat err =       0.000460235480
             autocorr =       1.301411792862
              std dev =       0.570542136749
             le_variance =       0.325518329806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329330062832
                                         uncertainty =       0.003692326570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329330062832
                                         uncertainty =       0.003692326570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405725419
  error estimate for blocks of size 2^( 2) =       0.000419698951
  error estimate for blocks of size 2^( 3) =       0.000433631810
  error estimate for blocks of size 2^( 4) =       0.000447454789
  error estimate for blocks of size 2^( 5) =       0.000458649868
  error estimate for blocks of size 2^( 6) =       0.000465651679
  error estimate for blocks of size 2^( 7) =       0.000471125891

      target function =                  N/A
              le_mean =     -16.906146766378
             les_mean =     286.147024552153
             stat err =       0.000460720557
             autocorr =       1.289468527909
              std dev =       0.573782389448
             le_variance =       0.329226230440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328144465030
                                         uncertainty =       0.003671898028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328144465030
                                         uncertainty =       0.003671898028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404994850
  error estimate for blocks of size 2^( 2) =       0.000419096521
  error estimate for blocks of size 2^( 3) =       0.000433153208
  error estimate for blocks of size 2^( 4) =       0.000447050287
  error estimate for blocks of size 2^( 5) =       0.000458270726
  error estimate for blocks of size 2^( 6) =       0.000465287004
  error estimate for blocks of size 2^( 7) =       0.000470814997

      target function =                  N/A
              le_mean =     -16.906099177235
             les_mean =     286.144230884092
             stat err =       0.000460355753
             autocorr =       1.292076263513
              std dev =       0.572749210046
             le_variance =       0.328041657609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325794663643
                                         uncertainty =       0.003600078839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.325794663643
                                         uncertainty =       0.003600078839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403543230
  error estimate for blocks of size 2^( 2) =       0.000418110115
  error estimate for blocks of size 2^( 3) =       0.000432581334
  error estimate for blocks of size 2^( 4) =       0.000446706452
  error estimate for blocks of size 2^( 5) =       0.000458014742
  error estimate for blocks of size 2^( 6) =       0.000465026064
  error estimate for blocks of size 2^( 7) =       0.000470710034

      target function =                  N/A
              le_mean =     -16.906051666222
             les_mean =     286.140277055316
             stat err =       0.000460114323
             autocorr =       1.300024008641
              std dev =       0.570696309092
             le_variance =       0.325694277212


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906072950337        initial
     2.5000e-01     2.5000e+00             1.2672e-02       -16.906146766378  <--
     1.0000e+00     1.0000e+01             4.3482e-03       -16.906099177235
     4.0000e+00     4.0000e+01             1.2199e-03       -16.906051666222

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0181e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.025384e-01 1 1  ON 0
 uu_1                 1.389487e-01 1 1  ON 1
 uu_2                 4.056042e-02 1 1  ON 2
 uu_3                -1.913485e-02 1 1  ON 3
 uu_4                -6.204457e-02 1 1  ON 4
 uu_5                -9.523469e-02 1 1  ON 5
 uu_6                -1.204567e-01 1 1  ON 6
 uu_7                -1.314504e-01 1 1  ON 7
 uu_8                -1.213658e-01 1 1  ON 8
 uu_9                -9.300856e-02 1 1  ON 9
 ud_0                 4.212155e-01 1 1  ON 10
 ud_1                 1.642435e-01 1 1  ON 11
 ud_2                 5.738065e-02 1 1  ON 12
 ud_3                -3.236070e-03 1 1  ON 13
 ud_4                -5.922509e-02 1 1  ON 14
 ud_5                -1.020057e-01 1 1  ON 15
 ud_6                -1.294822e-01 1 1  ON 16
 ud_7                -1.446378e-01 1 1  ON 17
 ud_8                -1.435492e-01 1 1  ON 18
 ud_9                -1.347211e-01 1 1  ON 19
 eO_0                -7.169821e-01 1 1  ON 20
 eO_1                -4.164460e-01 1 1  ON 21
 eO_2                -2.361412e-02 1 1  ON 22
 eO_3                 2.764988e-01 1 1  ON 23
 eO_4                 4.939282e-01 1 1  ON 24
 eO_5                 4.587015e-01 1 1  ON 25
 eO_6                 2.357986e-01 1 1  ON 26
 eO_7                -5.588460e-02 1 1  ON 27
 eO_8                -1.966643e-01 1 1  ON 28
 eO_9                -5.819731e-02 1 1  ON 29
eH1_0                -2.140302e-01 1 1  ON 30
eH1_1                -1.276156e-01 1 1  ON 31
eH1_2                -8.768304e-02 1 1  ON 32
eH1_3                -3.637653e-02 1 1  ON 33
eH1_4                 1.242825e-02 1 1  ON 34
eH1_5                 4.496675e-02 1 1  ON 35
eH1_6                 9.503092e-02 1 1  ON 36
eH1_7                 1.383102e-01 1 1  ON 37
eH1_8                 1.461730e-01 1 1  ON 38
eH1_9                 3.341270e-02 1 1  ON 39
eH2_0                -2.130170e-01 1 1  ON 40
eH2_1                -1.269247e-01 1 1  ON 41
eH2_2                -8.661488e-02 1 1  ON 42
eH2_3                -3.500565e-02 1 1  ON 43
eH2_4                 1.376588e-02 1 1  ON 44
eH2_5                 4.815886e-02 1 1  ON 45
eH2_6                 1.006047e-01 1 1  ON 46
eH2_7                 1.491657e-01 1 1  ON 47
eH2_8                 1.545485e-01 1 1  ON 48
eH2_9                 1.383070e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8088e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6858e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9075
    reference variance = 0.197136
====================================================
  Execution time = 2.0849e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2374e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323719981032
                                         uncertainty =       0.002785604452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323719981032
                                         uncertainty =       0.002785604452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402329847
  error estimate for blocks of size 2^( 2) =       0.000416051516
  error estimate for blocks of size 2^( 3) =       0.000429755039
  error estimate for blocks of size 2^( 4) =       0.000442772791
  error estimate for blocks of size 2^( 5) =       0.000455552939
  error estimate for blocks of size 2^( 6) =       0.000464807975
  error estimate for blocks of size 2^( 7) =       0.000474015094

      target function =                  N/A
              le_mean =     -16.905811476022
             les_mean =     286.130200112594
             stat err =       0.000459287200
             autocorr =       1.303179318833
              std dev =       0.568980326262
             le_variance =       0.323738611673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581147602e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811476022       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905892137619       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905967443503       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906043945320       residual = 1.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906099782435       residual = 3.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906141758056       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906158325694       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906155191168       residual = 6.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906167298788       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906169891917       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906178917514       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906180219363       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906177575253       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906177187853       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906177282569       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906177799096       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906178340391       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.917950e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811476022       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905862317959       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905906474603       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905935544949       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905980666719       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905999836847       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906001327312       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906003142102       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906001946567       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906004317967       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906004522537       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906004799188       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906004287333       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 8.134610e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811476022       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905831986976       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905849600085       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905856524975       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905875402179       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905880746298       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905881110075       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905881316924       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905881266970       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905881468362       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905881313440       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.635015e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.306849 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6375e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.027012e-01 1 1  ON 0
 uu_1                 1.385191e-01 1 1  ON 1
 uu_2                 3.971882e-02 1 1  ON 2
 uu_3                -1.948159e-02 1 1  ON 3
 uu_4                -6.182132e-02 1 1  ON 4
 uu_5                -9.473437e-02 1 1  ON 5
 uu_6                -1.203524e-01 1 1  ON 6
 uu_7                -1.316163e-01 1 1  ON 7
 uu_8                -1.219450e-01 1 1  ON 8
 uu_9                -9.295459e-02 1 1  ON 9
 ud_0                 4.271352e-01 1 1  ON 10
 ud_1                 1.672274e-01 1 1  ON 11
 ud_2                 5.627792e-02 1 1  ON 12
 ud_3                -6.596410e-03 1 1  ON 13
 ud_4                -6.124071e-02 1 1  ON 14
 ud_5                -1.026817e-01 1 1  ON 15
 ud_6                -1.297896e-01 1 1  ON 16
 ud_7                -1.453857e-01 1 1  ON 17
 ud_8                -1.440941e-01 1 1  ON 18
 ud_9                -1.346800e-01 1 1  ON 19
 eO_0                -7.251167e-01 1 1  ON 20
 eO_1                -4.192630e-01 1 1  ON 21
 eO_2                -1.949423e-02 1 1  ON 22
 eO_3                 2.818231e-01 1 1  ON 23
 eO_4                 4.965267e-01 1 1  ON 24
 eO_5                 4.587341e-01 1 1  ON 25
 eO_6                 2.355231e-01 1 1  ON 26
 eO_7                -5.577034e-02 1 1  ON 27
 eO_8                -1.971622e-01 1 1  ON 28
 eO_9                -5.859477e-02 1 1  ON 29
eH1_0                -2.173971e-01 1 1  ON 30
eH1_1                -1.282723e-01 1 1  ON 31
eH1_2                -8.721423e-02 1 1  ON 32
eH1_3                -3.563156e-02 1 1  ON 33
eH1_4                 1.275556e-02 1 1  ON 34
eH1_5                 4.499183e-02 1 1  ON 35
eH1_6                 9.486080e-02 1 1  ON 36
eH1_7                 1.387593e-01 1 1  ON 37
eH1_8                 1.472996e-01 1 1  ON 38
eH1_9                 3.428853e-02 1 1  ON 39
eH2_0                -2.161861e-01 1 1  ON 40
eH2_1                -1.270923e-01 1 1  ON 41
eH2_2                -8.568670e-02 1 1  ON 42
eH2_3                -3.401949e-02 1 1  ON 43
eH2_4                 1.426241e-02 1 1  ON 44
eH2_5                 4.867278e-02 1 1  ON 45
eH2_6                 1.004545e-01 1 1  ON 46
eH2_7                 1.484707e-01 1 1  ON 47
eH2_8                 1.549661e-01 1 1  ON 48
eH2_9                 1.463636e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8976
    reference variance = 0.238213
====================================================
  Execution time = 2.0168e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3423e-01
  Total weights = 2.0000e+06
  Execution time = 1.8952e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330502707103
                                         uncertainty =       0.003368605662

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330502707103
                                         uncertainty =       0.003368605662

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406589728
  error estimate for blocks of size 2^( 2) =       0.000420129893
  error estimate for blocks of size 2^( 3) =       0.000434362193
  error estimate for blocks of size 2^( 4) =       0.000447622255
  error estimate for blocks of size 2^( 5) =       0.000458345839
  error estimate for blocks of size 2^( 6) =       0.000466004895
  error estimate for blocks of size 2^( 7) =       0.000469744311

      target function =                  N/A
              le_mean =     -16.906179693404
             les_mean =     286.149542073886
             stat err =       0.000460429325
             autocorr =       1.282369406595
              std dev =       0.575004707390
             le_variance =       0.330630413521

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337741181177
                                         uncertainty =       0.003464495837

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337741181177
                                         uncertainty =       0.003464495837

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411018178
  error estimate for blocks of size 2^( 2) =       0.000424102771
  error estimate for blocks of size 2^( 3) =       0.000437909254
  error estimate for blocks of size 2^( 4) =       0.000450850462
  error estimate for blocks of size 2^( 5) =       0.000461336689
  error estimate for blocks of size 2^( 6) =       0.000468818660
  error estimate for blocks of size 2^( 7) =       0.000472517871

      target function =                  N/A
              le_mean =     -16.906136307826
             les_mean =     286.155316575805
             stat err =       0.000463380920
             autocorr =       1.271025417165
              std dev =       0.581267482265
             le_variance =       0.337871885939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338500010488
                                         uncertainty =       0.003469293969

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338500010488
                                         uncertainty =       0.003469293969

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411479555
  error estimate for blocks of size 2^( 2) =       0.000424536113
  error estimate for blocks of size 2^( 3) =       0.000438334255
  error estimate for blocks of size 2^( 4) =       0.000451272837
  error estimate for blocks of size 2^( 5) =       0.000461749548
  error estimate for blocks of size 2^( 6) =       0.000469229455
  error estimate for blocks of size 2^( 7) =       0.000472962663

      target function =                  N/A
              le_mean =     -16.906157449620
             les_mean =     286.156790390717
             stat err =       0.000463803626
             autocorr =       1.270491476069
              std dev =       0.581919967592
             le_variance =       0.338630848682

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331791613527
                                         uncertainty =       0.003387012677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331791613527
                                         uncertainty =       0.003387012677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407381813
  error estimate for blocks of size 2^( 2) =       0.000420810899
  error estimate for blocks of size 2^( 3) =       0.000434948997
  error estimate for blocks of size 2^( 4) =       0.000448143613
  error estimate for blocks of size 2^( 5) =       0.000458817110
  error estimate for blocks of size 2^( 6) =       0.000466442773
  error estimate for blocks of size 2^( 7) =       0.000470182003

      target function =                  N/A
              le_mean =     -16.906131621226
             les_mean =     286.149206111039
             stat err =       0.000460896375
             autocorr =       1.279980376313
              std dev =       0.576124884701
             le_variance =       0.331919882772


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906179693404        initial  <--
     6.2500e-02     6.2500e-01             1.9180e-02       -16.906136307826
     2.5000e-01     2.5000e+00             8.1346e-03       -16.906157449620
     1.0000e+00     1.0000e+01             2.6350e-03       -16.906131621226

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7296
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.025384e-01 1 1  ON 0
 uu_1                 1.389487e-01 1 1  ON 1
 uu_2                 4.056042e-02 1 1  ON 2
 uu_3                -1.913485e-02 1 1  ON 3
 uu_4                -6.204457e-02 1 1  ON 4
 uu_5                -9.523469e-02 1 1  ON 5
 uu_6                -1.204567e-01 1 1  ON 6
 uu_7                -1.314504e-01 1 1  ON 7
 uu_8                -1.213658e-01 1 1  ON 8
 uu_9                -9.300856e-02 1 1  ON 9
 ud_0                 4.212155e-01 1 1  ON 10
 ud_1                 1.642435e-01 1 1  ON 11
 ud_2                 5.738065e-02 1 1  ON 12
 ud_3                -3.236070e-03 1 1  ON 13
 ud_4                -5.922509e-02 1 1  ON 14
 ud_5                -1.020057e-01 1 1  ON 15
 ud_6                -1.294822e-01 1 1  ON 16
 ud_7                -1.446378e-01 1 1  ON 17
 ud_8                -1.435492e-01 1 1  ON 18
 ud_9                -1.347211e-01 1 1  ON 19
 eO_0                -7.169821e-01 1 1  ON 20
 eO_1                -4.164460e-01 1 1  ON 21
 eO_2                -2.361412e-02 1 1  ON 22
 eO_3                 2.764988e-01 1 1  ON 23
 eO_4                 4.939282e-01 1 1  ON 24
 eO_5                 4.587015e-01 1 1  ON 25
 eO_6                 2.357986e-01 1 1  ON 26
 eO_7                -5.588460e-02 1 1  ON 27
 eO_8                -1.966643e-01 1 1  ON 28
 eO_9                -5.819731e-02 1 1  ON 29
eH1_0                -2.140302e-01 1 1  ON 30
eH1_1                -1.276156e-01 1 1  ON 31
eH1_2                -8.768304e-02 1 1  ON 32
eH1_3                -3.637653e-02 1 1  ON 33
eH1_4                 1.242825e-02 1 1  ON 34
eH1_5                 4.496675e-02 1 1  ON 35
eH1_6                 9.503092e-02 1 1  ON 36
eH1_7                 1.383102e-01 1 1  ON 37
eH1_8                 1.461730e-01 1 1  ON 38
eH1_9                 3.341270e-02 1 1  ON 39
eH2_0                -2.130170e-01 1 1  ON 40
eH2_1                -1.269247e-01 1 1  ON 41
eH2_2                -8.661488e-02 1 1  ON 42
eH2_3                -3.500565e-02 1 1  ON 43
eH2_4                 1.376588e-02 1 1  ON 44
eH2_5                 4.815886e-02 1 1  ON 45
eH2_6                 1.006047e-01 1 1  ON 46
eH2_7                 1.491657e-01 1 1  ON 47
eH2_8                 1.545485e-01 1 1  ON 48
eH2_9                 1.383070e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6110e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6880e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 0.385331
====================================================
  Execution time = 2.0609e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2388e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323917679046
                                         uncertainty =       0.005064640931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323917679046
                                         uncertainty =       0.005064640931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000402419774
  error estimate for blocks of size 2^( 2) =       0.000415708029
  error estimate for blocks of size 2^( 3) =       0.000429686299
  error estimate for blocks of size 2^( 4) =       0.000442696564
  error estimate for blocks of size 2^( 5) =       0.000453719199
  error estimate for blocks of size 2^( 6) =       0.000462141472
  error estimate for blocks of size 2^( 7) =       0.000467977220

      target function =                  N/A
              le_mean =     -16.906224005669
             les_mean =     286.144293316921
             stat err =       0.000456633614
             autocorr =       1.287588620761
              std dev =       0.569107502160
             le_variance =       0.323883349014


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622400567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906224005669       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906246659533       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272410796       residual = 8.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906281689277       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906300709170       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906302534085       residual = 7.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906305896125       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906306349843       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906306242210       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906306448873       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906306730626       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906306764614       residual = 1.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 4.020899e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906224005669       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906231202282       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906239851646       residual = 9.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906242218472       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906247969377       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906248562229       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906249187738       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906249316718       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906249280629       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906249304242       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906249323103       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.151902e-03

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906224005669       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906225935421       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906228306262       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906228909910       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906230406536       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906230585637       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906230741156       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906230728713       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906230734882       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906230740484       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.997316e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6153e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.025990e-01 1 1  ON 0
 uu_1                 1.388654e-01 1 1  ON 1
 uu_2                 4.044969e-02 1 1  ON 2
 uu_3                -1.913498e-02 1 1  ON 3
 uu_4                -6.196011e-02 1 1  ON 4
 uu_5                -9.511799e-02 1 1  ON 5
 uu_6                -1.204586e-01 1 1  ON 6
 uu_7                -1.314754e-01 1 1  ON 7
 uu_8                -1.214785e-01 1 1  ON 8
 uu_9                -9.305676e-02 1 1  ON 9
 ud_0                 4.221649e-01 1 1  ON 10
 ud_1                 1.647785e-01 1 1  ON 11
 ud_2                 5.710873e-02 1 1  ON 12
 ud_3                -3.788199e-03 1 1  ON 13
 ud_4                -5.945986e-02 1 1  ON 14
 ud_5                -1.020953e-01 1 1  ON 15
 ud_6                -1.295827e-01 1 1  ON 16
 ud_7                -1.447288e-01 1 1  ON 17
 ud_8                -1.436519e-01 1 1  ON 18
 ud_9                -1.347555e-01 1 1  ON 19
 eO_0                -7.181340e-01 1 1  ON 20
 eO_1                -4.167498e-01 1 1  ON 21
 eO_2                -2.288313e-02 1 1  ON 22
 eO_3                 2.772012e-01 1 1  ON 23
 eO_4                 4.941994e-01 1 1  ON 24
 eO_5                 4.586262e-01 1 1  ON 25
 eO_6                 2.357602e-01 1 1  ON 26
 eO_7                -5.588054e-02 1 1  ON 27
 eO_8                -1.967455e-01 1 1  ON 28
 eO_9                -5.825039e-02 1 1  ON 29
eH1_0                -2.144284e-01 1 1  ON 30
eH1_1                -1.276297e-01 1 1  ON 31
eH1_2                -8.762881e-02 1 1  ON 32
eH1_3                -3.623183e-02 1 1  ON 33
eH1_4                 1.250028e-02 1 1  ON 34
eH1_5                 4.496113e-02 1 1  ON 35
eH1_6                 9.502540e-02 1 1  ON 36
eH1_7                 1.383439e-01 1 1  ON 37
eH1_8                 1.462381e-01 1 1  ON 38
eH1_9                 3.346789e-02 1 1  ON 39
eH2_0                -2.134465e-01 1 1  ON 40
eH2_1                -1.269758e-01 1 1  ON 41
eH2_2                -8.654018e-02 1 1  ON 42
eH2_3                -3.487220e-02 1 1  ON 43
eH2_4                 1.383478e-02 1 1  ON 44
eH2_5                 4.824885e-02 1 1  ON 45
eH2_6                 1.006073e-01 1 1  ON 46
eH2_7                 1.491246e-01 1 1  ON 47
eH2_8                 1.546014e-01 1 1  ON 48
eH2_9                 1.391661e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8847
    reference variance = 0.222832
====================================================
  Execution time = 2.0328e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2189e-01
  Total weights = 2.0000e+06
  Execution time = 1.8848e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321411587336
                                         uncertainty =       0.002713592767

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321411587336
                                         uncertainty =       0.002713592767

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400845382
  error estimate for blocks of size 2^( 2) =       0.000414596049
  error estimate for blocks of size 2^( 3) =       0.000428881897
  error estimate for blocks of size 2^( 4) =       0.000443273157
  error estimate for blocks of size 2^( 5) =       0.000456733637
  error estimate for blocks of size 2^( 6) =       0.000467004645
  error estimate for blocks of size 2^( 7) =       0.000472949241

      target function =                  N/A
              le_mean =     -16.905790159460
             les_mean =     286.127094795898
             stat err =       0.000459990170
             autocorr =       1.316871298994
              std dev =       0.566880975939
             le_variance =       0.321354040882

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323227257451
                                         uncertainty =       0.002736157289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323227257451
                                         uncertainty =       0.002736157289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401975440
  error estimate for blocks of size 2^( 2) =       0.000415555433
  error estimate for blocks of size 2^( 3) =       0.000429695640
  error estimate for blocks of size 2^( 4) =       0.000443991533
  error estimate for blocks of size 2^( 5) =       0.000457392980
  error estimate for blocks of size 2^( 6) =       0.000467606352
  error estimate for blocks of size 2^( 7) =       0.000473517344

      target function =                  N/A
              le_mean =     -16.905810338234
             les_mean =     286.129591539608
             stat err =       0.000460627052
             autocorr =       1.313106168908
              std dev =       0.568479119090
             le_variance =       0.323168508841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322506698748
                                         uncertainty =       0.002726601018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322506698748
                                         uncertainty =       0.002726601018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401527379
  error estimate for blocks of size 2^( 2) =       0.000415169550
  error estimate for blocks of size 2^( 3) =       0.000429363749
  error estimate for blocks of size 2^( 4) =       0.000443694921
  error estimate for blocks of size 2^( 5) =       0.000457119855
  error estimate for blocks of size 2^( 6) =       0.000467356109
  error estimate for blocks of size 2^( 7) =       0.000473281497

      target function =                  N/A
              le_mean =     -16.905799456013
             les_mean =     286.128503558149
             stat err =       0.000460363096
             autocorr =       1.314530524720
              std dev =       0.567845465291
             le_variance =       0.322448472451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321551440758
                                         uncertainty =       0.002715278056

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.321551440758
                                         uncertainty =       0.002715278056

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000400932542
  error estimate for blocks of size 2^( 2) =       0.000414668248
  error estimate for blocks of size 2^( 3) =       0.000428941540
  error estimate for blocks of size 2^( 4) =       0.000443324614
  error estimate for blocks of size 2^( 5) =       0.000456780367
  error estimate for blocks of size 2^( 6) =       0.000467046808
  error estimate for blocks of size 2^( 7) =       0.000472988935

      target function =                  N/A
              le_mean =     -16.905790461861
             les_mean =     286.127244786384
             stat err =       0.000460035181
             autocorr =       1.316556422267
              std dev =       0.567004238756
             le_variance =       0.321493806767


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905790159460        initial
     6.2500e-01     6.2500e+00             4.0209e-03       -16.905810338234  <--
     2.5000e+00     2.5000e+01             1.1519e-03       -16.905799456013
     1.0000e+01     1.0000e+02             2.9973e-04       -16.905790461861

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9811e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.027813e-01 1 1  ON 0
 uu_1                 1.387180e-01 1 1  ON 1
 uu_2                 4.019761e-02 1 1  ON 2
 uu_3                -1.920688e-02 1 1  ON 3
 uu_4                -6.180918e-02 1 1  ON 4
 uu_5                -9.483029e-02 1 1  ON 5
 uu_6                -1.204301e-01 1 1  ON 6
 uu_7                -1.315411e-01 1 1  ON 7
 uu_8                -1.218032e-01 1 1  ON 8
 uu_9                -9.320206e-02 1 1  ON 9
 ud_0                 4.243934e-01 1 1  ON 10
 ud_1                 1.659456e-01 1 1  ON 11
 ud_2                 5.670358e-02 1 1  ON 12
 ud_3                -5.040197e-03 1 1  ON 13
 ud_4                -6.016096e-02 1 1  ON 14
 ud_5                -1.023465e-01 1 1  ON 15
 ud_6                -1.297938e-01 1 1  ON 16
 ud_7                -1.449351e-01 1 1  ON 17
 ud_8                -1.439150e-01 1 1  ON 18
 ud_9                -1.348442e-01 1 1  ON 19
 eO_0                -7.210030e-01 1 1  ON 20
 eO_1                -4.176332e-01 1 1  ON 21
 eO_2                -2.128341e-02 1 1  ON 22
 eO_3                 2.790431e-01 1 1  ON 23
 eO_4                 4.950908e-01 1 1  ON 24
 eO_5                 4.585311e-01 1 1  ON 25
 eO_6                 2.356653e-01 1 1  ON 26
 eO_7                -5.586371e-02 1 1  ON 27
 eO_8                -1.969811e-01 1 1  ON 28
 eO_9                -5.840755e-02 1 1  ON 29
eH1_0                -2.154984e-01 1 1  ON 30
eH1_1                -1.277168e-01 1 1  ON 31
eH1_2                -8.746324e-02 1 1  ON 32
eH1_3                -3.588260e-02 1 1  ON 33
eH1_4                 1.266654e-02 1 1  ON 34
eH1_5                 4.495677e-02 1 1  ON 35
eH1_6                 9.503683e-02 1 1  ON 36
eH1_7                 1.384530e-01 1 1  ON 37
eH1_8                 1.464348e-01 1 1  ON 38
eH1_9                 3.363538e-02 1 1  ON 39
eH2_0                -2.146051e-01 1 1  ON 40
eH2_1                -1.271449e-01 1 1  ON 41
eH2_2                -8.634036e-02 1 1  ON 42
eH2_3                -3.454666e-02 1 1  ON 43
eH2_4                 1.399561e-02 1 1  ON 44
eH2_5                 4.850032e-02 1 1  ON 45
eH2_6                 1.006461e-01 1 1  ON 46
eH2_7                 1.490183e-01 1 1  ON 47
eH2_8                 1.547608e-01 1 1  ON 48
eH2_9                 1.417475e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5990e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6885e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9092
    reference variance = 0.29255
====================================================
  Execution time = 2.0852e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2258e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322631451590
                                         uncertainty =       0.002301416976

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.322631451590
                                         uncertainty =       0.002301416976

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401610684
  error estimate for blocks of size 2^( 2) =       0.000415217620
  error estimate for blocks of size 2^( 3) =       0.000428954197
  error estimate for blocks of size 2^( 4) =       0.000441835853
  error estimate for blocks of size 2^( 5) =       0.000452355095
  error estimate for blocks of size 2^( 6) =       0.000460923208
  error estimate for blocks of size 2^( 7) =       0.000465044522

      target function =                  N/A
              le_mean =     -16.906647237969
             les_mean =     286.157302950709
             stat err =       0.000455039670
             autocorr =       1.283772307753
              std dev =       0.567963275983
             le_variance =       0.322582282866


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690664723797e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906647237969       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906693191943       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906731673860       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906763348875       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906771289745       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906782499706       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906790875377       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906794223330       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906793782392       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906794938143       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906795323212       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906794766071       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906795207065       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906795240462       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 9.463998e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906647237969       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906668326038       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906686142210       residual = 4.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906694407789       residual = 7.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906700440438       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906703656653       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906705172026       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906705999575       residual = 6.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906705571586       residual = 7.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906705693967       residual = 3.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906705805858       residual = 9.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.329352e-03

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906647237969       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906653902072       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906659672318       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906661566097       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906663628947       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906664419527       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906664719363       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906664828178       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906664694596       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906664732687       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.553686e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315795 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6467e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.028979e-01 1 1  ON 0
 uu_1                 1.386403e-01 1 1  ON 1
 uu_2                 4.002189e-02 1 1  ON 2
 uu_3                -1.925775e-02 1 1  ON 3
 uu_4                -6.154223e-02 1 1  ON 4
 uu_5                -9.460844e-02 1 1  ON 5
 uu_6                -1.203127e-01 1 1  ON 6
 uu_7                -1.316564e-01 1 1  ON 7
 uu_8                -1.222001e-01 1 1  ON 8
 uu_9                -9.343791e-02 1 1  ON 9
 ud_0                 4.268792e-01 1 1  ON 10
 ud_1                 1.671959e-01 1 1  ON 11
 ud_2                 5.639291e-02 1 1  ON 12
 ud_3                -6.382479e-03 1 1  ON 13
 ud_4                -6.098509e-02 1 1  ON 14
 ud_5                -1.025465e-01 1 1  ON 15
 ud_6                -1.298438e-01 1 1  ON 16
 ud_7                -1.450796e-01 1 1  ON 17
 ud_8                -1.444479e-01 1 1  ON 18
 ud_9                -1.350661e-01 1 1  ON 19
 eO_0                -7.243323e-01 1 1  ON 20
 eO_1                -4.186233e-01 1 1  ON 21
 eO_2                -1.962414e-02 1 1  ON 22
 eO_3                 2.813535e-01 1 1  ON 23
 eO_4                 4.961485e-01 1 1  ON 24
 eO_5                 4.584747e-01 1 1  ON 25
 eO_6                 2.356051e-01 1 1  ON 26
 eO_7                -5.579346e-02 1 1  ON 27
 eO_8                -1.973740e-01 1 1  ON 28
 eO_9                -5.864686e-02 1 1  ON 29
eH1_0                -2.167933e-01 1 1  ON 30
eH1_1                -1.279405e-01 1 1  ON 31
eH1_2                -8.735652e-02 1 1  ON 32
eH1_3                -3.547885e-02 1 1  ON 33
eH1_4                 1.288757e-02 1 1  ON 34
eH1_5                 4.521143e-02 1 1  ON 35
eH1_6                 9.520052e-02 1 1  ON 36
eH1_7                 1.384332e-01 1 1  ON 37
eH1_8                 1.465909e-01 1 1  ON 38
eH1_9                 3.382875e-02 1 1  ON 39
eH2_0                -2.159627e-01 1 1  ON 40
eH2_1                -1.272015e-01 1 1  ON 41
eH2_2                -8.603049e-02 1 1  ON 42
eH2_3                -3.421923e-02 1 1  ON 43
eH2_4                 1.420816e-02 1 1  ON 44
eH2_5                 4.856920e-02 1 1  ON 45
eH2_6                 1.005243e-01 1 1  ON 46
eH2_7                 1.489773e-01 1 1  ON 47
eH2_8                 1.551332e-01 1 1  ON 48
eH2_9                 1.450860e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9103
    reference variance = 0.223057
====================================================
  Execution time = 2.0725e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3512e-01
  Total weights = 2.0000e+06
  Execution time = 1.8969e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333666295487
                                         uncertainty =       0.004414725516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333666295487
                                         uncertainty =       0.004414725516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408406124
  error estimate for blocks of size 2^( 2) =       0.000421668640
  error estimate for blocks of size 2^( 3) =       0.000434890358
  error estimate for blocks of size 2^( 4) =       0.000448048599
  error estimate for blocks of size 2^( 5) =       0.000459269939
  error estimate for blocks of size 2^( 6) =       0.000468250319
  error estimate for blocks of size 2^( 7) =       0.000475919369

      target function =                  N/A
              le_mean =     -16.906302699768
             les_mean =     286.156661933707
             stat err =       0.000462872057
             autocorr =       1.284509839561
              std dev =       0.577573479585
             le_variance =       0.333591124320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337503629722
                                         uncertainty =       0.004482179894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337503629722
                                         uncertainty =       0.004482179894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410747619
  error estimate for blocks of size 2^( 2) =       0.000423772598
  error estimate for blocks of size 2^( 3) =       0.000436734049
  error estimate for blocks of size 2^( 4) =       0.000449726457
  error estimate for blocks of size 2^( 5) =       0.000460825476
  error estimate for blocks of size 2^( 6) =       0.000469781578
  error estimate for blocks of size 2^( 7) =       0.000477506462

      target function =                  N/A
              le_mean =     -16.906297919554
             les_mean =     286.160336388896
             stat err =       0.000464459993
             autocorr =       1.278634781100
              std dev =       0.580884853383
             le_variance =       0.337427212890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336865607148
                                         uncertainty =       0.004468977700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336865607148
                                         uncertainty =       0.004468977700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410359288
  error estimate for blocks of size 2^( 2) =       0.000423418487
  error estimate for blocks of size 2^( 3) =       0.000436426683
  error estimate for blocks of size 2^( 4) =       0.000449451854
  error estimate for blocks of size 2^( 5) =       0.000460574736
  error estimate for blocks of size 2^( 6) =       0.000469530318
  error estimate for blocks of size 2^( 7) =       0.000477238832

      target function =                  N/A
              le_mean =     -16.906290416373
             les_mean =     286.159444964389
             stat err =       0.000464198935
             autocorr =       1.279616246215
              std dev =       0.580335670140
             le_variance =       0.336789490037

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334128790553
                                         uncertainty =       0.004422835870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334128790553
                                         uncertainty =       0.004422835870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408689048
  error estimate for blocks of size 2^( 2) =       0.000421917371
  error estimate for blocks of size 2^( 3) =       0.000435104557
  error estimate for blocks of size 2^( 4) =       0.000448241549
  error estimate for blocks of size 2^( 5) =       0.000459447614
  error estimate for blocks of size 2^( 6) =       0.000468423469
  error estimate for blocks of size 2^( 7) =       0.000476097800

      target function =                  N/A
              le_mean =     -16.906294813874
             les_mean =     286.156857643015
             stat err =       0.000463052608
             autocorr =       1.283732892316
              std dev =       0.577973594929
             le_variance =       0.334053476436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906302699768        initial  <--
     1.5625e-01     1.5625e+00             9.4640e-03       -16.906297919554
     6.2500e-01     6.2500e+00             3.3294e-03       -16.906290416373
     2.5000e+00     2.5000e+01             9.5537e-04       -16.906294813874

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2290
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.027813e-01 1 1  ON 0
 uu_1                 1.387180e-01 1 1  ON 1
 uu_2                 4.019761e-02 1 1  ON 2
 uu_3                -1.920688e-02 1 1  ON 3
 uu_4                -6.180918e-02 1 1  ON 4
 uu_5                -9.483029e-02 1 1  ON 5
 uu_6                -1.204301e-01 1 1  ON 6
 uu_7                -1.315411e-01 1 1  ON 7
 uu_8                -1.218032e-01 1 1  ON 8
 uu_9                -9.320206e-02 1 1  ON 9
 ud_0                 4.243934e-01 1 1  ON 10
 ud_1                 1.659456e-01 1 1  ON 11
 ud_2                 5.670358e-02 1 1  ON 12
 ud_3                -5.040197e-03 1 1  ON 13
 ud_4                -6.016096e-02 1 1  ON 14
 ud_5                -1.023465e-01 1 1  ON 15
 ud_6                -1.297938e-01 1 1  ON 16
 ud_7                -1.449351e-01 1 1  ON 17
 ud_8                -1.439150e-01 1 1  ON 18
 ud_9                -1.348442e-01 1 1  ON 19
 eO_0                -7.210030e-01 1 1  ON 20
 eO_1                -4.176332e-01 1 1  ON 21
 eO_2                -2.128341e-02 1 1  ON 22
 eO_3                 2.790431e-01 1 1  ON 23
 eO_4                 4.950908e-01 1 1  ON 24
 eO_5                 4.585311e-01 1 1  ON 25
 eO_6                 2.356653e-01 1 1  ON 26
 eO_7                -5.586371e-02 1 1  ON 27
 eO_8                -1.969811e-01 1 1  ON 28
 eO_9                -5.840755e-02 1 1  ON 29
eH1_0                -2.154984e-01 1 1  ON 30
eH1_1                -1.277168e-01 1 1  ON 31
eH1_2                -8.746324e-02 1 1  ON 32
eH1_3                -3.588260e-02 1 1  ON 33
eH1_4                 1.266654e-02 1 1  ON 34
eH1_5                 4.495677e-02 1 1  ON 35
eH1_6                 9.503683e-02 1 1  ON 36
eH1_7                 1.384530e-01 1 1  ON 37
eH1_8                 1.464348e-01 1 1  ON 38
eH1_9                 3.363538e-02 1 1  ON 39
eH2_0                -2.146051e-01 1 1  ON 40
eH2_1                -1.271449e-01 1 1  ON 41
eH2_2                -8.634036e-02 1 1  ON 42
eH2_3                -3.454666e-02 1 1  ON 43
eH2_4                 1.399561e-02 1 1  ON 44
eH2_5                 4.850032e-02 1 1  ON 45
eH2_6                 1.006461e-01 1 1  ON 46
eH2_7                 1.490183e-01 1 1  ON 47
eH2_8                 1.547608e-01 1 1  ON 48
eH2_9                 1.417475e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6703e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8649
    reference variance = 0.21821
====================================================
  Execution time = 2.2666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2812e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5066e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328178982717
                                         uncertainty =       0.003592105736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328178982717
                                         uncertainty =       0.003592105736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405042236
  error estimate for blocks of size 2^( 2) =       0.000418674417
  error estimate for blocks of size 2^( 3) =       0.000433002184
  error estimate for blocks of size 2^( 4) =       0.000447587494
  error estimate for blocks of size 2^( 5) =       0.000462157633
  error estimate for blocks of size 2^( 6) =       0.000472776036
  error estimate for blocks of size 2^( 7) =       0.000480639598

      target function =                  N/A
              le_mean =     -16.906094633165
             les_mean =     286.144154007927
             stat err =       0.000465790190
             autocorr =       1.322452405129
              std dev =       0.572816223986
             le_variance =       0.328118426462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690609463316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094633165       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906102650993       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906106590453       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906109634177       residual = 5.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906115966357       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906116125212       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906116322150       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906116411193       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906116350268       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906116312738       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906116335122       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.507171e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094633165       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906096852296       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906097989189       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906098719642       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906100513016       residual = 7.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906100522277       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906100534499       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906100554130       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906100526931       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906100526427       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.996851e-04

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906094633165       residual = 1.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906095203210       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906095499054       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906095680124       residual = 5.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906096142604       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906096143093       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906096143730       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906096148321       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906096140919       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.014281e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.319365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8180e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.027825e-01 1 1  ON 0
 uu_1                 1.387041e-01 1 1  ON 1
 uu_2                 4.016363e-02 1 1  ON 2
 uu_3                -1.921309e-02 1 1  ON 3
 uu_4                -6.178463e-02 1 1  ON 4
 uu_5                -9.481392e-02 1 1  ON 5
 uu_6                -1.204276e-01 1 1  ON 6
 uu_7                -1.315591e-01 1 1  ON 7
 uu_8                -1.218088e-01 1 1  ON 8
 uu_9                -9.320029e-02 1 1  ON 9
 ud_0                 4.246877e-01 1 1  ON 10
 ud_1                 1.660956e-01 1 1  ON 11
 ud_2                 5.662159e-02 1 1  ON 12
 ud_3                -5.220027e-03 1 1  ON 13
 ud_4                -6.025352e-02 1 1  ON 14
 ud_5                -1.023792e-01 1 1  ON 15
 ud_6                -1.298185e-01 1 1  ON 16
 ud_7                -1.449676e-01 1 1  ON 17
 ud_8                -1.439165e-01 1 1  ON 18
 ud_9                -1.348372e-01 1 1  ON 19
 eO_0                -7.214027e-01 1 1  ON 20
 eO_1                -4.177407e-01 1 1  ON 21
 eO_2                -2.105052e-02 1 1  ON 22
 eO_3                 2.792942e-01 1 1  ON 23
 eO_4                 4.951839e-01 1 1  ON 24
 eO_5                 4.585081e-01 1 1  ON 25
 eO_6                 2.356464e-01 1 1  ON 26
 eO_7                -5.585167e-02 1 1  ON 27
 eO_8                -1.969989e-01 1 1  ON 28
 eO_9                -5.842670e-02 1 1  ON 29
eH1_0                -2.156390e-01 1 1  ON 30
eH1_1                -1.277450e-01 1 1  ON 31
eH1_2                -8.743831e-02 1 1  ON 32
eH1_3                -3.584436e-02 1 1  ON 33
eH1_4                 1.268400e-02 1 1  ON 34
eH1_5                 4.497317e-02 1 1  ON 35
eH1_6                 9.504642e-02 1 1  ON 36
eH1_7                 1.384659e-01 1 1  ON 37
eH1_8                 1.464603e-01 1 1  ON 38
eH1_9                 3.366041e-02 1 1  ON 39
eH2_0                -2.147714e-01 1 1  ON 40
eH2_1                -1.271492e-01 1 1  ON 41
eH2_2                -8.630077e-02 1 1  ON 42
eH2_3                -3.451493e-02 1 1  ON 43
eH2_4                 1.402192e-02 1 1  ON 44
eH2_5                 4.850539e-02 1 1  ON 45
eH2_6                 1.006593e-01 1 1  ON 46
eH2_7                 1.490101e-01 1 1  ON 47
eH2_8                 1.547861e-01 1 1  ON 48
eH2_9                 1.421168e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8391
    reference variance = 0.224014
====================================================
  Execution time = 2.0708e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2651e-01
  Total weights = 2.0000e+06
  Execution time = 1.8835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326337323186
                                         uncertainty =       0.002857176765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326337323186
                                         uncertainty =       0.002857176765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403931827
  error estimate for blocks of size 2^( 2) =       0.000417280318
  error estimate for blocks of size 2^( 3) =       0.000431267200
  error estimate for blocks of size 2^( 4) =       0.000444538368
  error estimate for blocks of size 2^( 5) =       0.000457529170
  error estimate for blocks of size 2^( 6) =       0.000468766806
  error estimate for blocks of size 2^( 7) =       0.000472166636

      target function =                  N/A
              le_mean =     -16.905911360858
             les_mean =     286.136160619906
             stat err =       0.000460750245
             autocorr =       1.301112956015
              std dev =       0.571245868151
             le_variance =       0.326321841880

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327030103649
                                         uncertainty =       0.002867072828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327030103649
                                         uncertainty =       0.002867072828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404360285
  error estimate for blocks of size 2^( 2) =       0.000417657282
  error estimate for blocks of size 2^( 3) =       0.000431601059
  error estimate for blocks of size 2^( 4) =       0.000444840197
  error estimate for blocks of size 2^( 5) =       0.000457801619
  error estimate for blocks of size 2^( 6) =       0.000469028570
  error estimate for blocks of size 2^( 7) =       0.000472430135

      target function =                  N/A
              le_mean =     -16.905914122034
             les_mean =     286.136946617464
             stat err =       0.000461025130
             autocorr =       1.299906788673
              std dev =       0.571851798450
             le_variance =       0.327014479391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326717131823
                                         uncertainty =       0.002862576552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326717131823
                                         uncertainty =       0.002862576552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404166780
  error estimate for blocks of size 2^( 2) =       0.000417486547
  error estimate for blocks of size 2^( 3) =       0.000431449259
  error estimate for blocks of size 2^( 4) =       0.000444702601
  error estimate for blocks of size 2^( 5) =       0.000457677014
  error estimate for blocks of size 2^( 6) =       0.000468909246
  error estimate for blocks of size 2^( 7) =       0.000472310454

      target function =                  N/A
              le_mean =     -16.905912316456
             les_mean =     286.136572660303
             stat err =       0.000460899829
             autocorr =       1.300444627584
              std dev =       0.571578141603
             le_variance =       0.326701571959

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326386143312
                                         uncertainty =       0.002857870592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.326386143312
                                         uncertainty =       0.002857870592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000403962035
  error estimate for blocks of size 2^( 2) =       0.000417306767
  error estimate for blocks of size 2^( 3) =       0.000431290482
  error estimate for blocks of size 2^( 4) =       0.000444559331
  error estimate for blocks of size 2^( 5) =       0.000457548012
  error estimate for blocks of size 2^( 6) =       0.000468784992
  error estimate for blocks of size 2^( 7) =       0.000472185021

      target function =                  N/A
              le_mean =     -16.905911398199
             les_mean =     286.136210692412
             stat err =       0.000460769339
             autocorr =       1.301026194835
              std dev =       0.571288588931
             le_variance =       0.326370651843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905911360858        initial
     1.5625e+00     1.5625e+01             1.5072e-03       -16.905914122034  <--
     6.2500e+00     6.2500e+01             3.9969e-04       -16.905912316456
     2.5000e+01     2.5000e+02             1.0143e-04       -16.905911398199

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 3.0194e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.027989e-01 1 1  ON 0
 uu_1                 1.386693e-01 1 1  ON 1
 uu_2                 4.007510e-02 1 1  ON 2
 uu_3                -1.924508e-02 1 1  ON 3
 uu_4                -6.173220e-02 1 1  ON 4
 uu_5                -9.476840e-02 1 1  ON 5
 uu_6                -1.204185e-01 1 1  ON 6
 uu_7                -1.316094e-01 1 1  ON 7
 uu_8                -1.218263e-01 1 1  ON 8
 uu_9                -9.319550e-02 1 1  ON 9
 ud_0                 4.254766e-01 1 1  ON 10
 ud_1                 1.664878e-01 1 1  ON 11
 ud_2                 5.643546e-02 1 1  ON 12
 ud_3                -5.699257e-03 1 1  ON 13
 ud_4                -6.052899e-02 1 1  ON 14
 ud_5                -1.024770e-01 1 1  ON 15
 ud_6                -1.298810e-01 1 1  ON 16
 ud_7                -1.450528e-01 1 1  ON 17
 ud_8                -1.439179e-01 1 1  ON 18
 ud_9                -1.348150e-01 1 1  ON 19
 eO_0                -7.225101e-01 1 1  ON 20
 eO_1                -4.180660e-01 1 1  ON 21
 eO_2                -2.044041e-02 1 1  ON 22
 eO_3                 2.800084e-01 1 1  ON 23
 eO_4                 4.954776e-01 1 1  ON 24
 eO_5                 4.584587e-01 1 1  ON 25
 eO_6                 2.355937e-01 1 1  ON 26
 eO_7                -5.581467e-02 1 1  ON 27
 eO_8                -1.970519e-01 1 1  ON 28
 eO_9                -5.848425e-02 1 1  ON 29
eH1_0                -2.160448e-01 1 1  ON 30
eH1_1                -1.278310e-01 1 1  ON 31
eH1_2                -8.736559e-02 1 1  ON 32
eH1_3                -3.574258e-02 1 1  ON 33
eH1_4                 1.273005e-02 1 1  ON 34
eH1_5                 4.502164e-02 1 1  ON 35
eH1_6                 9.507920e-02 1 1  ON 36
eH1_7                 1.385071e-01 1 1  ON 37
eH1_8                 1.465375e-01 1 1  ON 38
eH1_9                 3.373612e-02 1 1  ON 39
eH2_0                -2.152468e-01 1 1  ON 40
eH2_1                -1.271693e-01 1 1  ON 41
eH2_2                -8.618763e-02 1 1  ON 42
eH2_3                -3.442855e-02 1 1  ON 43
eH2_4                 1.409024e-02 1 1  ON 44
eH2_5                 4.852192e-02 1 1  ON 45
eH2_6                 1.007022e-01 1 1  ON 46
eH2_7                 1.489878e-01 1 1  ON 47
eH2_8                 1.548625e-01 1 1  ON 48
eH2_9                 1.432322e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8380e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6883e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9197
    reference variance = 0.33552
====================================================
  Execution time = 2.0790e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4623e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346335716666
                                         uncertainty =       0.007505720163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346335716666
                                         uncertainty =       0.007505720163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416070289
  error estimate for blocks of size 2^( 2) =       0.000429176697
  error estimate for blocks of size 2^( 3) =       0.000442795848
  error estimate for blocks of size 2^( 4) =       0.000455799227
  error estimate for blocks of size 2^( 5) =       0.000467745140
  error estimate for blocks of size 2^( 6) =       0.000477037826
  error estimate for blocks of size 2^( 7) =       0.000481737574

      target function =                  N/A
              le_mean =     -16.905733678185
             les_mean =     286.150059996073
             stat err =       0.000470579942
             autocorr =       1.279185161777
              std dev =       0.588412246186
             le_variance =       0.346228971462


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573367819e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733678185       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905748183704       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905764582778       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905775727543       residual = 5.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905780363246       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905783165698       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905786594498       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905788176715       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905788653948       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905788041429       residual = 7.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905787753592       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905787852262       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.492052e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733678185       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905738652535       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905744465570       residual = 4.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905747295649       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905749478517       residual = 7.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905750044419       residual = 3.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905750707725       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905750958700       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905751071519       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905750979598       residual = 9.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.335881e-03

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905733678185       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905735049175       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905736680468       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905737393580       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905738036942       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905738163605       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905738301405       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905738347365       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905738371492       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905738351194       residual = 4.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.521145e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.323369 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6402e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.028101e-01 1 1  ON 0
 uu_1                 1.386264e-01 1 1  ON 1
 uu_2                 3.996130e-02 1 1  ON 2
 uu_3                -1.933991e-02 1 1  ON 3
 uu_4                -6.166915e-02 1 1  ON 4
 uu_5                -9.469391e-02 1 1  ON 5
 uu_6                -1.204508e-01 1 1  ON 6
 uu_7                -1.317039e-01 1 1  ON 7
 uu_8                -1.218102e-01 1 1  ON 8
 uu_9                -9.316854e-02 1 1  ON 9
 ud_0                 4.264630e-01 1 1  ON 10
 ud_1                 1.669401e-01 1 1  ON 11
 ud_2                 5.629581e-02 1 1  ON 12
 ud_3                -6.286456e-03 1 1  ON 13
 ud_4                -6.087229e-02 1 1  ON 14
 ud_5                -1.025946e-01 1 1  ON 15
 ud_6                -1.299275e-01 1 1  ON 16
 ud_7                -1.452117e-01 1 1  ON 17
 ud_8                -1.439787e-01 1 1  ON 18
 ud_9                -1.348158e-01 1 1  ON 19
 eO_0                -7.238460e-01 1 1  ON 20
 eO_1                -4.185099e-01 1 1  ON 21
 eO_2                -1.978671e-02 1 1  ON 22
 eO_3                 2.809106e-01 1 1  ON 23
 eO_4                 4.958860e-01 1 1  ON 24
 eO_5                 4.584358e-01 1 1  ON 25
 eO_6                 2.355529e-01 1 1  ON 26
 eO_7                -5.579743e-02 1 1  ON 27
 eO_8                -1.971133e-01 1 1  ON 28
 eO_9                -5.855378e-02 1 1  ON 29
eH1_0                -2.165767e-01 1 1  ON 30
eH1_1                -1.279076e-01 1 1  ON 31
eH1_2                -8.727572e-02 1 1  ON 32
eH1_3                -3.560595e-02 1 1  ON 33
eH1_4                 1.272002e-02 1 1  ON 34
eH1_5                 4.509087e-02 1 1  ON 35
eH1_6                 9.512069e-02 1 1  ON 36
eH1_7                 1.385729e-01 1 1  ON 37
eH1_8                 1.466440e-01 1 1  ON 38
eH1_9                 3.383575e-02 1 1  ON 39
eH2_0                -2.157868e-01 1 1  ON 40
eH2_1                -1.272743e-01 1 1  ON 41
eH2_2                -8.606324e-02 1 1  ON 42
eH2_3                -3.426071e-02 1 1  ON 43
eH2_4                 1.419600e-02 1 1  ON 44
eH2_5                 4.856861e-02 1 1  ON 45
eH2_6                 1.006762e-01 1 1  ON 46
eH2_7                 1.489442e-01 1 1  ON 47
eH2_8                 1.549714e-01 1 1  ON 48
eH2_9                 1.447368e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9477
    reference variance = 0.187056
====================================================
  Execution time = 2.0378e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3400e-01
  Total weights = 2.0000e+06
  Execution time = 1.8835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333359520621
                                         uncertainty =       0.005144353092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333359520621
                                         uncertainty =       0.005144353092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408254300
  error estimate for blocks of size 2^( 2) =       0.000421229469
  error estimate for blocks of size 2^( 3) =       0.000435074596
  error estimate for blocks of size 2^( 4) =       0.000447951923
  error estimate for blocks of size 2^( 5) =       0.000459160442
  error estimate for blocks of size 2^( 6) =       0.000467375119
  error estimate for blocks of size 2^( 7) =       0.000470724193

      target function =                  N/A
              le_mean =     -16.906628547193
             les_mean =     286.167431813257
             stat err =       0.000461302919
             autocorr =       1.276764709876
              std dev =       0.577358768151
             le_variance =       0.333343147161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335372378493
                                         uncertainty =       0.005202359337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335372378493
                                         uncertainty =       0.005202359337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409484997
  error estimate for blocks of size 2^( 2) =       0.000422343846
  error estimate for blocks of size 2^( 3) =       0.000436076799
  error estimate for blocks of size 2^( 4) =       0.000448866434
  error estimate for blocks of size 2^( 5) =       0.000460024891
  error estimate for blocks of size 2^( 6) =       0.000468224553
  error estimate for blocks of size 2^( 7) =       0.000471524657

      target function =                  N/A
              le_mean =     -16.906634829884
             les_mean =     286.169657029692
             stat err =       0.000462160134
             autocorr =       1.273822660096
              std dev =       0.579099237035
             le_variance =       0.335355926335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334687301115
                                         uncertainty =       0.005183747210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334687301115
                                         uncertainty =       0.005183747210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409066616
  error estimate for blocks of size 2^( 2) =       0.000421962528
  error estimate for blocks of size 2^( 3) =       0.000435732024
  error estimate for blocks of size 2^( 4) =       0.000448551870
  error estimate for blocks of size 2^( 5) =       0.000459730215
  error estimate for blocks of size 2^( 6) =       0.000467935602
  error estimate for blocks of size 2^( 7) =       0.000471249769

      target function =                  N/A
              le_mean =     -16.906628176781
             les_mean =     286.168747133979
             stat err =       0.000461866864
             autocorr =       1.274810212105
              std dev =       0.578507556910
             le_variance =       0.334670993402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333539126358
                                         uncertainty =       0.005149797784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333539126358
                                         uncertainty =       0.005149797784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408364279
  error estimate for blocks of size 2^( 2) =       0.000421328095
  error estimate for blocks of size 2^( 3) =       0.000435162493
  error estimate for blocks of size 2^( 4) =       0.000448031808
  error estimate for blocks of size 2^( 5) =       0.000459236271
  error estimate for blocks of size 2^( 6) =       0.000467449662
  error estimate for blocks of size 2^( 7) =       0.000470793835

      target function =                  N/A
              le_mean =     -16.906627590056
             les_mean =     286.167579070353
             stat err =       0.000461377894
             autocorr =       1.276491929752
              std dev =       0.577514301343
             le_variance =       0.333522768256


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906628547193        initial
     3.9062e-01     3.9062e+00             4.4921e-03       -16.906634829884  <--
     1.5625e+00     1.5625e+01             1.3359e-03       -16.906628176781
     6.2500e+00     6.2500e+01             3.5211e-04       -16.906627590056

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9899e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.029526e-01 1 1  ON 0
 uu_1                 1.385774e-01 1 1  ON 1
 uu_2                 3.970773e-02 1 1  ON 2
 uu_3                -1.962229e-02 1 1  ON 3
 uu_4                -6.169579e-02 1 1  ON 4
 uu_5                -9.457726e-02 1 1  ON 5
 uu_6                -1.205078e-01 1 1  ON 6
 uu_7                -1.319423e-01 1 1  ON 7
 uu_8                -1.217921e-01 1 1  ON 8
 uu_9                -9.310076e-02 1 1  ON 9
 ud_0                 4.285201e-01 1 1  ON 10
 ud_1                 1.679316e-01 1 1  ON 11
 ud_2                 5.616565e-02 1 1  ON 12
 ud_3                -7.426698e-03 1 1  ON 13
 ud_4                -6.176819e-02 1 1  ON 14
 ud_5                -1.029602e-01 1 1  ON 15
 ud_6                -1.300227e-01 1 1  ON 16
 ud_7                -1.455339e-01 1 1  ON 17
 ud_8                -1.441303e-01 1 1  ON 18
 ud_9                -1.348160e-01 1 1  ON 19
 eO_0                -7.270022e-01 1 1  ON 20
 eO_1                -4.197848e-01 1 1  ON 21
 eO_2                -1.854120e-02 1 1  ON 22
 eO_3                 2.830669e-01 1 1  ON 23
 eO_4                 4.971853e-01 1 1  ON 24
 eO_5                 4.585909e-01 1 1  ON 25
 eO_6                 2.354875e-01 1 1  ON 26
 eO_7                -5.574272e-02 1 1  ON 27
 eO_8                -1.972969e-01 1 1  ON 28
 eO_9                -5.876303e-02 1 1  ON 29
eH1_0                -2.179290e-01 1 1  ON 30
eH1_1                -1.281477e-01 1 1  ON 31
eH1_2                -8.709371e-02 1 1  ON 32
eH1_3                -3.533250e-02 1 1  ON 33
eH1_4                 1.265239e-02 1 1  ON 34
eH1_5                 4.524786e-02 1 1  ON 35
eH1_6                 9.528688e-02 1 1  ON 36
eH1_7                 1.387964e-01 1 1  ON 37
eH1_8                 1.469703e-01 1 1  ON 38
eH1_9                 3.413887e-02 1 1  ON 39
eH2_0                -2.171632e-01 1 1  ON 40
eH2_1                -1.275605e-01 1 1  ON 41
eH2_2                -8.579455e-02 1 1  ON 42
eH2_3                -3.387614e-02 1 1  ON 43
eH2_4                 1.441826e-02 1 1  ON 44
eH2_5                 4.868593e-02 1 1  ON 45
eH2_6                 1.006440e-01 1 1  ON 46
eH2_7                 1.488358e-01 1 1  ON 47
eH2_8                 1.552951e-01 1 1  ON 48
eH2_9                 1.492754e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6487e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9552
    reference variance = 0.331582
====================================================
  Execution time = 2.0650e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2871e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5284e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328783856117
                                         uncertainty =       0.002981389624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328783856117
                                         uncertainty =       0.002981389624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405409311
  error estimate for blocks of size 2^( 2) =       0.000418466164
  error estimate for blocks of size 2^( 3) =       0.000431503990
  error estimate for blocks of size 2^( 4) =       0.000444238253
  error estimate for blocks of size 2^( 5) =       0.000454477963
  error estimate for blocks of size 2^( 6) =       0.000461149119
  error estimate for blocks of size 2^( 7) =       0.000463440134

      target function =                  N/A
              le_mean =     -16.906351998821
             les_mean =     286.153451162090
             stat err =       0.000455826367
             autocorr =       1.264187376552
              std dev =       0.573335345514
             le_variance =       0.328713418416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635199882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906351998821       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906375182742       residual = 8.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906399387200       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906433709043       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906445197172       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906453773775       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906459918389       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906467196967       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906467469262       residual = 8.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906468295897       residual = 7.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906466841608       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906467926090       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906467906841       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906468267207       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906468231236       residual = 6.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         14 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 1.018353e-02

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906351998821       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906364114334       residual = 9.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906376412124       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906392131016       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906393671414       residual = 9.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906396495813       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906398111389       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906398849931       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906399760926       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906399281973       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906399144053       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906399183568       residual = 3.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 3.772099e-03

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906351998821       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906356162692       residual = 9.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906360389743       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906364703843       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365459263       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906366012579       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906366410362       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906366441056       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906366646542       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906366568124       residual = 6.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.119343e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.328700 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6188e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.032539e-01 1 1  ON 0
 uu_1                 1.386025e-01 1 1  ON 1
 uu_2                 3.946033e-02 1 1  ON 2
 uu_3                -1.984130e-02 1 1  ON 3
 uu_4                -6.172322e-02 1 1  ON 4
 uu_5                -9.413798e-02 1 1  ON 5
 uu_6                -1.203997e-01 1 1  ON 6
 uu_7                -1.321242e-01 1 1  ON 7
 uu_8                -1.225056e-01 1 1  ON 8
 uu_9                -9.339821e-02 1 1  ON 9
 ud_0                 4.307099e-01 1 1  ON 10
 ud_1                 1.692613e-01 1 1  ON 11
 ud_2                 5.618737e-02 1 1  ON 12
 ud_3                -8.501742e-03 1 1  ON 13
 ud_4                -6.278368e-02 1 1  ON 14
 ud_5                -1.032650e-01 1 1  ON 15
 ud_6                -1.301246e-01 1 1  ON 16
 ud_7                -1.455078e-01 1 1  ON 17
 ud_8                -1.446514e-01 1 1  ON 18
 ud_9                -1.352269e-01 1 1  ON 19
 eO_0                -7.307743e-01 1 1  ON 20
 eO_1                -4.212938e-01 1 1  ON 21
 eO_2                -1.714861e-02 1 1  ON 22
 eO_3                 2.857807e-01 1 1  ON 23
 eO_4                 4.989663e-01 1 1  ON 24
 eO_5                 4.588820e-01 1 1  ON 25
 eO_6                 2.354600e-01 1 1  ON 26
 eO_7                -5.558962e-02 1 1  ON 27
 eO_8                -1.978302e-01 1 1  ON 28
 eO_9                -5.919603e-02 1 1  ON 29
eH1_0                -2.194676e-01 1 1  ON 30
eH1_1                -1.285359e-01 1 1  ON 31
eH1_2                -8.666473e-02 1 1  ON 32
eH1_3                -3.490430e-02 1 1  ON 33
eH1_4                 1.285874e-02 1 1  ON 34
eH1_5                 4.530060e-02 1 1  ON 35
eH1_6                 9.541377e-02 1 1  ON 36
eH1_7                 1.386988e-01 1 1  ON 37
eH1_8                 1.473785e-01 1 1  ON 38
eH1_9                 3.449767e-02 1 1  ON 39
eH2_0                -2.188239e-01 1 1  ON 40
eH2_1                -1.275684e-01 1 1  ON 41
eH2_2                -8.551286e-02 1 1  ON 42
eH2_3                -3.346570e-02 1 1  ON 43
eH2_4                 1.464815e-02 1 1  ON 44
eH2_5                 4.861827e-02 1 1  ON 45
eH2_6                 1.004382e-01 1 1  ON 46
eH2_7                 1.487855e-01 1 1  ON 47
eH2_8                 1.558070e-01 1 1  ON 48
eH2_9                 1.550145e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9927
    reference variance = 0.498621
====================================================
  Execution time = 2.0413e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2866e-01
  Total weights = 2.0000e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327349878072
                                         uncertainty =       0.003288214509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327349878072
                                         uncertainty =       0.003288214509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404590913
  error estimate for blocks of size 2^( 2) =       0.000418131587
  error estimate for blocks of size 2^( 3) =       0.000433023694
  error estimate for blocks of size 2^( 4) =       0.000448213660
  error estimate for blocks of size 2^( 5) =       0.000460969246
  error estimate for blocks of size 2^( 6) =       0.000470002974
  error estimate for blocks of size 2^( 7) =       0.000477648748

      target function =                  N/A
              le_mean =     -16.906495292769
             les_mean =     286.156970534013
             stat err =       0.000464208657
             autocorr =       1.316419244180
              std dev =       0.572177955958
             le_variance =       0.327387613284

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330392191975
                                         uncertainty =       0.003320771904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330392191975
                                         uncertainty =       0.003320771904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406467243
  error estimate for blocks of size 2^( 2) =       0.000419844104
  error estimate for blocks of size 2^( 3) =       0.000434570585
  error estimate for blocks of size 2^( 4) =       0.000449624759
  error estimate for blocks of size 2^( 5) =       0.000462291331
  error estimate for blocks of size 2^( 6) =       0.000471300435
  error estimate for blocks of size 2^( 7) =       0.000478945464

      target function =                  N/A
              le_mean =     -16.906487673274
             les_mean =     286.159756521338
             stat err =       0.000465540497
             autocorr =       1.311788526168
              std dev =       0.574831488330
             le_variance =       0.330431239976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329980486738
                                         uncertainty =       0.003315801415

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329980486738
                                         uncertainty =       0.003315801415

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406213821
  error estimate for blocks of size 2^( 2) =       0.000419609416
  error estimate for blocks of size 2^( 3) =       0.000434362588
  error estimate for blocks of size 2^( 4) =       0.000449441485
  error estimate for blocks of size 2^( 5) =       0.000462122499
  error estimate for blocks of size 2^( 6) =       0.000471154776
  error estimate for blocks of size 2^( 7) =       0.000478784261

      target function =                  N/A
              le_mean =     -16.906486190379
             les_mean =     286.159294477811
             stat err =       0.000465375755
             autocorr =       1.312496384614
              std dev =       0.574473095392
             le_variance =       0.330019337330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327740989873
                                         uncertainty =       0.003292470157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327740989873
                                         uncertainty =       0.003292470157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404832626
  error estimate for blocks of size 2^( 2) =       0.000418347859
  error estimate for blocks of size 2^( 3) =       0.000433216552
  error estimate for blocks of size 2^( 4) =       0.000448388263
  error estimate for blocks of size 2^( 5) =       0.000461131747
  error estimate for blocks of size 2^( 6) =       0.000470166767
  error estimate for blocks of size 2^( 7) =       0.000477808281

      target function =                  N/A
              le_mean =     -16.906489234115
             les_mean =     286.157156969575
             stat err =       0.000464373764
             autocorr =       1.315783207655
              std dev =       0.572519790235
             le_variance =       0.327778910211


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906495292769        initial  <--
     9.7656e-02     9.7656e-01             1.0184e-02       -16.906487673274
     3.9062e-01     3.9062e+00             3.7721e-03       -16.906486190379
     1.5625e+00     1.5625e+01             1.1193e-03       -16.906489234115

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9193
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.029526e-01 1 1  ON 0
 uu_1                 1.385774e-01 1 1  ON 1
 uu_2                 3.970773e-02 1 1  ON 2
 uu_3                -1.962229e-02 1 1  ON 3
 uu_4                -6.169579e-02 1 1  ON 4
 uu_5                -9.457726e-02 1 1  ON 5
 uu_6                -1.205078e-01 1 1  ON 6
 uu_7                -1.319423e-01 1 1  ON 7
 uu_8                -1.217921e-01 1 1  ON 8
 uu_9                -9.310076e-02 1 1  ON 9
 ud_0                 4.285201e-01 1 1  ON 10
 ud_1                 1.679316e-01 1 1  ON 11
 ud_2                 5.616565e-02 1 1  ON 12
 ud_3                -7.426698e-03 1 1  ON 13
 ud_4                -6.176819e-02 1 1  ON 14
 ud_5                -1.029602e-01 1 1  ON 15
 ud_6                -1.300227e-01 1 1  ON 16
 ud_7                -1.455339e-01 1 1  ON 17
 ud_8                -1.441303e-01 1 1  ON 18
 ud_9                -1.348160e-01 1 1  ON 19
 eO_0                -7.270022e-01 1 1  ON 20
 eO_1                -4.197848e-01 1 1  ON 21
 eO_2                -1.854120e-02 1 1  ON 22
 eO_3                 2.830669e-01 1 1  ON 23
 eO_4                 4.971853e-01 1 1  ON 24
 eO_5                 4.585909e-01 1 1  ON 25
 eO_6                 2.354875e-01 1 1  ON 26
 eO_7                -5.574272e-02 1 1  ON 27
 eO_8                -1.972969e-01 1 1  ON 28
 eO_9                -5.876303e-02 1 1  ON 29
eH1_0                -2.179290e-01 1 1  ON 30
eH1_1                -1.281477e-01 1 1  ON 31
eH1_2                -8.709371e-02 1 1  ON 32
eH1_3                -3.533250e-02 1 1  ON 33
eH1_4                 1.265239e-02 1 1  ON 34
eH1_5                 4.524786e-02 1 1  ON 35
eH1_6                 9.528688e-02 1 1  ON 36
eH1_7                 1.387964e-01 1 1  ON 37
eH1_8                 1.469703e-01 1 1  ON 38
eH1_9                 3.413887e-02 1 1  ON 39
eH2_0                -2.171632e-01 1 1  ON 40
eH2_1                -1.275605e-01 1 1  ON 41
eH2_2                -8.579455e-02 1 1  ON 42
eH2_3                -3.387614e-02 1 1  ON 43
eH2_4                 1.441826e-02 1 1  ON 44
eH2_5                 4.868593e-02 1 1  ON 45
eH2_6                 1.006440e-01 1 1  ON 46
eH2_7                 1.488358e-01 1 1  ON 47
eH2_8                 1.552951e-01 1 1  ON 48
eH2_9                 1.492754e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8628
    reference variance = 0.376318
====================================================
  Execution time = 2.0768e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2307e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323125566050
                                         uncertainty =       0.003324754140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.323125566050
                                         uncertainty =       0.003324754140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000401913620
  error estimate for blocks of size 2^( 2) =       0.000415264833
  error estimate for blocks of size 2^( 3) =       0.000429331252
  error estimate for blocks of size 2^( 4) =       0.000442863966
  error estimate for blocks of size 2^( 5) =       0.000454947272
  error estimate for blocks of size 2^( 6) =       0.000465214459
  error estimate for blocks of size 2^( 7) =       0.000472396431

      target function =                  N/A
              le_mean =     -16.906573502013
             les_mean =     286.155296533223
             stat err =       0.000458855532
             autocorr =       1.303426351092
              std dev =       0.568391692224
             le_variance =       0.323069115790


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690657350201e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906573502013       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906577760956       residual = 7.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906580105319       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906584203213       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906591403806       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906592585997       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906592667172       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906592526148       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906592368182       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906592386801       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.737975e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906573502013       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906574769052       residual = 7.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906575422380       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906576355996       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906578402751       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906578646307       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906578695213       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906578700051       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906578685891       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.722199e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906573502013       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906573834570       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906574003039       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906574228069       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906574753429       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906574811794       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906574826096       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906574830370       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906574830016       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.208539e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6355e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.029850e-01 1 1  ON 0
 uu_1                 1.385724e-01 1 1  ON 1
 uu_2                 3.966046e-02 1 1  ON 2
 uu_3                -1.963851e-02 1 1  ON 3
 uu_4                -6.167287e-02 1 1  ON 4
 uu_5                -9.455610e-02 1 1  ON 5
 uu_6                -1.205204e-01 1 1  ON 6
 uu_7                -1.319699e-01 1 1  ON 7
 uu_8                -1.218429e-01 1 1  ON 8
 uu_9                -9.310108e-02 1 1  ON 9
 ud_0                 4.288135e-01 1 1  ON 10
 ud_1                 1.680749e-01 1 1  ON 11
 ud_2                 5.610965e-02 1 1  ON 12
 ud_3                -7.576432e-03 1 1  ON 13
 ud_4                -6.188840e-02 1 1  ON 14
 ud_5                -1.030032e-01 1 1  ON 15
 ud_6                -1.300463e-01 1 1  ON 16
 ud_7                -1.455808e-01 1 1  ON 17
 ud_8                -1.441670e-01 1 1  ON 18
 ud_9                -1.347966e-01 1 1  ON 19
 eO_0                -7.274744e-01 1 1  ON 20
 eO_1                -4.199089e-01 1 1  ON 21
 eO_2                -1.835441e-02 1 1  ON 22
 eO_3                 2.833716e-01 1 1  ON 23
 eO_4                 4.973500e-01 1 1  ON 24
 eO_5                 4.586196e-01 1 1  ON 25
 eO_6                 2.354700e-01 1 1  ON 26
 eO_7                -5.575856e-02 1 1  ON 27
 eO_8                -1.973284e-01 1 1  ON 28
 eO_9                -5.878647e-02 1 1  ON 29
eH1_0                -2.181392e-01 1 1  ON 30
eH1_1                -1.281756e-01 1 1  ON 31
eH1_2                -8.703619e-02 1 1  ON 32
eH1_3                -3.529547e-02 1 1  ON 33
eH1_4                 1.267984e-02 1 1  ON 34
eH1_5                 4.527822e-02 1 1  ON 35
eH1_6                 9.529504e-02 1 1  ON 36
eH1_7                 1.387850e-01 1 1  ON 37
eH1_8                 1.470100e-01 1 1  ON 38
eH1_9                 3.418473e-02 1 1  ON 39
eH2_0                -2.173389e-01 1 1  ON 40
eH2_1                -1.275820e-01 1 1  ON 41
eH2_2                -8.576757e-02 1 1  ON 42
eH2_3                -3.383798e-02 1 1  ON 43
eH2_4                 1.441315e-02 1 1  ON 44
eH2_5                 4.871346e-02 1 1  ON 45
eH2_6                 1.006536e-01 1 1  ON 46
eH2_7                 1.488336e-01 1 1  ON 47
eH2_8                 1.553408e-01 1 1  ON 48
eH2_9                 1.498268e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.17374
====================================================
  Execution time = 2.0450e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2781e-01
  Total weights = 2.0000e+06
  Execution time = 1.8831e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327629267515
                                         uncertainty =       0.002778212486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327629267515
                                         uncertainty =       0.002778212486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404725097
  error estimate for blocks of size 2^( 2) =       0.000417734015
  error estimate for blocks of size 2^( 3) =       0.000432133503
  error estimate for blocks of size 2^( 4) =       0.000444985797
  error estimate for blocks of size 2^( 5) =       0.000457831681
  error estimate for blocks of size 2^( 6) =       0.000469306252
  error estimate for blocks of size 2^( 7) =       0.000477143790

      target function =                  N/A
              le_mean =     -16.906451883723
             les_mean =     286.155719941501
             stat err =       0.000462316880
             autocorr =       1.304845909812
              std dev =       0.572367721527
             le_variance =       0.327604808646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328334756129
                                         uncertainty =       0.002780795307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328334756129
                                         uncertainty =       0.002780795307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405160619
  error estimate for blocks of size 2^( 2) =       0.000418129411
  error estimate for blocks of size 2^( 3) =       0.000432491343
  error estimate for blocks of size 2^( 4) =       0.000445316172
  error estimate for blocks of size 2^( 5) =       0.000458149500
  error estimate for blocks of size 2^( 6) =       0.000469621189
  error estimate for blocks of size 2^( 7) =       0.000477458669

      target function =                  N/A
              le_mean =     -16.906456578202
             les_mean =     286.156584121564
             stat err =       0.000462636383
             autocorr =       1.303842444089
              std dev =       0.572983642940
             le_variance =       0.328310255077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328046976571
                                         uncertainty =       0.002779711739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328046976571
                                         uncertainty =       0.002779711739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404983021
  error estimate for blocks of size 2^( 2) =       0.000417968013
  error estimate for blocks of size 2^( 3) =       0.000432345351
  error estimate for blocks of size 2^( 4) =       0.000445181776
  error estimate for blocks of size 2^( 5) =       0.000458020166
  error estimate for blocks of size 2^( 6) =       0.000469493304
  error estimate for blocks of size 2^( 7) =       0.000477330182

      target function =                  N/A
              le_mean =     -16.906454362608
             les_mean =     286.156221444992
             stat err =       0.000462506357
             autocorr =       1.304252813004
              std dev =       0.572732480370
             le_variance =       0.328022494071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327683313098
                                         uncertainty =       0.002778402628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327683313098
                                         uncertainty =       0.002778402628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404758478
  error estimate for blocks of size 2^( 2) =       0.000417764243
  error estimate for blocks of size 2^( 3) =       0.000432160824
  error estimate for blocks of size 2^( 4) =       0.000445011049
  error estimate for blocks of size 2^( 5) =       0.000457855948
  error estimate for blocks of size 2^( 6) =       0.000469330342
  error estimate for blocks of size 2^( 7) =       0.000477167766

      target function =                  N/A
              le_mean =     -16.906452139240
             les_mean =     286.155782623773
             stat err =       0.000462341276
             autocorr =       1.304768389485
              std dev =       0.572414929212
             le_variance =       0.327658851185


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906451883723        initial
     9.7656e-01     9.7656e+00             1.7380e-03       -16.906456578202  <--
     3.9062e+00     3.9062e+01             4.7222e-04       -16.906454362608
     1.5625e+01     1.5625e+02             1.2085e-04       -16.906452139240

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.9934e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.030920e-01 1 1  ON 0
 uu_1                 1.385595e-01 1 1  ON 1
 uu_2                 3.955352e-02 1 1  ON 2
 uu_3                -1.970588e-02 1 1  ON 3
 uu_4                -6.163194e-02 1 1  ON 4
 uu_5                -9.450118e-02 1 1  ON 5
 uu_6                -1.205526e-01 1 1  ON 6
 uu_7                -1.320481e-01 1 1  ON 7
 uu_8                -1.219944e-01 1 1  ON 8
 uu_9                -9.310439e-02 1 1  ON 9
 ud_0                 4.295484e-01 1 1  ON 10
 ud_1                 1.684433e-01 1 1  ON 11
 ud_2                 5.602202e-02 1 1  ON 12
 ud_3                -7.959979e-03 1 1  ON 13
 ud_4                -6.222145e-02 1 1  ON 14
 ud_5                -1.031304e-01 1 1  ON 15
 ud_6                -1.301084e-01 1 1  ON 16
 ud_7                -1.457044e-01 1 1  ON 17
 ud_8                -1.442719e-01 1 1  ON 18
 ud_9                -1.347388e-01 1 1  ON 19
 eO_0                -7.287402e-01 1 1  ON 20
 eO_1                -4.203050e-01 1 1  ON 21
 eO_2                -1.790487e-02 1 1  ON 22
 eO_3                 2.842152e-01 1 1  ON 23
 eO_4                 4.978625e-01 1 1  ON 24
 eO_5                 4.587345e-01 1 1  ON 25
 eO_6                 2.354238e-01 1 1  ON 26
 eO_7                -5.580573e-02 1 1  ON 27
 eO_8                -1.974228e-01 1 1  ON 28
 eO_9                -5.885686e-02 1 1  ON 29
eH1_0                -2.187254e-01 1 1  ON 30
eH1_1                -1.282553e-01 1 1  ON 31
eH1_2                -8.688648e-02 1 1  ON 32
eH1_3                -3.520147e-02 1 1  ON 33
eH1_4                 1.274575e-02 1 1  ON 34
eH1_5                 4.536797e-02 1 1  ON 35
eH1_6                 9.532656e-02 1 1  ON 36
eH1_7                 1.387540e-01 1 1  ON 37
eH1_8                 1.471285e-01 1 1  ON 38
eH1_9                 3.432226e-02 1 1  ON 39
eH2_0                -2.178317e-01 1 1  ON 40
eH2_1                -1.276569e-01 1 1  ON 41
eH2_2                -8.569120e-02 1 1  ON 42
eH2_3                -3.374169e-02 1 1  ON 43
eH2_4                 1.439225e-02 1 1  ON 44
eH2_5                 4.878985e-02 1 1  ON 45
eH2_6                 1.006889e-01 1 1  ON 46
eH2_7                 1.488304e-01 1 1  ON 47
eH2_8                 1.554779e-01 1 1  ON 48
eH2_9                 1.514813e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.804
    reference variance = 0.301475
====================================================
  Execution time = 2.1178e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2876e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328583127266
                                         uncertainty =       0.003480360072

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328583127266
                                         uncertainty =       0.003480360072

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405440662
  error estimate for blocks of size 2^( 2) =       0.000419061614
  error estimate for blocks of size 2^( 3) =       0.000433442053
  error estimate for blocks of size 2^( 4) =       0.000446135769
  error estimate for blocks of size 2^( 5) =       0.000457999063
  error estimate for blocks of size 2^( 6) =       0.000468892227
  error estimate for blocks of size 2^( 7) =       0.000474713437

      target function =                  N/A
              le_mean =     -16.906987307570
             les_mean =     286.174983915158
             stat err =       0.000461935124
             autocorr =       1.298097658497
              std dev =       0.573379683280
             le_variance =       0.328764261199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690698730757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906987307570       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906993754720       residual = 4.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907001963021       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907012758358       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907024983258       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907027646812       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907029396242       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907030541099       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907029106474       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907029773866       residual = 7.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907029988321       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907030089338       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.907030236220       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 4.867865e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906987307570       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906989729902       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906992383487       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906995564489       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906999485038       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907000318042       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907000774911       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907001241912       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907000856795       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907000893349       residual = 8.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.507723e-03

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906987307570       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906988000236       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906988735179       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906989528985       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906990533235       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906990785088       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906990918994       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906991043186       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906990968181       residual = 8.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.060366e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.336015 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6684e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.032039e-01 1 1  ON 0
 uu_1                 1.385230e-01 1 1  ON 1
 uu_2                 3.949781e-02 1 1  ON 2
 uu_3                -1.981991e-02 1 1  ON 3
 uu_4                -6.170174e-02 1 1  ON 4
 uu_5                -9.443634e-02 1 1  ON 5
 uu_6                -1.204096e-01 1 1  ON 6
 uu_7                -1.321090e-01 1 1  ON 7
 uu_8                -1.221249e-01 1 1  ON 8
 uu_9                -9.317968e-02 1 1  ON 9
 ud_0                 4.303834e-01 1 1  ON 10
 ud_1                 1.689131e-01 1 1  ON 11
 ud_2                 5.610820e-02 1 1  ON 12
 ud_3                -8.391189e-03 1 1  ON 13
 ud_4                -6.262018e-02 1 1  ON 14
 ud_5                -1.033345e-01 1 1  ON 15
 ud_6                -1.302423e-01 1 1  ON 16
 ud_7                -1.457841e-01 1 1  ON 17
 ud_8                -1.443983e-01 1 1  ON 18
 ud_9                -1.348102e-01 1 1  ON 19
 eO_0                -7.302479e-01 1 1  ON 20
 eO_1                -4.209176e-01 1 1  ON 21
 eO_2                -1.739578e-02 1 1  ON 22
 eO_3                 2.853148e-01 1 1  ON 23
 eO_4                 4.986097e-01 1 1  ON 24
 eO_5                 4.588447e-01 1 1  ON 25
 eO_6                 2.353648e-01 1 1  ON 26
 eO_7                -5.576594e-02 1 1  ON 27
 eO_8                -1.976074e-01 1 1  ON 28
 eO_9                -5.899168e-02 1 1  ON 29
eH1_0                -2.194428e-01 1 1  ON 30
eH1_1                -1.284797e-01 1 1  ON 31
eH1_2                -8.678533e-02 1 1  ON 32
eH1_3                -3.502177e-02 1 1  ON 33
eH1_4                 1.283659e-02 1 1  ON 34
eH1_5                 4.547387e-02 1 1  ON 35
eH1_6                 9.540149e-02 1 1  ON 36
eH1_7                 1.387827e-01 1 1  ON 37
eH1_8                 1.473276e-01 1 1  ON 38
eH1_9                 3.449153e-02 1 1  ON 39
eH2_0                -2.184780e-01 1 1  ON 40
eH2_1                -1.277135e-01 1 1  ON 41
eH2_2                -8.562706e-02 1 1  ON 42
eH2_3                -3.357902e-02 1 1  ON 43
eH2_4                 1.446108e-02 1 1  ON 44
eH2_5                 4.881453e-02 1 1  ON 45
eH2_6                 1.006904e-01 1 1  ON 46
eH2_7                 1.488500e-01 1 1  ON 47
eH2_8                 1.556541e-01 1 1  ON 48
eH2_9                 1.534245e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9082
    reference variance = 0.302431
====================================================
  Execution time = 2.0628e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2991e-01
  Total weights = 2.0000e+06
  Execution time = 1.8882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329542180194
                                         uncertainty =       0.003022264188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329542180194
                                         uncertainty =       0.003022264188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405865956
  error estimate for blocks of size 2^( 2) =       0.000418922922
  error estimate for blocks of size 2^( 3) =       0.000432681741
  error estimate for blocks of size 2^( 4) =       0.000446078191
  error estimate for blocks of size 2^( 5) =       0.000458174510
  error estimate for blocks of size 2^( 6) =       0.000467976392
  error estimate for blocks of size 2^( 7) =       0.000475496013

      target function =                  N/A
              le_mean =     -16.905953466289
             les_mean =     286.140716788011
             stat err =       0.000461931276
             autocorr =       1.295357036413
              std dev =       0.573981139405
             le_variance =       0.329454348393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330980801050
                                         uncertainty =       0.003036455574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330980801050
                                         uncertainty =       0.003036455574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406750385
  error estimate for blocks of size 2^( 2) =       0.000419731290
  error estimate for blocks of size 2^( 3) =       0.000433402476
  error estimate for blocks of size 2^( 4) =       0.000446726638
  error estimate for blocks of size 2^( 5) =       0.000458786200
  error estimate for blocks of size 2^( 6) =       0.000468565251
  error estimate for blocks of size 2^( 7) =       0.000476034478

      target function =                  N/A
              le_mean =     -16.905944329528
             les_mean =     286.141845258356
             stat err =       0.000462528142
             autocorr =       1.293065067516
              std dev =       0.575231910357
             le_variance =       0.330891750693

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330473973307
                                         uncertainty =       0.003031365955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330473973307
                                         uncertainty =       0.003031365955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406438993
  error estimate for blocks of size 2^( 2) =       0.000419444525
  error estimate for blocks of size 2^( 3) =       0.000433144823
  error estimate for blocks of size 2^( 4) =       0.000446492998
  error estimate for blocks of size 2^( 5) =       0.000458566423
  error estimate for blocks of size 2^( 6) =       0.000468356299
  error estimate for blocks of size 2^( 7) =       0.000475841410

      target function =                  N/A
              le_mean =     -16.905944782099
             les_mean =     286.141354120392
             stat err =       0.000462314282
             autocorr =       1.293849872791
              std dev =       0.574791536306
             le_variance =       0.330385310208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329670740840
                                         uncertainty =       0.003023517606

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329670740840
                                         uncertainty =       0.003023517606

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405945065
  error estimate for blocks of size 2^( 2) =       0.000418994513
  error estimate for blocks of size 2^( 3) =       0.000432744891
  error estimate for blocks of size 2^( 4) =       0.000446134435
  error estimate for blocks of size 2^( 5) =       0.000458227572
  error estimate for blocks of size 2^( 6) =       0.000468027873
  error estimate for blocks of size 2^( 7) =       0.000475542608

      target function =                  N/A
              le_mean =     -16.905951611138
             les_mean =     286.140782505309
             stat err =       0.000461983122
             autocorr =       1.295142891121
              std dev =       0.574093016815
             le_variance =       0.329582791955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905953466289        initial  <--
     2.4414e-01     2.4414e+00             4.8679e-03       -16.905944329528
     9.7656e-01     9.7656e+00             1.5077e-03       -16.905944782099
     3.9062e+00     3.9062e+01             4.0604e-04       -16.905951611138

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1199
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.030920e-01 1 1  ON 0
 uu_1                 1.385595e-01 1 1  ON 1
 uu_2                 3.955352e-02 1 1  ON 2
 uu_3                -1.970588e-02 1 1  ON 3
 uu_4                -6.163194e-02 1 1  ON 4
 uu_5                -9.450118e-02 1 1  ON 5
 uu_6                -1.205526e-01 1 1  ON 6
 uu_7                -1.320481e-01 1 1  ON 7
 uu_8                -1.219944e-01 1 1  ON 8
 uu_9                -9.310439e-02 1 1  ON 9
 ud_0                 4.295484e-01 1 1  ON 10
 ud_1                 1.684433e-01 1 1  ON 11
 ud_2                 5.602202e-02 1 1  ON 12
 ud_3                -7.959979e-03 1 1  ON 13
 ud_4                -6.222145e-02 1 1  ON 14
 ud_5                -1.031304e-01 1 1  ON 15
 ud_6                -1.301084e-01 1 1  ON 16
 ud_7                -1.457044e-01 1 1  ON 17
 ud_8                -1.442719e-01 1 1  ON 18
 ud_9                -1.347388e-01 1 1  ON 19
 eO_0                -7.287402e-01 1 1  ON 20
 eO_1                -4.203050e-01 1 1  ON 21
 eO_2                -1.790487e-02 1 1  ON 22
 eO_3                 2.842152e-01 1 1  ON 23
 eO_4                 4.978625e-01 1 1  ON 24
 eO_5                 4.587345e-01 1 1  ON 25
 eO_6                 2.354238e-01 1 1  ON 26
 eO_7                -5.580573e-02 1 1  ON 27
 eO_8                -1.974228e-01 1 1  ON 28
 eO_9                -5.885686e-02 1 1  ON 29
eH1_0                -2.187254e-01 1 1  ON 30
eH1_1                -1.282553e-01 1 1  ON 31
eH1_2                -8.688648e-02 1 1  ON 32
eH1_3                -3.520147e-02 1 1  ON 33
eH1_4                 1.274575e-02 1 1  ON 34
eH1_5                 4.536797e-02 1 1  ON 35
eH1_6                 9.532656e-02 1 1  ON 36
eH1_7                 1.387540e-01 1 1  ON 37
eH1_8                 1.471285e-01 1 1  ON 38
eH1_9                 3.432226e-02 1 1  ON 39
eH2_0                -2.178317e-01 1 1  ON 40
eH2_1                -1.276569e-01 1 1  ON 41
eH2_2                -8.569120e-02 1 1  ON 42
eH2_3                -3.374169e-02 1 1  ON 43
eH2_4                 1.439225e-02 1 1  ON 44
eH2_5                 4.878985e-02 1 1  ON 45
eH2_6                 1.006889e-01 1 1  ON 46
eH2_7                 1.488304e-01 1 1  ON 47
eH2_8                 1.554779e-01 1 1  ON 48
eH2_9                 1.514813e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6826e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9278
    reference variance = 0.337543
====================================================
  Execution time = 2.1316e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2841e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328376693267
                                         uncertainty =       0.002931970167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.328376693267
                                         uncertainty =       0.002931970167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405221246
  error estimate for blocks of size 2^( 2) =       0.000418818599
  error estimate for blocks of size 2^( 3) =       0.000433149484
  error estimate for blocks of size 2^( 4) =       0.000446534863
  error estimate for blocks of size 2^( 5) =       0.000459227989
  error estimate for blocks of size 2^( 6) =       0.000469269092
  error estimate for blocks of size 2^( 7) =       0.000478082339

      target function =                  N/A
              le_mean =     -16.905994389118
             les_mean =     286.141054637725
             stat err =       0.000463278571
             autocorr =       1.307073495578
              std dev =       0.573069382388
             le_variance =       0.328408517030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599438912e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905994389118       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905997149418       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905999466416       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906000094717       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906000207610       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906000518089       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906000714478       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906000725700       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906000638619       residual = 9.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 6.557126e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905994389118       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905995121149       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905995743381       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905995892836       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905995919472       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905995992210       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905996044004       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905996047287       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905996024143       residual = 5.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.690747e-04

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905994389118       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905994574951       residual = 6.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905994733475       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905994770260       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905994776893       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905994794712       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905994807767       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905994808631       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905994802813       residual = 4.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.261357e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.339057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6813e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.031102e-01 1 1  ON 0
 uu_1                 1.385576e-01 1 1  ON 1
 uu_2                 3.953629e-02 1 1  ON 2
 uu_3                -1.971087e-02 1 1  ON 3
 uu_4                -6.164017e-02 1 1  ON 4
 uu_5                -9.449803e-02 1 1  ON 5
 uu_6                -1.205446e-01 1 1  ON 6
 uu_7                -1.320541e-01 1 1  ON 7
 uu_8                -1.220105e-01 1 1  ON 8
 uu_9                -9.311059e-02 1 1  ON 9
 ud_0                 4.296427e-01 1 1  ON 10
 ud_1                 1.684915e-01 1 1  ON 11
 ud_2                 5.602368e-02 1 1  ON 12
 ud_3                -8.003963e-03 1 1  ON 13
 ud_4                -6.226961e-02 1 1  ON 14
 ud_5                -1.031439e-01 1 1  ON 15
 ud_6                -1.301158e-01 1 1  ON 16
 ud_7                -1.457199e-01 1 1  ON 17
 ud_8                -1.442899e-01 1 1  ON 18
 ud_9                -1.347445e-01 1 1  ON 19
 eO_0                -7.289092e-01 1 1  ON 20
 eO_1                -4.203665e-01 1 1  ON 21
 eO_2                -1.784563e-02 1 1  ON 22
 eO_3                 2.843221e-01 1 1  ON 23
 eO_4                 4.979437e-01 1 1  ON 24
 eO_5                 4.587546e-01 1 1  ON 25
 eO_6                 2.354209e-01 1 1  ON 26
 eO_7                -5.580452e-02 1 1  ON 27
 eO_8                -1.974435e-01 1 1  ON 28
 eO_9                -5.887127e-02 1 1  ON 29
eH1_0                -2.187945e-01 1 1  ON 30
eH1_1                -1.282734e-01 1 1  ON 31
eH1_2                -8.687539e-02 1 1  ON 32
eH1_3                -3.519179e-02 1 1  ON 33
eH1_4                 1.274258e-02 1 1  ON 34
eH1_5                 4.538515e-02 1 1  ON 35
eH1_6                 9.533667e-02 1 1  ON 36
eH1_7                 1.387557e-01 1 1  ON 37
eH1_8                 1.471456e-01 1 1  ON 38
eH1_9                 3.434190e-02 1 1  ON 39
eH2_0                -2.179041e-01 1 1  ON 40
eH2_1                -1.276681e-01 1 1  ON 41
eH2_2                -8.567426e-02 1 1  ON 42
eH2_3                -3.372358e-02 1 1  ON 43
eH2_4                 1.438489e-02 1 1  ON 44
eH2_5                 4.879599e-02 1 1  ON 45
eH2_6                 1.007026e-01 1 1  ON 46
eH2_7                 1.488320e-01 1 1  ON 47
eH2_8                 1.554951e-01 1 1  ON 48
eH2_9                 1.516645e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8761
    reference variance = 0.323474
====================================================
  Execution time = 2.2320e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3284e-01
  Total weights = 2.0000e+06
  Execution time = 1.8930e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332691454513
                                         uncertainty =       0.003438401723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332691454513
                                         uncertainty =       0.003438401723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407909908
  error estimate for blocks of size 2^( 2) =       0.000421224547
  error estimate for blocks of size 2^( 3) =       0.000435102814
  error estimate for blocks of size 2^( 4) =       0.000448441665
  error estimate for blocks of size 2^( 5) =       0.000461231246
  error estimate for blocks of size 2^( 6) =       0.000471436808
  error estimate for blocks of size 2^( 7) =       0.000477423211

      target function =                  N/A
              le_mean =     -16.905958089569
             les_mean =     286.144199745712
             stat err =       0.000464633233
             autocorr =       1.297454181461
              std dev =       0.576871723913
             le_variance =       0.332780985850

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332924126376
                                         uncertainty =       0.003440850812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332924126376
                                         uncertainty =       0.003440850812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408052521
  error estimate for blocks of size 2^( 2) =       0.000421355655
  error estimate for blocks of size 2^( 3) =       0.000435221294
  error estimate for blocks of size 2^( 4) =       0.000448551197
  error estimate for blocks of size 2^( 5) =       0.000461336687
  error estimate for blocks of size 2^( 6) =       0.000471540228
  error estimate for blocks of size 2^( 7) =       0.000477525049

      target function =                  N/A
              le_mean =     -16.905959182368
             les_mean =     286.144469429382
             stat err =       0.000464738290
             autocorr =       1.297133814614
              std dev =       0.577073409549
             le_variance =       0.333013720008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332813989874
                                         uncertainty =       0.003439703224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332813989874
                                         uncertainty =       0.003439703224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407985021
  error estimate for blocks of size 2^( 2) =       0.000421293594
  error estimate for blocks of size 2^( 3) =       0.000435165224
  error estimate for blocks of size 2^( 4) =       0.000448499371
  error estimate for blocks of size 2^( 5) =       0.000461286765
  error estimate for blocks of size 2^( 6) =       0.000471491294
  error estimate for blocks of size 2^( 7) =       0.000477476805

      target function =                  N/A
              le_mean =     -16.905958599836
             les_mean =     286.144339568092
             stat err =       0.000464688559
             autocorr =       1.297285375913
              std dev =       0.576977950325
             le_variance =       0.332903555161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332706949977
                                         uncertainty =       0.003438566975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332706949977
                                         uncertainty =       0.003438566975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407919407
  error estimate for blocks of size 2^( 2) =       0.000421233275
  error estimate for blocks of size 2^( 3) =       0.000435110700
  error estimate for blocks of size 2^( 4) =       0.000448448954
  error estimate for blocks of size 2^( 5) =       0.000461238257
  error estimate for blocks of size 2^( 6) =       0.000471443689
  error estimate for blocks of size 2^( 7) =       0.000477429977

      target function =                  N/A
              le_mean =     -16.905958147123
             les_mean =     286.144217191523
             stat err =       0.000464640219
             autocorr =       1.297432771245
              std dev =       0.576885158121
             le_variance =       0.332796485661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905958089569        initial
     2.4414e+00     2.4414e+01             6.5571e-04       -16.905959182368  <--
     9.7656e+00     9.7656e+01             1.6907e-04       -16.905958599836
     3.9062e+01     3.9062e+02             4.2614e-05       -16.905958147123

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 3.1857e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.031634e-01 1 1  ON 0
 uu_1                 1.385542e-01 1 1  ON 1
 uu_2                 3.949059e-02 1 1  ON 2
 uu_3                -1.973051e-02 1 1  ON 3
 uu_4                -6.166495e-02 1 1  ON 4
 uu_5                -9.449113e-02 1 1  ON 5
 uu_6                -1.205214e-01 1 1  ON 6
 uu_7                -1.320703e-01 1 1  ON 7
 uu_8                -1.220580e-01 1 1  ON 8
 uu_9                -9.312929e-02 1 1  ON 9
 ud_0                 4.299088e-01 1 1  ON 10
 ud_1                 1.686309e-01 1 1  ON 11
 ud_2                 5.603128e-02 1 1  ON 12
 ud_3                -8.125562e-03 1 1  ON 13
 ud_4                -6.240853e-02 1 1  ON 14
 ud_5                -1.031862e-01 1 1  ON 15
 ud_6                -1.301363e-01 1 1  ON 16
 ud_7                -1.457639e-01 1 1  ON 17
 ud_8                -1.443423e-01 1 1  ON 18
 ud_9                -1.347611e-01 1 1  ON 19
 eO_0                -7.293959e-01 1 1  ON 20
 eO_1                -4.205512e-01 1 1  ON 21
 eO_2                -1.768217e-02 1 1  ON 22
 eO_3                 2.846347e-01 1 1  ON 23
 eO_4                 4.981848e-01 1 1  ON 24
 eO_5                 4.588169e-01 1 1  ON 25
 eO_6                 2.354133e-01 1 1  ON 26
 eO_7                -5.580089e-02 1 1  ON 27
 eO_8                -1.975048e-01 1 1  ON 28
 eO_9                -5.891402e-02 1 1  ON 29
eH1_0                -2.189960e-01 1 1  ON 30
eH1_1                -1.283255e-01 1 1  ON 31
eH1_2                -8.684625e-02 1 1  ON 32
eH1_3                -3.516430e-02 1 1  ON 33
eH1_4                 1.273253e-02 1 1  ON 34
eH1_5                 4.543522e-02 1 1  ON 35
eH1_6                 9.536772e-02 1 1  ON 36
eH1_7                 1.387610e-01 1 1  ON 37
eH1_8                 1.471963e-01 1 1  ON 38
eH1_9                 3.440020e-02 1 1  ON 39
eH2_0                -2.181147e-01 1 1  ON 40
eH2_1                -1.277004e-01 1 1  ON 41
eH2_2                -8.562776e-02 1 1  ON 42
eH2_3                -3.367250e-02 1 1  ON 43
eH2_4                 1.436386e-02 1 1  ON 44
eH2_5                 4.881372e-02 1 1  ON 45
eH2_6                 1.007437e-01 1 1  ON 46
eH2_7                 1.488371e-01 1 1  ON 47
eH2_8                 1.555459e-01 1 1  ON 48
eH2_9                 1.522082e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8675e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9435
    reference variance = 0.193766
====================================================
  Execution time = 2.1065e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3417e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334239041322
                                         uncertainty =       0.006316932554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334239041322
                                         uncertainty =       0.006316932554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408763109
  error estimate for blocks of size 2^( 2) =       0.000422379998
  error estimate for blocks of size 2^( 3) =       0.000436410025
  error estimate for blocks of size 2^( 4) =       0.000449681574
  error estimate for blocks of size 2^( 5) =       0.000462441907
  error estimate for blocks of size 2^( 6) =       0.000473427180
  error estimate for blocks of size 2^( 7) =       0.000481962165

      target function =                  N/A
              le_mean =     -16.906340817882
             les_mean =     286.158534241055
             stat err =       0.000466878206
             autocorr =       1.304559276235
              std dev =       0.578078331863
             le_variance =       0.334174557770


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634081788e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906340817882       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906355739648       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906357410907       residual = 3.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906360223858       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906361027271       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906362620451       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906362570412       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906362874122       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906363127767       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906363268276       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906363247757       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.100470e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906340817882       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906345548397       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906345970522       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906346616018       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906346833618       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906347219774       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906347263217       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906347261512       residual = 7.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906347303954       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906347338542       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 5.806564e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906340817882       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906342085465       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906342192075       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906342348066       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906342401208       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906342494798       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906342512005       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906342506207       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906342513794       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.493458e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.342649 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6586e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.032392e-01 1 1  ON 0
 uu_1                 1.385514e-01 1 1  ON 1
 uu_2                 3.945917e-02 1 1  ON 2
 uu_3                -1.976524e-02 1 1  ON 3
 uu_4                -6.167732e-02 1 1  ON 4
 uu_5                -9.444376e-02 1 1  ON 5
 uu_6                -1.204766e-01 1 1  ON 6
 uu_7                -1.320696e-01 1 1  ON 7
 uu_8                -1.221515e-01 1 1  ON 8
 uu_9                -9.320218e-02 1 1  ON 9
 ud_0                 4.302717e-01 1 1  ON 10
 ud_1                 1.688471e-01 1 1  ON 11
 ud_2                 5.603812e-02 1 1  ON 12
 ud_3                -8.291686e-03 1 1  ON 13
 ud_4                -6.255076e-02 1 1  ON 14
 ud_5                -1.032486e-01 1 1  ON 15
 ud_6                -1.301344e-01 1 1  ON 16
 ud_7                -1.457851e-01 1 1  ON 17
 ud_8                -1.444885e-01 1 1  ON 18
 ud_9                -1.348169e-01 1 1  ON 19
 eO_0                -7.299765e-01 1 1  ON 20
 eO_1                -4.208387e-01 1 1  ON 21
 eO_2                -1.746066e-02 1 1  ON 22
 eO_3                 2.850713e-01 1 1  ON 23
 eO_4                 4.984899e-01 1 1  ON 24
 eO_5                 4.588689e-01 1 1  ON 25
 eO_6                 2.354247e-01 1 1  ON 26
 eO_7                -5.578796e-02 1 1  ON 27
 eO_8                -1.976098e-01 1 1  ON 28
 eO_9                -5.897499e-02 1 1  ON 29
eH1_0                -2.192463e-01 1 1  ON 30
eH1_1                -1.284191e-01 1 1  ON 31
eH1_2                -8.683023e-02 1 1  ON 32
eH1_3                -3.507873e-02 1 1  ON 33
eH1_4                 1.270646e-02 1 1  ON 34
eH1_5                 4.547247e-02 1 1  ON 35
eH1_6                 9.544832e-02 1 1  ON 36
eH1_7                 1.388197e-01 1 1  ON 37
eH1_8                 1.472553e-01 1 1  ON 38
eH1_9                 3.444196e-02 1 1  ON 39
eH2_0                -2.184065e-01 1 1  ON 40
eH2_1                -1.277393e-01 1 1  ON 41
eH2_2                -8.558595e-02 1 1  ON 42
eH2_3                -3.358797e-02 1 1  ON 43
eH2_4                 1.442514e-02 1 1  ON 44
eH2_5                 4.885558e-02 1 1  ON 45
eH2_6                 1.007268e-01 1 1  ON 46
eH2_7                 1.487927e-01 1 1  ON 47
eH2_8                 1.555934e-01 1 1  ON 48
eH2_9                 1.531750e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9005
    reference variance = 0.254125
====================================================
  Execution time = 2.0459e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3536e-01
  Total weights = 2.0000e+06
  Execution time = 1.8902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335211807650
                                         uncertainty =       0.004661785955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335211807650
                                         uncertainty =       0.004661785955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409353588
  error estimate for blocks of size 2^( 2) =       0.000422550197
  error estimate for blocks of size 2^( 3) =       0.000436162537
  error estimate for blocks of size 2^( 4) =       0.000449263973
  error estimate for blocks of size 2^( 5) =       0.000460592112
  error estimate for blocks of size 2^( 6) =       0.000470483813
  error estimate for blocks of size 2^( 7) =       0.000475513515

      target function =                  N/A
              le_mean =     -16.905392500987
             les_mean =     286.127436165398
             stat err =       0.000463963353
             autocorr =       1.284606613723
              std dev =       0.578913396413
             le_variance =       0.335140720547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335962001273
                                         uncertainty =       0.004678257058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335962001273
                                         uncertainty =       0.004678257058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409811251
  error estimate for blocks of size 2^( 2) =       0.000422966314
  error estimate for blocks of size 2^( 3) =       0.000436534742
  error estimate for blocks of size 2^( 4) =       0.000449602819
  error estimate for blocks of size 2^( 5) =       0.000460906326
  error estimate for blocks of size 2^( 6) =       0.000470773305
  error estimate for blocks of size 2^( 7) =       0.000475793756

      target function =                  N/A
              le_mean =     -16.905393703527
             les_mean =     286.128226626050
             stat err =       0.000464269051
             autocorr =       1.283428602325
              std dev =       0.579560629036
             le_variance =       0.335890522728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335657755857
                                         uncertainty =       0.004671465469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335657755857
                                         uncertainty =       0.004671465469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409625697
  error estimate for blocks of size 2^( 2) =       0.000422797166
  error estimate for blocks of size 2^( 3) =       0.000436383263
  error estimate for blocks of size 2^( 4) =       0.000449464842
  error estimate for blocks of size 2^( 5) =       0.000460778874
  error estimate for blocks of size 2^( 6) =       0.000470656670
  error estimate for blocks of size 2^( 7) =       0.000475681063

      target function =                  N/A
              le_mean =     -16.905392571238
             les_mean =     286.127884243245
             stat err =       0.000464145362
             autocorr =       1.283907227067
              std dev =       0.579298216260
             le_variance =       0.335586423362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335271416973
                                         uncertainty =       0.004663069427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335271416973
                                         uncertainty =       0.004663069427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409389971
  error estimate for blocks of size 2^( 2) =       0.000422583158
  error estimate for blocks of size 2^( 3) =       0.000436191948
  error estimate for blocks of size 2^( 4) =       0.000449290704
  error estimate for blocks of size 2^( 5) =       0.000460616984
  error estimate for blocks of size 2^( 6) =       0.000470506889
  error estimate for blocks of size 2^( 7) =       0.000475535898

      target function =                  N/A
              le_mean =     -16.905392402509
             les_mean =     286.127492411612
             stat err =       0.000463987619
             autocorr =       1.284512649307
              std dev =       0.578964849034
             le_variance =       0.335200296417


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905392500987        initial
     6.1035e-01     6.1035e+00             2.1005e-03       -16.905393703527  <--
     2.4414e+00     2.4414e+01             5.8066e-04       -16.905392571238
     9.7656e+00     9.7656e+01             1.4935e-04       -16.905392402509

*****************************************************************************
Applying the update for shift_i =   6.1035e-01     and shift_s =   6.1035e+00
*****************************************************************************

  Execution time = 2.9984e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.034569e-01 1 1  ON 0
 uu_1                 1.385773e-01 1 1  ON 1
 uu_2                 3.939846e-02 1 1  ON 2
 uu_3                -1.987115e-02 1 1  ON 3
 uu_4                -6.174199e-02 1 1  ON 4
 uu_5                -9.434657e-02 1 1  ON 5
 uu_6                -1.203614e-01 1 1  ON 6
 uu_7                -1.320553e-01 1 1  ON 7
 uu_8                -1.224087e-01 1 1  ON 8
 uu_9                -9.341672e-02 1 1  ON 9
 ud_0                 4.311590e-01 1 1  ON 10
 ud_1                 1.693890e-01 1 1  ON 11
 ud_2                 5.610987e-02 1 1  ON 12
 ud_3                -8.654789e-03 1 1  ON 13
 ud_4                -6.293293e-02 1 1  ON 14
 ud_5                -1.034293e-01 1 1  ON 15
 ud_6                -1.301374e-01 1 1  ON 16
 ud_7                -1.458228e-01 1 1  ON 17
 ud_8                -1.448795e-01 1 1  ON 18
 ud_9                -1.349769e-01 1 1  ON 19
 eO_0                -7.314964e-01 1 1  ON 20
 eO_1                -4.216428e-01 1 1  ON 21
 eO_2                -1.698834e-02 1 1  ON 22
 eO_3                 2.862212e-01 1 1  ON 23
 eO_4                 4.993911e-01 1 1  ON 24
 eO_5                 4.590807e-01 1 1  ON 25
 eO_6                 2.354745e-01 1 1  ON 26
 eO_7                -5.574409e-02 1 1  ON 27
 eO_8                -1.979174e-01 1 1  ON 28
 eO_9                -5.915619e-02 1 1  ON 29
eH1_0                -2.199312e-01 1 1  ON 30
eH1_1                -1.286659e-01 1 1  ON 31
eH1_2                -8.680727e-02 1 1  ON 32
eH1_3                -3.489512e-02 1 1  ON 33
eH1_4                 1.263175e-02 1 1  ON 34
eH1_5                 4.556385e-02 1 1  ON 35
eH1_6                 9.569302e-02 1 1  ON 36
eH1_7                 1.390040e-01 1 1  ON 37
eH1_8                 1.474348e-01 1 1  ON 38
eH1_9                 3.456790e-02 1 1  ON 39
eH2_0                -2.191831e-01 1 1  ON 40
eH2_1                -1.278525e-01 1 1  ON 41
eH2_2                -8.548762e-02 1 1  ON 42
eH2_3                -3.338386e-02 1 1  ON 43
eH2_4                 1.456899e-02 1 1  ON 44
eH2_5                 4.897265e-02 1 1  ON 45
eH2_6                 1.006935e-01 1 1  ON 46
eH2_7                 1.486698e-01 1 1  ON 47
eH2_8                 1.557335e-01 1 1  ON 48
eH2_9                 1.560505e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6576e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8559
    reference variance = 0.577359
====================================================
  Execution time = 2.0686e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3966e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339711295056
                                         uncertainty =       0.007279741710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339711295056
                                         uncertainty =       0.007279741710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412105030
  error estimate for blocks of size 2^( 2) =       0.000425460170
  error estimate for blocks of size 2^( 3) =       0.000439201440
  error estimate for blocks of size 2^( 4) =       0.000452472882
  error estimate for blocks of size 2^( 5) =       0.000464563182
  error estimate for blocks of size 2^( 6) =       0.000473281034
  error estimate for blocks of size 2^( 7) =       0.000481752634

      target function =                  N/A
              le_mean =     -16.906791750296
             les_mean =     286.179268229681
             stat err =       0.000468017433
             autocorr =       1.289757997334
              std dev =       0.582804522661
             le_variance =       0.339661111634


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690679175030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906791750296       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906801055742       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906808722145       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906823977224       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906830664023       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906831018454       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906833224265       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906834891350       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906834129418       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906833770223       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906834091323       residual = 5.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906834411691       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906834571847       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 5.960751e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906791750296       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906795769929       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906799158409       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906805312448       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906806622315       residual = 2.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906806344724       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906806281411       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906806653989       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906806676719       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906806563558       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906806577435       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 1.977562e-03

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906791750296       residual = 2.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906792978738       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906794049672       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906795884720       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906796010314       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906795958740       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906795869760       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906795936616       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906795950814       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 5.566092e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6225e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.036296e-01 1 1  ON 0
 uu_1                 1.386343e-01 1 1  ON 1
 uu_2                 3.932421e-02 1 1  ON 2
 uu_3                -1.998717e-02 1 1  ON 3
 uu_4                -6.187651e-02 1 1  ON 4
 uu_5                -9.431604e-02 1 1  ON 5
 uu_6                -1.204144e-01 1 1  ON 6
 uu_7                -1.320655e-01 1 1  ON 7
 uu_8                -1.226486e-01 1 1  ON 8
 uu_9                -9.345188e-02 1 1  ON 9
 ud_0                 4.320725e-01 1 1  ON 10
 ud_1                 1.699947e-01 1 1  ON 11
 ud_2                 5.615138e-02 1 1  ON 12
 ud_3                -9.132705e-03 1 1  ON 13
 ud_4                -6.344529e-02 1 1  ON 14
 ud_5                -1.036842e-01 1 1  ON 15
 ud_6                -1.303009e-01 1 1  ON 16
 ud_7                -1.459147e-01 1 1  ON 17
 ud_8                -1.449694e-01 1 1  ON 18
 ud_9                -1.348904e-01 1 1  ON 19
 eO_0                -7.334739e-01 1 1  ON 20
 eO_1                -4.223517e-01 1 1  ON 21
 eO_2                -1.662421e-02 1 1  ON 22
 eO_3                 2.875300e-01 1 1  ON 23
 eO_4                 5.004022e-01 1 1  ON 24
 eO_5                 4.594051e-01 1 1  ON 25
 eO_6                 2.355267e-01 1 1  ON 26
 eO_7                -5.565696e-02 1 1  ON 27
 eO_8                -1.981572e-01 1 1  ON 28
 eO_9                -5.933676e-02 1 1  ON 29
eH1_0                -2.209182e-01 1 1  ON 30
eH1_1                -1.289457e-01 1 1  ON 31
eH1_2                -8.680308e-02 1 1  ON 32
eH1_3                -3.482999e-02 1 1  ON 33
eH1_4                 1.272881e-02 1 1  ON 34
eH1_5                 4.573135e-02 1 1  ON 35
eH1_6                 9.589745e-02 1 1  ON 36
eH1_7                 1.390485e-01 1 1  ON 37
eH1_8                 1.477262e-01 1 1  ON 38
eH1_9                 3.490490e-02 1 1  ON 39
eH2_0                -2.199951e-01 1 1  ON 40
eH2_1                -1.279587e-01 1 1  ON 41
eH2_2                -8.543610e-02 1 1  ON 42
eH2_3                -3.325036e-02 1 1  ON 43
eH2_4                 1.461757e-02 1 1  ON 44
eH2_5                 4.891532e-02 1 1  ON 45
eH2_6                 1.007884e-01 1 1  ON 46
eH2_7                 1.486816e-01 1 1  ON 47
eH2_8                 1.559989e-01 1 1  ON 48
eH2_9                 1.597310e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8834
    reference variance = 0.496076
====================================================
  Execution time = 2.0125e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4076e-01
  Total weights = 2.0000e+06
  Execution time = 1.8959e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340132013083
                                         uncertainty =       0.008502133616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340132013083
                                         uncertainty =       0.008502133616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412397622
  error estimate for blocks of size 2^( 2) =       0.000425248834
  error estimate for blocks of size 2^( 3) =       0.000439033117
  error estimate for blocks of size 2^( 4) =       0.000451575813
  error estimate for blocks of size 2^( 5) =       0.000464606928
  error estimate for blocks of size 2^( 6) =       0.000473524312
  error estimate for blocks of size 2^( 7) =       0.000479631240

      target function =                  N/A
              le_mean =     -16.906511414681
             les_mean =     286.170271642511
             stat err =       0.000467334573
             autocorr =       1.284172948727
              std dev =       0.583218310619
             le_variance =       0.340143597841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341884906921
                                         uncertainty =       0.008593540696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341884906921
                                         uncertainty =       0.008593540696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413458833
  error estimate for blocks of size 2^( 2) =       0.000426236710
  error estimate for blocks of size 2^( 3) =       0.000439930666
  error estimate for blocks of size 2^( 4) =       0.000452411599
  error estimate for blocks of size 2^( 5) =       0.000465402800
  error estimate for blocks of size 2^( 6) =       0.000474279974
  error estimate for blocks of size 2^( 7) =       0.000480436879

      target function =                  N/A
              le_mean =     -16.906518850080
             les_mean =     286.172275870890
             stat err =       0.000468132813
             autocorr =       1.281957467939
              std dev =       0.584719089587
             le_variance =       0.341896413727

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341387325496
                                         uncertainty =       0.008569208944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341387325496
                                         uncertainty =       0.008569208944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413157937
  error estimate for blocks of size 2^( 2) =       0.000425953692
  error estimate for blocks of size 2^( 3) =       0.000439671684
  error estimate for blocks of size 2^( 4) =       0.000452173640
  error estimate for blocks of size 2^( 5) =       0.000465178374
  error estimate for blocks of size 2^( 6) =       0.000474067212
  error estimate for blocks of size 2^( 7) =       0.000480208721

      target function =                  N/A
              le_mean =     -16.906514805232
             les_mean =     286.171641651242
             stat err =       0.000467906986
             autocorr =       1.282587072162
              std dev =       0.584293558427
             le_variance =       0.341398962419

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340310112670
                                         uncertainty =       0.008511867538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340310112670
                                         uncertainty =       0.008511867538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412505588
  error estimate for blocks of size 2^( 2) =       0.000425348205
  error estimate for blocks of size 2^( 3) =       0.000439122435
  error estimate for blocks of size 2^( 4) =       0.000451659211
  error estimate for blocks of size 2^( 5) =       0.000464686585
  error estimate for blocks of size 2^( 6) =       0.000473599857
  error estimate for blocks of size 2^( 7) =       0.000479711497

      target function =                  N/A
              le_mean =     -16.906511024662
             les_mean =     286.170436577740
             stat err =       0.000467414288
             autocorr =       1.283938713134
              std dev =       0.583370997629
             le_variance =       0.340321720875


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906511414681        initial
     1.5259e-01     1.5259e+00             5.9608e-03       -16.906518850080  <--
     6.1035e-01     6.1035e+00             1.9776e-03       -16.906514805232
     2.4414e+00     2.4414e+01             5.5661e-04       -16.906511024662

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9680e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.041798e-01 1 1  ON 0
 uu_1                 1.389493e-01 1 1  ON 1
 uu_2                 3.929701e-02 1 1  ON 2
 uu_3                -2.026675e-02 1 1  ON 3
 uu_4                -6.231296e-02 1 1  ON 4
 uu_5                -9.450295e-02 1 1  ON 5
 uu_6                -1.206230e-01 1 1  ON 6
 uu_7                -1.321878e-01 1 1  ON 7
 uu_8                -1.232984e-01 1 1  ON 8
 uu_9                -9.358566e-02 1 1  ON 9
 ud_0                 4.337430e-01 1 1  ON 10
 ud_1                 1.711138e-01 1 1  ON 11
 ud_2                 5.644011e-02 1 1  ON 12
 ud_3                -9.754379e-03 1 1  ON 13
 ud_4                -6.444043e-02 1 1  ON 14
 ud_5                -1.043676e-01 1 1  ON 15
 ud_6                -1.307154e-01 1 1  ON 16
 ud_7                -1.461228e-01 1 1  ON 17
 ud_8                -1.452000e-01 1 1  ON 18
 ud_9                -1.346498e-01 1 1  ON 19
 eO_0                -7.374571e-01 1 1  ON 20
 eO_1                -4.243876e-01 1 1  ON 21
 eO_2                -1.634865e-02 1 1  ON 22
 eO_3                 2.899778e-01 1 1  ON 23
 eO_4                 5.030971e-01 1 1  ON 24
 eO_5                 4.607731e-01 1 1  ON 25
 eO_6                 2.358776e-01 1 1  ON 26
 eO_7                -5.540830e-02 1 1  ON 27
 eO_8                -1.988651e-01 1 1  ON 28
 eO_9                -5.987361e-02 1 1  ON 29
eH1_0                -2.230284e-01 1 1  ON 30
eH1_1                -1.297001e-01 1 1  ON 31
eH1_2                -8.704363e-02 1 1  ON 32
eH1_3                -3.490004e-02 1 1  ON 33
eH1_4                 1.277683e-02 1 1  ON 34
eH1_5                 4.599029e-02 1 1  ON 35
eH1_6                 9.649867e-02 1 1  ON 36
eH1_7                 1.392766e-01 1 1  ON 37
eH1_8                 1.485977e-01 1 1  ON 38
eH1_9                 3.590546e-02 1 1  ON 39
eH2_0                -2.216699e-01 1 1  ON 40
eH2_1                -1.283790e-01 1 1  ON 41
eH2_2                -8.548628e-02 1 1  ON 42
eH2_3                -3.313672e-02 1 1  ON 43
eH2_4                 1.459741e-02 1 1  ON 44
eH2_5                 4.869061e-02 1 1  ON 45
eH2_6                 1.010769e-01 1 1  ON 46
eH2_7                 1.487811e-01 1 1  ON 47
eH2_8                 1.567850e-01 1 1  ON 48
eH2_9                 1.706715e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6896e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8708
    reference variance = 0.251608
====================================================
  Execution time = 2.0644e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3549e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335558611629
                                         uncertainty =       0.003318451884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335558611629
                                         uncertainty =       0.003318451884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409569911
  error estimate for blocks of size 2^( 2) =       0.000422783924
  error estimate for blocks of size 2^( 3) =       0.000436827027
  error estimate for blocks of size 2^( 4) =       0.000450263197
  error estimate for blocks of size 2^( 5) =       0.000462935533
  error estimate for blocks of size 2^( 6) =       0.000471046275
  error estimate for blocks of size 2^( 7) =       0.000475246722

      target function =                  N/A
              le_mean =     -16.906781201642
             les_mean =     286.174745456493
             stat err =       0.000464872931
             autocorr =       1.288286424170
              std dev =       0.579219322924
             le_variance =       0.335495024048


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690678120164e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906781201642       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906786510462       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906799240774       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906813866825       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906820037255       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906828403003       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906837094460       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906848331845       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906849273160       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906845778928       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906846222397       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906849508459       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906851318215       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906849826032       residual = 5.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906849416839       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906849207234       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906848975631       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 1.075602e-02

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906781201642       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906784837416       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906791641139       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906799644761       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906800625932       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906803418717       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906808076799       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906810016049       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906809075405       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906807877672       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906807890220       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906808332337       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 4.042147e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906781201642       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906782809979       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906785063110       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906787619228       residual = 2.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906787638892       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906788098867       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906788934644       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906789610557       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906789410077       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906789235270       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 1.202530e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.353177 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6179e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.047186e-01 1 1  ON 0
 uu_1                 1.394791e-01 1 1  ON 1
 uu_2                 3.950827e-02 1 1  ON 2
 uu_3                -2.062265e-02 1 1  ON 3
 uu_4                -6.277752e-02 1 1  ON 4
 uu_5                -9.479828e-02 1 1  ON 5
 uu_6                -1.207007e-01 1 1  ON 6
 uu_7                -1.325612e-01 1 1  ON 7
 uu_8                -1.239084e-01 1 1  ON 8
 uu_9                -9.413896e-02 1 1  ON 9
 ud_0                 4.357185e-01 1 1  ON 10
 ud_1                 1.722901e-01 1 1  ON 11
 ud_2                 5.715961e-02 1 1  ON 12
 ud_3                -1.001659e-02 1 1  ON 13
 ud_4                -6.526204e-02 1 1  ON 14
 ud_5                -1.048994e-01 1 1  ON 15
 ud_6                -1.305466e-01 1 1  ON 16
 ud_7                -1.460820e-01 1 1  ON 17
 ud_8                -1.463273e-01 1 1  ON 18
 ud_9                -1.355289e-01 1 1  ON 19
 eO_0                -7.414992e-01 1 1  ON 20
 eO_1                -4.274072e-01 1 1  ON 21
 eO_2                -1.632163e-02 1 1  ON 22
 eO_3                 2.926728e-01 1 1  ON 23
 eO_4                 5.065817e-01 1 1  ON 24
 eO_5                 4.627950e-01 1 1  ON 25
 eO_6                 2.365774e-01 1 1  ON 26
 eO_7                -5.502423e-02 1 1  ON 27
 eO_8                -1.999817e-01 1 1  ON 28
 eO_9                -6.086285e-02 1 1  ON 29
eH1_0                -2.251354e-01 1 1  ON 30
eH1_1                -1.304894e-01 1 1  ON 31
eH1_2                -8.727930e-02 1 1  ON 32
eH1_3                -3.491521e-02 1 1  ON 33
eH1_4                 1.261997e-02 1 1  ON 34
eH1_5                 4.624929e-02 1 1  ON 35
eH1_6                 9.704752e-02 1 1  ON 36
eH1_7                 1.398567e-01 1 1  ON 37
eH1_8                 1.495539e-01 1 1  ON 38
eH1_9                 3.681755e-02 1 1  ON 39
eH2_0                -2.237778e-01 1 1  ON 40
eH2_1                -1.291873e-01 1 1  ON 41
eH2_2                -8.587619e-02 1 1  ON 42
eH2_3                -3.323546e-02 1 1  ON 43
eH2_4                 1.439766e-02 1 1  ON 44
eH2_5                 4.873301e-02 1 1  ON 45
eH2_6                 1.018020e-01 1 1  ON 46
eH2_7                 1.487996e-01 1 1  ON 47
eH2_8                 1.576922e-01 1 1  ON 48
eH2_9                 1.862590e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9927
    reference variance = 0.299378
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3712e-01
  Total weights = 2.0000e+06
  Execution time = 1.8841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336106186883
                                         uncertainty =       0.006838362223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336106186883
                                         uncertainty =       0.006838362223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409909873
  error estimate for blocks of size 2^( 2) =       0.000423004650
  error estimate for blocks of size 2^( 3) =       0.000437107418
  error estimate for blocks of size 2^( 4) =       0.000450953314
  error estimate for blocks of size 2^( 5) =       0.000462125471
  error estimate for blocks of size 2^( 6) =       0.000472413660
  error estimate for blocks of size 2^( 7) =       0.000478266221

      target function =                  N/A
              le_mean =     -16.906372816023
             les_mean =     286.161493834679
             stat err =       0.000465939667
             autocorr =       1.292059789738
              std dev =       0.579700102078
             le_variance =       0.336052208349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338533510176
                                         uncertainty =       0.006894196156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338533510176
                                         uncertainty =       0.006894196156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411387411
  error estimate for blocks of size 2^( 2) =       0.000424410446
  error estimate for blocks of size 2^( 3) =       0.000438405790
  error estimate for blocks of size 2^( 4) =       0.000452163403
  error estimate for blocks of size 2^( 5) =       0.000463263388
  error estimate for blocks of size 2^( 6) =       0.000473500852
  error estimate for blocks of size 2^( 7) =       0.000479366330

      target function =                  N/A
              le_mean =     -16.906381482882
             les_mean =     286.164213879435
             stat err =       0.000467073493
             autocorr =       1.289046095139
              std dev =       0.581789656100
             le_variance =       0.338479203944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338283122425
                                         uncertainty =       0.006882424759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338283122425
                                         uncertainty =       0.006882424759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411235335
  error estimate for blocks of size 2^( 2) =       0.000424263960
  error estimate for blocks of size 2^( 3) =       0.000438278139
  error estimate for blocks of size 2^( 4) =       0.000452063040
  error estimate for blocks of size 2^( 5) =       0.000463189024
  error estimate for blocks of size 2^( 6) =       0.000473440007
  error estimate for blocks of size 2^( 7) =       0.000479312398

      target function =                  N/A
              le_mean =     -16.906383063951
             les_mean =     286.164017136967
             stat err =       0.000467001117
             autocorr =       1.289599902882
              std dev =       0.581574587669
             le_variance =       0.338229001022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336471751872
                                         uncertainty =       0.006844517835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336471751872
                                         uncertainty =       0.006844517835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410132764
  error estimate for blocks of size 2^( 2) =       0.000423214546
  error estimate for blocks of size 2^( 3) =       0.000437301912
  error estimate for blocks of size 2^( 4) =       0.000451138894
  error estimate for blocks of size 2^( 5) =       0.000462305314
  error estimate for blocks of size 2^( 6) =       0.000472587924
  error estimate for blocks of size 2^( 7) =       0.000478446783

      target function =                  N/A
              le_mean =     -16.906372412786
             les_mean =     286.161845760445
             stat err =       0.000466119729
             autocorr =       1.291653543287
              std dev =       0.580015317752
             le_variance =       0.336417768827


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906372816023        initial
     3.8147e-02     3.8147e-01             1.0756e-02       -16.906381482882
     1.5259e-01     1.5259e+00             4.0421e-03       -16.906383063951  <--
     6.1035e-01     6.1035e+00             1.2025e-03       -16.906372412786

*****************************************************************************
Applying the update for shift_i =   1.5259e-01     and shift_s =   1.5259e+00
*****************************************************************************

  Execution time = 2.9802e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.047186e-01 1 1  ON 0
 uu_1                 1.394791e-01 1 1  ON 1
 uu_2                 3.950827e-02 1 1  ON 2
 uu_3                -2.062265e-02 1 1  ON 3
 uu_4                -6.277752e-02 1 1  ON 4
 uu_5                -9.479828e-02 1 1  ON 5
 uu_6                -1.207007e-01 1 1  ON 6
 uu_7                -1.325612e-01 1 1  ON 7
 uu_8                -1.239084e-01 1 1  ON 8
 uu_9                -9.413896e-02 1 1  ON 9
 ud_0                 4.357185e-01 1 1  ON 10
 ud_1                 1.722901e-01 1 1  ON 11
 ud_2                 5.715961e-02 1 1  ON 12
 ud_3                -1.001659e-02 1 1  ON 13
 ud_4                -6.526204e-02 1 1  ON 14
 ud_5                -1.048994e-01 1 1  ON 15
 ud_6                -1.305466e-01 1 1  ON 16
 ud_7                -1.460820e-01 1 1  ON 17
 ud_8                -1.463273e-01 1 1  ON 18
 ud_9                -1.355289e-01 1 1  ON 19
 eO_0                -7.414992e-01 1 1  ON 20
 eO_1                -4.274072e-01 1 1  ON 21
 eO_2                -1.632163e-02 1 1  ON 22
 eO_3                 2.926728e-01 1 1  ON 23
 eO_4                 5.065817e-01 1 1  ON 24
 eO_5                 4.627950e-01 1 1  ON 25
 eO_6                 2.365774e-01 1 1  ON 26
 eO_7                -5.502423e-02 1 1  ON 27
 eO_8                -1.999817e-01 1 1  ON 28
 eO_9                -6.086285e-02 1 1  ON 29
eH1_0                -2.251354e-01 1 1  ON 30
eH1_1                -1.304894e-01 1 1  ON 31
eH1_2                -8.727930e-02 1 1  ON 32
eH1_3                -3.491521e-02 1 1  ON 33
eH1_4                 1.261997e-02 1 1  ON 34
eH1_5                 4.624929e-02 1 1  ON 35
eH1_6                 9.704752e-02 1 1  ON 36
eH1_7                 1.398567e-01 1 1  ON 37
eH1_8                 1.495539e-01 1 1  ON 38
eH1_9                 3.681755e-02 1 1  ON 39
eH2_0                -2.237778e-01 1 1  ON 40
eH2_1                -1.291873e-01 1 1  ON 41
eH2_2                -8.587619e-02 1 1  ON 42
eH2_3                -3.323546e-02 1 1  ON 43
eH2_4                 1.439766e-02 1 1  ON 44
eH2_5                 4.873301e-02 1 1  ON 45
eH2_6                 1.018020e-01 1 1  ON 46
eH2_7                 1.487996e-01 1 1  ON 47
eH2_8                 1.576922e-01 1 1  ON 48
eH2_9                 1.862590e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6003e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9579
    reference variance = 0.284995
====================================================
  Execution time = 2.0858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3851e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338332327259
                                         uncertainty =       0.004265999422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338332327259
                                         uncertainty =       0.004265999422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411408008
  error estimate for blocks of size 2^( 2) =       0.000424302656
  error estimate for blocks of size 2^( 3) =       0.000437227530
  error estimate for blocks of size 2^( 4) =       0.000449593017
  error estimate for blocks of size 2^( 5) =       0.000460097041
  error estimate for blocks of size 2^( 6) =       0.000468906151
  error estimate for blocks of size 2^( 7) =       0.000475645726

      target function =                  N/A
              le_mean =     -16.906356496926
             les_mean =     286.163402930779
             stat err =       0.000463560484
             autocorr =       1.269601223921
              std dev =       0.581818785262
             le_variance =       0.338513098884


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635649693e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906356496926       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906359804271       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906363854849       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371853646       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906377303331       residual = 6.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906384811268       residual = 3.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906391844750       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906398109400       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906398479430       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906398900665       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906397976027       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906397365051       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906396300419       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906397728282       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906398556723       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906398793161       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906398827899       residual = 6.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         16 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 8.448700e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906356496926       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906358423001       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906360448127       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906363398422       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906365602773       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906370353650       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906371445955       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906373140594       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906372901996       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906372259331       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906371933775       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906372019984       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 3.102268e-03

solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906356496926       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906357218154       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906357967755       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906358524473       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906358900129       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906360663165       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906361116444       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906361221682       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906361124486       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 9.212058e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.359164 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6489e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.056563e-01 1 1  ON 0
 uu_1                 1.399565e-01 1 1  ON 1
 uu_2                 3.967713e-02 1 1  ON 2
 uu_3                -2.060148e-02 1 1  ON 3
 uu_4                -6.304026e-02 1 1  ON 4
 uu_5                -9.505134e-02 1 1  ON 5
 uu_6                -1.210351e-01 1 1  ON 6
 uu_7                -1.327634e-01 1 1  ON 7
 uu_8                -1.244858e-01 1 1  ON 8
 uu_9                -9.486390e-02 1 1  ON 9
 ud_0                 4.372602e-01 1 1  ON 10
 ud_1                 1.735312e-01 1 1  ON 11
 ud_2                 5.782634e-02 1 1  ON 12
 ud_3                -9.967634e-03 1 1  ON 13
 ud_4                -6.568527e-02 1 1  ON 14
 ud_5                -1.054809e-01 1 1  ON 15
 ud_6                -1.310095e-01 1 1  ON 16
 ud_7                -1.461137e-01 1 1  ON 17
 ud_8                -1.470178e-01 1 1  ON 18
 ud_9                -1.362024e-01 1 1  ON 19
 eO_0                -7.446015e-01 1 1  ON 20
 eO_1                -4.295968e-01 1 1  ON 21
 eO_2                -1.655312e-02 1 1  ON 22
 eO_3                 2.943462e-01 1 1  ON 23
 eO_4                 5.096186e-01 1 1  ON 24
 eO_5                 4.646531e-01 1 1  ON 25
 eO_6                 2.376484e-01 1 1  ON 26
 eO_7                -5.475853e-02 1 1  ON 27
 eO_8                -2.011809e-01 1 1  ON 28
 eO_9                -6.184641e-02 1 1  ON 29
eH1_0                -2.266943e-01 1 1  ON 30
eH1_1                -1.311886e-01 1 1  ON 31
eH1_2                -8.758549e-02 1 1  ON 32
eH1_3                -3.519884e-02 1 1  ON 33
eH1_4                 1.232056e-02 1 1  ON 34
eH1_5                 4.574002e-02 1 1  ON 35
eH1_6                 9.768714e-02 1 1  ON 36
eH1_7                 1.406132e-01 1 1  ON 37
eH1_8                 1.506823e-01 1 1  ON 38
eH1_9                 3.795550e-02 1 1  ON 39
eH2_0                -2.250481e-01 1 1  ON 40
eH2_1                -1.294954e-01 1 1  ON 41
eH2_2                -8.572784e-02 1 1  ON 42
eH2_3                -3.300204e-02 1 1  ON 43
eH2_4                 1.430363e-02 1 1  ON 44
eH2_5                 4.855655e-02 1 1  ON 45
eH2_6                 1.016295e-01 1 1  ON 46
eH2_7                 1.487039e-01 1 1  ON 47
eH2_8                 1.585155e-01 1 1  ON 48
eH2_9                 1.968896e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8582
    reference variance = 0.272705
====================================================
  Execution time = 2.0430e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3606e-01
  Total weights = 2.0000e+06
  Execution time = 1.8815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335304552398
                                         uncertainty =       0.003827155059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335304552398
                                         uncertainty =       0.003827155059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409411591
  error estimate for blocks of size 2^( 2) =       0.000422856808
  error estimate for blocks of size 2^( 3) =       0.000436655133
  error estimate for blocks of size 2^( 4) =       0.000449751537
  error estimate for blocks of size 2^( 5) =       0.000461877402
  error estimate for blocks of size 2^( 6) =       0.000471386356
  error estimate for blocks of size 2^( 7) =       0.000479299510

      target function =                  N/A
              le_mean =     -16.906828610798
             les_mean =     286.176089208439
             stat err =       0.000465578701
             autocorr =       1.293200732344
              std dev =       0.578995424135
             le_variance =       0.335235701170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337231506488
                                         uncertainty =       0.003848856457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337231506488
                                         uncertainty =       0.003848856457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410586335
  error estimate for blocks of size 2^( 2) =       0.000423976150
  error estimate for blocks of size 2^( 3) =       0.000437682982
  error estimate for blocks of size 2^( 4) =       0.000450682933
  error estimate for blocks of size 2^( 5) =       0.000462746999
  error estimate for blocks of size 2^( 6) =       0.000472199741
  error estimate for blocks of size 2^( 7) =       0.000480074045

      target function =                  N/A
              le_mean =     -16.906842004519
             les_mean =     286.178468674027
             stat err =       0.000466425930
             autocorr =       1.290495187215
              std dev =       0.580656763370
             le_variance =       0.337162276847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336987324044
                                         uncertainty =       0.003843997340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336987324044
                                         uncertainty =       0.003843997340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410437623
  error estimate for blocks of size 2^( 2) =       0.000423833165
  error estimate for blocks of size 2^( 3) =       0.000437559446
  error estimate for blocks of size 2^( 4) =       0.000450584139
  error estimate for blocks of size 2^( 5) =       0.000462672567
  error estimate for blocks of size 2^( 6) =       0.000472136233
  error estimate for blocks of size 2^( 7) =       0.000480026094

      target function =                  N/A
              le_mean =     -16.906835950844
             les_mean =     286.178019784279
             stat err =       0.000466354758
             autocorr =       1.291036431956
              std dev =       0.580446452289
             le_variance =       0.336918083975

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335583078781
                                         uncertainty =       0.003829825424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335583078781
                                         uncertainty =       0.003829825424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409581593
  error estimate for blocks of size 2^( 2) =       0.000423017689
  error estimate for blocks of size 2^( 3) =       0.000436804298
  error estimate for blocks of size 2^( 4) =       0.000449889328
  error estimate for blocks of size 2^( 5) =       0.000462010510
  error estimate for blocks of size 2^( 6) =       0.000471511918
  error estimate for blocks of size 2^( 7) =       0.000479420817

      target function =                  N/A
              le_mean =     -16.906827723577
             les_mean =     286.176337669357
             stat err =       0.000465708143
             autocorr =       1.292846020444
              std dev =       0.579235843505
             le_variance =       0.335514162401


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906828610798        initial
     3.8147e-02     3.8147e-01             8.4487e-03       -16.906842004519  <--
     1.5259e-01     1.5259e+00             3.1023e-03       -16.906835950844
     6.1035e-01     6.1035e+00             9.2121e-04       -16.906827723577

*****************************************************************************
Applying the update for shift_i =   3.8147e-02     and shift_s =   3.8147e-01
*****************************************************************************

  Execution time = 2.9921e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.071823e-01 1 1  ON 0
 uu_1                 1.410627e-01 1 1  ON 1
 uu_2                 4.039955e-02 1 1  ON 2
 uu_3                -2.039194e-02 1 1  ON 3
 uu_4                -6.338502e-02 1 1  ON 4
 uu_5                -9.576235e-02 1 1  ON 5
 uu_6                -1.219118e-01 1 1  ON 6
 uu_7                -1.336686e-01 1 1  ON 7
 uu_8                -1.255877e-01 1 1  ON 8
 uu_9                -9.664626e-02 1 1  ON 9
 ud_0                 4.396238e-01 1 1  ON 10
 ud_1                 1.755330e-01 1 1  ON 11
 ud_2                 5.927865e-02 1 1  ON 12
 ud_3                -9.278056e-03 1 1  ON 13
 ud_4                -6.580747e-02 1 1  ON 14
 ud_5                -1.060694e-01 1 1  ON 15
 ud_6                -1.318319e-01 1 1  ON 16
 ud_7                -1.466728e-01 1 1  ON 17
 ud_8                -1.479118e-01 1 1  ON 18
 ud_9                -1.376982e-01 1 1  ON 19
 eO_0                -7.499479e-01 1 1  ON 20
 eO_1                -4.335200e-01 1 1  ON 21
 eO_2                -1.798450e-02 1 1  ON 22
 eO_3                 2.964963e-01 1 1  ON 23
 eO_4                 5.147399e-01 1 1  ON 24
 eO_5                 4.699347e-01 1 1  ON 25
 eO_6                 2.415935e-01 1 1  ON 26
 eO_7                -5.364387e-02 1 1  ON 27
 eO_8                -2.045160e-01 1 1  ON 28
 eO_9                -6.480476e-02 1 1  ON 29
eH1_0                -2.294931e-01 1 1  ON 30
eH1_1                -1.331455e-01 1 1  ON 31
eH1_2                -8.913044e-02 1 1  ON 32
eH1_3                -3.641866e-02 1 1  ON 33
eH1_4                 1.106741e-02 1 1  ON 34
eH1_5                 4.453263e-02 1 1  ON 35
eH1_6                 9.832144e-02 1 1  ON 36
eH1_7                 1.427627e-01 1 1  ON 37
eH1_8                 1.542693e-01 1 1  ON 38
eH1_9                 4.154205e-02 1 1  ON 39
eH2_0                -2.269432e-01 1 1  ON 40
eH2_1                -1.303741e-01 1 1  ON 41
eH2_2                -8.626787e-02 1 1  ON 42
eH2_3                -3.327829e-02 1 1  ON 43
eH2_4                 1.380344e-02 1 1  ON 44
eH2_5                 4.774659e-02 1 1  ON 45
eH2_6                 1.011405e-01 1 1  ON 46
eH2_7                 1.488281e-01 1 1  ON 47
eH2_8                 1.609864e-01 1 1  ON 48
eH2_9                 2.291592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.8726
    reference variance = 0.347
====================================================
  Execution time = 2.0933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218087955
                                         uncertainty =       0.007017808835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344218087955
                                         uncertainty =       0.007017808835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414908512
  error estimate for blocks of size 2^( 2) =       0.000427579868
  error estimate for blocks of size 2^( 3) =       0.000440898090
  error estimate for blocks of size 2^( 4) =       0.000453469147
  error estimate for blocks of size 2^( 5) =       0.000463771743
  error estimate for blocks of size 2^( 6) =       0.000473026151
  error estimate for blocks of size 2^( 7) =       0.000479211406

      target function =                  N/A
              le_mean =     -16.906010634227
             les_mean =     286.157493538881
             stat err =       0.000467369612
             autocorr =       1.268867441376
              std dev =       0.586769244608
             le_variance =       0.344298146418


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690601063423e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906010634227       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906014693907       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906026665779       residual = 7.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906021442220       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906028884539       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906030326534       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906036220926       residual = 5.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906031365197       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906042153359       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906047581899       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906054040595       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906056104742       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906054976494       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906057245663       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906056766584       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906063073608       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906061099472       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906060417586       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906060468007       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906061527745       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.906061985150       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906062246990       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906061911396       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-03 is 2.443906e-02

solving harmonic davidson linear method for identity shift 3.8147e-02, overlap shift 3.8147e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906010634227       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906014313839       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906023768161       residual = 5.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906019023568       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906024632987       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906024909940       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906027638199       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906024230107       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906028673745       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906030062806       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906030960773       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906031183153       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906030392104       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906030565796       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906030773650       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906030919625       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         15 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-02 is 6.842194e-03

solving harmonic davidson linear method for identity shift 1.5259e-01, overlap shift 1.5259e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906010634227       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906013311319       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906016281058       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906020479899       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906017602096       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906018198757       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906018110282       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906017996968       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906017759179       residual = 5.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906018586409       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906018652482       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e-01 is 2.186570e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.454975 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6556e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.080421e-01 1 1  ON 0
 uu_1                 1.419243e-01 1 1  ON 1
 uu_2                 4.100494e-02 1 1  ON 2
 uu_3                -2.024790e-02 1 1  ON 3
 uu_4                -6.379968e-02 1 1  ON 4
 uu_5                -9.682053e-02 1 1  ON 5
 uu_6                -1.222084e-01 1 1  ON 6
 uu_7                -1.343399e-01 1 1  ON 7
 uu_8                -1.278317e-01 1 1  ON 8
 uu_9                -9.933925e-02 1 1  ON 9
 ud_0                 4.413763e-01 1 1  ON 10
 ud_1                 1.770937e-01 1 1  ON 11
 ud_2                 6.049212e-02 1 1  ON 12
 ud_3                -8.766292e-03 1 1  ON 13
 ud_4                -6.595561e-02 1 1  ON 14
 ud_5                -1.069339e-01 1 1  ON 15
 ud_6                -1.335890e-01 1 1  ON 16
 ud_7                -1.484440e-01 1 1  ON 17
 ud_8                -1.493102e-01 1 1  ON 18
 ud_9                -1.376957e-01 1 1  ON 19
 eO_0                -7.543350e-01 1 1  ON 20
 eO_1                -4.368966e-01 1 1  ON 21
 eO_2                -1.919163e-02 1 1  ON 22
 eO_3                 2.973224e-01 1 1  ON 23
 eO_4                 5.184131e-01 1 1  ON 24
 eO_5                 4.767769e-01 1 1  ON 25
 eO_6                 2.468863e-01 1 1  ON 26
 eO_7                -5.281692e-02 1 1  ON 27
 eO_8                -2.087356e-01 1 1  ON 28
 eO_9                -6.843142e-02 1 1  ON 29
eH1_0                -2.322924e-01 1 1  ON 30
eH1_1                -1.357875e-01 1 1  ON 31
eH1_2                -9.166998e-02 1 1  ON 32
eH1_3                -3.851101e-02 1 1  ON 33
eH1_4                 8.614575e-03 1 1  ON 34
eH1_5                 4.316637e-02 1 1  ON 35
eH1_6                 9.815476e-02 1 1  ON 36
eH1_7                 1.454600e-01 1 1  ON 37
eH1_8                 1.595220e-01 1 1  ON 38
eH1_9                 4.708363e-02 1 1  ON 39
eH2_0                -2.299941e-01 1 1  ON 40
eH2_1                -1.327285e-01 1 1  ON 41
eH2_2                -8.876771e-02 1 1  ON 42
eH2_3                -3.525826e-02 1 1  ON 43
eH2_4                 1.244971e-02 1 1  ON 44
eH2_5                 4.741339e-02 1 1  ON 45
eH2_6                 1.024381e-01 1 1  ON 46
eH2_7                 1.497708e-01 1 1  ON 47
eH2_8                 1.646009e-01 1 1  ON 48
eH2_9                 2.872710e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9277
    reference variance = 0.24632
====================================================
  Execution time = 2.0408e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6127e-01
  Total weights = 2.0000e+06
  Execution time = 2.2142e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360501630043
                                         uncertainty =       0.012958447064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360501630043
                                         uncertainty =       0.012958447064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424516047
  error estimate for blocks of size 2^( 2) =       0.000437116992
  error estimate for blocks of size 2^( 3) =       0.000450036651
  error estimate for blocks of size 2^( 4) =       0.000462887537
  error estimate for blocks of size 2^( 5) =       0.000475309505
  error estimate for blocks of size 2^( 6) =       0.000483842382
  error estimate for blocks of size 2^( 7) =       0.000492046219

      target function =                  N/A
              le_mean =     -16.905752293477
             les_mean =     286.164888176925
             stat err =       0.000478521411
             autocorr =       1.270616601441
              std dev =       0.600356351470
             le_variance =       0.360427748750

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362392036920
                                         uncertainty =       0.012994643435

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362392036920
                                         uncertainty =       0.012994643435

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425627690
  error estimate for blocks of size 2^( 2) =       0.000438202095
  error estimate for blocks of size 2^( 3) =       0.000451039399
  error estimate for blocks of size 2^( 4) =       0.000463792191
  error estimate for blocks of size 2^( 5) =       0.000476103406
  error estimate for blocks of size 2^( 6) =       0.000484548446
  error estimate for blocks of size 2^( 7) =       0.000492650874

      target function =                  N/A
              le_mean =     -16.905749022475
             les_mean =     286.166667691073
             stat err =       0.000479273730
             autocorr =       1.267965686048
              std dev =       0.601928452003
             le_variance =       0.362317861331

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362225723982
                                         uncertainty =       0.012994407380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362225723982
                                         uncertainty =       0.012994407380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425529851
  error estimate for blocks of size 2^( 2) =       0.000438107488
  error estimate for blocks of size 2^( 3) =       0.000450954994
  error estimate for blocks of size 2^( 4) =       0.000463726182
  error estimate for blocks of size 2^( 5) =       0.000476058836
  error estimate for blocks of size 2^( 6) =       0.000484543296
  error estimate for blocks of size 2^( 7) =       0.000492664870

      target function =                  N/A
              le_mean =     -16.905744993423
             les_mean =     286.166364909643
             stat err =       0.000479248296
             autocorr =       1.268414190821
              std dev =       0.601790086380
             le_variance =       0.362151308066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360776693050
                                         uncertainty =       0.012964705699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.360776693050
                                         uncertainty =       0.012964705699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424677919
  error estimate for blocks of size 2^( 2) =       0.000437273704
  error estimate for blocks of size 2^( 3) =       0.000450179069
  error estimate for blocks of size 2^( 4) =       0.000463016310
  error estimate for blocks of size 2^( 5) =       0.000475424208
  error estimate for blocks of size 2^( 6) =       0.000483954566
  error estimate for blocks of size 2^( 7) =       0.000492147073

      target function =                  N/A
              le_mean =     -16.905747128776
             les_mean =     286.164988470685
             stat err =       0.000478635539
             autocorr =       1.270253861978
              std dev =       0.600585271985
             le_variance =       0.360702668925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905752293477        initial  <--
     9.5367e-03     9.5367e-02             2.4439e-02       -16.905749022475
     3.8147e-02     3.8147e-01             6.8422e-03       -16.905744993423
     1.5259e-01     1.5259e+00             2.1866e-03       -16.905747128776

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.5502
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.071823e-01 1 1  ON 0
 uu_1                 1.410627e-01 1 1  ON 1
 uu_2                 4.039955e-02 1 1  ON 2
 uu_3                -2.039194e-02 1 1  ON 3
 uu_4                -6.338502e-02 1 1  ON 4
 uu_5                -9.576235e-02 1 1  ON 5
 uu_6                -1.219118e-01 1 1  ON 6
 uu_7                -1.336686e-01 1 1  ON 7
 uu_8                -1.255877e-01 1 1  ON 8
 uu_9                -9.664626e-02 1 1  ON 9
 ud_0                 4.396238e-01 1 1  ON 10
 ud_1                 1.755330e-01 1 1  ON 11
 ud_2                 5.927865e-02 1 1  ON 12
 ud_3                -9.278056e-03 1 1  ON 13
 ud_4                -6.580747e-02 1 1  ON 14
 ud_5                -1.060694e-01 1 1  ON 15
 ud_6                -1.318319e-01 1 1  ON 16
 ud_7                -1.466728e-01 1 1  ON 17
 ud_8                -1.479118e-01 1 1  ON 18
 ud_9                -1.376982e-01 1 1  ON 19
 eO_0                -7.499479e-01 1 1  ON 20
 eO_1                -4.335200e-01 1 1  ON 21
 eO_2                -1.798450e-02 1 1  ON 22
 eO_3                 2.964963e-01 1 1  ON 23
 eO_4                 5.147399e-01 1 1  ON 24
 eO_5                 4.699347e-01 1 1  ON 25
 eO_6                 2.415935e-01 1 1  ON 26
 eO_7                -5.364387e-02 1 1  ON 27
 eO_8                -2.045160e-01 1 1  ON 28
 eO_9                -6.480476e-02 1 1  ON 29
eH1_0                -2.294931e-01 1 1  ON 30
eH1_1                -1.331455e-01 1 1  ON 31
eH1_2                -8.913044e-02 1 1  ON 32
eH1_3                -3.641866e-02 1 1  ON 33
eH1_4                 1.106741e-02 1 1  ON 34
eH1_5                 4.453263e-02 1 1  ON 35
eH1_6                 9.832144e-02 1 1  ON 36
eH1_7                 1.427627e-01 1 1  ON 37
eH1_8                 1.542693e-01 1 1  ON 38
eH1_9                 4.154205e-02 1 1  ON 39
eH2_0                -2.269432e-01 1 1  ON 40
eH2_1                -1.303741e-01 1 1  ON 41
eH2_2                -8.626787e-02 1 1  ON 42
eH2_3                -3.327829e-02 1 1  ON 43
eH2_4                 1.380344e-02 1 1  ON 44
eH2_5                 4.774659e-02 1 1  ON 45
eH2_6                 1.011405e-01 1 1  ON 46
eH2_7                 1.488281e-01 1 1  ON 47
eH2_8                 1.609864e-01 1 1  ON 48
eH2_9                 2.291592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8113e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9394
    reference variance = 0.312857
====================================================
  Execution time = 2.0798e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3545e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5123e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335461927450
                                         uncertainty =       0.003737679825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335461927450
                                         uncertainty =       0.003737679825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409540211
  error estimate for blocks of size 2^( 2) =       0.000422022592
  error estimate for blocks of size 2^( 3) =       0.000435174172
  error estimate for blocks of size 2^( 4) =       0.000447875914
  error estimate for blocks of size 2^( 5) =       0.000458957228
  error estimate for blocks of size 2^( 6) =       0.000467616987
  error estimate for blocks of size 2^( 7) =       0.000474929502

      target function =                  N/A
              le_mean =     -16.906328024364
             les_mean =     286.159373467727
             stat err =       0.000462344908
             autocorr =       1.274497709828
              std dev =       0.579177320051
             le_variance =       0.335446368062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690632802436e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-02, overlap shift 9.5367e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906328024364       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906332506133       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906331741556       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906331010005       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906332343077       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906331649621       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906333116416       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906332449873       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906333916708       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906334922351       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906334946385       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906334737709       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906334606294       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-02 is 2.489028e-03

solving harmonic davidson linear method for identity shift 3.8147e-01, overlap shift 3.8147e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906328024364       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906330390997       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906330154754       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906329468551       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906329877491       residual = 7.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906329423328       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906329866256       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906329848665       residual = 5.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906329920673       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906330175576       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e-01 is 7.669486e-04

solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906328024364       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906328843900       residual = 5.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906328817313       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906328638739       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906328670085       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906328486143       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906328595773       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906328594156       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906328623760       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 2.043605e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.459183 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6318e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.073087e-01 1 1  ON 0
 uu_1                 1.412948e-01 1 1  ON 1
 uu_2                 4.038745e-02 1 1  ON 2
 uu_3                -2.058327e-02 1 1  ON 3
 uu_4                -6.348561e-02 1 1  ON 4
 uu_5                -9.580395e-02 1 1  ON 5
 uu_6                -1.217026e-01 1 1  ON 6
 uu_7                -1.337482e-01 1 1  ON 7
 uu_8                -1.258547e-01 1 1  ON 8
 uu_9                -9.688334e-02 1 1  ON 9
 ud_0                 4.399021e-01 1 1  ON 10
 ud_1                 1.757746e-01 1 1  ON 11
 ud_2                 5.946157e-02 1 1  ON 12
 ud_3                -9.107083e-03 1 1  ON 13
 ud_4                -6.589803e-02 1 1  ON 14
 ud_5                -1.060995e-01 1 1  ON 15
 ud_6                -1.319746e-01 1 1  ON 16
 ud_7                -1.468241e-01 1 1  ON 17
 ud_8                -1.481528e-01 1 1  ON 18
 ud_9                -1.378890e-01 1 1  ON 19
 eO_0                -7.507149e-01 1 1  ON 20
 eO_1                -4.341326e-01 1 1  ON 21
 eO_2                -1.796818e-02 1 1  ON 22
 eO_3                 2.969192e-01 1 1  ON 23
 eO_4                 5.153693e-01 1 1  ON 24
 eO_5                 4.705507e-01 1 1  ON 25
 eO_6                 2.419375e-01 1 1  ON 26
 eO_7                -5.345556e-02 1 1  ON 27
 eO_8                -2.049523e-01 1 1  ON 28
 eO_9                -6.515639e-02 1 1  ON 29
eH1_0                -2.297579e-01 1 1  ON 30
eH1_1                -1.334891e-01 1 1  ON 31
eH1_2                -8.930981e-02 1 1  ON 32
eH1_3                -3.634807e-02 1 1  ON 33
eH1_4                 1.073922e-02 1 1  ON 34
eH1_5                 4.450948e-02 1 1  ON 35
eH1_6                 9.833750e-02 1 1  ON 36
eH1_7                 1.429663e-01 1 1  ON 37
eH1_8                 1.547395e-01 1 1  ON 38
eH1_9                 4.194059e-02 1 1  ON 39
eH2_0                -2.271927e-01 1 1  ON 40
eH2_1                -1.305023e-01 1 1  ON 41
eH2_2                -8.636412e-02 1 1  ON 42
eH2_3                -3.329729e-02 1 1  ON 43
eH2_4                 1.378958e-02 1 1  ON 44
eH2_5                 4.771364e-02 1 1  ON 45
eH2_6                 1.009439e-01 1 1  ON 46
eH2_7                 1.488092e-01 1 1  ON 47
eH2_8                 1.613116e-01 1 1  ON 48
eH2_9                 2.338411e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.8676
    reference variance = 0.250569
====================================================
  Execution time = 2.0498e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3798e-01
  Total weights = 2.0000e+06
  Execution time = 1.8895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337795753011
                                         uncertainty =       0.006035213430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337795753011
                                         uncertainty =       0.006035213430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410967234
  error estimate for blocks of size 2^( 2) =       0.000424660679
  error estimate for blocks of size 2^( 3) =       0.000438873269
  error estimate for blocks of size 2^( 4) =       0.000453206213
  error estimate for blocks of size 2^( 5) =       0.000464861556
  error estimate for blocks of size 2^( 6) =       0.000475537467
  error estimate for blocks of size 2^( 7) =       0.000482276354

      target function =                  N/A
              le_mean =     -16.906072816960
             les_mean =     286.153086059089
             stat err =       0.000468970398
             autocorr =       1.302196321559
              std dev =       0.581195436690
             le_variance =       0.337788135629

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338318042253
                                         uncertainty =       0.006061618601

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338318042253
                                         uncertainty =       0.006061618601

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411284890
  error estimate for blocks of size 2^( 2) =       0.000424964877
  error estimate for blocks of size 2^( 3) =       0.000439155114
  error estimate for blocks of size 2^( 4) =       0.000453463737
  error estimate for blocks of size 2^( 5) =       0.000465100873
  error estimate for blocks of size 2^( 6) =       0.000475767004
  error estimate for blocks of size 2^( 7) =       0.000482505311

      target function =                  N/A
              le_mean =     -16.906068804946
             les_mean =     286.153472789856
             stat err =       0.000469209231
             autocorr =       1.301510231850
              std dev =       0.581644669408
             le_variance =       0.338310521451

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338174733102
                                         uncertainty =       0.006054414811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338174733102
                                         uncertainty =       0.006054414811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411197750
  error estimate for blocks of size 2^( 2) =       0.000424880623
  error estimate for blocks of size 2^( 3) =       0.000439077367
  error estimate for blocks of size 2^( 4) =       0.000453394944
  error estimate for blocks of size 2^( 5) =       0.000465037507
  error estimate for blocks of size 2^( 6) =       0.000475705303
  error estimate for blocks of size 2^( 7) =       0.000482443623

      target function =                  N/A
              le_mean =     -16.906068936432
             les_mean =     286.153333894287
             stat err =       0.000469145344
             autocorr =       1.301707362853
              std dev =       0.581521435533
             le_variance =       0.338167179984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337846054318
                                         uncertainty =       0.006037853024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337846054318
                                         uncertainty =       0.006037853024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410997838
  error estimate for blocks of size 2^( 2) =       0.000424689679
  error estimate for blocks of size 2^( 3) =       0.000438899961
  error estimate for blocks of size 2^( 4) =       0.000453230910
  error estimate for blocks of size 2^( 5) =       0.000464884280
  error estimate for blocks of size 2^( 6) =       0.000475558913
  error estimate for blocks of size 2^( 7) =       0.000482297668

      target function =                  N/A
              le_mean =     -16.906071874436
             les_mean =     286.153104500246
             stat err =       0.000468992943
             autocorr =       1.302127588865
              std dev =       0.581238716508
             le_variance =       0.337838445568


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906072816960        initial  <--
     9.5367e-02     9.5367e-01             2.4890e-03       -16.906068804946
     3.8147e-01     3.8147e+00             7.6695e-04       -16.906068936432
     1.5259e+00     1.5259e+01             2.0436e-04       -16.906071874436

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0249
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.071823e-01 1 1  ON 0
 uu_1                 1.410627e-01 1 1  ON 1
 uu_2                 4.039955e-02 1 1  ON 2
 uu_3                -2.039194e-02 1 1  ON 3
 uu_4                -6.338502e-02 1 1  ON 4
 uu_5                -9.576235e-02 1 1  ON 5
 uu_6                -1.219118e-01 1 1  ON 6
 uu_7                -1.336686e-01 1 1  ON 7
 uu_8                -1.255877e-01 1 1  ON 8
 uu_9                -9.664626e-02 1 1  ON 9
 ud_0                 4.396238e-01 1 1  ON 10
 ud_1                 1.755330e-01 1 1  ON 11
 ud_2                 5.927865e-02 1 1  ON 12
 ud_3                -9.278056e-03 1 1  ON 13
 ud_4                -6.580747e-02 1 1  ON 14
 ud_5                -1.060694e-01 1 1  ON 15
 ud_6                -1.318319e-01 1 1  ON 16
 ud_7                -1.466728e-01 1 1  ON 17
 ud_8                -1.479118e-01 1 1  ON 18
 ud_9                -1.376982e-01 1 1  ON 19
 eO_0                -7.499479e-01 1 1  ON 20
 eO_1                -4.335200e-01 1 1  ON 21
 eO_2                -1.798450e-02 1 1  ON 22
 eO_3                 2.964963e-01 1 1  ON 23
 eO_4                 5.147399e-01 1 1  ON 24
 eO_5                 4.699347e-01 1 1  ON 25
 eO_6                 2.415935e-01 1 1  ON 26
 eO_7                -5.364387e-02 1 1  ON 27
 eO_8                -2.045160e-01 1 1  ON 28
 eO_9                -6.480476e-02 1 1  ON 29
eH1_0                -2.294931e-01 1 1  ON 30
eH1_1                -1.331455e-01 1 1  ON 31
eH1_2                -8.913044e-02 1 1  ON 32
eH1_3                -3.641866e-02 1 1  ON 33
eH1_4                 1.106741e-02 1 1  ON 34
eH1_5                 4.453263e-02 1 1  ON 35
eH1_6                 9.832144e-02 1 1  ON 36
eH1_7                 1.427627e-01 1 1  ON 37
eH1_8                 1.542693e-01 1 1  ON 38
eH1_9                 4.154205e-02 1 1  ON 39
eH2_0                -2.269432e-01 1 1  ON 40
eH2_1                -1.303741e-01 1 1  ON 41
eH2_2                -8.626787e-02 1 1  ON 42
eH2_3                -3.327829e-02 1 1  ON 43
eH2_4                 1.380344e-02 1 1  ON 44
eH2_5                 4.774659e-02 1 1  ON 45
eH2_6                 1.011405e-01 1 1  ON 46
eH2_7                 1.488281e-01 1 1  ON 47
eH2_8                 1.609864e-01 1 1  ON 48
eH2_9                 2.291592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6349e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8845
    reference variance = 0.166247
====================================================
  Execution time = 2.0943e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3854e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338633799710
                                         uncertainty =       0.004017497834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338633799710
                                         uncertainty =       0.004017497834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411421756
  error estimate for blocks of size 2^( 2) =       0.000424307553
  error estimate for blocks of size 2^( 3) =       0.000437709515
  error estimate for blocks of size 2^( 4) =       0.000450344385
  error estimate for blocks of size 2^( 5) =       0.000461649082
  error estimate for blocks of size 2^( 6) =       0.000470742343
  error estimate for blocks of size 2^( 7) =       0.000478133994

      target function =                  N/A
              le_mean =     -16.905735109160
             les_mean =     286.142415133915
             stat err =       0.000465217451
             autocorr =       1.278608209026
              std dev =       0.581838226751
             le_variance =       0.338535722109


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573510916e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905735109160       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905735463816       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905735647495       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905735607674       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905735516328       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905735367176       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905735767980       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905735870812       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905735848200       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.267061e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905735109160       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905735212159       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905735273084       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905735266357       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905735213479       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905735168087       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905735254345       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905735284842       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 8.181870e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905735109160       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905735135994       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905735152500       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905735151098       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905735135220       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905735123784       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905735143412       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905735151353       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 2.058337e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.462030 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6682e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.072032e-01 1 1  ON 0
 uu_1                 1.410820e-01 1 1  ON 1
 uu_2                 4.040751e-02 1 1  ON 2
 uu_3                -2.038360e-02 1 1  ON 3
 uu_4                -6.342609e-02 1 1  ON 4
 uu_5                -9.579159e-02 1 1  ON 5
 uu_6                -1.219231e-01 1 1  ON 6
 uu_7                -1.337135e-01 1 1  ON 7
 uu_8                -1.255925e-01 1 1  ON 8
 uu_9                -9.664748e-02 1 1  ON 9
 ud_0                 4.396408e-01 1 1  ON 10
 ud_1                 1.755142e-01 1 1  ON 11
 ud_2                 5.927542e-02 1 1  ON 12
 ud_3                -9.270742e-03 1 1  ON 13
 ud_4                -6.582566e-02 1 1  ON 14
 ud_5                -1.060798e-01 1 1  ON 15
 ud_6                -1.318524e-01 1 1  ON 16
 ud_7                -1.466731e-01 1 1  ON 17
 ud_8                -1.478866e-01 1 1  ON 18
 ud_9                -1.376785e-01 1 1  ON 19
 eO_0                -7.500111e-01 1 1  ON 20
 eO_1                -4.335668e-01 1 1  ON 21
 eO_2                -1.803977e-02 1 1  ON 22
 eO_3                 2.965528e-01 1 1  ON 23
 eO_4                 5.147842e-01 1 1  ON 24
 eO_5                 4.700166e-01 1 1  ON 25
 eO_6                 2.416154e-01 1 1  ON 26
 eO_7                -5.362525e-02 1 1  ON 27
 eO_8                -2.045393e-01 1 1  ON 28
 eO_9                -6.483379e-02 1 1  ON 29
eH1_0                -2.295166e-01 1 1  ON 30
eH1_1                -1.331533e-01 1 1  ON 31
eH1_2                -8.916082e-02 1 1  ON 32
eH1_3                -3.642763e-02 1 1  ON 33
eH1_4                 1.103584e-02 1 1  ON 34
eH1_5                 4.451057e-02 1 1  ON 35
eH1_6                 9.830105e-02 1 1  ON 36
eH1_7                 1.427638e-01 1 1  ON 37
eH1_8                 1.543304e-01 1 1  ON 38
eH1_9                 4.161274e-02 1 1  ON 39
eH2_0                -2.270183e-01 1 1  ON 40
eH2_1                -1.303798e-01 1 1  ON 41
eH2_2                -8.628040e-02 1 1  ON 42
eH2_3                -3.328550e-02 1 1  ON 43
eH2_4                 1.378982e-02 1 1  ON 44
eH2_5                 4.774369e-02 1 1  ON 45
eH2_6                 1.011578e-01 1 1  ON 46
eH2_7                 1.488483e-01 1 1  ON 47
eH2_8                 1.610244e-01 1 1  ON 48
eH2_9                 2.295917e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9077
    reference variance = 0.432166
====================================================
  Execution time = 2.0477e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4499e-01
  Total weights = 2.0000e+06
  Execution time = 1.8860e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344872859535
                                         uncertainty =       0.005269401262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344872859535
                                         uncertainty =       0.005269401262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415310624
  error estimate for blocks of size 2^( 2) =       0.000428040585
  error estimate for blocks of size 2^( 3) =       0.000441541907
  error estimate for blocks of size 2^( 4) =       0.000454082775
  error estimate for blocks of size 2^( 5) =       0.000465787887
  error estimate for blocks of size 2^( 6) =       0.000473392495
  error estimate for blocks of size 2^( 7) =       0.000481543764

      target function =                  N/A
              le_mean =     -16.906672504597
             les_mean =     286.180540833815
             stat err =       0.000468701730
             autocorr =       1.273641002073
              std dev =       0.587337916879
             le_variance =       0.344965828604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344953270733
                                         uncertainty =       0.005270355988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344953270733
                                         uncertainty =       0.005270355988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415359016
  error estimate for blocks of size 2^( 2) =       0.000428088335
  error estimate for blocks of size 2^( 3) =       0.000441588982
  error estimate for blocks of size 2^( 4) =       0.000454128548
  error estimate for blocks of size 2^( 5) =       0.000465832705
  error estimate for blocks of size 2^( 6) =       0.000473437141
  error estimate for blocks of size 2^( 7) =       0.000481587137

      target function =                  N/A
              le_mean =     -16.906673308345
             les_mean =     286.180648406731
             stat err =       0.000468746383
             autocorr =       1.273586876552
              std dev =       0.587406353528
             le_variance =       0.345046224165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344930440866
                                         uncertainty =       0.005270095408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344930440866
                                         uncertainty =       0.005270095408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415345281
  error estimate for blocks of size 2^( 2) =       0.000428074397
  error estimate for blocks of size 2^( 3) =       0.000441574975
  error estimate for blocks of size 2^( 4) =       0.000454115050
  error estimate for blocks of size 2^( 5) =       0.000465819492
  error estimate for blocks of size 2^( 6) =       0.000473423827
  error estimate for blocks of size 2^( 7) =       0.000481574157

      target function =                  N/A
              le_mean =     -16.906673123519
             les_mean =     286.180619338652
             stat err =       0.000468733131
             autocorr =       1.273599093926
              std dev =       0.587386930091
             le_variance =       0.345023405642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344880788174
                                         uncertainty =       0.005269497074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344880788174
                                         uncertainty =       0.005269497074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415315396
  error estimate for blocks of size 2^( 2) =       0.000428045232
  error estimate for blocks of size 2^( 3) =       0.000441546444
  error estimate for blocks of size 2^( 4) =       0.000454087208
  error estimate for blocks of size 2^( 5) =       0.000465792234
  error estimate for blocks of size 2^( 6) =       0.000473396796
  error estimate for blocks of size 2^( 7) =       0.000481547942

      target function =                  N/A
              le_mean =     -16.906672588739
             les_mean =     286.180551607291
             stat err =       0.000468706045
             autocorr =       1.273635180751
              std dev =       0.587344666240
             le_variance =       0.344973756961


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906672504597        initial
     9.5367e-01     9.5367e+00             3.2671e-04       -16.906673308345  <--
     3.8147e+00     3.8147e+01             8.1819e-05       -16.906673123519
     1.5259e+01     1.5259e+02             2.0583e-05       -16.906672588739

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 3.0027e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.072688e-01 1 1  ON 0
 uu_1                 1.411354e-01 1 1  ON 1
 uu_2                 4.043009e-02 1 1  ON 2
 uu_3                -2.037524e-02 1 1  ON 3
 uu_4                -6.352770e-02 1 1  ON 4
 uu_5                -9.588280e-02 1 1  ON 5
 uu_6                -1.219601e-01 1 1  ON 6
 uu_7                -1.338385e-01 1 1  ON 7
 uu_8                -1.256117e-01 1 1  ON 8
 uu_9                -9.665480e-02 1 1  ON 9
 ud_0                 4.396654e-01 1 1  ON 10
 ud_1                 1.754794e-01 1 1  ON 11
 ud_2                 5.927663e-02 1 1  ON 12
 ud_3                -9.260163e-03 1 1  ON 13
 ud_4                -6.586233e-02 1 1  ON 14
 ud_5                -1.061151e-01 1 1  ON 15
 ud_6                -1.319033e-01 1 1  ON 16
 ud_7                -1.466790e-01 1 1  ON 17
 ud_8                -1.478217e-01 1 1  ON 18
 ud_9                -1.376222e-01 1 1  ON 19
 eO_0                -7.502020e-01 1 1  ON 20
 eO_1                -4.337216e-01 1 1  ON 21
 eO_2                -1.817384e-02 1 1  ON 22
 eO_3                 2.967026e-01 1 1  ON 23
 eO_4                 5.149200e-01 1 1  ON 24
 eO_5                 4.702614e-01 1 1  ON 25
 eO_6                 2.416884e-01 1 1  ON 26
 eO_7                -5.356917e-02 1 1  ON 27
 eO_8                -2.046127e-01 1 1  ON 28
 eO_9                -6.492308e-02 1 1  ON 29
eH1_0                -2.295895e-01 1 1  ON 30
eH1_1                -1.331912e-01 1 1  ON 31
eH1_2                -8.923890e-02 1 1  ON 32
eH1_3                -3.646465e-02 1 1  ON 33
eH1_4                 1.094670e-02 1 1  ON 34
eH1_5                 4.444611e-02 1 1  ON 35
eH1_6                 9.824124e-02 1 1  ON 36
eH1_7                 1.427673e-01 1 1  ON 37
eH1_8                 1.545153e-01 1 1  ON 38
eH1_9                 4.182797e-02 1 1  ON 39
eH2_0                -2.272286e-01 1 1  ON 40
eH2_1                -1.304045e-01 1 1  ON 41
eH2_2                -8.631661e-02 1 1  ON 42
eH2_3                -3.330969e-02 1 1  ON 43
eH2_4                 1.374574e-02 1 1  ON 44
eH2_5                 4.773082e-02 1 1  ON 45
eH2_6                 1.012060e-01 1 1  ON 46
eH2_7                 1.489096e-01 1 1  ON 47
eH2_8                 1.611406e-01 1 1  ON 48
eH2_9                 2.309109e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6714e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8524
    reference variance = 0.257482
====================================================
  Execution time = 2.0683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5168e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351619451125
                                         uncertainty =       0.015796700785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351619451125
                                         uncertainty =       0.015796700785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419333387
  error estimate for blocks of size 2^( 2) =       0.000432571249
  error estimate for blocks of size 2^( 3) =       0.000446543051
  error estimate for blocks of size 2^( 4) =       0.000459392163
  error estimate for blocks of size 2^( 5) =       0.000471682337
  error estimate for blocks of size 2^( 6) =       0.000479993402
  error estimate for blocks of size 2^( 7) =       0.000488205821

      target function =                  N/A
              le_mean =     -16.906179418815
             les_mean =     286.170583343677
             stat err =       0.000474818431
             autocorr =       1.282142374900
              std dev =       0.593026962586
             le_variance =       0.351680978354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617941881e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179418815       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906181295971       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906181685708       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906182134908       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906183407197       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906185318692       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906185884947       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906186513055       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906185971255       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906185904485       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906185863469       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.386405e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179418815       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906180104266       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906180222689       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906180334130       residual = 9.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906180824032       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906181085865       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906181232548       residual = 4.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906181288459       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906181302491       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.858773e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906179418815       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906179612479       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906179646276       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906179674036       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906179686930       residual = 8.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906179810482       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906179869147       residual = 3.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906179876759       residual = 7.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 9.912856e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.465391 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6171e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.072636e-01 1 1  ON 0
 uu_1                 1.411729e-01 1 1  ON 1
 uu_2                 4.045881e-02 1 1  ON 2
 uu_3                -2.050742e-02 1 1  ON 3
 uu_4                -6.361915e-02 1 1  ON 4
 uu_5                -9.594503e-02 1 1  ON 5
 uu_6                -1.218534e-01 1 1  ON 6
 uu_7                -1.338615e-01 1 1  ON 7
 uu_8                -1.257308e-01 1 1  ON 8
 uu_9                -9.667777e-02 1 1  ON 9
 ud_0                 4.396401e-01 1 1  ON 10
 ud_1                 1.755992e-01 1 1  ON 11
 ud_2                 5.933777e-02 1 1  ON 12
 ud_3                -9.293786e-03 1 1  ON 13
 ud_4                -6.589803e-02 1 1  ON 14
 ud_5                -1.062543e-01 1 1  ON 15
 ud_6                -1.320254e-01 1 1  ON 16
 ud_7                -1.466390e-01 1 1  ON 17
 ud_8                -1.477404e-01 1 1  ON 18
 ud_9                -1.376179e-01 1 1  ON 19
 eO_0                -7.505878e-01 1 1  ON 20
 eO_1                -4.340230e-01 1 1  ON 21
 eO_2                -1.821360e-02 1 1  ON 22
 eO_3                 2.969544e-01 1 1  ON 23
 eO_4                 5.151923e-01 1 1  ON 24
 eO_5                 4.705409e-01 1 1  ON 25
 eO_6                 2.418290e-01 1 1  ON 26
 eO_7                -5.348608e-02 1 1  ON 27
 eO_8                -2.047578e-01 1 1  ON 28
 eO_9                -6.506266e-02 1 1  ON 29
eH1_0                -2.297185e-01 1 1  ON 30
eH1_1                -1.333099e-01 1 1  ON 31
eH1_2                -8.925244e-02 1 1  ON 32
eH1_3                -3.648479e-02 1 1  ON 33
eH1_4                 1.085968e-02 1 1  ON 34
eH1_5                 4.433445e-02 1 1  ON 35
eH1_6                 9.830616e-02 1 1  ON 36
eH1_7                 1.429857e-01 1 1  ON 37
eH1_8                 1.546433e-01 1 1  ON 38
eH1_9                 4.191512e-02 1 1  ON 39
eH2_0                -2.274153e-01 1 1  ON 40
eH2_1                -1.305219e-01 1 1  ON 41
eH2_2                -8.647829e-02 1 1  ON 42
eH2_3                -3.336959e-02 1 1  ON 43
eH2_4                 1.366476e-02 1 1  ON 44
eH2_5                 4.774704e-02 1 1  ON 45
eH2_6                 1.012551e-01 1 1  ON 46
eH2_7                 1.489276e-01 1 1  ON 47
eH2_8                 1.613144e-01 1 1  ON 48
eH2_9                 2.338963e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9303
    reference variance = 0.168081
====================================================
  Execution time = 2.0651e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3454e-01
  Total weights = 2.0000e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334601243515
                                         uncertainty =       0.004712348649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334601243515
                                         uncertainty =       0.004712348649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409029962
  error estimate for blocks of size 2^( 2) =       0.000422108861
  error estimate for blocks of size 2^( 3) =       0.000435551216
  error estimate for blocks of size 2^( 4) =       0.000448443459
  error estimate for blocks of size 2^( 5) =       0.000459420412
  error estimate for blocks of size 2^( 6) =       0.000465216279
  error estimate for blocks of size 2^( 7) =       0.000470975054

      target function =                  N/A
              le_mean =     -16.906124052641
             les_mean =     286.151641334834
             stat err =       0.000461013801
             autocorr =       1.270333090960
              std dev =       0.578455718999
             le_variance =       0.334611018842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334606804900
                                         uncertainty =       0.004711666499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334606804900
                                         uncertainty =       0.004711666499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409033396
  error estimate for blocks of size 2^( 2) =       0.000422117597
  error estimate for blocks of size 2^( 3) =       0.000435558300
  error estimate for blocks of size 2^( 4) =       0.000448448477
  error estimate for blocks of size 2^( 5) =       0.000459416358
  error estimate for blocks of size 2^( 6) =       0.000465205047
  error estimate for blocks of size 2^( 7) =       0.000470962460

      target function =                  N/A
              le_mean =     -16.906124567824
             les_mean =     286.151664373816
             stat err =       0.000461008086
             autocorr =       1.270280258927
              std dev =       0.578460576302
             le_variance =       0.334616638335

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334470575176
                                         uncertainty =       0.004709726390

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334470575176
                                         uncertainty =       0.004709726390

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408950138
  error estimate for blocks of size 2^( 2) =       0.000422036148
  error estimate for blocks of size 2^( 3) =       0.000435480786
  error estimate for blocks of size 2^( 4) =       0.000448375512
  error estimate for blocks of size 2^( 5) =       0.000459348729
  error estimate for blocks of size 2^( 6) =       0.000465142125
  error estimate for blocks of size 2^( 7) =       0.000470898547

      target function =                  N/A
              le_mean =     -16.906124826716
             les_mean =     286.151536919561
             stat err =       0.000460941228
             autocorr =       1.270428978455
              std dev =       0.578342831114
             le_variance =       0.334480430301

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568536652
                                         uncertainty =       0.004711766814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334568536652
                                         uncertainty =       0.004711766814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409009979
  error estimate for blocks of size 2^( 2) =       0.000422090252
  error estimate for blocks of size 2^( 3) =       0.000435533301
  error estimate for blocks of size 2^( 4) =       0.000448426240
  error estimate for blocks of size 2^( 5) =       0.000459402831
  error estimate for blocks of size 2^( 6) =       0.000465198629
  error estimate for blocks of size 2^( 7) =       0.000470956877

      target function =                  N/A
              le_mean =     -16.906124104391
             les_mean =     286.151610391121
             stat err =       0.000460996144
             autocorr =       1.270359907383
              std dev =       0.578427459008
             le_variance =       0.334578325334


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906124052641        initial
     2.3842e-01     2.3842e+00             1.3864e-03       -16.906124567824
     9.5367e-01     9.5367e+00             3.8588e-04       -16.906124826716  <--
     3.8147e+00     3.8147e+01             9.9129e-05       -16.906124104391

*****************************************************************************
Applying the update for shift_i =   9.5367e-01     and shift_s =   9.5367e+00
*****************************************************************************

  Execution time = 3.0141e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.072636e-01 1 1  ON 0
 uu_1                 1.411729e-01 1 1  ON 1
 uu_2                 4.045881e-02 1 1  ON 2
 uu_3                -2.050742e-02 1 1  ON 3
 uu_4                -6.361915e-02 1 1  ON 4
 uu_5                -9.594503e-02 1 1  ON 5
 uu_6                -1.218534e-01 1 1  ON 6
 uu_7                -1.338615e-01 1 1  ON 7
 uu_8                -1.257308e-01 1 1  ON 8
 uu_9                -9.667777e-02 1 1  ON 9
 ud_0                 4.396401e-01 1 1  ON 10
 ud_1                 1.755992e-01 1 1  ON 11
 ud_2                 5.933777e-02 1 1  ON 12
 ud_3                -9.293786e-03 1 1  ON 13
 ud_4                -6.589803e-02 1 1  ON 14
 ud_5                -1.062543e-01 1 1  ON 15
 ud_6                -1.320254e-01 1 1  ON 16
 ud_7                -1.466390e-01 1 1  ON 17
 ud_8                -1.477404e-01 1 1  ON 18
 ud_9                -1.376179e-01 1 1  ON 19
 eO_0                -7.505878e-01 1 1  ON 20
 eO_1                -4.340230e-01 1 1  ON 21
 eO_2                -1.821360e-02 1 1  ON 22
 eO_3                 2.969544e-01 1 1  ON 23
 eO_4                 5.151923e-01 1 1  ON 24
 eO_5                 4.705409e-01 1 1  ON 25
 eO_6                 2.418290e-01 1 1  ON 26
 eO_7                -5.348608e-02 1 1  ON 27
 eO_8                -2.047578e-01 1 1  ON 28
 eO_9                -6.506266e-02 1 1  ON 29
eH1_0                -2.297185e-01 1 1  ON 30
eH1_1                -1.333099e-01 1 1  ON 31
eH1_2                -8.925244e-02 1 1  ON 32
eH1_3                -3.648479e-02 1 1  ON 33
eH1_4                 1.085968e-02 1 1  ON 34
eH1_5                 4.433445e-02 1 1  ON 35
eH1_6                 9.830616e-02 1 1  ON 36
eH1_7                 1.429857e-01 1 1  ON 37
eH1_8                 1.546433e-01 1 1  ON 38
eH1_9                 4.191512e-02 1 1  ON 39
eH2_0                -2.274153e-01 1 1  ON 40
eH2_1                -1.305219e-01 1 1  ON 41
eH2_2                -8.647829e-02 1 1  ON 42
eH2_3                -3.336959e-02 1 1  ON 43
eH2_4                 1.366476e-02 1 1  ON 44
eH2_5                 4.774704e-02 1 1  ON 45
eH2_6                 1.012551e-01 1 1  ON 46
eH2_7                 1.489276e-01 1 1  ON 47
eH2_8                 1.613144e-01 1 1  ON 48
eH2_9                 2.338963e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6318e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9567
    reference variance = 0.234933
====================================================
  Execution time = 2.0885e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4353e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343543940302
                                         uncertainty =       0.004109760087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343543940302
                                         uncertainty =       0.004109760087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414446142
  error estimate for blocks of size 2^( 2) =       0.000427651976
  error estimate for blocks of size 2^( 3) =       0.000441709650
  error estimate for blocks of size 2^( 4) =       0.000455688120
  error estimate for blocks of size 2^( 5) =       0.000468091783
  error estimate for blocks of size 2^( 6) =       0.000478572326
  error estimate for blocks of size 2^( 7) =       0.000485972909

      target function =                  N/A
              le_mean =     -16.906213127286
             les_mean =     286.163573342626
             stat err =       0.000472081284
             autocorr =       1.297470116521
              std dev =       0.586115354842
             le_variance =       0.343531209181


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690621312729e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213127286       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906215543374       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906216105688       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906215596428       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906218070182       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906216943600       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906217590404       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906217389835       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906217733978       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906217924720       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906217733658       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.206486e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213127286       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213941635       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906214086147       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906214106769       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906214972271       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906214528248       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906214640863       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906214671650       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906214666674       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.438715e-04

solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906213127286       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906213350286       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906213388601       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906213419177       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906213666615       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906213551629       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906213564094       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906213583471       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 9.050505e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.468807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6445e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.072959e-01 1 1  ON 0
 uu_1                 1.412202e-01 1 1  ON 1
 uu_2                 4.045496e-02 1 1  ON 2
 uu_3                -2.050658e-02 1 1  ON 3
 uu_4                -6.367703e-02 1 1  ON 4
 uu_5                -9.609785e-02 1 1  ON 5
 uu_6                -1.219571e-01 1 1  ON 6
 uu_7                -1.340435e-01 1 1  ON 7
 uu_8                -1.256750e-01 1 1  ON 8
 uu_9                -9.660694e-02 1 1  ON 9
 ud_0                 4.396402e-01 1 1  ON 10
 ud_1                 1.755538e-01 1 1  ON 11
 ud_2                 5.921611e-02 1 1  ON 12
 ud_3                -9.386753e-03 1 1  ON 13
 ud_4                -6.597266e-02 1 1  ON 14
 ud_5                -1.063629e-01 1 1  ON 15
 ud_6                -1.319809e-01 1 1  ON 16
 ud_7                -1.467135e-01 1 1  ON 17
 ud_8                -1.475084e-01 1 1  ON 18
 ud_9                -1.374614e-01 1 1  ON 19
 eO_0                -7.509317e-01 1 1  ON 20
 eO_1                -4.342359e-01 1 1  ON 21
 eO_2                -1.827196e-02 1 1  ON 22
 eO_3                 2.969966e-01 1 1  ON 23
 eO_4                 5.153927e-01 1 1  ON 24
 eO_5                 4.707748e-01 1 1  ON 25
 eO_6                 2.420046e-01 1 1  ON 26
 eO_7                -5.337398e-02 1 1  ON 27
 eO_8                -2.048135e-01 1 1  ON 28
 eO_9                -6.514378e-02 1 1  ON 29
eH1_0                -2.297921e-01 1 1  ON 30
eH1_1                -1.334067e-01 1 1  ON 31
eH1_2                -8.934465e-02 1 1  ON 32
eH1_3                -3.650899e-02 1 1  ON 33
eH1_4                 1.075835e-02 1 1  ON 34
eH1_5                 4.428561e-02 1 1  ON 35
eH1_6                 9.818688e-02 1 1  ON 36
eH1_7                 1.430030e-01 1 1  ON 37
eH1_8                 1.548834e-01 1 1  ON 38
eH1_9                 4.217866e-02 1 1  ON 39
eH2_0                -2.275505e-01 1 1  ON 40
eH2_1                -1.306756e-01 1 1  ON 41
eH2_2                -8.658880e-02 1 1  ON 42
eH2_3                -3.340320e-02 1 1  ON 43
eH2_4                 1.357605e-02 1 1  ON 44
eH2_5                 4.760764e-02 1 1  ON 45
eH2_6                 1.013247e-01 1 1  ON 46
eH2_7                 1.490704e-01 1 1  ON 47
eH2_8                 1.615210e-01 1 1  ON 48
eH2_9                 2.361826e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8706
    reference variance = 0.19635
====================================================
  Execution time = 2.0552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3471e-01
  Total weights = 2.0000e+06
  Execution time = 1.8883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334643659417
                                         uncertainty =       0.004743236773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334643659417
                                         uncertainty =       0.004743236773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409017629
  error estimate for blocks of size 2^( 2) =       0.000422340222
  error estimate for blocks of size 2^( 3) =       0.000435966884
  error estimate for blocks of size 2^( 4) =       0.000449329201
  error estimate for blocks of size 2^( 5) =       0.000461277378
  error estimate for blocks of size 2^( 6) =       0.000469924496
  error estimate for blocks of size 2^( 7) =       0.000473967693

      target function =                  N/A
              le_mean =     -16.906639739996
             les_mean =     286.169057972717
             stat err =       0.000463624692
             autocorr =       1.284840038675
              std dev =       0.578438278457
             le_variance =       0.334590841984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334965502623
                                         uncertainty =       0.004746218279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334965502623
                                         uncertainty =       0.004746218279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409214272
  error estimate for blocks of size 2^( 2) =       0.000422531778
  error estimate for blocks of size 2^( 3) =       0.000436152476
  error estimate for blocks of size 2^( 4) =       0.000449503996
  error estimate for blocks of size 2^( 5) =       0.000461436642
  error estimate for blocks of size 2^( 6) =       0.000470060898
  error estimate for blocks of size 2^( 7) =       0.000474099323

      target function =                  N/A
              le_mean =     -16.906639783476
             les_mean =     286.169381242228
             stat err =       0.000463775215
             autocorr =       1.284439124122
              std dev =       0.578716373934
             le_variance =       0.334912641460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334876499573
                                         uncertainty =       0.004745317825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334876499573
                                         uncertainty =       0.004745317825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409159911
  error estimate for blocks of size 2^( 2) =       0.000422477313
  error estimate for blocks of size 2^( 3) =       0.000436098841
  error estimate for blocks of size 2^( 4) =       0.000449454323
  error estimate for blocks of size 2^( 5) =       0.000461392240
  error estimate for blocks of size 2^( 6) =       0.000470023713
  error estimate for blocks of size 2^( 7) =       0.000474066383

      target function =                  N/A
              le_mean =     -16.906639485084
             les_mean =     286.169282176121
             stat err =       0.000463734165
             autocorr =       1.284553025284
              std dev =       0.578639494785
             le_variance =       0.334823664925

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334679213126
                                         uncertainty =       0.004743497977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334679213126
                                         uncertainty =       0.004743497977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409039358
  error estimate for blocks of size 2^( 2) =       0.000422361080
  error estimate for blocks of size 2^( 3) =       0.000435986930
  error estimate for blocks of size 2^( 4) =       0.000449348281
  error estimate for blocks of size 2^( 5) =       0.000461295016
  error estimate for blocks of size 2^( 6) =       0.000469939862
  error estimate for blocks of size 2^( 7) =       0.000473983134

      target function =                  N/A
              le_mean =     -16.906639663973
             les_mean =     286.169090953514
             stat err =       0.000463641573
             autocorr =       1.284797091222
              std dev =       0.578469008165
             le_variance =       0.334626393407


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906639739996        initial
     2.3842e-01     2.3842e+00             1.2065e-03       -16.906639783476  <--
     9.5367e-01     9.5367e+00             3.4387e-04       -16.906639485084
     3.8147e+00     3.8147e+01             9.0505e-05       -16.906639663973

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 3.0064e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.074165e-01 1 1  ON 0
 uu_1                 1.413000e-01 1 1  ON 1
 uu_2                 4.047021e-02 1 1  ON 2
 uu_3                -2.054856e-02 1 1  ON 3
 uu_4                -6.383405e-02 1 1  ON 4
 uu_5                -9.647889e-02 1 1  ON 5
 uu_6                -1.222445e-01 1 1  ON 6
 uu_7                -1.345176e-01 1 1  ON 7
 uu_8                -1.256108e-01 1 1  ON 8
 uu_9                -9.643278e-02 1 1  ON 9
 ud_0                 4.396005e-01 1 1  ON 10
 ud_1                 1.754228e-01 1 1  ON 11
 ud_2                 5.899769e-02 1 1  ON 12
 ud_3                -9.629388e-03 1 1  ON 13
 ud_4                -6.619632e-02 1 1  ON 14
 ud_5                -1.066117e-01 1 1  ON 15
 ud_6                -1.319627e-01 1 1  ON 16
 ud_7                -1.468661e-01 1 1  ON 17
 ud_8                -1.469621e-01 1 1  ON 18
 ud_9                -1.370300e-01 1 1  ON 19
 eO_0                -7.517943e-01 1 1  ON 20
 eO_1                -4.348741e-01 1 1  ON 21
 eO_2                -1.855826e-02 1 1  ON 22
 eO_3                 2.971018e-01 1 1  ON 23
 eO_4                 5.159512e-01 1 1  ON 24
 eO_5                 4.714781e-01 1 1  ON 25
 eO_6                 2.425719e-01 1 1  ON 26
 eO_7                -5.304672e-02 1 1  ON 27
 eO_8                -2.050033e-01 1 1  ON 28
 eO_9                -6.539144e-02 1 1  ON 29
eH1_0                -2.300240e-01 1 1  ON 30
eH1_1                -1.336859e-01 1 1  ON 31
eH1_2                -8.956698e-02 1 1  ON 32
eH1_3                -3.664757e-02 1 1  ON 33
eH1_4                 1.048912e-02 1 1  ON 34
eH1_5                 4.409826e-02 1 1  ON 35
eH1_6                 9.785089e-02 1 1  ON 36
eH1_7                 1.430606e-01 1 1  ON 37
eH1_8                 1.555938e-01 1 1  ON 38
eH1_9                 4.296840e-02 1 1  ON 39
eH2_0                -2.279415e-01 1 1  ON 40
eH2_1                -1.310658e-01 1 1  ON 41
eH2_2                -8.688336e-02 1 1  ON 42
eH2_3                -3.361029e-02 1 1  ON 43
eH2_4                 1.332265e-02 1 1  ON 44
eH2_5                 4.722625e-02 1 1  ON 45
eH2_6                 1.014756e-01 1 1  ON 46
eH2_7                 1.494862e-01 1 1  ON 47
eH2_8                 1.621426e-01 1 1  ON 48
eH2_9                 2.430738e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6515e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9651
    reference variance = 0.407139
====================================================
  Execution time = 2.0765e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4237e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5798e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342463160043
                                         uncertainty =       0.006591505608

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342463160043
                                         uncertainty =       0.006591505608

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413744961
  error estimate for blocks of size 2^( 2) =       0.000426830690
  error estimate for blocks of size 2^( 3) =       0.000440844937
  error estimate for blocks of size 2^( 4) =       0.000454717799
  error estimate for blocks of size 2^( 5) =       0.000466680353
  error estimate for blocks of size 2^( 6) =       0.000476381932
  error estimate for blocks of size 2^( 7) =       0.000484726971

      target function =                  N/A
              le_mean =     -16.906403809918
             les_mean =     286.168859398245
             stat err =       0.000470626764
             autocorr =       1.293861551183
              std dev =       0.585123735125
             le_variance =       0.342369785407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690640380992e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906403809918       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906405848714       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906408580182       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906408903365       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906411495263       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906412183843       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906414910099       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906417240592       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906416555206       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906416730148       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906417670064       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906417880302       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906417671506       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906417728544       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 4.386469e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906403809918       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906404941906       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906406487524       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906406414140       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906407331590       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906407618296       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906407968482       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906408417308       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906408240655       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906408231550       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906408319223       residual = 2.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.285086e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906403809918       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906404217239       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906404804746       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906404702719       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906404782628       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906405067146       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906405027979       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906405073956       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906405074546       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 3.363840e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.473521 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6354e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.077317e-01 1 1  ON 0
 uu_1                 1.413504e-01 1 1  ON 1
 uu_2                 4.048222e-02 1 1  ON 2
 uu_3                -2.056472e-02 1 1  ON 3
 uu_4                -6.396411e-02 1 1  ON 4
 uu_5                -9.689515e-02 1 1  ON 5
 uu_6                -1.228588e-01 1 1  ON 6
 uu_7                -1.348263e-01 1 1  ON 7
 uu_8                -1.258247e-01 1 1  ON 8
 uu_9                -9.618626e-02 1 1  ON 9
 ud_0                 4.398323e-01 1 1  ON 10
 ud_1                 1.755115e-01 1 1  ON 11
 ud_2                 5.903643e-02 1 1  ON 12
 ud_3                -9.839068e-03 1 1  ON 13
 ud_4                -6.666417e-02 1 1  ON 14
 ud_5                -1.068851e-01 1 1  ON 15
 ud_6                -1.322101e-01 1 1  ON 16
 ud_7                -1.468748e-01 1 1  ON 17
 ud_8                -1.469679e-01 1 1  ON 18
 ud_9                -1.366391e-01 1 1  ON 19
 eO_0                -7.527068e-01 1 1  ON 20
 eO_1                -4.357514e-01 1 1  ON 21
 eO_2                -1.886451e-02 1 1  ON 22
 eO_3                 2.971747e-01 1 1  ON 23
 eO_4                 5.167172e-01 1 1  ON 24
 eO_5                 4.727632e-01 1 1  ON 25
 eO_6                 2.430788e-01 1 1  ON 26
 eO_7                -5.285632e-02 1 1  ON 27
 eO_8                -2.052580e-01 1 1  ON 28
 eO_9                -6.581383e-02 1 1  ON 29
eH1_0                -2.305257e-01 1 1  ON 30
eH1_1                -1.336550e-01 1 1  ON 31
eH1_2                -8.972478e-02 1 1  ON 32
eH1_3                -3.669210e-02 1 1  ON 33
eH1_4                 1.020291e-02 1 1  ON 34
eH1_5                 4.368633e-02 1 1  ON 35
eH1_6                 9.743921e-02 1 1  ON 36
eH1_7                 1.430323e-01 1 1  ON 37
eH1_8                 1.563030e-01 1 1  ON 38
eH1_9                 4.392517e-02 1 1  ON 39
eH2_0                -2.285115e-01 1 1  ON 40
eH2_1                -1.315146e-01 1 1  ON 41
eH2_2                -8.725981e-02 1 1  ON 42
eH2_3                -3.404510e-02 1 1  ON 43
eH2_4                 1.325270e-02 1 1  ON 44
eH2_5                 4.694643e-02 1 1  ON 45
eH2_6                 1.016229e-01 1 1  ON 46
eH2_7                 1.497524e-01 1 1  ON 47
eH2_8                 1.627346e-01 1 1  ON 48
eH2_9                 2.535432e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8538
    reference variance = 0.239334
====================================================
  Execution time = 2.0329e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4135e-01
  Total weights = 2.0000e+06
  Execution time = 1.8769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341088311589
                                         uncertainty =       0.005181372292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341088311589
                                         uncertainty =       0.005181372292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412957064
  error estimate for blocks of size 2^( 2) =       0.000425879546
  error estimate for blocks of size 2^( 3) =       0.000439550556
  error estimate for blocks of size 2^( 4) =       0.000452790021
  error estimate for blocks of size 2^( 5) =       0.000464551014
  error estimate for blocks of size 2^( 6) =       0.000473266051
  error estimate for blocks of size 2^( 7) =       0.000479715239

      target function =                  N/A
              le_mean =     -16.906537284541
             les_mean =     286.172069856087
             stat err =       0.000467580581
             autocorr =       1.282044601215
              std dev =       0.584009480270
             le_variance =       0.341067073046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341806372650
                                         uncertainty =       0.005200673869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341806372650
                                         uncertainty =       0.005200673869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413391527
  error estimate for blocks of size 2^( 2) =       0.000426306058
  error estimate for blocks of size 2^( 3) =       0.000439955101
  error estimate for blocks of size 2^( 4) =       0.000453163931
  error estimate for blocks of size 2^( 5) =       0.000464895388
  error estimate for blocks of size 2^( 6) =       0.000473592447
  error estimate for blocks of size 2^( 7) =       0.000480022861

      target function =                  N/A
              le_mean =     -16.906540927607
             les_mean =     286.172911075629
             stat err =       0.000467918657
             autocorr =       1.281201918797
              std dev =       0.584623904456
             le_variance =       0.341785109661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341666034099
                                         uncertainty =       0.005196550726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341666034099
                                         uncertainty =       0.005196550726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413306646
  error estimate for blocks of size 2^( 2) =       0.000426220874
  error estimate for blocks of size 2^( 3) =       0.000439875095
  error estimate for blocks of size 2^( 4) =       0.000453092914
  error estimate for blocks of size 2^( 5) =       0.000464836771
  error estimate for blocks of size 2^( 6) =       0.000473541290
  error estimate for blocks of size 2^( 7) =       0.000479973569

      target function =                  N/A
              le_mean =     -16.906541022805
             les_mean =     286.172773952325
             stat err =       0.000467861136
             autocorr =       1.281413113497
              std dev =       0.584503864273
             le_variance =       0.341644767350

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341175552600
                                         uncertainty =       0.005183640446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341175552600
                                         uncertainty =       0.005183640446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413009874
  error estimate for blocks of size 2^( 2) =       0.000425930932
  error estimate for blocks of size 2^( 3) =       0.000439599388
  error estimate for blocks of size 2^( 4) =       0.000452835420
  error estimate for blocks of size 2^( 5) =       0.000464594151
  error estimate for blocks of size 2^( 6) =       0.000473307613
  error estimate for blocks of size 2^( 7) =       0.000479753847

      target function =                  N/A
              le_mean =     -16.906537675878
             les_mean =     286.172170327669
             stat err =       0.000467622758
             autocorr =       1.281947996998
              std dev =       0.584084165477
             le_variance =       0.341154312361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906537284541        initial
     5.9605e-02     5.9605e-01             4.3865e-03       -16.906540927607
     2.3842e-01     2.3842e+00             1.2851e-03       -16.906541022805  <--
     9.5367e-01     9.5367e+00             3.3638e-04       -16.906537675878

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 2.9783e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.077317e-01 1 1  ON 0
 uu_1                 1.413504e-01 1 1  ON 1
 uu_2                 4.048222e-02 1 1  ON 2
 uu_3                -2.056472e-02 1 1  ON 3
 uu_4                -6.396411e-02 1 1  ON 4
 uu_5                -9.689515e-02 1 1  ON 5
 uu_6                -1.228588e-01 1 1  ON 6
 uu_7                -1.348263e-01 1 1  ON 7
 uu_8                -1.258247e-01 1 1  ON 8
 uu_9                -9.618626e-02 1 1  ON 9
 ud_0                 4.398323e-01 1 1  ON 10
 ud_1                 1.755115e-01 1 1  ON 11
 ud_2                 5.903643e-02 1 1  ON 12
 ud_3                -9.839068e-03 1 1  ON 13
 ud_4                -6.666417e-02 1 1  ON 14
 ud_5                -1.068851e-01 1 1  ON 15
 ud_6                -1.322101e-01 1 1  ON 16
 ud_7                -1.468748e-01 1 1  ON 17
 ud_8                -1.469679e-01 1 1  ON 18
 ud_9                -1.366391e-01 1 1  ON 19
 eO_0                -7.527068e-01 1 1  ON 20
 eO_1                -4.357514e-01 1 1  ON 21
 eO_2                -1.886451e-02 1 1  ON 22
 eO_3                 2.971747e-01 1 1  ON 23
 eO_4                 5.167172e-01 1 1  ON 24
 eO_5                 4.727632e-01 1 1  ON 25
 eO_6                 2.430788e-01 1 1  ON 26
 eO_7                -5.285632e-02 1 1  ON 27
 eO_8                -2.052580e-01 1 1  ON 28
 eO_9                -6.581383e-02 1 1  ON 29
eH1_0                -2.305257e-01 1 1  ON 30
eH1_1                -1.336550e-01 1 1  ON 31
eH1_2                -8.972478e-02 1 1  ON 32
eH1_3                -3.669210e-02 1 1  ON 33
eH1_4                 1.020291e-02 1 1  ON 34
eH1_5                 4.368633e-02 1 1  ON 35
eH1_6                 9.743921e-02 1 1  ON 36
eH1_7                 1.430323e-01 1 1  ON 37
eH1_8                 1.563030e-01 1 1  ON 38
eH1_9                 4.392517e-02 1 1  ON 39
eH2_0                -2.285115e-01 1 1  ON 40
eH2_1                -1.315146e-01 1 1  ON 41
eH2_2                -8.725981e-02 1 1  ON 42
eH2_3                -3.404510e-02 1 1  ON 43
eH2_4                 1.325270e-02 1 1  ON 44
eH2_5                 4.694643e-02 1 1  ON 45
eH2_6                 1.016229e-01 1 1  ON 46
eH2_7                 1.497524e-01 1 1  ON 47
eH2_8                 1.627346e-01 1 1  ON 48
eH2_9                 2.535432e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6142e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9508
    reference variance = 0.340811
====================================================
  Execution time = 2.2706e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3444e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5344e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334473185336
                                         uncertainty =       0.003495591731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334473185336
                                         uncertainty =       0.003495591731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408925619
  error estimate for blocks of size 2^( 2) =       0.000421838133
  error estimate for blocks of size 2^( 3) =       0.000435202413
  error estimate for blocks of size 2^( 4) =       0.000447443996
  error estimate for blocks of size 2^( 5) =       0.000458360279
  error estimate for blocks of size 2^( 6) =       0.000465876688
  error estimate for blocks of size 2^( 7) =       0.000472644420

      target function =                  N/A
              le_mean =     -16.905833958112
             les_mean =     286.141661975119
             stat err =       0.000461081346
             autocorr =       1.271353916264
              std dev =       0.578308155827
             le_variance =       0.334440323096


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690583395811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905833958112       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905834301809       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905835885222       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905838751452       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905833846552       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905836325655       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905838404605       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905843764703       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905843392592       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905843170333       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905842531680       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905843040625       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905843273707       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905843381365       residual = 5.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 4.165114e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905833958112       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905834146425       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905834614943       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905835435572       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905833596254       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905835093581       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905834682883       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905835951120       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905836149120       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905836131309       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 1.091089e-03

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905833958112       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905834025165       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905834097592       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905833911637       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905834551200       residual = 8.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905834048581       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905834046217       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905834212462       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905834323071       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.784012e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.478095 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8249e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9205
    reference variance = 0.156211
====================================================
  Execution time = 2.0524e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3581e-01
  Total weights = 2.0000e+06
  Execution time = 1.8899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335707789735
                                         uncertainty =       0.004435190110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335707789735
                                         uncertainty =       0.004435190110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409730975
  error estimate for blocks of size 2^( 2) =       0.000422560216
  error estimate for blocks of size 2^( 3) =       0.000435558111
  error estimate for blocks of size 2^( 4) =       0.000448501846
  error estimate for blocks of size 2^( 5) =       0.000460990751
  error estimate for blocks of size 2^( 6) =       0.000470205647
  error estimate for blocks of size 2^( 7) =       0.000476644839

      target function =                  N/A
              le_mean =     -16.906106719059
             les_mean =     286.152203172046
             stat err =       0.000464085771
             autocorr =       1.282918038346
              std dev =       0.579447101752
             le_variance =       0.335758943728

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336091872220
                                         uncertainty =       0.004434539200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336091872220
                                         uncertainty =       0.004434539200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409965516
  error estimate for blocks of size 2^( 2) =       0.000422793419
  error estimate for blocks of size 2^( 3) =       0.000435775776
  error estimate for blocks of size 2^( 4) =       0.000448695784
  error estimate for blocks of size 2^( 5) =       0.000461152414
  error estimate for blocks of size 2^( 6) =       0.000470354949
  error estimate for blocks of size 2^( 7) =       0.000476779540

      target function =                  N/A
              le_mean =     -16.906108502004
             les_mean =     286.152647961782
             stat err =       0.000464245672
             autocorr =       1.282333746474
              std dev =       0.579778792574
             le_variance =       0.336143448319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335810923266
                                         uncertainty =       0.004432176000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335810923266
                                         uncertainty =       0.004432176000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409794033
  error estimate for blocks of size 2^( 2) =       0.000422628671
  error estimate for blocks of size 2^( 3) =       0.000435622411
  error estimate for blocks of size 2^( 4) =       0.000448557943
  error estimate for blocks of size 2^( 5) =       0.000461029513
  error estimate for blocks of size 2^( 6) =       0.000470243783
  error estimate for blocks of size 2^( 7) =       0.000476673501

      target function =                  N/A
              le_mean =     -16.906109457895
             les_mean =     286.152399133339
             stat err =       0.000464126185
             autocorr =       1.282746628245
              std dev =       0.579536279223
             le_variance =       0.335862298936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335678058110
                                         uncertainty =       0.004433744775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335678058110
                                         uncertainty =       0.004433744775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409712841
  error estimate for blocks of size 2^( 2) =       0.000422544326
  error estimate for blocks of size 2^( 3) =       0.000435542925
  error estimate for blocks of size 2^( 4) =       0.000448486975
  error estimate for blocks of size 2^( 5) =       0.000460974125
  error estimate for blocks of size 2^( 6) =       0.000470189942
  error estimate for blocks of size 2^( 7) =       0.000476628342

      target function =                  N/A
              le_mean =     -16.906107235892
             les_mean =     286.152190928184
             stat err =       0.000464069846
             autocorr =       1.282943553204
              std dev =       0.579421456775
             le_variance =       0.335729224572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906106719059        initial
     5.9605e-02     5.9605e-01             4.1651e-03       -16.906108502004
     2.3842e-01     2.3842e+00             1.0911e-03       -16.906109457895  <--
     9.5367e-01     9.5367e+00             2.7840e-04       -16.906107235892

*****************************************************************************
Applying the update for shift_i =   2.3842e-01     and shift_s =   2.3842e+00
*****************************************************************************

  Execution time = 3.0051e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8306e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8816
    reference variance = 0.291274
====================================================
  Execution time = 2.0751e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3681e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336835895087
                                         uncertainty =       0.006003340031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336835895087
                                         uncertainty =       0.006003340031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410373352
  error estimate for blocks of size 2^( 2) =       0.000423601944
  error estimate for blocks of size 2^( 3) =       0.000437088673
  error estimate for blocks of size 2^( 4) =       0.000450131214
  error estimate for blocks of size 2^( 5) =       0.000461675693
  error estimate for blocks of size 2^( 6) =       0.000471121822
  error estimate for blocks of size 2^( 7) =       0.000476857826

      target function =                  N/A
              le_mean =     -16.906854178363
             les_mean =     286.178530615872
             stat err =       0.000464946639
             autocorr =       1.283653831271
              std dev =       0.580355559856
             le_variance =       0.336812575855


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690685417836e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-02, overlap shift 5.9605e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906854178363       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906856135137       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906855092420       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906855310989       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906853674567       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906855819997       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906857939385       residual = 8.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906860785130       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906862206797       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906863457470       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906864278773       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906864385363       residual = 2.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906863756956       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906863273422       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-02 is 3.512135e-03

solving harmonic davidson linear method for identity shift 2.3842e-01, overlap shift 2.3842e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906854178363       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906855247568       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906854551275       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906854515352       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906853594294       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906854503173       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906854739625       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906855442656       residual = 9.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906855836069       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906856020526       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e-01 is 9.002769e-04

solving harmonic davidson linear method for identity shift 9.5367e-01, overlap shift 9.5367e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906854178363       residual = 5.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906854558274       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906854259047       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906854208044       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906853943462       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906854069695       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906854142864       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906854265083       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906854336952       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e-01 is 2.391410e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.482582 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6310e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.081000e-01 1 1  ON 0
 uu_1                 1.417439e-01 1 1  ON 1
 uu_2                 4.065984e-02 1 1  ON 2
 uu_3                -2.077324e-02 1 1  ON 3
 uu_4                -6.427517e-02 1 1  ON 4
 uu_5                -9.718483e-02 1 1  ON 5
 uu_6                -1.230435e-01 1 1  ON 6
 uu_7                -1.350412e-01 1 1  ON 7
 uu_8                -1.266424e-01 1 1  ON 8
 uu_9                -9.674297e-02 1 1  ON 9
 ud_0                 4.401216e-01 1 1  ON 10
 ud_1                 1.760318e-01 1 1  ON 11
 ud_2                 5.948094e-02 1 1  ON 12
 ud_3                -9.527778e-03 1 1  ON 13
 ud_4                -6.667370e-02 1 1  ON 14
 ud_5                -1.071879e-01 1 1  ON 15
 ud_6                -1.327852e-01 1 1  ON 16
 ud_7                -1.466157e-01 1 1  ON 17
 ud_8                -1.473747e-01 1 1  ON 18
 ud_9                -1.369773e-01 1 1  ON 19
 eO_0                -7.545462e-01 1 1  ON 20
 eO_1                -4.373189e-01 1 1  ON 21
 eO_2                -1.947115e-02 1 1  ON 22
 eO_3                 2.977584e-01 1 1  ON 23
 eO_4                 5.183422e-01 1 1  ON 24
 eO_5                 4.746128e-01 1 1  ON 25
 eO_6                 2.445414e-01 1 1  ON 26
 eO_7                -5.170271e-02 1 1  ON 27
 eO_8                -2.065775e-01 1 1  ON 28
 eO_9                -6.696864e-02 1 1  ON 29
eH1_0                -2.311308e-01 1 1  ON 30
eH1_1                -1.344123e-01 1 1  ON 31
eH1_2                -9.043568e-02 1 1  ON 32
eH1_3                -3.739716e-02 1 1  ON 33
eH1_4                 9.581268e-03 1 1  ON 34
eH1_5                 4.282664e-02 1 1  ON 35
eH1_6                 9.724406e-02 1 1  ON 36
eH1_7                 1.445456e-01 1 1  ON 37
eH1_8                 1.578614e-01 1 1  ON 38
eH1_9                 4.521386e-02 1 1  ON 39
eH2_0                -2.289902e-01 1 1  ON 40
eH2_1                -1.319505e-01 1 1  ON 41
eH2_2                -8.791051e-02 1 1  ON 42
eH2_3                -3.449135e-02 1 1  ON 43
eH2_4                 1.264847e-02 1 1  ON 44
eH2_5                 4.638779e-02 1 1  ON 45
eH2_6                 1.016166e-01 1 1  ON 46
eH2_7                 1.499759e-01 1 1  ON 47
eH2_8                 1.639727e-01 1 1  ON 48
eH2_9                 2.707809e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.0098
    reference variance = 1.63505
====================================================
  Execution time = 2.0523e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3703e-01
  Total weights = 2.0000e+06
  Execution time = 1.8955e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336987515426
                                         uncertainty =       0.004533273542

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336987515426
                                         uncertainty =       0.004533273542

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410477841
  error estimate for blocks of size 2^( 2) =       0.000423301589
  error estimate for blocks of size 2^( 3) =       0.000437465114
  error estimate for blocks of size 2^( 4) =       0.000451004425
  error estimate for blocks of size 2^( 5) =       0.000463286590
  error estimate for blocks of size 2^( 6) =       0.000471118236
  error estimate for blocks of size 2^( 7) =       0.000475627228

      target function =                  N/A
              le_mean =     -16.906317852487
             les_mean =     286.160567276634
             stat err =       0.000465259120
             autocorr =       1.284725531533
              std dev =       0.580503329707
             le_variance =       0.336984115800

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337265961910
                                         uncertainty =       0.004540537287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337265961910
                                         uncertainty =       0.004540537287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410647478
  error estimate for blocks of size 2^( 2) =       0.000423463040
  error estimate for blocks of size 2^( 3) =       0.000437609329
  error estimate for blocks of size 2^( 4) =       0.000451124366
  error estimate for blocks of size 2^( 5) =       0.000463389615
  error estimate for blocks of size 2^( 6) =       0.000471199837
  error estimate for blocks of size 2^( 7) =       0.000475713468

      target function =                  N/A
              le_mean =     -16.906317002605
             les_mean =     286.160817126522
             stat err =       0.000465356821
             autocorr =       1.284203497773
              std dev =       0.580743232916
             le_variance =       0.337262702578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337089446999
                                         uncertainty =       0.004536140500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337089446999
                                         uncertainty =       0.004536140500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410540031
  error estimate for blocks of size 2^( 2) =       0.000423357950
  error estimate for blocks of size 2^( 3) =       0.000437511632
  error estimate for blocks of size 2^( 4) =       0.000451039241
  error estimate for blocks of size 2^( 5) =       0.000463309777
  error estimate for blocks of size 2^( 6) =       0.000471131410
  error estimate for blocks of size 2^( 7) =       0.000475648088

      target function =                  N/A
              le_mean =     -16.906315405481
             les_mean =     286.160586655593
             stat err =       0.000465282129
             autocorr =       1.284463363526
              std dev =       0.580591280102
             le_variance =       0.337086234531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336982681829
                                         uncertainty =       0.004533347861

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336982681829
                                         uncertainty =       0.004533347861

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410474923
  error estimate for blocks of size 2^( 2) =       0.000423297719
  error estimate for blocks of size 2^( 3) =       0.000437460140
  error estimate for blocks of size 2^( 4) =       0.000450998584
  error estimate for blocks of size 2^( 5) =       0.000463278752
  error estimate for blocks of size 2^( 6) =       0.000471110245
  error estimate for blocks of size 2^( 7) =       0.000475621132

      target function =                  N/A
              le_mean =     -16.906316792969
             les_mean =     286.160526661233
             stat err =       0.000465252178
             autocorr =       1.284705457762
              std dev =       0.580499203713
             le_variance =       0.336979325511


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906317852487        initial  <--
     5.9605e-02     5.9605e-01             3.5121e-03       -16.906317002605
     2.3842e-01     2.3842e+00             9.0028e-04       -16.906315405481
     9.5367e-01     9.5367e+00             2.3914e-04       -16.906316792969

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0721
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6387e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.178893
====================================================
  Execution time = 2.1208e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3699e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5528e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336899973966
                                         uncertainty =       0.004057509645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336899973966
                                         uncertainty =       0.004057509645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410484171
  error estimate for blocks of size 2^( 2) =       0.000423316851
  error estimate for blocks of size 2^( 3) =       0.000436476635
  error estimate for blocks of size 2^( 4) =       0.000450207328
  error estimate for blocks of size 2^( 5) =       0.000461957392
  error estimate for blocks of size 2^( 6) =       0.000470196358
  error estimate for blocks of size 2^( 7) =       0.000474406934

      target function =                  N/A
              le_mean =     -16.905843889550
             les_mean =     286.144551958980
             stat err =       0.000464192003
             autocorr =       1.278799561487
              std dev =       0.580512282068
             le_variance =       0.336994509631


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690584388955e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-01, overlap shift 5.9605e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905843889550       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905844564217       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905845293142       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905845696282       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905846348932       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905846079722       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905846203606       residual = 8.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905846229618       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905846129963       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e-01 is 4.319669e-04

solving harmonic davidson linear method for identity shift 2.3842e+00, overlap shift 2.3842e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905843889550       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905844085729       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905844339974       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905844407097       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905844582077       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905844532288       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905844558297       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905844531626       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905844542026       residual = 1.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+00 is 1.093171e-04

solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905843889550       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905843940680       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905844011873       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905844026431       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905844069087       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905844057312       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905844064873       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905844056855       residual = 9.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.654232e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.485525 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6768e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.080653e-01 1 1  ON 0
 uu_1                 1.413323e-01 1 1  ON 1
 uu_2                 4.054260e-02 1 1  ON 2
 uu_3                -2.092927e-02 1 1  ON 3
 uu_4                -6.435525e-02 1 1  ON 4
 uu_5                -9.712072e-02 1 1  ON 5
 uu_6                -1.229704e-01 1 1  ON 6
 uu_7                -1.345995e-01 1 1  ON 7
 uu_8                -1.258862e-01 1 1  ON 8
 uu_9                -9.645729e-02 1 1  ON 9
 ud_0                 4.400022e-01 1 1  ON 10
 ud_1                 1.758588e-01 1 1  ON 11
 ud_2                 5.929368e-02 1 1  ON 12
 ud_3                -9.655924e-03 1 1  ON 13
 ud_4                -6.670260e-02 1 1  ON 14
 ud_5                -1.069888e-01 1 1  ON 15
 ud_6                -1.325929e-01 1 1  ON 16
 ud_7                -1.468628e-01 1 1  ON 17
 ud_8                -1.471189e-01 1 1  ON 18
 ud_9                -1.369938e-01 1 1  ON 19
 eO_0                -7.537362e-01 1 1  ON 20
 eO_1                -4.367515e-01 1 1  ON 21
 eO_2                -1.916234e-02 1 1  ON 22
 eO_3                 2.974671e-01 1 1  ON 23
 eO_4                 5.175939e-01 1 1  ON 24
 eO_5                 4.739427e-01 1 1  ON 25
 eO_6                 2.437221e-01 1 1  ON 26
 eO_7                -5.211412e-02 1 1  ON 27
 eO_8                -2.059053e-01 1 1  ON 28
 eO_9                -6.648547e-02 1 1  ON 29
eH1_0                -2.309499e-01 1 1  ON 30
eH1_1                -1.340674e-01 1 1  ON 31
eH1_2                -8.991509e-02 1 1  ON 32
eH1_3                -3.707898e-02 1 1  ON 33
eH1_4                 1.012690e-02 1 1  ON 34
eH1_5                 4.324438e-02 1 1  ON 35
eH1_6                 9.729883e-02 1 1  ON 36
eH1_7                 1.439005e-01 1 1  ON 37
eH1_8                 1.570605e-01 1 1  ON 38
eH1_9                 4.439763e-02 1 1  ON 39
eH2_0                -2.288514e-01 1 1  ON 40
eH2_1                -1.318916e-01 1 1  ON 41
eH2_2                -8.773839e-02 1 1  ON 42
eH2_3                -3.451378e-02 1 1  ON 43
eH2_4                 1.283809e-02 1 1  ON 44
eH2_5                 4.668615e-02 1 1  ON 45
eH2_6                 1.016782e-01 1 1  ON 46
eH2_7                 1.499708e-01 1 1  ON 47
eH2_8                 1.636612e-01 1 1  ON 48
eH2_9                 2.648996e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9588
    reference variance = 0.2136
====================================================
  Execution time = 2.0340e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3940e-01
  Total weights = 2.0000e+06
  Execution time = 1.8778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339291569743
                                         uncertainty =       0.003581642933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339291569743
                                         uncertainty =       0.003581642933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411958006
  error estimate for blocks of size 2^( 2) =       0.000424606269
  error estimate for blocks of size 2^( 3) =       0.000438292668
  error estimate for blocks of size 2^( 4) =       0.000449931133
  error estimate for blocks of size 2^( 5) =       0.000460959879
  error estimate for blocks of size 2^( 6) =       0.000466835345
  error estimate for blocks of size 2^( 7) =       0.000470346537

      target function =                  N/A
              le_mean =     -16.906315650195
             les_mean =     286.162927492300
             stat err =       0.000462018223
             autocorr =       1.257802101453
              std dev =       0.582596599699
             le_variance =       0.339418797980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339274022983
                                         uncertainty =       0.003581422476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339274022983
                                         uncertainty =       0.003581422476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411947366
  error estimate for blocks of size 2^( 2) =       0.000424593287
  error estimate for blocks of size 2^( 3) =       0.000438276166
  error estimate for blocks of size 2^( 4) =       0.000449910896
  error estimate for blocks of size 2^( 5) =       0.000460937752
  error estimate for blocks of size 2^( 6) =       0.000466816947
  error estimate for blocks of size 2^( 7) =       0.000470326385

      target function =                  N/A
              le_mean =     -16.906315048246
             les_mean =     286.162889605356
             stat err =       0.000461997995
             autocorr =       1.257756936698
              std dev =       0.582581551795
             le_variance =       0.339401264492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339263110848
                                         uncertainty =       0.003581084303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339263110848
                                         uncertainty =       0.003581084303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411940745
  error estimate for blocks of size 2^( 2) =       0.000424587854
  error estimate for blocks of size 2^( 3) =       0.000438272494
  error estimate for blocks of size 2^( 4) =       0.000449909299
  error estimate for blocks of size 2^( 5) =       0.000460937443
  error estimate for blocks of size 2^( 6) =       0.000466816781
  error estimate for blocks of size 2^( 7) =       0.000470327149

      target function =                  N/A
              le_mean =     -16.906315301569
             les_mean =     286.162887261590
             stat err =       0.000461997668
             autocorr =       1.257795584234
              std dev =       0.582572188847
             le_variance =       0.339390355218

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339285428114
                                         uncertainty =       0.003581529039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339285428114
                                         uncertainty =       0.003581529039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411954280
  error estimate for blocks of size 2^( 2) =       0.000424602426
  error estimate for blocks of size 2^( 3) =       0.000438288640
  error estimate for blocks of size 2^( 4) =       0.000449926947
  error estimate for blocks of size 2^( 5) =       0.000460955641
  error estimate for blocks of size 2^( 6) =       0.000466831771
  error estimate for blocks of size 2^( 7) =       0.000470342880

      target function =                  N/A
              le_mean =     -16.906315586101
             les_mean =     286.162919184843
             stat err =       0.000462014310
             autocorr =       1.257803547990
              std dev =       0.582591329942
             le_variance =       0.339412657724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906315650195        initial  <--
     5.9605e-01     5.9605e+00             4.3197e-04       -16.906315048246
     2.3842e+00     2.3842e+01             1.0932e-04       -16.906315301569
     9.5367e+00     9.5367e+01             2.6542e-05       -16.906315586101

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8790
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.862
    reference variance = 1.94227
====================================================
  Execution time = 2.0722e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.7983e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379892755394
                                         uncertainty =       0.042782172799

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.379892755394
                                         uncertainty =       0.042782172799

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435791814
  error estimate for blocks of size 2^( 2) =       0.000447982630
  error estimate for blocks of size 2^( 3) =       0.000460789815
  error estimate for blocks of size 2^( 4) =       0.000473602932
  error estimate for blocks of size 2^( 5) =       0.000485003680
  error estimate for blocks of size 2^( 6) =       0.000492380531
  error estimate for blocks of size 2^( 7) =       0.000500074798

      target function =                  N/A
              le_mean =     -16.906271899734
             les_mean =     286.201858368042
             stat err =       0.000487765485
             autocorr =       1.252748800980
              std dev =       0.616302693666
             le_variance =       0.379829010219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627189973e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+00, overlap shift 5.9605e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906271899734       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906272067130       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906272078700       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906272046415       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906271993025       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906271989098       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906271991095       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906272020619       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+00 is 5.324685e-05

solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906271899734       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906271942706       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906271946063       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906271937793       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906271922373       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906271922172       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906271921663       residual = 2.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906271928828       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 1.355335e-05

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906271899734       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906271910550       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906271911420       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906271909341       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906271905348       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906271905343       residual = 8.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906271905165       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906271906931       residual = 4.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 3.404392e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.488184 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6248e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.080443e-01 1 1  ON 0
 uu_1                 1.412898e-01 1 1  ON 1
 uu_2                 4.049748e-02 1 1  ON 2
 uu_3                -2.091212e-02 1 1  ON 3
 uu_4                -6.436729e-02 1 1  ON 4
 uu_5                -9.711078e-02 1 1  ON 5
 uu_6                -1.230021e-01 1 1  ON 6
 uu_7                -1.345669e-01 1 1  ON 7
 uu_8                -1.257927e-01 1 1  ON 8
 uu_9                -9.639083e-02 1 1  ON 9
 ud_0                 4.399994e-01 1 1  ON 10
 ud_1                 1.757963e-01 1 1  ON 11
 ud_2                 5.929715e-02 1 1  ON 12
 ud_3                -9.732405e-03 1 1  ON 13
 ud_4                -6.672401e-02 1 1  ON 14
 ud_5                -1.069801e-01 1 1  ON 15
 ud_6                -1.325967e-01 1 1  ON 16
 ud_7                -1.468291e-01 1 1  ON 17
 ud_8                -1.470713e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.537085e-01 1 1  ON 20
 eO_1                -4.366798e-01 1 1  ON 21
 eO_2                -1.913461e-02 1 1  ON 22
 eO_3                 2.974184e-01 1 1  ON 23
 eO_4                 5.175569e-01 1 1  ON 24
 eO_5                 4.738618e-01 1 1  ON 25
 eO_6                 2.436481e-01 1 1  ON 26
 eO_7                -5.214535e-02 1 1  ON 27
 eO_8                -2.058240e-01 1 1  ON 28
 eO_9                -6.642816e-02 1 1  ON 29
eH1_0                -2.309198e-01 1 1  ON 30
eH1_1                -1.340312e-01 1 1  ON 31
eH1_2                -8.987917e-02 1 1  ON 32
eH1_3                -3.706450e-02 1 1  ON 33
eH1_4                 1.014702e-02 1 1  ON 34
eH1_5                 4.323708e-02 1 1  ON 35
eH1_6                 9.729261e-02 1 1  ON 36
eH1_7                 1.438612e-01 1 1  ON 37
eH1_8                 1.570082e-01 1 1  ON 38
eH1_9                 4.436281e-02 1 1  ON 39
eH2_0                -2.288150e-01 1 1  ON 40
eH2_1                -1.318492e-01 1 1  ON 41
eH2_2                -8.770158e-02 1 1  ON 42
eH2_3                -3.452783e-02 1 1  ON 43
eH2_4                 1.291090e-02 1 1  ON 44
eH2_5                 4.670774e-02 1 1  ON 45
eH2_6                 1.016800e-01 1 1  ON 46
eH2_7                 1.499660e-01 1 1  ON 47
eH2_8                 1.635781e-01 1 1  ON 48
eH2_9                 2.639012e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.863
    reference variance = 0.214085
====================================================
  Execution time = 2.0606e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3600e-01
  Total weights = 2.0000e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336001298799
                                         uncertainty =       0.002705685129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336001298799
                                         uncertainty =       0.002705685129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409877710
  error estimate for blocks of size 2^( 2) =       0.000423011981
  error estimate for blocks of size 2^( 3) =       0.000436415178
  error estimate for blocks of size 2^( 4) =       0.000448951237
  error estimate for blocks of size 2^( 5) =       0.000460705545
  error estimate for blocks of size 2^( 6) =       0.000470945802
  error estimate for blocks of size 2^( 7) =       0.000477991063

      target function =                  N/A
              le_mean =     -16.906476690032
             les_mean =     286.164953377188
             stat err =       0.000464648412
             autocorr =       1.285110023902
              std dev =       0.579654616633
             le_variance =       0.335999474585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335992477892
                                         uncertainty =       0.002705500715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335992477892
                                         uncertainty =       0.002705500715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409872336
  error estimate for blocks of size 2^( 2) =       0.000423006664
  error estimate for blocks of size 2^( 3) =       0.000436409709
  error estimate for blocks of size 2^( 4) =       0.000448945918
  error estimate for blocks of size 2^( 5) =       0.000460700285
  error estimate for blocks of size 2^( 6) =       0.000470940289
  error estimate for blocks of size 2^( 7) =       0.000477986176

      target function =                  N/A
              le_mean =     -16.906476585993
             les_mean =     286.164941048077
             stat err =       0.000464643167
             autocorr =       1.285114713343
              std dev =       0.579647016161
             le_variance =       0.335990663344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335996522846
                                         uncertainty =       0.002705587698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335996522846
                                         uncertainty =       0.002705587698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409874800
  error estimate for blocks of size 2^( 2) =       0.000423009105
  error estimate for blocks of size 2^( 3) =       0.000436412229
  error estimate for blocks of size 2^( 4) =       0.000448948374
  error estimate for blocks of size 2^( 5) =       0.000460702715
  error estimate for blocks of size 2^( 6) =       0.000470942844
  error estimate for blocks of size 2^( 7) =       0.000477988434

      target function =                  N/A
              le_mean =     -16.906476634584
             les_mean =     286.164946731419
             stat err =       0.000464645592
             autocorr =       1.285112673294
              std dev =       0.579650501330
             le_variance =       0.335994703692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336000689081
                                         uncertainty =       0.002705672778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336000689081
                                         uncertainty =       0.002705672778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409877339
  error estimate for blocks of size 2^( 2) =       0.000423011614
  error estimate for blocks of size 2^( 3) =       0.000436414802
  error estimate for blocks of size 2^( 4) =       0.000448950872
  error estimate for blocks of size 2^( 5) =       0.000460705184
  error estimate for blocks of size 2^( 6) =       0.000470945425
  error estimate for blocks of size 2^( 7) =       0.000477990728

      target function =                  N/A
              le_mean =     -16.906476682893
             les_mean =     286.164952526726
             stat err =       0.000464648052
             autocorr =       1.285110365104
              std dev =       0.579654091253
             le_variance =       0.335998865507


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906476690032        initial  <--
     5.9605e+00     5.9605e+01             5.3247e-05       -16.906476585993
     2.3842e+01     2.3842e+02             1.3553e-05       -16.906476634584
     9.5367e+01     9.5367e+02             3.4044e-06       -16.906476682893

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0999
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6353e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8939
    reference variance = 0.311717
====================================================
  Execution time = 2.0880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3516e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4985e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335167121758
                                         uncertainty =       0.002810803901

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335167121758
                                         uncertainty =       0.002810803901

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409366573
  error estimate for blocks of size 2^( 2) =       0.000422372060
  error estimate for blocks of size 2^( 3) =       0.000436060432
  error estimate for blocks of size 2^( 4) =       0.000449874000
  error estimate for blocks of size 2^( 5) =       0.000462604056
  error estimate for blocks of size 2^( 6) =       0.000472305899
  error estimate for blocks of size 2^( 7) =       0.000478588087

      target function =                  N/A
              le_mean =     -16.906350745658
             les_mean =     286.159857349106
             stat err =       0.000465843010
             autocorr =       1.294954215513
              std dev =       0.578931758917
             le_variance =       0.335161981483


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690635074566e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906350745658       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906350744763       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906350730165       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906350736667       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906350736537       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906350740707       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906350740815       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906350742043       residual = 2.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 5.405510e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906350745658       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906350745434       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906350741771       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906350743396       residual = 9.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906350743355       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906350744397       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906350744429       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906350744735       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.353899e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906350745658       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906350745602       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906350744685       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906350745092       residual = 9.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906350745081       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906350745341       residual = 6.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906350745349       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906350745425       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 3.386333e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.490822 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6386e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.080494e-01 1 1  ON 0
 uu_1                 1.412823e-01 1 1  ON 1
 uu_2                 4.049631e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436467e-02 1 1  ON 4
 uu_5                -9.711062e-02 1 1  ON 5
 uu_6                -1.230010e-01 1 1  ON 6
 uu_7                -1.345661e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639072e-02 1 1  ON 9
 ud_0                 4.400010e-01 1 1  ON 10
 ud_1                 1.757951e-01 1 1  ON 11
 ud_2                 5.929446e-02 1 1  ON 12
 ud_3                -9.736004e-03 1 1  ON 13
 ud_4                -6.672400e-02 1 1  ON 14
 ud_5                -1.069754e-01 1 1  ON 15
 ud_6                -1.325995e-01 1 1  ON 16
 ud_7                -1.468290e-01 1 1  ON 17
 ud_8                -1.470637e-01 1 1  ON 18
 ud_9                -1.369491e-01 1 1  ON 19
 eO_0                -7.536963e-01 1 1  ON 20
 eO_1                -4.366749e-01 1 1  ON 21
 eO_2                -1.913162e-02 1 1  ON 22
 eO_3                 2.974123e-01 1 1  ON 23
 eO_4                 5.175478e-01 1 1  ON 24
 eO_5                 4.738551e-01 1 1  ON 25
 eO_6                 2.436417e-01 1 1  ON 26
 eO_7                -5.214790e-02 1 1  ON 27
 eO_8                -2.058180e-01 1 1  ON 28
 eO_9                -6.642373e-02 1 1  ON 29
eH1_0                -2.309118e-01 1 1  ON 30
eH1_1                -1.340282e-01 1 1  ON 31
eH1_2                -8.987404e-02 1 1  ON 32
eH1_3                -3.706610e-02 1 1  ON 33
eH1_4                 1.014704e-02 1 1  ON 34
eH1_5                 4.323376e-02 1 1  ON 35
eH1_6                 9.729327e-02 1 1  ON 36
eH1_7                 1.438618e-01 1 1  ON 37
eH1_8                 1.570025e-01 1 1  ON 38
eH1_9                 4.435589e-02 1 1  ON 39
eH2_0                -2.288180e-01 1 1  ON 40
eH2_1                -1.318427e-01 1 1  ON 41
eH2_2                -8.769698e-02 1 1  ON 42
eH2_3                -3.452245e-02 1 1  ON 43
eH2_4                 1.291260e-02 1 1  ON 44
eH2_5                 4.670619e-02 1 1  ON 45
eH2_6                 1.016830e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635702e-01 1 1  ON 48
eH2_9                 2.638177e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8498
    reference variance = 0.205993
====================================================
  Execution time = 2.0514e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3388e-01
  Total weights = 2.0000e+06
  Execution time = 1.8809e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333842413464
                                         uncertainty =       0.002602073189

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333842413464
                                         uncertainty =       0.002602073189

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408584597
  error estimate for blocks of size 2^( 2) =       0.000421784715
  error estimate for blocks of size 2^( 3) =       0.000435643840
  error estimate for blocks of size 2^( 4) =       0.000448428899
  error estimate for blocks of size 2^( 5) =       0.000460532194
  error estimate for blocks of size 2^( 6) =       0.000470993365
  error estimate for blocks of size 2^( 7) =       0.000475800600

      target function =                  N/A
              le_mean =     -16.905275558885
             les_mean =     286.122224300890
             stat err =       0.000463938765
             autocorr =       1.289309973787
              std dev =       0.577825878619
             le_variance =       0.333882746002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333841849772
                                         uncertainty =       0.002602070232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333841849772
                                         uncertainty =       0.002602070232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408584253
  error estimate for blocks of size 2^( 2) =       0.000421784400
  error estimate for blocks of size 2^( 3) =       0.000435643525
  error estimate for blocks of size 2^( 4) =       0.000448428571
  error estimate for blocks of size 2^( 5) =       0.000460531857
  error estimate for blocks of size 2^( 6) =       0.000470993020
  error estimate for blocks of size 2^( 7) =       0.000475800234

      target function =                  N/A
              le_mean =     -16.905275554267
             les_mean =     286.122223581591
             stat err =       0.000463938420
             autocorr =       1.289310235837
              std dev =       0.577825391304
             le_variance =       0.333882182835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333842127271
                                         uncertainty =       0.002602071682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333842127271
                                         uncertainty =       0.002602071682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408584422
  error estimate for blocks of size 2^( 2) =       0.000421784555
  error estimate for blocks of size 2^( 3) =       0.000435643680
  error estimate for blocks of size 2^( 4) =       0.000448428733
  error estimate for blocks of size 2^( 5) =       0.000460532023
  error estimate for blocks of size 2^( 6) =       0.000470993190
  error estimate for blocks of size 2^( 7) =       0.000475800415

      target function =                  N/A
              le_mean =     -16.905275556549
             les_mean =     286.122223936001
             stat err =       0.000463938590
             autocorr =       1.289310109110
              std dev =       0.577825631202
             le_variance =       0.333882460074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333842377547
                                         uncertainty =       0.002602073000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333842377547
                                         uncertainty =       0.002602073000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408584575
  error estimate for blocks of size 2^( 2) =       0.000421784695
  error estimate for blocks of size 2^( 3) =       0.000435643820
  error estimate for blocks of size 2^( 4) =       0.000448428878
  error estimate for blocks of size 2^( 5) =       0.000460532172
  error estimate for blocks of size 2^( 6) =       0.000470993343
  error estimate for blocks of size 2^( 7) =       0.000475800577

      target function =                  N/A
              le_mean =     -16.905275558591
             les_mean =     286.122224255085
             stat err =       0.000463938743
             autocorr =       1.289309990843
              std dev =       0.577825847568
             le_variance =       0.333882710117


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905275558885        initial  <--
     5.9605e+01     5.9605e+02             5.4055e-06       -16.905275554267
     2.3842e+02     2.3842e+03             1.3539e-06       -16.905275556549
     9.5367e+02     9.5367e+03             3.3863e-07       -16.905275558591

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9849
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6384e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8903
    reference variance = 0.193546
====================================================
  Execution time = 2.0750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3074e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330795683530
                                         uncertainty =       0.002866596766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330795683530
                                         uncertainty =       0.002866596766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406655422
  error estimate for blocks of size 2^( 2) =       0.000420072200
  error estimate for blocks of size 2^( 3) =       0.000433846055
  error estimate for blocks of size 2^( 4) =       0.000447154783
  error estimate for blocks of size 2^( 5) =       0.000459314681
  error estimate for blocks of size 2^( 6) =       0.000468476487
  error estimate for blocks of size 2^( 7) =       0.000476895216

      target function =                  N/A
              le_mean =     -16.906229464957
             les_mean =     286.151331820494
             stat err =       0.000462960292
             autocorr =       1.296087589922
              std dev =       0.575097612664
             le_variance =       0.330737264092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622946496e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906229464957       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906229465718       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906229465723       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906229465499       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906229464719       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906229464783       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906229464949       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906229464953       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 5.645227e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906229464957       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906229465147       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906229465148       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906229465092       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906229464897       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906229464913       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906229464954       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906229464955       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.411610e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906229464957       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906229465004       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906229465005       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906229464992       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906229464938       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906229464948       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906229464949       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906229464945       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 3.529216e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.494323 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8618e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.080497e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049643e-02 1 1  ON 2
 uu_3                -2.091041e-02 1 1  ON 3
 uu_4                -6.436458e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345660e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400010e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929425e-02 1 1  ON 12
 ud_3                -9.735978e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325990e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536951e-01 1 1  ON 20
 eO_1                -4.366745e-01 1 1  ON 21
 eO_2                -1.913130e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175471e-01 1 1  ON 24
 eO_5                 4.738544e-01 1 1  ON 25
 eO_6                 2.436412e-01 1 1  ON 26
 eO_7                -5.214841e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642314e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340280e-01 1 1  ON 31
eH1_2                -8.987325e-02 1 1  ON 32
eH1_3                -3.706597e-02 1 1  ON 33
eH1_4                 1.014688e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729326e-02 1 1  ON 36
eH1_7                 1.438615e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435549e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452222e-02 1 1  ON 43
eH2_4                 1.291283e-02 1 1  ON 44
eH2_5                 4.670630e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499662e-01 1 1  ON 47
eH2_8                 1.635693e-01 1 1  ON 48
eH2_9                 2.638075e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8956
    reference variance = 0.178164
====================================================
  Execution time = 2.0303e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4644e-01
  Total weights = 2.0000e+06
  Execution time = 1.8830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346460059025
                                         uncertainty =       0.006584714697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346460059025
                                         uncertainty =       0.006584714697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416200204
  error estimate for blocks of size 2^( 2) =       0.000429023302
  error estimate for blocks of size 2^( 3) =       0.000442444616
  error estimate for blocks of size 2^( 4) =       0.000455727715
  error estimate for blocks of size 2^( 5) =       0.000468496953
  error estimate for blocks of size 2^( 6) =       0.000478789066
  error estimate for blocks of size 2^( 7) =       0.000484839949

      target function =                  N/A
              le_mean =     -16.906612954471
             les_mean =     286.180006639059
             stat err =       0.000471963421
             autocorr =       1.285914526853
              std dev =       0.588595973490
             le_variance =       0.346445220008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346459821858
                                         uncertainty =       0.006584715461

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346459821858
                                         uncertainty =       0.006584715461

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416200062
  error estimate for blocks of size 2^( 2) =       0.000429023163
  error estimate for blocks of size 2^( 3) =       0.000442444479
  error estimate for blocks of size 2^( 4) =       0.000455727582
  error estimate for blocks of size 2^( 5) =       0.000468496820
  error estimate for blocks of size 2^( 6) =       0.000478788937
  error estimate for blocks of size 2^( 7) =       0.000484839826

      target function =                  N/A
              le_mean =     -16.906612953564
             les_mean =     286.180006371527
             stat err =       0.000471963292
             autocorr =       1.285914701825
              std dev =       0.588595772275
             le_variance =       0.346444983140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346459940363
                                         uncertainty =       0.006584715079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346459940363
                                         uncertainty =       0.006584715079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416200133
  error estimate for blocks of size 2^( 2) =       0.000429023232
  error estimate for blocks of size 2^( 3) =       0.000442444548
  error estimate for blocks of size 2^( 4) =       0.000455727649
  error estimate for blocks of size 2^( 5) =       0.000468496887
  error estimate for blocks of size 2^( 6) =       0.000478789001
  error estimate for blocks of size 2^( 7) =       0.000484839888

      target function =                  N/A
              le_mean =     -16.906612954017
             les_mean =     286.180006505203
             stat err =       0.000471963356
             autocorr =       1.285914614405
              std dev =       0.588595872816
             le_variance =       0.346445101496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346460044189
                                         uncertainty =       0.006584714744

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346460044189
                                         uncertainty =       0.006584714744

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416200195
  error estimate for blocks of size 2^( 2) =       0.000429023293
  error estimate for blocks of size 2^( 3) =       0.000442444608
  error estimate for blocks of size 2^( 4) =       0.000455727707
  error estimate for blocks of size 2^( 5) =       0.000468496945
  error estimate for blocks of size 2^( 6) =       0.000478789058
  error estimate for blocks of size 2^( 7) =       0.000484839941

      target function =                  N/A
              le_mean =     -16.906612954414
             les_mean =     286.180006622324
             stat err =       0.000471963413
             autocorr =       1.285914537800
              std dev =       0.588595960903
             le_variance =       0.346445205192


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906612954471        initial  <--
     5.9605e+02     5.9605e+03             5.6452e-07       -16.906612953564
     2.3842e+03     2.3842e+04             1.4116e-07       -16.906612954017
     9.5367e+03     9.5367e+04             3.5292e-08       -16.906612954414

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8092
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8432e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8645
    reference variance = 0.472157
====================================================
  Execution time = 2.0959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3299e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333063088955
                                         uncertainty =       0.002338776663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333063088955
                                         uncertainty =       0.002338776663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408035925
  error estimate for blocks of size 2^( 2) =       0.000420888369
  error estimate for blocks of size 2^( 3) =       0.000434468343
  error estimate for blocks of size 2^( 4) =       0.000447838291
  error estimate for blocks of size 2^( 5) =       0.000458689572
  error estimate for blocks of size 2^( 6) =       0.000468467183
  error estimate for blocks of size 2^( 7) =       0.000476568658

      target function =                  N/A
              le_mean =     -16.906222889135
             les_mean =     286.153358842827
             stat err =       0.000462890926
             autocorr =       1.286946613666
              std dev =       0.577049939086
             le_variance =       0.332986632199


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622288914e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906222889135       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906222889117       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906222889103       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906222889166       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906222889192       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906222889205       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906222889226       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906222889206       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 4.217884e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906222889135       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906222889131       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906222889127       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906222889148       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906222889151       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906222889150       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906222889162       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906222889139       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 1.054496e-08

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906222889135       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906222889134       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906222889133       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906222889137       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906222889139       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906222889108       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906222889126       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906222889241       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.636257e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.496971 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6583e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049642e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736013e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536950e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214841e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642310e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014688e-02 1 1  ON 34
eH1_5                 4.323412e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670635e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9861
    reference variance = 0.813455
====================================================
  Execution time = 2.0468e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3503e-01
  Total weights = 2.0000e+06
  Execution time = 1.8879e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110191465
                                         uncertainty =       0.004577002099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110191465
                                         uncertainty =       0.004577002099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409288320
  error estimate for blocks of size 2^( 2) =       0.000422144726
  error estimate for blocks of size 2^( 3) =       0.000435767017
  error estimate for blocks of size 2^( 4) =       0.000448460827
  error estimate for blocks of size 2^( 5) =       0.000460255907
  error estimate for blocks of size 2^( 6) =       0.000471831854
  error estimate for blocks of size 2^( 7) =       0.000476914783

      target function =                  N/A
              le_mean =     -16.906132656212
             les_mean =     286.152355079289
             stat err =       0.000464365842
             autocorr =       1.287246831356
              std dev =       0.578821092725
             le_variance =       0.335033857383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110183614
                                         uncertainty =       0.004577001885

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110183614
                                         uncertainty =       0.004577001885

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409288315
  error estimate for blocks of size 2^( 2) =       0.000422144721
  error estimate for blocks of size 2^( 3) =       0.000435767012
  error estimate for blocks of size 2^( 4) =       0.000448460822
  error estimate for blocks of size 2^( 5) =       0.000460255902
  error estimate for blocks of size 2^( 6) =       0.000471831849
  error estimate for blocks of size 2^( 7) =       0.000476914778

      target function =                  N/A
              le_mean =     -16.906132656121
             les_mean =     286.152355068412
             stat err =       0.000464365838
             autocorr =       1.287246835765
              std dev =       0.578821085962
             le_variance =       0.335033849554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110187539
                                         uncertainty =       0.004577001992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110187539
                                         uncertainty =       0.004577001992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409288317
  error estimate for blocks of size 2^( 2) =       0.000422144724
  error estimate for blocks of size 2^( 3) =       0.000435767014
  error estimate for blocks of size 2^( 4) =       0.000448460824
  error estimate for blocks of size 2^( 5) =       0.000460255904
  error estimate for blocks of size 2^( 6) =       0.000471831852
  error estimate for blocks of size 2^( 7) =       0.000476914780

      target function =                  N/A
              le_mean =     -16.906132656166
             les_mean =     286.152355073850
             stat err =       0.000464365840
             autocorr =       1.287246833569
              std dev =       0.578821089343
             le_variance =       0.335033853468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110190974
                                         uncertainty =       0.004577002086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335110190974
                                         uncertainty =       0.004577002086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409288319
  error estimate for blocks of size 2^( 2) =       0.000422144726
  error estimate for blocks of size 2^( 3) =       0.000435767016
  error estimate for blocks of size 2^( 4) =       0.000448460826
  error estimate for blocks of size 2^( 5) =       0.000460255906
  error estimate for blocks of size 2^( 6) =       0.000471831854
  error estimate for blocks of size 2^( 7) =       0.000476914782

      target function =                  N/A
              le_mean =     -16.906132656206
             les_mean =     286.152355078609
             stat err =       0.000464365842
             autocorr =       1.287246831632
              std dev =       0.578821092302
             le_variance =       0.335033856893


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906132656212        initial  <--
     5.9605e+03     5.9605e+04             4.2179e-08       -16.906132656121
     2.3842e+04     2.3842e+05             1.0545e-08       -16.906132656166
     9.5367e+04     9.5367e+05             2.6363e-09       -16.906132656206

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9642
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6553e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8932
    reference variance = 0.274627
====================================================
  Execution time = 2.0693e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3741e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6221e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337286460171
                                         uncertainty =       0.003288195942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337286460171
                                         uncertainty =       0.003288195942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410736230
  error estimate for blocks of size 2^( 2) =       0.000423839774
  error estimate for blocks of size 2^( 3) =       0.000437516431
  error estimate for blocks of size 2^( 4) =       0.000451504537
  error estimate for blocks of size 2^( 5) =       0.000464888798
  error estimate for blocks of size 2^( 6) =       0.000473814774
  error estimate for blocks of size 2^( 7) =       0.000480516891

      target function =                  N/A
              le_mean =     -16.906486411823
             les_mean =     286.166691125646
             stat err =       0.000467681250
             autocorr =       1.296504096070
              std dev =       0.580868746960
             le_variance =       0.337408501195


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690648641182e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906486411823       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906486411842       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906486411829       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906486411837       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906486411826       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906486411835       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906486411832       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906486411843       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 5.781820e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906486411823       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906486411828       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906486411824       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906486411826       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906486411874       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906486412252       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906486411859       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906486411706       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 1.445457e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906486411823       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906486411824       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906486411823       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906486411713       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906486411783       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906486411574       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906486412932       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906486411605       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 3.613642e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.499608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6321e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049642e-02 1 1  ON 2
 uu_3                -2.091040e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8448
    reference variance = 0.224798
====================================================
  Execution time = 2.0335e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4182e-01
  Total weights = 2.0000e+06
  Execution time = 1.8888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341863672018
                                         uncertainty =       0.004647938607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341863672018
                                         uncertainty =       0.004647938607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413414568
  error estimate for blocks of size 2^( 2) =       0.000426258126
  error estimate for blocks of size 2^( 3) =       0.000439615352
  error estimate for blocks of size 2^( 4) =       0.000452462327
  error estimate for blocks of size 2^( 5) =       0.000463524371
  error estimate for blocks of size 2^( 6) =       0.000473153876
  error estimate for blocks of size 2^( 7) =       0.000481271735

      target function =                  N/A
              le_mean =     -16.906092896956
             les_mean =     286.157800079044
             stat err =       0.000467603077
             autocorr =       1.279331723014
              std dev =       0.584656488413
             le_variance =       0.341823209443

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341863668849
                                         uncertainty =       0.004647938525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341863668849
                                         uncertainty =       0.004647938525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413414566
  error estimate for blocks of size 2^( 2) =       0.000426258125
  error estimate for blocks of size 2^( 3) =       0.000439615350
  error estimate for blocks of size 2^( 4) =       0.000452462325
  error estimate for blocks of size 2^( 5) =       0.000463524370
  error estimate for blocks of size 2^( 6) =       0.000473153874
  error estimate for blocks of size 2^( 7) =       0.000481271733

      target function =                  N/A
              le_mean =     -16.906092896946
             les_mean =     286.157800075548
             stat err =       0.000467603076
             autocorr =       1.279331725912
              std dev =       0.584656485704
             le_variance =       0.341823206275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341863670433
                                         uncertainty =       0.004647938566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341863670433
                                         uncertainty =       0.004647938566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413414567
  error estimate for blocks of size 2^( 2) =       0.000426258126
  error estimate for blocks of size 2^( 3) =       0.000439615351
  error estimate for blocks of size 2^( 4) =       0.000452462326
  error estimate for blocks of size 2^( 5) =       0.000463524370
  error estimate for blocks of size 2^( 6) =       0.000473153875
  error estimate for blocks of size 2^( 7) =       0.000481271734

      target function =                  N/A
              le_mean =     -16.906092896951
             les_mean =     286.157800077296
             stat err =       0.000467603076
             autocorr =       1.279331724464
              std dev =       0.584656487058
             le_variance =       0.341823207859

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341863671820
                                         uncertainty =       0.004647938602

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341863671820
                                         uncertainty =       0.004647938602

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413414568
  error estimate for blocks of size 2^( 2) =       0.000426258126
  error estimate for blocks of size 2^( 3) =       0.000439615352
  error estimate for blocks of size 2^( 4) =       0.000452462327
  error estimate for blocks of size 2^( 5) =       0.000463524371
  error estimate for blocks of size 2^( 6) =       0.000473153876
  error estimate for blocks of size 2^( 7) =       0.000481271735

      target function =                  N/A
              le_mean =     -16.906092896956
             les_mean =     286.157800078825
             stat err =       0.000467603077
             autocorr =       1.279331723195
              std dev =       0.584656488244
             le_variance =       0.341823209245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906092896956        initial  <--
     5.9605e+04     5.9605e+05             5.7818e-09       -16.906092896946
     2.3842e+05     2.3842e+06             1.4455e-09       -16.906092896951
     9.5367e+05     9.5367e+06             3.6136e-10       -16.906092896956

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8543
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6232e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8583
    reference variance = 0.424642
====================================================
  Execution time = 2.0782e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3450e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5422e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334587771403
                                         uncertainty =       0.003359091162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334587771403
                                         uncertainty =       0.003359091162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408965121
  error estimate for blocks of size 2^( 2) =       0.000421915522
  error estimate for blocks of size 2^( 3) =       0.000435078961
  error estimate for blocks of size 2^( 4) =       0.000447520135
  error estimate for blocks of size 2^( 5) =       0.000459278757
  error estimate for blocks of size 2^( 6) =       0.000468696618
  error estimate for blocks of size 2^( 7) =       0.000472475511

      target function =                  N/A
              le_mean =     -16.906487699390
             les_mean =     286.163831102839
             stat err =       0.000461992755
             autocorr =       1.276138437419
              std dev =       0.578364020717
             le_variance =       0.334504940460


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690648769939e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906487699390       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906487699390       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906487699390       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906487699268       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906487699830       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906487699310       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906487699002       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906487699167       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.568336e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906487699390       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906487699390       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906487699390       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906487699390       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906487699390       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906487698770       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906487700096       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906487699405       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.142085e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906487699390       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906487699390       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906487699390       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906487695562       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906487695682       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906487700775       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906487700582       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906487698996       residual = 4.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.855213e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.502237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6331e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8748
    reference variance = 0.29113
====================================================
  Execution time = 2.0266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3697e-01
  Total weights = 2.0000e+06
  Execution time = 1.8797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010424203
                                         uncertainty =       0.003065747572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010424203
                                         uncertainty =       0.003065747572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410469401
  error estimate for blocks of size 2^( 2) =       0.000423389287
  error estimate for blocks of size 2^( 3) =       0.000436650417
  error estimate for blocks of size 2^( 4) =       0.000449965021
  error estimate for blocks of size 2^( 5) =       0.000461232388
  error estimate for blocks of size 2^( 6) =       0.000471101373
  error estimate for blocks of size 2^( 7) =       0.000479444964

      target function =                  N/A
              le_mean =     -16.905975587566
             les_mean =     286.148980656834
             stat err =       0.000465435936
             autocorr =       1.285755082023
              std dev =       0.580491393513
             le_variance =       0.336970257942

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010424481
                                         uncertainty =       0.003065747574

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010424481
                                         uncertainty =       0.003065747574

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410469401
  error estimate for blocks of size 2^( 2) =       0.000423389287
  error estimate for blocks of size 2^( 3) =       0.000436650417
  error estimate for blocks of size 2^( 4) =       0.000449965021
  error estimate for blocks of size 2^( 5) =       0.000461232388
  error estimate for blocks of size 2^( 6) =       0.000471101373
  error estimate for blocks of size 2^( 7) =       0.000479444964

      target function =                  N/A
              le_mean =     -16.905975587566
             les_mean =     286.148980657120
             stat err =       0.000465435936
             autocorr =       1.285755081708
              std dev =       0.580491393752
             le_variance =       0.336970258220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010424342
                                         uncertainty =       0.003065747573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010424342
                                         uncertainty =       0.003065747573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410469401
  error estimate for blocks of size 2^( 2) =       0.000423389287
  error estimate for blocks of size 2^( 3) =       0.000436650417
  error estimate for blocks of size 2^( 4) =       0.000449965021
  error estimate for blocks of size 2^( 5) =       0.000461232388
  error estimate for blocks of size 2^( 6) =       0.000471101373
  error estimate for blocks of size 2^( 7) =       0.000479444964

      target function =                  N/A
              le_mean =     -16.905975587566
             les_mean =     286.148980656977
             stat err =       0.000465435936
             autocorr =       1.285755081858
              std dev =       0.580491393632
             le_variance =       0.336970258081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010424221
                                         uncertainty =       0.003065747572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337010424221
                                         uncertainty =       0.003065747572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410469401
  error estimate for blocks of size 2^( 2) =       0.000423389287
  error estimate for blocks of size 2^( 3) =       0.000436650417
  error estimate for blocks of size 2^( 4) =       0.000449965021
  error estimate for blocks of size 2^( 5) =       0.000461232388
  error estimate for blocks of size 2^( 6) =       0.000471101373
  error estimate for blocks of size 2^( 7) =       0.000479444964

      target function =                  N/A
              le_mean =     -16.905975587566
             les_mean =     286.148980656852
             stat err =       0.000465435936
             autocorr =       1.285755082006
              std dev =       0.580491393528
             le_variance =       0.336970257960


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905975587566        initial
     5.9605e+05     5.9605e+06             4.5683e-10       -16.905975587566  <--
     2.3842e+06     2.3842e+07             1.1421e-10       -16.905975587566
     9.5367e+06     9.5367e+07             2.8552e-11       -16.905975587566

*****************************************************************************
Applying the update for shift_i =   5.9605e+05     and shift_s =   5.9605e+06
*****************************************************************************

  Execution time = 2.9771e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736015e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706593e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6108e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8619
    reference variance = 0.222096
====================================================
  Execution time = 2.0912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3111e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331124128975
                                         uncertainty =       0.002873107450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331124128975
                                         uncertainty =       0.002873107450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406885064
  error estimate for blocks of size 2^( 2) =       0.000419979937
  error estimate for blocks of size 2^( 3) =       0.000433776117
  error estimate for blocks of size 2^( 4) =       0.000446161953
  error estimate for blocks of size 2^( 5) =       0.000458430480
  error estimate for blocks of size 2^( 6) =       0.000468026722
  error estimate for blocks of size 2^( 7) =       0.000475595747

      target function =                  N/A
              le_mean =     -16.906114206732
             les_mean =     286.147808316052
             stat err =       0.000462053726
             autocorr =       1.289559713172
              std dev =       0.575422375789
             le_variance =       0.331110910558


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690611420673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906114206732       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906114206732       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906114206732       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906114206732       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906114206814       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906114206746       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906114206681       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906114206805       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.545525e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906114206732       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906114206732       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906114206732       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906114206732       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906114206782       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906114206762       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906114206652       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906114206623       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 3.863812e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906114206732       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906114206732       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906114206732       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906114206732       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906114206732       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906114206732       residual = 6.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906114207390       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906114203473       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 9.659542e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.504862 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6425e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913126e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738542e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638064e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9069
    reference variance = 0.207932
====================================================
  Execution time = 2.0627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3335e-01
  Total weights = 2.0000e+06
  Execution time = 1.8834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333427780472
                                         uncertainty =       0.004195251215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333427780472
                                         uncertainty =       0.004195251215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408260596
  error estimate for blocks of size 2^( 2) =       0.000421193279
  error estimate for blocks of size 2^( 3) =       0.000434664357
  error estimate for blocks of size 2^( 4) =       0.000448079708
  error estimate for blocks of size 2^( 5) =       0.000459398891
  error estimate for blocks of size 2^( 6) =       0.000468852619
  error estimate for blocks of size 2^( 7) =       0.000474493163

      target function =                  N/A
              le_mean =     -16.906360662130
             les_mean =     286.158384099767
             stat err =       0.000462706095
             autocorr =       1.284504146570
              std dev =       0.577367671790
             le_variance =       0.333353428428

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333427780482
                                         uncertainty =       0.004195251209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333427780482
                                         uncertainty =       0.004195251209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408260596
  error estimate for blocks of size 2^( 2) =       0.000421193279
  error estimate for blocks of size 2^( 3) =       0.000434664357
  error estimate for blocks of size 2^( 4) =       0.000448079708
  error estimate for blocks of size 2^( 5) =       0.000459398891
  error estimate for blocks of size 2^( 6) =       0.000468852619
  error estimate for blocks of size 2^( 7) =       0.000474493163

      target function =                  N/A
              le_mean =     -16.906360662134
             les_mean =     286.158384099917
             stat err =       0.000462706095
             autocorr =       1.284504146436
              std dev =       0.577367671799
             le_variance =       0.333353428439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333427780477
                                         uncertainty =       0.004195251212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333427780477
                                         uncertainty =       0.004195251212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408260596
  error estimate for blocks of size 2^( 2) =       0.000421193279
  error estimate for blocks of size 2^( 3) =       0.000434664357
  error estimate for blocks of size 2^( 4) =       0.000448079708
  error estimate for blocks of size 2^( 5) =       0.000459398891
  error estimate for blocks of size 2^( 6) =       0.000468852619
  error estimate for blocks of size 2^( 7) =       0.000474493163

      target function =                  N/A
              le_mean =     -16.906360662132
             les_mean =     286.158384099842
             stat err =       0.000462706095
             autocorr =       1.284504146501
              std dev =       0.577367671794
             le_variance =       0.333353428433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333427780473
                                         uncertainty =       0.004195251215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333427780473
                                         uncertainty =       0.004195251215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408260596
  error estimate for blocks of size 2^( 2) =       0.000421193279
  error estimate for blocks of size 2^( 3) =       0.000434664357
  error estimate for blocks of size 2^( 4) =       0.000448079708
  error estimate for blocks of size 2^( 5) =       0.000459398891
  error estimate for blocks of size 2^( 6) =       0.000468852619
  error estimate for blocks of size 2^( 7) =       0.000474493163

      target function =                  N/A
              le_mean =     -16.906360662130
             les_mean =     286.158384099776
             stat err =       0.000462706095
             autocorr =       1.284504146562
              std dev =       0.577367671790
             le_variance =       0.333353428428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906360662130        initial
     1.4901e+05     1.4901e+06             1.5455e-09       -16.906360662134  <--
     5.9605e+05     5.9605e+06             3.8638e-10       -16.906360662132
     2.3842e+06     2.3842e+07             9.6595e-11       -16.906360662130

*****************************************************************************
Applying the update for shift_i =   1.4901e+05     and shift_s =   1.4901e+06
*****************************************************************************

  Execution time = 3.0130e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6560e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8972
    reference variance = 0.256467
====================================================
  Execution time = 2.1069e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6750e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5239e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367595538652
                                         uncertainty =       0.019442238519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.367595538652
                                         uncertainty =       0.019442238519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428658156
  error estimate for blocks of size 2^( 2) =       0.000441567247
  error estimate for blocks of size 2^( 3) =       0.000455027321
  error estimate for blocks of size 2^( 4) =       0.000466978995
  error estimate for blocks of size 2^( 5) =       0.000478041044
  error estimate for blocks of size 2^( 6) =       0.000487272956
  error estimate for blocks of size 2^( 7) =       0.000492327717

      target function =                  N/A
              le_mean =     -16.906274154029
             les_mean =     286.189601216490
             stat err =       0.000481155178
             autocorr =       1.259935013739
              std dev =       0.606214177525
             le_variance =       0.367495629033


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690627415403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906274154029       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906274154039       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906274154052       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906274154070       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906274154087       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906274154068       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906274154070       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906274154068       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 9.134108e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906274154029       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906274154032       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906274154035       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906274154027       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906274154044       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906274153997       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906274153917       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906274154139       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 2.283528e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906274154029       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906274154030       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906274154031       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906274154032       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906274154033       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906274154108       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906274153872       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906274153964       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 5.708818e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.507474 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6600e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736013e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014688e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8774
    reference variance = 0.15915
====================================================
  Execution time = 2.2192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3655e-01
  Total weights = 2.0000e+06
  Execution time = 1.8778e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336625915230
                                         uncertainty =       0.003520289759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336625915230
                                         uncertainty =       0.003520289759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410212000
  error estimate for blocks of size 2^( 2) =       0.000422935061
  error estimate for blocks of size 2^( 3) =       0.000436862829
  error estimate for blocks of size 2^( 4) =       0.000450274307
  error estimate for blocks of size 2^( 5) =       0.000462304446
  error estimate for blocks of size 2^( 6) =       0.000470662138
  error estimate for blocks of size 2^( 7) =       0.000476453712

      target function =                  N/A
              le_mean =     -16.905711845816
             les_mean =     286.139640616003
             stat err =       0.000464923651
             autocorr =       1.284536816118
              std dev =       0.580127374391
             le_variance =       0.336547770518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336625915341
                                         uncertainty =       0.003520289774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336625915341
                                         uncertainty =       0.003520289774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410212000
  error estimate for blocks of size 2^( 2) =       0.000422935061
  error estimate for blocks of size 2^( 3) =       0.000436862829
  error estimate for blocks of size 2^( 4) =       0.000450274307
  error estimate for blocks of size 2^( 5) =       0.000462304445
  error estimate for blocks of size 2^( 6) =       0.000470662138
  error estimate for blocks of size 2^( 7) =       0.000476453712

      target function =                  N/A
              le_mean =     -16.905711845799
             les_mean =     286.139640615537
             stat err =       0.000464923650
             autocorr =       1.284536815023
              std dev =       0.580127374486
             le_variance =       0.336547770628

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336625915285
                                         uncertainty =       0.003520289766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336625915285
                                         uncertainty =       0.003520289766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410212000
  error estimate for blocks of size 2^( 2) =       0.000422935061
  error estimate for blocks of size 2^( 3) =       0.000436862829
  error estimate for blocks of size 2^( 4) =       0.000450274307
  error estimate for blocks of size 2^( 5) =       0.000462304445
  error estimate for blocks of size 2^( 6) =       0.000470662138
  error estimate for blocks of size 2^( 7) =       0.000476453712

      target function =                  N/A
              le_mean =     -16.905711845807
             les_mean =     286.139640615770
             stat err =       0.000464923650
             autocorr =       1.284536815568
              std dev =       0.580127374438
             le_variance =       0.336547770573

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336625915237
                                         uncertainty =       0.003520289760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336625915237
                                         uncertainty =       0.003520289760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410212000
  error estimate for blocks of size 2^( 2) =       0.000422935061
  error estimate for blocks of size 2^( 3) =       0.000436862829
  error estimate for blocks of size 2^( 4) =       0.000450274307
  error estimate for blocks of size 2^( 5) =       0.000462304446
  error estimate for blocks of size 2^( 6) =       0.000470662138
  error estimate for blocks of size 2^( 7) =       0.000476453712

      target function =                  N/A
              le_mean =     -16.905711845815
             les_mean =     286.139640615974
             stat err =       0.000464923651
             autocorr =       1.284536816049
              std dev =       0.580127374397
             le_variance =       0.336547770525


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905711845816        initial  <--
     3.7253e+04     3.7253e+05             9.1341e-09       -16.905711845799
     1.4901e+05     1.4901e+06             2.2835e-09       -16.905711845807
     5.9605e+05     5.9605e+06             5.7088e-10       -16.905711845815

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6611
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8466
    reference variance = 0.778912
====================================================
  Execution time = 2.0917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3312e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332943791880
                                         uncertainty =       0.002462781895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332943791880
                                         uncertainty =       0.002462781895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408119790
  error estimate for blocks of size 2^( 2) =       0.000421492000
  error estimate for blocks of size 2^( 3) =       0.000435350544
  error estimate for blocks of size 2^( 4) =       0.000449579287
  error estimate for blocks of size 2^( 5) =       0.000462121255
  error estimate for blocks of size 2^( 6) =       0.000472273702
  error estimate for blocks of size 2^( 7) =       0.000480777772

      target function =                  N/A
              le_mean =     -16.906022249384
             les_mean =     286.146711655735
             stat err =       0.000466188004
             autocorr =       1.304808807120
              std dev =       0.577168541784
             le_variance =       0.333123525625


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690602224938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906022249384       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906022249386       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906022249387       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906022249387       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906022249379       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906022249440       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906022248958       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906022249321       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.768349e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906022249384       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906022249385       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906022249385       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906022249385       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906022249307       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906022247833       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906022249651       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906022251338       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.692091e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906022249384       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906022249384       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906022249384       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906022251427       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906022249384       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906022246916       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906022250113       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906022249351       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 4.230221e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.510147 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6412e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9315
    reference variance = 0.323428
====================================================
  Execution time = 2.0266e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3984e-01
  Total weights = 2.0000e+06
  Execution time = 1.8833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736911287
                                         uncertainty =       0.005207553970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736911287
                                         uncertainty =       0.005207553970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412211220
  error estimate for blocks of size 2^( 2) =       0.000425195150
  error estimate for blocks of size 2^( 3) =       0.000438851087
  error estimate for blocks of size 2^( 4) =       0.000452008603
  error estimate for blocks of size 2^( 5) =       0.000464502065
  error estimate for blocks of size 2^( 6) =       0.000474710929
  error estimate for blocks of size 2^( 7) =       0.000481157669

      target function =                  N/A
              le_mean =     -16.906366342301
             les_mean =     286.165058910438
             stat err =       0.000468094816
             autocorr =       1.289519890526
              std dev =       0.582954698300
             le_variance =       0.339836180270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736911368
                                         uncertainty =       0.005207553977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736911368
                                         uncertainty =       0.005207553977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412211220
  error estimate for blocks of size 2^( 2) =       0.000425195150
  error estimate for blocks of size 2^( 3) =       0.000438851087
  error estimate for blocks of size 2^( 4) =       0.000452008603
  error estimate for blocks of size 2^( 5) =       0.000464502065
  error estimate for blocks of size 2^( 6) =       0.000474710929
  error estimate for blocks of size 2^( 7) =       0.000481157669

      target function =                  N/A
              le_mean =     -16.906366342301
             les_mean =     286.165058910511
             stat err =       0.000468094816
             autocorr =       1.289519890409
              std dev =       0.582954698369
             le_variance =       0.339836180351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736911328
                                         uncertainty =       0.005207553973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736911328
                                         uncertainty =       0.005207553973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412211220
  error estimate for blocks of size 2^( 2) =       0.000425195150
  error estimate for blocks of size 2^( 3) =       0.000438851087
  error estimate for blocks of size 2^( 4) =       0.000452008603
  error estimate for blocks of size 2^( 5) =       0.000464502065
  error estimate for blocks of size 2^( 6) =       0.000474710929
  error estimate for blocks of size 2^( 7) =       0.000481157669

      target function =                  N/A
              le_mean =     -16.906366342301
             les_mean =     286.165058910475
             stat err =       0.000468094816
             autocorr =       1.289519890482
              std dev =       0.582954698334
             le_variance =       0.339836180310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736911293
                                         uncertainty =       0.005207553970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339736911293
                                         uncertainty =       0.005207553970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412211220
  error estimate for blocks of size 2^( 2) =       0.000425195150
  error estimate for blocks of size 2^( 3) =       0.000438851087
  error estimate for blocks of size 2^( 4) =       0.000452008603
  error estimate for blocks of size 2^( 5) =       0.000464502065
  error estimate for blocks of size 2^( 6) =       0.000474710929
  error estimate for blocks of size 2^( 7) =       0.000481157669

      target function =                  N/A
              le_mean =     -16.906366342301
             les_mean =     286.165058910443
             stat err =       0.000468094816
             autocorr =       1.289519890529
              std dev =       0.582954698304
             le_variance =       0.339836180275


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906366342301        initial  <--
     3.7253e+05     3.7253e+06             6.7683e-10       -16.906366342301
     1.4901e+06     1.4901e+07             1.6921e-10       -16.906366342301
     5.9605e+06     5.9605e+07             4.2302e-11       -16.906366342301

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7683
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6198e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9692
    reference variance = 0.31559
====================================================
  Execution time = 2.0729e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3791e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5563e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337998351511
                                         uncertainty =       0.004897648487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337998351511
                                         uncertainty =       0.004897648487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411042535
  error estimate for blocks of size 2^( 2) =       0.000424390197
  error estimate for blocks of size 2^( 3) =       0.000438004968
  error estimate for blocks of size 2^( 4) =       0.000451436255
  error estimate for blocks of size 2^( 5) =       0.000463039857
  error estimate for blocks of size 2^( 6) =       0.000471675879
  error estimate for blocks of size 2^( 7) =       0.000478212665

      target function =                  N/A
              le_mean =     -16.907133849045
             les_mean =     286.189086751756
             stat err =       0.000466091164
             autocorr =       1.285784566762
              std dev =       0.581301927727
             le_variance =       0.337911931179


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690713384905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907133849045       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907133849045       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907133849045       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907133849221       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907133848726       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907133848448       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907133847655       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907133849466       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 7.863208e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907133849045       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907133849045       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907133849045       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907133852192       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907133849094       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907133844378       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907133849331       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907133862848       residual = 6.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.965805e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907133849045       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907133849045       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907133849045       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907133854987       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907133856973       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907133832084       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907133869189       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907133861717       residual = 6.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 4.914528e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.512784 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6292e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8707
    reference variance = 0.251957
====================================================
  Execution time = 2.0550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.8705e-01
  Total weights = 2.0000e+06
  Execution time = 1.8850e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387203173433
                                         uncertainty =       0.041989379756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387203173433
                                         uncertainty =       0.041989379756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439915572
  error estimate for blocks of size 2^( 2) =       0.000452256026
  error estimate for blocks of size 2^( 3) =       0.000465572279
  error estimate for blocks of size 2^( 4) =       0.000478191570
  error estimate for blocks of size 2^( 5) =       0.000489613940
  error estimate for blocks of size 2^( 6) =       0.000496979624
  error estimate for blocks of size 2^( 7) =       0.000503586408

      target function =                  N/A
              le_mean =     -16.906593287243
             les_mean =     286.219947806951
             stat err =       0.000492092886
             autocorr =       1.251282880398
              std dev =       0.622134567617
             le_variance =       0.387051420224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387203173432
                                         uncertainty =       0.041989379756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387203173432
                                         uncertainty =       0.041989379756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439915572
  error estimate for blocks of size 2^( 2) =       0.000452256026
  error estimate for blocks of size 2^( 3) =       0.000465572279
  error estimate for blocks of size 2^( 4) =       0.000478191570
  error estimate for blocks of size 2^( 5) =       0.000489613940
  error estimate for blocks of size 2^( 6) =       0.000496979624
  error estimate for blocks of size 2^( 7) =       0.000503586408

      target function =                  N/A
              le_mean =     -16.906593287243
             les_mean =     286.219947806953
             stat err =       0.000492092886
             autocorr =       1.251282880379
              std dev =       0.622134567617
             le_variance =       0.387051420223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387203173433
                                         uncertainty =       0.041989379756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387203173433
                                         uncertainty =       0.041989379756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439915572
  error estimate for blocks of size 2^( 2) =       0.000452256026
  error estimate for blocks of size 2^( 3) =       0.000465572279
  error estimate for blocks of size 2^( 4) =       0.000478191570
  error estimate for blocks of size 2^( 5) =       0.000489613940
  error estimate for blocks of size 2^( 6) =       0.000496979624
  error estimate for blocks of size 2^( 7) =       0.000503586408

      target function =                  N/A
              le_mean =     -16.906593287243
             les_mean =     286.219947806952
             stat err =       0.000492092886
             autocorr =       1.251282880385
              std dev =       0.622134567617
             le_variance =       0.387051420224

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387203173433
                                         uncertainty =       0.041989379756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.387203173433
                                         uncertainty =       0.041989379756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439915572
  error estimate for blocks of size 2^( 2) =       0.000452256026
  error estimate for blocks of size 2^( 3) =       0.000465572279
  error estimate for blocks of size 2^( 4) =       0.000478191570
  error estimate for blocks of size 2^( 5) =       0.000489613940
  error estimate for blocks of size 2^( 6) =       0.000496979624
  error estimate for blocks of size 2^( 7) =       0.000503586408

      target function =                  N/A
              le_mean =     -16.906593287243
             les_mean =     286.219947806951
             stat err =       0.000492092886
             autocorr =       1.251282880393
              std dev =       0.622134567617
             le_variance =       0.387051420224


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906593287243        initial
     3.7253e+06     3.7253e+07             7.8632e-11       -16.906593287243  <--
     1.4901e+07     1.4901e+08             1.9658e-11       -16.906593287243
     5.9605e+07     5.9605e+08             4.9145e-12       -16.906593287243

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 3.0064e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6372e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9734
    reference variance = 0.324662
====================================================
  Execution time = 2.0780e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3768e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337781434123
                                         uncertainty =       0.004245158613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337781434123
                                         uncertainty =       0.004245158613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410901415
  error estimate for blocks of size 2^( 2) =       0.000423866896
  error estimate for blocks of size 2^( 3) =       0.000437768495
  error estimate for blocks of size 2^( 4) =       0.000451510656
  error estimate for blocks of size 2^( 5) =       0.000463066424
  error estimate for blocks of size 2^( 6) =       0.000473137492
  error estimate for blocks of size 2^( 7) =       0.000479313667

      target function =                  N/A
              le_mean =     -16.907368860298
             les_mean =     286.196801555630
             stat err =       0.000466757060
             autocorr =       1.290346999751
              std dev =       0.581102354403
             le_variance =       0.337679946293


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690736886030e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907368860298       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907368860299       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907368860298       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907368860298       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907368860182       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907368860295       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907368860522       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907368860427       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 3.491779e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907368860298       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907368860298       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907368860298       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907368861834       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907368860169       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907368861357       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907368857701       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907368860317       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 8.729446e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907368860298       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907368860298       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907368860298       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907368867021       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907368860298       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907368868346       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907368858396       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907368853338       residual = 6.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 2.182348e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.515419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6299e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8542
    reference variance = 0.219065
====================================================
  Execution time = 2.0326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2949e-01
  Total weights = 2.0000e+06
  Execution time = 1.8859e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329441126889
                                         uncertainty =       0.002630993977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329441126889
                                         uncertainty =       0.002630993977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405886034
  error estimate for blocks of size 2^( 2) =       0.000418591520
  error estimate for blocks of size 2^( 3) =       0.000431974534
  error estimate for blocks of size 2^( 4) =       0.000444203473
  error estimate for blocks of size 2^( 5) =       0.000455726970
  error estimate for blocks of size 2^( 6) =       0.000463811666
  error estimate for blocks of size 2^( 7) =       0.000471289562

      target function =                  N/A
              le_mean =     -16.906363839516
             les_mean =     286.154625054957
             stat err =       0.000458757918
             autocorr =       1.277494175567
              std dev =       0.574009534415
             le_variance =       0.329486945600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329441126857
                                         uncertainty =       0.002630993977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329441126857
                                         uncertainty =       0.002630993977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405886034
  error estimate for blocks of size 2^( 2) =       0.000418591520
  error estimate for blocks of size 2^( 3) =       0.000431974534
  error estimate for blocks of size 2^( 4) =       0.000444203473
  error estimate for blocks of size 2^( 5) =       0.000455726970
  error estimate for blocks of size 2^( 6) =       0.000463811666
  error estimate for blocks of size 2^( 7) =       0.000471289561

      target function =                  N/A
              le_mean =     -16.906363839516
             les_mean =     286.154625054921
             stat err =       0.000458757918
             autocorr =       1.277494175582
              std dev =       0.574009534388
             le_variance =       0.329486945568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329441126873
                                         uncertainty =       0.002630993977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329441126873
                                         uncertainty =       0.002630993977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405886034
  error estimate for blocks of size 2^( 2) =       0.000418591520
  error estimate for blocks of size 2^( 3) =       0.000431974534
  error estimate for blocks of size 2^( 4) =       0.000444203473
  error estimate for blocks of size 2^( 5) =       0.000455726970
  error estimate for blocks of size 2^( 6) =       0.000463811666
  error estimate for blocks of size 2^( 7) =       0.000471289562

      target function =                  N/A
              le_mean =     -16.906363839516
             les_mean =     286.154625054939
             stat err =       0.000458757918
             autocorr =       1.277494175574
              std dev =       0.574009534402
             le_variance =       0.329486945584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329441126887
                                         uncertainty =       0.002630993977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329441126887
                                         uncertainty =       0.002630993977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405886034
  error estimate for blocks of size 2^( 2) =       0.000418591520
  error estimate for blocks of size 2^( 3) =       0.000431974534
  error estimate for blocks of size 2^( 4) =       0.000444203473
  error estimate for blocks of size 2^( 5) =       0.000455726970
  error estimate for blocks of size 2^( 6) =       0.000463811666
  error estimate for blocks of size 2^( 7) =       0.000471289562

      target function =                  N/A
              le_mean =     -16.906363839516
             les_mean =     286.154625054955
             stat err =       0.000458757918
             autocorr =       1.277494175580
              std dev =       0.574009534414
             le_variance =       0.329486945598


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906363839516        initial  <--
     9.3132e+05     9.3132e+06             3.4918e-10       -16.906363839516
     3.7253e+06     3.7253e+07             8.7294e-11       -16.906363839516
     1.4901e+07     1.4901e+08             2.1823e-11       -16.906363839516

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8323
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6136e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8693
    reference variance = 0.327187
====================================================
  Execution time = 2.0592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4756e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347575801535
                                         uncertainty =       0.010203522368

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347575801535
                                         uncertainty =       0.010203522368

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416871769
  error estimate for blocks of size 2^( 2) =       0.000429466039
  error estimate for blocks of size 2^( 3) =       0.000442213265
  error estimate for blocks of size 2^( 4) =       0.000455449309
  error estimate for blocks of size 2^( 5) =       0.000467218996
  error estimate for blocks of size 2^( 6) =       0.000474446720
  error estimate for blocks of size 2^( 7) =       0.000479415676

      target function =                  N/A
              le_mean =     -16.905890368711
             les_mean =     286.156693128775
             stat err =       0.000469132675
             autocorr =       1.266445178580
              std dev =       0.589545709587
             le_variance =       0.347564143693


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589036871e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905890368711       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905890368711       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905890368711       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890372205       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890368622       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905890365240       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905890365159       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905890366750       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 3.037042e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905890368711       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905890368711       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905890368711       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890368711       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890384507       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905890376891       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905890369685       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905890291999       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 7.592528e-12

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905890368711       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905890368711       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905890368711       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905890381980       residual = 7.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905890373193       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905890358414       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905890443849       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905890452162       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 1.898087e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.518020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6096e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9416
    reference variance = 0.189702
====================================================
  Execution time = 2.0613e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3670e-01
  Total weights = 2.0000e+06
  Execution time = 1.8766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336766333059
                                         uncertainty =       0.003372804254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336766333059
                                         uncertainty =       0.003372804254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410306320
  error estimate for blocks of size 2^( 2) =       0.000422737990
  error estimate for blocks of size 2^( 3) =       0.000436114277
  error estimate for blocks of size 2^( 4) =       0.000449158779
  error estimate for blocks of size 2^( 5) =       0.000460104137
  error estimate for blocks of size 2^( 6) =       0.000467384976
  error estimate for blocks of size 2^( 7) =       0.000471054465

      target function =                  N/A
              le_mean =     -16.906081551395
             les_mean =     286.152295807285
             stat err =       0.000461925589
             autocorr =       1.267440642424
              std dev =       0.580260763107
             le_variance =       0.336702553202

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336766333064
                                         uncertainty =       0.003372804254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336766333064
                                         uncertainty =       0.003372804254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410306320
  error estimate for blocks of size 2^( 2) =       0.000422737990
  error estimate for blocks of size 2^( 3) =       0.000436114277
  error estimate for blocks of size 2^( 4) =       0.000449158779
  error estimate for blocks of size 2^( 5) =       0.000460104137
  error estimate for blocks of size 2^( 6) =       0.000467384976
  error estimate for blocks of size 2^( 7) =       0.000471054465

      target function =                  N/A
              le_mean =     -16.906081551395
             les_mean =     286.152295807286
             stat err =       0.000461925589
             autocorr =       1.267440642418
              std dev =       0.580260763112
             le_variance =       0.336702553207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336766333062
                                         uncertainty =       0.003372804254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336766333062
                                         uncertainty =       0.003372804254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410306320
  error estimate for blocks of size 2^( 2) =       0.000422737990
  error estimate for blocks of size 2^( 3) =       0.000436114277
  error estimate for blocks of size 2^( 4) =       0.000449158779
  error estimate for blocks of size 2^( 5) =       0.000460104137
  error estimate for blocks of size 2^( 6) =       0.000467384976
  error estimate for blocks of size 2^( 7) =       0.000471054465

      target function =                  N/A
              le_mean =     -16.906081551395
             les_mean =     286.152295807285
             stat err =       0.000461925589
             autocorr =       1.267440642420
              std dev =       0.580260763110
             le_variance =       0.336702553205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336766333059
                                         uncertainty =       0.003372804254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336766333059
                                         uncertainty =       0.003372804254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410306320
  error estimate for blocks of size 2^( 2) =       0.000422737990
  error estimate for blocks of size 2^( 3) =       0.000436114277
  error estimate for blocks of size 2^( 4) =       0.000449158779
  error estimate for blocks of size 2^( 5) =       0.000460104137
  error estimate for blocks of size 2^( 6) =       0.000467384976
  error estimate for blocks of size 2^( 7) =       0.000471054465

      target function =                  N/A
              le_mean =     -16.906081551395
             les_mean =     286.152295807285
             stat err =       0.000461925589
             autocorr =       1.267440642425
              std dev =       0.580260763108
             le_variance =       0.336702553202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906081551395        initial  <--
     9.3132e+06     9.3132e+07             3.0370e-11       -16.906081551395
     3.7253e+07     3.7253e+08             7.5925e-12       -16.906081551395
     1.4901e+08     1.4901e+09             1.8981e-12       -16.906081551395

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0892
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6190e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6900e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9212
    reference variance = 0.247998
====================================================
  Execution time = 2.0739e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4273e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342852002482
                                         uncertainty =       0.004414566397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342852002482
                                         uncertainty =       0.004414566397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413962639
  error estimate for blocks of size 2^( 2) =       0.000427039120
  error estimate for blocks of size 2^( 3) =       0.000440475081
  error estimate for blocks of size 2^( 4) =       0.000453589709
  error estimate for blocks of size 2^( 5) =       0.000464601374
  error estimate for blocks of size 2^( 6) =       0.000473596778
  error estimate for blocks of size 2^( 7) =       0.000478566276

      target function =                  N/A
              le_mean =     -16.906970265572
             les_mean =     286.188373523208
             stat err =       0.000467588534
             autocorr =       1.275867019817
              std dev =       0.585431578943
             le_variance =       0.342730133624


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690697026557e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906970265572       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906970265572       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906970265572       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906970231676       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906970299574       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906970269765       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906970268246       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906970282611       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 4.337513e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906970265572       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906970265572       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906970265572       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906970174051       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906969981189       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906970200947       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906970141948       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906969585948       residual = 7.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.084250e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906970265572       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906970265572       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906970265572       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906970070065       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906970252545       residual = 5.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906970182532       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906969375481       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906971796787       residual = 7.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 2.717723e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.520614 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6265e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9322
    reference variance = 0.286199
====================================================
  Execution time = 2.0249e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5608e-01
  Total weights = 2.0000e+06
  Execution time = 1.8780e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356159598039
                                         uncertainty =       0.013044248346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356159598039
                                         uncertainty =       0.013044248346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421947560
  error estimate for blocks of size 2^( 2) =       0.000434427892
  error estimate for blocks of size 2^( 3) =       0.000447897279
  error estimate for blocks of size 2^( 4) =       0.000461234334
  error estimate for blocks of size 2^( 5) =       0.000473229583
  error estimate for blocks of size 2^( 6) =       0.000482490592
  error estimate for blocks of size 2^( 7) =       0.000488566147

      target function =                  N/A
              le_mean =     -16.906887347478
             les_mean =     286.198919088237
             stat err =       0.000476380164
             autocorr =       1.274648327741
              std dev =       0.596723961285
             le_variance =       0.356079485971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356159598039
                                         uncertainty =       0.013044248346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356159598039
                                         uncertainty =       0.013044248346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421947560
  error estimate for blocks of size 2^( 2) =       0.000434427892
  error estimate for blocks of size 2^( 3) =       0.000447897279
  error estimate for blocks of size 2^( 4) =       0.000461234334
  error estimate for blocks of size 2^( 5) =       0.000473229583
  error estimate for blocks of size 2^( 6) =       0.000482490592
  error estimate for blocks of size 2^( 7) =       0.000488566147

      target function =                  N/A
              le_mean =     -16.906887347478
             les_mean =     286.198919088237
             stat err =       0.000476380164
             autocorr =       1.274648327744
              std dev =       0.596723961284
             le_variance =       0.356079485971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356159598039
                                         uncertainty =       0.013044248346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356159598039
                                         uncertainty =       0.013044248346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421947560
  error estimate for blocks of size 2^( 2) =       0.000434427892
  error estimate for blocks of size 2^( 3) =       0.000447897279
  error estimate for blocks of size 2^( 4) =       0.000461234334
  error estimate for blocks of size 2^( 5) =       0.000473229583
  error estimate for blocks of size 2^( 6) =       0.000482490592
  error estimate for blocks of size 2^( 7) =       0.000488566147

      target function =                  N/A
              le_mean =     -16.906887347478
             les_mean =     286.198919088237
             stat err =       0.000476380164
             autocorr =       1.274648327743
              std dev =       0.596723961285
             le_variance =       0.356079485971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356159598039
                                         uncertainty =       0.013044248346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356159598039
                                         uncertainty =       0.013044248346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421947560
  error estimate for blocks of size 2^( 2) =       0.000434427892
  error estimate for blocks of size 2^( 3) =       0.000447897279
  error estimate for blocks of size 2^( 4) =       0.000461234334
  error estimate for blocks of size 2^( 5) =       0.000473229583
  error estimate for blocks of size 2^( 6) =       0.000482490592
  error estimate for blocks of size 2^( 7) =       0.000488566147

      target function =                  N/A
              le_mean =     -16.906887347478
             les_mean =     286.198919088237
             stat err =       0.000476380164
             autocorr =       1.274648327737
              std dev =       0.596723961285
             le_variance =       0.356079485971


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906887347478        initial  <--
     9.3132e+07     9.3132e+08             4.3375e-12       -16.906887347478
     3.7253e+08     3.7253e+09             1.0842e-12       -16.906887347478
     1.4901e+09     1.4901e+10             2.7177e-13       -16.906887347478

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7314
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6001e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8737
    reference variance = 0.359838
====================================================
  Execution time = 2.2824e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4343e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343459301085
                                         uncertainty =       0.007132600296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343459301085
                                         uncertainty =       0.007132600296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414382226
  error estimate for blocks of size 2^( 2) =       0.000427434691
  error estimate for blocks of size 2^( 3) =       0.000441421203
  error estimate for blocks of size 2^( 4) =       0.000454048619
  error estimate for blocks of size 2^( 5) =       0.000465832473
  error estimate for blocks of size 2^( 6) =       0.000474277657
  error estimate for blocks of size 2^( 7) =       0.000481539707

      target function =                  N/A
              le_mean =     -16.906082801459
             les_mean =     286.159060776281
             stat err =       0.000468924614
             autocorr =       1.280571469269
              std dev =       0.586024963803
             le_variance =       0.343425258201


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690608280146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+08, overlap shift 9.3132e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906082801459       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906082801459       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906082801459       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906082955149       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906082374034       residual = 5.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906083390201       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906082577628       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906083192559       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+08 is 3.275622e-13

solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906082801459       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906082801459       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906082801459       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906082801459       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906082801459       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906080941075       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906081131342       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906080114000       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 8.158461e-14

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906082801459       residual = 6.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906082801459       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906082801459       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906083239208       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906081292636       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906092198342       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906087356635       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906078888970       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+10 is 2.068529e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.523210 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8380e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8036
    reference variance = 0.338282
====================================================
  Execution time = 2.0581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3819e-01
  Total weights = 2.0000e+06
  Execution time = 1.8906e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338080145469
                                         uncertainty =       0.004570787053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338080145469
                                         uncertainty =       0.004570787053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411214449
  error estimate for blocks of size 2^( 2) =       0.000424537136
  error estimate for blocks of size 2^( 3) =       0.000438655604
  error estimate for blocks of size 2^( 4) =       0.000451329489
  error estimate for blocks of size 2^( 5) =       0.000464468841
  error estimate for blocks of size 2^( 6) =       0.000475373043
  error estimate for blocks of size 2^( 7) =       0.000480439050

      target function =                  N/A
              le_mean =     -16.906182675510
             les_mean =     286.157207134722
             stat err =       0.000467902606
             autocorr =       1.294715047344
              std dev =       0.581545050791
             le_variance =       0.338194646100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338080145469
                                         uncertainty =       0.004570787053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338080145469
                                         uncertainty =       0.004570787053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411214449
  error estimate for blocks of size 2^( 2) =       0.000424537136
  error estimate for blocks of size 2^( 3) =       0.000438655604
  error estimate for blocks of size 2^( 4) =       0.000451329489
  error estimate for blocks of size 2^( 5) =       0.000464468841
  error estimate for blocks of size 2^( 6) =       0.000475373043
  error estimate for blocks of size 2^( 7) =       0.000480439050

      target function =                  N/A
              le_mean =     -16.906182675510
             les_mean =     286.157207134722
             stat err =       0.000467902606
             autocorr =       1.294715047345
              std dev =       0.581545050791
             le_variance =       0.338194646100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338080145469
                                         uncertainty =       0.004570787053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338080145469
                                         uncertainty =       0.004570787053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411214449
  error estimate for blocks of size 2^( 2) =       0.000424537136
  error estimate for blocks of size 2^( 3) =       0.000438655604
  error estimate for blocks of size 2^( 4) =       0.000451329489
  error estimate for blocks of size 2^( 5) =       0.000464468841
  error estimate for blocks of size 2^( 6) =       0.000475373043
  error estimate for blocks of size 2^( 7) =       0.000480439050

      target function =                  N/A
              le_mean =     -16.906182675510
             les_mean =     286.157207134722
             stat err =       0.000467902606
             autocorr =       1.294715047344
              std dev =       0.581545050791
             le_variance =       0.338194646100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338080145469
                                         uncertainty =       0.004570787053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338080145469
                                         uncertainty =       0.004570787053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411214449
  error estimate for blocks of size 2^( 2) =       0.000424537136
  error estimate for blocks of size 2^( 3) =       0.000438655604
  error estimate for blocks of size 2^( 4) =       0.000451329489
  error estimate for blocks of size 2^( 5) =       0.000464468841
  error estimate for blocks of size 2^( 6) =       0.000475373043
  error estimate for blocks of size 2^( 7) =       0.000480439050

      target function =                  N/A
              le_mean =     -16.906182675510
             les_mean =     286.157207134722
             stat err =       0.000467902606
             autocorr =       1.294715047347
              std dev =       0.581545050791
             le_variance =       0.338194646100


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906182675510        initial  <--
     9.3132e+08     9.3132e+09             3.2756e-13       -16.906182675510
     3.7253e+09     3.7253e+10             8.1585e-14       -16.906182675510
     1.4901e+10     1.4901e+11             2.0685e-14       -16.906182675510

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0631
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8448e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9429
    reference variance = 0.200769
====================================================
  Execution time = 2.0647e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3643e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5110e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336429946742
                                         uncertainty =       0.003496394535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336429946742
                                         uncertainty =       0.003496394535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410139667
  error estimate for blocks of size 2^( 2) =       0.000422839259
  error estimate for blocks of size 2^( 3) =       0.000435840780
  error estimate for blocks of size 2^( 4) =       0.000449232022
  error estimate for blocks of size 2^( 5) =       0.000460395359
  error estimate for blocks of size 2^( 6) =       0.000468571381
  error estimate for blocks of size 2^( 7) =       0.000472488383

      target function =                  N/A
              le_mean =     -16.906822722827
             les_mean =     286.177083506586
             stat err =       0.000462671786
             autocorr =       1.272572352937
              std dev =       0.580025080229
             le_variance =       0.336429093694


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690682272283e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+09, overlap shift 9.3132e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906822722827       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906822722827       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906822722827       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906822464848       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906821473609       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906824208875       residual = 7.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906815445590       residual = 3.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906857173835       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906835533709       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906805178178       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906871278584       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906880937850       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906807916279       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906882354334       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906840990818       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906886671184       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.907001359202       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906635276353       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906740540203       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.907109008587       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907141236242       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906941051655       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.906728352264       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907499309511       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.905919482281       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.906738559743       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.906957500431       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.906286056329       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.906828352458       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906492471146       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.906754394112       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.906664853694       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.904672662495       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.906074249301       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.906390074720       residual = 2.40e-05           smallest_sin_value = 9.99e-01
davidson iteration   35:   krylov dim =  36   energy =     -16.907891607580       residual = 1.62e-04           smallest_sin_value = 9.96e-01
davidson iteration   36 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+09 is 3.224643e-14

solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906822722827       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906822722827       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906822722827       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906822722827       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906822374700       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906815168099       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906821217807       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906813857424       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906837820212       residual = 4.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906800363159       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906895333525       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907244055040       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906929334502       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906188076837       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906757130799       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906560142512       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906452708685       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906817621251       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.905850971295       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.909237896781       residual = 7.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.904048446082       residual = 9.28e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906129358416       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.907941425462       residual = 1.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.907904079317       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903765260116       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.910467082100       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.909186583444       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.898985887320       residual = 7.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.910130997144       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.906063029336       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.902520937698       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.902863433652       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.909253755468       residual = 7.10e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   energy =     -16.910007769117       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   energy =     -16.902995474724       residual = 2.58e-03           smallest_sin_value = 9.98e-01
davidson iteration   35:   krylov dim =  36   energy =     -16.904573075739       residual = 2.10e-03           smallest_sin_value = 9.90e-01
davidson iteration   36 stopping due to small subspace S singular value of 9.81e-01
davidson solver did not converge after         36 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 8.197168e-15

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906822722827       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906822722827       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906822722827       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906877507659       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906822722827       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906746118557       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907100731944       residual = 9.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906524830616       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909687428427       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907071907437       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907115937930       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907185295690       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.903399751821       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.901572160058       residual = 3.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.905584735284       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.898958241416       residual = 7.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.902904111374       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909946479970       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.924084003767       residual = 3.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.921121594662       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.908850680756       residual = 7.77e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.903421989503       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.912800543814       residual = 5.08e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.901986235043       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.903447029673       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.902740172078       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.899198351345       residual = 8.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.903619534792       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.895639966560       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.884196422983       residual = 6.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.897401056764       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.932377197785       residual = 8.72e-02           smallest_sin_value = 9.99e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.89e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+11 is 1.480754e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.610730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6250e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8617
    reference variance = 0.307893
====================================================
  Execution time = 2.0677e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3290e-01
  Total weights = 2.0000e+06
  Execution time = 1.8789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332920390821
                                         uncertainty =       0.003071865218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332920390821
                                         uncertainty =       0.003071865218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407980808
  error estimate for blocks of size 2^( 2) =       0.000421100525
  error estimate for blocks of size 2^( 3) =       0.000434456126
  error estimate for blocks of size 2^( 4) =       0.000447101093
  error estimate for blocks of size 2^( 5) =       0.000460789461
  error estimate for blocks of size 2^( 6) =       0.000471912781
  error estimate for blocks of size 2^( 7) =       0.000476349502

      target function =                  N/A
              le_mean =     -16.906120956598
             les_mean =     286.149822312123
             stat err =       0.000464038209
             autocorr =       1.293683432504
              std dev =       0.576971991899
             le_variance =       0.332896679436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332920390821
                                         uncertainty =       0.003071865218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332920390821
                                         uncertainty =       0.003071865218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407980808
  error estimate for blocks of size 2^( 2) =       0.000421100525
  error estimate for blocks of size 2^( 3) =       0.000434456126
  error estimate for blocks of size 2^( 4) =       0.000447101093
  error estimate for blocks of size 2^( 5) =       0.000460789461
  error estimate for blocks of size 2^( 6) =       0.000471912781
  error estimate for blocks of size 2^( 7) =       0.000476349502

      target function =                  N/A
              le_mean =     -16.906120956598
             les_mean =     286.149822312123
             stat err =       0.000464038209
             autocorr =       1.293683432510
              std dev =       0.576971991899
             le_variance =       0.332896679436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332920390821
                                         uncertainty =       0.003071865218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332920390821
                                         uncertainty =       0.003071865218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407980808
  error estimate for blocks of size 2^( 2) =       0.000421100525
  error estimate for blocks of size 2^( 3) =       0.000434456126
  error estimate for blocks of size 2^( 4) =       0.000447101093
  error estimate for blocks of size 2^( 5) =       0.000460789461
  error estimate for blocks of size 2^( 6) =       0.000471912781
  error estimate for blocks of size 2^( 7) =       0.000476349502

      target function =                  N/A
              le_mean =     -16.906120956598
             les_mean =     286.149822312123
             stat err =       0.000464038209
             autocorr =       1.293683432508
              std dev =       0.576971991899
             le_variance =       0.332896679436

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332920390821
                                         uncertainty =       0.003071865218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332920390821
                                         uncertainty =       0.003071865218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407980808
  error estimate for blocks of size 2^( 2) =       0.000421100525
  error estimate for blocks of size 2^( 3) =       0.000434456126
  error estimate for blocks of size 2^( 4) =       0.000447101093
  error estimate for blocks of size 2^( 5) =       0.000460789461
  error estimate for blocks of size 2^( 6) =       0.000471912781
  error estimate for blocks of size 2^( 7) =       0.000476349502

      target function =                  N/A
              le_mean =     -16.906120956598
             les_mean =     286.149822312123
             stat err =       0.000464038209
             autocorr =       1.293683432505
              std dev =       0.576971991899
             le_variance =       0.332896679436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906120956598        initial
     9.3132e+09     9.3132e+10             3.2246e-14       -16.906120956598
     3.7253e+10     3.7253e+11             8.1972e-15       -16.906120956598
     1.4901e+11     1.4901e+12             1.4808e-15       -16.906120956598  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e+11     and shift_s =   1.4901e+12
*****************************************************************************

  Execution time = 3.0218e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6473e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8796
    reference variance = 0.251988
====================================================
  Execution time = 2.1257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6908e+01
  VMC Evar = 3.3454e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5254e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334582637617
                                         uncertainty =       0.002894669644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334582637617
                                         uncertainty =       0.002894669644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408986254
  error estimate for blocks of size 2^( 2) =       0.000421867737
  error estimate for blocks of size 2^( 3) =       0.000434740563
  error estimate for blocks of size 2^( 4) =       0.000447303621
  error estimate for blocks of size 2^( 5) =       0.000456806315
  error estimate for blocks of size 2^( 6) =       0.000464312865
  error estimate for blocks of size 2^( 7) =       0.000469871876

      target function =                  N/A
              le_mean =     -16.907680846212
             les_mean =     286.204210941643
             stat err =       0.000459573669
             autocorr =       1.262678698150
              std dev =       0.578393906900
             le_variance =       0.334539511539


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690768084621e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907680846212       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907680846212       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907680846212       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907703818202       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907677583110       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907686071514       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907704886033       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907685494877       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907692355257       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907666104704       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907808527733       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.907620535619       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.907474218786       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.907568330121       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.907751948407       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907884049073       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.900764099763       residual = 5.90e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.902887448137       residual = 2.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.907161075674       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.908086987822       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.907908632649       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.906246490225       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.910099572543       residual = 7.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.908833868441       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.904606010313       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.904047252633       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.907059214133       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.911245121186       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.909949296747       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.911967683470       residual = 2.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.910915762265       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.910730436360       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.906406898589       residual = 4.39e-04           smallest_sin_value = 9.98e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.884603358385       residual = 7.18e-02           smallest_sin_value = 9.98e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.82e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 8.168896e-15

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907680846212       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907680846212       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907680846212       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907462076285       residual = 5.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907673800960       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907660801536       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907300307559       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907798852430       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907653560147       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.907780449473       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.907725946132       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.909601783659       residual = 5.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905905180339       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.908762102390       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.912427309260       residual = 3.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.921775139565       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.909381159403       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.904727776952       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.902456884060       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.899209874683       residual = 9.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.914792961808       residual = 6.83e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.902920691132       residual = 3.18e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.912164869186       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.891539910399       residual = 3.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.923900486378       residual = 3.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.909619822251       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.891339070813       residual = 3.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.928650314345       residual = 7.35e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.900509802037       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.914812276900       residual = 6.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.917521900831       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.885124041032       residual = 6.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   energy =     -16.899970114672       residual = 1.05e-02           smallest_sin_value = 9.99e-01
davidson iteration   33:   krylov dim =  34   energy =     -16.931598905367       residual = 7.39e-02           smallest_sin_value = 9.90e-01
davidson iteration   34 stopping due to small subspace S singular value of 9.08e-01
davidson solver did not converge after         34 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+11 is 1.861582e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907680846212       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907680846212       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907680846212       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907564485985       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.908777543133       residual = 1.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907143875016       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911593617903       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909117166590       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.914021349785       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905415340803       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.918753132003       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.913273448514       residual = 4.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.919413941929       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911633287691       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.901362796781       residual = 5.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.908357948710       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.918711566997       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.907596300147       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.926680131695       residual = 4.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.914527351682       residual = 8.01e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.863918127075       residual = 2.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.984380947700       residual = 7.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.875618787210       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.935986794124       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.944950877625       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.955632060762       residual = 3.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.943442630419       residual = 1.78e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.933399451506       residual = 9.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.962142866514       residual = 4.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.841531249367       residual = 5.53e-01           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.834453092108       residual = 7.47e-01           smallest_sin_value = 9.94e-01
davidson iteration   31:   krylov dim =  32   energy =     -17.004691949449       residual = 1.50e+00           smallest_sin_value = 9.94e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.38e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+11 is 2.271683e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.658941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6834e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9201
    reference variance = 0.241349
====================================================
  Execution time = 2.0481e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.2961e-01
  Total weights = 2.0000e+06
  Execution time = 1.8823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329637538302
                                         uncertainty =       0.002427111526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329637538302
                                         uncertainty =       0.002427111526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405963231
  error estimate for blocks of size 2^( 2) =       0.000419011482
  error estimate for blocks of size 2^( 3) =       0.000432347648
  error estimate for blocks of size 2^( 4) =       0.000445780822
  error estimate for blocks of size 2^( 5) =       0.000458840110
  error estimate for blocks of size 2^( 6) =       0.000468396347
  error estimate for blocks of size 2^( 7) =       0.000474644676

      target function =                  N/A
              le_mean =     -16.906501563106
             les_mean =     286.159407228208
             stat err =       0.000461915489
             autocorr =       1.294647836164
              std dev =       0.574118706974
             le_variance =       0.329612289697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329637538302
                                         uncertainty =       0.002427111526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329637538302
                                         uncertainty =       0.002427111526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405963231
  error estimate for blocks of size 2^( 2) =       0.000419011482
  error estimate for blocks of size 2^( 3) =       0.000432347648
  error estimate for blocks of size 2^( 4) =       0.000445780822
  error estimate for blocks of size 2^( 5) =       0.000458840110
  error estimate for blocks of size 2^( 6) =       0.000468396347
  error estimate for blocks of size 2^( 7) =       0.000474644676

      target function =                  N/A
              le_mean =     -16.906501563106
             les_mean =     286.159407228208
             stat err =       0.000461915489
             autocorr =       1.294647836165
              std dev =       0.574118706974
             le_variance =       0.329612289697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329637538302
                                         uncertainty =       0.002427111526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329637538302
                                         uncertainty =       0.002427111526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405963231
  error estimate for blocks of size 2^( 2) =       0.000419011482
  error estimate for blocks of size 2^( 3) =       0.000432347648
  error estimate for blocks of size 2^( 4) =       0.000445780822
  error estimate for blocks of size 2^( 5) =       0.000458840110
  error estimate for blocks of size 2^( 6) =       0.000468396347
  error estimate for blocks of size 2^( 7) =       0.000474644676

      target function =                  N/A
              le_mean =     -16.906501563106
             les_mean =     286.159407228208
             stat err =       0.000461915489
             autocorr =       1.294647836165
              std dev =       0.574118706974
             le_variance =       0.329612289697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329637538302
                                         uncertainty =       0.002427111526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329637538302
                                         uncertainty =       0.002427111526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405963231
  error estimate for blocks of size 2^( 2) =       0.000419011482
  error estimate for blocks of size 2^( 3) =       0.000432347648
  error estimate for blocks of size 2^( 4) =       0.000445780822
  error estimate for blocks of size 2^( 5) =       0.000458840110
  error estimate for blocks of size 2^( 6) =       0.000468396347
  error estimate for blocks of size 2^( 7) =       0.000474644676

      target function =                  N/A
              le_mean =     -16.906501563106
             les_mean =     286.159407228208
             stat err =       0.000461915489
             autocorr =       1.294647836164
              std dev =       0.574118706974
             le_variance =       0.329612289697


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906501563106        initial  <--
     3.7253e+10     3.7253e+11             8.1689e-15       -16.906501563106
     1.4901e+11     1.4901e+12             1.8616e-15       -16.906501563106
     5.9605e+11     5.9605e+12             2.2717e-16       -16.906501563106

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9654
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6805e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6899e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.873
    reference variance = 0.24947
====================================================
  Execution time = 2.0477e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4653e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346510260052
                                         uncertainty =       0.009469916790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346510260052
                                         uncertainty =       0.009469916790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416252190
  error estimate for blocks of size 2^( 2) =       0.000429424188
  error estimate for blocks of size 2^( 3) =       0.000443044262
  error estimate for blocks of size 2^( 4) =       0.000455872676
  error estimate for blocks of size 2^( 5) =       0.000467935955
  error estimate for blocks of size 2^( 6) =       0.000479431430
  error estimate for blocks of size 2^( 7) =       0.000487497109

      target function =                  N/A
              le_mean =     -16.905534581131
             les_mean =     286.143631071197
             stat err =       0.000472684292
             autocorr =       1.289523554549
              std dev =       0.588669491867
             le_variance =       0.346531770655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553458113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905534581131       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905534581131       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905534581131       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905534581131       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905571754224       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905546918433       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905222892121       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905639927144       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.902883772096       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909659710739       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.900053007291       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.904312940675       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.904436810961       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.891296641137       residual = 2.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.908886968485       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.907757440291       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.913980718300       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.890349643692       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.911294774207       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.892972519420       residual = 2.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.884542378800       residual = 5.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.911197910975       residual = 4.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.920800138303       residual = 2.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.924382552783       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.951167292251       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.909908887787       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.889532400905       residual = 3.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.903067219476       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.918319077820       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.916127533653       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -16.946171047125       residual = 2.49e-01           smallest_sin_value = 9.99e-01
davidson iteration   31:   krylov dim =  32   energy =     -16.884158578136       residual = 6.84e-02           smallest_sin_value = 9.95e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.53e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 8.699197e-16

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905534581131       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905534581131       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905534581131       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905534581131       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.904762987240       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905581684595       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906667294444       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.898829286917       residual = 5.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907749640134       residual = 8.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906351006319       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.903256455467       residual = 7.85e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.953115938912       residual = 2.97e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.921751594473       residual = 3.40e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.902608814799       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.961538282450       residual = 3.89e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.904895377073       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.879932087409       residual = 8.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.867624146864       residual = 1.80e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.851396303679       residual = 3.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.892244718710       residual = 3.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.962719209764       residual = 4.18e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -17.108133847646       residual = 5.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.914022775148       residual = 9.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.982564679156       residual = 7.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -17.034875177672       residual = 2.26e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.817288294592       residual = 1.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.034495513532       residual = 2.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.970905569623       residual = 6.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -17.031385228671       residual = 2.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.674855599222       residual = 7.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   energy =     -17.006783794251       residual = 1.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   energy =     -16.677056389773       residual = 6.89e+00           smallest_sin_value = 9.97e-01
davidson iteration   32 stopping due to small subspace S singular value of 9.39e-01
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+12 is 1.340586e-16

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905534581131       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905534581131       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905534581131       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907484964155       residual = 4.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907082949933       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.928995718828       residual = 5.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.887608502400       residual = 4.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.888503707681       residual = 4.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.890499042957       residual = 4.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.867870402779       residual = 1.83e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.827994292276       residual = 7.00e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.866148009289       residual = 1.77e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.907396541194       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -17.086993549926       residual = 4.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -17.033589271377       residual = 2.06e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.440667382093       residual = 2.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.595455393002       residual = 1.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.227537024583       residual = 6.12e+01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.892479768751       residual = 3.63e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -15.787591797637       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.450709004380       residual = 2.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -15.795499610810       residual = 1.66e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.826460943967       residual = 1.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.657725329370       residual = 8.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.977160715223       residual = 7.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -17.069420482025       residual = 3.34e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -17.160439158664       residual = 1.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.884370115217       residual = 2.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.288824254614       residual = 4.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.971552270558       residual = 6.70e-01           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -15.559183894672       residual = 2.38e+02           smallest_sin_value = 9.95e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.57e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+12 is 2.306319e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.699941 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6110e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.904
    reference variance = 0.180987
====================================================
  Execution time = 2.0601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3847e-01
  Total weights = 2.0000e+06
  Execution time = 1.8807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338240645422
                                         uncertainty =       0.003723331139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338240645422
                                         uncertainty =       0.003723331139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411384214
  error estimate for blocks of size 2^( 2) =       0.000424434177
  error estimate for blocks of size 2^( 3) =       0.000437952586
  error estimate for blocks of size 2^( 4) =       0.000450983594
  error estimate for blocks of size 2^( 5) =       0.000462703188
  error estimate for blocks of size 2^( 6) =       0.000471136634
  error estimate for blocks of size 2^( 7) =       0.000477031096

      target function =                  N/A
              le_mean =     -16.906854591354
             les_mean =     286.180205946713
             stat err =       0.000465463628
             autocorr =       1.280195381484
              std dev =       0.581785134529
             le_variance =       0.338473942759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338240645422
                                         uncertainty =       0.003723331139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338240645422
                                         uncertainty =       0.003723331139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411384214
  error estimate for blocks of size 2^( 2) =       0.000424434177
  error estimate for blocks of size 2^( 3) =       0.000437952586
  error estimate for blocks of size 2^( 4) =       0.000450983594
  error estimate for blocks of size 2^( 5) =       0.000462703188
  error estimate for blocks of size 2^( 6) =       0.000471136634
  error estimate for blocks of size 2^( 7) =       0.000477031096

      target function =                  N/A
              le_mean =     -16.906854591354
             les_mean =     286.180205946713
             stat err =       0.000465463628
             autocorr =       1.280195381488
              std dev =       0.581785134529
             le_variance =       0.338473942759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338240645422
                                         uncertainty =       0.003723331139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338240645422
                                         uncertainty =       0.003723331139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411384214
  error estimate for blocks of size 2^( 2) =       0.000424434177
  error estimate for blocks of size 2^( 3) =       0.000437952586
  error estimate for blocks of size 2^( 4) =       0.000450983594
  error estimate for blocks of size 2^( 5) =       0.000462703188
  error estimate for blocks of size 2^( 6) =       0.000471136634
  error estimate for blocks of size 2^( 7) =       0.000477031096

      target function =                  N/A
              le_mean =     -16.906854591354
             les_mean =     286.180205946713
             stat err =       0.000465463628
             autocorr =       1.280195381484
              std dev =       0.581785134529
             le_variance =       0.338473942759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338240645422
                                         uncertainty =       0.003723331139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338240645422
                                         uncertainty =       0.003723331139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411384214
  error estimate for blocks of size 2^( 2) =       0.000424434177
  error estimate for blocks of size 2^( 3) =       0.000437952586
  error estimate for blocks of size 2^( 4) =       0.000450983594
  error estimate for blocks of size 2^( 5) =       0.000462703188
  error estimate for blocks of size 2^( 6) =       0.000471136634
  error estimate for blocks of size 2^( 7) =       0.000477031096

      target function =                  N/A
              le_mean =     -16.906854591354
             les_mean =     286.180205946713
             stat err =       0.000465463628
             autocorr =       1.280195381484
              std dev =       0.581785134529
             le_variance =       0.338473942759


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906854591354        initial  <--
     3.7253e+11     3.7253e+12             8.6992e-16       -16.906854591354
     1.4901e+12     1.4901e+13             1.3406e-16       -16.906854591354
     5.9605e+12     5.9605e+13             2.3063e-17       -16.906854591354

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0698
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.080498e-01 1 1  ON 0
 uu_1                 1.412818e-01 1 1  ON 1
 uu_2                 4.049641e-02 1 1  ON 2
 uu_3                -2.091039e-02 1 1  ON 3
 uu_4                -6.436460e-02 1 1  ON 4
 uu_5                -9.711026e-02 1 1  ON 5
 uu_6                -1.230012e-01 1 1  ON 6
 uu_7                -1.345659e-01 1 1  ON 7
 uu_8                -1.257867e-01 1 1  ON 8
 uu_9                -9.639029e-02 1 1  ON 9
 ud_0                 4.400011e-01 1 1  ON 10
 ud_1                 1.757947e-01 1 1  ON 11
 ud_2                 5.929423e-02 1 1  ON 12
 ud_3                -9.736014e-03 1 1  ON 13
 ud_4                -6.672413e-02 1 1  ON 14
 ud_5                -1.069756e-01 1 1  ON 15
 ud_6                -1.325991e-01 1 1  ON 16
 ud_7                -1.468293e-01 1 1  ON 17
 ud_8                -1.470633e-01 1 1  ON 18
 ud_9                -1.369486e-01 1 1  ON 19
 eO_0                -7.536949e-01 1 1  ON 20
 eO_1                -4.366744e-01 1 1  ON 21
 eO_2                -1.913127e-02 1 1  ON 22
 eO_3                 2.974115e-01 1 1  ON 23
 eO_4                 5.175470e-01 1 1  ON 24
 eO_5                 4.738543e-01 1 1  ON 25
 eO_6                 2.436411e-01 1 1  ON 26
 eO_7                -5.214842e-02 1 1  ON 27
 eO_8                -2.058174e-01 1 1  ON 28
 eO_9                -6.642309e-02 1 1  ON 29
eH1_0                -2.309121e-01 1 1  ON 30
eH1_1                -1.340279e-01 1 1  ON 31
eH1_2                -8.987319e-02 1 1  ON 32
eH1_3                -3.706594e-02 1 1  ON 33
eH1_4                 1.014689e-02 1 1  ON 34
eH1_5                 4.323411e-02 1 1  ON 35
eH1_6                 9.729324e-02 1 1  ON 36
eH1_7                 1.438614e-01 1 1  ON 37
eH1_8                 1.570022e-01 1 1  ON 38
eH1_9                 4.435545e-02 1 1  ON 39
eH2_0                -2.288175e-01 1 1  ON 40
eH2_1                -1.318423e-01 1 1  ON 41
eH2_2                -8.769696e-02 1 1  ON 42
eH2_3                -3.452217e-02 1 1  ON 43
eH2_4                 1.291288e-02 1 1  ON 44
eH2_5                 4.670636e-02 1 1  ON 45
eH2_6                 1.016835e-01 1 1  ON 46
eH2_7                 1.499661e-01 1 1  ON 47
eH2_8                 1.635692e-01 1 1  ON 48
eH2_9                 2.638065e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6184e+01 secs
  Total Execution time = 2.2703e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
