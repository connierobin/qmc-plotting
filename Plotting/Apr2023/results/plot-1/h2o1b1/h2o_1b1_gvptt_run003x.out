Rank =    0  Free Memory = 85088 MB
Rank =    1  Free Memory = 85088 MB
Rank =    2  Free Memory = 85088 MB
Rank =    3  Free Memory = 85088 MB
Rank =    4  Free Memory = 85088 MB
Rank =    5  Free Memory = 85088 MB
Rank =    6  Free Memory = 85088 MB
Rank =    7  Free Memory = 85088 MB
Rank =    8  Free Memory = 85088 MB
Rank =    9  Free Memory = 85088 MB
Rank =   10  Free Memory = 85088 MB
Rank =   11  Free Memory = 85088 MB
Rank =   12  Free Memory = 85088 MB
Rank =   13  Free Memory = 85088 MB
Rank =   14  Free Memory = 85087 MB
Rank =   15  Free Memory = 85078 MB
Rank =   16  Free Memory = 85075 MB
Rank =   17  Free Memory = 85075 MB
Rank =   18  Free Memory = 85074 MB
Rank =   19  Free Memory = 85074 MB
Rank =   20  Free Memory = 85074 MB
Rank =   21  Free Memory = 85074 MB
Rank =   22  Free Memory = 85074 MB
Rank =   23  Free Memory = 85074 MB
Rank =   24  Free Memory = 85074 MB
Rank =   25  Free Memory = 85074 MB
Rank =   26  Free Memory = 85073 MB
Rank =   27  Free Memory = 85073 MB
Rank =   28  Free Memory = 85073 MB
Rank =   29  Free Memory = 85073 MB
Rank =   30  Free Memory = 85073 MB
Rank =   31  Free Memory = 85073 MB
Rank =   32  Free Memory = 84698 MB
Rank =   33  Free Memory = 84698 MB
Rank =   34  Free Memory = 84698 MB
Rank =   35  Free Memory = 84698 MB
Rank =   36  Free Memory = 84698 MB
Rank =   37  Free Memory = 84698 MB
Rank =   38  Free Memory = 84698 MB
Rank =   39  Free Memory = 84698 MB
Rank =   40  Free Memory = 84698 MB
Rank =   41  Free Memory = 84698 MB
Rank =   42  Free Memory = 84698 MB
Rank =   43  Free Memory = 84698 MB
Rank =   44  Free Memory = 84698 MB
Rank =   45  Free Memory = 84698 MB
Rank =   46  Free Memory = 84698 MB
Rank =   47  Free Memory = 84698 MB
Rank =   48  Free Memory = 84698 MB
Rank =   49  Free Memory = 84698 MB
Rank =   50  Free Memory = 84698 MB
Rank =   51  Free Memory = 84698 MB
Rank =   52  Free Memory = 84698 MB
Rank =   53  Free Memory = 84698 MB
Rank =   54  Free Memory = 84698 MB
Rank =   55  Free Memory = 84698 MB
Rank =   56  Free Memory = 84698 MB
Rank =   57  Free Memory = 84698 MB
Rank =   58  Free Memory = 84698 MB
Rank =   59  Free Memory = 84698 MB
Rank =   60  Free Memory = 84698 MB
Rank =   61  Free Memory = 84698 MB
Rank =   62  Free Memory = 84698 MB
Rank =   63  Free Memory = 84698 MB
Rank =   64  Free Memory = 84698 MB
Rank =   65  Free Memory = 84698 MB
Rank =   66  Free Memory = 84698 MB
Rank =   67  Free Memory = 84698 MB
Rank =   68  Free Memory = 84698 MB
Rank =   69  Free Memory = 84698 MB
Rank =   70  Free Memory = 84698 MB
Rank =   71  Free Memory = 84698 MB
Rank =   72  Free Memory = 78491 MB
Rank =   73  Free Memory = 78491 MB
Rank =   74  Free Memory = 78491 MB
Rank =   75  Free Memory = 78491 MB
Rank =   76  Free Memory = 78491 MB
Rank =   77  Free Memory = 78491 MB
Rank =   78  Free Memory = 78491 MB
Rank =   79  Free Memory = 78491 MB
Rank =   80  Free Memory = 78491 MB
Rank =   81  Free Memory = 78491 MB
Rank =   82  Free Memory = 78491 MB
Rank =   83  Free Memory = 78491 MB
Rank =   84  Free Memory = 78491 MB
Rank =   85  Free Memory = 78491 MB
Rank =   86  Free Memory = 78491 MB
Rank =   87  Free Memory = 78491 MB
Rank =   88  Free Memory = 78491 MB
Rank =   89  Free Memory = 78491 MB
Rank =   90  Free Memory = 78491 MB
Rank =   91  Free Memory = 78491 MB
Rank =   92  Free Memory = 78491 MB
Rank =   93  Free Memory = 78491 MB
Rank =   94  Free Memory = 78491 MB
Rank =   95  Free Memory = 78491 MB
Rank =   96  Free Memory = 78491 MB
Rank =   97  Free Memory = 78491 MB
Rank =   98  Free Memory = 78491 MB
Rank =   99  Free Memory = 78491 MB
Rank =  100  Free Memory = 78491 MB
Rank =  101  Free Memory = 78491 MB
Rank =  102  Free Memory = 78491 MB
Rank =  103  Free Memory = 78491 MB
Rank =  104  Free Memory = 78491 MB
Rank =  105  Free Memory = 78491 MB
Rank =  106  Free Memory = 78491 MB
Rank =  107  Free Memory = 78491 MB
Rank =  108  Free Memory = 78491 MB
Rank =  109  Free Memory = 78491 MB
Rank =  110  Free Memory = 78491 MB
Rank =  111  Free Memory = 78491 MB
Rank =  112  Free Memory = 73290 MB
Rank =  113  Free Memory = 73290 MB
  Input file(s): opt_h2o_1b1_gvptt_run003x.xml 
Rank =  114  Free Memory = 73290 MB
Rank =  115  Free Memory = 73290 MB
Rank =  116  Free Memory = 73290 MB
Rank =  117  Free Memory = 73290 MB
Rank =  118  Free Memory = 73290 MB
Rank =  119  Free Memory = 73290 MB
Rank =  120  Free Memory = 73290 MB
Rank =  121  Free Memory = 73290 MB
Rank =  122  Free Memory = 73290 MB
Rank =  123  Free Memory = 73290 MB
Rank =  127  Free Memory = 73290 MB
Rank =  124  Free Memory = 73290 MB
Rank =  125  Free Memory = 73290 MB
Rank =  126  Free Memory = 73290 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003x.xml

  Project = H2O
  date    = 2023-04-25 15:57:03 PDT
  host    = n0043.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 703

  Range of prime numbers to use as seeds over processors and threads = 5323-6389


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.119502e-01    1         1  ON     0
     uu_1                 1.443344e-01    1         1  ON     1
     uu_2                 4.230326e-02    1         1  ON     2
     uu_3                -2.087400e-02    1         1  ON     3
     uu_4                -6.734868e-02    1         1  ON     4
     uu_5                -1.038428e-01    1         1  ON     5
     uu_6                -1.331901e-01    1         1  ON     6
     uu_7                -1.491723e-01    1         1  ON     7
     uu_8                -1.429928e-01    1         1  ON     8
     uu_9                -1.125317e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.543167e-01    1         1  ON     0
     ud_1                 1.882661e-01    1         1  ON     1
     ud_2                 6.726057e-02    1         1  ON     2
     ud_3                -4.393934e-03    1         1  ON     3
     ud_4                -6.210423e-02    1         1  ON     4
     ud_5                -1.047283e-01    1         1  ON     5
     ud_6                -1.334004e-01    1         1  ON     6
     ud_7                -1.510358e-01    1         1  ON     7
     ud_8                -1.524560e-01    1         1  ON     8
     ud_9                -1.435410e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.496281e-01    1         1  ON     0
     eO_1                -4.278327e-01    1         1  ON     1
     eO_2                -1.240719e-02    1         1  ON     2
     eO_3                 3.046992e-01    1         1  ON     3
     eO_4                 5.328688e-01    1         1  ON     4
     eO_5                 4.974593e-01    1         1  ON     5
     eO_6                 2.675366e-01    1         1  ON     6
     eO_7                -4.321129e-02    1         1  ON     7
     eO_8                -2.436654e-01    1         1  ON     8
     eO_9                -1.178440e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.674423e-01    1         1  ON     0
     eH1_1                -1.614867e-01    1         1  ON     1
     eH1_2                -1.121435e-01    1         1  ON     2
     eH1_3                -5.637036e-02    1         1  ON     3
     eH1_4                -6.378645e-03    1         1  ON     4
     eH1_5                 3.013612e-02    1         1  ON     5
     eH1_6                 9.384750e-02    1         1  ON     6
     eH1_7                 1.614870e-01    1         1  ON     7
     eH1_8                 2.037161e-01    1         1  ON     8
     eH1_9                 1.123117e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.648072e-01    1         1  ON     0
     eH2_1                -1.588793e-01    1         1  ON     1
     eH2_2                -1.095500e-01    1         1  ON     2
     eH2_3                -5.386492e-02    1         1  ON     3
     eH2_4                -3.713962e-03    1         1  ON     4
     eH2_5                 3.406766e-02    1         1  ON     5
     eH2_6                 9.728637e-02    1         1  ON     6
     eH2_7                 1.616936e-01    1         1  ON     7
     eH2_8                 2.046449e-01    1         1  ON     8
     eH2_9                 1.032143e-01    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 2.009048e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.1877e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9097
    reference variance = 0.185596
====================================================
  Execution time = 2.0462e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3935e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339370094149
                                         uncertainty =       0.004804484671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339370094149
                                         uncertainty =       0.004804484671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411916448
  error estimate for blocks of size 2^( 2) =       0.000424172995
  error estimate for blocks of size 2^( 3) =       0.000436920412
  error estimate for blocks of size 2^( 4) =       0.000448638062
  error estimate for blocks of size 2^( 5) =       0.000458189869
  error estimate for blocks of size 2^( 6) =       0.000466270335
  error estimate for blocks of size 2^( 7) =       0.000474763100

      target function =                  N/A
              le_mean =     -16.906646859114
             les_mean =     286.174058169644
             stat err =       0.000461965342
             autocorr =       1.257767940100
              std dev =       0.582537827554
             le_variance =       0.339350320531


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690664685911e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906646859114       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906647669530       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906648486458       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906649329168       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906649741187       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906649024964       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906648812054       residual = 7.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906648940432       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906649237457       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906649519519       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.907718e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906646859114       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906647154847       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906647472385       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906647823982       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906647964418       residual = 2.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906647871507       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906647695852       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906647699257       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.411342e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906646859114       residual = 4.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906646942646       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906647037624       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906647143372       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906647184607       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906647180038       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906647134138       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906647131436       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 6.106193e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6061e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.119299e-01                 1 1 ON  0
uu_1  1.443701e-01                 1 1 ON  1
uu_2  4.238446e-02                 1 1 ON  2
uu_3  -2.084710e-02                1 1 ON  3
uu_4  -6.733012e-02                1 1 ON  4
uu_5  -1.038775e-01                1 1 ON  5
uu_6  -1.332883e-01                1 1 ON  6
uu_7  -1.491847e-01                1 1 ON  7
uu_8  -1.430707e-01                1 1 ON  8
uu_9  -1.126348e-01                1 1 ON  9
ud_0  4.542498e-01                 1 1 ON  10
ud_1  1.881874e-01                 1 1 ON  11
ud_2  6.725156e-02                 1 1 ON  12
ud_3  -4.381256e-03                1 1 ON  13
ud_4  -6.204563e-02                1 1 ON  14
ud_5  -1.047685e-01                1 1 ON  15
ud_6  -1.333386e-01                1 1 ON  16
ud_7  -1.509363e-01                1 1 ON  17
ud_8  -1.525187e-01                1 1 ON  18
ud_9  -1.435342e-01                1 1 ON  19
eO_0  -7.495411e-01                1 1 ON  20
eO_1  -4.277754e-01                1 1 ON  21
eO_2  -1.240746e-02                1 1 ON  22
eO_3  3.047282e-01                 1 1 ON  23
eO_4  5.329453e-01                 1 1 ON  24
eO_5  4.974234e-01                 1 1 ON  25
eO_6  2.675288e-01                 1 1 ON  26
eO_7  -4.318694e-02                1 1 ON  27
eO_8  -2.437646e-01                1 1 ON  28
eO_9  -1.179598e-01                1 1 ON  29
eH1_0 -2.674618e-01                1 1 ON  30
eH1_1 -1.614883e-01                1 1 ON  31
eH1_2 -1.121701e-01                1 1 ON  32
eH1_3 -5.644852e-02                1 1 ON  33
eH1_4 -6.380069e-03                1 1 ON  34
eH1_5 3.014694e-02                 1 1 ON  35
eH1_6 9.380134e-02                 1 1 ON  36
eH1_7 1.615012e-01                 1 1 ON  37
eH1_8 2.037595e-01                 1 1 ON  38
eH1_9 1.123999e-01                 1 1 ON  39
eH2_0 -2.648644e-01                1 1 ON  40
eH2_1 -1.590290e-01                1 1 ON  41
eH2_2 -1.095221e-01                1 1 ON  42
eH2_3 -5.385420e-02                1 1 ON  43
eH2_4 -3.792255e-03                1 1 ON  44
eH2_5 3.401725e-02                 1 1 ON  45
eH2_6 9.719281e-02                 1 1 ON  46
eH2_7 1.616242e-01                 1 1 ON  47
eH2_8 2.048008e-01                 1 1 ON  48
eH2_9 1.034555e-01                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8673
    reference variance = 0.176958
====================================================
  Execution time = 2.0085e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3718e-01
  Total weights = 2.0000e+06
  Execution time = 1.8977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337278741306
                                         uncertainty =       0.004873848558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337278741306
                                         uncertainty =       0.004873848558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410642763
  error estimate for blocks of size 2^( 2) =       0.000423455586
  error estimate for blocks of size 2^( 3) =       0.000436514314
  error estimate for blocks of size 2^( 4) =       0.000449065926
  error estimate for blocks of size 2^( 5) =       0.000458647126
  error estimate for blocks of size 2^( 6) =       0.000464096787
  error estimate for blocks of size 2^( 7) =       0.000470665340

      target function =                  N/A
              le_mean =     -16.906504782047
             les_mean =     286.167158733588
             stat err =       0.000460618795
             autocorr =       1.258215304289
              std dev =       0.580736564049
             le_variance =       0.337254956824

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337106026349
                                         uncertainty =       0.004874216775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337106026349
                                         uncertainty =       0.004874216775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410537597
  error estimate for blocks of size 2^( 2) =       0.000423356355
  error estimate for blocks of size 2^( 3) =       0.000436423183
  error estimate for blocks of size 2^( 4) =       0.000448978236
  error estimate for blocks of size 2^( 5) =       0.000458558923
  error estimate for blocks of size 2^( 6) =       0.000464010157
  error estimate for blocks of size 2^( 7) =       0.000470568964

      target function =                  N/A
              le_mean =     -16.906504145685
             les_mean =     286.166964497244
             stat err =       0.000460529070
             autocorr =       1.258369622848
              std dev =       0.580587838084
             le_variance =       0.337082237730

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337137426513
                                         uncertainty =       0.004874400762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337137426513
                                         uncertainty =       0.004874400762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410556703
  error estimate for blocks of size 2^( 2) =       0.000423374584
  error estimate for blocks of size 2^( 3) =       0.000436440211
  error estimate for blocks of size 2^( 4) =       0.000448995105
  error estimate for blocks of size 2^( 5) =       0.000458575384
  error estimate for blocks of size 2^( 6) =       0.000464025801
  error estimate for blocks of size 2^( 7) =       0.000470585537

      target function =                  N/A
              le_mean =     -16.906504026712
             les_mean =     286.166991849881
             stat err =       0.000460545457
             autocorr =       1.258342050849
              std dev =       0.580614857906
             le_variance =       0.337113613222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337259533514
                                         uncertainty =       0.004873944115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337259533514
                                         uncertainty =       0.004873944115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410631065
  error estimate for blocks of size 2^( 2) =       0.000423444612
  error estimate for blocks of size 2^( 3) =       0.000436504359
  error estimate for blocks of size 2^( 4) =       0.000449056480
  error estimate for blocks of size 2^( 5) =       0.000458637479
  error estimate for blocks of size 2^( 6) =       0.000464087182
  error estimate for blocks of size 2^( 7) =       0.000470654374

      target function =                  N/A
              le_mean =     -16.906504612013
             les_mean =     286.167133770136
             stat err =       0.000460608879
             autocorr =       1.258232817461
              std dev =       0.580720020954
             le_variance =       0.337235742737


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906504782047        initial  <--
     2.5000e-01     2.5000e+00             9.9077e-04       -16.906504145685
     1.0000e+00     1.0000e+01             2.4113e-04       -16.906504026712
     4.0000e+00     4.0000e+01             6.1062e-05       -16.906504612013

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5981
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.119502e-01 1 1  ON 0
 uu_1                 1.443344e-01 1 1  ON 1
 uu_2                 4.230326e-02 1 1  ON 2
 uu_3                -2.087400e-02 1 1  ON 3
 uu_4                -6.734868e-02 1 1  ON 4
 uu_5                -1.038428e-01 1 1  ON 5
 uu_6                -1.331901e-01 1 1  ON 6
 uu_7                -1.491723e-01 1 1  ON 7
 uu_8                -1.429928e-01 1 1  ON 8
 uu_9                -1.125317e-01 1 1  ON 9
 ud_0                 4.543167e-01 1 1  ON 10
 ud_1                 1.882661e-01 1 1  ON 11
 ud_2                 6.726057e-02 1 1  ON 12
 ud_3                -4.393934e-03 1 1  ON 13
 ud_4                -6.210423e-02 1 1  ON 14
 ud_5                -1.047283e-01 1 1  ON 15
 ud_6                -1.334004e-01 1 1  ON 16
 ud_7                -1.510358e-01 1 1  ON 17
 ud_8                -1.524560e-01 1 1  ON 18
 ud_9                -1.435410e-01 1 1  ON 19
 eO_0                -7.496281e-01 1 1  ON 20
 eO_1                -4.278327e-01 1 1  ON 21
 eO_2                -1.240719e-02 1 1  ON 22
 eO_3                 3.046992e-01 1 1  ON 23
 eO_4                 5.328688e-01 1 1  ON 24
 eO_5                 4.974593e-01 1 1  ON 25
 eO_6                 2.675366e-01 1 1  ON 26
 eO_7                -4.321129e-02 1 1  ON 27
 eO_8                -2.436654e-01 1 1  ON 28
 eO_9                -1.178440e-01 1 1  ON 29
eH1_0                -2.674423e-01 1 1  ON 30
eH1_1                -1.614867e-01 1 1  ON 31
eH1_2                -1.121435e-01 1 1  ON 32
eH1_3                -5.637036e-02 1 1  ON 33
eH1_4                -6.378645e-03 1 1  ON 34
eH1_5                 3.013612e-02 1 1  ON 35
eH1_6                 9.384750e-02 1 1  ON 36
eH1_7                 1.614870e-01 1 1  ON 37
eH1_8                 2.037161e-01 1 1  ON 38
eH1_9                 1.123117e-01 1 1  ON 39
eH2_0                -2.648072e-01 1 1  ON 40
eH2_1                -1.588793e-01 1 1  ON 41
eH2_2                -1.095500e-01 1 1  ON 42
eH2_3                -5.386492e-02 1 1  ON 43
eH2_4                -3.713962e-03 1 1  ON 44
eH2_5                 3.406766e-02 1 1  ON 45
eH2_6                 9.728637e-02 1 1  ON 46
eH2_7                 1.616936e-01 1 1  ON 47
eH2_8                 2.046449e-01 1 1  ON 48
eH2_9                 1.032143e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5667e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6888e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8684
    reference variance = 0.188458
====================================================
  Execution time = 2.0391e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3737e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337295042561
                                         uncertainty =       0.002907390694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337295042561
                                         uncertainty =       0.002907390694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410710021
  error estimate for blocks of size 2^( 2) =       0.000423073876
  error estimate for blocks of size 2^( 3) =       0.000435750826
  error estimate for blocks of size 2^( 4) =       0.000447770160
  error estimate for blocks of size 2^( 5) =       0.000458263397
  error estimate for blocks of size 2^( 6) =       0.000467508621
  error estimate for blocks of size 2^( 7) =       0.000473826701

      target function =                  N/A
              le_mean =     -16.906343078971
             les_mean =     286.161801577705
             stat err =       0.000461842220
             autocorr =       1.264493684861
              std dev =       0.580831681738
             le_variance =       0.337365442510


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690634307897e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906343078971       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906343091585       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906342989311       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906343029056       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906342943758       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906342917553       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906342939141       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906342934626       residual = 2.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 6.288303e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906343078971       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906343082392       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906343053702       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906343061812       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906343039748       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906343032840       residual = 4.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906343035996       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 1.561453e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906343078971       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906343079845       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906343072449       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906343074338       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906343068755       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906343066999       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906343067614       residual = 8.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 3.917303e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.110162 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5888e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.119612e-01 1 1  ON 0
 uu_1                 1.443412e-01 1 1  ON 1
 uu_2                 4.229595e-02 1 1  ON 2
 uu_3                -2.087334e-02 1 1  ON 3
 uu_4                -6.735025e-02 1 1  ON 4
 uu_5                -1.038406e-01 1 1  ON 5
 uu_6                -1.331987e-01 1 1  ON 6
 uu_7                -1.491608e-01 1 1  ON 7
 uu_8                -1.430035e-01 1 1  ON 8
 uu_9                -1.125473e-01 1 1  ON 9
 ud_0                 4.543176e-01 1 1  ON 10
 ud_1                 1.882722e-01 1 1  ON 11
 ud_2                 6.726506e-02 1 1  ON 12
 ud_3                -4.391262e-03 1 1  ON 13
 ud_4                -6.209981e-02 1 1  ON 14
 ud_5                -1.047261e-01 1 1  ON 15
 ud_6                -1.334002e-01 1 1  ON 16
 ud_7                -1.510266e-01 1 1  ON 17
 ud_8                -1.524683e-01 1 1  ON 18
 ud_9                -1.435542e-01 1 1  ON 19
 eO_0                -7.496232e-01 1 1  ON 20
 eO_1                -4.278253e-01 1 1  ON 21
 eO_2                -1.240520e-02 1 1  ON 22
 eO_3                 3.047087e-01 1 1  ON 23
 eO_4                 5.328655e-01 1 1  ON 24
 eO_5                 4.974584e-01 1 1  ON 25
 eO_6                 2.675435e-01 1 1  ON 26
 eO_7                -4.320762e-02 1 1  ON 27
 eO_8                -2.436793e-01 1 1  ON 28
 eO_9                -1.178574e-01 1 1  ON 29
eH1_0                -2.674432e-01 1 1  ON 30
eH1_1                -1.614842e-01 1 1  ON 31
eH1_2                -1.121497e-01 1 1  ON 32
eH1_3                -5.637813e-02 1 1  ON 33
eH1_4                -6.379330e-03 1 1  ON 34
eH1_5                 3.014345e-02 1 1  ON 35
eH1_6                 9.384651e-02 1 1  ON 36
eH1_7                 1.614812e-01 1 1  ON 37
eH1_8                 2.037191e-01 1 1  ON 38
eH1_9                 1.123212e-01 1 1  ON 39
eH2_0                -2.648128e-01 1 1  ON 40
eH2_1                -1.588810e-01 1 1  ON 41
eH2_2                -1.095598e-01 1 1  ON 42
eH2_3                -5.387075e-02 1 1  ON 43
eH2_4                -3.714258e-03 1 1  ON 44
eH2_5                 3.406683e-02 1 1  ON 45
eH2_6                 9.728333e-02 1 1  ON 46
eH2_7                 1.616985e-01 1 1  ON 47
eH2_8                 2.046497e-01 1 1  ON 48
eH2_9                 1.032296e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9186
    reference variance = 0.455033
====================================================
  Execution time = 1.9797e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4022e-01
  Total weights = 2.0000e+06
  Execution time = 1.8823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340242033250
                                         uncertainty =       0.004971854497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340242033250
                                         uncertainty =       0.004971854497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412443485
  error estimate for blocks of size 2^( 2) =       0.000424853981
  error estimate for blocks of size 2^( 3) =       0.000437254874
  error estimate for blocks of size 2^( 4) =       0.000448648133
  error estimate for blocks of size 2^( 5) =       0.000459327375
  error estimate for blocks of size 2^( 6) =       0.000466351850
  error estimate for blocks of size 2^( 7) =       0.000472324725

      target function =                  N/A
              le_mean =     -16.906621230228
             les_mean =     286.174060508415
             stat err =       0.000461663021
             autocorr =       1.252914061064
              std dev =       0.583283169767
             le_variance =       0.340219256133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340256610480
                                         uncertainty =       0.004971991310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340256610480
                                         uncertainty =       0.004971991310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412452318
  error estimate for blocks of size 2^( 2) =       0.000424862202
  error estimate for blocks of size 2^( 3) =       0.000437262292
  error estimate for blocks of size 2^( 4) =       0.000448655142
  error estimate for blocks of size 2^( 5) =       0.000459334103
  error estimate for blocks of size 2^( 6) =       0.000466358192
  error estimate for blocks of size 2^( 7) =       0.000472331958

      target function =                  N/A
              le_mean =     -16.906621067750
             les_mean =     286.174069588196
             stat err =       0.000461669849
             autocorr =       1.252897451421
              std dev =       0.583295662445
             le_variance =       0.340233829827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340249457059
                                         uncertainty =       0.004971921561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340249457059
                                         uncertainty =       0.004971921561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412447983
  error estimate for blocks of size 2^( 2) =       0.000424858160
  error estimate for blocks of size 2^( 3) =       0.000437258630
  error estimate for blocks of size 2^( 4) =       0.000448651658
  error estimate for blocks of size 2^( 5) =       0.000459330749
  error estimate for blocks of size 2^( 6) =       0.000466354997
  error estimate for blocks of size 2^( 7) =       0.000472328358

      target function =                  N/A
              le_mean =     -16.906621140474
             les_mean =     286.174064895303
             stat err =       0.000461666440
             autocorr =       1.252905289625
              std dev =       0.583289531785
             le_variance =       0.340226677890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340242974917
                                         uncertainty =       0.004971862998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340242974917
                                         uncertainty =       0.004971862998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412444055
  error estimate for blocks of size 2^( 2) =       0.000424854511
  error estimate for blocks of size 2^( 3) =       0.000437255350
  error estimate for blocks of size 2^( 4) =       0.000448648581
  error estimate for blocks of size 2^( 5) =       0.000459327803
  error estimate for blocks of size 2^( 6) =       0.000466352248
  error estimate for blocks of size 2^( 7) =       0.000472325187

      target function =                  N/A
              le_mean =     -16.906621218173
             les_mean =     286.174061042193
             stat err =       0.000461663455
             autocorr =       1.252912948432
              std dev =       0.583283976733
             le_variance =       0.340220197513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906621230228        initial  <--
     2.5000e+00     2.5000e+01             6.2883e-05       -16.906621067750
     1.0000e+01     1.0000e+02             1.5615e-05       -16.906621140474
     4.0000e+01     4.0000e+02             3.9173e-06       -16.906621218173

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2750
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.119502e-01 1 1  ON 0
 uu_1                 1.443344e-01 1 1  ON 1
 uu_2                 4.230326e-02 1 1  ON 2
 uu_3                -2.087400e-02 1 1  ON 3
 uu_4                -6.734868e-02 1 1  ON 4
 uu_5                -1.038428e-01 1 1  ON 5
 uu_6                -1.331901e-01 1 1  ON 6
 uu_7                -1.491723e-01 1 1  ON 7
 uu_8                -1.429928e-01 1 1  ON 8
 uu_9                -1.125317e-01 1 1  ON 9
 ud_0                 4.543167e-01 1 1  ON 10
 ud_1                 1.882661e-01 1 1  ON 11
 ud_2                 6.726057e-02 1 1  ON 12
 ud_3                -4.393934e-03 1 1  ON 13
 ud_4                -6.210423e-02 1 1  ON 14
 ud_5                -1.047283e-01 1 1  ON 15
 ud_6                -1.334004e-01 1 1  ON 16
 ud_7                -1.510358e-01 1 1  ON 17
 ud_8                -1.524560e-01 1 1  ON 18
 ud_9                -1.435410e-01 1 1  ON 19
 eO_0                -7.496281e-01 1 1  ON 20
 eO_1                -4.278327e-01 1 1  ON 21
 eO_2                -1.240719e-02 1 1  ON 22
 eO_3                 3.046992e-01 1 1  ON 23
 eO_4                 5.328688e-01 1 1  ON 24
 eO_5                 4.974593e-01 1 1  ON 25
 eO_6                 2.675366e-01 1 1  ON 26
 eO_7                -4.321129e-02 1 1  ON 27
 eO_8                -2.436654e-01 1 1  ON 28
 eO_9                -1.178440e-01 1 1  ON 29
eH1_0                -2.674423e-01 1 1  ON 30
eH1_1                -1.614867e-01 1 1  ON 31
eH1_2                -1.121435e-01 1 1  ON 32
eH1_3                -5.637036e-02 1 1  ON 33
eH1_4                -6.378645e-03 1 1  ON 34
eH1_5                 3.013612e-02 1 1  ON 35
eH1_6                 9.384750e-02 1 1  ON 36
eH1_7                 1.614870e-01 1 1  ON 37
eH1_8                 2.037161e-01 1 1  ON 38
eH1_9                 1.123117e-01 1 1  ON 39
eH2_0                -2.648072e-01 1 1  ON 40
eH2_1                -1.588793e-01 1 1  ON 41
eH2_2                -1.095500e-01 1 1  ON 42
eH2_3                -5.386492e-02 1 1  ON 43
eH2_4                -3.713962e-03 1 1  ON 44
eH2_5                 3.406766e-02 1 1  ON 45
eH2_6                 9.728637e-02 1 1  ON 46
eH2_7                 1.616936e-01 1 1  ON 47
eH2_8                 2.046449e-01 1 1  ON 48
eH2_9                 1.032143e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5171e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.246974
====================================================
  Execution time = 2.0253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3661e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6488e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336660653784
                                         uncertainty =       0.002921948399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336660653784
                                         uncertainty =       0.002921948399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410247647
  error estimate for blocks of size 2^( 2) =       0.000423176890
  error estimate for blocks of size 2^( 3) =       0.000436753192
  error estimate for blocks of size 2^( 4) =       0.000448909988
  error estimate for blocks of size 2^( 5) =       0.000459802868
  error estimate for blocks of size 2^( 6) =       0.000469783237
  error estimate for blocks of size 2^( 7) =       0.000477027427

      target function =                  N/A
              le_mean =     -16.906980054995
             les_mean =     286.182580675130
             stat err =       0.000463880880
             autocorr =       1.278558924098
              std dev =       0.580177786060
             le_variance =       0.336606263437


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690698005499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906980054995       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906980076657       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906980077957       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906980093661       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906980096326       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906980104324       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906980097325       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906980094130       residual = 2.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 8.560397e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906980054995       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906980060432       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906980060771       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906980064735       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906980065401       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906980067436       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906980065667       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906980064891       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 2.141774e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906980054995       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906980056355       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906980056441       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906980057434       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906980057601       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906980058112       residual = 5.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906980057669       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906980057476       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 5.355488e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112901 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5908e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.119496e-01 1 1  ON 0
 uu_1                 1.443352e-01 1 1  ON 1
 uu_2                 4.230257e-02 1 1  ON 2
 uu_3                -2.087317e-02 1 1  ON 3
 uu_4                -6.734923e-02 1 1  ON 4
 uu_5                -1.038436e-01 1 1  ON 5
 uu_6                -1.331907e-01 1 1  ON 6
 uu_7                -1.491724e-01 1 1  ON 7
 uu_8                -1.429933e-01 1 1  ON 8
 uu_9                -1.125317e-01 1 1  ON 9
 ud_0                 4.543162e-01 1 1  ON 10
 ud_1                 1.882655e-01 1 1  ON 11
 ud_2                 6.726108e-02 1 1  ON 12
 ud_3                -4.393971e-03 1 1  ON 13
 ud_4                -6.210419e-02 1 1  ON 14
 ud_5                -1.047285e-01 1 1  ON 15
 ud_6                -1.333994e-01 1 1  ON 16
 ud_7                -1.510370e-01 1 1  ON 17
 ud_8                -1.524562e-01 1 1  ON 18
 ud_9                -1.435407e-01 1 1  ON 19
 eO_0                -7.496270e-01 1 1  ON 20
 eO_1                -4.278320e-01 1 1  ON 21
 eO_2                -1.240774e-02 1 1  ON 22
 eO_3                 3.046994e-01 1 1  ON 23
 eO_4                 5.328696e-01 1 1  ON 24
 eO_5                 4.974585e-01 1 1  ON 25
 eO_6                 2.675365e-01 1 1  ON 26
 eO_7                -4.321111e-02 1 1  ON 27
 eO_8                -2.436662e-01 1 1  ON 28
 eO_9                -1.178447e-01 1 1  ON 29
eH1_0                -2.674429e-01 1 1  ON 30
eH1_1                -1.614880e-01 1 1  ON 31
eH1_2                -1.121436e-01 1 1  ON 32
eH1_3                -5.637031e-02 1 1  ON 33
eH1_4                -6.378446e-03 1 1  ON 34
eH1_5                 3.013604e-02 1 1  ON 35
eH1_6                 9.384760e-02 1 1  ON 36
eH1_7                 1.614867e-01 1 1  ON 37
eH1_8                 2.037165e-01 1 1  ON 38
eH1_9                 1.123130e-01 1 1  ON 39
eH2_0                -2.648082e-01 1 1  ON 40
eH2_1                -1.588792e-01 1 1  ON 41
eH2_2                -1.095498e-01 1 1  ON 42
eH2_3                -5.386480e-02 1 1  ON 43
eH2_4                -3.715052e-03 1 1  ON 44
eH2_5                 3.406665e-02 1 1  ON 45
eH2_6                 9.728561e-02 1 1  ON 46
eH2_7                 1.616933e-01 1 1  ON 47
eH2_8                 2.046456e-01 1 1  ON 48
eH2_9                 1.032165e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.847
    reference variance = 0.731108
====================================================
  Execution time = 1.9927e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4159e-01
  Total weights = 2.0000e+06
  Execution time = 1.8977e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446909383
                                         uncertainty =       0.003571594104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446909383
                                         uncertainty =       0.003571594104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413274389
  error estimate for blocks of size 2^( 2) =       0.000426096706
  error estimate for blocks of size 2^( 3) =       0.000438914004
  error estimate for blocks of size 2^( 4) =       0.000451189835
  error estimate for blocks of size 2^( 5) =       0.000461992176
  error estimate for blocks of size 2^( 6) =       0.000470055751
  error estimate for blocks of size 2^( 7) =       0.000475773477

      target function =                  N/A
              le_mean =     -16.906863148043
             les_mean =     286.183612776709
             stat err =       0.000464752810
             autocorr =       1.264640435469
              std dev =       0.584458245595
             le_variance =       0.341591440844

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341444825294
                                         uncertainty =       0.003571630805

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341444825294
                                         uncertainty =       0.003571630805

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413273123
  error estimate for blocks of size 2^( 2) =       0.000426095553
  error estimate for blocks of size 2^( 3) =       0.000438912957
  error estimate for blocks of size 2^( 4) =       0.000451188869
  error estimate for blocks of size 2^( 5) =       0.000461991294
  error estimate for blocks of size 2^( 6) =       0.000470054924
  error estimate for blocks of size 2^( 7) =       0.000475772799

      target function =                  N/A
              le_mean =     -16.906863155558
             les_mean =     286.183610937671
             stat err =       0.000464751972
             autocorr =       1.264643622513
              std dev =       0.584456454935
             le_variance =       0.341589347715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341445872129
                                         uncertainty =       0.003571613049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341445872129
                                         uncertainty =       0.003571613049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413273759
  error estimate for blocks of size 2^( 2) =       0.000426096133
  error estimate for blocks of size 2^( 3) =       0.000438913484
  error estimate for blocks of size 2^( 4) =       0.000451189356
  error estimate for blocks of size 2^( 5) =       0.000461991739
  error estimate for blocks of size 2^( 6) =       0.000470055342
  error estimate for blocks of size 2^( 7) =       0.000475773143

      target function =                  N/A
              le_mean =     -16.906863151804
             les_mean =     286.183611862039
             stat err =       0.000464752395
             autocorr =       1.264642034370
              std dev =       0.584457354319
             le_variance =       0.341590399017

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446779854
                                         uncertainty =       0.003571596491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341446779854
                                         uncertainty =       0.003571596491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413274310
  error estimate for blocks of size 2^( 2) =       0.000426096635
  error estimate for blocks of size 2^( 3) =       0.000438913939
  error estimate for blocks of size 2^( 4) =       0.000451189775
  error estimate for blocks of size 2^( 5) =       0.000461992122
  error estimate for blocks of size 2^( 6) =       0.000470055700
  error estimate for blocks of size 2^( 7) =       0.000475773436

      target function =                  N/A
              le_mean =     -16.906863148510
             les_mean =     286.183612662384
             stat err =       0.000464752758
             autocorr =       1.264640635499
              std dev =       0.584458134293
             le_variance =       0.341591310741


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906863148043        initial
     2.5000e+01     2.5000e+02             8.5604e-06       -16.906863155558  <--
     1.0000e+02     1.0000e+03             2.1418e-06       -16.906863151804
     4.0000e+02     4.0000e+03             5.3555e-07       -16.906863148510

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.9429e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.119480e-01 1 1  ON 0
 uu_1                 1.443379e-01 1 1  ON 1
 uu_2                 4.230057e-02 1 1  ON 2
 uu_3                -2.087072e-02 1 1  ON 3
 uu_4                -6.735085e-02 1 1  ON 4
 uu_5                -1.038460e-01 1 1  ON 5
 uu_6                -1.331926e-01 1 1  ON 6
 uu_7                -1.491726e-01 1 1  ON 7
 uu_8                -1.429949e-01 1 1  ON 8
 uu_9                -1.125318e-01 1 1  ON 9
 ud_0                 4.543149e-01 1 1  ON 10
 ud_1                 1.882639e-01 1 1  ON 11
 ud_2                 6.726257e-02 1 1  ON 12
 ud_3                -4.394065e-03 1 1  ON 13
 ud_4                -6.210406e-02 1 1  ON 14
 ud_5                -1.047289e-01 1 1  ON 15
 ud_6                -1.333964e-01 1 1  ON 16
 ud_7                -1.510404e-01 1 1  ON 17
 ud_8                -1.524566e-01 1 1  ON 18
 ud_9                -1.435395e-01 1 1  ON 19
 eO_0                -7.496238e-01 1 1  ON 20
 eO_1                -4.278298e-01 1 1  ON 21
 eO_2                -1.240934e-02 1 1  ON 22
 eO_3                 3.047001e-01 1 1  ON 23
 eO_4                 5.328721e-01 1 1  ON 24
 eO_5                 4.974563e-01 1 1  ON 25
 eO_6                 2.675361e-01 1 1  ON 26
 eO_7                -4.321055e-02 1 1  ON 27
 eO_8                -2.436688e-01 1 1  ON 28
 eO_9                -1.178471e-01 1 1  ON 29
eH1_0                -2.674447e-01 1 1  ON 30
eH1_1                -1.614922e-01 1 1  ON 31
eH1_2                -1.121437e-01 1 1  ON 32
eH1_3                -5.637017e-02 1 1  ON 33
eH1_4                -6.377846e-03 1 1  ON 34
eH1_5                 3.013578e-02 1 1  ON 35
eH1_6                 9.384789e-02 1 1  ON 36
eH1_7                 1.614860e-01 1 1  ON 37
eH1_8                 2.037176e-01 1 1  ON 38
eH1_9                 1.123166e-01 1 1  ON 39
eH2_0                -2.648109e-01 1 1  ON 40
eH2_1                -1.588786e-01 1 1  ON 41
eH2_2                -1.095492e-01 1 1  ON 42
eH2_3                -5.386447e-02 1 1  ON 43
eH2_4                -3.718305e-03 1 1  ON 44
eH2_5                 3.406364e-02 1 1  ON 45
eH2_6                 9.728333e-02 1 1  ON 46
eH2_7                 1.616924e-01 1 1  ON 47
eH2_8                 2.046478e-01 1 1  ON 48
eH2_9                 1.032229e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5344e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6882e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8231
    reference variance = 0.313386
====================================================
  Execution time = 2.0543e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3536e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335373215753
                                         uncertainty =       0.002950672206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335373215753
                                         uncertainty =       0.002950672206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409487695
  error estimate for blocks of size 2^( 2) =       0.000422101663
  error estimate for blocks of size 2^( 3) =       0.000435339650
  error estimate for blocks of size 2^( 4) =       0.000447677302
  error estimate for blocks of size 2^( 5) =       0.000458519884
  error estimate for blocks of size 2^( 6) =       0.000466576949
  error estimate for blocks of size 2^( 7) =       0.000470813067

      target function =                  N/A
              le_mean =     -16.906810484101
             les_mean =     286.175600921999
             stat err =       0.000460896800
             autocorr =       1.266851398525
              std dev =       0.579103051600
             le_variance =       0.335360344373


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690681048410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906810484101       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906810469569       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906810479535       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906810467924       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906810466343       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906810498664       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906810502038       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906810473969       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.154322e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906810484101       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906810480386       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906810482783       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906810479666       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906810479343       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906810487046       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906810487572       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906810480934       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 7.909071e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906810484101       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906810483167       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906810483760       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906810482966       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906810482891       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906810484791       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906810484899       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906810483264       residual = 2.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 1.978768e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115603 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6147e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.119421e-01 1 1  ON 0
 uu_1                 1.443374e-01 1 1  ON 1
 uu_2                 4.229767e-02 1 1  ON 2
 uu_3                -2.087091e-02 1 1  ON 3
 uu_4                -6.735305e-02 1 1  ON 4
 uu_5                -1.038402e-01 1 1  ON 5
 uu_6                -1.331882e-01 1 1  ON 6
 uu_7                -1.491701e-01 1 1  ON 7
 uu_8                -1.429978e-01 1 1  ON 8
 uu_9                -1.125343e-01 1 1  ON 9
 ud_0                 4.543183e-01 1 1  ON 10
 ud_1                 1.882633e-01 1 1  ON 11
 ud_2                 6.726684e-02 1 1  ON 12
 ud_3                -4.394672e-03 1 1  ON 13
 ud_4                -6.210341e-02 1 1  ON 14
 ud_5                -1.047307e-01 1 1  ON 15
 ud_6                -1.333958e-01 1 1  ON 16
 ud_7                -1.510419e-01 1 1  ON 17
 ud_8                -1.524592e-01 1 1  ON 18
 ud_9                -1.435396e-01 1 1  ON 19
 eO_0                -7.496213e-01 1 1  ON 20
 eO_1                -4.278245e-01 1 1  ON 21
 eO_2                -1.241273e-02 1 1  ON 22
 eO_3                 3.047044e-01 1 1  ON 23
 eO_4                 5.328726e-01 1 1  ON 24
 eO_5                 4.974553e-01 1 1  ON 25
 eO_6                 2.675377e-01 1 1  ON 26
 eO_7                -4.320995e-02 1 1  ON 27
 eO_8                -2.436731e-01 1 1  ON 28
 eO_9                -1.178523e-01 1 1  ON 29
eH1_0                -2.674506e-01 1 1  ON 30
eH1_1                -1.614909e-01 1 1  ON 31
eH1_2                -1.121458e-01 1 1  ON 32
eH1_3                -5.637255e-02 1 1  ON 33
eH1_4                -6.375556e-03 1 1  ON 34
eH1_5                 3.013328e-02 1 1  ON 35
eH1_6                 9.384579e-02 1 1  ON 36
eH1_7                 1.614835e-01 1 1  ON 37
eH1_8                 2.037219e-01 1 1  ON 38
eH1_9                 1.123245e-01 1 1  ON 39
eH2_0                -2.648146e-01 1 1  ON 40
eH2_1                -1.588820e-01 1 1  ON 41
eH2_2                -1.095511e-01 1 1  ON 42
eH2_3                -5.386293e-02 1 1  ON 43
eH2_4                -3.720505e-03 1 1  ON 44
eH2_5                 3.406071e-02 1 1  ON 45
eH2_6                 9.728448e-02 1 1  ON 46
eH2_7                 1.616945e-01 1 1  ON 47
eH2_8                 2.046497e-01 1 1  ON 48
eH2_9                 1.032295e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.8236
    reference variance = 0.159379
====================================================
  Execution time = 1.9941e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4381e-01
  Total weights = 2.0000e+06
  Execution time = 1.8936e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343852813505
                                         uncertainty =       0.006823525760

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343852813505
                                         uncertainty =       0.006823525760

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414613994
  error estimate for blocks of size 2^( 2) =       0.000426866456
  error estimate for blocks of size 2^( 3) =       0.000439374618
  error estimate for blocks of size 2^( 4) =       0.000450779618
  error estimate for blocks of size 2^( 5) =       0.000460909910
  error estimate for blocks of size 2^( 6) =       0.000468433031
  error estimate for blocks of size 2^( 7) =       0.000472400738

      target function =                  N/A
              le_mean =     -16.907135222401
             les_mean =     286.195030784620
             stat err =       0.000463130824
             autocorr =       1.247726679452
              std dev =       0.586352733398
             le_variance =       0.343809527963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343850847793
                                         uncertainty =       0.006823325187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343850847793
                                         uncertainty =       0.006823325187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414612811
  error estimate for blocks of size 2^( 2) =       0.000426865294
  error estimate for blocks of size 2^( 3) =       0.000439373504
  error estimate for blocks of size 2^( 4) =       0.000450778609
  error estimate for blocks of size 2^( 5) =       0.000460908579
  error estimate for blocks of size 2^( 6) =       0.000468431455
  error estimate for blocks of size 2^( 7) =       0.000472399731

      target function =                  N/A
              le_mean =     -16.907135227171
             les_mean =     286.195028984518
             stat err =       0.000463129594
             autocorr =       1.247727166280
              std dev =       0.586351060851
             le_variance =       0.343807566561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343851893686
                                         uncertainty =       0.006823426508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343851893686
                                         uncertainty =       0.006823426508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414613441
  error estimate for blocks of size 2^( 2) =       0.000426865913
  error estimate for blocks of size 2^( 3) =       0.000439374100
  error estimate for blocks of size 2^( 4) =       0.000450779150
  error estimate for blocks of size 2^( 5) =       0.000460909271
  error estimate for blocks of size 2^( 6) =       0.000468432262
  error estimate for blocks of size 2^( 7) =       0.000472400272

      target function =                  N/A
              le_mean =     -16.907135223760
             les_mean =     286.195029912964
             stat err =       0.000463130239
             autocorr =       1.247726854496
              std dev =       0.586351950938
             le_variance =       0.343808610369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343852700222
                                         uncertainty =       0.006823513395

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343852700222
                                         uncertainty =       0.006823513395

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414613926
  error estimate for blocks of size 2^( 2) =       0.000426866389
  error estimate for blocks of size 2^( 3) =       0.000439374554
  error estimate for blocks of size 2^( 4) =       0.000450779560
  error estimate for blocks of size 2^( 5) =       0.000460909831
  error estimate for blocks of size 2^( 6) =       0.000468432935
  error estimate for blocks of size 2^( 7) =       0.000472400681

      target function =                  N/A
              le_mean =     -16.907135222483
             les_mean =     286.195030674374
             stat err =       0.000463130752
             autocorr =       1.247726699065
              std dev =       0.586352637037
             le_variance =       0.343809414961


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907135222401        initial
     6.2500e+00     6.2500e+01             3.1543e-05       -16.907135227171  <--
     2.5000e+01     2.5000e+02             7.9091e-06       -16.907135223760
     1.0000e+02     1.0000e+03             1.9788e-06       -16.907135222483

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.9446e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.119247e-01 1 1  ON 0
 uu_1                 1.443356e-01 1 1  ON 1
 uu_2                 4.228931e-02 1 1  ON 2
 uu_3                -2.087179e-02 1 1  ON 3
 uu_4                -6.735917e-02 1 1  ON 4
 uu_5                -1.038234e-01 1 1  ON 5
 uu_6                -1.331751e-01 1 1  ON 6
 uu_7                -1.491626e-01 1 1  ON 7
 uu_8                -1.430064e-01 1 1  ON 8
 uu_9                -1.125416e-01 1 1  ON 9
 ud_0                 4.543278e-01 1 1  ON 10
 ud_1                 1.882623e-01 1 1  ON 11
 ud_2                 6.727886e-02 1 1  ON 12
 ud_3                -4.396004e-03 1 1  ON 13
 ud_4                -6.210173e-02 1 1  ON 14
 ud_5                -1.047358e-01 1 1  ON 15
 ud_6                -1.333944e-01 1 1  ON 16
 ud_7                -1.510463e-01 1 1  ON 17
 ud_8                -1.524669e-01 1 1  ON 18
 ud_9                -1.435397e-01 1 1  ON 19
 eO_0                -7.496139e-01 1 1  ON 20
 eO_1                -4.278091e-01 1 1  ON 21
 eO_2                -1.242219e-02 1 1  ON 22
 eO_3                 3.047170e-01 1 1  ON 23
 eO_4                 5.328742e-01 1 1  ON 24
 eO_5                 4.974524e-01 1 1  ON 25
 eO_6                 2.675424e-01 1 1  ON 26
 eO_7                -4.320813e-02 1 1  ON 27
 eO_8                -2.436859e-01 1 1  ON 28
 eO_9                -1.178680e-01 1 1  ON 29
eH1_0                -2.674682e-01 1 1  ON 30
eH1_1                -1.614873e-01 1 1  ON 31
eH1_2                -1.121518e-01 1 1  ON 32
eH1_3                -5.637954e-02 1 1  ON 33
eH1_4                -6.368947e-03 1 1  ON 34
eH1_5                 3.012586e-02 1 1  ON 35
eH1_6                 9.383952e-02 1 1  ON 36
eH1_7                 1.614761e-01 1 1  ON 37
eH1_8                 2.037348e-01 1 1  ON 38
eH1_9                 1.123481e-01 1 1  ON 39
eH2_0                -2.648259e-01 1 1  ON 40
eH2_1                -1.588919e-01 1 1  ON 41
eH2_2                -1.095568e-01 1 1  ON 42
eH2_3                -5.385863e-02 1 1  ON 43
eH2_4                -3.726905e-03 1 1  ON 44
eH2_5                 3.405190e-02 1 1  ON 45
eH2_6                 9.728792e-02 1 1  ON 46
eH2_7                 1.617009e-01 1 1  ON 47
eH2_8                 2.046555e-01 1 1  ON 48
eH2_9                 1.032493e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5601e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6868e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9515
    reference variance = 0.28995
====================================================
  Execution time = 2.0332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4599e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346092933449
                                         uncertainty =       0.007534241284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346092933449
                                         uncertainty =       0.007534241284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415929466
  error estimate for blocks of size 2^( 2) =       0.000428156358
  error estimate for blocks of size 2^( 3) =       0.000440815011
  error estimate for blocks of size 2^( 4) =       0.000452400962
  error estimate for blocks of size 2^( 5) =       0.000463039190
  error estimate for blocks of size 2^( 6) =       0.000470571435
  error estimate for blocks of size 2^( 7) =       0.000476694136

      target function =                  N/A
              le_mean =     -16.906585815856
             les_mean =     286.178638417860
             stat err =       0.000465676431
             autocorr =       1.253513851990
              std dev =       0.588213092301
             le_variance =       0.345994641955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658581586e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906585815856       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906586012470       residual = 9.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906586008133       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906586151443       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906586066992       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906586066138       residual = 5.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906586063815       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906586097851       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 9.649766e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906585815856       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906585869147       residual = 9.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906585865765       residual = 9.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906585905515       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906585885194       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906585887733       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906585885711       residual = 6.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 2.311416e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906585815856       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906585829465       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906585828453       residual = 9.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906585838674       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906585833673       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906585834542       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906585833969       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 5.807155e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118047 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5907e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.119199e-01 1 1  ON 0
 uu_1                 1.443220e-01 1 1  ON 1
 uu_2                 4.229339e-02 1 1  ON 2
 uu_3                -2.087339e-02 1 1  ON 3
 uu_4                -6.735016e-02 1 1  ON 4
 uu_5                -1.038183e-01 1 1  ON 5
 uu_6                -1.331619e-01 1 1  ON 6
 uu_7                -1.491611e-01 1 1  ON 7
 uu_8                -1.430274e-01 1 1  ON 8
 uu_9                -1.125620e-01 1 1  ON 9
 ud_0                 4.543155e-01 1 1  ON 10
 ud_1                 1.882669e-01 1 1  ON 11
 ud_2                 6.728330e-02 1 1  ON 12
 ud_3                -4.387599e-03 1 1  ON 13
 ud_4                -6.209122e-02 1 1  ON 14
 ud_5                -1.047420e-01 1 1  ON 15
 ud_6                -1.333941e-01 1 1  ON 16
 ud_7                -1.510588e-01 1 1  ON 17
 ud_8                -1.524672e-01 1 1  ON 18
 ud_9                -1.435343e-01 1 1  ON 19
 eO_0                -7.496097e-01 1 1  ON 20
 eO_1                -4.277960e-01 1 1  ON 21
 eO_2                -1.241627e-02 1 1  ON 22
 eO_3                 3.047116e-01 1 1  ON 23
 eO_4                 5.328797e-01 1 1  ON 24
 eO_5                 4.974607e-01 1 1  ON 25
 eO_6                 2.675451e-01 1 1  ON 26
 eO_7                -4.320948e-02 1 1  ON 27
 eO_8                -2.436970e-01 1 1  ON 28
 eO_9                -1.178874e-01 1 1  ON 29
eH1_0                -2.674706e-01 1 1  ON 30
eH1_1                -1.614996e-01 1 1  ON 31
eH1_2                -1.121518e-01 1 1  ON 32
eH1_3                -5.639017e-02 1 1  ON 33
eH1_4                -6.384381e-03 1 1  ON 34
eH1_5                 3.011888e-02 1 1  ON 35
eH1_6                 9.383524e-02 1 1  ON 36
eH1_7                 1.614846e-01 1 1  ON 37
eH1_8                 2.037533e-01 1 1  ON 38
eH1_9                 1.123698e-01 1 1  ON 39
eH2_0                -2.648322e-01 1 1  ON 40
eH2_1                -1.588985e-01 1 1  ON 41
eH2_2                -1.095511e-01 1 1  ON 42
eH2_3                -5.387130e-02 1 1  ON 43
eH2_4                -3.726254e-03 1 1  ON 44
eH2_5                 3.404811e-02 1 1  ON 45
eH2_6                 9.728190e-02 1 1  ON 46
eH2_7                 1.616981e-01 1 1  ON 47
eH2_8                 2.046615e-01 1 1  ON 48
eH2_9                 1.032725e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.8991
    reference variance = 0.256773
====================================================
  Execution time = 2.0278e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4678e-01
  Total weights = 2.0000e+06
  Execution time = 2.2991e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346872697553
                                         uncertainty =       0.008074980818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346872697553
                                         uncertainty =       0.008074980818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416413876
  error estimate for blocks of size 2^( 2) =       0.000428477792
  error estimate for blocks of size 2^( 3) =       0.000440842530
  error estimate for blocks of size 2^( 4) =       0.000451948167
  error estimate for blocks of size 2^( 5) =       0.000460741695
  error estimate for blocks of size 2^( 6) =       0.000468407415
  error estimate for blocks of size 2^( 7) =       0.000471644908

      target function =                  N/A
              le_mean =     -16.906663482006
             les_mean =     286.182070952676
             stat err =       0.000463185546
             autocorr =       1.237256122351
              std dev =       0.588898151021
             le_variance =       0.346801032277

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346802651609
                                         uncertainty =       0.008074227326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346802651609
                                         uncertainty =       0.008074227326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416371814
  error estimate for blocks of size 2^( 2) =       0.000428438230
  error estimate for blocks of size 2^( 3) =       0.000440805355
  error estimate for blocks of size 2^( 4) =       0.000451912925
  error estimate for blocks of size 2^( 5) =       0.000460706738
  error estimate for blocks of size 2^( 6) =       0.000468373321
  error estimate for blocks of size 2^( 7) =       0.000471612130

      target function =                  N/A
              le_mean =     -16.906663550740
             les_mean =     286.182003219018
             stat err =       0.000463151279
             autocorr =       1.237323012328
              std dev =       0.588838665916
             le_variance =       0.346730974478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346829898108
                                         uncertainty =       0.008074528693

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346829898108
                                         uncertainty =       0.008074528693

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416388176
  error estimate for blocks of size 2^( 2) =       0.000428453599
  error estimate for blocks of size 2^( 3) =       0.000440819705
  error estimate for blocks of size 2^( 4) =       0.000451926556
  error estimate for blocks of size 2^( 5) =       0.000460720287
  error estimate for blocks of size 2^( 6) =       0.000468386497
  error estimate for blocks of size 2^( 7) =       0.000471624866

      target function =                  N/A
              le_mean =     -16.906663536003
             les_mean =     286.182029971895
             stat err =       0.000463164552
             autocorr =       1.237296686593
              std dev =       0.588861805236
             le_variance =       0.346758225666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346867101061
                                         uncertainty =       0.008074922224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346867101061
                                         uncertainty =       0.008074922224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416410516
  error estimate for blocks of size 2^( 2) =       0.000428474629
  error estimate for blocks of size 2^( 3) =       0.000440839546
  error estimate for blocks of size 2^( 4) =       0.000451945341
  error estimate for blocks of size 2^( 5) =       0.000460738896
  error estimate for blocks of size 2^( 6) =       0.000468404681
  error estimate for blocks of size 2^( 7) =       0.000471642287

      target function =                  N/A
              le_mean =     -16.906663489061
             les_mean =     286.182065593810
             stat err =       0.000463182801
             autocorr =       1.237261428051
              std dev =       0.588893398565
             le_variance =       0.346795434873


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906663482006        initial
     1.5625e+00     1.5625e+01             9.6498e-05       -16.906663550740  <--
     6.2500e+00     6.2500e+01             2.3114e-05       -16.906663536003
     2.5000e+01     2.5000e+02             5.8072e-06       -16.906663489061

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 3.0934e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.119055e-01 1 1  ON 0
 uu_1                 1.442940e-01 1 1  ON 1
 uu_2                 4.230003e-02 1 1  ON 2
 uu_3                -2.087630e-02 1 1  ON 3
 uu_4                -6.732739e-02 1 1  ON 4
 uu_5                -1.038040e-01 1 1  ON 5
 uu_6                -1.331295e-01 1 1  ON 6
 uu_7                -1.491570e-01 1 1  ON 7
 uu_8                -1.430896e-01 1 1  ON 8
 uu_9                -1.126250e-01 1 1  ON 9
 ud_0                 4.542894e-01 1 1  ON 10
 ud_1                 1.882719e-01 1 1  ON 11
 ud_2                 6.729718e-02 1 1  ON 12
 ud_3                -4.364340e-03 1 1  ON 13
 ud_4                -6.206573e-02 1 1  ON 14
 ud_5                -1.047549e-01 1 1  ON 15
 ud_6                -1.333963e-01 1 1  ON 16
 ud_7                -1.510951e-01 1 1  ON 17
 ud_8                -1.524671e-01 1 1  ON 18
 ud_9                -1.435173e-01 1 1  ON 19
 eO_0                -7.495920e-01 1 1  ON 20
 eO_1                -4.277606e-01 1 1  ON 21
 eO_2                -1.239834e-02 1 1  ON 22
 eO_3                 3.047001e-01 1 1  ON 23
 eO_4                 5.328964e-01 1 1  ON 24
 eO_5                 4.974847e-01 1 1  ON 25
 eO_6                 2.675522e-01 1 1  ON 26
 eO_7                -4.321294e-02 1 1  ON 27
 eO_8                -2.437316e-01 1 1  ON 28
 eO_9                -1.179490e-01 1 1  ON 29
eH1_0                -2.674795e-01 1 1  ON 30
eH1_1                -1.615353e-01 1 1  ON 31
eH1_2                -1.121525e-01 1 1  ON 32
eH1_3                -5.642411e-02 1 1  ON 33
eH1_4                -6.430253e-03 1 1  ON 34
eH1_5                 3.009592e-02 1 1  ON 35
eH1_6                 9.382014e-02 1 1  ON 36
eH1_7                 1.615102e-01 1 1  ON 37
eH1_8                 2.038114e-01 1 1  ON 38
eH1_9                 1.124388e-01 1 1  ON 39
eH2_0                -2.648497e-01 1 1  ON 40
eH2_1                -1.589166e-01 1 1  ON 41
eH2_2                -1.095426e-01 1 1  ON 42
eH2_3                -5.390851e-02 1 1  ON 43
eH2_4                -3.726712e-03 1 1  ON 44
eH2_5                 3.403726e-02 1 1  ON 45
eH2_6                 9.726413e-02 1 1  ON 46
eH2_7                 1.616898e-01 1 1  ON 47
eH2_8                 2.046810e-01 1 1  ON 48
eH2_9                 1.033458e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6847e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6879e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9295
    reference variance = 0.308718
====================================================
  Execution time = 2.0346e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4210e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342172145862
                                         uncertainty =       0.006798187850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342172145862
                                         uncertainty =       0.006798187850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413583628
  error estimate for blocks of size 2^( 2) =       0.000426489639
  error estimate for blocks of size 2^( 3) =       0.000439272828
  error estimate for blocks of size 2^( 4) =       0.000450612907
  error estimate for blocks of size 2^( 5) =       0.000461225135
  error estimate for blocks of size 2^( 6) =       0.000469805222
  error estimate for blocks of size 2^( 7) =       0.000474542913

      target function =                  N/A
              le_mean =     -16.906530164986
             les_mean =     286.172864883224
             stat err =       0.000464046544
             autocorr =       1.258915000260
              std dev =       0.584895575903
             le_variance =       0.342102834711


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653016499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906530164986       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906531566293       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906531419646       residual = 9.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906531367446       residual = 9.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906531625978       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906531368794       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906531453320       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906531617093       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906531733107       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.979267e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906530164986       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906530614358       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906530547047       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906530564321       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906530650010       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906530564022       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906530506418       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906530534470       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.207547e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906530164986       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906530285873       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906530265938       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906530273769       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906530296777       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906530274332       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906530251927       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906530257680       residual = 3.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 3.295694e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120883 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6008e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.118313e-01 1 1  ON 0
 uu_1                 1.444083e-01 1 1  ON 1
 uu_2                 4.230898e-02 1 1  ON 2
 uu_3                -2.082777e-02 1 1  ON 3
 uu_4                -6.732370e-02 1 1  ON 4
 uu_5                -1.038353e-01 1 1  ON 5
 uu_6                -1.331738e-01 1 1  ON 6
 uu_7                -1.491983e-01 1 1  ON 7
 uu_8                -1.430538e-01 1 1  ON 8
 uu_9                -1.126466e-01 1 1  ON 9
 ud_0                 4.543298e-01 1 1  ON 10
 ud_1                 1.883031e-01 1 1  ON 11
 ud_2                 6.730945e-02 1 1  ON 12
 ud_3                -4.307213e-03 1 1  ON 13
 ud_4                -6.209336e-02 1 1  ON 14
 ud_5                -1.047401e-01 1 1  ON 15
 ud_6                -1.333253e-01 1 1  ON 16
 ud_7                -1.510592e-01 1 1  ON 17
 ud_8                -1.524815e-01 1 1  ON 18
 ud_9                -1.435964e-01 1 1  ON 19
 eO_0                -7.495373e-01 1 1  ON 20
 eO_1                -4.276776e-01 1 1  ON 21
 eO_2                -1.238788e-02 1 1  ON 22
 eO_3                 3.047125e-01 1 1  ON 23
 eO_4                 5.329375e-01 1 1  ON 24
 eO_5                 4.974810e-01 1 1  ON 25
 eO_6                 2.675560e-01 1 1  ON 26
 eO_7                -4.323096e-02 1 1  ON 27
 eO_8                -2.437950e-01 1 1  ON 28
 eO_9                -1.180436e-01 1 1  ON 29
eH1_0                -2.675344e-01 1 1  ON 30
eH1_1                -1.615604e-01 1 1  ON 31
eH1_2                -1.121417e-01 1 1  ON 32
eH1_3                -5.647429e-02 1 1  ON 33
eH1_4                -6.378221e-03 1 1  ON 34
eH1_5                 3.011340e-02 1 1  ON 35
eH1_6                 9.382413e-02 1 1  ON 36
eH1_7                 1.614858e-01 1 1  ON 37
eH1_8                 2.038195e-01 1 1  ON 38
eH1_9                 1.125021e-01 1 1  ON 39
eH2_0                -2.649025e-01 1 1  ON 40
eH2_1                -1.589548e-01 1 1  ON 41
eH2_2                -1.095654e-01 1 1  ON 42
eH2_3                -5.396317e-02 1 1  ON 43
eH2_4                -3.697679e-03 1 1  ON 44
eH2_5                 3.402280e-02 1 1  ON 45
eH2_6                 9.726153e-02 1 1  ON 46
eH2_7                 1.616732e-01 1 1  ON 47
eH2_8                 2.046997e-01 1 1  ON 48
eH2_9                 1.034666e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9244
    reference variance = 0.23026
====================================================
  Execution time = 1.9967e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4344e-01
  Total weights = 2.0000e+06
  Execution time = 1.8841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343500818655
                                         uncertainty =       0.008722207771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343500818655
                                         uncertainty =       0.008722207771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414383002
  error estimate for blocks of size 2^( 2) =       0.000427079762
  error estimate for blocks of size 2^( 3) =       0.000438917151
  error estimate for blocks of size 2^( 4) =       0.000449954099
  error estimate for blocks of size 2^( 5) =       0.000459063884
  error estimate for blocks of size 2^( 6) =       0.000465523515
  error estimate for blocks of size 2^( 7) =       0.000470290931

      target function =                  N/A
              le_mean =     -16.905807652215
             les_mean =     286.149758745964
             stat err =       0.000461208107
             autocorr =       1.238768068576
              std dev =       0.586026060828
             le_variance =       0.343426543970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343514570950
                                         uncertainty =       0.008728325567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343514570950
                                         uncertainty =       0.008728325567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414391234
  error estimate for blocks of size 2^( 2) =       0.000427084468
  error estimate for blocks of size 2^( 3) =       0.000438918614
  error estimate for blocks of size 2^( 4) =       0.000449951463
  error estimate for blocks of size 2^( 5) =       0.000459060938
  error estimate for blocks of size 2^( 6) =       0.000465521291
  error estimate for blocks of size 2^( 7) =       0.000470292187

      target function =                  N/A
              le_mean =     -16.905805940740
             les_mean =     286.149714523388
             stat err =       0.000461206470
             autocorr =       1.238710053793
              std dev =       0.586037702835
             le_variance =       0.343440189144

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343524809241
                                         uncertainty =       0.008727041530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343524809241
                                         uncertainty =       0.008727041530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414397416
  error estimate for blocks of size 2^( 2) =       0.000427091376
  error estimate for blocks of size 2^( 3) =       0.000438926448
  error estimate for blocks of size 2^( 4) =       0.000449960027
  error estimate for blocks of size 2^( 5) =       0.000459068827
  error estimate for blocks of size 2^( 6) =       0.000465528481
  error estimate for blocks of size 2^( 7) =       0.000470299122

      target function =                  N/A
              le_mean =     -16.905805953466
             les_mean =     286.149725201919
             stat err =       0.000461214114
             autocorr =       1.238714154410
              std dev =       0.586046446450
             le_variance =       0.343450437397

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343505187973
                                         uncertainty =       0.008722959658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343505187973
                                         uncertainty =       0.008722959658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414385629
  error estimate for blocks of size 2^( 2) =       0.000427081964
  error estimate for blocks of size 2^( 3) =       0.000438918999
  error estimate for blocks of size 2^( 4) =       0.000449955426
  error estimate for blocks of size 2^( 5) =       0.000459065010
  error estimate for blocks of size 2^( 6) =       0.000465524596
  error estimate for blocks of size 2^( 7) =       0.000470292542

      target function =                  N/A
              le_mean =     -16.905807356451
             les_mean =     286.149753100398
             stat err =       0.000461209393
             autocorr =       1.238759268739
              std dev =       0.586029776263
             le_variance =       0.343430898667


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905807652215        initial  <--
     3.9062e-01     3.9062e+00             4.9793e-04       -16.905805940740
     1.5625e+00     1.5625e+01             1.2075e-04       -16.905805953466
     6.2500e+00     6.2500e+01             3.2957e-05       -16.905807356451

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4953
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.119055e-01 1 1  ON 0
 uu_1                 1.442940e-01 1 1  ON 1
 uu_2                 4.230003e-02 1 1  ON 2
 uu_3                -2.087630e-02 1 1  ON 3
 uu_4                -6.732739e-02 1 1  ON 4
 uu_5                -1.038040e-01 1 1  ON 5
 uu_6                -1.331295e-01 1 1  ON 6
 uu_7                -1.491570e-01 1 1  ON 7
 uu_8                -1.430896e-01 1 1  ON 8
 uu_9                -1.126250e-01 1 1  ON 9
 ud_0                 4.542894e-01 1 1  ON 10
 ud_1                 1.882719e-01 1 1  ON 11
 ud_2                 6.729718e-02 1 1  ON 12
 ud_3                -4.364340e-03 1 1  ON 13
 ud_4                -6.206573e-02 1 1  ON 14
 ud_5                -1.047549e-01 1 1  ON 15
 ud_6                -1.333963e-01 1 1  ON 16
 ud_7                -1.510951e-01 1 1  ON 17
 ud_8                -1.524671e-01 1 1  ON 18
 ud_9                -1.435173e-01 1 1  ON 19
 eO_0                -7.495920e-01 1 1  ON 20
 eO_1                -4.277606e-01 1 1  ON 21
 eO_2                -1.239834e-02 1 1  ON 22
 eO_3                 3.047001e-01 1 1  ON 23
 eO_4                 5.328964e-01 1 1  ON 24
 eO_5                 4.974847e-01 1 1  ON 25
 eO_6                 2.675522e-01 1 1  ON 26
 eO_7                -4.321294e-02 1 1  ON 27
 eO_8                -2.437316e-01 1 1  ON 28
 eO_9                -1.179490e-01 1 1  ON 29
eH1_0                -2.674795e-01 1 1  ON 30
eH1_1                -1.615353e-01 1 1  ON 31
eH1_2                -1.121525e-01 1 1  ON 32
eH1_3                -5.642411e-02 1 1  ON 33
eH1_4                -6.430253e-03 1 1  ON 34
eH1_5                 3.009592e-02 1 1  ON 35
eH1_6                 9.382014e-02 1 1  ON 36
eH1_7                 1.615102e-01 1 1  ON 37
eH1_8                 2.038114e-01 1 1  ON 38
eH1_9                 1.124388e-01 1 1  ON 39
eH2_0                -2.648497e-01 1 1  ON 40
eH2_1                -1.589166e-01 1 1  ON 41
eH2_2                -1.095426e-01 1 1  ON 42
eH2_3                -5.390851e-02 1 1  ON 43
eH2_4                -3.726712e-03 1 1  ON 44
eH2_5                 3.403726e-02 1 1  ON 45
eH2_6                 9.726413e-02 1 1  ON 46
eH2_7                 1.616898e-01 1 1  ON 47
eH2_8                 2.046810e-01 1 1  ON 48
eH2_9                 1.033458e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5510e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6887e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8853
    reference variance = 0.331386
====================================================
  Execution time = 2.0460e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4452e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344578208107
                                         uncertainty =       0.006035922479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344578208107
                                         uncertainty =       0.006035922479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415044550
  error estimate for blocks of size 2^( 2) =       0.000427447094
  error estimate for blocks of size 2^( 3) =       0.000440008862
  error estimate for blocks of size 2^( 4) =       0.000451214342
  error estimate for blocks of size 2^( 5) =       0.000460852162
  error estimate for blocks of size 2^( 6) =       0.000465768859
  error estimate for blocks of size 2^( 7) =       0.000469980347

      target function =                  N/A
              le_mean =     -16.905657612100
             les_mean =     286.145783081500
             stat err =       0.000461953927
             autocorr =       1.238819113936
              std dev =       0.586961630953
             le_variance =       0.344523956211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690565761210e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905657612100       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905657589907       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905657678912       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905657609066       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905657655794       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905657602278       residual = 7.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905657603833       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905657606660       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.145386e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905657612100       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905657606360       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905657627255       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905657611744       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905657624664       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905657609573       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905657607957       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.230386e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905657612100       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905657610652       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905657615776       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905657612071       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905657615357       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905657611469       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905657610932       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.085437e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.123251 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6022e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.119012e-01 1 1  ON 0
 uu_1                 1.442976e-01 1 1  ON 1
 uu_2                 4.230010e-02 1 1  ON 2
 uu_3                -2.087510e-02 1 1  ON 3
 uu_4                -6.732761e-02 1 1  ON 4
 uu_5                -1.038093e-01 1 1  ON 5
 uu_6                -1.331300e-01 1 1  ON 6
 uu_7                -1.491525e-01 1 1  ON 7
 uu_8                -1.430927e-01 1 1  ON 8
 uu_9                -1.126290e-01 1 1  ON 9
 ud_0                 4.542992e-01 1 1  ON 10
 ud_1                 1.882725e-01 1 1  ON 11
 ud_2                 6.729745e-02 1 1  ON 12
 ud_3                -4.365283e-03 1 1  ON 13
 ud_4                -6.207117e-02 1 1  ON 14
 ud_5                -1.047523e-01 1 1  ON 15
 ud_6                -1.333912e-01 1 1  ON 16
 ud_7                -1.511012e-01 1 1  ON 17
 ud_8                -1.524741e-01 1 1  ON 18
 ud_9                -1.435155e-01 1 1  ON 19
 eO_0                -7.495804e-01 1 1  ON 20
 eO_1                -4.277615e-01 1 1  ON 21
 eO_2                -1.239497e-02 1 1  ON 22
 eO_3                 3.047031e-01 1 1  ON 23
 eO_4                 5.328949e-01 1 1  ON 24
 eO_5                 4.974811e-01 1 1  ON 25
 eO_6                 2.675517e-01 1 1  ON 26
 eO_7                -4.321029e-02 1 1  ON 27
 eO_8                -2.437382e-01 1 1  ON 28
 eO_9                -1.179559e-01 1 1  ON 29
eH1_0                -2.674830e-01 1 1  ON 30
eH1_1                -1.615370e-01 1 1  ON 31
eH1_2                -1.121515e-01 1 1  ON 32
eH1_3                -5.643046e-02 1 1  ON 33
eH1_4                -6.427084e-03 1 1  ON 34
eH1_5                 3.009879e-02 1 1  ON 35
eH1_6                 9.381397e-02 1 1  ON 36
eH1_7                 1.615070e-01 1 1  ON 37
eH1_8                 2.038141e-01 1 1  ON 38
eH1_9                 1.124482e-01 1 1  ON 39
eH2_0                -2.648525e-01 1 1  ON 40
eH2_1                -1.589235e-01 1 1  ON 41
eH2_2                -1.095474e-01 1 1  ON 42
eH2_3                -5.391200e-02 1 1  ON 43
eH2_4                -3.722098e-03 1 1  ON 44
eH2_5                 3.403699e-02 1 1  ON 45
eH2_6                 9.725804e-02 1 1  ON 46
eH2_7                 1.616871e-01 1 1  ON 47
eH2_8                 2.046873e-01 1 1  ON 48
eH2_9                 1.033581e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9174
    reference variance = 0.217579
====================================================
  Execution time = 1.9860e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5627e-01
  Total weights = 2.0000e+06
  Execution time = 1.8819e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356322892855
                                         uncertainty =       0.013038932255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356322892855
                                         uncertainty =       0.013038932255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422059297
  error estimate for blocks of size 2^( 2) =       0.000434754628
  error estimate for blocks of size 2^( 3) =       0.000447395835
  error estimate for blocks of size 2^( 4) =       0.000458723555
  error estimate for blocks of size 2^( 5) =       0.000469726058
  error estimate for blocks of size 2^( 6) =       0.000476901685
  error estimate for blocks of size 2^( 7) =       0.000481904326

      target function =                  N/A
              le_mean =     -16.905566065564
             les_mean =     286.154431919319
             stat err =       0.000471813906
             autocorr =       1.249667662260
              std dev =       0.596881981875
             le_variance =       0.356268100287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356346758840
                                         uncertainty =       0.013039360256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356346758840
                                         uncertainty =       0.013039360256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422073431
  error estimate for blocks of size 2^( 2) =       0.000434767737
  error estimate for blocks of size 2^( 3) =       0.000447407869
  error estimate for blocks of size 2^( 4) =       0.000458735171
  error estimate for blocks of size 2^( 5) =       0.000469737139
  error estimate for blocks of size 2^( 6) =       0.000476911950
  error estimate for blocks of size 2^( 7) =       0.000481916607

      target function =                  N/A
              le_mean =     -16.905566218586
             les_mean =     286.154460955142
             stat err =       0.000471825217
             autocorr =       1.249643880676
              std dev =       0.596901970421
             le_variance =       0.356291962293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356336303168
                                         uncertainty =       0.013039151305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356336303168
                                         uncertainty =       0.013039151305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422067239
  error estimate for blocks of size 2^( 2) =       0.000434762014
  error estimate for blocks of size 2^( 3) =       0.000447402644
  error estimate for blocks of size 2^( 4) =       0.000458730125
  error estimate for blocks of size 2^( 5) =       0.000469732321
  error estimate for blocks of size 2^( 6) =       0.000476907470
  error estimate for blocks of size 2^( 7) =       0.000481911170

      target function =                  N/A
              le_mean =     -16.905566148996
             les_mean =     286.154448148078
             stat err =       0.000471820272
             autocorr =       1.249654352821
              std dev =       0.596893213352
             le_variance =       0.356281508145

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356324605876
                                         uncertainty =       0.013038960272

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.356324605876
                                         uncertainty =       0.013038960272

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422060311
  error estimate for blocks of size 2^( 2) =       0.000434755572
  error estimate for blocks of size 2^( 3) =       0.000447396706
  error estimate for blocks of size 2^( 4) =       0.000458724395
  error estimate for blocks of size 2^( 5) =       0.000469726859
  error estimate for blocks of size 2^( 6) =       0.000476902425
  error estimate for blocks of size 2^( 7) =       0.000481905200

      target function =                  N/A
              le_mean =     -16.905566075857
             les_mean =     286.154433980030
             stat err =       0.000471814719
             autocorr =       1.249665963106
              std dev =       0.596883416585
             le_variance =       0.356269812994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905566065564        initial
     3.9062e+00     3.9062e+01             5.1454e-05       -16.905566218586  <--
     1.5625e+01     1.5625e+02             1.2304e-05       -16.905566148996
     6.2500e+01     6.2500e+02             3.0854e-06       -16.905566075857

*****************************************************************************
Applying the update for shift_i =   3.9062e+00     and shift_s =   3.9062e+01
*****************************************************************************

  Execution time = 2.9390e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.118882e-01 1 1  ON 0
 uu_1                 1.443066e-01 1 1  ON 1
 uu_2                 4.230090e-02 1 1  ON 2
 uu_3                -2.087235e-02 1 1  ON 3
 uu_4                -6.732956e-02 1 1  ON 4
 uu_5                -1.038223e-01 1 1  ON 5
 uu_6                -1.331311e-01 1 1  ON 6
 uu_7                -1.491396e-01 1 1  ON 7
 uu_8                -1.431021e-01 1 1  ON 8
 uu_9                -1.126412e-01 1 1  ON 9
 ud_0                 4.543252e-01 1 1  ON 10
 ud_1                 1.882747e-01 1 1  ON 11
 ud_2                 6.729816e-02 1 1  ON 12
 ud_3                -4.367249e-03 1 1  ON 13
 ud_4                -6.208469e-02 1 1  ON 14
 ud_5                -1.047452e-01 1 1  ON 15
 ud_6                -1.333766e-01 1 1  ON 16
 ud_7                -1.511191e-01 1 1  ON 17
 ud_8                -1.524951e-01 1 1  ON 18
 ud_9                -1.435097e-01 1 1  ON 19
 eO_0                -7.495476e-01 1 1  ON 20
 eO_1                -4.277608e-01 1 1  ON 21
 eO_2                -1.238433e-02 1 1  ON 22
 eO_3                 3.047113e-01 1 1  ON 23
 eO_4                 5.328912e-01 1 1  ON 24
 eO_5                 4.974706e-01 1 1  ON 25
 eO_6                 2.675499e-01 1 1  ON 26
 eO_7                -4.320181e-02 1 1  ON 27
 eO_8                -2.437589e-01 1 1  ON 28
 eO_9                -1.179778e-01 1 1  ON 29
eH1_0                -2.674935e-01 1 1  ON 30
eH1_1                -1.615406e-01 1 1  ON 31
eH1_2                -1.121481e-01 1 1  ON 32
eH1_3                -5.644924e-02 1 1  ON 33
eH1_4                -6.421836e-03 1 1  ON 34
eH1_5                 3.010667e-02 1 1  ON 35
eH1_6                 9.379577e-02 1 1  ON 36
eH1_7                 1.614975e-01 1 1  ON 37
eH1_8                 2.038225e-01 1 1  ON 38
eH1_9                 1.124783e-01 1 1  ON 39
eH2_0                -2.648614e-01 1 1  ON 40
eH2_1                -1.589441e-01 1 1  ON 41
eH2_2                -1.095634e-01 1 1  ON 42
eH2_3                -5.392195e-02 1 1  ON 43
eH2_4                -3.709444e-03 1 1  ON 44
eH2_5                 3.403614e-02 1 1  ON 45
eH2_6                 9.723948e-02 1 1  ON 46
eH2_7                 1.616785e-01 1 1  ON 47
eH2_8                 2.047074e-01 1 1  ON 48
eH2_9                 1.033973e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5420e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6889e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9197
    reference variance = 0.299964
====================================================
  Execution time = 2.0183e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3939e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5237e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339466967790
                                         uncertainty =       0.005580145122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339466967790
                                         uncertainty =       0.005580145122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411941139
  error estimate for blocks of size 2^( 2) =       0.000424699888
  error estimate for blocks of size 2^( 3) =       0.000437936641
  error estimate for blocks of size 2^( 4) =       0.000449174322
  error estimate for blocks of size 2^( 5) =       0.000458008812
  error estimate for blocks of size 2^( 6) =       0.000466871111
  error estimate for blocks of size 2^( 7) =       0.000471138291

      target function =                  N/A
              le_mean =     -16.906043386091
             les_mean =     286.153693805902
             stat err =       0.000461298134
             autocorr =       1.253987091473
              std dev =       0.582572744990
             le_variance =       0.339391003205


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690604338609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906043386091       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906043326832       residual = 8.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906043684570       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906043876437       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906043874261       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043921756       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906043942780       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906043964102       residual = 5.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.427264e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906043386091       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906043369159       residual = 8.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906043477117       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906043521148       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906043531294       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043527204       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906043533138       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 3.461689e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906043386091       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906043381701       residual = 9.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906043410034       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906043420839       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906043423525       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906043422365       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906043423394       residual = 8.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 8.728734e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5714e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.119080e-01 1 1  ON 0
 uu_1                 1.443270e-01 1 1  ON 1
 uu_2                 4.229553e-02 1 1  ON 2
 uu_3                -2.088542e-02 1 1  ON 3
 uu_4                -6.734003e-02 1 1  ON 4
 uu_5                -1.038318e-01 1 1  ON 5
 uu_6                -1.331478e-01 1 1  ON 6
 uu_7                -1.491549e-01 1 1  ON 7
 uu_8                -1.431070e-01 1 1  ON 8
 uu_9                -1.126455e-01 1 1  ON 9
 ud_0                 4.543470e-01 1 1  ON 10
 ud_1                 1.882786e-01 1 1  ON 11
 ud_2                 6.730737e-02 1 1  ON 12
 ud_3                -4.372794e-03 1 1  ON 13
 ud_4                -6.208346e-02 1 1  ON 14
 ud_5                -1.047337e-01 1 1  ON 15
 ud_6                -1.333843e-01 1 1  ON 16
 ud_7                -1.511320e-01 1 1  ON 17
 ud_8                -1.524957e-01 1 1  ON 18
 ud_9                -1.435243e-01 1 1  ON 19
 eO_0                -7.495326e-01 1 1  ON 20
 eO_1                -4.277608e-01 1 1  ON 21
 eO_2                -1.235996e-02 1 1  ON 22
 eO_3                 3.047125e-01 1 1  ON 23
 eO_4                 5.329056e-01 1 1  ON 24
 eO_5                 4.974665e-01 1 1  ON 25
 eO_6                 2.675464e-01 1 1  ON 26
 eO_7                -4.320231e-02 1 1  ON 27
 eO_8                -2.437756e-01 1 1  ON 28
 eO_9                -1.180053e-01 1 1  ON 29
eH1_0                -2.675121e-01 1 1  ON 30
eH1_1                -1.615680e-01 1 1  ON 31
eH1_2                -1.121792e-01 1 1  ON 32
eH1_3                -5.648103e-02 1 1  ON 33
eH1_4                -6.432644e-03 1 1  ON 34
eH1_5                 3.011278e-02 1 1  ON 35
eH1_6                 9.382790e-02 1 1  ON 36
eH1_7                 1.615193e-01 1 1  ON 37
eH1_8                 2.038414e-01 1 1  ON 38
eH1_9                 1.125115e-01 1 1  ON 39
eH2_0                -2.648691e-01 1 1  ON 40
eH2_1                -1.589218e-01 1 1  ON 41
eH2_2                -1.095734e-01 1 1  ON 42
eH2_3                -5.393181e-02 1 1  ON 43
eH2_4                -3.709355e-03 1 1  ON 44
eH2_5                 3.402541e-02 1 1  ON 45
eH2_6                 9.723493e-02 1 1  ON 46
eH2_7                 1.616622e-01 1 1  ON 47
eH2_8                 2.047055e-01 1 1  ON 48
eH2_9                 1.034319e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8963
    reference variance = 0.294157
====================================================
  Execution time = 2.0259e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3665e-01
  Total weights = 2.0000e+06
  Execution time = 1.8733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336660134306
                                         uncertainty =       0.003573479718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336660134306
                                         uncertainty =       0.003573479718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410255421
  error estimate for blocks of size 2^( 2) =       0.000423192415
  error estimate for blocks of size 2^( 3) =       0.000436077847
  error estimate for blocks of size 2^( 4) =       0.000448959008
  error estimate for blocks of size 2^( 5) =       0.000461436553
  error estimate for blocks of size 2^( 6) =       0.000470739662
  error estimate for blocks of size 2^( 7) =       0.000477830750

      target function =                  N/A
              le_mean =     -16.906012203619
             les_mean =     286.149867481048
             stat err =       0.000464741493
             autocorr =       1.283258771286
              std dev =       0.580188779996
             le_variance =       0.336619020433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336744691768
                                         uncertainty =       0.003574392607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336744691768
                                         uncertainty =       0.003574392607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410306965
  error estimate for blocks of size 2^( 2) =       0.000423240461
  error estimate for blocks of size 2^( 3) =       0.000436122155
  error estimate for blocks of size 2^( 4) =       0.000448999869
  error estimate for blocks of size 2^( 5) =       0.000461476355
  error estimate for blocks of size 2^( 6) =       0.000470779249
  error estimate for blocks of size 2^( 7) =       0.000477870324

      target function =                  N/A
              le_mean =     -16.906012499946
             les_mean =     286.149962090248
             stat err =       0.000464781449
             autocorr =       1.283156990813
              std dev =       0.580261673949
             le_variance =       0.336703610254

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714019021
                                         uncertainty =       0.003574019475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336714019021
                                         uncertainty =       0.003574019475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410288270
  error estimate for blocks of size 2^( 2) =       0.000423223116
  error estimate for blocks of size 2^( 3) =       0.000436106334
  error estimate for blocks of size 2^( 4) =       0.000448985478
  error estimate for blocks of size 2^( 5) =       0.000461462382
  error estimate for blocks of size 2^( 6) =       0.000470765177
  error estimate for blocks of size 2^( 7) =       0.000477855906

      target function =                  N/A
              le_mean =     -16.906012318277
             les_mean =     286.149925266086
             stat err =       0.000464767236
             autocorr =       1.283195441436
              std dev =       0.580235235650
             le_variance =       0.336672928689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336667156002
                                         uncertainty =       0.003573549443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336667156002
                                         uncertainty =       0.003573549443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410259701
  error estimate for blocks of size 2^( 2) =       0.000423196415
  error estimate for blocks of size 2^( 3) =       0.000436081560
  error estimate for blocks of size 2^( 4) =       0.000448962459
  error estimate for blocks of size 2^( 5) =       0.000461439920
  error estimate for blocks of size 2^( 6) =       0.000470742981
  error estimate for blocks of size 2^( 7) =       0.000477834016

      target function =                  N/A
              le_mean =     -16.906012215827
             les_mean =     286.149874918641
             stat err =       0.000464744844
             autocorr =       1.283250497105
              std dev =       0.580194833894
             le_variance =       0.336626045277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906012203619        initial
     9.7656e-01     9.7656e+00             1.4273e-04       -16.906012499946  <--
     3.9062e+00     3.9062e+01             3.4617e-05       -16.906012318277
     1.5625e+01     1.5625e+02             8.7287e-06       -16.906012215827

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.9742e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.119623e-01 1 1  ON 0
 uu_1                 1.443643e-01 1 1  ON 1
 uu_2                 4.229117e-02 1 1  ON 2
 uu_3                -2.091811e-02 1 1  ON 3
 uu_4                -6.736846e-02 1 1  ON 4
 uu_5                -1.038585e-01 1 1  ON 5
 uu_6                -1.331930e-01 1 1  ON 6
 uu_7                -1.492008e-01 1 1  ON 7
 uu_8                -1.431237e-01 1 1  ON 8
 uu_9                -1.126594e-01 1 1  ON 9
 ud_0                 4.543964e-01 1 1  ON 10
 ud_1                 1.882974e-01 1 1  ON 11
 ud_2                 6.733155e-02 1 1  ON 12
 ud_3                -4.383477e-03 1 1  ON 13
 ud_4                -6.207305e-02 1 1  ON 14
 ud_5                -1.047046e-01 1 1  ON 15
 ud_6                -1.333994e-01 1 1  ON 16
 ud_7                -1.511688e-01 1 1  ON 17
 ud_8                -1.524997e-01 1 1  ON 18
 ud_9                -1.435702e-01 1 1  ON 19
 eO_0                -7.494972e-01 1 1  ON 20
 eO_1                -4.277418e-01 1 1  ON 21
 eO_2                -1.229591e-02 1 1  ON 22
 eO_3                 3.047181e-01 1 1  ON 23
 eO_4                 5.329503e-01 1 1  ON 24
 eO_5                 4.974562e-01 1 1  ON 25
 eO_6                 2.675374e-01 1 1  ON 26
 eO_7                -4.320449e-02 1 1  ON 27
 eO_8                -2.438282e-01 1 1  ON 28
 eO_9                -1.180916e-01 1 1  ON 29
eH1_0                -2.675756e-01 1 1  ON 30
eH1_1                -1.616519e-01 1 1  ON 31
eH1_2                -1.122751e-01 1 1  ON 32
eH1_3                -5.656810e-02 1 1  ON 33
eH1_4                -6.465364e-03 1 1  ON 34
eH1_5                 3.012866e-02 1 1  ON 35
eH1_6                 9.392193e-02 1 1  ON 36
eH1_7                 1.615860e-01 1 1  ON 37
eH1_8                 2.039003e-01 1 1  ON 38
eH1_9                 1.126152e-01 1 1  ON 39
eH2_0                -2.648928e-01 1 1  ON 40
eH2_1                -1.588726e-01 1 1  ON 41
eH2_2                -1.095950e-01 1 1  ON 42
eH2_3                -5.395794e-02 1 1  ON 43
eH2_4                -3.715979e-03 1 1  ON 44
eH2_5                 3.399793e-02 1 1  ON 45
eH2_6                 9.722458e-02 1 1  ON 46
eH2_7                 1.616138e-01 1 1  ON 47
eH2_8                 2.046996e-01 1 1  ON 48
eH2_9                 1.035400e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5463e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.8822
    reference variance = 0.216253
====================================================
  Execution time = 2.0666e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3381e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6673e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333730244798
                                         uncertainty =       0.002967409457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333730244798
                                         uncertainty =       0.002967409457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408537380
  error estimate for blocks of size 2^( 2) =       0.000421776574
  error estimate for blocks of size 2^( 3) =       0.000435114161
  error estimate for blocks of size 2^( 4) =       0.000447502061
  error estimate for blocks of size 2^( 5) =       0.000458313038
  error estimate for blocks of size 2^( 6) =       0.000466614015
  error estimate for blocks of size 2^( 7) =       0.000474033254

      target function =                  N/A
              le_mean =     -16.907235053914
             les_mean =     286.188402582560
             stat err =       0.000461615592
             autocorr =       1.276724936285
              std dev =       0.577759103060
             le_variance =       0.333805581168


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690723505391e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907235053914       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907235105428       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907235039793       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907235827546       residual = 5.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907235824922       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907235817246       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907236613395       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907236060435       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.907236014167       residual = 8.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 8.730080e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907235053914       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907235072741       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907234969125       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907235159006       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907235126980       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907235200829       residual = 6.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907235394350       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907235254709       residual = 5.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.191910e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907235053914       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907235059235       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907235017461       residual = 7.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907235045257       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907235030265       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907235054830       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907235106112       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907235081562       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 5.528723e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128466 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6340e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.118405e-01 1 1  ON 0
 uu_1                 1.443973e-01 1 1  ON 1
 uu_2                 4.231897e-02 1 1  ON 2
 uu_3                -2.090593e-02 1 1  ON 3
 uu_4                -6.739043e-02 1 1  ON 4
 uu_5                -1.039299e-01 1 1  ON 5
 uu_6                -1.331817e-01 1 1  ON 6
 uu_7                -1.491920e-01 1 1  ON 7
 uu_8                -1.431284e-01 1 1  ON 8
 uu_9                -1.127083e-01 1 1  ON 9
 ud_0                 4.543566e-01 1 1  ON 10
 ud_1                 1.882416e-01 1 1  ON 11
 ud_2                 6.735681e-02 1 1  ON 12
 ud_3                -4.395919e-03 1 1  ON 13
 ud_4                -6.204725e-02 1 1  ON 14
 ud_5                -1.047174e-01 1 1  ON 15
 ud_6                -1.332656e-01 1 1  ON 16
 ud_7                -1.511995e-01 1 1  ON 17
 ud_8                -1.525643e-01 1 1  ON 18
 ud_9                -1.435702e-01 1 1  ON 19
 eO_0                -7.494518e-01 1 1  ON 20
 eO_1                -4.276221e-01 1 1  ON 21
 eO_2                -1.232435e-02 1 1  ON 22
 eO_3                 3.046676e-01 1 1  ON 23
 eO_4                 5.330112e-01 1 1  ON 24
 eO_5                 4.974209e-01 1 1  ON 25
 eO_6                 2.676252e-01 1 1  ON 26
 eO_7                -4.318042e-02 1 1  ON 27
 eO_8                -2.439011e-01 1 1  ON 28
 eO_9                -1.182209e-01 1 1  ON 29
eH1_0                -2.676255e-01 1 1  ON 30
eH1_1                -1.616905e-01 1 1  ON 31
eH1_2                -1.122882e-01 1 1  ON 32
eH1_3                -5.658359e-02 1 1  ON 33
eH1_4                -6.472264e-03 1 1  ON 34
eH1_5                 3.010491e-02 1 1  ON 35
eH1_6                 9.395136e-02 1 1  ON 36
eH1_7                 1.615473e-01 1 1  ON 37
eH1_8                 2.039401e-01 1 1  ON 38
eH1_9                 1.127394e-01 1 1  ON 39
eH2_0                -2.649345e-01 1 1  ON 40
eH2_1                -1.589034e-01 1 1  ON 41
eH2_2                -1.095663e-01 1 1  ON 42
eH2_3                -5.405160e-02 1 1  ON 43
eH2_4                -3.713498e-03 1 1  ON 44
eH2_5                 3.387082e-02 1 1  ON 45
eH2_6                 9.714274e-02 1 1  ON 46
eH2_7                 1.615861e-01 1 1  ON 47
eH2_8                 2.047918e-01 1 1  ON 48
eH2_9                 1.037592e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9406
    reference variance = 0.37584
====================================================
  Execution time = 1.9997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3658e-01
  Total weights = 2.0000e+06
  Execution time = 1.8719e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336543067898
                                         uncertainty =       0.004203043023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336543067898
                                         uncertainty =       0.004203043023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410275040
  error estimate for blocks of size 2^( 2) =       0.000423158646
  error estimate for blocks of size 2^( 3) =       0.000435683731
  error estimate for blocks of size 2^( 4) =       0.000447375482
  error estimate for blocks of size 2^( 5) =       0.000457345782
  error estimate for blocks of size 2^( 6) =       0.000462806613
  error estimate for blocks of size 2^( 7) =       0.000469213047

      target function =                  N/A
              le_mean =     -16.906898245720
             les_mean =     286.179859339770
             stat err =       0.000459185231
             autocorr =       1.252638134496
              std dev =       0.580216525934
             le_variance =       0.336651216967

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359115299
                                         uncertainty =       0.004207831553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336359115299
                                         uncertainty =       0.004207831553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410162837
  error estimate for blocks of size 2^( 2) =       0.000423049006
  error estimate for blocks of size 2^( 3) =       0.000435578650
  error estimate for blocks of size 2^( 4) =       0.000447275955
  error estimate for blocks of size 2^( 5) =       0.000457251052
  error estimate for blocks of size 2^( 6) =       0.000462720293
  error estimate for blocks of size 2^( 7) =       0.000469125407

      target function =                  N/A
              le_mean =     -16.906897293860
             les_mean =     286.179643043116
             stat err =       0.000459093177
             autocorr =       1.252821099716
              std dev =       0.580057847299
             le_variance =       0.336467106214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336398845820
                                         uncertainty =       0.004207219279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336398845820
                                         uncertainty =       0.004207219279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410187070
  error estimate for blocks of size 2^( 2) =       0.000423073007
  error estimate for blocks of size 2^( 3) =       0.000435602083
  error estimate for blocks of size 2^( 4) =       0.000447298333
  error estimate for blocks of size 2^( 5) =       0.000457272110
  error estimate for blocks of size 2^( 6) =       0.000462739221
  error estimate for blocks of size 2^( 7) =       0.000469146103

      target function =                  N/A
              le_mean =     -16.906897753944
             les_mean =     286.179698359051
             stat err =       0.000459113942
             autocorr =       1.252786396926
              std dev =       0.580092117667
             le_variance =       0.336506864979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336522123386
                                         uncertainty =       0.004203698771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336522123386
                                         uncertainty =       0.004203698771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410262266
  error estimate for blocks of size 2^( 2) =       0.000423146250
  error estimate for blocks of size 2^( 3) =       0.000435671964
  error estimate for blocks of size 2^( 4) =       0.000447364416
  error estimate for blocks of size 2^( 5) =       0.000457335215
  error estimate for blocks of size 2^( 6) =       0.000462796931
  error estimate for blocks of size 2^( 7) =       0.000469203627

      target function =                  N/A
              le_mean =     -16.906898170786
             les_mean =     286.179835842291
             stat err =       0.000459175048
             autocorr =       1.252660580763
              std dev =       0.580198460266
             le_variance =       0.336630253295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906898245720        initial  <--
     2.4414e-01     2.4414e+00             8.7301e-04       -16.906897293860
     9.7656e-01     9.7656e+00             2.1919e-04       -16.906897753944
     3.9062e+00     3.9062e+01             5.5287e-05       -16.906898170786

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4566
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.119623e-01 1 1  ON 0
 uu_1                 1.443643e-01 1 1  ON 1
 uu_2                 4.229117e-02 1 1  ON 2
 uu_3                -2.091811e-02 1 1  ON 3
 uu_4                -6.736846e-02 1 1  ON 4
 uu_5                -1.038585e-01 1 1  ON 5
 uu_6                -1.331930e-01 1 1  ON 6
 uu_7                -1.492008e-01 1 1  ON 7
 uu_8                -1.431237e-01 1 1  ON 8
 uu_9                -1.126594e-01 1 1  ON 9
 ud_0                 4.543964e-01 1 1  ON 10
 ud_1                 1.882974e-01 1 1  ON 11
 ud_2                 6.733155e-02 1 1  ON 12
 ud_3                -4.383477e-03 1 1  ON 13
 ud_4                -6.207305e-02 1 1  ON 14
 ud_5                -1.047046e-01 1 1  ON 15
 ud_6                -1.333994e-01 1 1  ON 16
 ud_7                -1.511688e-01 1 1  ON 17
 ud_8                -1.524997e-01 1 1  ON 18
 ud_9                -1.435702e-01 1 1  ON 19
 eO_0                -7.494972e-01 1 1  ON 20
 eO_1                -4.277418e-01 1 1  ON 21
 eO_2                -1.229591e-02 1 1  ON 22
 eO_3                 3.047181e-01 1 1  ON 23
 eO_4                 5.329503e-01 1 1  ON 24
 eO_5                 4.974562e-01 1 1  ON 25
 eO_6                 2.675374e-01 1 1  ON 26
 eO_7                -4.320449e-02 1 1  ON 27
 eO_8                -2.438282e-01 1 1  ON 28
 eO_9                -1.180916e-01 1 1  ON 29
eH1_0                -2.675756e-01 1 1  ON 30
eH1_1                -1.616519e-01 1 1  ON 31
eH1_2                -1.122751e-01 1 1  ON 32
eH1_3                -5.656810e-02 1 1  ON 33
eH1_4                -6.465364e-03 1 1  ON 34
eH1_5                 3.012866e-02 1 1  ON 35
eH1_6                 9.392193e-02 1 1  ON 36
eH1_7                 1.615860e-01 1 1  ON 37
eH1_8                 2.039003e-01 1 1  ON 38
eH1_9                 1.126152e-01 1 1  ON 39
eH2_0                -2.648928e-01 1 1  ON 40
eH2_1                -1.588726e-01 1 1  ON 41
eH2_2                -1.095950e-01 1 1  ON 42
eH2_3                -5.395794e-02 1 1  ON 43
eH2_4                -3.715979e-03 1 1  ON 44
eH2_5                 3.399793e-02 1 1  ON 45
eH2_6                 9.722458e-02 1 1  ON 46
eH2_7                 1.616138e-01 1 1  ON 47
eH2_8                 2.046996e-01 1 1  ON 48
eH2_9                 1.035400e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5804e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8941
    reference variance = 0.196123
====================================================
  Execution time = 2.0610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6306e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362975610109
                                         uncertainty =       0.023019930748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.362975610109
                                         uncertainty =       0.023019930748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426060588
  error estimate for blocks of size 2^( 2) =       0.000438455128
  error estimate for blocks of size 2^( 3) =       0.000451210025
  error estimate for blocks of size 2^( 4) =       0.000462972766
  error estimate for blocks of size 2^( 5) =       0.000473897474
  error estimate for blocks of size 2^( 6) =       0.000480764735
  error estimate for blocks of size 2^( 7) =       0.000488055242

      target function =                  N/A
              le_mean =     -16.906167498432
             les_mean =     286.181554552379
             stat err =       0.000476422554
             autocorr =       1.250379665226
              std dev =       0.602540661576
             le_variance =       0.363055248853


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690616749843e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906167498432       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906167531447       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906167358259       residual = 5.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906167453126       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906167610116       residual = 3.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906167657933       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906167586690       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906167585049       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.811053e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906167498432       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906167507097       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906167459811       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906167484823       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906167519715       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906167535134       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906167517218       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906167515309       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.968522e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906167498432       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906167500626       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906167488529       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906167494850       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906167503282       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906167507315       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906167502866       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906167502293       residual = 2.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.930830e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.131101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6183e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.119631e-01 1 1  ON 0
 uu_1                 1.443590e-01 1 1  ON 1
 uu_2                 4.229176e-02 1 1  ON 2
 uu_3                -2.091449e-02 1 1  ON 3
 uu_4                -6.737219e-02 1 1  ON 4
 uu_5                -1.038596e-01 1 1  ON 5
 uu_6                -1.331966e-01 1 1  ON 6
 uu_7                -1.492015e-01 1 1  ON 7
 uu_8                -1.431206e-01 1 1  ON 8
 uu_9                -1.126670e-01 1 1  ON 9
 ud_0                 4.543931e-01 1 1  ON 10
 ud_1                 1.883065e-01 1 1  ON 11
 ud_2                 6.733330e-02 1 1  ON 12
 ud_3                -4.379856e-03 1 1  ON 13
 ud_4                -6.206985e-02 1 1  ON 14
 ud_5                -1.046901e-01 1 1  ON 15
 ud_6                -1.333977e-01 1 1  ON 16
 ud_7                -1.511724e-01 1 1  ON 17
 ud_8                -1.525097e-01 1 1  ON 18
 ud_9                -1.435756e-01 1 1  ON 19
 eO_0                -7.494968e-01 1 1  ON 20
 eO_1                -4.277325e-01 1 1  ON 21
 eO_2                -1.230148e-02 1 1  ON 22
 eO_3                 3.047329e-01 1 1  ON 23
 eO_4                 5.329618e-01 1 1  ON 24
 eO_5                 4.974539e-01 1 1  ON 25
 eO_6                 2.675330e-01 1 1  ON 26
 eO_7                -4.320357e-02 1 1  ON 27
 eO_8                -2.438373e-01 1 1  ON 28
 eO_9                -1.181040e-01 1 1  ON 29
eH1_0                -2.675760e-01 1 1  ON 30
eH1_1                -1.616529e-01 1 1  ON 31
eH1_2                -1.122826e-01 1 1  ON 32
eH1_3                -5.657520e-02 1 1  ON 33
eH1_4                -6.475195e-03 1 1  ON 34
eH1_5                 3.013180e-02 1 1  ON 35
eH1_6                 9.391768e-02 1 1  ON 36
eH1_7                 1.615815e-01 1 1  ON 37
eH1_8                 2.039051e-01 1 1  ON 38
eH1_9                 1.126349e-01 1 1  ON 39
eH2_0                -2.649038e-01 1 1  ON 40
eH2_1                -1.588837e-01 1 1  ON 41
eH2_2                -1.096059e-01 1 1  ON 42
eH2_3                -5.394828e-02 1 1  ON 43
eH2_4                -3.719258e-03 1 1  ON 44
eH2_5                 3.398896e-02 1 1  ON 45
eH2_6                 9.723112e-02 1 1  ON 46
eH2_7                 1.616221e-01 1 1  ON 47
eH2_8                 2.047056e-01 1 1  ON 48
eH2_9                 1.035547e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.853
    reference variance = 0.238275
====================================================
  Execution time = 2.0048e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4123e-01
  Total weights = 2.0000e+06
  Execution time = 1.8760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341318406212
                                         uncertainty =       0.007246841741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341318406212
                                         uncertainty =       0.007246841741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413060085
  error estimate for blocks of size 2^( 2) =       0.000426238127
  error estimate for blocks of size 2^( 3) =       0.000439384918
  error estimate for blocks of size 2^( 4) =       0.000452272662
  error estimate for blocks of size 2^( 5) =       0.000465539445
  error estimate for blocks of size 2^( 6) =       0.000473962238
  error estimate for blocks of size 2^( 7) =       0.000477676786

      target function =                  N/A
              le_mean =     -16.905106266653
             les_mean =     286.123854983778
             stat err =       0.000467362783
             autocorr =       1.280211696353
              std dev =       0.584155174212
             le_variance =       0.341237267559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341297284383
                                         uncertainty =       0.007246974743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341297284383
                                         uncertainty =       0.007246974743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413047299
  error estimate for blocks of size 2^( 2) =       0.000426225961
  error estimate for blocks of size 2^( 3) =       0.000439372827
  error estimate for blocks of size 2^( 4) =       0.000452260254
  error estimate for blocks of size 2^( 5) =       0.000465526953
  error estimate for blocks of size 2^( 6) =       0.000473949680
  error estimate for blocks of size 2^( 7) =       0.000477663228

      target function =                  N/A
              le_mean =     -16.905106527256
             les_mean =     286.123842670170
             stat err =       0.000467350029
             autocorr =       1.280221080748
              std dev =       0.584137092547
             le_variance =       0.341216142889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341306389221
                                         uncertainty =       0.007246893669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341306389221
                                         uncertainty =       0.007246893669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413052811
  error estimate for blocks of size 2^( 2) =       0.000426231190
  error estimate for blocks of size 2^( 3) =       0.000439378021
  error estimate for blocks of size 2^( 4) =       0.000452265614
  error estimate for blocks of size 2^( 5) =       0.000465532369
  error estimate for blocks of size 2^( 6) =       0.000473955169
  error estimate for blocks of size 2^( 7) =       0.000477669192

      target function =                  N/A
              le_mean =     -16.905106407816
             les_mean =     286.123847737668
             stat err =       0.000467355586
             autocorr =       1.280217361515
              std dev =       0.584144886729
             le_variance =       0.341225248692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341316847003
                                         uncertainty =       0.007246847520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341316847003
                                         uncertainty =       0.007246847520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413059141
  error estimate for blocks of size 2^( 2) =       0.000426237227
  error estimate for blocks of size 2^( 3) =       0.000439384022
  error estimate for blocks of size 2^( 4) =       0.000452271747
  error estimate for blocks of size 2^( 5) =       0.000465538527
  error estimate for blocks of size 2^( 6) =       0.000473961324
  error estimate for blocks of size 2^( 7) =       0.000477675805

      target function =                  N/A
              le_mean =     -16.905106284377
             les_mean =     286.123854023571
             stat err =       0.000467361851
             autocorr =       1.280212441547
              std dev =       0.584153839411
             le_variance =       0.341235708099


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905106266653        initial
     2.4414e+00     2.4414e+01             7.8111e-05       -16.905106527256  <--
     9.7656e+00     9.7656e+01             1.9685e-05       -16.905106407816
     3.9062e+01     3.9062e+02             4.9308e-06       -16.905106284377

*****************************************************************************
Applying the update for shift_i =   2.4414e+00     and shift_s =   2.4414e+01
*****************************************************************************

  Execution time = 2.9537e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.119652e-01 1 1  ON 0
 uu_1                 1.443452e-01 1 1  ON 1
 uu_2                 4.229350e-02 1 1  ON 2
 uu_3                -2.090577e-02 1 1  ON 3
 uu_4                -6.738169e-02 1 1  ON 4
 uu_5                -1.038633e-01 1 1  ON 5
 uu_6                -1.332068e-01 1 1  ON 6
 uu_7                -1.492036e-01 1 1  ON 7
 uu_8                -1.431116e-01 1 1  ON 8
 uu_9                -1.126898e-01 1 1  ON 9
 ud_0                 4.543870e-01 1 1  ON 10
 ud_1                 1.883303e-01 1 1  ON 11
 ud_2                 6.734044e-02 1 1  ON 12
 ud_3                -4.370085e-03 1 1  ON 13
 ud_4                -6.205939e-02 1 1  ON 14
 ud_5                -1.046501e-01 1 1  ON 15
 ud_6                -1.333915e-01 1 1  ON 16
 ud_7                -1.511826e-01 1 1  ON 17
 ud_8                -1.525400e-01 1 1  ON 18
 ud_9                -1.435917e-01 1 1  ON 19
 eO_0                -7.494935e-01 1 1  ON 20
 eO_1                -4.277082e-01 1 1  ON 21
 eO_2                -1.231600e-02 1 1  ON 22
 eO_3                 3.047757e-01 1 1  ON 23
 eO_4                 5.329964e-01 1 1  ON 24
 eO_5                 4.974472e-01 1 1  ON 25
 eO_6                 2.675198e-01 1 1  ON 26
 eO_7                -4.320107e-02 1 1  ON 27
 eO_8                -2.438644e-01 1 1  ON 28
 eO_9                -1.181410e-01 1 1  ON 29
eH1_0                -2.675769e-01 1 1  ON 30
eH1_1                -1.616572e-01 1 1  ON 31
eH1_2                -1.123042e-01 1 1  ON 32
eH1_3                -5.659588e-02 1 1  ON 33
eH1_4                -6.504022e-03 1 1  ON 34
eH1_5                 3.014079e-02 1 1  ON 35
eH1_6                 9.390538e-02 1 1  ON 36
eH1_7                 1.615683e-01 1 1  ON 37
eH1_8                 2.039194e-01 1 1  ON 38
eH1_9                 1.126934e-01 1 1  ON 39
eH2_0                -2.649365e-01 1 1  ON 40
eH2_1                -1.589156e-01 1 1  ON 41
eH2_2                -1.096362e-01 1 1  ON 42
eH2_3                -5.392344e-02 1 1  ON 43
eH2_4                -3.727719e-03 1 1  ON 44
eH2_5                 3.396192e-02 1 1  ON 45
eH2_6                 9.725042e-02 1 1  ON 46
eH2_7                 1.616466e-01 1 1  ON 47
eH2_8                 2.047235e-01 1 1  ON 48
eH2_9                 1.035984e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5727e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8789
    reference variance = 0.506777
====================================================
  Execution time = 2.2612e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4086e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340967777120
                                         uncertainty =       0.004538342323

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340967777120
                                         uncertainty =       0.004538342323

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412828773
  error estimate for blocks of size 2^( 2) =       0.000425570384
  error estimate for blocks of size 2^( 3) =       0.000438803706
  error estimate for blocks of size 2^( 4) =       0.000450373494
  error estimate for blocks of size 2^( 5) =       0.000460708045
  error estimate for blocks of size 2^( 6) =       0.000469772558
  error estimate for blocks of size 2^( 7) =       0.000475378859

      target function =                  N/A
              le_mean =     -16.905982411621
             les_mean =     286.153096323721
             stat err =       0.000464058239
             autocorr =       1.263586733208
              std dev =       0.583828050131
             le_variance =       0.340855192120


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598241162e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-01, overlap shift 6.1035e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905982411621       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905982501356       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905982937384       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905982737116       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905982514761       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905982468313       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905982556916       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905982534756       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905982587021       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e-01 is 2.689240e-04

solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905982411621       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905982439297       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905982554894       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905982514655       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905982482061       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905982412975       residual = 8.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905982443289       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905982427818       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.261375e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905982411621       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905982418969       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905982448269       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905982439275       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905982432834       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905982411000       residual = 6.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905982419102       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.848102e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.133750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8196e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.120204e-01 1 1  ON 0
 uu_1                 1.443678e-01 1 1  ON 1
 uu_2                 4.226310e-02 1 1  ON 2
 uu_3                -2.092744e-02 1 1  ON 3
 uu_4                -6.738928e-02 1 1  ON 4
 uu_5                -1.038822e-01 1 1  ON 5
 uu_6                -1.332374e-01 1 1  ON 6
 uu_7                -1.491644e-01 1 1  ON 7
 uu_8                -1.431161e-01 1 1  ON 8
 uu_9                -1.127324e-01 1 1  ON 9
 ud_0                 4.544087e-01 1 1  ON 10
 ud_1                 1.883688e-01 1 1  ON 11
 ud_2                 6.736367e-02 1 1  ON 12
 ud_3                -4.345249e-03 1 1  ON 13
 ud_4                -6.202911e-02 1 1  ON 14
 ud_5                -1.046266e-01 1 1  ON 15
 ud_6                -1.333610e-01 1 1  ON 16
 ud_7                -1.512182e-01 1 1  ON 17
 ud_8                -1.526126e-01 1 1  ON 18
 ud_9                -1.436335e-01 1 1  ON 19
 eO_0                -7.494720e-01 1 1  ON 20
 eO_1                -4.276781e-01 1 1  ON 21
 eO_2                -1.227792e-02 1 1  ON 22
 eO_3                 3.047846e-01 1 1  ON 23
 eO_4                 5.330010e-01 1 1  ON 24
 eO_5                 4.974311e-01 1 1  ON 25
 eO_6                 2.675367e-01 1 1  ON 26
 eO_7                -4.319934e-02 1 1  ON 27
 eO_8                -2.439026e-01 1 1  ON 28
 eO_9                -1.181987e-01 1 1  ON 29
eH1_0                -2.675482e-01 1 1  ON 30
eH1_1                -1.616868e-01 1 1  ON 31
eH1_2                -1.123225e-01 1 1  ON 32
eH1_3                -5.662397e-02 1 1  ON 33
eH1_4                -6.512328e-03 1 1  ON 34
eH1_5                 3.017283e-02 1 1  ON 35
eH1_6                 9.387151e-02 1 1  ON 36
eH1_7                 1.615343e-01 1 1  ON 37
eH1_8                 2.039455e-01 1 1  ON 38
eH1_9                 1.127516e-01 1 1  ON 39
eH2_0                -2.649401e-01 1 1  ON 40
eH2_1                -1.589254e-01 1 1  ON 41
eH2_2                -1.096819e-01 1 1  ON 42
eH2_3                -5.392086e-02 1 1  ON 43
eH2_4                -3.748015e-03 1 1  ON 44
eH2_5                 3.394683e-02 1 1  ON 45
eH2_6                 9.726288e-02 1 1  ON 46
eH2_7                 1.616707e-01 1 1  ON 47
eH2_8                 2.047289e-01 1 1  ON 48
eH2_9                 1.036507e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9529
    reference variance = 0.22004
====================================================
  Execution time = 1.9893e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3098e-01
  Total weights = 2.0000e+06
  Execution time = 1.8682e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330832323585
                                         uncertainty =       0.002636504835

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330832323585
                                         uncertainty =       0.002636504835

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406784886
  error estimate for blocks of size 2^( 2) =       0.000419704485
  error estimate for blocks of size 2^( 3) =       0.000433327233
  error estimate for blocks of size 2^( 4) =       0.000446310407
  error estimate for blocks of size 2^( 5) =       0.000457218218
  error estimate for blocks of size 2^( 6) =       0.000466620377
  error estimate for blocks of size 2^( 7) =       0.000472374465

      target function =                  N/A
              le_mean =     -16.905351216911
             les_mean =     286.121847488537
             stat err =       0.000460630867
             autocorr =       1.282261068508
              std dev =       0.575280702704
             le_variance =       0.330947886903

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330940335636
                                         uncertainty =       0.002637452037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330940335636
                                         uncertainty =       0.002637452037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406851288
  error estimate for blocks of size 2^( 2) =       0.000419764918
  error estimate for blocks of size 2^( 3) =       0.000433381905
  error estimate for blocks of size 2^( 4) =       0.000446360158
  error estimate for blocks of size 2^( 5) =       0.000457266404
  error estimate for blocks of size 2^( 6) =       0.000466667550
  error estimate for blocks of size 2^( 7) =       0.000472426554

      target function =                  N/A
              le_mean =     -16.905350340317
             les_mean =     286.121925903859
             stat err =       0.000460680166
             autocorr =       1.282116945985
              std dev =       0.575374608862
             le_variance =       0.331055940523

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330892545433
                                         uncertainty =       0.002637036181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330892545433
                                         uncertainty =       0.002637036181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406821920
  error estimate for blocks of size 2^( 2) =       0.000419738109
  error estimate for blocks of size 2^( 3) =       0.000433357528
  error estimate for blocks of size 2^( 4) =       0.000446337987
  error estimate for blocks of size 2^( 5) =       0.000457244930
  error estimate for blocks of size 2^( 6) =       0.000466646441
  error estimate for blocks of size 2^( 7) =       0.000472404331

      target function =                  N/A
              le_mean =     -16.905350627447
             les_mean =     286.121887820576
             stat err =       0.000460658422
             autocorr =       1.282181014015
              std dev =       0.575333076720
             le_variance =       0.331008149168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330840471313
                                         uncertainty =       0.002636579391

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330840471313
                                         uncertainty =       0.002636579391

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406789898
  error estimate for blocks of size 2^( 2) =       0.000419709032
  error estimate for blocks of size 2^( 3) =       0.000433331346
  error estimate for blocks of size 2^( 4) =       0.000446314160
  error estimate for blocks of size 2^( 5) =       0.000457221865
  error estimate for blocks of size 2^( 6) =       0.000466623953
  error estimate for blocks of size 2^( 7) =       0.000472378588

      target function =                  N/A
              le_mean =     -16.905351134768
             les_mean =     286.121852866865
             stat err =       0.000460634642
             autocorr =       1.282250485558
              std dev =       0.575287791057
             le_variance =       0.330956042540


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905351216911        initial  <--
     6.1035e-01     6.1035e+00             2.6892e-04       -16.905350340317
     2.4414e+00     2.4414e+01             7.2614e-05       -16.905350627447
     9.7656e+00     9.7656e+01             1.8481e-05       -16.905351134768

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3524
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.119652e-01 1 1  ON 0
 uu_1                 1.443452e-01 1 1  ON 1
 uu_2                 4.229350e-02 1 1  ON 2
 uu_3                -2.090577e-02 1 1  ON 3
 uu_4                -6.738169e-02 1 1  ON 4
 uu_5                -1.038633e-01 1 1  ON 5
 uu_6                -1.332068e-01 1 1  ON 6
 uu_7                -1.492036e-01 1 1  ON 7
 uu_8                -1.431116e-01 1 1  ON 8
 uu_9                -1.126898e-01 1 1  ON 9
 ud_0                 4.543870e-01 1 1  ON 10
 ud_1                 1.883303e-01 1 1  ON 11
 ud_2                 6.734044e-02 1 1  ON 12
 ud_3                -4.370085e-03 1 1  ON 13
 ud_4                -6.205939e-02 1 1  ON 14
 ud_5                -1.046501e-01 1 1  ON 15
 ud_6                -1.333915e-01 1 1  ON 16
 ud_7                -1.511826e-01 1 1  ON 17
 ud_8                -1.525400e-01 1 1  ON 18
 ud_9                -1.435917e-01 1 1  ON 19
 eO_0                -7.494935e-01 1 1  ON 20
 eO_1                -4.277082e-01 1 1  ON 21
 eO_2                -1.231600e-02 1 1  ON 22
 eO_3                 3.047757e-01 1 1  ON 23
 eO_4                 5.329964e-01 1 1  ON 24
 eO_5                 4.974472e-01 1 1  ON 25
 eO_6                 2.675198e-01 1 1  ON 26
 eO_7                -4.320107e-02 1 1  ON 27
 eO_8                -2.438644e-01 1 1  ON 28
 eO_9                -1.181410e-01 1 1  ON 29
eH1_0                -2.675769e-01 1 1  ON 30
eH1_1                -1.616572e-01 1 1  ON 31
eH1_2                -1.123042e-01 1 1  ON 32
eH1_3                -5.659588e-02 1 1  ON 33
eH1_4                -6.504022e-03 1 1  ON 34
eH1_5                 3.014079e-02 1 1  ON 35
eH1_6                 9.390538e-02 1 1  ON 36
eH1_7                 1.615683e-01 1 1  ON 37
eH1_8                 2.039194e-01 1 1  ON 38
eH1_9                 1.126934e-01 1 1  ON 39
eH2_0                -2.649365e-01 1 1  ON 40
eH2_1                -1.589156e-01 1 1  ON 41
eH2_2                -1.096362e-01 1 1  ON 42
eH2_3                -5.392344e-02 1 1  ON 43
eH2_4                -3.727719e-03 1 1  ON 44
eH2_5                 3.396192e-02 1 1  ON 45
eH2_6                 9.725042e-02 1 1  ON 46
eH2_7                 1.616466e-01 1 1  ON 47
eH2_8                 2.047235e-01 1 1  ON 48
eH2_9                 1.035984e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7555e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6894e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8831
    reference variance = 0.269332
====================================================
  Execution time = 2.0468e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4883e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6138e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348753720127
                                         uncertainty =       0.015641963404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348753720127
                                         uncertainty =       0.015641963404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417629514
  error estimate for blocks of size 2^( 2) =       0.000430014362
  error estimate for blocks of size 2^( 3) =       0.000442808530
  error estimate for blocks of size 2^( 4) =       0.000455344733
  error estimate for blocks of size 2^( 5) =       0.000465860745
  error estimate for blocks of size 2^( 6) =       0.000473037875
  error estimate for blocks of size 2^( 7) =       0.000477225438

      target function =                  N/A
              le_mean =     -16.906880003125
             les_mean =     286.191420087193
             stat err =       0.000467867198
             autocorr =       1.255055207727
              std dev =       0.590617322418
             le_variance =       0.348828821540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690688000312e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906880003125       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906880036732       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906879980196       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906879966558       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906879972119       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906880002852       residual = 6.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906880030889       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906880022848       residual = 5.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.059876e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906880003125       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906880011747       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906879997422       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906879994059       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906879995650       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906880003501       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906880010701       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906880008838       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 7.824586e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906880003125       residual = 5.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906880005295       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906880001701       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906880000864       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906880001275       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906880003250       residual = 5.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906880005062       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906880004606       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 1.967540e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.136360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6092e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.119631e-01 1 1  ON 0
 uu_1                 1.443502e-01 1 1  ON 1
 uu_2                 4.229082e-02 1 1  ON 2
 uu_3                -2.090885e-02 1 1  ON 3
 uu_4                -6.738285e-02 1 1  ON 4
 uu_5                -1.038642e-01 1 1  ON 5
 uu_6                -1.332060e-01 1 1  ON 6
 uu_7                -1.491966e-01 1 1  ON 7
 uu_8                -1.431108e-01 1 1  ON 8
 uu_9                -1.126944e-01 1 1  ON 9
 ud_0                 4.543861e-01 1 1  ON 10
 ud_1                 1.883306e-01 1 1  ON 11
 ud_2                 6.734116e-02 1 1  ON 12
 ud_3                -4.368776e-03 1 1  ON 13
 ud_4                -6.205749e-02 1 1  ON 14
 ud_5                -1.046455e-01 1 1  ON 15
 ud_6                -1.333932e-01 1 1  ON 16
 ud_7                -1.511850e-01 1 1  ON 17
 ud_8                -1.525404e-01 1 1  ON 18
 ud_9                -1.435927e-01 1 1  ON 19
 eO_0                -7.494965e-01 1 1  ON 20
 eO_1                -4.277066e-01 1 1  ON 21
 eO_2                -1.230817e-02 1 1  ON 22
 eO_3                 3.047751e-01 1 1  ON 23
 eO_4                 5.329986e-01 1 1  ON 24
 eO_5                 4.974509e-01 1 1  ON 25
 eO_6                 2.675173e-01 1 1  ON 26
 eO_7                -4.320147e-02 1 1  ON 27
 eO_8                -2.438671e-01 1 1  ON 28
 eO_9                -1.181459e-01 1 1  ON 29
eH1_0                -2.675833e-01 1 1  ON 30
eH1_1                -1.616537e-01 1 1  ON 31
eH1_2                -1.123026e-01 1 1  ON 32
eH1_3                -5.659956e-02 1 1  ON 33
eH1_4                -6.506398e-03 1 1  ON 34
eH1_5                 3.013756e-02 1 1  ON 35
eH1_6                 9.390538e-02 1 1  ON 36
eH1_7                 1.615681e-01 1 1  ON 37
eH1_8                 2.039231e-01 1 1  ON 38
eH1_9                 1.126994e-01 1 1  ON 39
eH2_0                -2.649394e-01 1 1  ON 40
eH2_1                -1.589163e-01 1 1  ON 41
eH2_2                -1.096326e-01 1 1  ON 42
eH2_3                -5.392611e-02 1 1  ON 43
eH2_4                -3.728007e-03 1 1  ON 44
eH2_5                 3.395750e-02 1 1  ON 45
eH2_6                 9.725019e-02 1 1  ON 46
eH2_7                 1.616468e-01 1 1  ON 47
eH2_8                 2.047251e-01 1 1  ON 48
eH2_9                 1.036035e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8812
    reference variance = 0.243689
====================================================
  Execution time = 1.9964e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3943e-01
  Total weights = 2.0000e+06
  Execution time = 1.8892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339478299957
                                         uncertainty =       0.005301209235

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339478299957
                                         uncertainty =       0.005301209235

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411962948
  error estimate for blocks of size 2^( 2) =       0.000424468291
  error estimate for blocks of size 2^( 3) =       0.000437320701
  error estimate for blocks of size 2^( 4) =       0.000449285088
  error estimate for blocks of size 2^( 5) =       0.000459294500
  error estimate for blocks of size 2^( 6) =       0.000465673015
  error estimate for blocks of size 2^( 7) =       0.000468427327

      target function =                  N/A
              le_mean =     -16.906365755273
             les_mean =     286.164629822131
             stat err =       0.000460669982
             autocorr =       1.250441890163
              std dev =       0.582603588033
             le_variance =       0.339426940789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339476359326
                                         uncertainty =       0.005301272952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339476359326
                                         uncertainty =       0.005301272952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411961771
  error estimate for blocks of size 2^( 2) =       0.000424466894
  error estimate for blocks of size 2^( 3) =       0.000437319312
  error estimate for blocks of size 2^( 4) =       0.000449284049
  error estimate for blocks of size 2^( 5) =       0.000459293705
  error estimate for blocks of size 2^( 6) =       0.000465672368
  error estimate for blocks of size 2^( 7) =       0.000468426697

      target function =                  N/A
              le_mean =     -16.906365928911
             les_mean =     286.164633754837
             stat err =       0.000460669205
             autocorr =       1.250444809709
              std dev =       0.582601924385
             le_variance =       0.339425002297

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339477307200
                                         uncertainty =       0.005301239365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339477307200
                                         uncertainty =       0.005301239365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411962346
  error estimate for blocks of size 2^( 2) =       0.000424467575
  error estimate for blocks of size 2^( 3) =       0.000437319989
  error estimate for blocks of size 2^( 4) =       0.000449284558
  error estimate for blocks of size 2^( 5) =       0.000459294096
  error estimate for blocks of size 2^( 6) =       0.000465672690
  error estimate for blocks of size 2^( 7) =       0.000468427014

      target function =                  N/A
              le_mean =     -16.906365845253
             les_mean =     286.164631872887
             stat err =       0.000460669589
             autocorr =       1.250443410461
              std dev =       0.582602736920
             le_variance =       0.339425949066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339478174921
                                         uncertainty =       0.005301212948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339478174921
                                         uncertainty =       0.005301212948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411962872
  error estimate for blocks of size 2^( 2) =       0.000424468201
  error estimate for blocks of size 2^( 3) =       0.000437320612
  error estimate for blocks of size 2^( 4) =       0.000449285022
  error estimate for blocks of size 2^( 5) =       0.000459294449
  error estimate for blocks of size 2^( 6) =       0.000465672974
  error estimate for blocks of size 2^( 7) =       0.000468427287

      target function =                  N/A
              le_mean =     -16.906365766561
             les_mean =     286.164630078896
             stat err =       0.000460669933
             autocorr =       1.250442081974
              std dev =       0.582603480834
             le_variance =       0.339426815880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906365755273        initial
     6.1035e+00     6.1035e+01             3.0599e-05       -16.906365928911  <--
     2.4414e+01     2.4414e+02             7.8246e-06       -16.906365845253
     9.7656e+01     9.7656e+02             1.9675e-06       -16.906365766561

*****************************************************************************
Applying the update for shift_i =   6.1035e+00     and shift_s =   6.1035e+01
*****************************************************************************

  Execution time = 2.9506e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.119574e-01 1 1  ON 0
 uu_1                 1.443640e-01 1 1  ON 1
 uu_2                 4.228326e-02 1 1  ON 2
 uu_3                -2.091795e-02 1 1  ON 3
 uu_4                -6.738636e-02 1 1  ON 4
 uu_5                -1.038665e-01 1 1  ON 5
 uu_6                -1.332036e-01 1 1  ON 6
 uu_7                -1.491758e-01 1 1  ON 7
 uu_8                -1.431083e-01 1 1  ON 8
 uu_9                -1.127082e-01 1 1  ON 9
 ud_0                 4.543836e-01 1 1  ON 10
 ud_1                 1.883318e-01 1 1  ON 11
 ud_2                 6.734324e-02 1 1  ON 12
 ud_3                -4.364864e-03 1 1  ON 13
 ud_4                -6.205177e-02 1 1  ON 14
 ud_5                -1.046321e-01 1 1  ON 15
 ud_6                -1.333979e-01 1 1  ON 16
 ud_7                -1.511921e-01 1 1  ON 17
 ud_8                -1.525419e-01 1 1  ON 18
 ud_9                -1.435955e-01 1 1  ON 19
 eO_0                -7.495053e-01 1 1  ON 20
 eO_1                -4.277016e-01 1 1  ON 21
 eO_2                -1.228540e-02 1 1  ON 22
 eO_3                 3.047734e-01 1 1  ON 23
 eO_4                 5.330052e-01 1 1  ON 24
 eO_5                 4.974617e-01 1 1  ON 25
 eO_6                 2.675098e-01 1 1  ON 26
 eO_7                -4.320270e-02 1 1  ON 27
 eO_8                -2.438751e-01 1 1  ON 28
 eO_9                -1.181608e-01 1 1  ON 29
eH1_0                -2.676020e-01 1 1  ON 30
eH1_1                -1.616436e-01 1 1  ON 31
eH1_2                -1.122980e-01 1 1  ON 32
eH1_3                -5.661022e-02 1 1  ON 33
eH1_4                -6.513608e-03 1 1  ON 34
eH1_5                 3.012800e-02 1 1  ON 35
eH1_6                 9.390540e-02 1 1  ON 36
eH1_7                 1.615673e-01 1 1  ON 37
eH1_8                 2.039339e-01 1 1  ON 38
eH1_9                 1.127174e-01 1 1  ON 39
eH2_0                -2.649479e-01 1 1  ON 40
eH2_1                -1.589183e-01 1 1  ON 41
eH2_2                -1.096222e-01 1 1  ON 42
eH2_3                -5.393374e-02 1 1  ON 43
eH2_4                -3.729015e-03 1 1  ON 44
eH2_5                 3.394440e-02 1 1  ON 45
eH2_6                 9.724948e-02 1 1  ON 46
eH2_7                 1.616475e-01 1 1  ON 47
eH2_8                 2.047300e-01 1 1  ON 48
eH2_9                 1.036187e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5606e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6893e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8338
    reference variance = 0.228938
====================================================
  Execution time = 2.0519e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3386e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333910548394
                                         uncertainty =       0.002961471764

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333910548394
                                         uncertainty =       0.002961471764

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408567761
  error estimate for blocks of size 2^( 2) =       0.000421386988
  error estimate for blocks of size 2^( 3) =       0.000434827380
  error estimate for blocks of size 2^( 4) =       0.000447300822
  error estimate for blocks of size 2^( 5) =       0.000458028371
  error estimate for blocks of size 2^( 6) =       0.000465199692
  error estimate for blocks of size 2^( 7) =       0.000469004564

      target function =                  N/A
              le_mean =     -16.906528488716
             les_mean =     286.164560604026
             stat err =       0.000459883362
             autocorr =       1.266972550780
              std dev =       0.577802069204
             le_variance =       0.333855231177


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652848872e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+00, overlap shift 1.5259e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906528488716       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906529346904       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906529352440       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906529393268       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906529129943       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906529176649       residual = 8.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906529202511       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906529225847       residual = 9.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+00 is 1.072509e-04

solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906528488716       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906528719131       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906528722262       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906528734632       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906528661393       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906528678848       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906528691485       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906528696833       residual = 4.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 2.720617e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906528488716       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906528547405       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906528548365       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906528551638       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906528532795       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906528537627       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906528541245       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906528542638       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 6.823244e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139020 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6076e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.119558e-01 1 1  ON 0
 uu_1                 1.443782e-01 1 1  ON 1
 uu_2                 4.229194e-02 1 1  ON 2
 uu_3                -2.091148e-02 1 1  ON 3
 uu_4                -6.736690e-02 1 1  ON 4
 uu_5                -1.038630e-01 1 1  ON 5
 uu_6                -1.332171e-01 1 1  ON 6
 uu_7                -1.491877e-01 1 1  ON 7
 uu_8                -1.431167e-01 1 1  ON 8
 uu_9                -1.127324e-01 1 1  ON 9
 ud_0                 4.543765e-01 1 1  ON 10
 ud_1                 1.883490e-01 1 1  ON 11
 ud_2                 6.734891e-02 1 1  ON 12
 ud_3                -4.358302e-03 1 1  ON 13
 ud_4                -6.204376e-02 1 1  ON 14
 ud_5                -1.046206e-01 1 1  ON 15
 ud_6                -1.333782e-01 1 1  ON 16
 ud_7                -1.512010e-01 1 1  ON 17
 ud_8                -1.525691e-01 1 1  ON 18
 ud_9                -1.436132e-01 1 1  ON 19
 eO_0                -7.494909e-01 1 1  ON 20
 eO_1                -4.276878e-01 1 1  ON 21
 eO_2                -1.227421e-02 1 1  ON 22
 eO_3                 3.047761e-01 1 1  ON 23
 eO_4                 5.329982e-01 1 1  ON 24
 eO_5                 4.974669e-01 1 1  ON 25
 eO_6                 2.675207e-01 1 1  ON 26
 eO_7                -4.320921e-02 1 1  ON 27
 eO_8                -2.438985e-01 1 1  ON 28
 eO_9                -1.181796e-01 1 1  ON 29
eH1_0                -2.676112e-01 1 1  ON 30
eH1_1                -1.616569e-01 1 1  ON 31
eH1_2                -1.123004e-01 1 1  ON 32
eH1_3                -5.659972e-02 1 1  ON 33
eH1_4                -6.530335e-03 1 1  ON 34
eH1_5                 3.012719e-02 1 1  ON 35
eH1_6                 9.390180e-02 1 1  ON 36
eH1_7                 1.615704e-01 1 1  ON 37
eH1_8                 2.039451e-01 1 1  ON 38
eH1_9                 1.127364e-01 1 1  ON 39
eH2_0                -2.649697e-01 1 1  ON 40
eH2_1                -1.589183e-01 1 1  ON 41
eH2_2                -1.096048e-01 1 1  ON 42
eH2_3                -5.393525e-02 1 1  ON 43
eH2_4                -3.731761e-03 1 1  ON 44
eH2_5                 3.392620e-02 1 1  ON 45
eH2_6                 9.724883e-02 1 1  ON 46
eH2_7                 1.616505e-01 1 1  ON 47
eH2_8                 2.047343e-01 1 1  ON 48
eH2_9                 1.036384e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9253
    reference variance = 0.248844
====================================================
  Execution time = 2.0039e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3641e-01
  Total weights = 2.0000e+06
  Execution time = 1.8962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336427324065
                                         uncertainty =       0.003133832378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336427324065
                                         uncertainty =       0.003133832378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410138932
  error estimate for blocks of size 2^( 2) =       0.000422995821
  error estimate for blocks of size 2^( 3) =       0.000436296234
  error estimate for blocks of size 2^( 4) =       0.000448855001
  error estimate for blocks of size 2^( 5) =       0.000460038479
  error estimate for blocks of size 2^( 6) =       0.000467649046
  error estimate for blocks of size 2^( 7) =       0.000473027561

      target function =                  N/A
              le_mean =     -16.906364801493
             les_mean =     286.161598519581
             stat err =       0.000462392522
             autocorr =       1.271041151061
              std dev =       0.580024039692
             le_variance =       0.336427886621

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336364862024
                                         uncertainty =       0.003133388399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336364862024
                                         uncertainty =       0.003133388399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410100848
  error estimate for blocks of size 2^( 2) =       0.000422958380
  error estimate for blocks of size 2^( 3) =       0.000436259777
  error estimate for blocks of size 2^( 4) =       0.000448819196
  error estimate for blocks of size 2^( 5) =       0.000460004539
  error estimate for blocks of size 2^( 6) =       0.000467617866
  error estimate for blocks of size 2^( 7) =       0.000472999831

      target function =                  N/A
              le_mean =     -16.906364478139
             les_mean =     286.161525111266
             stat err =       0.000462360358
             autocorr =       1.271100375092
              std dev =       0.579970181792
             le_variance =       0.336365411768

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336389351343
                                         uncertainty =       0.003133543650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336389351343
                                         uncertainty =       0.003133543650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410115780
  error estimate for blocks of size 2^( 2) =       0.000422973122
  error estimate for blocks of size 2^( 3) =       0.000436274186
  error estimate for blocks of size 2^( 4) =       0.000448833343
  error estimate for blocks of size 2^( 5) =       0.000460017864
  error estimate for blocks of size 2^( 6) =       0.000467629871
  error estimate for blocks of size 2^( 7) =       0.000473010248

      target function =                  N/A
              le_mean =     -16.906364617835
             les_mean =     286.161554329273
             stat err =       0.000462372832
             autocorr =       1.271076398787
              std dev =       0.579991298461
             le_variance =       0.336389906290

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336422312984
                                         uncertainty =       0.003133793545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336422312984
                                         uncertainty =       0.003133793545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410135877
  error estimate for blocks of size 2^( 2) =       0.000422992827
  error estimate for blocks of size 2^( 3) =       0.000436293327
  error estimate for blocks of size 2^( 4) =       0.000448852145
  error estimate for blocks of size 2^( 5) =       0.000460035757
  error estimate for blocks of size 2^( 6) =       0.000467646506
  error estimate for blocks of size 2^( 7) =       0.000473025259

      target function =                  N/A
              le_mean =     -16.906364776586
             les_mean =     286.161592665324
             stat err =       0.000462389917
             autocorr =       1.271045764769
              std dev =       0.580019719100
             le_variance =       0.336422874545


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906364801493        initial  <--
     1.5259e+00     1.5259e+01             1.0725e-04       -16.906364478139
     6.1035e+00     6.1035e+01             2.7206e-05       -16.906364617835
     2.4414e+01     2.4414e+02             6.8232e-06       -16.906364776586

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5661
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.119574e-01 1 1  ON 0
 uu_1                 1.443640e-01 1 1  ON 1
 uu_2                 4.228326e-02 1 1  ON 2
 uu_3                -2.091795e-02 1 1  ON 3
 uu_4                -6.738636e-02 1 1  ON 4
 uu_5                -1.038665e-01 1 1  ON 5
 uu_6                -1.332036e-01 1 1  ON 6
 uu_7                -1.491758e-01 1 1  ON 7
 uu_8                -1.431083e-01 1 1  ON 8
 uu_9                -1.127082e-01 1 1  ON 9
 ud_0                 4.543836e-01 1 1  ON 10
 ud_1                 1.883318e-01 1 1  ON 11
 ud_2                 6.734324e-02 1 1  ON 12
 ud_3                -4.364864e-03 1 1  ON 13
 ud_4                -6.205177e-02 1 1  ON 14
 ud_5                -1.046321e-01 1 1  ON 15
 ud_6                -1.333979e-01 1 1  ON 16
 ud_7                -1.511921e-01 1 1  ON 17
 ud_8                -1.525419e-01 1 1  ON 18
 ud_9                -1.435955e-01 1 1  ON 19
 eO_0                -7.495053e-01 1 1  ON 20
 eO_1                -4.277016e-01 1 1  ON 21
 eO_2                -1.228540e-02 1 1  ON 22
 eO_3                 3.047734e-01 1 1  ON 23
 eO_4                 5.330052e-01 1 1  ON 24
 eO_5                 4.974617e-01 1 1  ON 25
 eO_6                 2.675098e-01 1 1  ON 26
 eO_7                -4.320270e-02 1 1  ON 27
 eO_8                -2.438751e-01 1 1  ON 28
 eO_9                -1.181608e-01 1 1  ON 29
eH1_0                -2.676020e-01 1 1  ON 30
eH1_1                -1.616436e-01 1 1  ON 31
eH1_2                -1.122980e-01 1 1  ON 32
eH1_3                -5.661022e-02 1 1  ON 33
eH1_4                -6.513608e-03 1 1  ON 34
eH1_5                 3.012800e-02 1 1  ON 35
eH1_6                 9.390540e-02 1 1  ON 36
eH1_7                 1.615673e-01 1 1  ON 37
eH1_8                 2.039339e-01 1 1  ON 38
eH1_9                 1.127174e-01 1 1  ON 39
eH2_0                -2.649479e-01 1 1  ON 40
eH2_1                -1.589183e-01 1 1  ON 41
eH2_2                -1.096222e-01 1 1  ON 42
eH2_3                -5.393374e-02 1 1  ON 43
eH2_4                -3.729015e-03 1 1  ON 44
eH2_5                 3.394440e-02 1 1  ON 45
eH2_6                 9.724948e-02 1 1  ON 46
eH2_7                 1.616475e-01 1 1  ON 47
eH2_8                 2.047300e-01 1 1  ON 48
eH2_9                 1.036187e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5660e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6892e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.849
    reference variance = 0.213139
====================================================
  Execution time = 2.0508e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3599e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5309e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336010197004
                                         uncertainty =       0.003690269956

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336010197004
                                         uncertainty =       0.003690269956

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409871957
  error estimate for blocks of size 2^( 2) =       0.000422752051
  error estimate for blocks of size 2^( 3) =       0.000435898396
  error estimate for blocks of size 2^( 4) =       0.000448334610
  error estimate for blocks of size 2^( 5) =       0.000458961806
  error estimate for blocks of size 2^( 6) =       0.000466108657
  error estimate for blocks of size 2^( 7) =       0.000472777724

      target function =                  N/A
              le_mean =     -16.906310764293
             les_mean =     286.159333533098
             stat err =       0.000461545699
             autocorr =       1.268040154136
              std dev =       0.579646480390
             le_variance =       0.335990042229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631076429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906310764293       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906310796424       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906310816299       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906310823003       residual = 5.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906310826936       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906310818777       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906310828819       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906310823993       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.232604e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906310764293       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906310772364       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906310777436       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906310779181       residual = 5.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906310780236       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906310778221       residual = 6.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906310780758       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906310779553       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.086197e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906310764293       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906310766314       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906310767588       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906310768029       residual = 5.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906310768297       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906310767795       residual = 6.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906310768431       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906310768129       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 7.718455e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.141589 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6046e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.119571e-01 1 1  ON 0
 uu_1                 1.443633e-01 1 1  ON 1
 uu_2                 4.228204e-02 1 1  ON 2
 uu_3                -2.091698e-02 1 1  ON 3
 uu_4                -6.738809e-02 1 1  ON 4
 uu_5                -1.038656e-01 1 1  ON 5
 uu_6                -1.332051e-01 1 1  ON 6
 uu_7                -1.491740e-01 1 1  ON 7
 uu_8                -1.431077e-01 1 1  ON 8
 uu_9                -1.127092e-01 1 1  ON 9
 ud_0                 4.543848e-01 1 1  ON 10
 ud_1                 1.883304e-01 1 1  ON 11
 ud_2                 6.734317e-02 1 1  ON 12
 ud_3                -4.363963e-03 1 1  ON 13
 ud_4                -6.205229e-02 1 1  ON 14
 ud_5                -1.046309e-01 1 1  ON 15
 ud_6                -1.333969e-01 1 1  ON 16
 ud_7                -1.511915e-01 1 1  ON 17
 ud_8                -1.525430e-01 1 1  ON 18
 ud_9                -1.435959e-01 1 1  ON 19
 eO_0                -7.495058e-01 1 1  ON 20
 eO_1                -4.276991e-01 1 1  ON 21
 eO_2                -1.228564e-02 1 1  ON 22
 eO_3                 3.047735e-01 1 1  ON 23
 eO_4                 5.330053e-01 1 1  ON 24
 eO_5                 4.974620e-01 1 1  ON 25
 eO_6                 2.675105e-01 1 1  ON 26
 eO_7                -4.320208e-02 1 1  ON 27
 eO_8                -2.438759e-01 1 1  ON 28
 eO_9                -1.181629e-01 1 1  ON 29
eH1_0                -2.676037e-01 1 1  ON 30
eH1_1                -1.616451e-01 1 1  ON 31
eH1_2                -1.122977e-01 1 1  ON 32
eH1_3                -5.661242e-02 1 1  ON 33
eH1_4                -6.515061e-03 1 1  ON 34
eH1_5                 3.012874e-02 1 1  ON 35
eH1_6                 9.390640e-02 1 1  ON 36
eH1_7                 1.615683e-01 1 1  ON 37
eH1_8                 2.039345e-01 1 1  ON 38
eH1_9                 1.127200e-01 1 1  ON 39
eH2_0                -2.649492e-01 1 1  ON 40
eH2_1                -1.589182e-01 1 1  ON 41
eH2_2                -1.096208e-01 1 1  ON 42
eH2_3                -5.393420e-02 1 1  ON 43
eH2_4                -3.729454e-03 1 1  ON 44
eH2_5                 3.394131e-02 1 1  ON 45
eH2_6                 9.724908e-02 1 1  ON 46
eH2_7                 1.616485e-01 1 1  ON 47
eH2_8                 2.047309e-01 1 1  ON 48
eH2_9                 1.036209e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9155
    reference variance = 0.217035
====================================================
  Execution time = 1.9932e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3813e-01
  Total weights = 2.0000e+06
  Execution time = 1.8675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338013579689
                                         uncertainty =       0.004610834591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338013579689
                                         uncertainty =       0.004610834591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411176720
  error estimate for blocks of size 2^( 2) =       0.000423780134
  error estimate for blocks of size 2^( 3) =       0.000436562241
  error estimate for blocks of size 2^( 4) =       0.000448337769
  error estimate for blocks of size 2^( 5) =       0.000458913824
  error estimate for blocks of size 2^( 6) =       0.000467780693
  error estimate for blocks of size 2^( 7) =       0.000472987046

      target function =                  N/A
              le_mean =     -16.906064619041
             les_mean =     286.153153324784
             stat err =       0.000462004833
             autocorr =       1.262513414100
              std dev =       0.581491694399
             le_variance =       0.338132590656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338017785512
                                         uncertainty =       0.004610838523

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338017785512
                                         uncertainty =       0.004610838523

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411179277
  error estimate for blocks of size 2^( 2) =       0.000423782641
  error estimate for blocks of size 2^( 3) =       0.000436564748
  error estimate for blocks of size 2^( 4) =       0.000448340425
  error estimate for blocks of size 2^( 5) =       0.000458916518
  error estimate for blocks of size 2^( 6) =       0.000467783357
  error estimate for blocks of size 2^( 7) =       0.000472989705

      target function =                  N/A
              le_mean =     -16.906064674744
             les_mean =     286.153159413126
             stat err =       0.000462007501
             autocorr =       1.262512297632
              std dev =       0.581495310008
             le_variance =       0.338136795561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338015771353
                                         uncertainty =       0.004610837589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338015771353
                                         uncertainty =       0.004610837589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411178053
  error estimate for blocks of size 2^( 2) =       0.000423781439
  error estimate for blocks of size 2^( 3) =       0.000436563545
  error estimate for blocks of size 2^( 4) =       0.000448339148
  error estimate for blocks of size 2^( 5) =       0.000458915223
  error estimate for blocks of size 2^( 6) =       0.000467782076
  error estimate for blocks of size 2^( 7) =       0.000472988425

      target function =                  N/A
              le_mean =     -16.906064647208
             les_mean =     286.153156468396
             stat err =       0.000462006218
             autocorr =       1.262512801762
              std dev =       0.581493578543
             le_variance =       0.338134781887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338013856436
                                         uncertainty =       0.004610835000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338013856436
                                         uncertainty =       0.004610835000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411176889
  error estimate for blocks of size 2^( 2) =       0.000423780299
  error estimate for blocks of size 2^( 3) =       0.000436562406
  error estimate for blocks of size 2^( 4) =       0.000448337943
  error estimate for blocks of size 2^( 5) =       0.000458914001
  error estimate for blocks of size 2^( 6) =       0.000467780868
  error estimate for blocks of size 2^( 7) =       0.000472987220

      target function =                  N/A
              le_mean =     -16.906064622563
             les_mean =     286.153153720548
             stat err =       0.000462005008
             autocorr =       1.262513335820
              std dev =       0.581491932317
             le_variance =       0.338132867349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906064619041        initial
     1.5259e+01     1.5259e+02             1.2326e-05       -16.906064674744  <--
     6.1035e+01     6.1035e+02             3.0862e-06       -16.906064647208
     2.4414e+02     2.4414e+03             7.7185e-07       -16.906064622563

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 2.9370e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.119563e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227846e-02 1 1  ON 2
 uu_3                -2.091422e-02 1 1  ON 3
 uu_4                -6.739315e-02 1 1  ON 4
 uu_5                -1.038629e-01 1 1  ON 5
 uu_6                -1.332096e-01 1 1  ON 6
 uu_7                -1.491687e-01 1 1  ON 7
 uu_8                -1.431058e-01 1 1  ON 8
 uu_9                -1.127121e-01 1 1  ON 9
 ud_0                 4.543882e-01 1 1  ON 10
 ud_1                 1.883263e-01 1 1  ON 11
 ud_2                 6.734297e-02 1 1  ON 12
 ud_3                -4.361325e-03 1 1  ON 13
 ud_4                -6.205377e-02 1 1  ON 14
 ud_5                -1.046273e-01 1 1  ON 15
 ud_6                -1.333939e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525465e-01 1 1  ON 18
 ud_9                -1.435974e-01 1 1  ON 19
 eO_0                -7.495075e-01 1 1  ON 20
 eO_1                -4.276917e-01 1 1  ON 21
 eO_2                -1.228630e-02 1 1  ON 22
 eO_3                 3.047742e-01 1 1  ON 23
 eO_4                 5.330055e-01 1 1  ON 24
 eO_5                 4.974628e-01 1 1  ON 25
 eO_6                 2.675124e-01 1 1  ON 26
 eO_7                -4.320020e-02 1 1  ON 27
 eO_8                -2.438784e-01 1 1  ON 28
 eO_9                -1.181693e-01 1 1  ON 29
eH1_0                -2.676088e-01 1 1  ON 30
eH1_1                -1.616493e-01 1 1  ON 31
eH1_2                -1.122972e-01 1 1  ON 32
eH1_3                -5.661899e-02 1 1  ON 33
eH1_4                -6.519416e-03 1 1  ON 34
eH1_5                 3.013094e-02 1 1  ON 35
eH1_6                 9.390942e-02 1 1  ON 36
eH1_7                 1.615712e-01 1 1  ON 37
eH1_8                 2.039363e-01 1 1  ON 38
eH1_9                 1.127277e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589179e-01 1 1  ON 41
eH2_2                -1.096167e-01 1 1  ON 42
eH2_3                -5.393559e-02 1 1  ON 43
eH2_4                -3.730757e-03 1 1  ON 44
eH2_5                 3.393207e-02 1 1  ON 45
eH2_6                 9.724789e-02 1 1  ON 46
eH2_7                 1.616516e-01 1 1  ON 47
eH2_8                 2.047336e-01 1 1  ON 48
eH2_9                 1.036276e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9939
    reference variance = 0.242334
====================================================
  Execution time = 2.0321e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4245e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6153e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342440606830
                                         uncertainty =       0.003993650369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342440606830
                                         uncertainty =       0.003993650369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413795049
  error estimate for blocks of size 2^( 2) =       0.000426340432
  error estimate for blocks of size 2^( 3) =       0.000439705299
  error estimate for blocks of size 2^( 4) =       0.000451307203
  error estimate for blocks of size 2^( 5) =       0.000462589039
  error estimate for blocks of size 2^( 6) =       0.000469990187
  error estimate for blocks of size 2^( 7) =       0.000471763928

      target function =                  N/A
              le_mean =     -16.905933262119
             les_mean =     286.153031977898
             stat err =       0.000463912589
             autocorr =       1.256902919189
              std dev =       0.585194570970
             le_variance =       0.342452685893


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690593326212e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933262119       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933412854       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933309036       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933332119       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933338342       residual = 2.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933338644       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933328676       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905933343013       residual = 2.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 4.431484e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933262119       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933301170       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933273709       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933278544       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933278866       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933278726       residual = 5.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933276620       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.133106e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905933262119       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905933271971       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905933265007       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905933266141       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905933266133       residual = 2.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905933266081       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905933265583       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 2.887286e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.143956 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5943e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.119566e-01 1 1  ON 0
 uu_1                 1.443634e-01 1 1  ON 1
 uu_2                 4.227516e-02 1 1  ON 2
 uu_3                -2.090954e-02 1 1  ON 3
 uu_4                -6.739550e-02 1 1  ON 4
 uu_5                -1.038652e-01 1 1  ON 5
 uu_6                -1.332134e-01 1 1  ON 6
 uu_7                -1.491661e-01 1 1  ON 7
 uu_8                -1.431051e-01 1 1  ON 8
 uu_9                -1.127149e-01 1 1  ON 9
 ud_0                 4.543995e-01 1 1  ON 10
 ud_1                 1.883224e-01 1 1  ON 11
 ud_2                 6.734730e-02 1 1  ON 12
 ud_3                -4.363224e-03 1 1  ON 13
 ud_4                -6.205250e-02 1 1  ON 14
 ud_5                -1.046265e-01 1 1  ON 15
 ud_6                -1.333932e-01 1 1  ON 16
 ud_7                -1.511874e-01 1 1  ON 17
 ud_8                -1.525463e-01 1 1  ON 18
 ud_9                -1.436040e-01 1 1  ON 19
 eO_0                -7.494975e-01 1 1  ON 20
 eO_1                -4.276913e-01 1 1  ON 21
 eO_2                -1.228908e-02 1 1  ON 22
 eO_3                 3.047754e-01 1 1  ON 23
 eO_4                 5.330065e-01 1 1  ON 24
 eO_5                 4.974669e-01 1 1  ON 25
 eO_6                 2.675134e-01 1 1  ON 26
 eO_7                -4.319939e-02 1 1  ON 27
 eO_8                -2.438832e-01 1 1  ON 28
 eO_9                -1.181783e-01 1 1  ON 29
eH1_0                -2.676120e-01 1 1  ON 30
eH1_1                -1.616546e-01 1 1  ON 31
eH1_2                -1.123013e-01 1 1  ON 32
eH1_3                -5.661646e-02 1 1  ON 33
eH1_4                -6.523791e-03 1 1  ON 34
eH1_5                 3.012766e-02 1 1  ON 35
eH1_6                 9.390679e-02 1 1  ON 36
eH1_7                 1.615733e-01 1 1  ON 37
eH1_8                 2.039426e-01 1 1  ON 38
eH1_9                 1.127380e-01 1 1  ON 39
eH2_0                -2.649536e-01 1 1  ON 40
eH2_1                -1.589216e-01 1 1  ON 41
eH2_2                -1.096131e-01 1 1  ON 42
eH2_3                -5.393343e-02 1 1  ON 43
eH2_4                -3.741855e-03 1 1  ON 44
eH2_5                 3.393000e-02 1 1  ON 45
eH2_6                 9.724452e-02 1 1  ON 46
eH2_7                 1.616512e-01 1 1  ON 47
eH2_8                 2.047382e-01 1 1  ON 48
eH2_9                 1.036376e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.0987
    reference variance = 2.77003
====================================================
  Execution time = 1.9821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3672e-01
  Total weights = 2.0000e+06
  Execution time = 1.8728e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336568935895
                                         uncertainty =       0.002979120563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336568935895
                                         uncertainty =       0.002979120563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410309978
  error estimate for blocks of size 2^( 2) =       0.000423010227
  error estimate for blocks of size 2^( 3) =       0.000435483309
  error estimate for blocks of size 2^( 4) =       0.000446615554
  error estimate for blocks of size 2^( 5) =       0.000456518490
  error estimate for blocks of size 2^( 6) =       0.000463231930
  error estimate for blocks of size 2^( 7) =       0.000464679076

      target function =                  N/A
              le_mean =     -16.906513176997
             les_mean =     286.166896191467
             stat err =       0.000457761262
             autocorr =       1.244669134343
              std dev =       0.580265935446
             le_variance =       0.336708555839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336596772747
                                         uncertainty =       0.002979535940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336596772747
                                         uncertainty =       0.002979535940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410326952
  error estimate for blocks of size 2^( 2) =       0.000423026318
  error estimate for blocks of size 2^( 3) =       0.000435498564
  error estimate for blocks of size 2^( 4) =       0.000446630158
  error estimate for blocks of size 2^( 5) =       0.000456532635
  error estimate for blocks of size 2^( 6) =       0.000463245877
  error estimate for blocks of size 2^( 7) =       0.000464692338

      target function =                  N/A
              le_mean =     -16.906513054051
             les_mean =     286.166919893108
             stat err =       0.000457775252
             autocorr =       1.244642231516
              std dev =       0.580289940192
             le_variance =       0.336736414688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336585154800
                                         uncertainty =       0.002979363149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336585154800
                                         uncertainty =       0.002979363149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410319868
  error estimate for blocks of size 2^( 2) =       0.000423019621
  error estimate for blocks of size 2^( 3) =       0.000435492229
  error estimate for blocks of size 2^( 4) =       0.000446624098
  error estimate for blocks of size 2^( 5) =       0.000456526758
  error estimate for blocks of size 2^( 6) =       0.000463240121
  error estimate for blocks of size 2^( 7) =       0.000464686920

      target function =                  N/A
              le_mean =     -16.906513078035
             les_mean =     286.166909077988
             stat err =       0.000457769474
             autocorr =       1.244653784985
              std dev =       0.580279922614
             le_variance =       0.336724788589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336571013333
                                         uncertainty =       0.002979151632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336571013333
                                         uncertainty =       0.002979151632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410311245
  error estimate for blocks of size 2^( 2) =       0.000423011431
  error estimate for blocks of size 2^( 3) =       0.000435484452
  error estimate for blocks of size 2^( 4) =       0.000446616649
  error estimate for blocks of size 2^( 5) =       0.000456519549
  error estimate for blocks of size 2^( 6) =       0.000463232979
  error estimate for blocks of size 2^( 7) =       0.000464680081

      target function =                  N/A
              le_mean =     -16.906513163841
             les_mean =     286.166897825822
             stat err =       0.000457762314
             autocorr =       1.244667169660
              std dev =       0.580267727055
             le_variance =       0.336710635061


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906513176997        initial  <--
     3.8147e+00     3.8147e+01             4.4315e-05       -16.906513054051
     1.5259e+01     1.5259e+02             1.1331e-05       -16.906513078035
     6.1035e+01     6.1035e+02             2.8873e-06       -16.906513163841

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2986
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.119563e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227846e-02 1 1  ON 2
 uu_3                -2.091422e-02 1 1  ON 3
 uu_4                -6.739315e-02 1 1  ON 4
 uu_5                -1.038629e-01 1 1  ON 5
 uu_6                -1.332096e-01 1 1  ON 6
 uu_7                -1.491687e-01 1 1  ON 7
 uu_8                -1.431058e-01 1 1  ON 8
 uu_9                -1.127121e-01 1 1  ON 9
 ud_0                 4.543882e-01 1 1  ON 10
 ud_1                 1.883263e-01 1 1  ON 11
 ud_2                 6.734297e-02 1 1  ON 12
 ud_3                -4.361325e-03 1 1  ON 13
 ud_4                -6.205377e-02 1 1  ON 14
 ud_5                -1.046273e-01 1 1  ON 15
 ud_6                -1.333939e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525465e-01 1 1  ON 18
 ud_9                -1.435974e-01 1 1  ON 19
 eO_0                -7.495075e-01 1 1  ON 20
 eO_1                -4.276917e-01 1 1  ON 21
 eO_2                -1.228630e-02 1 1  ON 22
 eO_3                 3.047742e-01 1 1  ON 23
 eO_4                 5.330055e-01 1 1  ON 24
 eO_5                 4.974628e-01 1 1  ON 25
 eO_6                 2.675124e-01 1 1  ON 26
 eO_7                -4.320020e-02 1 1  ON 27
 eO_8                -2.438784e-01 1 1  ON 28
 eO_9                -1.181693e-01 1 1  ON 29
eH1_0                -2.676088e-01 1 1  ON 30
eH1_1                -1.616493e-01 1 1  ON 31
eH1_2                -1.122972e-01 1 1  ON 32
eH1_3                -5.661899e-02 1 1  ON 33
eH1_4                -6.519416e-03 1 1  ON 34
eH1_5                 3.013094e-02 1 1  ON 35
eH1_6                 9.390942e-02 1 1  ON 36
eH1_7                 1.615712e-01 1 1  ON 37
eH1_8                 2.039363e-01 1 1  ON 38
eH1_9                 1.127277e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589179e-01 1 1  ON 41
eH2_2                -1.096167e-01 1 1  ON 42
eH2_3                -5.393559e-02 1 1  ON 43
eH2_4                -3.730757e-03 1 1  ON 44
eH2_5                 3.393207e-02 1 1  ON 45
eH2_6                 9.724789e-02 1 1  ON 46
eH2_7                 1.616516e-01 1 1  ON 47
eH2_8                 2.047336e-01 1 1  ON 48
eH2_9                 1.036276e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5249e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9496
    reference variance = 0.217898
====================================================
  Execution time = 2.0479e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3750e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337409266964
                                         uncertainty =       0.002974950856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337409266964
                                         uncertainty =       0.002974950856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410794828
  error estimate for blocks of size 2^( 2) =       0.000423518815
  error estimate for blocks of size 2^( 3) =       0.000436789163
  error estimate for blocks of size 2^( 4) =       0.000449316085
  error estimate for blocks of size 2^( 5) =       0.000460279741
  error estimate for blocks of size 2^( 6) =       0.000470257876
  error estimate for blocks of size 2^( 7) =       0.000474852341

      target function =                  N/A
              le_mean =     -16.906554190697
             les_mean =     286.169079215250
             stat err =       0.000463676511
             autocorr =       1.274031769556
              std dev =       0.580951616771
             le_variance =       0.337504781029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690655419070e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906554190697       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906554189170       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906554190718       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906554192865       residual = 5.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906554196136       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906554205480       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906554202064       residual = 8.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 4.673615e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906554190697       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906554190314       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906554190697       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906554191227       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906554192045       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906554194380       residual = 4.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906554193531       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.169205e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906554190697       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906554190601       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906554190697       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906554190829       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906554191033       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906554191617       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906554191405       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 2.923513e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6101e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.119567e-01 1 1  ON 0
 uu_1                 1.443609e-01 1 1  ON 1
 uu_2                 4.227834e-02 1 1  ON 2
 uu_3                -2.091415e-02 1 1  ON 3
 uu_4                -6.739342e-02 1 1  ON 4
 uu_5                -1.038623e-01 1 1  ON 5
 uu_6                -1.332096e-01 1 1  ON 6
 uu_7                -1.491686e-01 1 1  ON 7
 uu_8                -1.431058e-01 1 1  ON 8
 uu_9                -1.127130e-01 1 1  ON 9
 ud_0                 4.543882e-01 1 1  ON 10
 ud_1                 1.883271e-01 1 1  ON 11
 ud_2                 6.734319e-02 1 1  ON 12
 ud_3                -4.361394e-03 1 1  ON 13
 ud_4                -6.205330e-02 1 1  ON 14
 ud_5                -1.046274e-01 1 1  ON 15
 ud_6                -1.333931e-01 1 1  ON 16
 ud_7                -1.511898e-01 1 1  ON 17
 ud_8                -1.525472e-01 1 1  ON 18
 ud_9                -1.435979e-01 1 1  ON 19
 eO_0                -7.495068e-01 1 1  ON 20
 eO_1                -4.276915e-01 1 1  ON 21
 eO_2                -1.228576e-02 1 1  ON 22
 eO_3                 3.047742e-01 1 1  ON 23
 eO_4                 5.330055e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675126e-01 1 1  ON 26
 eO_7                -4.320025e-02 1 1  ON 27
 eO_8                -2.438791e-01 1 1  ON 28
 eO_9                -1.181703e-01 1 1  ON 29
eH1_0                -2.676095e-01 1 1  ON 30
eH1_1                -1.616496e-01 1 1  ON 31
eH1_2                -1.122973e-01 1 1  ON 32
eH1_3                -5.661899e-02 1 1  ON 33
eH1_4                -6.519795e-03 1 1  ON 34
eH1_5                 3.013088e-02 1 1  ON 35
eH1_6                 9.390968e-02 1 1  ON 36
eH1_7                 1.615713e-01 1 1  ON 37
eH1_8                 2.039366e-01 1 1  ON 38
eH1_9                 1.127285e-01 1 1  ON 39
eH2_0                -2.649527e-01 1 1  ON 40
eH2_1                -1.589186e-01 1 1  ON 41
eH2_2                -1.096172e-01 1 1  ON 42
eH2_3                -5.393563e-02 1 1  ON 43
eH2_4                -3.731188e-03 1 1  ON 44
eH2_5                 3.393132e-02 1 1  ON 45
eH2_6                 9.724809e-02 1 1  ON 46
eH2_7                 1.616517e-01 1 1  ON 47
eH2_8                 2.047339e-01 1 1  ON 48
eH2_9                 1.036288e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9178
    reference variance = 0.36227
====================================================
  Execution time = 2.2246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4421e-01
  Total weights = 2.0000e+06
  Execution time = 1.8753e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344137252566
                                         uncertainty =       0.005098185215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344137252566
                                         uncertainty =       0.005098185215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414852804
  error estimate for blocks of size 2^( 2) =       0.000427290870
  error estimate for blocks of size 2^( 3) =       0.000439499060
  error estimate for blocks of size 2^( 4) =       0.000451289204
  error estimate for blocks of size 2^( 5) =       0.000461723844
  error estimate for blocks of size 2^( 6) =       0.000469702841
  error estimate for blocks of size 2^( 7) =       0.000474290674

      target function =                  N/A
              le_mean =     -16.906348684543
             les_mean =     286.168831369063
             stat err =       0.000464251641
             autocorr =       1.252330146659
              std dev =       0.586690461672
             le_variance =       0.344205697816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344136105903
                                         uncertainty =       0.005098212199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344136105903
                                         uncertainty =       0.005098212199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414852113
  error estimate for blocks of size 2^( 2) =       0.000427290171
  error estimate for blocks of size 2^( 3) =       0.000439498351
  error estimate for blocks of size 2^( 4) =       0.000451288534
  error estimate for blocks of size 2^( 5) =       0.000461723192
  error estimate for blocks of size 2^( 6) =       0.000469702167
  error estimate for blocks of size 2^( 7) =       0.000474290037

      target function =                  N/A
              le_mean =     -16.906348673282
             les_mean =     286.168829841397
             stat err =       0.000464250983
             autocorr =       1.252330768187
              std dev =       0.586689484229
             le_variance =       0.344204550905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344136671279
                                         uncertainty =       0.005098198763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344136671279
                                         uncertainty =       0.005098198763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414852454
  error estimate for blocks of size 2^( 2) =       0.000427290516
  error estimate for blocks of size 2^( 3) =       0.000439498701
  error estimate for blocks of size 2^( 4) =       0.000451288865
  error estimate for blocks of size 2^( 5) =       0.000461723513
  error estimate for blocks of size 2^( 6) =       0.000469702500
  error estimate for blocks of size 2^( 7) =       0.000474290351

      target function =                  N/A
              le_mean =     -16.906348678849
             les_mean =     286.168830595111
             stat err =       0.000464251307
             autocorr =       1.252330462806
              std dev =       0.586689966168
             le_variance =       0.344205116402

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344137179646
                                         uncertainty =       0.005098186910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344137179646
                                         uncertainty =       0.005098186910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414852760
  error estimate for blocks of size 2^( 2) =       0.000427290826
  error estimate for blocks of size 2^( 3) =       0.000439499015
  error estimate for blocks of size 2^( 4) =       0.000451289162
  error estimate for blocks of size 2^( 5) =       0.000461723802
  error estimate for blocks of size 2^( 6) =       0.000469702799
  error estimate for blocks of size 2^( 7) =       0.000474290633

      target function =                  N/A
              le_mean =     -16.906348683828
             les_mean =     286.168831271959
             stat err =       0.000464251599
             autocorr =       1.252330186346
              std dev =       0.586690399512
             le_variance =       0.344205624880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906348684543        initial  <--
     3.8147e+01     3.8147e+02             4.6736e-06       -16.906348673282
     1.5259e+02     1.5259e+03             1.1692e-06       -16.906348678849
     6.1035e+02     6.1035e+03             2.9235e-07       -16.906348683828

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.7279
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.119563e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227846e-02 1 1  ON 2
 uu_3                -2.091422e-02 1 1  ON 3
 uu_4                -6.739315e-02 1 1  ON 4
 uu_5                -1.038629e-01 1 1  ON 5
 uu_6                -1.332096e-01 1 1  ON 6
 uu_7                -1.491687e-01 1 1  ON 7
 uu_8                -1.431058e-01 1 1  ON 8
 uu_9                -1.127121e-01 1 1  ON 9
 ud_0                 4.543882e-01 1 1  ON 10
 ud_1                 1.883263e-01 1 1  ON 11
 ud_2                 6.734297e-02 1 1  ON 12
 ud_3                -4.361325e-03 1 1  ON 13
 ud_4                -6.205377e-02 1 1  ON 14
 ud_5                -1.046273e-01 1 1  ON 15
 ud_6                -1.333939e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525465e-01 1 1  ON 18
 ud_9                -1.435974e-01 1 1  ON 19
 eO_0                -7.495075e-01 1 1  ON 20
 eO_1                -4.276917e-01 1 1  ON 21
 eO_2                -1.228630e-02 1 1  ON 22
 eO_3                 3.047742e-01 1 1  ON 23
 eO_4                 5.330055e-01 1 1  ON 24
 eO_5                 4.974628e-01 1 1  ON 25
 eO_6                 2.675124e-01 1 1  ON 26
 eO_7                -4.320020e-02 1 1  ON 27
 eO_8                -2.438784e-01 1 1  ON 28
 eO_9                -1.181693e-01 1 1  ON 29
eH1_0                -2.676088e-01 1 1  ON 30
eH1_1                -1.616493e-01 1 1  ON 31
eH1_2                -1.122972e-01 1 1  ON 32
eH1_3                -5.661899e-02 1 1  ON 33
eH1_4                -6.519416e-03 1 1  ON 34
eH1_5                 3.013094e-02 1 1  ON 35
eH1_6                 9.390942e-02 1 1  ON 36
eH1_7                 1.615712e-01 1 1  ON 37
eH1_8                 2.039363e-01 1 1  ON 38
eH1_9                 1.127277e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589179e-01 1 1  ON 41
eH2_2                -1.096167e-01 1 1  ON 42
eH2_3                -5.393559e-02 1 1  ON 43
eH2_4                -3.730757e-03 1 1  ON 44
eH2_5                 3.393207e-02 1 1  ON 45
eH2_6                 9.724789e-02 1 1  ON 46
eH2_7                 1.616516e-01 1 1  ON 47
eH2_8                 2.047336e-01 1 1  ON 48
eH2_9                 1.036276e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7836e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9816
    reference variance = 0.285698
====================================================
  Execution time = 2.0610e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.6177e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6022e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361833699202
                                         uncertainty =       0.018738933663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.361833699202
                                         uncertainty =       0.018738933663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000425304561
  error estimate for blocks of size 2^( 2) =       0.000437586404
  error estimate for blocks of size 2^( 3) =       0.000450150343
  error estimate for blocks of size 2^( 4) =       0.000461917519
  error estimate for blocks of size 2^( 5) =       0.000471836406
  error estimate for blocks of size 2^( 6) =       0.000478844368
  error estimate for blocks of size 2^( 7) =       0.000483261971

      target function =                  N/A
              le_mean =     -16.906526303068
             les_mean =     286.192399395363
             stat err =       0.000473965066
             autocorr =       1.241917035371
              std dev =       0.601471478881
             le_variance =       0.361767939907


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690652630307e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906526303068       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906526305421       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906526306742       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906526307121       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906526306946       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906526306427       residual = 5.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906526306732       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906526306809       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.623777e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906526303068       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906526303657       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906526303987       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906526304082       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906526304039       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906526303909       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906526303972       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906526304004       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.156025e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906526303068       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906526303215       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906526303298       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906526303323       residual = 6.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906526303311       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906526303269       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906526303285       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906526303298       residual = 2.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 2.890113e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.148756 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6220e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.119563e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227846e-02 1 1  ON 2
 uu_3                -2.091425e-02 1 1  ON 3
 uu_4                -6.739309e-02 1 1  ON 4
 uu_5                -1.038628e-01 1 1  ON 5
 uu_6                -1.332097e-01 1 1  ON 6
 uu_7                -1.491687e-01 1 1  ON 7
 uu_8                -1.431058e-01 1 1  ON 8
 uu_9                -1.127122e-01 1 1  ON 9
 ud_0                 4.543883e-01 1 1  ON 10
 ud_1                 1.883264e-01 1 1  ON 11
 ud_2                 6.734297e-02 1 1  ON 12
 ud_3                -4.361293e-03 1 1  ON 13
 ud_4                -6.205380e-02 1 1  ON 14
 ud_5                -1.046273e-01 1 1  ON 15
 ud_6                -1.333938e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525465e-01 1 1  ON 18
 ud_9                -1.435975e-01 1 1  ON 19
 eO_0                -7.495074e-01 1 1  ON 20
 eO_1                -4.276917e-01 1 1  ON 21
 eO_2                -1.228626e-02 1 1  ON 22
 eO_3                 3.047742e-01 1 1  ON 23
 eO_4                 5.330055e-01 1 1  ON 24
 eO_5                 4.974627e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320018e-02 1 1  ON 27
 eO_8                -2.438785e-01 1 1  ON 28
 eO_9                -1.181694e-01 1 1  ON 29
eH1_0                -2.676089e-01 1 1  ON 30
eH1_1                -1.616493e-01 1 1  ON 31
eH1_2                -1.122971e-01 1 1  ON 32
eH1_3                -5.661906e-02 1 1  ON 33
eH1_4                -6.519461e-03 1 1  ON 34
eH1_5                 3.013101e-02 1 1  ON 35
eH1_6                 9.390943e-02 1 1  ON 36
eH1_7                 1.615712e-01 1 1  ON 37
eH1_8                 2.039364e-01 1 1  ON 38
eH1_9                 1.127278e-01 1 1  ON 39
eH2_0                -2.649531e-01 1 1  ON 40
eH2_1                -1.589179e-01 1 1  ON 41
eH2_2                -1.096167e-01 1 1  ON 42
eH2_3                -5.393560e-02 1 1  ON 43
eH2_4                -3.730740e-03 1 1  ON 44
eH2_5                 3.393203e-02 1 1  ON 45
eH2_6                 9.724786e-02 1 1  ON 46
eH2_7                 1.616515e-01 1 1  ON 47
eH2_8                 2.047336e-01 1 1  ON 48
eH2_9                 1.036277e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8329
    reference variance = 0.195845
====================================================
  Execution time = 2.0023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3696e-01
  Total weights = 2.0000e+06
  Execution time = 1.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336989803798
                                         uncertainty =       0.004434362255

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336989803798
                                         uncertainty =       0.004434362255

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410461136
  error estimate for blocks of size 2^( 2) =       0.000422932723
  error estimate for blocks of size 2^( 3) =       0.000436670038
  error estimate for blocks of size 2^( 4) =       0.000449127464
  error estimate for blocks of size 2^( 5) =       0.000460415834
  error estimate for blocks of size 2^( 6) =       0.000470816635
  error estimate for blocks of size 2^( 7) =       0.000478223278

      target function =                  N/A
              le_mean =     -16.905563390780
             les_mean =     286.135030079828
             stat err =       0.000464645803
             autocorr =       1.281444942769
              std dev =       0.580479705597
             le_variance =       0.336956688610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336989883247
                                         uncertainty =       0.004434361953

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336989883247
                                         uncertainty =       0.004434361953

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410461185
  error estimate for blocks of size 2^( 2) =       0.000422932767
  error estimate for blocks of size 2^( 3) =       0.000436670081
  error estimate for blocks of size 2^( 4) =       0.000449127508
  error estimate for blocks of size 2^( 5) =       0.000460415878
  error estimate for blocks of size 2^( 6) =       0.000470816674
  error estimate for blocks of size 2^( 7) =       0.000478223314

      target function =                  N/A
              le_mean =     -16.905563391752
             les_mean =     286.135030192145
             stat err =       0.000464645844
             autocorr =       1.281444864478
              std dev =       0.580479774042
             le_variance =       0.336956768072

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336989843551
                                         uncertainty =       0.004434362102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336989843551
                                         uncertainty =       0.004434362102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410461160
  error estimate for blocks of size 2^( 2) =       0.000422932745
  error estimate for blocks of size 2^( 3) =       0.000436670060
  error estimate for blocks of size 2^( 4) =       0.000449127486
  error estimate for blocks of size 2^( 5) =       0.000460415856
  error estimate for blocks of size 2^( 6) =       0.000470816655
  error estimate for blocks of size 2^( 7) =       0.000478223296

      target function =                  N/A
              le_mean =     -16.905563391267
             les_mean =     286.135030136025
             stat err =       0.000464645823
             autocorr =       1.281444903598
              std dev =       0.580479739844
             le_variance =       0.336956728370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336989808767
                                         uncertainty =       0.004434362236

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336989808767
                                         uncertainty =       0.004434362236

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410461139
  error estimate for blocks of size 2^( 2) =       0.000422932725
  error estimate for blocks of size 2^( 3) =       0.000436670040
  error estimate for blocks of size 2^( 4) =       0.000449127467
  error estimate for blocks of size 2^( 5) =       0.000460415837
  error estimate for blocks of size 2^( 6) =       0.000470816637
  error estimate for blocks of size 2^( 7) =       0.000478223281

      target function =                  N/A
              le_mean =     -16.905563390841
             les_mean =     286.135030086853
             stat err =       0.000464645806
             autocorr =       1.281444937872
              std dev =       0.580479709879
             le_variance =       0.336956693581


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905563390780        initial
     3.8147e+02     3.8147e+03             4.6238e-07       -16.905563391752  <--
     1.5259e+03     1.5259e+04             1.1560e-07       -16.905563391267
     6.1035e+03     6.1035e+04             2.8901e-08       -16.905563390841

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 2.9464e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.119563e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227848e-02 1 1  ON 2
 uu_3                -2.091432e-02 1 1  ON 3
 uu_4                -6.739289e-02 1 1  ON 4
 uu_5                -1.038627e-01 1 1  ON 5
 uu_6                -1.332099e-01 1 1  ON 6
 uu_7                -1.491687e-01 1 1  ON 7
 uu_8                -1.431057e-01 1 1  ON 8
 uu_9                -1.127125e-01 1 1  ON 9
 ud_0                 4.543884e-01 1 1  ON 10
 ud_1                 1.883265e-01 1 1  ON 11
 ud_2                 6.734297e-02 1 1  ON 12
 ud_3                -4.361197e-03 1 1  ON 13
 ud_4                -6.205387e-02 1 1  ON 14
 ud_5                -1.046272e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511898e-01 1 1  ON 17
 ud_8                -1.525467e-01 1 1  ON 18
 ud_9                -1.435977e-01 1 1  ON 19
 eO_0                -7.495072e-01 1 1  ON 20
 eO_1                -4.276917e-01 1 1  ON 21
 eO_2                -1.228614e-02 1 1  ON 22
 eO_3                 3.047743e-01 1 1  ON 23
 eO_4                 5.330057e-01 1 1  ON 24
 eO_5                 4.974626e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320013e-02 1 1  ON 27
 eO_8                -2.438787e-01 1 1  ON 28
 eO_9                -1.181698e-01 1 1  ON 29
eH1_0                -2.676090e-01 1 1  ON 30
eH1_1                -1.616495e-01 1 1  ON 31
eH1_2                -1.122971e-01 1 1  ON 32
eH1_3                -5.661929e-02 1 1  ON 33
eH1_4                -6.519596e-03 1 1  ON 34
eH1_5                 3.013121e-02 1 1  ON 35
eH1_6                 9.390945e-02 1 1  ON 36
eH1_7                 1.615712e-01 1 1  ON 37
eH1_8                 2.039364e-01 1 1  ON 38
eH1_9                 1.127281e-01 1 1  ON 39
eH2_0                -2.649532e-01 1 1  ON 40
eH2_1                -1.589180e-01 1 1  ON 41
eH2_2                -1.096166e-01 1 1  ON 42
eH2_3                -5.393563e-02 1 1  ON 43
eH2_4                -3.730689e-03 1 1  ON 44
eH2_5                 3.393190e-02 1 1  ON 45
eH2_6                 9.724778e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047336e-01 1 1  ON 48
eH2_9                 1.036281e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5691e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9119
    reference variance = 0.254001
====================================================
  Execution time = 2.0565e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 4.0077e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.400956723697
                                         uncertainty =       0.060232128839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.400956723697
                                         uncertainty =       0.060232128839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000447646414
  error estimate for blocks of size 2^( 2) =       0.000459242059
  error estimate for blocks of size 2^( 3) =       0.000470114571
  error estimate for blocks of size 2^( 4) =       0.000481258924
  error estimate for blocks of size 2^( 5) =       0.000491014134
  error estimate for blocks of size 2^( 6) =       0.000498969613
  error estimate for blocks of size 2^( 7) =       0.000500972186

      target function =                  N/A
              le_mean =     -16.905738377907
             les_mean =     286.204764525416
             stat err =       0.000493053714
             autocorr =       1.213160468023
              std dev =       0.633067629533
             le_variance =       0.400774623562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573837791e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905738377907       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905738380242       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738380971       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905738386430       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905738389576       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905738386197       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905738386110       residual = 9.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.805296e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905738377907       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905738378492       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738378674       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905738380040       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905738380831       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905738379985       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905738379962       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.516303e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905738377907       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905738378053       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905738378099       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905738378440       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905738378639       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905738378428       residual = 7.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905738378421       residual = 9.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.129268e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.150985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6133e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.119561e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227874e-02 1 1  ON 2
 uu_3                -2.091404e-02 1 1  ON 3
 uu_4                -6.739293e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332100e-01 1 1  ON 6
 uu_7                -1.491686e-01 1 1  ON 7
 uu_8                -1.431058e-01 1 1  ON 8
 uu_9                -1.127128e-01 1 1  ON 9
 ud_0                 4.543886e-01 1 1  ON 10
 ud_1                 1.883266e-01 1 1  ON 11
 ud_2                 6.734313e-02 1 1  ON 12
 ud_3                -4.361249e-03 1 1  ON 13
 ud_4                -6.205386e-02 1 1  ON 14
 ud_5                -1.046270e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511898e-01 1 1  ON 17
 ud_8                -1.525469e-01 1 1  ON 18
 ud_9                -1.435978e-01 1 1  ON 19
 eO_0                -7.495071e-01 1 1  ON 20
 eO_1                -4.276916e-01 1 1  ON 21
 eO_2                -1.228623e-02 1 1  ON 22
 eO_3                 3.047742e-01 1 1  ON 23
 eO_4                 5.330061e-01 1 1  ON 24
 eO_5                 4.974627e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320011e-02 1 1  ON 27
 eO_8                -2.438789e-01 1 1  ON 28
 eO_9                -1.181701e-01 1 1  ON 29
eH1_0                -2.676091e-01 1 1  ON 30
eH1_1                -1.616496e-01 1 1  ON 31
eH1_2                -1.122974e-01 1 1  ON 32
eH1_3                -5.661968e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013103e-02 1 1  ON 35
eH1_6                 9.390960e-02 1 1  ON 36
eH1_7                 1.615715e-01 1 1  ON 37
eH1_8                 2.039366e-01 1 1  ON 38
eH1_9                 1.127285e-01 1 1  ON 39
eH2_0                -2.649532e-01 1 1  ON 40
eH2_1                -1.589179e-01 1 1  ON 41
eH2_2                -1.096168e-01 1 1  ON 42
eH2_3                -5.393583e-02 1 1  ON 43
eH2_4                -3.730729e-03 1 1  ON 44
eH2_5                 3.393178e-02 1 1  ON 45
eH2_6                 9.724756e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047338e-01 1 1  ON 48
eH2_9                 1.036285e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.8433
    reference variance = 0.158343
====================================================
  Execution time = 1.9865e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3556e-01
  Total weights = 2.0000e+06
  Execution time = 1.8749e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335549594080
                                         uncertainty =       0.004564768226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335549594080
                                         uncertainty =       0.004564768226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409611352
  error estimate for blocks of size 2^( 2) =       0.000422345630
  error estimate for blocks of size 2^( 3) =       0.000435135536
  error estimate for blocks of size 2^( 4) =       0.000448378233
  error estimate for blocks of size 2^( 5) =       0.000459343259
  error estimate for blocks of size 2^( 6) =       0.000466132051
  error estimate for blocks of size 2^( 7) =       0.000473965654

      target function =                  N/A
              le_mean =     -16.906642009104
             les_mean =     286.170106775263
             stat err =       0.000461954800
             autocorr =       1.271905950743
              std dev =       0.579277929023
             le_variance =       0.335562919053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335549221665
                                         uncertainty =       0.004564773874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335549221665
                                         uncertainty =       0.004564773874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409611125
  error estimate for blocks of size 2^( 2) =       0.000422345414
  error estimate for blocks of size 2^( 3) =       0.000435135322
  error estimate for blocks of size 2^( 4) =       0.000448378002
  error estimate for blocks of size 2^( 5) =       0.000459343020
  error estimate for blocks of size 2^( 6) =       0.000466131814
  error estimate for blocks of size 2^( 7) =       0.000473965418

      target function =                  N/A
              le_mean =     -16.906642009772
             les_mean =     286.170106425631
             stat err =       0.000461954564
             autocorr =       1.271906062668
              std dev =       0.579277607726
             le_variance =       0.335562546813

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335549406721
                                         uncertainty =       0.004564771060

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335549406721
                                         uncertainty =       0.004564771060

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409611238
  error estimate for blocks of size 2^( 2) =       0.000422345522
  error estimate for blocks of size 2^( 3) =       0.000435135429
  error estimate for blocks of size 2^( 4) =       0.000448378117
  error estimate for blocks of size 2^( 5) =       0.000459343139
  error estimate for blocks of size 2^( 6) =       0.000466131932
  error estimate for blocks of size 2^( 7) =       0.000473965535

      target function =                  N/A
              le_mean =     -16.906642009431
             les_mean =     286.170106599055
             stat err =       0.000461954681
             autocorr =       1.271906007960
              std dev =       0.579277767381
             le_variance =       0.335562731781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335549570623
                                         uncertainty =       0.004564768581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335549570623
                                         uncertainty =       0.004564768581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409611337
  error estimate for blocks of size 2^( 2) =       0.000422345616
  error estimate for blocks of size 2^( 3) =       0.000435135523
  error estimate for blocks of size 2^( 4) =       0.000448378219
  error estimate for blocks of size 2^( 5) =       0.000459343244
  error estimate for blocks of size 2^( 6) =       0.000466132037
  error estimate for blocks of size 2^( 7) =       0.000473965639

      target function =                  N/A
              le_mean =     -16.906642009144
             les_mean =     286.170106753186
             stat err =       0.000461954785
             autocorr =       1.271905957934
              std dev =       0.579277908785
             le_variance =       0.335562895607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906642009104        initial
     9.5367e+01     9.5367e+02             1.8053e-06       -16.906642009772  <--
     3.8147e+02     3.8147e+03             4.5163e-07       -16.906642009431
     1.5259e+03     1.5259e+04             1.1293e-07       -16.906642009144

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.9335e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361400e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519588e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730847e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036298e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5475e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.0053
    reference variance = 0.486451
====================================================
  Execution time = 2.0309e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3843e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336778845356
                                         uncertainty =       0.004603551841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336778845356
                                         uncertainty =       0.004603551841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411360590
  error estimate for blocks of size 2^( 2) =       0.000423828303
  error estimate for blocks of size 2^( 3) =       0.000437047174
  error estimate for blocks of size 2^( 4) =       0.000448841523
  error estimate for blocks of size 2^( 5) =       0.000459767569
  error estimate for blocks of size 2^( 6) =       0.000467111793
  error estimate for blocks of size 2^( 7) =       0.000472147931

      target function =                  N/A
              le_mean =     -16.905690629469
             les_mean =     286.140810559699
             stat err =       0.000461967204
             autocorr =       1.261179567480
              std dev =       0.581751725058
             le_variance =       0.338435069608


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690569062947e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690629469       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690651978       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690678774       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690683343       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690687025       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690685238       residual = 5.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690688415       residual = 9.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 6.643185e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690629469       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690635128       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690641876       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690643034       residual = 5.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690643963       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690643510       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690644274       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.663697e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905690629469       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690630886       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690632576       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905690632866       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690633099       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905690632985       residual = 5.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905690633175       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.161053e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153169 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5880e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.119557e-01 1 1  ON 0
 uu_1                 1.443609e-01 1 1  ON 1
 uu_2                 4.227962e-02 1 1  ON 2
 uu_3                -2.091315e-02 1 1  ON 3
 uu_4                -6.739429e-02 1 1  ON 4
 uu_5                -1.038610e-01 1 1  ON 5
 uu_6                -1.332104e-01 1 1  ON 6
 uu_7                -1.491681e-01 1 1  ON 7
 uu_8                -1.431057e-01 1 1  ON 8
 uu_9                -1.127154e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883278e-01 1 1  ON 11
 ud_2                 6.734410e-02 1 1  ON 12
 ud_3                -4.360184e-03 1 1  ON 13
 ud_4                -6.205399e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333931e-01 1 1  ON 16
 ud_7                -1.511906e-01 1 1  ON 17
 ud_8                -1.525489e-01 1 1  ON 18
 ud_9                -1.435985e-01 1 1  ON 19
 eO_0                -7.495058e-01 1 1  ON 20
 eO_1                -4.276910e-01 1 1  ON 21
 eO_2                -1.228697e-02 1 1  ON 22
 eO_3                 3.047748e-01 1 1  ON 23
 eO_4                 5.330083e-01 1 1  ON 24
 eO_5                 4.974638e-01 1 1  ON 25
 eO_6                 2.675121e-01 1 1  ON 26
 eO_7                -4.320008e-02 1 1  ON 27
 eO_8                -2.438806e-01 1 1  ON 28
 eO_9                -1.181724e-01 1 1  ON 29
eH1_0                -2.676100e-01 1 1  ON 30
eH1_1                -1.616506e-01 1 1  ON 31
eH1_2                -1.122982e-01 1 1  ON 32
eH1_3                -5.662188e-02 1 1  ON 33
eH1_4                -6.520525e-03 1 1  ON 34
eH1_5                 3.013175e-02 1 1  ON 35
eH1_6                 9.390975e-02 1 1  ON 36
eH1_7                 1.615715e-01 1 1  ON 37
eH1_8                 2.039381e-01 1 1  ON 38
eH1_9                 1.127314e-01 1 1  ON 39
eH2_0                -2.649536e-01 1 1  ON 40
eH2_1                -1.589175e-01 1 1  ON 41
eH2_2                -1.096181e-01 1 1  ON 42
eH2_3                -5.393578e-02 1 1  ON 43
eH2_4                -3.731421e-03 1 1  ON 44
eH2_5                 3.393128e-02 1 1  ON 45
eH2_6                 9.724706e-02 1 1  ON 46
eH2_7                 1.616507e-01 1 1  ON 47
eH2_8                 2.047340e-01 1 1  ON 48
eH2_9                 1.036314e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.426178
====================================================
  Execution time = 1.9776e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3952e-01
  Total weights = 2.0000e+06
  Execution time = 1.8783e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544255210
                                         uncertainty =       0.005213109171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544255210
                                         uncertainty =       0.005213109171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412018273
  error estimate for blocks of size 2^( 2) =       0.000424237383
  error estimate for blocks of size 2^( 3) =       0.000436850491
  error estimate for blocks of size 2^( 4) =       0.000448349041
  error estimate for blocks of size 2^( 5) =       0.000458286139
  error estimate for blocks of size 2^( 6) =       0.000464881404
  error estimate for blocks of size 2^( 7) =       0.000470985767

      target function =                  N/A
              le_mean =     -16.906269247496
             les_mean =     286.161457814126
             stat err =       0.000460625588
             autocorr =       1.249865161861
              std dev =       0.582681830044
             le_variance =       0.339518115063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339542073039
                                         uncertainty =       0.005213111768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339542073039
                                         uncertainty =       0.005213111768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412016949
  error estimate for blocks of size 2^( 2) =       0.000424236089
  error estimate for blocks of size 2^( 3) =       0.000436849260
  error estimate for blocks of size 2^( 4) =       0.000448347856
  error estimate for blocks of size 2^( 5) =       0.000458284952
  error estimate for blocks of size 2^( 6) =       0.000464880220
  error estimate for blocks of size 2^( 7) =       0.000470984585

      target function =                  N/A
              le_mean =     -16.906269214112
             les_mean =     286.161454503257
             stat err =       0.000460624403
             autocorr =       1.249866767107
              std dev =       0.582679957597
             le_variance =       0.339515932986

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339543152319
                                         uncertainty =       0.005213110568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339543152319
                                         uncertainty =       0.005213110568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412017604
  error estimate for blocks of size 2^( 2) =       0.000424236729
  error estimate for blocks of size 2^( 3) =       0.000436849870
  error estimate for blocks of size 2^( 4) =       0.000448348443
  error estimate for blocks of size 2^( 5) =       0.000458285539
  error estimate for blocks of size 2^( 6) =       0.000464880806
  error estimate for blocks of size 2^( 7) =       0.000470985170

      target function =                  N/A
              le_mean =     -16.906269230723
             les_mean =     286.161456144169
             stat err =       0.000460624990
             autocorr =       1.249865976628
              std dev =       0.582680883694
             le_variance =       0.339517012222

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544116953
                                         uncertainty =       0.005213109349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339544116953
                                         uncertainty =       0.005213109349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412018189
  error estimate for blocks of size 2^( 2) =       0.000424237301
  error estimate for blocks of size 2^( 3) =       0.000436850413
  error estimate for blocks of size 2^( 4) =       0.000448348966
  error estimate for blocks of size 2^( 5) =       0.000458286063
  error estimate for blocks of size 2^( 6) =       0.000464881329
  error estimate for blocks of size 2^( 7) =       0.000470985692

      target function =                  N/A
              le_mean =     -16.906269245393
             les_mean =     286.161457604786
             stat err =       0.000460625513
             autocorr =       1.249865264089
              std dev =       0.582681711410
             le_variance =       0.339517976812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906269247496        initial  <--
     2.3842e+01     2.3842e+02             6.6432e-06       -16.906269214112
     9.5367e+01     9.5367e+02             1.6637e-06       -16.906269230723
     3.8147e+02     3.8147e+03             4.1611e-07       -16.906269245393

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2644
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361400e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519588e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730847e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036298e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5153e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.7877
    reference variance = 0.853031
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3622e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336092401200
                                         uncertainty =       0.002756724427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336092401200
                                         uncertainty =       0.002756724427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410015298
  error estimate for blocks of size 2^( 2) =       0.000422935388
  error estimate for blocks of size 2^( 3) =       0.000436239666
  error estimate for blocks of size 2^( 4) =       0.000448682685
  error estimate for blocks of size 2^( 5) =       0.000459026692
  error estimate for blocks of size 2^( 6) =       0.000466929219
  error estimate for blocks of size 2^( 7) =       0.000473128632

      target function =                  N/A
              le_mean =     -16.905789774299
             les_mean =     286.141952814070
             stat err =       0.000461941807
             autocorr =       1.269329623626
              std dev =       0.579849195399
             le_variance =       0.336225089405


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578977430e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905789774299       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905789773153       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905789773757       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905789775935       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905789774844       residual = 9.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905789775477       residual = 4.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905789775113       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905789774776       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 7.609135e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905789774299       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905789774012       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905789774163       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905789774708       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905789774437       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905789774594       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905789774502       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905789774419       residual = 4.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.902462e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905789774299       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905789774227       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905789774265       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905789774401       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905789774331       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905789774373       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905789774353       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905789774327       residual = 4.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 4.756267e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.155778 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5870e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.119554e-01 1 1  ON 0
 uu_1                 1.443613e-01 1 1  ON 1
 uu_2                 4.227949e-02 1 1  ON 2
 uu_3                -2.091313e-02 1 1  ON 3
 uu_4                -6.739310e-02 1 1  ON 4
 uu_5                -1.038625e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127138e-01 1 1  ON 9
 ud_0                 4.543892e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734352e-02 1 1  ON 12
 ud_3                -4.361468e-03 1 1  ON 13
 ud_4                -6.205384e-02 1 1  ON 14
 ud_5                -1.046265e-01 1 1  ON 15
 ud_6                -1.333934e-01 1 1  ON 16
 ud_7                -1.511898e-01 1 1  ON 17
 ud_8                -1.525475e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276911e-01 1 1  ON 21
 eO_2                -1.228644e-02 1 1  ON 22
 eO_3                 3.047741e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320006e-02 1 1  ON 27
 eO_8                -2.438798e-01 1 1  ON 28
 eO_9                -1.181712e-01 1 1  ON 29
eH1_0                -2.676096e-01 1 1  ON 30
eH1_1                -1.616499e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662091e-02 1 1  ON 33
eH1_4                -6.519636e-03 1 1  ON 34
eH1_5                 3.013044e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039373e-01 1 1  ON 38
eH1_9                 1.127299e-01 1 1  ON 39
eH2_0                -2.649531e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096175e-01 1 1  ON 42
eH2_3                -5.393636e-02 1 1  ON 43
eH2_4                -3.730715e-03 1 1  ON 44
eH2_5                 3.393132e-02 1 1  ON 45
eH2_6                 9.724680e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036300e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9439
    reference variance = 0.267535
====================================================
  Execution time = 1.9818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5035e-01
  Total weights = 2.0000e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350432631068
                                         uncertainty =       0.008290585340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350432631068
                                         uncertainty =       0.008290585340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418540207
  error estimate for blocks of size 2^( 2) =       0.000430878799
  error estimate for blocks of size 2^( 3) =       0.000443288201
  error estimate for blocks of size 2^( 4) =       0.000454853507
  error estimate for blocks of size 2^( 5) =       0.000466710562
  error estimate for blocks of size 2^( 6) =       0.000472885981
  error estimate for blocks of size 2^( 7) =       0.000479378784

      target function =                  N/A
              le_mean =     -16.907086358750
             les_mean =     286.199920777146
             stat err =       0.000468457208
             autocorr =       1.252753088168
              std dev =       0.591905237433
             le_variance =       0.350351810100

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350433532266
                                         uncertainty =       0.008290580312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350433532266
                                         uncertainty =       0.008290580312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418540745
  error estimate for blocks of size 2^( 2) =       0.000430879301
  error estimate for blocks of size 2^( 3) =       0.000443288668
  error estimate for blocks of size 2^( 4) =       0.000454853946
  error estimate for blocks of size 2^( 5) =       0.000466710985
  error estimate for blocks of size 2^( 6) =       0.000472886404
  error estimate for blocks of size 2^( 7) =       0.000479379215

      target function =                  N/A
              le_mean =     -16.907086355665
             les_mean =     286.199921573900
             stat err =       0.000468457637
             autocorr =       1.252752160999
              std dev =       0.591905998596
             le_variance =       0.350352711174

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350433082179
                                         uncertainty =       0.008290582809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350433082179
                                         uncertainty =       0.008290582809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418540477
  error estimate for blocks of size 2^( 2) =       0.000430879050
  error estimate for blocks of size 2^( 3) =       0.000443288435
  error estimate for blocks of size 2^( 4) =       0.000454853727
  error estimate for blocks of size 2^( 5) =       0.000466710774
  error estimate for blocks of size 2^( 6) =       0.000472886193
  error estimate for blocks of size 2^( 7) =       0.000479379000

      target function =                  N/A
              le_mean =     -16.907086357203
             les_mean =     286.199921175877
             stat err =       0.000468457423
             autocorr =       1.252752624002
              std dev =       0.591905618447
             le_variance =       0.350352261149

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350432687473
                                         uncertainty =       0.008290585023

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350432687473
                                         uncertainty =       0.008290585023

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418540241
  error estimate for blocks of size 2^( 2) =       0.000430878830
  error estimate for blocks of size 2^( 3) =       0.000443288230
  error estimate for blocks of size 2^( 4) =       0.000454853534
  error estimate for blocks of size 2^( 5) =       0.000466710588
  error estimate for blocks of size 2^( 6) =       0.000472886008
  error estimate for blocks of size 2^( 7) =       0.000479378811

      target function =                  N/A
              le_mean =     -16.907086358556
             les_mean =     286.199920826996
             stat err =       0.000468457235
             autocorr =       1.252753030125
              std dev =       0.591905285073
             le_variance =       0.350351866497


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907086358750        initial  <--
     2.3842e+02     2.3842e+03             7.6091e-07       -16.907086355665
     9.5367e+02     9.5367e+03             1.9025e-07       -16.907086357203
     3.8147e+03     3.8147e+04             4.7563e-08       -16.907086358556

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3159
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361400e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519588e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730847e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036298e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5194e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9491
    reference variance = 0.218028
====================================================
  Execution time = 2.0330e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4046e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5096e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340433480210
                                         uncertainty =       0.005763802449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340433480210
                                         uncertainty =       0.005763802449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412589185
  error estimate for blocks of size 2^( 2) =       0.000425111262
  error estimate for blocks of size 2^( 3) =       0.000438423590
  error estimate for blocks of size 2^( 4) =       0.000451008213
  error estimate for blocks of size 2^( 5) =       0.000461596763
  error estimate for blocks of size 2^( 6) =       0.000469526216
  error estimate for blocks of size 2^( 7) =       0.000476992747

      target function =                  N/A
              le_mean =     -16.906605389015
             les_mean =     286.173765281475
             stat err =       0.000464780985
             autocorr =       1.268998249161
              std dev =       0.583489221682
             le_variance =       0.340459671820


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660538902e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906605389015       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906605389226       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906605389240       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906605389308       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906605389192       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906605389075       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906605389129       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906605389094       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 7.974717e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906605389015       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906605389068       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906605389071       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906605389087       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906605389066       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906605389027       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906605389044       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906605389032       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 1.993693e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906605389015       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906605389029       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906605389029       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906605389034       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906605389062       residual = 2.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906605389015       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906605388916       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906605388988       residual = 2.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 4.984242e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.158379 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5847e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091317e-02 1 1  ON 3
 uu_4                -6.739303e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361407e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228650e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320005e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519598e-03 1 1  ON 34
eH1_5                 3.013048e-02 1 1  ON 35
eH1_6                 9.391006e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730860e-03 1 1  ON 44
eH2_5                 3.393141e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9278
    reference variance = 0.25273
====================================================
  Execution time = 1.9990e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5531e-01
  Total weights = 2.0000e+06
  Execution time = 1.8851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355292614214
                                         uncertainty =       0.012821604804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355292614214
                                         uncertainty =       0.012821604804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421493484
  error estimate for blocks of size 2^( 2) =       0.000434258516
  error estimate for blocks of size 2^( 3) =       0.000446862742
  error estimate for blocks of size 2^( 4) =       0.000459182509
  error estimate for blocks of size 2^( 5) =       0.000471032396
  error estimate for blocks of size 2^( 6) =       0.000480396958
  error estimate for blocks of size 2^( 7) =       0.000488650613

      target function =                  N/A
              le_mean =     -16.906433472719
             les_mean =     286.182806104685
             stat err =       0.000474815619
             autocorr =       1.269019402942
              std dev =       0.596081802171
             le_variance =       0.355313514879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355292670905
                                         uncertainty =       0.012821606994

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355292670905
                                         uncertainty =       0.012821606994

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421493518
  error estimate for blocks of size 2^( 2) =       0.000434258548
  error estimate for blocks of size 2^( 3) =       0.000446862773
  error estimate for blocks of size 2^( 4) =       0.000459182538
  error estimate for blocks of size 2^( 5) =       0.000471032424
  error estimate for blocks of size 2^( 6) =       0.000480396987
  error estimate for blocks of size 2^( 7) =       0.000488650641

      target function =                  N/A
              le_mean =     -16.906433472583
             les_mean =     286.182806156790
             stat err =       0.000474815648
             autocorr =       1.269019352592
              std dev =       0.596081849727
             le_variance =       0.355313571574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355292642564
                                         uncertainty =       0.012821605899

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355292642564
                                         uncertainty =       0.012821605899

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421493501
  error estimate for blocks of size 2^( 2) =       0.000434258532
  error estimate for blocks of size 2^( 3) =       0.000446862757
  error estimate for blocks of size 2^( 4) =       0.000459182524
  error estimate for blocks of size 2^( 5) =       0.000471032410
  error estimate for blocks of size 2^( 6) =       0.000480396973
  error estimate for blocks of size 2^( 7) =       0.000488650627

      target function =                  N/A
              le_mean =     -16.906433472651
             les_mean =     286.182806130741
             stat err =       0.000474815633
             autocorr =       1.269019377756
              std dev =       0.596081825952
             le_variance =       0.355313543231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355292617758
                                         uncertainty =       0.012821604941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355292617758
                                         uncertainty =       0.012821604941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000421493487
  error estimate for blocks of size 2^( 2) =       0.000434258518
  error estimate for blocks of size 2^( 3) =       0.000446862744
  error estimate for blocks of size 2^( 4) =       0.000459182511
  error estimate for blocks of size 2^( 5) =       0.000471032398
  error estimate for blocks of size 2^( 6) =       0.000480396960
  error estimate for blocks of size 2^( 7) =       0.000488650615

      target function =                  N/A
              le_mean =     -16.906433472710
             les_mean =     286.182806107942
             stat err =       0.000474815621
             autocorr =       1.269019399792
              std dev =       0.596081805143
             le_variance =       0.355313518423


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906433472719        initial  <--
     2.3842e+03     2.3842e+04             7.9747e-08       -16.906433472583
     9.5367e+03     9.5367e+04             1.9937e-08       -16.906433472651
     3.8147e+04     3.8147e+05             4.9842e-09       -16.906433472710

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 33.1866
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361400e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519588e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730847e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036298e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9087e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8608
    reference variance = 0.203156
====================================================
  Execution time = 2.0374e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3753e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337514304801
                                         uncertainty =       0.003536373452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337514304801
                                         uncertainty =       0.003536373452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410812463
  error estimate for blocks of size 2^( 2) =       0.000423922186
  error estimate for blocks of size 2^( 3) =       0.000437644570
  error estimate for blocks of size 2^( 4) =       0.000450371348
  error estimate for blocks of size 2^( 5) =       0.000462707005
  error estimate for blocks of size 2^( 6) =       0.000470772968
  error estimate for blocks of size 2^( 7) =       0.000479877260

      target function =                  N/A
              le_mean =     -16.906220267354
             les_mean =     286.157817319164
             stat err =       0.000465932145
             autocorr =       1.286346967146
              std dev =       0.580976556887
             le_variance =       0.337533759653


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690622026735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906220267354       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906220267361       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906220267400       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906220267385       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906220267378       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906220267395       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906220267399       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906220267405       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.759184e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906220267354       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906220267355       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906220267365       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906220267362       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906220267392       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906220267413       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906220267345       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906220267407       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.439798e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906220267354       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906220267354       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906220267357       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906220267356       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906220267293       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906220267637       residual = 7.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906220267380       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906220267307       residual = 4.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 6.099498e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160994 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6011e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519589e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730848e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036298e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.8793
    reference variance = 0.250796
====================================================
  Execution time = 1.9931e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3362e-01
  Total weights = 2.0000e+06
  Execution time = 1.8771e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333677113110
                                         uncertainty =       0.003631586277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333677113110
                                         uncertainty =       0.003631586277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408425364
  error estimate for blocks of size 2^( 2) =       0.000421673908
  error estimate for blocks of size 2^( 3) =       0.000434704282
  error estimate for blocks of size 2^( 4) =       0.000446645230
  error estimate for blocks of size 2^( 5) =       0.000457839795
  error estimate for blocks of size 2^( 6) =       0.000467375145
  error estimate for blocks of size 2^( 7) =       0.000475393102

      target function =                  N/A
              le_mean =     -16.905981203759
             les_mean =     286.145822851635
             stat err =       0.000461813318
             autocorr =       1.278519910864
              std dev =       0.577600689562
             le_variance =       0.333622556582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333677113242
                                         uncertainty =       0.003631586296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333677113242
                                         uncertainty =       0.003631586296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408425364
  error estimate for blocks of size 2^( 2) =       0.000421673908
  error estimate for blocks of size 2^( 3) =       0.000434704282
  error estimate for blocks of size 2^( 4) =       0.000446645230
  error estimate for blocks of size 2^( 5) =       0.000457839796
  error estimate for blocks of size 2^( 6) =       0.000467375145
  error estimate for blocks of size 2^( 7) =       0.000475393102

      target function =                  N/A
              le_mean =     -16.905981203770
             les_mean =     286.145822852144
             stat err =       0.000461813318
             autocorr =       1.278519911869
              std dev =       0.577600689678
             le_variance =       0.333622556717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333677113176
                                         uncertainty =       0.003631586287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333677113176
                                         uncertainty =       0.003631586287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408425364
  error estimate for blocks of size 2^( 2) =       0.000421673908
  error estimate for blocks of size 2^( 3) =       0.000434704282
  error estimate for blocks of size 2^( 4) =       0.000446645230
  error estimate for blocks of size 2^( 5) =       0.000457839795
  error estimate for blocks of size 2^( 6) =       0.000467375145
  error estimate for blocks of size 2^( 7) =       0.000475393102

      target function =                  N/A
              le_mean =     -16.905981203765
             les_mean =     286.145822851889
             stat err =       0.000461813318
             autocorr =       1.278519911370
              std dev =       0.577600689620
             le_variance =       0.333622556650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333677113118
                                         uncertainty =       0.003631586279

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333677113118
                                         uncertainty =       0.003631586279

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408425364
  error estimate for blocks of size 2^( 2) =       0.000421673908
  error estimate for blocks of size 2^( 3) =       0.000434704282
  error estimate for blocks of size 2^( 4) =       0.000446645230
  error estimate for blocks of size 2^( 5) =       0.000457839795
  error estimate for blocks of size 2^( 6) =       0.000467375145
  error estimate for blocks of size 2^( 7) =       0.000475393102

      target function =                  N/A
              le_mean =     -16.905981203760
             les_mean =     286.145822851667
             stat err =       0.000461813318
             autocorr =       1.278519910924
              std dev =       0.577600689569
             le_variance =       0.333622556591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905981203759        initial
     2.3842e+04     2.3842e+05             9.7592e-09       -16.905981203770  <--
     9.5367e+04     9.5367e+05             2.4398e-09       -16.905981203765
     3.8147e+05     3.8147e+06             6.0995e-10       -16.905981203760

*****************************************************************************
Applying the update for shift_i =   2.3842e+04     and shift_s =   2.3842e+05
*****************************************************************************

  Execution time = 2.9413e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5432e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9534
    reference variance = 0.248776
====================================================
  Execution time = 2.0341e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3475e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5669e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334805952724
                                         uncertainty =       0.002853086061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334805952724
                                         uncertainty =       0.002853086061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409115344
  error estimate for blocks of size 2^( 2) =       0.000422299198
  error estimate for blocks of size 2^( 3) =       0.000435611840
  error estimate for blocks of size 2^( 4) =       0.000448712536
  error estimate for blocks of size 2^( 5) =       0.000460554903
  error estimate for blocks of size 2^( 6) =       0.000469866008
  error estimate for blocks of size 2^( 7) =       0.000478823166

      target function =                  N/A
              le_mean =     -16.906537483465
             les_mean =     286.165760242099
             stat err =       0.000464489153
             autocorr =       1.289019883012
              std dev =       0.578576468302
             le_variance =       0.334750729673


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653748346e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906537483465       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906537483516       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906537483487       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906537483546       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906537483450       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906537483468       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906537483502       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 3.925613e-08

solving harmonic davidson linear method for identity shift 2.3842e+04, overlap shift 2.3842e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906537483465       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906537483478       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906537483470       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906537483473       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906537483455       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906537483466       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906537483476       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+04 is 9.814099e-09

solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906537483465       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906537483468       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906537483466       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906537483479       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906537483397       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906537483408       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906537483368       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 2.453529e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.163195 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5915e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361399e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519596e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391006e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730848e-03 1 1  ON 44
eH2_5                 3.393141e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9328
    reference variance = 0.258192
====================================================
  Execution time = 2.0361e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6331e-01
  Total weights = 2.0000e+06
  Execution time = 1.8781e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363373256415
                                         uncertainty =       0.027147989243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363373256415
                                         uncertainty =       0.027147989243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426211834
  error estimate for blocks of size 2^( 2) =       0.000438515210
  error estimate for blocks of size 2^( 3) =       0.000451055506
  error estimate for blocks of size 2^( 4) =       0.000463132913
  error estimate for blocks of size 2^( 5) =       0.000473517893
  error estimate for blocks of size 2^( 6) =       0.000482101640
  error estimate for blocks of size 2^( 7) =       0.000486810630

      target function =                  N/A
              le_mean =     -16.905841340010
             les_mean =     286.170784286087
             stat err =       0.000476390769
             autocorr =       1.249325681979
              std dev =       0.602754555475
             le_variance =       0.363313054146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363373277891
                                         uncertainty =       0.027147991150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363373277891
                                         uncertainty =       0.027147991150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426211846
  error estimate for blocks of size 2^( 2) =       0.000438515222
  error estimate for blocks of size 2^( 3) =       0.000451055516
  error estimate for blocks of size 2^( 4) =       0.000463132923
  error estimate for blocks of size 2^( 5) =       0.000473517902
  error estimate for blocks of size 2^( 6) =       0.000482101648
  error estimate for blocks of size 2^( 7) =       0.000486810638

      target function =                  N/A
              le_mean =     -16.905841339855
             les_mean =     286.170784302322
             stat err =       0.000476390778
             autocorr =       1.249325656207
              std dev =       0.602754573294
             le_variance =       0.363313075627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363373267154
                                         uncertainty =       0.027147990197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363373267154
                                         uncertainty =       0.027147990197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426211840
  error estimate for blocks of size 2^( 2) =       0.000438515216
  error estimate for blocks of size 2^( 3) =       0.000451055511
  error estimate for blocks of size 2^( 4) =       0.000463132918
  error estimate for blocks of size 2^( 5) =       0.000473517897
  error estimate for blocks of size 2^( 6) =       0.000482101644
  error estimate for blocks of size 2^( 7) =       0.000486810634

      target function =                  N/A
              le_mean =     -16.905841339933
             les_mean =     286.170784294205
             stat err =       0.000476390773
             autocorr =       1.249325669090
              std dev =       0.602754564385
             le_variance =       0.363313064887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363373257757
                                         uncertainty =       0.027147989362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.363373257757
                                         uncertainty =       0.027147989362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000426211834
  error estimate for blocks of size 2^( 2) =       0.000438515211
  error estimate for blocks of size 2^( 3) =       0.000451055506
  error estimate for blocks of size 2^( 4) =       0.000463132914
  error estimate for blocks of size 2^( 5) =       0.000473517893
  error estimate for blocks of size 2^( 6) =       0.000482101640
  error estimate for blocks of size 2^( 7) =       0.000486810630

      target function =                  N/A
              le_mean =     -16.905841340000
             les_mean =     286.170784287102
             stat err =       0.000476390769
             autocorr =       1.249325680367
              std dev =       0.602754556589
             le_variance =       0.363313055489


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905841340010        initial  <--
     5.9605e+03     5.9605e+04             3.9256e-08       -16.905841339855
     2.3842e+04     2.3842e+05             9.8141e-09       -16.905841339933
     9.5367e+04     9.5367e+05             2.4535e-09       -16.905841340000

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8540
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5777e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8822
    reference variance = 0.270356
====================================================
  Execution time = 2.0300e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3379e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5021e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333885992883
                                         uncertainty =       0.002581889539

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333885992883
                                         uncertainty =       0.002581889539

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408529187
  error estimate for blocks of size 2^( 2) =       0.000421528126
  error estimate for blocks of size 2^( 3) =       0.000434709211
  error estimate for blocks of size 2^( 4) =       0.000447793007
  error estimate for blocks of size 2^( 5) =       0.000457859123
  error estimate for blocks of size 2^( 6) =       0.000466718638
  error estimate for blocks of size 2^( 7) =       0.000469947870

      target function =                  N/A
              le_mean =     -16.905942795737
             les_mean =     286.144693839780
             stat err =       0.000460579660
             autocorr =       1.271052030202
              std dev =       0.577747517460
             le_variance =       0.333792193931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594279574e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905942795737       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905942795739       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905942795741       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905942795743       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905942795744       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905942795742       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905942795710       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905942795754       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.446600e-09

solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905942795737       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905942795738       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905942795738       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905942795702       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905942795698       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905942795788       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905942795864       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905942797149       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 8.616504e-10

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905942795737       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905942795738       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905942795738       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905942795738       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905942795738       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905942795710       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905942796246       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905942794629       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 2.154126e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165761 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5809e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8897
    reference variance = 0.170648
====================================================
  Execution time = 1.9901e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4566e-01
  Total weights = 2.0000e+06
  Execution time = 1.8865e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345728338650
                                         uncertainty =       0.008070727138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345728338650
                                         uncertainty =       0.008070727138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415729576
  error estimate for blocks of size 2^( 2) =       0.000428155921
  error estimate for blocks of size 2^( 3) =       0.000440673013
  error estimate for blocks of size 2^( 4) =       0.000453332008
  error estimate for blocks of size 2^( 5) =       0.000464030889
  error estimate for blocks of size 2^( 6) =       0.000473164725
  error estimate for blocks of size 2^( 7) =       0.000479172269

      target function =                  N/A
              le_mean =     -16.906865585886
             les_mean =     286.187765927236
             stat err =       0.000467424973
             autocorr =       1.264159807355
              std dev =       0.587930404770
             le_variance =       0.345662160853

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345728337882
                                         uncertainty =       0.008070727126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345728337882
                                         uncertainty =       0.008070727126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415729576
  error estimate for blocks of size 2^( 2) =       0.000428155920
  error estimate for blocks of size 2^( 3) =       0.000440673012
  error estimate for blocks of size 2^( 4) =       0.000453332008
  error estimate for blocks of size 2^( 5) =       0.000464030889
  error estimate for blocks of size 2^( 6) =       0.000473164725
  error estimate for blocks of size 2^( 7) =       0.000479172269

      target function =                  N/A
              le_mean =     -16.906865585882
             les_mean =     286.187765926351
             stat err =       0.000467424973
             autocorr =       1.264159808645
              std dev =       0.587930404117
             le_variance =       0.345662160085

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345728338266
                                         uncertainty =       0.008070727132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345728338266
                                         uncertainty =       0.008070727132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415729576
  error estimate for blocks of size 2^( 2) =       0.000428155921
  error estimate for blocks of size 2^( 3) =       0.000440673013
  error estimate for blocks of size 2^( 4) =       0.000453332008
  error estimate for blocks of size 2^( 5) =       0.000464030889
  error estimate for blocks of size 2^( 6) =       0.000473164725
  error estimate for blocks of size 2^( 7) =       0.000479172269

      target function =                  N/A
              le_mean =     -16.906865585884
             les_mean =     286.187765926793
             stat err =       0.000467424973
             autocorr =       1.264159808003
              std dev =       0.587930404443
             le_variance =       0.345662160469

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345728338602
                                         uncertainty =       0.008070727137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345728338602
                                         uncertainty =       0.008070727137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415729576
  error estimate for blocks of size 2^( 2) =       0.000428155921
  error estimate for blocks of size 2^( 3) =       0.000440673013
  error estimate for blocks of size 2^( 4) =       0.000453332008
  error estimate for blocks of size 2^( 5) =       0.000464030889
  error estimate for blocks of size 2^( 6) =       0.000473164725
  error estimate for blocks of size 2^( 7) =       0.000479172269

      target function =                  N/A
              le_mean =     -16.906865585886
             les_mean =     286.187765927180
             stat err =       0.000467424973
             autocorr =       1.264159807439
              std dev =       0.587930404729
             le_variance =       0.345662160805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906865585886        initial  <--
     5.9605e+04     5.9605e+05             3.4466e-09       -16.906865585882
     2.3842e+05     2.3842e+06             8.6165e-10       -16.906865585884
     9.5367e+05     9.5367e+06             2.1541e-10       -16.906865585886

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4298
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5248e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6904e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9846
    reference variance = 1.61118
====================================================
  Execution time = 2.0388e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4137e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5897e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341371485433
                                         uncertainty =       0.003977440735

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341371485433
                                         uncertainty =       0.003977440735

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413141235
  error estimate for blocks of size 2^( 2) =       0.000425997144
  error estimate for blocks of size 2^( 3) =       0.000438895267
  error estimate for blocks of size 2^( 4) =       0.000450650994
  error estimate for blocks of size 2^( 5) =       0.000461617084
  error estimate for blocks of size 2^( 6) =       0.000469024349
  error estimate for blocks of size 2^( 7) =       0.000472823573

      target function =                  N/A
              le_mean =     -16.906302672432
             les_mean =     286.164441240936
             stat err =       0.000463529000
             autocorr =       1.258800000913
              std dev =       0.584269937402
             le_variance =       0.341371359752


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630267243e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302672432       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906302672432       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906302672433       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906302672403       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906302674988       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906302672512       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906302672266       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906302672434       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.060809e-10

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302672432       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906302672432       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906302672432       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906302671324       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906302673101       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906302672776       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906302673778       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906302672494       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 1.015202e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906302672432       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906302672432       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906302672432       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906302672432       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906302675484       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906302672080       residual = 6.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906302682427       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906302658423       residual = 4.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 2.537971e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168349 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5985e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9159
    reference variance = 0.267637
====================================================
  Execution time = 2.0036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3677e-01
  Total weights = 2.0000e+06
  Execution time = 1.8786e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807624581
                                         uncertainty =       0.003183301854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807624581
                                         uncertainty =       0.003183301854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410349868
  error estimate for blocks of size 2^( 2) =       0.000423516668
  error estimate for blocks of size 2^( 3) =       0.000436983918
  error estimate for blocks of size 2^( 4) =       0.000449392634
  error estimate for blocks of size 2^( 5) =       0.000461148931
  error estimate for blocks of size 2^( 6) =       0.000467218255
  error estimate for blocks of size 2^( 7) =       0.000471579001

      target function =                  N/A
              le_mean =     -16.905877143565
             les_mean =     286.145455852729
             stat err =       0.000462334705
             autocorr =       1.269417247644
              std dev =       0.580322348190
             le_variance =       0.336774027808

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807624326
                                         uncertainty =       0.003183301851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807624326
                                         uncertainty =       0.003183301851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410349868
  error estimate for blocks of size 2^( 2) =       0.000423516668
  error estimate for blocks of size 2^( 3) =       0.000436983918
  error estimate for blocks of size 2^( 4) =       0.000449392634
  error estimate for blocks of size 2^( 5) =       0.000461148931
  error estimate for blocks of size 2^( 6) =       0.000467218255
  error estimate for blocks of size 2^( 7) =       0.000471579001

      target function =                  N/A
              le_mean =     -16.905877143563
             les_mean =     286.145455852419
             stat err =       0.000462334705
             autocorr =       1.269417247889
              std dev =       0.580322347970
             le_variance =       0.336774027554

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807624453
                                         uncertainty =       0.003183301853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807624453
                                         uncertainty =       0.003183301853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410349868
  error estimate for blocks of size 2^( 2) =       0.000423516668
  error estimate for blocks of size 2^( 3) =       0.000436983918
  error estimate for blocks of size 2^( 4) =       0.000449392634
  error estimate for blocks of size 2^( 5) =       0.000461148931
  error estimate for blocks of size 2^( 6) =       0.000467218255
  error estimate for blocks of size 2^( 7) =       0.000471579001

      target function =                  N/A
              le_mean =     -16.905877143564
             les_mean =     286.145455852574
             stat err =       0.000462334705
             autocorr =       1.269417247756
              std dev =       0.580322348080
             le_variance =       0.336774027681

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807624565
                                         uncertainty =       0.003183301854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336807624565
                                         uncertainty =       0.003183301854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410349868
  error estimate for blocks of size 2^( 2) =       0.000423516668
  error estimate for blocks of size 2^( 3) =       0.000436983918
  error estimate for blocks of size 2^( 4) =       0.000449392634
  error estimate for blocks of size 2^( 5) =       0.000461148931
  error estimate for blocks of size 2^( 6) =       0.000467218255
  error estimate for blocks of size 2^( 7) =       0.000471579001

      target function =                  N/A
              le_mean =     -16.905877143565
             les_mean =     286.145455852709
             stat err =       0.000462334705
             autocorr =       1.269417247662
              std dev =       0.580322348176
             le_variance =       0.336774027792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905877143565        initial  <--
     5.9605e+05     5.9605e+06             4.0608e-10       -16.905877143563
     2.3842e+06     2.3842e+07             1.0152e-10       -16.905877143564
     9.5367e+06     9.5367e+07             2.5380e-11       -16.905877143565

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5404
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5534e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9698
    reference variance = 0.271938
====================================================
  Execution time = 2.0392e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3831e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338260409851
                                         uncertainty =       0.004649538283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338260409851
                                         uncertainty =       0.004649538283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411286340
  error estimate for blocks of size 2^( 2) =       0.000423619417
  error estimate for blocks of size 2^( 3) =       0.000435690938
  error estimate for blocks of size 2^( 4) =       0.000447576968
  error estimate for blocks of size 2^( 5) =       0.000457413671
  error estimate for blocks of size 2^( 6) =       0.000463490409
  error estimate for blocks of size 2^( 7) =       0.000466999337

      target function =                  N/A
              le_mean =     -16.906136214820
             les_mean =     286.155754451656
             stat err =       0.000458870096
             autocorr =       1.244775242036
              std dev =       0.581646719903
             le_variance =       0.338312906774


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690613621482e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136214820       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136214820       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906136214820       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906136215487       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906136213913       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136210645       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906136212289       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 2.614043e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136214820       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136214820       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906136214820       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906136214355       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906136213574       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136197224       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906136211085       residual = 3.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 6.535355e-12

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906136214820       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906136214820       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906136214820       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906136214820       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906136222235       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906136222492       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906136198860       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 1.633705e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.170559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6091e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9448
    reference variance = 0.120228
====================================================
  Execution time = 1.9826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4412e-01
  Total weights = 2.0000e+06
  Execution time = 1.8651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344251986887
                                         uncertainty =       0.005770802625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344251986887
                                         uncertainty =       0.005770802625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414801102
  error estimate for blocks of size 2^( 2) =       0.000428060102
  error estimate for blocks of size 2^( 3) =       0.000440864792
  error estimate for blocks of size 2^( 4) =       0.000452850633
  error estimate for blocks of size 2^( 5) =       0.000462894227
  error estimate for blocks of size 2^( 6) =       0.000472131731
  error estimate for blocks of size 2^( 7) =       0.000475056810

      target function =                  N/A
              le_mean =     -16.906201643202
             les_mean =     286.163773736380
             stat err =       0.000465733350
             autocorr =       1.260651003406
              std dev =       0.586617343617
             le_variance =       0.344119907832

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344251986861
                                         uncertainty =       0.005770802625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344251986861
                                         uncertainty =       0.005770802625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414801102
  error estimate for blocks of size 2^( 2) =       0.000428060102
  error estimate for blocks of size 2^( 3) =       0.000440864792
  error estimate for blocks of size 2^( 4) =       0.000452850633
  error estimate for blocks of size 2^( 5) =       0.000462894227
  error estimate for blocks of size 2^( 6) =       0.000472131731
  error estimate for blocks of size 2^( 7) =       0.000475056810

      target function =                  N/A
              le_mean =     -16.906201643202
             les_mean =     286.163773736356
             stat err =       0.000465733350
             autocorr =       1.260651003430
              std dev =       0.586617343595
             le_variance =       0.344119907806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344251986874
                                         uncertainty =       0.005770802625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344251986874
                                         uncertainty =       0.005770802625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414801102
  error estimate for blocks of size 2^( 2) =       0.000428060102
  error estimate for blocks of size 2^( 3) =       0.000440864792
  error estimate for blocks of size 2^( 4) =       0.000452850633
  error estimate for blocks of size 2^( 5) =       0.000462894227
  error estimate for blocks of size 2^( 6) =       0.000472131731
  error estimate for blocks of size 2^( 7) =       0.000475056810

      target function =                  N/A
              le_mean =     -16.906201643202
             les_mean =     286.163773736368
             stat err =       0.000465733350
             autocorr =       1.260651003414
              std dev =       0.586617343606
             le_variance =       0.344119907819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344251986886
                                         uncertainty =       0.005770802625

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344251986886
                                         uncertainty =       0.005770802625

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414801102
  error estimate for blocks of size 2^( 2) =       0.000428060102
  error estimate for blocks of size 2^( 3) =       0.000440864792
  error estimate for blocks of size 2^( 4) =       0.000452850633
  error estimate for blocks of size 2^( 5) =       0.000462894227
  error estimate for blocks of size 2^( 6) =       0.000472131731
  error estimate for blocks of size 2^( 7) =       0.000475056810

      target function =                  N/A
              le_mean =     -16.906201643202
             les_mean =     286.163773736378
             stat err =       0.000465733350
             autocorr =       1.260651003404
              std dev =       0.586617343615
             le_variance =       0.344119907830


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906201643202        initial
     5.9605e+06     5.9605e+07             2.6140e-11       -16.906201643202  <--
     2.3842e+07     2.3842e+08             6.5354e-12       -16.906201643202
     9.5367e+07     9.5367e+08             1.6337e-12       -16.906201643202

*****************************************************************************
Applying the update for shift_i =   5.9605e+06     and shift_s =   5.9605e+07
*****************************************************************************

  Execution time = 2.9257e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5355e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.957
    reference variance = 0.467463
====================================================
  Execution time = 2.2682e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3298e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333056483133
                                         uncertainty =       0.002932131973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333056483133
                                         uncertainty =       0.002932131973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408030054
  error estimate for blocks of size 2^( 2) =       0.000420880868
  error estimate for blocks of size 2^( 3) =       0.000434515738
  error estimate for blocks of size 2^( 4) =       0.000447122573
  error estimate for blocks of size 2^( 5) =       0.000457196618
  error estimate for blocks of size 2^( 6) =       0.000467201223
  error estimate for blocks of size 2^( 7) =       0.000472019915

      target function =                  N/A
              le_mean =     -16.906544006925
             les_mean =     286.164207141925
             stat err =       0.000460885082
             autocorr =       1.275854049702
              std dev =       0.577041636548
             le_variance =       0.332977050310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690654400693e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906544006925       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906544006925       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906544006925       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906544006925       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906544007254       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906544006862       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906544006026       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906544006632       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 1.223276e-10

solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906544006925       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906544006925       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906544006925       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906544006925       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906544006897       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906544004964       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906544006172       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906544006838       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 3.058180e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906544006925       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906544006925       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906544006925       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906544007424       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906543995305       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906544007919       residual = 3.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906544026631       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906543993215       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 7.645637e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.173197 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8232e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8778
    reference variance = 0.266813
====================================================
  Execution time = 1.9880e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3491e-01
  Total weights = 2.0000e+06
  Execution time = 1.8634e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334936006112
                                         uncertainty =       0.003169142572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334936006112
                                         uncertainty =       0.003169142572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409214799
  error estimate for blocks of size 2^( 2) =       0.000422180656
  error estimate for blocks of size 2^( 3) =       0.000435851650
  error estimate for blocks of size 2^( 4) =       0.000448977747
  error estimate for blocks of size 2^( 5) =       0.000460312724
  error estimate for blocks of size 2^( 6) =       0.000468582740
  error estimate for blocks of size 2^( 7) =       0.000475984761

      target function =                  N/A
              le_mean =     -16.906341681599
             les_mean =     286.159302390347
             stat err =       0.000463464493
             autocorr =       1.282715295473
              std dev =       0.578717118149
             le_variance =       0.334913502838

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334936006110
                                         uncertainty =       0.003169142572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334936006110
                                         uncertainty =       0.003169142572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409214799
  error estimate for blocks of size 2^( 2) =       0.000422180656
  error estimate for blocks of size 2^( 3) =       0.000435851650
  error estimate for blocks of size 2^( 4) =       0.000448977747
  error estimate for blocks of size 2^( 5) =       0.000460312724
  error estimate for blocks of size 2^( 6) =       0.000468582740
  error estimate for blocks of size 2^( 7) =       0.000475984761

      target function =                  N/A
              le_mean =     -16.906341681599
             les_mean =     286.159302390343
             stat err =       0.000463464493
             autocorr =       1.282715295491
              std dev =       0.578717118147
             le_variance =       0.334913502836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334936006111
                                         uncertainty =       0.003169142572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334936006111
                                         uncertainty =       0.003169142572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409214799
  error estimate for blocks of size 2^( 2) =       0.000422180656
  error estimate for blocks of size 2^( 3) =       0.000435851650
  error estimate for blocks of size 2^( 4) =       0.000448977747
  error estimate for blocks of size 2^( 5) =       0.000460312724
  error estimate for blocks of size 2^( 6) =       0.000468582740
  error estimate for blocks of size 2^( 7) =       0.000475984761

      target function =                  N/A
              le_mean =     -16.906341681599
             les_mean =     286.159302390345
             stat err =       0.000463464493
             autocorr =       1.282715295480
              std dev =       0.578717118148
             le_variance =       0.334913502837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334936006112
                                         uncertainty =       0.003169142572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334936006112
                                         uncertainty =       0.003169142572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409214799
  error estimate for blocks of size 2^( 2) =       0.000422180656
  error estimate for blocks of size 2^( 3) =       0.000435851650
  error estimate for blocks of size 2^( 4) =       0.000448977747
  error estimate for blocks of size 2^( 5) =       0.000460312724
  error estimate for blocks of size 2^( 6) =       0.000468582740
  error estimate for blocks of size 2^( 7) =       0.000475984761

      target function =                  N/A
              le_mean =     -16.906341681599
             les_mean =     286.159302390346
             stat err =       0.000463464493
             autocorr =       1.282715295480
              std dev =       0.578717118149
             le_variance =       0.334913502838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906341681599        initial  <--
     1.4901e+06     1.4901e+07             1.2233e-10       -16.906341681599
     5.9605e+06     5.9605e+07             3.0582e-11       -16.906341681599
     2.3842e+07     2.3842e+08             7.6456e-12       -16.906341681599

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3129
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6908e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8852
    reference variance = 0.216447
====================================================
  Execution time = 2.0387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4364e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343437202823
                                         uncertainty =       0.010256617765

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343437202823
                                         uncertainty =       0.010256617765

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414509286
  error estimate for blocks of size 2^( 2) =       0.000426841038
  error estimate for blocks of size 2^( 3) =       0.000439543403
  error estimate for blocks of size 2^( 4) =       0.000451946034
  error estimate for blocks of size 2^( 5) =       0.000461202529
  error estimate for blocks of size 2^( 6) =       0.000467272991
  error estimate for blocks of size 2^( 7) =       0.000472677907

      target function =                  N/A
              le_mean =     -16.906640601989
             les_mean =     286.178132168708
             stat err =       0.000463274865
             autocorr =       1.249133768792
              std dev =       0.586204653445
             le_variance =       0.343635895720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690664060199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906640601988       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906640601988       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906640601988       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906640601993       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906640609014       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906640606809       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906640593727       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.073792e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906640601988       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906640601988       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906640601988       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906640576666       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906640580331       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906640601989       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906640583230       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 2.684597e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906640601988       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906640601988       residual = 2.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906640601988       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906640506058       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906640601988       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906640515595       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906640430328       residual = 9.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 6.711547e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175347 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6029e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.9831
    reference variance = 0.229823
====================================================
  Execution time = 2.0121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3822e-01
  Total weights = 2.0000e+06
  Execution time = 1.8751e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338199303533
                                         uncertainty =       0.005004701860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338199303533
                                         uncertainty =       0.005004701860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411230169
  error estimate for blocks of size 2^( 2) =       0.000423825824
  error estimate for blocks of size 2^( 3) =       0.000437341773
  error estimate for blocks of size 2^( 4) =       0.000449321933
  error estimate for blocks of size 2^( 5) =       0.000458457680
  error estimate for blocks of size 2^( 6) =       0.000466124376
  error estimate for blocks of size 2^( 7) =       0.000471719974

      target function =                  N/A
              le_mean =     -16.906437254193
             les_mean =     286.165840965061
             stat err =       0.000461405991
             autocorr =       1.258915327391
              std dev =       0.581567282616
             le_variance =       0.338220504209

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338199303541
                                         uncertainty =       0.005004701860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338199303541
                                         uncertainty =       0.005004701860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411230169
  error estimate for blocks of size 2^( 2) =       0.000423825824
  error estimate for blocks of size 2^( 3) =       0.000437341773
  error estimate for blocks of size 2^( 4) =       0.000449321933
  error estimate for blocks of size 2^( 5) =       0.000458457680
  error estimate for blocks of size 2^( 6) =       0.000466124376
  error estimate for blocks of size 2^( 7) =       0.000471719974

      target function =                  N/A
              le_mean =     -16.906437254193
             les_mean =     286.165840965071
             stat err =       0.000461405991
             autocorr =       1.258915327385
              std dev =       0.581567282622
             le_variance =       0.338220504216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338199303537
                                         uncertainty =       0.005004701860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338199303537
                                         uncertainty =       0.005004701860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411230169
  error estimate for blocks of size 2^( 2) =       0.000423825824
  error estimate for blocks of size 2^( 3) =       0.000437341773
  error estimate for blocks of size 2^( 4) =       0.000449321933
  error estimate for blocks of size 2^( 5) =       0.000458457680
  error estimate for blocks of size 2^( 6) =       0.000466124376
  error estimate for blocks of size 2^( 7) =       0.000471719974

      target function =                  N/A
              le_mean =     -16.906437254193
             les_mean =     286.165840965066
             stat err =       0.000461405991
             autocorr =       1.258915327389
              std dev =       0.581567282619
             le_variance =       0.338220504213

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338199303534
                                         uncertainty =       0.005004701860

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338199303534
                                         uncertainty =       0.005004701860

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411230169
  error estimate for blocks of size 2^( 2) =       0.000423825824
  error estimate for blocks of size 2^( 3) =       0.000437341773
  error estimate for blocks of size 2^( 4) =       0.000449321933
  error estimate for blocks of size 2^( 5) =       0.000458457680
  error estimate for blocks of size 2^( 6) =       0.000466124376
  error estimate for blocks of size 2^( 7) =       0.000471719974

      target function =                  N/A
              le_mean =     -16.906437254193
             les_mean =     286.165840965062
             stat err =       0.000461405991
             autocorr =       1.258915327396
              std dev =       0.581567282616
             le_variance =       0.338220504209


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906437254193        initial
     1.4901e+07     1.4901e+08             1.0738e-11       -16.906437254193  <--
     5.9605e+07     5.9605e+08             2.6846e-12       -16.906437254193
     2.3842e+08     2.3842e+09             6.7115e-13       -16.906437254193

*****************************************************************************
Applying the update for shift_i =   1.4901e+07     and shift_s =   1.4901e+08
*****************************************************************************

  Execution time = 2.9597e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5633e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6909e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.0874
    reference variance = 1.08757
====================================================
  Execution time = 2.0334e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3806e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5192e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337984772650
                                         uncertainty =       0.003116859974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337984772650
                                         uncertainty =       0.003116859974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411133118
  error estimate for blocks of size 2^( 2) =       0.000423450862
  error estimate for blocks of size 2^( 3) =       0.000436151282
  error estimate for blocks of size 2^( 4) =       0.000448046271
  error estimate for blocks of size 2^( 5) =       0.000458412812
  error estimate for blocks of size 2^( 6) =       0.000464281619
  error estimate for blocks of size 2^( 7) =       0.000466394459

      target function =                  N/A
              le_mean =     -16.907068236863
             les_mean =     286.187017077572
             stat err =       0.000459283790
             autocorr =       1.247950367774
              std dev =       0.581430030742
             le_variance =       0.338060880649


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690706823686e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907068236863       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907068236863       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907068236863       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907068236863       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907068236944       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907068236864       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907068237026       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907068232591       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 5.259036e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907068236863       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907068236863       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907068236863       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907068236863       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907068237000       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907068234327       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907068236868       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907068251121       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.314763e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907068236863       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907068236863       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907068236863       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907068257199       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907068235563       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907068235387       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907068241155       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907068254140       residual = 4.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 3.286907e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.178038 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5861e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.901
    reference variance = 0.24109
====================================================
  Execution time = 2.0367e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3676e-01
  Total weights = 2.0000e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336494031849
                                         uncertainty =       0.003083855007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336494031849
                                         uncertainty =       0.003083855007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410342741
  error estimate for blocks of size 2^( 2) =       0.000422759957
  error estimate for blocks of size 2^( 3) =       0.000435821597
  error estimate for blocks of size 2^( 4) =       0.000447246976
  error estimate for blocks of size 2^( 5) =       0.000457072123
  error estimate for blocks of size 2^( 6) =       0.000465446735
  error estimate for blocks of size 2^( 7) =       0.000471578923

      target function =                  N/A
              le_mean =     -16.906233013518
             les_mean =     286.157476868362
             stat err =       0.000460336189
             autocorr =       1.258510164226
              std dev =       0.580312268849
             le_variance =       0.336762329376

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336494031837
                                         uncertainty =       0.003083855007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336494031837
                                         uncertainty =       0.003083855007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410342741
  error estimate for blocks of size 2^( 2) =       0.000422759957
  error estimate for blocks of size 2^( 3) =       0.000435821597
  error estimate for blocks of size 2^( 4) =       0.000447246976
  error estimate for blocks of size 2^( 5) =       0.000457072123
  error estimate for blocks of size 2^( 6) =       0.000465446735
  error estimate for blocks of size 2^( 7) =       0.000471578923

      target function =                  N/A
              le_mean =     -16.906233013518
             les_mean =     286.157476868356
             stat err =       0.000460336189
             autocorr =       1.258510164248
              std dev =       0.580312268838
             le_variance =       0.336762329364

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336494031843
                                         uncertainty =       0.003083855007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336494031843
                                         uncertainty =       0.003083855007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410342741
  error estimate for blocks of size 2^( 2) =       0.000422759957
  error estimate for blocks of size 2^( 3) =       0.000435821597
  error estimate for blocks of size 2^( 4) =       0.000447246976
  error estimate for blocks of size 2^( 5) =       0.000457072123
  error estimate for blocks of size 2^( 6) =       0.000465446735
  error estimate for blocks of size 2^( 7) =       0.000471578923

      target function =                  N/A
              le_mean =     -16.906233013518
             les_mean =     286.157476868359
             stat err =       0.000460336189
             autocorr =       1.258510164239
              std dev =       0.580312268843
             le_variance =       0.336762329370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336494031848
                                         uncertainty =       0.003083855007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336494031848
                                         uncertainty =       0.003083855007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410342741
  error estimate for blocks of size 2^( 2) =       0.000422759957
  error estimate for blocks of size 2^( 3) =       0.000435821597
  error estimate for blocks of size 2^( 4) =       0.000447246976
  error estimate for blocks of size 2^( 5) =       0.000457072123
  error estimate for blocks of size 2^( 6) =       0.000465446735
  error estimate for blocks of size 2^( 7) =       0.000471578923

      target function =                  N/A
              le_mean =     -16.906233013518
             les_mean =     286.157476868362
             stat err =       0.000460336189
             autocorr =       1.258510164233
              std dev =       0.580312268848
             le_variance =       0.336762329375


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906233013518        initial
     3.7253e+06     3.7253e+07             5.2590e-11       -16.906233013518  <--
     1.4901e+07     1.4901e+08             1.3148e-11       -16.906233013518
     5.9605e+07     5.9605e+08             3.2869e-12       -16.906233013518

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 2.9865e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6912e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9308
    reference variance = 0.205194
====================================================
  Execution time = 2.0411e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4402e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4743e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344075838739
                                         uncertainty =       0.004308484941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344075838739
                                         uncertainty =       0.004308484941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414743976
  error estimate for blocks of size 2^( 2) =       0.000427113965
  error estimate for blocks of size 2^( 3) =       0.000440290095
  error estimate for blocks of size 2^( 4) =       0.000451371540
  error estimate for blocks of size 2^( 5) =       0.000462438220
  error estimate for blocks of size 2^( 6) =       0.000471246632
  error estimate for blocks of size 2^( 7) =       0.000480355364

      target function =                  N/A
              le_mean =     -16.905811643096
             les_mean =     286.150492271112
             stat err =       0.000466352939
             autocorr =       1.264355675626
              std dev =       0.586536555798
             le_variance =       0.344025131288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690581164310e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811643096       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905811643097       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905811643097       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905811642969       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905811643213       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905811642844       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905811643310       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905811643135       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.037092e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811643096       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905811643096       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905811643096       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905811643096       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905811640335       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905811644688       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905811643120       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905811642890       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 5.092732e-11

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905811643096       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905811643096       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905811643096       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905811643096       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905811648415       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905811629830       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905811647906       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905811650492       residual = 2.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 1.273176e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.180610 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5892e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9506
    reference variance = 0.775904
====================================================
  Execution time = 2.0075e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3578e-01
  Total weights = 2.0000e+06
  Execution time = 1.8814e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854303711
                                         uncertainty =       0.002604836713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854303711
                                         uncertainty =       0.002604836713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409741129
  error estimate for blocks of size 2^( 2) =       0.000422939469
  error estimate for blocks of size 2^( 3) =       0.000436696674
  error estimate for blocks of size 2^( 4) =       0.000450096612
  error estimate for blocks of size 2^( 5) =       0.000461494356
  error estimate for blocks of size 2^( 6) =       0.000468531833
  error estimate for blocks of size 2^( 7) =       0.000474412464

      target function =                  N/A
              le_mean =     -16.905739362152
             les_mean =     286.139798798076
             stat err =       0.000463633816
             autocorr =       1.280357031259
              std dev =       0.579461461148
             le_variance =       0.335775584956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854303645
                                         uncertainty =       0.002604836713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854303645
                                         uncertainty =       0.002604836713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409741129
  error estimate for blocks of size 2^( 2) =       0.000422939469
  error estimate for blocks of size 2^( 3) =       0.000436696674
  error estimate for blocks of size 2^( 4) =       0.000450096612
  error estimate for blocks of size 2^( 5) =       0.000461494356
  error estimate for blocks of size 2^( 6) =       0.000468531833
  error estimate for blocks of size 2^( 7) =       0.000474412464

      target function =                  N/A
              le_mean =     -16.905739362152
             les_mean =     286.139798798017
             stat err =       0.000463633816
             autocorr =       1.280357031316
              std dev =       0.579461461090
             le_variance =       0.335775584889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854303678
                                         uncertainty =       0.002604836713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854303678
                                         uncertainty =       0.002604836713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409741129
  error estimate for blocks of size 2^( 2) =       0.000422939469
  error estimate for blocks of size 2^( 3) =       0.000436696674
  error estimate for blocks of size 2^( 4) =       0.000450096612
  error estimate for blocks of size 2^( 5) =       0.000461494356
  error estimate for blocks of size 2^( 6) =       0.000468531833
  error estimate for blocks of size 2^( 7) =       0.000474412464

      target function =                  N/A
              le_mean =     -16.905739362152
             les_mean =     286.139798798047
             stat err =       0.000463633816
             autocorr =       1.280357031294
              std dev =       0.579461461119
             le_variance =       0.335775584922

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854303707
                                         uncertainty =       0.002604836713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335854303707
                                         uncertainty =       0.002604836713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409741129
  error estimate for blocks of size 2^( 2) =       0.000422939469
  error estimate for blocks of size 2^( 3) =       0.000436696674
  error estimate for blocks of size 2^( 4) =       0.000450096612
  error estimate for blocks of size 2^( 5) =       0.000461494356
  error estimate for blocks of size 2^( 6) =       0.000468531833
  error estimate for blocks of size 2^( 7) =       0.000474412464

      target function =                  N/A
              le_mean =     -16.905739362152
             les_mean =     286.139798798072
             stat err =       0.000463633816
             autocorr =       1.280357031271
              std dev =       0.579461461144
             le_variance =       0.335775584952


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905739362152        initial
     9.3132e+05     9.3132e+06             2.0371e-10       -16.905739362152  <--
     3.7253e+06     3.7253e+07             5.0927e-11       -16.905739362152
     1.4901e+07     1.4901e+08             1.2732e-11       -16.905739362152

*****************************************************************************
Applying the update for shift_i =   9.3132e+05     and shift_s =   9.3132e+06
*****************************************************************************

  Execution time = 2.9583e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5483e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9016
    reference variance = 0.168733
====================================================
  Execution time = 2.0546e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3711e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337155231277
                                         uncertainty =       0.003495125793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337155231277
                                         uncertainty =       0.003495125793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410557595
  error estimate for blocks of size 2^( 2) =       0.000423342500
  error estimate for blocks of size 2^( 3) =       0.000437185406
  error estimate for blocks of size 2^( 4) =       0.000450118250
  error estimate for blocks of size 2^( 5) =       0.000461533932
  error estimate for blocks of size 2^( 6) =       0.000470187398
  error estimate for blocks of size 2^( 7) =       0.000474089397

      target function =                  N/A
              le_mean =     -16.905898319948
             les_mean =     286.146512913572
             stat err =       0.000463982244
             autocorr =       1.277187150721
              std dev =       0.580616119067
             le_variance =       0.337115077720


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690589831995e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898319948       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898319949       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898319950       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898319949       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905898319949       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898319997       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905898320004       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 8.341572e-10

solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898319948       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898319948       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898319948       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898319948       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905898320217       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898319948       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905898319992       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 2.085394e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905898319948       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905898319948       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905898319948       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905898319297       residual = 2.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905898319948       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905898319797       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905898319837       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 5.213480e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182834 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6121e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.0283
    reference variance = 0.83385
====================================================
  Execution time = 1.9944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.8094e-01
  Total weights = 2.0000e+06
  Execution time = 1.8745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380962269199
                                         uncertainty =       0.032092530229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380962269199
                                         uncertainty =       0.032092530229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436428383
  error estimate for blocks of size 2^( 2) =       0.000448609604
  error estimate for blocks of size 2^( 3) =       0.000460834577
  error estimate for blocks of size 2^( 4) =       0.000471986523
  error estimate for blocks of size 2^( 5) =       0.000480636289
  error estimate for blocks of size 2^( 6) =       0.000486889063
  error estimate for blocks of size 2^( 7) =       0.000494226672

      target function =                  N/A
              le_mean =     -16.907152567281
             les_mean =     286.232747209585
             stat err =       0.000483434637
             autocorr =       1.227014096450
              std dev =       0.617202938055
             le_variance =       0.380939466744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380962269300
                                         uncertainty =       0.032092530238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380962269300
                                         uncertainty =       0.032092530238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436428383
  error estimate for blocks of size 2^( 2) =       0.000448609604
  error estimate for blocks of size 2^( 3) =       0.000460834577
  error estimate for blocks of size 2^( 4) =       0.000471986523
  error estimate for blocks of size 2^( 5) =       0.000480636289
  error estimate for blocks of size 2^( 6) =       0.000486889063
  error estimate for blocks of size 2^( 7) =       0.000494226672

      target function =                  N/A
              le_mean =     -16.907152567279
             les_mean =     286.232747209637
             stat err =       0.000483434637
             autocorr =       1.227014096363
              std dev =       0.617202938137
             le_variance =       0.380939466845

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380962269250
                                         uncertainty =       0.032092530234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380962269250
                                         uncertainty =       0.032092530234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436428383
  error estimate for blocks of size 2^( 2) =       0.000448609604
  error estimate for blocks of size 2^( 3) =       0.000460834577
  error estimate for blocks of size 2^( 4) =       0.000471986523
  error estimate for blocks of size 2^( 5) =       0.000480636289
  error estimate for blocks of size 2^( 6) =       0.000486889063
  error estimate for blocks of size 2^( 7) =       0.000494226672

      target function =                  N/A
              le_mean =     -16.907152567280
             les_mean =     286.232747209611
             stat err =       0.000483434637
             autocorr =       1.227014096404
              std dev =       0.617202938096
             le_variance =       0.380939466795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380962269205
                                         uncertainty =       0.032092530230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.380962269205
                                         uncertainty =       0.032092530230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000436428383
  error estimate for blocks of size 2^( 2) =       0.000448609604
  error estimate for blocks of size 2^( 3) =       0.000460834577
  error estimate for blocks of size 2^( 4) =       0.000471986523
  error estimate for blocks of size 2^( 5) =       0.000480636289
  error estimate for blocks of size 2^( 6) =       0.000486889063
  error estimate for blocks of size 2^( 7) =       0.000494226672

      target function =                  N/A
              le_mean =     -16.907152567281
             les_mean =     286.232747209589
             stat err =       0.000483434637
             autocorr =       1.227014096446
              std dev =       0.617202938060
             le_variance =       0.380939466750


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907152567281        initial  <--
     2.3283e+05     2.3283e+06             8.3416e-10       -16.907152567279
     9.3132e+05     9.3132e+06             2.0854e-10       -16.907152567280
     3.7253e+06     3.7253e+07             5.2135e-11       -16.907152567281

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4165
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5545e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9103
    reference variance = 0.272317
====================================================
  Execution time = 2.0103e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3824e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4267e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338339143496
                                         uncertainty =       0.005522051336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338339143496
                                         uncertainty =       0.005522051336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411242336
  error estimate for blocks of size 2^( 2) =       0.000423852942
  error estimate for blocks of size 2^( 3) =       0.000436643601
  error estimate for blocks of size 2^( 4) =       0.000448792295
  error estimate for blocks of size 2^( 5) =       0.000458536703
  error estimate for blocks of size 2^( 6) =       0.000466751906
  error estimate for blocks of size 2^( 7) =       0.000469950169

      target function =                  N/A
              le_mean =     -16.906307216617
             les_mean =     286.161464050592
             stat err =       0.000461007769
             autocorr =       1.256668860884
              std dev =       0.581584488330
             le_variance =       0.338240517066


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690630721662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906307216617       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906307216617       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906307216617       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906307217279       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906307215943       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906307217512       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906307217361       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 7.925555e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906307216617       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906307216617       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906307216617       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906307216617       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906307216617       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906307216617       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906307215768       residual = 7.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 1.981388e-11

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906307216617       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906307216617       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906307216617       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906307216617       residual = 7.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906307230181       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906307237289       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906307216098       residual = 7.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 4.953694e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185069 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5536e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9042
    reference variance = 0.165777
====================================================
  Execution time = 2.2341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4744e-01
  Total weights = 2.0000e+06
  Execution time = 1.8767e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347328594158
                                         uncertainty =       0.008744912424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347328594158
                                         uncertainty =       0.008744912424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416798551
  error estimate for blocks of size 2^( 2) =       0.000429446902
  error estimate for blocks of size 2^( 3) =       0.000442463702
  error estimate for blocks of size 2^( 4) =       0.000454522498
  error estimate for blocks of size 2^( 5) =       0.000465166320
  error estimate for blocks of size 2^( 6) =       0.000472422913
  error estimate for blocks of size 2^( 7) =       0.000475028173

      target function =                  N/A
              le_mean =     -16.907113959024
             les_mean =     286.197944313693
             stat err =       0.000466784976
             autocorr =       1.254241995628
              std dev =       0.589442163398
             le_variance =       0.347442063991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347328594208
                                         uncertainty =       0.008744912426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347328594208
                                         uncertainty =       0.008744912426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416798551
  error estimate for blocks of size 2^( 2) =       0.000429446902
  error estimate for blocks of size 2^( 3) =       0.000442463702
  error estimate for blocks of size 2^( 4) =       0.000454522498
  error estimate for blocks of size 2^( 5) =       0.000465166320
  error estimate for blocks of size 2^( 6) =       0.000472422913
  error estimate for blocks of size 2^( 7) =       0.000475028173

      target function =                  N/A
              le_mean =     -16.907113959024
             les_mean =     286.197944313754
             stat err =       0.000466784976
             autocorr =       1.254241995571
              std dev =       0.589442163440
             le_variance =       0.347442064041

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347328594183
                                         uncertainty =       0.008744912425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347328594183
                                         uncertainty =       0.008744912425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416798551
  error estimate for blocks of size 2^( 2) =       0.000429446902
  error estimate for blocks of size 2^( 3) =       0.000442463702
  error estimate for blocks of size 2^( 4) =       0.000454522498
  error estimate for blocks of size 2^( 5) =       0.000465166320
  error estimate for blocks of size 2^( 6) =       0.000472422913
  error estimate for blocks of size 2^( 7) =       0.000475028173

      target function =                  N/A
              le_mean =     -16.907113959024
             les_mean =     286.197944313724
             stat err =       0.000466784976
             autocorr =       1.254241995598
              std dev =       0.589442163419
             le_variance =       0.347442064016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347328594161
                                         uncertainty =       0.008744912424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347328594161
                                         uncertainty =       0.008744912424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416798551
  error estimate for blocks of size 2^( 2) =       0.000429446902
  error estimate for blocks of size 2^( 3) =       0.000442463702
  error estimate for blocks of size 2^( 4) =       0.000454522498
  error estimate for blocks of size 2^( 5) =       0.000465166320
  error estimate for blocks of size 2^( 6) =       0.000472422913
  error estimate for blocks of size 2^( 7) =       0.000475028173

      target function =                  N/A
              le_mean =     -16.907113959024
             les_mean =     286.197944313697
             stat err =       0.000466784976
             autocorr =       1.254241995624
              std dev =       0.589442163400
             le_variance =       0.347442063994


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907113959024        initial
     2.3283e+06     2.3283e+07             7.9256e-11       -16.907113959024  <--
     9.3132e+06     9.3132e+07             1.9814e-11       -16.907113959024
     3.7253e+07     3.7253e+08             4.9537e-12       -16.907113959024

*****************************************************************************
Applying the update for shift_i =   2.3283e+06     and shift_s =   2.3283e+07
*****************************************************************************

  Execution time = 3.1822e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7366e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8355
    reference variance = 0.174557
====================================================
  Execution time = 2.0400e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3779e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4847e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337843074911
                                         uncertainty =       0.003106466507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337843074911
                                         uncertainty =       0.003106466507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410966146
  error estimate for blocks of size 2^( 2) =       0.000424238300
  error estimate for blocks of size 2^( 3) =       0.000437984236
  error estimate for blocks of size 2^( 4) =       0.000450361558
  error estimate for blocks of size 2^( 5) =       0.000461810425
  error estimate for blocks of size 2^( 6) =       0.000471103996
  error estimate for blocks of size 2^( 7) =       0.000475565989

      target function =                  N/A
              le_mean =     -16.906409386574
             les_mean =     286.164464523848
             stat err =       0.000464710492
             autocorr =       1.278653466702
              std dev =       0.581193897331
             le_variance =       0.337786346295


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690640938657e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906409386574       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906409386573       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906409386573       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906409386840       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906409386610       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906409386556       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906409386107       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906409386060       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.136944e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906409386574       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906409386574       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906409386574       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906409388389       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906409386876       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906409387751       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906409386418       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906409387984       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 7.842373e-11

solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906409386574       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906409386574       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906409386574       residual = 5.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906409386574       residual = 8.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906409385785       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906409389363       residual = 5.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906409379932       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906409377728       residual = 3.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 1.960592e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.187686 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5892e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.907
    reference variance = 0.283895
====================================================
  Execution time = 2.0049e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4219e-01
  Total weights = 2.0000e+06
  Execution time = 1.8851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342270803217
                                         uncertainty =       0.008449604121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342270803217
                                         uncertainty =       0.008449604121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413635617
  error estimate for blocks of size 2^( 2) =       0.000425984128
  error estimate for blocks of size 2^( 3) =       0.000438981605
  error estimate for blocks of size 2^( 4) =       0.000449462433
  error estimate for blocks of size 2^( 5) =       0.000459521275
  error estimate for blocks of size 2^( 6) =       0.000467803855
  error estimate for blocks of size 2^( 7) =       0.000470276913

      target function =                  N/A
              le_mean =     -16.905815005965
             les_mean =     286.148769692567
             stat err =       0.000461766119
             autocorr =       1.246258900900
              std dev =       0.584969099815
             le_variance =       0.342188847738

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342270803044
                                         uncertainty =       0.008449604107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342270803044
                                         uncertainty =       0.008449604107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413635617
  error estimate for blocks of size 2^( 2) =       0.000425984128
  error estimate for blocks of size 2^( 3) =       0.000438981605
  error estimate for blocks of size 2^( 4) =       0.000449462433
  error estimate for blocks of size 2^( 5) =       0.000459521275
  error estimate for blocks of size 2^( 6) =       0.000467803855
  error estimate for blocks of size 2^( 7) =       0.000470276913

      target function =                  N/A
              le_mean =     -16.905815005967
             les_mean =     286.148769692452
             stat err =       0.000461766119
             autocorr =       1.246258901050
              std dev =       0.584969099667
             le_variance =       0.342188847565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342270803130
                                         uncertainty =       0.008449604114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342270803130
                                         uncertainty =       0.008449604114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413635617
  error estimate for blocks of size 2^( 2) =       0.000425984128
  error estimate for blocks of size 2^( 3) =       0.000438981605
  error estimate for blocks of size 2^( 4) =       0.000449462433
  error estimate for blocks of size 2^( 5) =       0.000459521275
  error estimate for blocks of size 2^( 6) =       0.000467803855
  error estimate for blocks of size 2^( 7) =       0.000470276913

      target function =                  N/A
              le_mean =     -16.905815005966
             les_mean =     286.148769692509
             stat err =       0.000461766119
             autocorr =       1.246258900983
              std dev =       0.584969099741
             le_variance =       0.342188847652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342270803206
                                         uncertainty =       0.008449604120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342270803206
                                         uncertainty =       0.008449604120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413635617
  error estimate for blocks of size 2^( 2) =       0.000425984128
  error estimate for blocks of size 2^( 3) =       0.000438981605
  error estimate for blocks of size 2^( 4) =       0.000449462433
  error estimate for blocks of size 2^( 5) =       0.000459521275
  error estimate for blocks of size 2^( 6) =       0.000467803855
  error estimate for blocks of size 2^( 7) =       0.000470276913

      target function =                  N/A
              le_mean =     -16.905815005965
             les_mean =     286.148769692560
             stat err =       0.000461766119
             autocorr =       1.246258900925
              std dev =       0.584969099806
             le_variance =       0.342188847728


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905815005965        initial
     5.8208e+05     5.8208e+06             3.1369e-10       -16.905815005967  <--
     2.3283e+06     2.3283e+07             7.8424e-11       -16.905815005966
     9.3132e+06     9.3132e+07             1.9606e-11       -16.905815005965

*****************************************************************************
Applying the update for shift_i =   5.8208e+05     and shift_s =   5.8208e+06
*****************************************************************************

  Execution time = 2.9555e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5454e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9023
    reference variance = 0.271925
====================================================
  Execution time = 2.0371e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3721e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111303739
                                         uncertainty =       0.002724854939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337111303739
                                         uncertainty =       0.002724854939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410614816
  error estimate for blocks of size 2^( 2) =       0.000423178094
  error estimate for blocks of size 2^( 3) =       0.000436194271
  error estimate for blocks of size 2^( 4) =       0.000448177972
  error estimate for blocks of size 2^( 5) =       0.000458776837
  error estimate for blocks of size 2^( 6) =       0.000467461790
  error estimate for blocks of size 2^( 7) =       0.000475464722

      target function =                  N/A
              le_mean =     -16.905535937199
             les_mean =     286.134354208904
             stat err =       0.000462470330
             autocorr =       1.268523510950
              std dev =       0.580697041128
             le_variance =       0.337209053575


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690553593720e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905535937199       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905535937200       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905535937198       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905535937078       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905535937136       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905535937186       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905535937112       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.241570e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905535937199       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905535937199       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905535937199       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905535937205       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905535937204       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905535937437       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905535937499       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 3.103927e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905535937199       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905535937199       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905535937199       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905535937199       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905535937430       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905535938859       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905535937588       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 7.759824e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189908 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6003e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730852e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8877
    reference variance = 0.507974
====================================================
  Execution time = 2.0030e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4797e-01
  Total weights = 2.0000e+06
  Execution time = 1.8694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348040367893
                                         uncertainty =       0.004477708916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348040367893
                                         uncertainty =       0.004477708916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417116272
  error estimate for blocks of size 2^( 2) =       0.000429724862
  error estimate for blocks of size 2^( 3) =       0.000442652160
  error estimate for blocks of size 2^( 4) =       0.000454543037
  error estimate for blocks of size 2^( 5) =       0.000464458815
  error estimate for blocks of size 2^( 6) =       0.000470425186
  error estimate for blocks of size 2^( 7) =       0.000474621983

      target function =                  N/A
              le_mean =     -16.906483472593
             les_mean =     286.177155203735
             stat err =       0.000466012255
             autocorr =       1.248189174047
              std dev =       0.589891488895
             le_variance =       0.347971968671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348040367314
                                         uncertainty =       0.004477708910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348040367314
                                         uncertainty =       0.004477708910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417116272
  error estimate for blocks of size 2^( 2) =       0.000429724861
  error estimate for blocks of size 2^( 3) =       0.000442652160
  error estimate for blocks of size 2^( 4) =       0.000454543037
  error estimate for blocks of size 2^( 5) =       0.000464458815
  error estimate for blocks of size 2^( 6) =       0.000470425186
  error estimate for blocks of size 2^( 7) =       0.000474621983

      target function =                  N/A
              le_mean =     -16.906483472592
             les_mean =     286.177155203145
             stat err =       0.000466012255
             autocorr =       1.248189174531
              std dev =       0.589891488404
             le_variance =       0.347971968091

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348040367603
                                         uncertainty =       0.004477708913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348040367603
                                         uncertainty =       0.004477708913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417116272
  error estimate for blocks of size 2^( 2) =       0.000429724861
  error estimate for blocks of size 2^( 3) =       0.000442652160
  error estimate for blocks of size 2^( 4) =       0.000454543037
  error estimate for blocks of size 2^( 5) =       0.000464458815
  error estimate for blocks of size 2^( 6) =       0.000470425186
  error estimate for blocks of size 2^( 7) =       0.000474621983

      target function =                  N/A
              le_mean =     -16.906483472593
             les_mean =     286.177155203440
             stat err =       0.000466012255
             autocorr =       1.248189174291
              std dev =       0.589891488649
             le_variance =       0.347971968381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348040367857
                                         uncertainty =       0.004477708916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348040367857
                                         uncertainty =       0.004477708916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417116272
  error estimate for blocks of size 2^( 2) =       0.000429724862
  error estimate for blocks of size 2^( 3) =       0.000442652160
  error estimate for blocks of size 2^( 4) =       0.000454543037
  error estimate for blocks of size 2^( 5) =       0.000464458815
  error estimate for blocks of size 2^( 6) =       0.000470425186
  error estimate for blocks of size 2^( 7) =       0.000474621983

      target function =                  N/A
              le_mean =     -16.906483472593
             les_mean =     286.177155203698
             stat err =       0.000466012255
             autocorr =       1.248189174072
              std dev =       0.589891488864
             le_variance =       0.347971968635


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906483472593        initial  <--
     1.4552e+05     1.4552e+06             1.2416e-09       -16.906483472592
     5.8208e+05     5.8208e+06             3.1039e-10       -16.906483472593
     2.3283e+06     2.3283e+07             7.7598e-11       -16.906483472593

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4808
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5496e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9144
    reference variance = 0.212763
====================================================
  Execution time = 2.0293e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4060e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340658280408
                                         uncertainty =       0.005051803697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340658280408
                                         uncertainty =       0.005051803697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412674253
  error estimate for blocks of size 2^( 2) =       0.000424793832
  error estimate for blocks of size 2^( 3) =       0.000437467216
  error estimate for blocks of size 2^( 4) =       0.000448928008
  error estimate for blocks of size 2^( 5) =       0.000458814550
  error estimate for blocks of size 2^( 6) =       0.000464824344
  error estimate for blocks of size 2^( 7) =       0.000469622062

      target function =                  N/A
              le_mean =     -16.905989975348
             les_mean =     286.153096955099
             stat err =       0.000460547241
             autocorr =       1.245471004911
              std dev =       0.583609525992
             le_variance =       0.340600078828


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690598997535e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905989975348       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905989975348       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905989975348       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905989975260       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905989975644       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905989976714       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905989975366       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.124275e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905989975348       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905989975348       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905989975348       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905989970466       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905989976144       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905989975024       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905989975397       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 2.810651e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905989975348       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905989975348       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905989975348       residual = 9.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905989975348       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905989975287       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905989992170       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905989975159       residual = 6.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 7.027043e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192094 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5854e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.0624
    reference variance = 0.366965
====================================================
  Execution time = 2.0149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3776e-01
  Total weights = 2.0000e+06
  Execution time = 1.8757e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758992290
                                         uncertainty =       0.003463414950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758992290
                                         uncertainty =       0.003463414950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410953164
  error estimate for blocks of size 2^( 2) =       0.000423563319
  error estimate for blocks of size 2^( 3) =       0.000436411994
  error estimate for blocks of size 2^( 4) =       0.000448701888
  error estimate for blocks of size 2^( 5) =       0.000459135449
  error estimate for blocks of size 2^( 6) =       0.000466046477
  error estimate for blocks of size 2^( 7) =       0.000470543577

      target function =                  N/A
              le_mean =     -16.906531446583
             les_mean =     286.168570390739
             stat err =       0.000461106848
             autocorr =       1.258979003521
              std dev =       0.581175537435
             le_variance =       0.337765005313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758992203
                                         uncertainty =       0.003463414950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758992203
                                         uncertainty =       0.003463414950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410953164
  error estimate for blocks of size 2^( 2) =       0.000423563319
  error estimate for blocks of size 2^( 3) =       0.000436411994
  error estimate for blocks of size 2^( 4) =       0.000448701888
  error estimate for blocks of size 2^( 5) =       0.000459135449
  error estimate for blocks of size 2^( 6) =       0.000466046477
  error estimate for blocks of size 2^( 7) =       0.000470543577

      target function =                  N/A
              le_mean =     -16.906531446583
             les_mean =     286.168570390649
             stat err =       0.000461106848
             autocorr =       1.258979003608
              std dev =       0.581175537360
             le_variance =       0.337765005226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758992247
                                         uncertainty =       0.003463414950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758992247
                                         uncertainty =       0.003463414950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410953164
  error estimate for blocks of size 2^( 2) =       0.000423563319
  error estimate for blocks of size 2^( 3) =       0.000436411994
  error estimate for blocks of size 2^( 4) =       0.000448701888
  error estimate for blocks of size 2^( 5) =       0.000459135449
  error estimate for blocks of size 2^( 6) =       0.000466046477
  error estimate for blocks of size 2^( 7) =       0.000470543577

      target function =                  N/A
              le_mean =     -16.906531446583
             les_mean =     286.168570390694
             stat err =       0.000461106848
             autocorr =       1.258979003573
              std dev =       0.581175537398
             le_variance =       0.337765005270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758992285
                                         uncertainty =       0.003463414950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337758992285
                                         uncertainty =       0.003463414950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410953164
  error estimate for blocks of size 2^( 2) =       0.000423563319
  error estimate for blocks of size 2^( 3) =       0.000436411994
  error estimate for blocks of size 2^( 4) =       0.000448701888
  error estimate for blocks of size 2^( 5) =       0.000459135449
  error estimate for blocks of size 2^( 6) =       0.000466046477
  error estimate for blocks of size 2^( 7) =       0.000470543577

      target function =                  N/A
              le_mean =     -16.906531446583
             les_mean =     286.168570390734
             stat err =       0.000461106848
             autocorr =       1.258979003534
              std dev =       0.581175537431
             le_variance =       0.337765005308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906531446583        initial  <--
     1.4552e+06     1.4552e+07             1.1243e-10       -16.906531446583
     5.8208e+06     5.8208e+07             2.8107e-11       -16.906531446583
     2.3283e+07     2.3283e+08             7.0270e-12       -16.906531446583

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6344
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5496e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9917
    reference variance = 0.240469
====================================================
  Execution time = 2.0432e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4869e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5919e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348800555372
                                         uncertainty =       0.013668154439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348800555372
                                         uncertainty =       0.013668154439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417544008
  error estimate for blocks of size 2^( 2) =       0.000430520206
  error estimate for blocks of size 2^( 3) =       0.000444099452
  error estimate for blocks of size 2^( 4) =       0.000456239109
  error estimate for blocks of size 2^( 5) =       0.000466639079
  error estimate for blocks of size 2^( 6) =       0.000474950613
  error estimate for blocks of size 2^( 7) =       0.000482270384

      target function =                  N/A
              le_mean =     -16.906480453040
             les_mean =     286.177767132102
             stat err =       0.000470024796
             autocorr =       1.267176259081
              std dev =       0.590496399146
             le_variance =       0.348685997404


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690648045304e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906480453040       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906480453040       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906480453041       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906480453034       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906480453041       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906480460848       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906480459369       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906480460093       residual = 3.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.561747e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906480453040       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906480453040       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906480453040       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906480453040       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906480441062       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906480459574       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906480452202       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906480381782       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 3.904377e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906480453040       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906480453040       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906480453040       residual = 6.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906480453040       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906480453040       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906480463859       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906480427733       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906480685232       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 9.760926e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.194668 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6030e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9943
    reference variance = 0.289065
====================================================
  Execution time = 1.9894e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3410e-01
  Total weights = 2.0000e+06
  Execution time = 1.8770e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334119651103
                                         uncertainty =       0.007378271252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334119651103
                                         uncertainty =       0.007378271252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408715449
  error estimate for blocks of size 2^( 2) =       0.000421310608
  error estimate for blocks of size 2^( 3) =       0.000433784096
  error estimate for blocks of size 2^( 4) =       0.000445682871
  error estimate for blocks of size 2^( 5) =       0.000455405026
  error estimate for blocks of size 2^( 6) =       0.000463688291
  error estimate for blocks of size 2^( 7) =       0.000470457146

      target function =                  N/A
              le_mean =     -16.905364859930
             les_mean =     286.125457516138
             stat err =       0.000458808334
             autocorr =       1.260144906273
              std dev =       0.578010930556
             le_variance =       0.334096635842

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334119651100
                                         uncertainty =       0.007378271251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334119651100
                                         uncertainty =       0.007378271251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408715449
  error estimate for blocks of size 2^( 2) =       0.000421310608
  error estimate for blocks of size 2^( 3) =       0.000433784096
  error estimate for blocks of size 2^( 4) =       0.000445682871
  error estimate for blocks of size 2^( 5) =       0.000455405026
  error estimate for blocks of size 2^( 6) =       0.000463688291
  error estimate for blocks of size 2^( 7) =       0.000470457146

      target function =                  N/A
              le_mean =     -16.905364859930
             les_mean =     286.125457516136
             stat err =       0.000458808334
             autocorr =       1.260144906275
              std dev =       0.578010930553
             le_variance =       0.334096635839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334119651102
                                         uncertainty =       0.007378271252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334119651102
                                         uncertainty =       0.007378271252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408715449
  error estimate for blocks of size 2^( 2) =       0.000421310608
  error estimate for blocks of size 2^( 3) =       0.000433784096
  error estimate for blocks of size 2^( 4) =       0.000445682871
  error estimate for blocks of size 2^( 5) =       0.000455405026
  error estimate for blocks of size 2^( 6) =       0.000463688291
  error estimate for blocks of size 2^( 7) =       0.000470457146

      target function =                  N/A
              le_mean =     -16.905364859930
             les_mean =     286.125457516137
             stat err =       0.000458808334
             autocorr =       1.260144906279
              std dev =       0.578010930555
             le_variance =       0.334096635841

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334119651103
                                         uncertainty =       0.007378271252

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334119651103
                                         uncertainty =       0.007378271252

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408715449
  error estimate for blocks of size 2^( 2) =       0.000421310608
  error estimate for blocks of size 2^( 3) =       0.000433784096
  error estimate for blocks of size 2^( 4) =       0.000445682871
  error estimate for blocks of size 2^( 5) =       0.000455405026
  error estimate for blocks of size 2^( 6) =       0.000463688291
  error estimate for blocks of size 2^( 7) =       0.000470457146

      target function =                  N/A
              le_mean =     -16.905364859930
             les_mean =     286.125457516138
             stat err =       0.000458808334
             autocorr =       1.260144906275
              std dev =       0.578010930556
             le_variance =       0.334096635842


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905364859930        initial
     1.4552e+07     1.4552e+08             1.5617e-11       -16.905364859930  <--
     5.8208e+07     5.8208e+08             3.9044e-12       -16.905364859930
     2.3283e+08     2.3283e+09             9.7609e-13       -16.905364859930

*****************************************************************************
Applying the update for shift_i =   1.4552e+07     and shift_s =   1.4552e+08
*****************************************************************************

  Execution time = 2.9375e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5413e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9173
    reference variance = 0.265617
====================================================
  Execution time = 2.0370e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3902e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5549e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338857036133
                                         uncertainty =       0.003900759641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338857036133
                                         uncertainty =       0.003900759641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411717839
  error estimate for blocks of size 2^( 2) =       0.000424434113
  error estimate for blocks of size 2^( 3) =       0.000436920538
  error estimate for blocks of size 2^( 4) =       0.000449020630
  error estimate for blocks of size 2^( 5) =       0.000459869477
  error estimate for blocks of size 2^( 6) =       0.000466225519
  error estimate for blocks of size 2^( 7) =       0.000469561529

      target function =                  N/A
              le_mean =     -16.906124982980
             les_mean =     286.156084928699
             stat err =       0.000461169289
             autocorr =       1.254646519712
              std dev =       0.582256951917
             le_variance =       0.339023158056


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690612498298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906124982980       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124982980       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906124982980       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906124984981       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906124983963       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906124984496       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906124980983       residual = 9.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 3.835004e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906124982980       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124982980       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906124982980       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906124982980       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906124982980       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906124982359       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906124988173       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 9.587455e-12

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906124982980       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906124982980       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906124982980       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906125023542       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906124950429       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906124929473       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906124980961       residual = 9.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 2.396416e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196897 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5932e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.8859
    reference variance = 0.204913
====================================================
  Execution time = 1.9986e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4604e-01
  Total weights = 2.0000e+06
  Execution time = 1.8759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346172586259
                                         uncertainty =       0.010194458201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346172586259
                                         uncertainty =       0.010194458201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415956959
  error estimate for blocks of size 2^( 2) =       0.000428804598
  error estimate for blocks of size 2^( 3) =       0.000441813030
  error estimate for blocks of size 2^( 4) =       0.000453367741
  error estimate for blocks of size 2^( 5) =       0.000463736901
  error estimate for blocks of size 2^( 6) =       0.000470781402
  error estimate for blocks of size 2^( 7) =       0.000474957823

      target function =                  N/A
              le_mean =     -16.906212248976
             les_mean =     286.166052817959
             stat err =       0.000465710967
             autocorr =       1.253534065852
              std dev =       0.588251972855
             le_variance =       0.346040383568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346172586243
                                         uncertainty =       0.010194458199

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346172586243
                                         uncertainty =       0.010194458199

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415956959
  error estimate for blocks of size 2^( 2) =       0.000428804598
  error estimate for blocks of size 2^( 3) =       0.000441813030
  error estimate for blocks of size 2^( 4) =       0.000453367741
  error estimate for blocks of size 2^( 5) =       0.000463736901
  error estimate for blocks of size 2^( 6) =       0.000470781402
  error estimate for blocks of size 2^( 7) =       0.000474957823

      target function =                  N/A
              le_mean =     -16.906212248976
             les_mean =     286.166052817948
             stat err =       0.000465710967
             autocorr =       1.253534065870
              std dev =       0.588251972842
             le_variance =       0.346040383553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346172586251
                                         uncertainty =       0.010194458200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346172586251
                                         uncertainty =       0.010194458200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415956959
  error estimate for blocks of size 2^( 2) =       0.000428804598
  error estimate for blocks of size 2^( 3) =       0.000441813030
  error estimate for blocks of size 2^( 4) =       0.000453367741
  error estimate for blocks of size 2^( 5) =       0.000463736901
  error estimate for blocks of size 2^( 6) =       0.000470781402
  error estimate for blocks of size 2^( 7) =       0.000474957823

      target function =                  N/A
              le_mean =     -16.906212248976
             les_mean =     286.166052817953
             stat err =       0.000465710967
             autocorr =       1.253534065868
              std dev =       0.588251972849
             le_variance =       0.346040383561

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346172586258
                                         uncertainty =       0.010194458201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346172586258
                                         uncertainty =       0.010194458201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415956959
  error estimate for blocks of size 2^( 2) =       0.000428804598
  error estimate for blocks of size 2^( 3) =       0.000441813030
  error estimate for blocks of size 2^( 4) =       0.000453367741
  error estimate for blocks of size 2^( 5) =       0.000463736901
  error estimate for blocks of size 2^( 6) =       0.000470781402
  error estimate for blocks of size 2^( 7) =       0.000474957823

      target function =                  N/A
              le_mean =     -16.906212248976
             les_mean =     286.166052817958
             stat err =       0.000465710967
             autocorr =       1.253534065854
              std dev =       0.588251972854
             le_variance =       0.346040383567


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906212248976        initial
     3.6380e+06     3.6380e+07             3.8350e-11       -16.906212248976  <--
     1.4552e+07     1.4552e+08             9.5875e-12       -16.906212248976
     5.8208e+07     5.8208e+08             2.3964e-12       -16.906212248976

*****************************************************************************
Applying the update for shift_i =   3.6380e+06     and shift_s =   3.6380e+07
*****************************************************************************

  Execution time = 2.9476e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9429
    reference variance = 0.324155
====================================================
  Execution time = 2.2456e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4305e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6167e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343176079648
                                         uncertainty =       0.004233632598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343176079648
                                         uncertainty =       0.004233632598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414155008
  error estimate for blocks of size 2^( 2) =       0.000426643389
  error estimate for blocks of size 2^( 3) =       0.000439006708
  error estimate for blocks of size 2^( 4) =       0.000450347175
  error estimate for blocks of size 2^( 5) =       0.000460451366
  error estimate for blocks of size 2^( 6) =       0.000466392787
  error estimate for blocks of size 2^( 7) =       0.000468692580

      target function =                  N/A
              le_mean =     -16.906608158384
             les_mean =     286.176447990239
             stat err =       0.000461470977
             autocorr =       1.241546388767
              std dev =       0.585703628671
             le_variance =       0.343048740638


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690660815838e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+05, overlap shift 9.0949e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906608158384       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906608158384       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906608158384       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906608158385       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906608158385       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906608158098       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906608158474       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+05 is 2.755653e-10

solving harmonic davidson linear method for identity shift 3.6380e+06, overlap shift 3.6380e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906608158384       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906608158384       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906608158384       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906608158385       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906608159624       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906608161283       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906608160329       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+06 is 6.889205e-11

solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906608158384       residual = 7.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906608158384       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906608158384       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906608150520       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906608158754       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906608156855       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906608147802       residual = 9.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 1.722271e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199096 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8079e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.8695
    reference variance = 0.214943
====================================================
  Execution time = 2.0130e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3866e-01
  Total weights = 2.0000e+06
  Execution time = 1.8759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338718004264
                                         uncertainty =       0.003572338144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338718004264
                                         uncertainty =       0.003572338144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411499495
  error estimate for blocks of size 2^( 2) =       0.000423963077
  error estimate for blocks of size 2^( 3) =       0.000436149125
  error estimate for blocks of size 2^( 4) =       0.000447799584
  error estimate for blocks of size 2^( 5) =       0.000457846699
  error estimate for blocks of size 2^( 6) =       0.000466363440
  error estimate for blocks of size 2^( 7) =       0.000472337279

      target function =                  N/A
              le_mean =     -16.906273967351
             les_mean =     286.160762958159
             stat err =       0.000461086751
             autocorr =       1.255528782621
              std dev =       0.581948166375
             le_variance =       0.338663668347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338718004385
                                         uncertainty =       0.003572338148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338718004385
                                         uncertainty =       0.003572338148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411499495
  error estimate for blocks of size 2^( 2) =       0.000423963077
  error estimate for blocks of size 2^( 3) =       0.000436149125
  error estimate for blocks of size 2^( 4) =       0.000447799584
  error estimate for blocks of size 2^( 5) =       0.000457846699
  error estimate for blocks of size 2^( 6) =       0.000466363440
  error estimate for blocks of size 2^( 7) =       0.000472337279

      target function =                  N/A
              le_mean =     -16.906273967351
             les_mean =     286.160762958254
             stat err =       0.000461086751
             autocorr =       1.255528782506
              std dev =       0.581948166479
             le_variance =       0.338663668468

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338718004325
                                         uncertainty =       0.003572338146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338718004325
                                         uncertainty =       0.003572338146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411499495
  error estimate for blocks of size 2^( 2) =       0.000423963077
  error estimate for blocks of size 2^( 3) =       0.000436149125
  error estimate for blocks of size 2^( 4) =       0.000447799584
  error estimate for blocks of size 2^( 5) =       0.000457846699
  error estimate for blocks of size 2^( 6) =       0.000466363440
  error estimate for blocks of size 2^( 7) =       0.000472337279

      target function =                  N/A
              le_mean =     -16.906273967351
             les_mean =     286.160762958207
             stat err =       0.000461086751
             autocorr =       1.255528782559
              std dev =       0.581948166426
             le_variance =       0.338663668407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338718004272
                                         uncertainty =       0.003572338144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338718004272
                                         uncertainty =       0.003572338144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411499495
  error estimate for blocks of size 2^( 2) =       0.000423963077
  error estimate for blocks of size 2^( 3) =       0.000436149125
  error estimate for blocks of size 2^( 4) =       0.000447799584
  error estimate for blocks of size 2^( 5) =       0.000457846699
  error estimate for blocks of size 2^( 6) =       0.000466363440
  error estimate for blocks of size 2^( 7) =       0.000472337279

      target function =                  N/A
              le_mean =     -16.906273967351
             les_mean =     286.160762958165
             stat err =       0.000461086751
             autocorr =       1.255528782605
              std dev =       0.581948166381
             le_variance =       0.338663668354


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906273967351        initial  <--
     9.0949e+05     9.0949e+06             2.7557e-10       -16.906273967351
     3.6380e+06     3.6380e+07             6.8892e-11       -16.906273967351
     1.4552e+07     1.4552e+08             1.7223e-11       -16.906273967351

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6062
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7693e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9283
    reference variance = 0.208292
====================================================
  Execution time = 2.0099e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4953e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349583481518
                                         uncertainty =       0.017879937348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349583481518
                                         uncertainty =       0.017879937348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418046774
  error estimate for blocks of size 2^( 2) =       0.000430522517
  error estimate for blocks of size 2^( 3) =       0.000443573563
  error estimate for blocks of size 2^( 4) =       0.000455652736
  error estimate for blocks of size 2^( 5) =       0.000465786275
  error estimate for blocks of size 2^( 6) =       0.000475053326
  error estimate for blocks of size 2^( 7) =       0.000481769955

      target function =                  N/A
              le_mean =     -16.906317227507
             les_mean =     286.173088232243
             stat err =       0.000469565573
             autocorr =       1.261661191297
              std dev =       0.591207416993
             le_variance =       0.349526209908


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690631722751e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906317227507       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906317227507       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906317227507       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906317228051       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906317227512       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906317230089       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906317220200       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906317206454       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+06 is 2.125927e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906317227507       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906317227507       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906317227507       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906317229376       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906317227507       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906317213689       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906317247624       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906317275361       residual = 4.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 5.315135e-12

solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906317227507       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906317227507       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906317227507       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906317232551       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906317232999       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906317297259       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906317229569       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906317234774       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.328914e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.201671 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5686e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9461
    reference variance = 0.173873
====================================================
  Execution time = 2.0068e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3869e-01
  Total weights = 2.0000e+06
  Execution time = 1.8797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338793735263
                                         uncertainty =       0.004884570895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338793735263
                                         uncertainty =       0.004884570895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411513129
  error estimate for blocks of size 2^( 2) =       0.000423904868
  error estimate for blocks of size 2^( 3) =       0.000436804285
  error estimate for blocks of size 2^( 4) =       0.000448745878
  error estimate for blocks of size 2^( 5) =       0.000458499666
  error estimate for blocks of size 2^( 6) =       0.000467294955
  error estimate for blocks of size 2^( 7) =       0.000473159745

      target function =                  N/A
              le_mean =     -16.906003569818
             les_mean =     286.151642644326
             stat err =       0.000461925061
             autocorr =       1.260014833004
              std dev =       0.581967448381
             le_variance =       0.338686110976

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338793735256
                                         uncertainty =       0.004884570895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338793735256
                                         uncertainty =       0.004884570895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411513129
  error estimate for blocks of size 2^( 2) =       0.000423904868
  error estimate for blocks of size 2^( 3) =       0.000436804285
  error estimate for blocks of size 2^( 4) =       0.000448745878
  error estimate for blocks of size 2^( 5) =       0.000458499666
  error estimate for blocks of size 2^( 6) =       0.000467294955
  error estimate for blocks of size 2^( 7) =       0.000473159745

      target function =                  N/A
              le_mean =     -16.906003569818
             les_mean =     286.151642644320
             stat err =       0.000461925061
             autocorr =       1.260014833015
              std dev =       0.581967448376
             le_variance =       0.338686110969

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338793735260
                                         uncertainty =       0.004884570895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338793735260
                                         uncertainty =       0.004884570895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411513129
  error estimate for blocks of size 2^( 2) =       0.000423904868
  error estimate for blocks of size 2^( 3) =       0.000436804285
  error estimate for blocks of size 2^( 4) =       0.000448745878
  error estimate for blocks of size 2^( 5) =       0.000458499666
  error estimate for blocks of size 2^( 6) =       0.000467294955
  error estimate for blocks of size 2^( 7) =       0.000473159745

      target function =                  N/A
              le_mean =     -16.906003569818
             les_mean =     286.151642644323
             stat err =       0.000461925061
             autocorr =       1.260014833009
              std dev =       0.581967448379
             le_variance =       0.338686110972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338793735263
                                         uncertainty =       0.004884570895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338793735263
                                         uncertainty =       0.004884570895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411513129
  error estimate for blocks of size 2^( 2) =       0.000423904868
  error estimate for blocks of size 2^( 3) =       0.000436804285
  error estimate for blocks of size 2^( 4) =       0.000448745878
  error estimate for blocks of size 2^( 5) =       0.000458499666
  error estimate for blocks of size 2^( 6) =       0.000467294955
  error estimate for blocks of size 2^( 7) =       0.000473159745

      target function =                  N/A
              le_mean =     -16.906003569818
             les_mean =     286.151642644325
             stat err =       0.000461925061
             autocorr =       1.260014833014
              std dev =       0.581967448381
             le_variance =       0.338686110975


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906003569818        initial
     9.0949e+06     9.0949e+07             2.1259e-11       -16.906003569818  <--
     3.6380e+07     3.6380e+08             5.3151e-12       -16.906003569818
     1.4552e+08     1.4552e+09             1.3289e-12       -16.906003569818

*****************************************************************************
Applying the update for shift_i =   9.0949e+06     and shift_s =   9.0949e+07
*****************************************************************************

  Execution time = 2.9571e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5264e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.847
    reference variance = 0.271376
====================================================
  Execution time = 2.0350e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3801e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338038420603
                                         uncertainty =       0.004701061651

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338038420603
                                         uncertainty =       0.004701061651

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411105130
  error estimate for blocks of size 2^( 2) =       0.000423491378
  error estimate for blocks of size 2^( 3) =       0.000436616380
  error estimate for blocks of size 2^( 4) =       0.000448539608
  error estimate for blocks of size 2^( 5) =       0.000459033881
  error estimate for blocks of size 2^( 6) =       0.000466626254
  error estimate for blocks of size 2^( 7) =       0.000475851651

      target function =                  N/A
              le_mean =     -16.905951258495
             les_mean =     286.149202642004
             stat err =       0.000462512848
             autocorr =       1.265732146898
              std dev =       0.581390450903
             le_variance =       0.338014856402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690595125850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+06, overlap shift 2.2737e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905951258495       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905951258495       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905951258495       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905951258383       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905951257846       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905951252647       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905951258307       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905951258552       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+06 is 8.100643e-11

solving harmonic davidson linear method for identity shift 9.0949e+06, overlap shift 9.0949e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905951258495       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905951258495       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905951258495       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905951253621       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905951258495       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905951254026       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905951258495       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905951258493       residual = 2.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+06 is 2.025158e-11

solving harmonic davidson linear method for identity shift 3.6380e+07, overlap shift 3.6380e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905951258495       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905951258495       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905951258495       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905951223240       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905951258454       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905951254762       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905951273047       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905951275652       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+07 is 5.062119e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.204265 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5943e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730852e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.862
    reference variance = 0.1642
====================================================
  Execution time = 1.9988e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3594e-01
  Total weights = 2.0000e+06
  Execution time = 1.8700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336013379446
                                         uncertainty =       0.002920107804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336013379446
                                         uncertainty =       0.002920107804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409842326
  error estimate for blocks of size 2^( 2) =       0.000422598986
  error estimate for blocks of size 2^( 3) =       0.000436272098
  error estimate for blocks of size 2^( 4) =       0.000448003179
  error estimate for blocks of size 2^( 5) =       0.000458651128
  error estimate for blocks of size 2^( 6) =       0.000467519310
  error estimate for blocks of size 2^( 7) =       0.000472060713

      target function =                  N/A
              le_mean =     -16.905884901320
             les_mean =     286.144885593879
             stat err =       0.000461558582
             autocorr =       1.268294313010
              std dev =       0.579604576559
             le_variance =       0.335941465169

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336013379472
                                         uncertainty =       0.002920107804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336013379472
                                         uncertainty =       0.002920107804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409842327
  error estimate for blocks of size 2^( 2) =       0.000422598986
  error estimate for blocks of size 2^( 3) =       0.000436272098
  error estimate for blocks of size 2^( 4) =       0.000448003179
  error estimate for blocks of size 2^( 5) =       0.000458651128
  error estimate for blocks of size 2^( 6) =       0.000467519310
  error estimate for blocks of size 2^( 7) =       0.000472060713

      target function =                  N/A
              le_mean =     -16.905884901320
             les_mean =     286.144885593897
             stat err =       0.000461558582
             autocorr =       1.268294312980
              std dev =       0.579604576582
             le_variance =       0.335941465194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336013379459
                                         uncertainty =       0.002920107804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336013379459
                                         uncertainty =       0.002920107804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409842326
  error estimate for blocks of size 2^( 2) =       0.000422598986
  error estimate for blocks of size 2^( 3) =       0.000436272098
  error estimate for blocks of size 2^( 4) =       0.000448003179
  error estimate for blocks of size 2^( 5) =       0.000458651128
  error estimate for blocks of size 2^( 6) =       0.000467519310
  error estimate for blocks of size 2^( 7) =       0.000472060713

      target function =                  N/A
              le_mean =     -16.905884901320
             les_mean =     286.144885593888
             stat err =       0.000461558582
             autocorr =       1.268294312989
              std dev =       0.579604576570
             le_variance =       0.335941465181

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336013379448
                                         uncertainty =       0.002920107804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336013379448
                                         uncertainty =       0.002920107804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409842326
  error estimate for blocks of size 2^( 2) =       0.000422598986
  error estimate for blocks of size 2^( 3) =       0.000436272098
  error estimate for blocks of size 2^( 4) =       0.000448003179
  error estimate for blocks of size 2^( 5) =       0.000458651128
  error estimate for blocks of size 2^( 6) =       0.000467519310
  error estimate for blocks of size 2^( 7) =       0.000472060713

      target function =                  N/A
              le_mean =     -16.905884901320
             les_mean =     286.144885593880
             stat err =       0.000461558582
             autocorr =       1.268294313012
              std dev =       0.579604576561
             le_variance =       0.335941465170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905884901320        initial  <--
     2.2737e+06     2.2737e+07             8.1006e-11       -16.905884901320
     9.0949e+06     9.0949e+07             2.0252e-11       -16.905884901320
     3.6380e+07     3.6380e+08             5.0621e-12       -16.905884901320

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4378
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.119553e-01 1 1  ON 0
 uu_1                 1.443612e-01 1 1  ON 1
 uu_2                 4.227954e-02 1 1  ON 2
 uu_3                -2.091318e-02 1 1  ON 3
 uu_4                -6.739302e-02 1 1  ON 4
 uu_5                -1.038626e-01 1 1  ON 5
 uu_6                -1.332105e-01 1 1  ON 6
 uu_7                -1.491685e-01 1 1  ON 7
 uu_8                -1.431060e-01 1 1  ON 8
 uu_9                -1.127137e-01 1 1  ON 9
 ud_0                 4.543891e-01 1 1  ON 10
 ud_1                 1.883267e-01 1 1  ON 11
 ud_2                 6.734361e-02 1 1  ON 12
 ud_3                -4.361401e-03 1 1  ON 13
 ud_4                -6.205385e-02 1 1  ON 14
 ud_5                -1.046264e-01 1 1  ON 15
 ud_6                -1.333936e-01 1 1  ON 16
 ud_7                -1.511899e-01 1 1  ON 17
 ud_8                -1.525473e-01 1 1  ON 18
 ud_9                -1.435980e-01 1 1  ON 19
 eO_0                -7.495067e-01 1 1  ON 20
 eO_1                -4.276912e-01 1 1  ON 21
 eO_2                -1.228651e-02 1 1  ON 22
 eO_3                 3.047740e-01 1 1  ON 23
 eO_4                 5.330075e-01 1 1  ON 24
 eO_5                 4.974630e-01 1 1  ON 25
 eO_6                 2.675125e-01 1 1  ON 26
 eO_7                -4.320004e-02 1 1  ON 27
 eO_8                -2.438796e-01 1 1  ON 28
 eO_9                -1.181711e-01 1 1  ON 29
eH1_0                -2.676094e-01 1 1  ON 30
eH1_1                -1.616498e-01 1 1  ON 31
eH1_2                -1.122983e-01 1 1  ON 32
eH1_3                -5.662083e-02 1 1  ON 33
eH1_4                -6.519594e-03 1 1  ON 34
eH1_5                 3.013049e-02 1 1  ON 35
eH1_6                 9.391007e-02 1 1  ON 36
eH1_7                 1.615722e-01 1 1  ON 37
eH1_8                 2.039372e-01 1 1  ON 38
eH1_9                 1.127297e-01 1 1  ON 39
eH2_0                -2.649530e-01 1 1  ON 40
eH2_1                -1.589176e-01 1 1  ON 41
eH2_2                -1.096174e-01 1 1  ON 42
eH2_3                -5.393643e-02 1 1  ON 43
eH2_4                -3.730851e-03 1 1  ON 44
eH2_5                 3.393142e-02 1 1  ON 45
eH2_6                 9.724689e-02 1 1  ON 46
eH2_7                 1.616514e-01 1 1  ON 47
eH2_8                 2.047342e-01 1 1  ON 48
eH2_9                 1.036299e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5388e+01 secs
  Total Execution time = 2.2351e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
