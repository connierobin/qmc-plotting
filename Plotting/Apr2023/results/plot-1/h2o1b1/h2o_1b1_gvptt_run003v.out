Rank =    0  Free Memory = 81667 MB
Rank =    1  Free Memory = 81666 MB
Rank =    2  Free Memory = 81666 MB
Rank =    3  Free Memory = 81666 MB
Rank =    4  Free Memory = 81666 MB
Rank =    5  Free Memory = 81666 MB
Rank =    6  Free Memory = 81666 MB
Rank =    7  Free Memory = 81666 MB
Rank =    8  Free Memory = 81665 MB
Rank =    9  Free Memory = 81665 MB
Rank =   10  Free Memory = 81665 MB
Rank =   11  Free Memory = 81665 MB
Rank =   12  Free Memory = 81665 MB
Rank =   13  Free Memory = 81665 MB
Rank =   14  Free Memory = 81664 MB
Rank =   15  Free Memory = 81654 MB
Rank =   16  Free Memory = 81651 MB
Rank =   17  Free Memory = 81651 MB
Rank =   18  Free Memory = 81651 MB
Rank =   19  Free Memory = 81651 MB
Rank =   20  Free Memory = 81651 MB
Rank =   21  Free Memory = 81651 MB
Rank =   22  Free Memory = 81651 MB
Rank =   23  Free Memory = 81651 MB
Rank =   24  Free Memory = 81651 MB
Rank =   25  Free Memory = 81651 MB
Rank =   26  Free Memory = 81651 MB
Rank =   27  Free Memory = 81651 MB
Rank =   28  Free Memory = 81651 MB
Rank =   29  Free Memory = 81651 MB
Rank =   30  Free Memory = 81651 MB
Rank =   31  Free Memory = 81650 MB
Rank =   32  Free Memory = 84664 MB
Rank =   33  Free Memory = 84664 MB
Rank =   34  Free Memory = 84664 MB
Rank =   35  Free Memory = 84664 MB
Rank =   36  Free Memory = 84664 MB
Rank =   37  Free Memory = 84663 MB
Rank =   38  Free Memory = 84663 MB
Rank =   39  Free Memory = 84663 MB
Rank =   40  Free Memory = 84663 MB
Rank =   41  Free Memory = 84663 MB
Rank =   42  Free Memory = 84663 MB
Rank =   43  Free Memory = 84663 MB
Rank =   44  Free Memory = 84663 MB
Rank =   45  Free Memory = 84663 MB
Rank =   46  Free Memory = 84663 MB
Rank =   47  Free Memory = 84663 MB
Rank =   48  Free Memory = 84663 MB
Rank =   49  Free Memory = 84663 MB
Rank =   50  Free Memory = 84663 MB
Rank =   51  Free Memory = 84663 MB
Rank =   52  Free Memory = 84663 MB
Rank =   53  Free Memory = 84663 MB
Rank =   54  Free Memory = 84663 MB
Rank =   55  Free Memory = 84663 MB
Rank =   56  Free Memory = 84663 MB
Rank =   57  Free Memory = 84663 MB
Rank =   58  Free Memory = 84663 MB
Rank =   59  Free Memory = 84663 MB
Rank =   60  Free Memory = 84663 MB
Rank =   61  Free Memory = 84663 MB
Rank =   62  Free Memory = 84663 MB
Rank =   63  Free Memory = 84663 MB
Rank =   64  Free Memory = 84147 MB
Rank =   65  Free Memory = 84147 MB
Rank =   66  Free Memory = 84147 MB
Rank =   67  Free Memory = 84147 MB
Rank =   68  Free Memory = 84147 MB
Rank =   69  Free Memory = 84147 MB
Rank =   70  Free Memory = 84147 MB
Rank =   71  Free Memory = 84147 MB
Rank =   72  Free Memory = 84147 MB
Rank =   73  Free Memory = 84147 MB
Rank =   74  Free Memory = 84147 MB
Rank =   75  Free Memory = 84147 MB
Rank =   76  Free Memory = 84147 MB
Rank =   77  Free Memory = 84147 MB
Rank =   78  Free Memory = 84147 MB
Rank =   79  Free Memory = 84147 MB
Rank =   80  Free Memory = 84147 MB
Rank =   81  Free Memory = 84147 MB
Rank =   82  Free Memory = 84147 MB
Rank =   83  Free Memory = 84147 MB
Rank =   84  Free Memory = 84147 MB
Rank =   85  Free Memory = 84146 MB
Rank =   86  Free Memory = 84146 MB
Rank =   87  Free Memory = 84146 MB
Rank =   88  Free Memory = 84146 MB
Rank =   89  Free Memory = 84146 MB
Rank =   90  Free Memory = 84146 MB
Rank =   91  Free Memory = 84146 MB
Rank =   92  Free Memory = 84146 MB
Rank =   93  Free Memory = 84146 MB
Rank =   94  Free Memory = 84146 MB
Rank =   95  Free Memory = 84146 MB
Rank =   96  Free Memory = 69919 MB
Rank =   97  Free Memory = 69919 MB
Rank =   98  Free Memory = 69919 MB
Rank =   99  Free Memory = 69919 MB
Rank =  100  Free Memory = 69919 MB
Rank =  101  Free Memory = 69919 MB
Rank =  102  Free Memory = 69919 MB
Rank =  103  Free Memory = 69919 MB
Rank =  104  Free Memory = 69919 MB
Rank =  105  Free Memory = 69919 MB
  Input file(s): opt_h2o_1b1_gvptt_run003v.xml 
Rank =  106  Free Memory = 69919 MB
Rank =  107  Free Memory = 69919 MB
Rank =  108  Free Memory = 69919 MB
Rank =  109  Free Memory = 69919 MB
Rank =  110  Free Memory = 69919 MB
Rank =  111  Free Memory = 69919 MB
Rank =  112  Free Memory = 69919 MB
Rank =  113  Free Memory = 69919 MB
Rank =  114  Free Memory = 69919 MB
Rank =  115  Free Memory = 69919 MB
Rank =  116  Free Memory = 69919 MB
Rank =  117  Free Memory = 69919 MB
Rank =  118  Free Memory = 69919 MB
Rank =  119  Free Memory = 69919 MB
Rank =  120  Free Memory = 69919 MB
Rank =  121  Free Memory = 69919 MB
Rank =  122  Free Memory = 69919 MB
Rank =  123  Free Memory = 69919 MB
Rank =  124  Free Memory = 69919 MB
Rank =  125  Free Memory = 69919 MB
Rank =  126  Free Memory = 69919 MB
Rank =  127  Free Memory = 69919 MB

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: 39b7557df04c29964085ccccce933740e3918067-dirty
  Last git commit date: Wed Mar 22 11:37:25 2023 -0700
  Last git commit subject: deleting more debugging statements
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_gvptt_run003v.xml

  Project = H2O
  date    = 2023-04-24 17:10:23 PDT
  host    = n0114.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 623

  Range of prime numbers to use as seeds over processors and threads = 4637-5717


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.115894e-01    1         1  ON     0
     uu_1                 1.443680e-01    1         1  ON     1
     uu_2                 4.235682e-02    1         1  ON     2
     uu_3                -2.053276e-02    1         1  ON     3
     uu_4                -6.678728e-02    1         1  ON     4
     uu_5                -1.028973e-01    1         1  ON     5
     uu_6                -1.319506e-01    1         1  ON     6
     uu_7                -1.471347e-01    1         1  ON     7
     uu_8                -1.402373e-01    1         1  ON     8
     uu_9                -1.126804e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.544254e-01    1         1  ON     0
     ud_1                 1.883003e-01    1         1  ON     1
     ud_2                 6.735747e-02    1         1  ON     2
     ud_3                -4.335117e-03    1         1  ON     3
     ud_4                -6.202956e-02    1         1  ON     4
     ud_5                -1.045684e-01    1         1  ON     5
     ud_6                -1.332070e-01    1         1  ON     6
     ud_7                -1.516366e-01    1         1  ON     7
     ud_8                -1.540559e-01    1         1  ON     8
     ud_9                -1.462024e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.510407e-01    1         1  ON     0
     eO_1                -4.293402e-01    1         1  ON     1
     eO_2                -1.394353e-02    1         1  ON     2
     eO_3                 3.032321e-01    1         1  ON     3
     eO_4                 5.308073e-01    1         1  ON     4
     eO_5                 4.941248e-01    1         1  ON     5
     eO_6                 2.652326e-01    1         1  ON     6
     eO_7                -4.105133e-02    1         1  ON     7
     eO_8                -2.401505e-01    1         1  ON     8
     eO_9                -1.114905e-01    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.647366e-01    1         1  ON     0
     eH1_1                -1.593806e-01    1         1  ON     1
     eH1_2                -1.099674e-01    1         1  ON     2
     eH1_3                -5.441772e-02    1         1  ON     3
     eH1_4                -4.021061e-03    1         1  ON     4
     eH1_5                 3.291174e-02    1         1  ON     5
     eH1_6                 9.579278e-02    1         1  ON     6
     eH1_7                 1.600168e-01    1         1  ON     7
     eH1_8                 1.995597e-01    1         1  ON     8
     eH1_9                 1.031986e-01    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.607438e-01    1         1  ON     0
     eH2_1                -1.556641e-01    1         1  ON     1
     eH2_2                -1.064044e-01    1         1  ON     2
     eH2_3                -5.105191e-02    1         1  ON     3
     eH2_4                -8.975626e-04    1         1  ON     4
     eH2_5                 3.478603e-02    1         1  ON     5
     eH2_6                 9.773895e-02    1         1  ON     6
     eH2_7                 1.601398e-01    1         1  ON     7
     eH2_8                 2.005955e-01    1         1  ON     8
     eH2_9                 9.330818e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.791456e+01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.1360e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9788
    reference variance = 1.19985
====================================================
  Execution time = 2.1147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3392e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5564e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333946286064
                                         uncertainty =       0.002283321728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333946286064
                                         uncertainty =       0.002283321728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408609731
  error estimate for blocks of size 2^( 2) =       0.000420882285
  error estimate for blocks of size 2^( 3) =       0.000433743984
  error estimate for blocks of size 2^( 4) =       0.000445079853
  error estimate for blocks of size 2^( 5) =       0.000454554158
  error estimate for blocks of size 2^( 6) =       0.000461836264
  error estimate for blocks of size 2^( 7) =       0.000464061044

      target function =                  N/A
              le_mean =     -16.906865544529
             les_mean =     286.176026198528
             stat err =       0.000456382830
             autocorr =       1.247501806835
              std dev =       0.577861423448
             le_variance =       0.333923824709


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.690686554453e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906865544529       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906866915300       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906865528790       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906865942460       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906864628237       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906865339476       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906866145316       residual = 8.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906866094981       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906865522468       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906865653147       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.295342e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906865544529       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906866033541       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906865594034       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906865753266       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906865292806       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906865512477       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906865755577       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906865778898       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 2.082448e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906865544529       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906865681391       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906865564715       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906865613285       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906865495119       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906865542195       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906865615044       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906865618095       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 5.305448e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304151 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7016e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.115766e-01                 1 1 ON  0
uu_1  1.444086e-01                 1 1 ON  1
uu_2  4.239165e-02                 1 1 ON  2
uu_3  -2.052447e-02                1 1 ON  3
uu_4  -6.683022e-02                1 1 ON  4
uu_5  -1.028642e-01                1 1 ON  5
uu_6  -1.318118e-01                1 1 ON  6
uu_7  -1.471307e-01                1 1 ON  7
uu_8  -1.403951e-01                1 1 ON  8
uu_9  -1.127993e-01                1 1 ON  9
ud_0  4.543446e-01                 1 1 ON  10
ud_1  1.883802e-01                 1 1 ON  11
ud_2  6.744116e-02                 1 1 ON  12
ud_3  -4.256366e-03                1 1 ON  13
ud_4  -6.196636e-02                1 1 ON  14
ud_5  -1.044314e-01                1 1 ON  15
ud_6  -1.332021e-01                1 1 ON  16
ud_7  -1.515756e-01                1 1 ON  17
ud_8  -1.542642e-01                1 1 ON  18
ud_9  -1.463024e-01                1 1 ON  19
eO_0  -7.510584e-01                1 1 ON  20
eO_1  -4.292358e-01                1 1 ON  21
eO_2  -1.393012e-02                1 1 ON  22
eO_3  3.033978e-01                 1 1 ON  23
eO_4  5.308250e-01                 1 1 ON  24
eO_5  4.941827e-01                 1 1 ON  25
eO_6  2.652550e-01                 1 1 ON  26
eO_7  -4.111018e-02                1 1 ON  27
eO_8  -2.402987e-01                1 1 ON  28
eO_9  -1.116254e-01                1 1 ON  29
eH1_0 -2.648626e-01                1 1 ON  30
eH1_1 -1.593409e-01                1 1 ON  31
eH1_2 -1.099832e-01                1 1 ON  32
eH1_3 -5.443587e-02                1 1 ON  33
eH1_4 -4.122510e-03                1 1 ON  34
eH1_5 3.289290e-02                 1 1 ON  35
eH1_6 9.582861e-02                 1 1 ON  36
eH1_7 1.599991e-01                 1 1 ON  37
eH1_8 1.996175e-01                 1 1 ON  38
eH1_9 1.033564e-01                 1 1 ON  39
eH2_0 -2.607858e-01                1 1 ON  40
eH2_1 -1.556818e-01                1 1 ON  41
eH2_2 -1.064232e-01                1 1 ON  42
eH2_3 -5.109899e-02                1 1 ON  43
eH2_4 -8.625718e-04                1 1 ON  44
eH2_5 3.471723e-02                 1 1 ON  45
eH2_6 9.772226e-02                 1 1 ON  46
eH2_7 1.601322e-01                 1 1 ON  47
eH2_8 2.005871e-01                 1 1 ON  48
eH2_9 9.347102e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.8531
    reference variance = 0.214508
====================================================
  Execution time = 2.0579e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3677e-01
  Total weights = 2.0000e+06
  Execution time = 1.8935e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336884151334
                                         uncertainty =       0.003477700530

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336884151334
                                         uncertainty =       0.003477700530

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410442721
  error estimate for blocks of size 2^( 2) =       0.000423673312
  error estimate for blocks of size 2^( 3) =       0.000437371612
  error estimate for blocks of size 2^( 4) =       0.000449940260
  error estimate for blocks of size 2^( 5) =       0.000460456887
  error estimate for blocks of size 2^( 6) =       0.000469460550
  error estimate for blocks of size 2^( 7) =       0.000475019109

      target function =                  N/A
              le_mean =     -16.905819628233
             les_mean =     286.143663588301
             stat err =       0.000463719202
             autocorr =       1.276453630050
              std dev =       0.580453662589
             le_variance =       0.336926454413

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336593567651
                                         uncertainty =       0.003474483468

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336593567651
                                         uncertainty =       0.003474483468

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410265661
  error estimate for blocks of size 2^( 2) =       0.000423501945
  error estimate for blocks of size 2^( 3) =       0.000437205605
  error estimate for blocks of size 2^( 4) =       0.000449780053
  error estimate for blocks of size 2^( 5) =       0.000460300681
  error estimate for blocks of size 2^( 6) =       0.000469312690
  error estimate for blocks of size 2^( 7) =       0.000474865267

      target function =                  N/A
              le_mean =     -16.905821804265
             les_mean =     286.143446533637
             stat err =       0.000463564673
             autocorr =       1.276704321692
              std dev =       0.580203261271
             le_variance =       0.336635824390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336578864842
                                         uncertainty =       0.003474058128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336578864842
                                         uncertainty =       0.003474058128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410256689
  error estimate for blocks of size 2^( 2) =       0.000423494858
  error estimate for blocks of size 2^( 3) =       0.000437199764
  error estimate for blocks of size 2^( 4) =       0.000449775198
  error estimate for blocks of size 2^( 5) =       0.000460295538
  error estimate for blocks of size 2^( 6) =       0.000469306676
  error estimate for blocks of size 2^( 7) =       0.000474859043

      target function =                  N/A
              le_mean =     -16.905821291649
             les_mean =     286.143414478669
             stat err =       0.000463559114
             autocorr =       1.276729538027
              std dev =       0.580190573710
             le_variance =       0.336621101822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336832767938
                                         uncertainty =       0.003477068570

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336832767938
                                         uncertainty =       0.003477068570

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410411416
  error estimate for blocks of size 2^( 2) =       0.000423643334
  error estimate for blocks of size 2^( 3) =       0.000437342751
  error estimate for blocks of size 2^( 4) =       0.000449912528
  error estimate for blocks of size 2^( 5) =       0.000460429748
  error estimate for blocks of size 2^( 6) =       0.000469434574
  error estimate for blocks of size 2^( 7) =       0.000474992125

      target function =                  N/A
              le_mean =     -16.905819852685
             les_mean =     286.143619784057
             stat err =       0.000463692244
             autocorr =       1.276499936846
              std dev =       0.580409390917
             le_variance =       0.336875061064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905819628233        initial
     2.5000e-01     2.5000e+00             7.2953e-04       -16.905821804265  <--
     1.0000e+00     1.0000e+01             2.0824e-04       -16.905821291649
     4.0000e+00     4.0000e+01             5.3054e-05       -16.905819852685

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0166e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.116269e-01 1 1  ON 0
 uu_1                 1.445023e-01 1 1  ON 1
 uu_2                 4.245195e-02 1 1  ON 2
 uu_3                -2.051247e-02 1 1  ON 3
 uu_4                -6.688946e-02 1 1  ON 4
 uu_5                -1.027702e-01 1 1  ON 5
 uu_6                -1.315948e-01 1 1  ON 6
 uu_7                -1.470818e-01 1 1  ON 7
 uu_8                -1.407796e-01 1 1  ON 8
 uu_9                -1.131467e-01 1 1  ON 9
 ud_0                 4.543664e-01 1 1  ON 10
 ud_1                 1.885526e-01 1 1  ON 11
 ud_2                 6.761703e-02 1 1  ON 12
 ud_3                -4.056944e-03 1 1  ON 13
 ud_4                -6.180645e-02 1 1  ON 14
 ud_5                -1.041607e-01 1 1  ON 15
 ud_6                -1.331629e-01 1 1  ON 16
 ud_7                -1.514330e-01 1 1  ON 17
 ud_8                -1.547855e-01 1 1  ON 18
 ud_9                -1.465907e-01 1 1  ON 19
 eO_0                -7.509990e-01 1 1  ON 20
 eO_1                -4.290301e-01 1 1  ON 21
 eO_2                -1.377151e-02 1 1  ON 22
 eO_3                 3.037425e-01 1 1  ON 23
 eO_4                 5.309206e-01 1 1  ON 24
 eO_5                 4.943491e-01 1 1  ON 25
 eO_6                 2.653063e-01 1 1  ON 26
 eO_7                -4.127307e-02 1 1  ON 27
 eO_8                -2.407383e-01 1 1  ON 28
 eO_9                -1.120369e-01 1 1  ON 29
eH1_0                -2.651389e-01 1 1  ON 30
eH1_1                -1.593315e-01 1 1  ON 31
eH1_2                -1.100686e-01 1 1  ON 32
eH1_3                -5.450928e-02 1 1  ON 33
eH1_4                -4.344959e-03 1 1  ON 34
eH1_5                 3.280905e-02 1 1  ON 35
eH1_6                 9.592042e-02 1 1  ON 36
eH1_7                 1.599529e-01 1 1  ON 37
eH1_8                 1.998009e-01 1 1  ON 38
eH1_9                 1.038387e-01 1 1  ON 39
eH2_0                -2.608915e-01 1 1  ON 40
eH2_1                -1.557408e-01 1 1  ON 41
eH2_2                -1.064852e-01 1 1  ON 42
eH2_3                -5.121128e-02 1 1  ON 43
eH2_4                -8.587070e-04 1 1  ON 44
eH2_5                 3.455846e-02 1 1  ON 45
eH2_6                 9.768035e-02 1 1  ON 46
eH2_7                 1.601045e-01 1 1  ON 47
eH2_8                 2.005645e-01 1 1  ON 48
eH2_9                 9.396781e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7189e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8691
    reference variance = 0.200885
====================================================
  Execution time = 2.3282e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.2707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5122e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327067015748
                                         uncertainty =       0.002060751993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.327067015748
                                         uncertainty =       0.002060751993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000404394293
  error estimate for blocks of size 2^( 2) =       0.000417277110
  error estimate for blocks of size 2^( 3) =       0.000430372994
  error estimate for blocks of size 2^( 4) =       0.000442718786
  error estimate for blocks of size 2^( 5) =       0.000453712087
  error estimate for blocks of size 2^( 6) =       0.000461315128
  error estimate for blocks of size 2^( 7) =       0.000465541085

      target function =                  N/A
              le_mean =     -16.905614953779
             les_mean =     286.126886290787
             stat err =       0.000455821771
             autocorr =       1.270515864054
              std dev =       0.571899894105
             le_variance =       0.327069488877


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690561495378e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905614953779       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905614418401       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905610317704       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905610844319       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905606684260       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905610539304       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905614690961       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905614127258       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905615441921       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905614225767       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905613598161       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905613529512       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905614020530       residual = 4.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.045385e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905614953779       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905614630921       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905612373691       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905611730331       residual = 6.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905609806094       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905610996093       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905612041372       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905612295346       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905612377317       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905612183512       residual = 4.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 7.543132e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905614953779       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905614829018       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905613910880       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905613377150       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905613091720       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905612796758       residual = 8.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905613079862       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905613216832       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905613240669       residual = 1.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.898130e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.309215 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8803e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.116811e-01 1 1  ON 0
 uu_1                 1.444012e-01 1 1  ON 1
 uu_2                 4.220256e-02 1 1  ON 2
 uu_3                -2.070815e-02 1 1  ON 3
 uu_4                -6.697956e-02 1 1  ON 4
 uu_5                -1.028857e-01 1 1  ON 5
 uu_6                -1.315767e-01 1 1  ON 6
 uu_7                -1.472812e-01 1 1  ON 7
 uu_8                -1.408411e-01 1 1  ON 8
 uu_9                -1.129797e-01 1 1  ON 9
 ud_0                 4.547265e-01 1 1  ON 10
 ud_1                 1.884781e-01 1 1  ON 11
 ud_2                 6.739981e-02 1 1  ON 12
 ud_3                -4.274960e-03 1 1  ON 13
 ud_4                -6.196262e-02 1 1  ON 14
 ud_5                -1.044803e-01 1 1  ON 15
 ud_6                -1.332902e-01 1 1  ON 16
 ud_7                -1.515705e-01 1 1  ON 17
 ud_8                -1.541750e-01 1 1  ON 18
 ud_9                -1.462423e-01 1 1  ON 19
 eO_0                -7.508274e-01 1 1  ON 20
 eO_1                -4.290354e-01 1 1  ON 21
 eO_2                -1.372696e-02 1 1  ON 22
 eO_3                 3.036050e-01 1 1  ON 23
 eO_4                 5.311886e-01 1 1  ON 24
 eO_5                 4.945444e-01 1 1  ON 25
 eO_6                 2.656228e-01 1 1  ON 26
 eO_7                -4.134853e-02 1 1  ON 27
 eO_8                -2.410234e-01 1 1  ON 28
 eO_9                -1.124507e-01 1 1  ON 29
eH1_0                -2.653965e-01 1 1  ON 30
eH1_1                -1.594788e-01 1 1  ON 31
eH1_2                -1.103989e-01 1 1  ON 32
eH1_3                -5.472930e-02 1 1  ON 33
eH1_4                -4.588708e-03 1 1  ON 34
eH1_5                 3.237491e-02 1 1  ON 35
eH1_6                 9.560520e-02 1 1  ON 36
eH1_7                 1.603817e-01 1 1  ON 37
eH1_8                 2.005311e-01 1 1  ON 38
eH1_9                 1.045930e-01 1 1  ON 39
eH2_0                -2.612056e-01 1 1  ON 40
eH2_1                -1.557389e-01 1 1  ON 41
eH2_2                -1.065583e-01 1 1  ON 42
eH2_3                -5.115068e-02 1 1  ON 43
eH2_4                -1.273891e-03 1 1  ON 44
eH2_5                 3.455957e-02 1 1  ON 45
eH2_6                 9.750374e-02 1 1  ON 46
eH2_7                 1.599990e-01 1 1  ON 47
eH2_8                 2.007612e-01 1 1  ON 48
eH2_9                 9.459459e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.9543
    reference variance = 0.289784
====================================================
  Execution time = 1.9970e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3720e-01
  Total weights = 2.0000e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336589570058
                                         uncertainty =       0.003318160889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336589570058
                                         uncertainty =       0.003318160889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410258999
  error estimate for blocks of size 2^( 2) =       0.000423431043
  error estimate for blocks of size 2^( 3) =       0.000436651525
  error estimate for blocks of size 2^( 4) =       0.000448660837
  error estimate for blocks of size 2^( 5) =       0.000457840787
  error estimate for blocks of size 2^( 6) =       0.000464622338
  error estimate for blocks of size 2^( 7) =       0.000469176822

      target function =                  N/A
              le_mean =     -16.906270973647
             les_mean =     286.158622958228
             stat err =       0.000460075196
             autocorr =       1.257596756560
              std dev =       0.580193840159
             le_variance =       0.336624892158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337457966664
                                         uncertainty =       0.003324220308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337457966664
                                         uncertainty =       0.003324220308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410787950
  error estimate for blocks of size 2^( 2) =       0.000423939389
  error estimate for blocks of size 2^( 3) =       0.000437138410
  error estimate for blocks of size 2^( 4) =       0.000449116676
  error estimate for blocks of size 2^( 5) =       0.000458278364
  error estimate for blocks of size 2^( 6) =       0.000465046059
  error estimate for blocks of size 2^( 7) =       0.000469581963

      target function =                  N/A
              le_mean =     -16.906264328964
             les_mean =     286.159266872478
             stat err =       0.000460505765
             autocorr =       1.256709075842
              std dev =       0.580941890749
             le_variance =       0.337493480427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337747483695
                                         uncertainty =       0.003326933882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337747483695
                                         uncertainty =       0.003326933882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410964117
  error estimate for blocks of size 2^( 2) =       0.000424105123
  error estimate for blocks of size 2^( 3) =       0.000437293999
  error estimate for blocks of size 2^( 4) =       0.000449262183
  error estimate for blocks of size 2^( 5) =       0.000458423821
  error estimate for blocks of size 2^( 6) =       0.000465194645
  error estimate for blocks of size 2^( 7) =       0.000469732043

      target function =                  N/A
              le_mean =     -16.906262733288
             les_mean =     286.159502448727
             stat err =       0.000460653173
             autocorr =       1.256435872367
              std dev =       0.581191027694
             le_variance =       0.337783010672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336857656968
                                         uncertainty =       0.003320241823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336857656968
                                         uncertainty =       0.003320241823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410422359
  error estimate for blocks of size 2^( 2) =       0.000423586462
  error estimate for blocks of size 2^( 3) =       0.000436799156
  error estimate for blocks of size 2^( 4) =       0.000448798887
  error estimate for blocks of size 2^( 5) =       0.000457974993
  error estimate for blocks of size 2^( 6) =       0.000464754594
  error estimate for blocks of size 2^( 7) =       0.000469305586

      target function =                  N/A
              le_mean =     -16.906268575022
             les_mean =     286.158809988593
             stat err =       0.000460208515
             autocorr =       1.257324198959
              std dev =       0.580424867034
             le_variance =       0.336893026271


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906270973647        initial  <--
     6.2500e-02     6.2500e-01             3.0454e-03       -16.906264328964
     2.5000e-01     2.5000e+00             7.5431e-04       -16.906262733288
     1.0000e+00     1.0000e+01             1.8981e-04       -16.906268575022

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5213
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.116269e-01 1 1  ON 0
 uu_1                 1.445023e-01 1 1  ON 1
 uu_2                 4.245195e-02 1 1  ON 2
 uu_3                -2.051247e-02 1 1  ON 3
 uu_4                -6.688946e-02 1 1  ON 4
 uu_5                -1.027702e-01 1 1  ON 5
 uu_6                -1.315948e-01 1 1  ON 6
 uu_7                -1.470818e-01 1 1  ON 7
 uu_8                -1.407796e-01 1 1  ON 8
 uu_9                -1.131467e-01 1 1  ON 9
 ud_0                 4.543664e-01 1 1  ON 10
 ud_1                 1.885526e-01 1 1  ON 11
 ud_2                 6.761703e-02 1 1  ON 12
 ud_3                -4.056944e-03 1 1  ON 13
 ud_4                -6.180645e-02 1 1  ON 14
 ud_5                -1.041607e-01 1 1  ON 15
 ud_6                -1.331629e-01 1 1  ON 16
 ud_7                -1.514330e-01 1 1  ON 17
 ud_8                -1.547855e-01 1 1  ON 18
 ud_9                -1.465907e-01 1 1  ON 19
 eO_0                -7.509990e-01 1 1  ON 20
 eO_1                -4.290301e-01 1 1  ON 21
 eO_2                -1.377151e-02 1 1  ON 22
 eO_3                 3.037425e-01 1 1  ON 23
 eO_4                 5.309206e-01 1 1  ON 24
 eO_5                 4.943491e-01 1 1  ON 25
 eO_6                 2.653063e-01 1 1  ON 26
 eO_7                -4.127307e-02 1 1  ON 27
 eO_8                -2.407383e-01 1 1  ON 28
 eO_9                -1.120369e-01 1 1  ON 29
eH1_0                -2.651389e-01 1 1  ON 30
eH1_1                -1.593315e-01 1 1  ON 31
eH1_2                -1.100686e-01 1 1  ON 32
eH1_3                -5.450928e-02 1 1  ON 33
eH1_4                -4.344959e-03 1 1  ON 34
eH1_5                 3.280905e-02 1 1  ON 35
eH1_6                 9.592042e-02 1 1  ON 36
eH1_7                 1.599529e-01 1 1  ON 37
eH1_8                 1.998009e-01 1 1  ON 38
eH1_9                 1.038387e-01 1 1  ON 39
eH2_0                -2.608915e-01 1 1  ON 40
eH2_1                -1.557408e-01 1 1  ON 41
eH2_2                -1.064852e-01 1 1  ON 42
eH2_3                -5.121128e-02 1 1  ON 43
eH2_4                -8.587070e-04 1 1  ON 44
eH2_5                 3.455846e-02 1 1  ON 45
eH2_6                 9.768035e-02 1 1  ON 46
eH2_7                 1.601045e-01 1 1  ON 47
eH2_8                 2.005645e-01 1 1  ON 48
eH2_9                 9.396781e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8331e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.8973
    reference variance = 0.259915
====================================================
  Execution time = 2.0487e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4538e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345457177201
                                         uncertainty =       0.004427249699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345457177201
                                         uncertainty =       0.004427249699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415557409
  error estimate for blocks of size 2^( 2) =       0.000428148897
  error estimate for blocks of size 2^( 3) =       0.000441365300
  error estimate for blocks of size 2^( 4) =       0.000452847373
  error estimate for blocks of size 2^( 5) =       0.000462613474
  error estimate for blocks of size 2^( 6) =       0.000472809900
  error estimate for blocks of size 2^( 7) =       0.000480351962

      target function =                  N/A
              le_mean =     -16.906972718496
             les_mean =     286.191102251666
             stat err =       0.000467155677
             autocorr =       1.263750097822
              std dev =       0.587686923797
             le_variance =       0.345375920401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690697271850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906972718496       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906973772515       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906973270917       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906972739040       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906972484089       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906972406328       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906972958861       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906972877255       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906972870960       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.618409e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906972718496       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906973032277       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906972874115       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906972717423       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906972585835       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906972557650       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906972710823       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 9.726711e-05

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906972718496       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906972800870       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906972758886       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906972717951       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906972677752       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906972669151       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906972707936       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 2.487211e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.311833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5959e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.117097e-01 1 1  ON 0
 uu_1                 1.444799e-01 1 1  ON 1
 uu_2                 4.243469e-02 1 1  ON 2
 uu_3                -2.053560e-02 1 1  ON 3
 uu_4                -6.692487e-02 1 1  ON 4
 uu_5                -1.027657e-01 1 1  ON 5
 uu_6                -1.315788e-01 1 1  ON 6
 uu_7                -1.470903e-01 1 1  ON 7
 uu_8                -1.407610e-01 1 1  ON 8
 uu_9                -1.131758e-01 1 1  ON 9
 ud_0                 4.544213e-01 1 1  ON 10
 ud_1                 1.885774e-01 1 1  ON 11
 ud_2                 6.763897e-02 1 1  ON 12
 ud_3                -4.038614e-03 1 1  ON 13
 ud_4                -6.176701e-02 1 1  ON 14
 ud_5                -1.041669e-01 1 1  ON 15
 ud_6                -1.331615e-01 1 1  ON 16
 ud_7                -1.514871e-01 1 1  ON 17
 ud_8                -1.548131e-01 1 1  ON 18
 ud_9                -1.466132e-01 1 1  ON 19
 eO_0                -7.509685e-01 1 1  ON 20
 eO_1                -4.290097e-01 1 1  ON 21
 eO_2                -1.373733e-02 1 1  ON 22
 eO_3                 3.037384e-01 1 1  ON 23
 eO_4                 5.309304e-01 1 1  ON 24
 eO_5                 4.943342e-01 1 1  ON 25
 eO_6                 2.653411e-01 1 1  ON 26
 eO_7                -4.127161e-02 1 1  ON 27
 eO_8                -2.407790e-01 1 1  ON 28
 eO_9                -1.120961e-01 1 1  ON 29
eH1_0                -2.651305e-01 1 1  ON 30
eH1_1                -1.593669e-01 1 1  ON 31
eH1_2                -1.100702e-01 1 1  ON 32
eH1_3                -5.453838e-02 1 1  ON 33
eH1_4                -4.348080e-03 1 1  ON 34
eH1_5                 3.277240e-02 1 1  ON 35
eH1_6                 9.587933e-02 1 1  ON 36
eH1_7                 1.599669e-01 1 1  ON 37
eH1_8                 1.998445e-01 1 1  ON 38
eH1_9                 1.039015e-01 1 1  ON 39
eH2_0                -2.609888e-01 1 1  ON 40
eH2_1                -1.557352e-01 1 1  ON 41
eH2_2                -1.064856e-01 1 1  ON 42
eH2_3                -5.116095e-02 1 1  ON 43
eH2_4                -8.821641e-04 1 1  ON 44
eH2_5                 3.460280e-02 1 1  ON 45
eH2_6                 9.765462e-02 1 1  ON 46
eH2_7                 1.600958e-01 1 1  ON 47
eH2_8                 2.005741e-01 1 1  ON 48
eH2_9                 9.401547e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9277
    reference variance = 0.30004
====================================================
  Execution time = 2.0341e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3182e-01
  Total weights = 2.0000e+06
  Execution time = 1.8957e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331778739843
                                         uncertainty =       0.002892363374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331778739843
                                         uncertainty =       0.002892363374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407293342
  error estimate for blocks of size 2^( 2) =       0.000419937455
  error estimate for blocks of size 2^( 3) =       0.000433058657
  error estimate for blocks of size 2^( 4) =       0.000445108333
  error estimate for blocks of size 2^( 5) =       0.000454476532
  error estimate for blocks of size 2^( 6) =       0.000461898027
  error estimate for blocks of size 2^( 7) =       0.000466496808

      target function =                  N/A
              le_mean =     -16.906252843024
             les_mean =     286.153160759289
             stat err =       0.000456994925
             autocorr =       1.258948987774
              std dev =       0.575999768162
             le_variance =       0.331775732923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331913369580
                                         uncertainty =       0.002895105457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331913369580
                                         uncertainty =       0.002895105457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407375962
  error estimate for blocks of size 2^( 2) =       0.000420014737
  error estimate for blocks of size 2^( 3) =       0.000433131455
  error estimate for blocks of size 2^( 4) =       0.000445178626
  error estimate for blocks of size 2^( 5) =       0.000454546249
  error estimate for blocks of size 2^( 6) =       0.000461967680
  error estimate for blocks of size 2^( 7) =       0.000466565215

      target function =                  N/A
              le_mean =     -16.906253138027
             les_mean =     286.153305350738
             stat err =       0.000457064442
             autocorr =       1.258821273942
              std dev =       0.576116611142
             le_variance =       0.331910349634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331872545970
                                         uncertainty =       0.002894289852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331872545970
                                         uncertainty =       0.002894289852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407350913
  error estimate for blocks of size 2^( 2) =       0.000419991446
  error estimate for blocks of size 2^( 3) =       0.000433109744
  error estimate for blocks of size 2^( 4) =       0.000445157733
  error estimate for blocks of size 2^( 5) =       0.000454525488
  error estimate for blocks of size 2^( 6) =       0.000461946708
  error estimate for blocks of size 2^( 7) =       0.000466544966

      target function =                  N/A
              le_mean =     -16.906252904207
             les_mean =     286.153256628437
             stat err =       0.000457043724
             autocorr =       1.258861959962
              std dev =       0.576081186438
             le_variance =       0.331869533367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331791436388
                                         uncertainty =       0.002892623047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331791436388
                                         uncertainty =       0.002892623047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407301135
  error estimate for blocks of size 2^( 2) =       0.000419944761
  error estimate for blocks of size 2^( 3) =       0.000433065575
  error estimate for blocks of size 2^( 4) =       0.000445115020
  error estimate for blocks of size 2^( 5) =       0.000454483151
  error estimate for blocks of size 2^( 6) =       0.000461904595
  error estimate for blocks of size 2^( 7) =       0.000466503291

      target function =                  N/A
              le_mean =     -16.906252841193
             les_mean =     286.153173393282
             stat err =       0.000457001515
             autocorr =       1.258937118554
              std dev =       0.576010788819
             le_variance =       0.331788428836


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906252843024        initial
     6.2500e-01     6.2500e+00             3.6184e-04       -16.906253138027  <--
     2.5000e+00     2.5000e+01             9.7267e-05       -16.906252904207
     1.0000e+01     1.0000e+02             2.4872e-05       -16.906252841193

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.9914e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.118738e-01 1 1  ON 0
 uu_1                 1.444423e-01 1 1  ON 1
 uu_2                 4.239780e-02 1 1  ON 2
 uu_3                -2.058311e-02 1 1  ON 3
 uu_4                -6.700045e-02 1 1  ON 4
 uu_5                -1.027738e-01 1 1  ON 5
 uu_6                -1.315453e-01 1 1  ON 6
 uu_7                -1.471108e-01 1 1  ON 7
 uu_8                -1.406932e-01 1 1  ON 8
 uu_9                -1.132643e-01 1 1  ON 9
 ud_0                 4.545421e-01 1 1  ON 10
 ud_1                 1.886504e-01 1 1  ON 11
 ud_2                 6.770212e-02 1 1  ON 12
 ud_3                -3.974573e-03 1 1  ON 13
 ud_4                -6.167600e-02 1 1  ON 14
 ud_5                -1.041449e-01 1 1  ON 15
 ud_6                -1.331582e-01 1 1  ON 16
 ud_7                -1.516196e-01 1 1  ON 17
 ud_8                -1.548828e-01 1 1  ON 18
 ud_9                -1.466826e-01 1 1  ON 19
 eO_0                -7.508950e-01 1 1  ON 20
 eO_1                -4.289295e-01 1 1  ON 21
 eO_2                -1.364944e-02 1 1  ON 22
 eO_3                 3.037456e-01 1 1  ON 23
 eO_4                 5.309658e-01 1 1  ON 24
 eO_5                 4.942972e-01 1 1  ON 25
 eO_6                 2.654499e-01 1 1  ON 26
 eO_7                -4.126141e-02 1 1  ON 27
 eO_8                -2.409090e-01 1 1  ON 28
 eO_9                -1.122917e-01 1 1  ON 29
eH1_0                -2.651336e-01 1 1  ON 30
eH1_1                -1.594593e-01 1 1  ON 31
eH1_2                -1.101082e-01 1 1  ON 32
eH1_3                -5.460846e-02 1 1  ON 33
eH1_4                -4.386393e-03 1 1  ON 34
eH1_5                 3.267909e-02 1 1  ON 35
eH1_6                 9.576388e-02 1 1  ON 36
eH1_7                 1.600081e-01 1 1  ON 37
eH1_8                 1.999846e-01 1 1  ON 38
eH1_9                 1.041109e-01 1 1  ON 39
eH2_0                -2.612534e-01 1 1  ON 40
eH2_1                -1.557277e-01 1 1  ON 41
eH2_2                -1.064876e-01 1 1  ON 42
eH2_3                -5.104925e-02 1 1  ON 43
eH2_4                -9.351257e-04 1 1  ON 44
eH2_5                 3.470962e-02 1 1  ON 45
eH2_6                 9.757580e-02 1 1  ON 46
eH2_7                 1.600776e-01 1 1  ON 47
eH2_8                 2.006106e-01 1 1  ON 48
eH2_9                 9.417565e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5879e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.919
    reference variance = 0.358509
====================================================
  Execution time = 2.0580e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3509e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5287e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335162739085
                                         uncertainty =       0.003588944091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335162739085
                                         uncertainty =       0.003588944091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409319866
  error estimate for blocks of size 2^( 2) =       0.000422341912
  error estimate for blocks of size 2^( 3) =       0.000435389134
  error estimate for blocks of size 2^( 4) =       0.000447298255
  error estimate for blocks of size 2^( 5) =       0.000457770606
  error estimate for blocks of size 2^( 6) =       0.000465451102
  error estimate for blocks of size 2^( 7) =       0.000468072703

      target function =                  N/A
              le_mean =     -16.905688399489
             les_mean =     286.137385598162
             stat err =       0.000459648167
             autocorr =       1.261029998741
              std dev =       0.578865705576
             le_variance =       0.335085505092


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690568839949e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905688399489       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905690551093       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905690533559       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905691903588       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905690932852       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905691433828       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905692570808       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905691497717       residual = 9.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905691917728       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905691942148       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905691935500       residual = 7.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.186664e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905688399489       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905689372055       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905689249325       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905689766978       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905689383089       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905689377817       residual = 9.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905689753255       residual = 4.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905689481173       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905689522941       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.996686e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905688399489       residual = 5.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905688704185       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905688661260       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905688808373       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905688689049       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905688654637       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905688754673       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905688697245       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 7.380259e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.315274 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6116e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.120194e-01 1 1  ON 0
 uu_1                 1.443406e-01 1 1  ON 1
 uu_2                 4.230020e-02 1 1  ON 2
 uu_3                -2.062177e-02 1 1  ON 3
 uu_4                -6.700970e-02 1 1  ON 4
 uu_5                -1.026078e-01 1 1  ON 5
 uu_6                -1.316773e-01 1 1  ON 6
 uu_7                -1.472029e-01 1 1  ON 7
 uu_8                -1.406981e-01 1 1  ON 8
 uu_9                -1.132771e-01 1 1  ON 9
 ud_0                 4.546754e-01 1 1  ON 10
 ud_1                 1.887362e-01 1 1  ON 11
 ud_2                 6.769710e-02 1 1  ON 12
 ud_3                -3.891456e-03 1 1  ON 13
 ud_4                -6.169862e-02 1 1  ON 14
 ud_5                -1.041313e-01 1 1  ON 15
 ud_6                -1.332768e-01 1 1  ON 16
 ud_7                -1.517406e-01 1 1  ON 17
 ud_8                -1.547873e-01 1 1  ON 18
 ud_9                -1.466741e-01 1 1  ON 19
 eO_0                -7.507595e-01 1 1  ON 20
 eO_1                -4.289456e-01 1 1  ON 21
 eO_2                -1.361236e-02 1 1  ON 22
 eO_3                 3.038583e-01 1 1  ON 23
 eO_4                 5.311103e-01 1 1  ON 24
 eO_5                 4.943452e-01 1 1  ON 25
 eO_6                 2.654389e-01 1 1  ON 26
 eO_7                -4.131819e-02 1 1  ON 27
 eO_8                -2.410565e-01 1 1  ON 28
 eO_9                -1.124931e-01 1 1  ON 29
eH1_0                -2.653534e-01 1 1  ON 30
eH1_1                -1.594867e-01 1 1  ON 31
eH1_2                -1.102187e-01 1 1  ON 32
eH1_3                -5.473883e-02 1 1  ON 33
eH1_4                -4.460174e-03 1 1  ON 34
eH1_5                 3.260448e-02 1 1  ON 35
eH1_6                 9.587047e-02 1 1  ON 36
eH1_7                 1.601174e-01 1 1  ON 37
eH1_8                 2.000810e-01 1 1  ON 38
eH1_9                 1.044106e-01 1 1  ON 39
eH2_0                -2.612763e-01 1 1  ON 40
eH2_1                -1.559036e-01 1 1  ON 41
eH2_2                -1.065265e-01 1 1  ON 42
eH2_3                -5.102436e-02 1 1  ON 43
eH2_4                -1.156314e-03 1 1  ON 44
eH2_5                 3.475071e-02 1 1  ON 45
eH2_6                 9.761654e-02 1 1  ON 46
eH2_7                 1.600064e-01 1 1  ON 47
eH2_8                 2.007122e-01 1 1  ON 48
eH2_9                 9.442887e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.982
    reference variance = 0.296625
====================================================
  Execution time = 2.0766e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3790e-01
  Total weights = 2.0000e+06
  Execution time = 1.8974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337831554464
                                         uncertainty =       0.003090981584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337831554464
                                         uncertainty =       0.003090981584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410949814
  error estimate for blocks of size 2^( 2) =       0.000423728604
  error estimate for blocks of size 2^( 3) =       0.000436800141
  error estimate for blocks of size 2^( 4) =       0.000449676334
  error estimate for blocks of size 2^( 5) =       0.000460345321
  error estimate for blocks of size 2^( 6) =       0.000470175141
  error estimate for blocks of size 2^( 7) =       0.000475262199

      target function =                  N/A
              le_mean =     -16.906550348959
             les_mean =     286.169204031821
             stat err =       0.000463864749
             autocorr =       1.274104834886
              std dev =       0.581170800029
             le_variance =       0.337759498806

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338075754408
                                         uncertainty =       0.003092425219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338075754408
                                         uncertainty =       0.003092425219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411098380
  error estimate for blocks of size 2^( 2) =       0.000423875238
  error estimate for blocks of size 2^( 3) =       0.000436944445
  error estimate for blocks of size 2^( 4) =       0.000449811618
  error estimate for blocks of size 2^( 5) =       0.000460475588
  error estimate for blocks of size 2^( 6) =       0.000470295917
  error estimate for blocks of size 2^( 7) =       0.000475373338

      target function =                  N/A
              le_mean =     -16.906550791430
             les_mean =     286.169463250861
             stat err =       0.000463989115
             autocorr =       1.273866901986
              std dev =       0.581380904960
             le_variance =       0.338003756652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338111086033
                                         uncertainty =       0.003093148688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338111086033
                                         uncertainty =       0.003093148688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411119874
  error estimate for blocks of size 2^( 2) =       0.000423894401
  error estimate for blocks of size 2^( 3) =       0.000436962113
  error estimate for blocks of size 2^( 4) =       0.000449830054
  error estimate for blocks of size 2^( 5) =       0.000460497003
  error estimate for blocks of size 2^( 6) =       0.000470316872
  error estimate for blocks of size 2^( 7) =       0.000475397402

      target function =                  N/A
              le_mean =     -16.906550003533
             les_mean =     286.169471954454
             stat err =       0.000464010333
             autocorr =       1.273850201158
              std dev =       0.581411301503
             le_variance =       0.338039101516

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337881259054
                                         uncertainty =       0.003091399373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337881259054
                                         uncertainty =       0.003091399373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410980059
  error estimate for blocks of size 2^( 2) =       0.000423757892
  error estimate for blocks of size 2^( 3) =       0.000436828563
  error estimate for blocks of size 2^( 4) =       0.000449703306
  error estimate for blocks of size 2^( 5) =       0.000460372117
  error estimate for blocks of size 2^( 6) =       0.000470200142
  error estimate for blocks of size 2^( 7) =       0.000475286254

      target function =                  N/A
              le_mean =     -16.906550083959
             les_mean =     286.169244789741
             stat err =       0.000463890455
             autocorr =       1.274058510452
              std dev =       0.581213572812
             le_variance =       0.337809217221


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906550348959        initial
     1.5625e-01     1.5625e+00             1.1867e-03       -16.906550791430  <--
     6.2500e-01     6.2500e+00             2.9967e-04       -16.906550003533
     2.5000e+00     2.5000e+01             7.3803e-05       -16.906550083959

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 3.0354e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.120860e-01 1 1  ON 0
 uu_1                 1.442170e-01 1 1  ON 1
 uu_2                 4.220430e-02 1 1  ON 2
 uu_3                -2.069144e-02 1 1  ON 3
 uu_4                -6.700453e-02 1 1  ON 4
 uu_5                -1.024181e-01 1 1  ON 5
 uu_6                -1.318183e-01 1 1  ON 6
 uu_7                -1.474200e-01 1 1  ON 7
 uu_8                -1.407800e-01 1 1  ON 8
 uu_9                -1.133362e-01 1 1  ON 9
 ud_0                 4.548936e-01 1 1  ON 10
 ud_1                 1.889056e-01 1 1  ON 11
 ud_2                 6.781667e-02 1 1  ON 12
 ud_3                -3.752829e-03 1 1  ON 13
 ud_4                -6.165294e-02 1 1  ON 14
 ud_5                -1.041240e-01 1 1  ON 15
 ud_6                -1.334217e-01 1 1  ON 16
 ud_7                -1.520127e-01 1 1  ON 17
 ud_8                -1.546256e-01 1 1  ON 18
 ud_9                -1.466694e-01 1 1  ON 19
 eO_0                -7.505552e-01 1 1  ON 20
 eO_1                -4.288563e-01 1 1  ON 21
 eO_2                -1.347226e-02 1 1  ON 22
 eO_3                 3.041855e-01 1 1  ON 23
 eO_4                 5.315536e-01 1 1  ON 24
 eO_5                 4.945408e-01 1 1  ON 25
 eO_6                 2.654302e-01 1 1  ON 26
 eO_7                -4.152198e-02 1 1  ON 27
 eO_8                -2.415119e-01 1 1  ON 28
 eO_9                -1.130920e-01 1 1  ON 29
eH1_0                -2.658995e-01 1 1  ON 30
eH1_1                -1.597456e-01 1 1  ON 31
eH1_2                -1.105412e-01 1 1  ON 32
eH1_3                -5.506455e-02 1 1  ON 33
eH1_4                -4.716580e-03 1 1  ON 34
eH1_5                 3.243861e-02 1 1  ON 35
eH1_6                 9.617015e-02 1 1  ON 36
eH1_7                 1.604501e-01 1 1  ON 37
eH1_8                 2.003633e-01 1 1  ON 38
eH1_9                 1.052976e-01 1 1  ON 39
eH2_0                -2.614507e-01 1 1  ON 40
eH2_1                -1.562334e-01 1 1  ON 41
eH2_2                -1.067164e-01 1 1  ON 42
eH2_3                -5.112245e-02 1 1  ON 43
eH2_4                -1.544153e-03 1 1  ON 44
eH2_5                 3.476017e-02 1 1  ON 45
eH2_6                 9.772652e-02 1 1  ON 46
eH2_7                 1.598284e-01 1 1  ON 47
eH2_8                 2.010028e-01 1 1  ON 48
eH2_9                 9.517270e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6477e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6923e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9291
    reference variance = 0.248093
====================================================
  Execution time = 2.0643e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3561e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5514e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335559545699
                                         uncertainty =       0.003203063800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335559545699
                                         uncertainty =       0.003203063800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409638035
  error estimate for blocks of size 2^( 2) =       0.000422914078
  error estimate for blocks of size 2^( 3) =       0.000436511273
  error estimate for blocks of size 2^( 4) =       0.000449013413
  error estimate for blocks of size 2^( 5) =       0.000459932859
  error estimate for blocks of size 2^( 6) =       0.000469297639
  error estimate for blocks of size 2^( 7) =       0.000475246575

      target function =                  N/A
              le_mean =     -16.906589981893
             les_mean =     286.168391288062
             stat err =       0.000463372622
             autocorr =       1.279558632995
              std dev =       0.579315665251
             le_variance =       0.335606640005


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690658998189e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906589981893       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906595462627       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906596639932       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906595372983       residual = 1.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906593884180       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906593345739       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906593158321       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906595451966       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906595453661       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906596820882       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906596595468       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906598119465       residual = 7.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906599822422       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906599576590       residual = 7.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.968049e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906589981893       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906592986419       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906593559693       residual = 9.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906592569201       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906592416939       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906591364528       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906590890370       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906592083843       residual = 9.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906592128055       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906592402275       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906592433007       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.266488e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906589981893       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906591052182       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906591321211       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906591107253       residual = 7.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906591000874       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906590667928       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906590350351       residual = 4.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906590657359       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906590711311       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.141777e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320158 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6203e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.118742e-01 1 1  ON 0
 uu_1                 1.441366e-01 1 1  ON 1
 uu_2                 4.206500e-02 1 1  ON 2
 uu_3                -2.074883e-02 1 1  ON 3
 uu_4                -6.707912e-02 1 1  ON 4
 uu_5                -1.028882e-01 1 1  ON 5
 uu_6                -1.318439e-01 1 1  ON 6
 uu_7                -1.471275e-01 1 1  ON 7
 uu_8                -1.404071e-01 1 1  ON 8
 uu_9                -1.135372e-01 1 1  ON 9
 ud_0                 4.548596e-01 1 1  ON 10
 ud_1                 1.886397e-01 1 1  ON 11
 ud_2                 6.764076e-02 1 1  ON 12
 ud_3                -3.984901e-03 1 1  ON 13
 ud_4                -6.162607e-02 1 1  ON 14
 ud_5                -1.043808e-01 1 1  ON 15
 ud_6                -1.335740e-01 1 1  ON 16
 ud_7                -1.522334e-01 1 1  ON 17
 ud_8                -1.540998e-01 1 1  ON 18
 ud_9                -1.456137e-01 1 1  ON 19
 eO_0                -7.505266e-01 1 1  ON 20
 eO_1                -4.285043e-01 1 1  ON 21
 eO_2                -1.344257e-02 1 1  ON 22
 eO_3                 3.041245e-01 1 1  ON 23
 eO_4                 5.318738e-01 1 1  ON 24
 eO_5                 4.949806e-01 1 1  ON 25
 eO_6                 2.658139e-01 1 1  ON 26
 eO_7                -4.183677e-02 1 1  ON 27
 eO_8                -2.418128e-01 1 1  ON 28
 eO_9                -1.137877e-01 1 1  ON 29
eH1_0                -2.661145e-01 1 1  ON 30
eH1_1                -1.602353e-01 1 1  ON 31
eH1_2                -1.109001e-01 1 1  ON 32
eH1_3                -5.536455e-02 1 1  ON 33
eH1_4                -4.911804e-03 1 1  ON 34
eH1_5                 3.195155e-02 1 1  ON 35
eH1_6                 9.593747e-02 1 1  ON 36
eH1_7                 1.608403e-01 1 1  ON 37
eH1_8                 2.007288e-01 1 1  ON 38
eH1_9                 1.064434e-01 1 1  ON 39
eH2_0                -2.615537e-01 1 1  ON 40
eH2_1                -1.565107e-01 1 1  ON 41
eH2_2                -1.073104e-01 1 1  ON 42
eH2_3                -5.194588e-02 1 1  ON 43
eH2_4                -2.023299e-03 1 1  ON 44
eH2_5                 3.456287e-02 1 1  ON 45
eH2_6                 9.741554e-02 1 1  ON 46
eH2_7                 1.603405e-01 1 1  ON 47
eH2_8                 2.019725e-01 1 1  ON 48
eH2_9                 9.643919e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9116
    reference variance = 0.245483
====================================================
  Execution time = 1.9931e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5907e-01
  Total weights = 2.0000e+06
  Execution time = 1.8598e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358924226708
                                         uncertainty =       0.018391608697

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.358924226708
                                         uncertainty =       0.018391608697

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423565498
  error estimate for blocks of size 2^( 2) =       0.000436064839
  error estimate for blocks of size 2^( 3) =       0.000448712217
  error estimate for blocks of size 2^( 4) =       0.000461230061
  error estimate for blocks of size 2^( 5) =       0.000471706205
  error estimate for blocks of size 2^( 6) =       0.000479151661
  error estimate for blocks of size 2^( 7) =       0.000485245203

      target function =                  N/A
              le_mean =     -16.906396848786
             les_mean =     286.185069690925
             stat err =       0.000474333282
             autocorr =       1.254082316635
              std dev =       0.599012071407
             le_variance =       0.358815461691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359276883053
                                         uncertainty =       0.018478808064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359276883053
                                         uncertainty =       0.018478808064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423773556
  error estimate for blocks of size 2^( 2) =       0.000436276708
  error estimate for blocks of size 2^( 3) =       0.000448924822
  error estimate for blocks of size 2^( 4) =       0.000461441397
  error estimate for blocks of size 2^( 5) =       0.000471906457
  error estimate for blocks of size 2^( 6) =       0.000479339197
  error estimate for blocks of size 2^( 7) =       0.000485427751

      target function =                  N/A
              le_mean =     -16.906399139819
             les_mean =     286.185499748871
             stat err =       0.000474528701
             autocorr =       1.253883721384
              std dev =       0.599306310313
             le_variance =       0.359168053582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359437368160
                                         uncertainty =       0.018506014509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359437368160
                                         uncertainty =       0.018506014509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423868139
  error estimate for blocks of size 2^( 2) =       0.000436364121
  error estimate for blocks of size 2^( 3) =       0.000449006357
  error estimate for blocks of size 2^( 4) =       0.000461520773
  error estimate for blocks of size 2^( 5) =       0.000471984018
  error estimate for blocks of size 2^( 6) =       0.000479422499
  error estimate for blocks of size 2^( 7) =       0.000485518038

      target function =                  N/A
              le_mean =     -16.906400552317
             les_mean =     286.185707854033
             stat err =       0.000474611332
             autocorr =       1.253760724190
              std dev =       0.599440070666
             le_variance =       0.359328398320

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359052167081
                                         uncertainty =       0.018420181682

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359052167081
                                         uncertainty =       0.018420181682

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000423640964
  error estimate for blocks of size 2^( 2) =       0.000436138361
  error estimate for blocks of size 2^( 3) =       0.000448783694
  error estimate for blocks of size 2^( 4) =       0.000461300541
  error estimate for blocks of size 2^( 5) =       0.000471773939
  error estimate for blocks of size 2^( 6) =       0.000479218261
  error estimate for blocks of size 2^( 7) =       0.000485312711

      target function =                  N/A
              le_mean =     -16.906397192770
             les_mean =     286.185209193172
             stat err =       0.000474401363
             autocorr =       1.253995450783
              std dev =       0.599118797023
             le_variance =       0.358943332946


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906396848786        initial
     3.9062e-02     3.9062e-01             4.9680e-03       -16.906399139819
     1.5625e-01     1.5625e+00             1.2665e-03       -16.906400552317  <--
     6.2500e-01     6.2500e+00             3.1418e-04       -16.906397192770

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9368e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.118742e-01 1 1  ON 0
 uu_1                 1.441366e-01 1 1  ON 1
 uu_2                 4.206500e-02 1 1  ON 2
 uu_3                -2.074883e-02 1 1  ON 3
 uu_4                -6.707912e-02 1 1  ON 4
 uu_5                -1.028882e-01 1 1  ON 5
 uu_6                -1.318439e-01 1 1  ON 6
 uu_7                -1.471275e-01 1 1  ON 7
 uu_8                -1.404071e-01 1 1  ON 8
 uu_9                -1.135372e-01 1 1  ON 9
 ud_0                 4.548596e-01 1 1  ON 10
 ud_1                 1.886397e-01 1 1  ON 11
 ud_2                 6.764076e-02 1 1  ON 12
 ud_3                -3.984901e-03 1 1  ON 13
 ud_4                -6.162607e-02 1 1  ON 14
 ud_5                -1.043808e-01 1 1  ON 15
 ud_6                -1.335740e-01 1 1  ON 16
 ud_7                -1.522334e-01 1 1  ON 17
 ud_8                -1.540998e-01 1 1  ON 18
 ud_9                -1.456137e-01 1 1  ON 19
 eO_0                -7.505266e-01 1 1  ON 20
 eO_1                -4.285043e-01 1 1  ON 21
 eO_2                -1.344257e-02 1 1  ON 22
 eO_3                 3.041245e-01 1 1  ON 23
 eO_4                 5.318738e-01 1 1  ON 24
 eO_5                 4.949806e-01 1 1  ON 25
 eO_6                 2.658139e-01 1 1  ON 26
 eO_7                -4.183677e-02 1 1  ON 27
 eO_8                -2.418128e-01 1 1  ON 28
 eO_9                -1.137877e-01 1 1  ON 29
eH1_0                -2.661145e-01 1 1  ON 30
eH1_1                -1.602353e-01 1 1  ON 31
eH1_2                -1.109001e-01 1 1  ON 32
eH1_3                -5.536455e-02 1 1  ON 33
eH1_4                -4.911804e-03 1 1  ON 34
eH1_5                 3.195155e-02 1 1  ON 35
eH1_6                 9.593747e-02 1 1  ON 36
eH1_7                 1.608403e-01 1 1  ON 37
eH1_8                 2.007288e-01 1 1  ON 38
eH1_9                 1.064434e-01 1 1  ON 39
eH2_0                -2.615537e-01 1 1  ON 40
eH2_1                -1.565107e-01 1 1  ON 41
eH2_2                -1.073104e-01 1 1  ON 42
eH2_3                -5.194588e-02 1 1  ON 43
eH2_4                -2.023299e-03 1 1  ON 44
eH2_5                 3.456287e-02 1 1  ON 45
eH2_6                 9.741554e-02 1 1  ON 46
eH2_7                 1.603405e-01 1 1  ON 47
eH2_8                 2.019725e-01 1 1  ON 48
eH2_9                 9.643919e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5577e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.9038
    reference variance = 0.419214
====================================================
  Execution time = 2.0416e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3884e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5841e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338770279654
                                         uncertainty =       0.004206164437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338770279654
                                         uncertainty =       0.004206164437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411604632
  error estimate for blocks of size 2^( 2) =       0.000424807515
  error estimate for blocks of size 2^( 3) =       0.000438065043
  error estimate for blocks of size 2^( 4) =       0.000449504992
  error estimate for blocks of size 2^( 5) =       0.000458973167
  error estimate for blocks of size 2^( 6) =       0.000466183758
  error estimate for blocks of size 2^( 7) =       0.000470605514

      target function =                  N/A
              le_mean =     -16.906739550915
             les_mean =     286.176678819624
             stat err =       0.000461316858
             autocorr =       1.256140283593
              std dev =       0.582096853251
             le_variance =       0.338836746565


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690673955092e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906739550915       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906741188114       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906740186826       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906740107063       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906742846744       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906743703593       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906741825525       residual = 5.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906741713603       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906742572071       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906742530483       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906742353993       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906742683487       residual = 2.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906743240009       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906743020647       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 3.667310e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906739550915       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906740570095       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906740006756       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906740071694       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906742185711       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906741423407       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906741192300       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906741126066       residual = 3.45e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906741314526       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906741250913       residual = 6.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 8.957546e-04

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906739550915       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906739956972       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906739766597       residual = 9.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906739880999       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906740272942       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906740690254       residual = 7.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906740389006       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906740329111       residual = 8.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 2.168430e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324482 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6008e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.117839e-01 1 1  ON 0
 uu_1                 1.441659e-01 1 1  ON 1
 uu_2                 4.218909e-02 1 1  ON 2
 uu_3                -2.073769e-02 1 1  ON 3
 uu_4                -6.704782e-02 1 1  ON 4
 uu_5                -1.034100e-01 1 1  ON 5
 uu_6                -1.319941e-01 1 1  ON 6
 uu_7                -1.472613e-01 1 1  ON 7
 uu_8                -1.407393e-01 1 1  ON 8
 uu_9                -1.134320e-01 1 1  ON 9
 ud_0                 4.546575e-01 1 1  ON 10
 ud_1                 1.885851e-01 1 1  ON 11
 ud_2                 6.761243e-02 1 1  ON 12
 ud_3                -3.997684e-03 1 1  ON 13
 ud_4                -6.184636e-02 1 1  ON 14
 ud_5                -1.045223e-01 1 1  ON 15
 ud_6                -1.334836e-01 1 1  ON 16
 ud_7                -1.519494e-01 1 1  ON 17
 ud_8                -1.536644e-01 1 1  ON 18
 ud_9                -1.454248e-01 1 1  ON 19
 eO_0                -7.500949e-01 1 1  ON 20
 eO_1                -4.285042e-01 1 1  ON 21
 eO_2                -1.341973e-02 1 1  ON 22
 eO_3                 3.042422e-01 1 1  ON 23
 eO_4                 5.319695e-01 1 1  ON 24
 eO_5                 4.957203e-01 1 1  ON 25
 eO_6                 2.661395e-01 1 1  ON 26
 eO_7                -4.196046e-02 1 1  ON 27
 eO_8                -2.423887e-01 1 1  ON 28
 eO_9                -1.146480e-01 1 1  ON 29
eH1_0                -2.664897e-01 1 1  ON 30
eH1_1                -1.604413e-01 1 1  ON 31
eH1_2                -1.111980e-01 1 1  ON 32
eH1_3                -5.548469e-02 1 1  ON 33
eH1_4                -5.294525e-03 1 1  ON 34
eH1_5                 3.216351e-02 1 1  ON 35
eH1_6                 9.554769e-02 1 1  ON 36
eH1_7                 1.608234e-01 1 1  ON 37
eH1_8                 2.012128e-01 1 1  ON 38
eH1_9                 1.073105e-01 1 1  ON 39
eH2_0                -2.618726e-01 1 1  ON 40
eH2_1                -1.565107e-01 1 1  ON 41
eH2_2                -1.076739e-01 1 1  ON 42
eH2_3                -5.198289e-02 1 1  ON 43
eH2_4                -2.448245e-03 1 1  ON 44
eH2_5                 3.435221e-02 1 1  ON 45
eH2_6                 9.738249e-02 1 1  ON 46
eH2_7                 1.604905e-01 1 1  ON 47
eH2_8                 2.022453e-01 1 1  ON 48
eH2_9                 9.733494e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.897
    reference variance = 0.284077
====================================================
  Execution time = 1.9844e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4389e-01
  Total weights = 2.0000e+06
  Execution time = 1.8745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344119716351
                                         uncertainty =       0.007096579561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344119716351
                                         uncertainty =       0.007096579561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414786965
  error estimate for blocks of size 2^( 2) =       0.000427310851
  error estimate for blocks of size 2^( 3) =       0.000440575994
  error estimate for blocks of size 2^( 4) =       0.000452014018
  error estimate for blocks of size 2^( 5) =       0.000461781638
  error estimate for blocks of size 2^( 6) =       0.000469416340
  error estimate for blocks of size 2^( 7) =       0.000472921529

      target function =                  N/A
              le_mean =     -16.905885336102
             les_mean =     286.153055278787
             stat err =       0.000464033381
             autocorr =       1.251550120523
              std dev =       0.586597352031
             le_variance =       0.344096453409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343905255910
                                         uncertainty =       0.007082909259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343905255910
                                         uncertainty =       0.007082909259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414657685
  error estimate for blocks of size 2^( 2) =       0.000427188973
  error estimate for blocks of size 2^( 3) =       0.000440457766
  error estimate for blocks of size 2^( 4) =       0.000451896978
  error estimate for blocks of size 2^( 5) =       0.000461667687
  error estimate for blocks of size 2^( 6) =       0.000469307522
  error estimate for blocks of size 2^( 7) =       0.000472792449

      target function =                  N/A
              le_mean =     -16.905888257862
             les_mean =     286.152939607095
             stat err =       0.000463916159
             autocorr =       1.251698010483
              std dev =       0.586414522105
             le_variance =       0.343881991736

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343720014347
                                         uncertainty =       0.007076299850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343720014347
                                         uncertainty =       0.007076299850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414546015
  error estimate for blocks of size 2^( 2) =       0.000427081827
  error estimate for blocks of size 2^( 3) =       0.000440354626
  error estimate for blocks of size 2^( 4) =       0.000451800274
  error estimate for blocks of size 2^( 5) =       0.000461576542
  error estimate for blocks of size 2^( 6) =       0.000469225388
  error estimate for blocks of size 2^( 7) =       0.000472707868

      target function =                  N/A
              le_mean =     -16.905889295837
             les_mean =     286.152789508150
             stat err =       0.000463827518
             autocorr =       1.251893927609
              std dev =       0.586256596466
             le_variance =       0.343696796900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343996278586
                                         uncertainty =       0.007090940598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.343996278586
                                         uncertainty =       0.007090940598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414712569
  error estimate for blocks of size 2^( 2) =       0.000427239611
  error estimate for blocks of size 2^( 3) =       0.000440506719
  error estimate for blocks of size 2^( 4) =       0.000451946855
  error estimate for blocks of size 2^( 5) =       0.000461716721
  error estimate for blocks of size 2^( 6) =       0.000469356220
  error estimate for blocks of size 2^( 7) =       0.000472856826

      target function =                  N/A
              le_mean =     -16.905886050472
             les_mean =     286.152956009100
             stat err =       0.000463969155
             autocorr =       1.251652650403
              std dev =       0.586492139361
             le_variance =       0.343973029532


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905885336102        initial
     3.9062e-02     3.9062e-01             3.6673e-03       -16.905888257862
     1.5625e-01     1.5625e+00             8.9575e-04       -16.905889295837  <--
     6.2500e-01     6.2500e+00             2.1684e-04       -16.905886050472

*****************************************************************************
Applying the update for shift_i =   1.5625e-01     and shift_s =   1.5625e+00
*****************************************************************************

  Execution time = 2.9270e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.117839e-01 1 1  ON 0
 uu_1                 1.441659e-01 1 1  ON 1
 uu_2                 4.218909e-02 1 1  ON 2
 uu_3                -2.073769e-02 1 1  ON 3
 uu_4                -6.704782e-02 1 1  ON 4
 uu_5                -1.034100e-01 1 1  ON 5
 uu_6                -1.319941e-01 1 1  ON 6
 uu_7                -1.472613e-01 1 1  ON 7
 uu_8                -1.407393e-01 1 1  ON 8
 uu_9                -1.134320e-01 1 1  ON 9
 ud_0                 4.546575e-01 1 1  ON 10
 ud_1                 1.885851e-01 1 1  ON 11
 ud_2                 6.761243e-02 1 1  ON 12
 ud_3                -3.997684e-03 1 1  ON 13
 ud_4                -6.184636e-02 1 1  ON 14
 ud_5                -1.045223e-01 1 1  ON 15
 ud_6                -1.334836e-01 1 1  ON 16
 ud_7                -1.519494e-01 1 1  ON 17
 ud_8                -1.536644e-01 1 1  ON 18
 ud_9                -1.454248e-01 1 1  ON 19
 eO_0                -7.500949e-01 1 1  ON 20
 eO_1                -4.285042e-01 1 1  ON 21
 eO_2                -1.341973e-02 1 1  ON 22
 eO_3                 3.042422e-01 1 1  ON 23
 eO_4                 5.319695e-01 1 1  ON 24
 eO_5                 4.957203e-01 1 1  ON 25
 eO_6                 2.661395e-01 1 1  ON 26
 eO_7                -4.196046e-02 1 1  ON 27
 eO_8                -2.423887e-01 1 1  ON 28
 eO_9                -1.146480e-01 1 1  ON 29
eH1_0                -2.664897e-01 1 1  ON 30
eH1_1                -1.604413e-01 1 1  ON 31
eH1_2                -1.111980e-01 1 1  ON 32
eH1_3                -5.548469e-02 1 1  ON 33
eH1_4                -5.294525e-03 1 1  ON 34
eH1_5                 3.216351e-02 1 1  ON 35
eH1_6                 9.554769e-02 1 1  ON 36
eH1_7                 1.608234e-01 1 1  ON 37
eH1_8                 2.012128e-01 1 1  ON 38
eH1_9                 1.073105e-01 1 1  ON 39
eH2_0                -2.618726e-01 1 1  ON 40
eH2_1                -1.565107e-01 1 1  ON 41
eH2_2                -1.076739e-01 1 1  ON 42
eH2_3                -5.198289e-02 1 1  ON 43
eH2_4                -2.448245e-03 1 1  ON 44
eH2_5                 3.435221e-02 1 1  ON 45
eH2_6                 9.738249e-02 1 1  ON 46
eH2_7                 1.604905e-01 1 1  ON 47
eH2_8                 2.022453e-01 1 1  ON 48
eH2_9                 9.733494e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5284e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9168
    reference variance = 0.881641
====================================================
  Execution time = 2.0251e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3871e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5892e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338696462369
                                         uncertainty =       0.003588666842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338696462369
                                         uncertainty =       0.003588666842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411529477
  error estimate for blocks of size 2^( 2) =       0.000424431878
  error estimate for blocks of size 2^( 3) =       0.000437561973
  error estimate for blocks of size 2^( 4) =       0.000451078491
  error estimate for blocks of size 2^( 5) =       0.000462677861
  error estimate for blocks of size 2^( 6) =       0.000472238809
  error estimate for blocks of size 2^( 7) =       0.000476177113

      target function =                  N/A
              le_mean =     -16.905717656618
             les_mean =     286.142002336822
             stat err =       0.000465543069
             autocorr =       1.279728474405
              std dev =       0.581990567695
             le_variance =       0.338713020886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690571765662e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905717656618       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905718197815       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905721475313       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905717508684       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905714697264       residual = 9.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905717701200       residual = 6.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905719150647       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905719689472       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905718415685       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905719124804       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905720227822       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905720825511       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.905721105654       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.905721331934       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 4.865397e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905717656618       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905718004148       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905719772728       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905716917426       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905716311411       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905716722798       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905718160949       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905717709673       residual = 6.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905717748380       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905717621240       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905717807053       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.243509e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905717656618       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905717799553       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905718353386       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905717431727       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905716960849       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905717237140       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905717497311       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905717489760       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905717481449       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.565454e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.329220 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9140e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.121263e-01 1 1  ON 0
 uu_1                 1.444564e-01 1 1  ON 1
 uu_2                 4.240277e-02 1 1  ON 2
 uu_3                -2.060673e-02 1 1  ON 3
 uu_4                -6.722872e-02 1 1  ON 4
 uu_5                -1.036559e-01 1 1  ON 5
 uu_6                -1.326227e-01 1 1  ON 6
 uu_7                -1.484027e-01 1 1  ON 7
 uu_8                -1.410795e-01 1 1  ON 8
 uu_9                -1.128765e-01 1 1  ON 9
 ud_0                 4.544066e-01 1 1  ON 10
 ud_1                 1.882067e-01 1 1  ON 11
 ud_2                 6.732070e-02 1 1  ON 12
 ud_3                -4.231487e-03 1 1  ON 13
 ud_4                -6.205151e-02 1 1  ON 14
 ud_5                -1.046383e-01 1 1  ON 15
 ud_6                -1.332759e-01 1 1  ON 16
 ud_7                -1.514557e-01 1 1  ON 17
 ud_8                -1.529840e-01 1 1  ON 18
 ud_9                -1.447870e-01 1 1  ON 19
 eO_0                -7.500823e-01 1 1  ON 20
 eO_1                -4.282810e-01 1 1  ON 21
 eO_2                -1.326012e-02 1 1  ON 22
 eO_3                 3.040827e-01 1 1  ON 23
 eO_4                 5.321426e-01 1 1  ON 24
 eO_5                 4.963351e-01 1 1  ON 25
 eO_6                 2.663054e-01 1 1  ON 26
 eO_7                -4.230005e-02 1 1  ON 27
 eO_8                -2.424705e-01 1 1  ON 28
 eO_9                -1.152247e-01 1 1  ON 29
eH1_0                -2.666868e-01 1 1  ON 30
eH1_1                -1.604804e-01 1 1  ON 31
eH1_2                -1.112820e-01 1 1  ON 32
eH1_3                -5.556838e-02 1 1  ON 33
eH1_4                -5.477532e-03 1 1  ON 34
eH1_5                 3.133948e-02 1 1  ON 35
eH1_6                 9.520267e-02 1 1  ON 36
eH1_7                 1.611163e-01 1 1  ON 37
eH1_8                 2.016819e-01 1 1  ON 38
eH1_9                 1.082675e-01 1 1  ON 39
eH2_0                -2.626205e-01 1 1  ON 40
eH2_1                -1.573256e-01 1 1  ON 41
eH2_2                -1.080032e-01 1 1  ON 42
eH2_3                -5.270139e-02 1 1  ON 43
eH2_4                -2.532744e-03 1 1  ON 44
eH2_5                 3.475598e-02 1 1  ON 45
eH2_6                 9.750905e-02 1 1  ON 46
eH2_7                 1.606685e-01 1 1  ON 47
eH2_8                 2.026968e-01 1 1  ON 48
eH2_9                 9.857845e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9171
    reference variance = 0.316857
====================================================
  Execution time = 2.0601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3686e-01
  Total weights = 2.0000e+06
  Execution time = 1.8632e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336804414274
                                         uncertainty =       0.003597225954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336804414274
                                         uncertainty =       0.003597225954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410340342
  error estimate for blocks of size 2^( 2) =       0.000422831160
  error estimate for blocks of size 2^( 3) =       0.000435580122
  error estimate for blocks of size 2^( 4) =       0.000448329885
  error estimate for blocks of size 2^( 5) =       0.000458803761
  error estimate for blocks of size 2^( 6) =       0.000466597199
  error estimate for blocks of size 2^( 7) =       0.000470103435

      target function =                  N/A
              le_mean =     -16.906905604852
             les_mean =     286.180215355926
             stat err =       0.000460958570
             autocorr =       1.261930259749
              std dev =       0.580308877175
             le_variance =       0.336758392928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337000826205
                                         uncertainty =       0.003598751917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337000826205
                                         uncertainty =       0.003598751917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410459968
  error estimate for blocks of size 2^( 2) =       0.000422952389
  error estimate for blocks of size 2^( 3) =       0.000435700644
  error estimate for blocks of size 2^( 4) =       0.000448442057
  error estimate for blocks of size 2^( 5) =       0.000458917966
  error estimate for blocks of size 2^( 6) =       0.000466713017
  error estimate for blocks of size 2^( 7) =       0.000470204901

      target function =                  N/A
              le_mean =     -16.906910299883
             les_mean =     286.180570489876
             stat err =       0.000461069485
             autocorr =       1.261801816259
              std dev =       0.580478053054
             le_variance =       0.336954770078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337019402993
                                         uncertainty =       0.003599341479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337019402993
                                         uncertainty =       0.003599341479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410471265
  error estimate for blocks of size 2^( 2) =       0.000422959181
  error estimate for blocks of size 2^( 3) =       0.000435706481
  error estimate for blocks of size 2^( 4) =       0.000448446194
  error estimate for blocks of size 2^( 5) =       0.000458925222
  error estimate for blocks of size 2^( 6) =       0.000466721059
  error estimate for blocks of size 2^( 7) =       0.000470220490

      target function =                  N/A
              le_mean =     -16.906908757734
             les_mean =     286.180536892650
             stat err =       0.000461078241
             autocorr =       1.261780280651
              std dev =       0.580494029939
             le_variance =       0.336973318795

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843792406
                                         uncertainty =       0.003597849148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336843792406
                                         uncertainty =       0.003597849148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410364319
  error estimate for blocks of size 2^( 2) =       0.000422854252
  error estimate for blocks of size 2^( 3) =       0.000435602996
  error estimate for blocks of size 2^( 4) =       0.000448350956
  error estimate for blocks of size 2^( 5) =       0.000458826035
  error estimate for blocks of size 2^( 6) =       0.000466620499
  error estimate for blocks of size 2^( 7) =       0.000470126510

      target function =                  N/A
              le_mean =     -16.906905382033
             les_mean =     286.180247177368
             stat err =       0.000460981000
             autocorr =       1.261905597834
              std dev =       0.580342785545
             le_variance =       0.336797748734


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906905604852        initial
     3.9062e-02     3.9062e-01             4.8654e-03       -16.906910299883  <--
     1.5625e-01     1.5625e+00             1.2435e-03       -16.906908757734
     6.2500e-01     6.2500e+00             3.5655e-04       -16.906905382033

*****************************************************************************
Applying the update for shift_i =   3.9062e-02     and shift_s =   3.9062e-01
*****************************************************************************

  Execution time = 2.9970e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.124800e-01 1 1  ON 0
 uu_1                 1.447286e-01 1 1  ON 1
 uu_2                 4.256209e-02 1 1  ON 2
 uu_3                -2.058225e-02 1 1  ON 3
 uu_4                -6.745628e-02 1 1  ON 4
 uu_5                -1.041554e-01 1 1  ON 5
 uu_6                -1.337256e-01 1 1  ON 6
 uu_7                -1.497077e-01 1 1  ON 7
 uu_8                -1.425654e-01 1 1  ON 8
 uu_9                -1.119950e-01 1 1  ON 9
 ud_0                 4.540353e-01 1 1  ON 10
 ud_1                 1.878498e-01 1 1  ON 11
 ud_2                 6.697968e-02 1 1  ON 12
 ud_3                -4.525794e-03 1 1  ON 13
 ud_4                -6.230683e-02 1 1  ON 14
 ud_5                -1.047758e-01 1 1  ON 15
 ud_6                -1.331585e-01 1 1  ON 16
 ud_7                -1.508181e-01 1 1  ON 17
 ud_8                -1.519532e-01 1 1  ON 18
 ud_9                -1.432307e-01 1 1  ON 19
 eO_0                -7.498924e-01 1 1  ON 20
 eO_1                -4.279193e-01 1 1  ON 21
 eO_2                -1.282978e-02 1 1  ON 22
 eO_3                 3.043056e-01 1 1  ON 23
 eO_4                 5.326766e-01 1 1  ON 24
 eO_5                 4.975252e-01 1 1  ON 25
 eO_6                 2.670805e-01 1 1  ON 26
 eO_7                -4.319269e-02 1 1  ON 27
 eO_8                -2.429539e-01 1 1  ON 28
 eO_9                -1.169849e-01 1 1  ON 29
eH1_0                -2.672621e-01 1 1  ON 30
eH1_1                -1.609347e-01 1 1  ON 31
eH1_2                -1.117313e-01 1 1  ON 32
eH1_3                -5.603334e-02 1 1  ON 33
eH1_4                -5.974460e-03 1 1  ON 34
eH1_5                 3.020139e-02 1 1  ON 35
eH1_6                 9.412041e-02 1 1  ON 36
eH1_7                 1.615931e-01 1 1  ON 37
eH1_8                 2.029630e-01 1 1  ON 38
eH1_9                 1.110627e-01 1 1  ON 39
eH2_0                -2.642861e-01 1 1  ON 40
eH2_1                -1.588862e-01 1 1  ON 41
eH2_2                -1.093514e-01 1 1  ON 42
eH2_3                -5.410599e-02 1 1  ON 43
eH2_4                -3.390845e-03 1 1  ON 44
eH2_5                 3.477495e-02 1 1  ON 45
eH2_6                 9.769990e-02 1 1  ON 46
eH2_7                 1.614086e-01 1 1  ON 47
eH2_8                 2.041091e-01 1 1  ON 48
eH2_9                 1.022003e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.9116e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.0002
    reference variance = 0.454965
====================================================
  Execution time = 2.0310e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.9186e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391821990586
                                         uncertainty =       0.050741558188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.391821990586
                                         uncertainty =       0.050741558188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000442637172
  error estimate for blocks of size 2^( 2) =       0.000453812583
  error estimate for blocks of size 2^( 3) =       0.000465911443
  error estimate for blocks of size 2^( 4) =       0.000477815068
  error estimate for blocks of size 2^( 5) =       0.000488011822
  error estimate for blocks of size 2^( 6) =       0.000494631200
  error estimate for blocks of size 2^( 7) =       0.000497900098

      target function =                  N/A
              le_mean =     -16.906653557238
             les_mean =     286.226789640162
             stat err =       0.000489589547
             autocorr =       1.223400092695
              std dev =       0.625983491504
             le_variance =       0.391855331635


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690665355724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-03, overlap shift 9.7656e-02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906653557238       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906651997275       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906651590087       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906650743271       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906653233681       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906655245656       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906656994741       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906658053858       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906657581691       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906656557444       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906663514578       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906664986501       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906664741565       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.906663311609       residual = 6.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.906663246826       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.906664139902       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.906664989110       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.906664459796       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.906664666608       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.906664650466       residual = 6.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-03 is 2.221529e-02

solving harmonic davidson linear method for identity shift 3.9062e-02, overlap shift 3.9062e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906653557238       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652183517       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906651777634       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906650982498       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652797781       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906653660749       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906654750033       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906655291557       residual = 5.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906654455887       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906653863200       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906655485290       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906655951102       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.906655643612       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-02 is 5.666714e-03

solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906653557238       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906652627511       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906652233486       residual = 7.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906651601035       residual = 6.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906652274695       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906652268022       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906652797561       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906653205371       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906652775124       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906652841691       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906652900745       residual = 3.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.433493e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337874 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5897e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.116754e-01 1 1  ON 0
 uu_1                 1.439604e-01 1 1  ON 1
 uu_2                 4.184667e-02 1 1  ON 2
 uu_3                -2.116197e-02 1 1  ON 3
 uu_4                -6.766748e-02 1 1  ON 4
 uu_5                -1.044625e-01 1 1  ON 5
 uu_6                -1.343861e-01 1 1  ON 6
 uu_7                -1.499030e-01 1 1  ON 7
 uu_8                -1.430966e-01 1 1  ON 8
 uu_9                -1.115423e-01 1 1  ON 9
 ud_0                 4.545307e-01 1 1  ON 10
 ud_1                 1.887622e-01 1 1  ON 11
 ud_2                 6.770689e-02 1 1  ON 12
 ud_3                -4.127496e-03 1 1  ON 13
 ud_4                -6.202869e-02 1 1  ON 14
 ud_5                -1.047025e-01 1 1  ON 15
 ud_6                -1.334530e-01 1 1  ON 16
 ud_7                -1.511622e-01 1 1  ON 17
 ud_8                -1.519223e-01 1 1  ON 18
 ud_9                -1.438141e-01 1 1  ON 19
 eO_0                -7.488972e-01 1 1  ON 20
 eO_1                -4.270840e-01 1 1  ON 21
 eO_2                -1.199298e-02 1 1  ON 22
 eO_3                 3.050658e-01 1 1  ON 23
 eO_4                 5.340186e-01 1 1  ON 24
 eO_5                 4.977676e-01 1 1  ON 25
 eO_6                 2.674645e-01 1 1  ON 26
 eO_7                -4.356726e-02 1 1  ON 27
 eO_8                -2.443710e-01 1 1  ON 28
 eO_9                -1.198672e-01 1 1  ON 29
eH1_0                -2.681525e-01 1 1  ON 30
eH1_1                -1.619882e-01 1 1  ON 31
eH1_2                -1.127525e-01 1 1  ON 32
eH1_3                -5.696520e-02 1 1  ON 33
eH1_4                -6.857132e-03 1 1  ON 34
eH1_5                 2.954787e-02 1 1  ON 35
eH1_6                 9.427527e-02 1 1  ON 36
eH1_7                 1.620190e-01 1 1  ON 37
eH1_8                 2.040948e-01 1 1  ON 38
eH1_9                 1.145565e-01 1 1  ON 39
eH2_0                -2.662576e-01 1 1  ON 40
eH2_1                -1.603361e-01 1 1  ON 41
eH2_2                -1.114416e-01 1 1  ON 42
eH2_3                -5.549438e-02 1 1  ON 43
eH2_4                -5.213859e-03 1 1  ON 44
eH2_5                 3.272814e-02 1 1  ON 45
eH2_6                 9.743119e-02 1 1  ON 46
eH2_7                 1.629036e-01 1 1  ON 47
eH2_8                 2.066864e-01 1 1  ON 48
eH2_9                 1.078671e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9391
    reference variance = 0.297237
====================================================
  Execution time = 2.0175e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3109e-01
  Total weights = 2.0000e+06
  Execution time = 1.8791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331217983633
                                         uncertainty =       0.003417845248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331217983633
                                         uncertainty =       0.003417845248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406973700
  error estimate for blocks of size 2^( 2) =       0.000419716771
  error estimate for blocks of size 2^( 3) =       0.000432704422
  error estimate for blocks of size 2^( 4) =       0.000444549155
  error estimate for blocks of size 2^( 5) =       0.000453920839
  error estimate for blocks of size 2^( 6) =       0.000460743913
  error estimate for blocks of size 2^( 7) =       0.000466289660

      target function =                  N/A
              le_mean =     -16.906096480682
             les_mean =     286.147353233486
             stat err =       0.000456375892
             autocorr =       1.257513626357
              std dev =       0.575547726075
             le_variance =       0.331255184990

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331091862419
                                         uncertainty =       0.003419015092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331091862419
                                         uncertainty =       0.003419015092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406895949
  error estimate for blocks of size 2^( 2) =       0.000419650675
  error estimate for blocks of size 2^( 3) =       0.000432635682
  error estimate for blocks of size 2^( 4) =       0.000444459821
  error estimate for blocks of size 2^( 5) =       0.000453818029
  error estimate for blocks of size 2^( 6) =       0.000460630455
  error estimate for blocks of size 2^( 7) =       0.000466160555

      target function =                  N/A
              le_mean =     -16.906092599606
             les_mean =     286.147095447555
             stat err =       0.000456267215
             autocorr =       1.257395191254
              std dev =       0.575437769586
             le_variance =       0.331128626666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330903525016
                                         uncertainty =       0.003416775604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330903525016
                                         uncertainty =       0.003416775604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406780123
  error estimate for blocks of size 2^( 2) =       0.000419545590
  error estimate for blocks of size 2^( 3) =       0.000432539765
  error estimate for blocks of size 2^( 4) =       0.000444369639
  error estimate for blocks of size 2^( 5) =       0.000453740259
  error estimate for blocks of size 2^( 6) =       0.000460555409
  error estimate for blocks of size 2^( 7) =       0.000466092164

      target function =                  N/A
              le_mean =     -16.906094572702
             les_mean =     286.146973672348
             stat err =       0.000456189368
             autocorr =       1.257682077364
              std dev =       0.575273966633
             le_variance =       0.330940136686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331010755029
                                         uncertainty =       0.003416382389

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331010755029
                                         uncertainty =       0.003416382389

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406846268
  error estimate for blocks of size 2^( 2) =       0.000419598460
  error estimate for blocks of size 2^( 3) =       0.000432590330
  error estimate for blocks of size 2^( 4) =       0.000444433436
  error estimate for blocks of size 2^( 5) =       0.000453808469
  error estimate for blocks of size 2^( 6) =       0.000460631359
  error estimate for blocks of size 2^( 7) =       0.000466177380

      target function =                  N/A
              le_mean =     -16.906094734394
             les_mean =     286.147086774504
             stat err =       0.000456262661
             autocorr =       1.257677190841
              std dev =       0.575367510152
             le_variance =       0.331047771739


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906096480682        initial  <--
     9.7656e-03     9.7656e-02             2.2215e-02       -16.906092599606
     3.9062e-02     3.9062e-01             5.6667e-03       -16.906094572702
     1.5625e-01     1.5625e+00             1.4335e-03       -16.906094734394

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5498
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.124800e-01 1 1  ON 0
 uu_1                 1.447286e-01 1 1  ON 1
 uu_2                 4.256209e-02 1 1  ON 2
 uu_3                -2.058225e-02 1 1  ON 3
 uu_4                -6.745628e-02 1 1  ON 4
 uu_5                -1.041554e-01 1 1  ON 5
 uu_6                -1.337256e-01 1 1  ON 6
 uu_7                -1.497077e-01 1 1  ON 7
 uu_8                -1.425654e-01 1 1  ON 8
 uu_9                -1.119950e-01 1 1  ON 9
 ud_0                 4.540353e-01 1 1  ON 10
 ud_1                 1.878498e-01 1 1  ON 11
 ud_2                 6.697968e-02 1 1  ON 12
 ud_3                -4.525794e-03 1 1  ON 13
 ud_4                -6.230683e-02 1 1  ON 14
 ud_5                -1.047758e-01 1 1  ON 15
 ud_6                -1.331585e-01 1 1  ON 16
 ud_7                -1.508181e-01 1 1  ON 17
 ud_8                -1.519532e-01 1 1  ON 18
 ud_9                -1.432307e-01 1 1  ON 19
 eO_0                -7.498924e-01 1 1  ON 20
 eO_1                -4.279193e-01 1 1  ON 21
 eO_2                -1.282978e-02 1 1  ON 22
 eO_3                 3.043056e-01 1 1  ON 23
 eO_4                 5.326766e-01 1 1  ON 24
 eO_5                 4.975252e-01 1 1  ON 25
 eO_6                 2.670805e-01 1 1  ON 26
 eO_7                -4.319269e-02 1 1  ON 27
 eO_8                -2.429539e-01 1 1  ON 28
 eO_9                -1.169849e-01 1 1  ON 29
eH1_0                -2.672621e-01 1 1  ON 30
eH1_1                -1.609347e-01 1 1  ON 31
eH1_2                -1.117313e-01 1 1  ON 32
eH1_3                -5.603334e-02 1 1  ON 33
eH1_4                -5.974460e-03 1 1  ON 34
eH1_5                 3.020139e-02 1 1  ON 35
eH1_6                 9.412041e-02 1 1  ON 36
eH1_7                 1.615931e-01 1 1  ON 37
eH1_8                 2.029630e-01 1 1  ON 38
eH1_9                 1.110627e-01 1 1  ON 39
eH2_0                -2.642861e-01 1 1  ON 40
eH2_1                -1.588862e-01 1 1  ON 41
eH2_2                -1.093514e-01 1 1  ON 42
eH2_3                -5.410599e-02 1 1  ON 43
eH2_4                -3.390845e-03 1 1  ON 44
eH2_5                 3.477495e-02 1 1  ON 45
eH2_6                 9.769990e-02 1 1  ON 46
eH2_7                 1.614086e-01 1 1  ON 47
eH2_8                 2.041091e-01 1 1  ON 48
eH2_9                 1.022003e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5453e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9002
    reference variance = 0.176525
====================================================
  Execution time = 2.0576e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3824e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5710e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338238336767
                                         uncertainty =       0.003273198905

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338238336767
                                         uncertainty =       0.003273198905

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411239415
  error estimate for blocks of size 2^( 2) =       0.000424107185
  error estimate for blocks of size 2^( 3) =       0.000437024326
  error estimate for blocks of size 2^( 4) =       0.000449659973
  error estimate for blocks of size 2^( 5) =       0.000459530287
  error estimate for blocks of size 2^( 6) =       0.000468729170
  error estimate for blocks of size 2^( 7) =       0.000475453882

      target function =                  N/A
              le_mean =     -16.906557514484
             les_mean =     286.169922534880
             stat err =       0.000463343328
             autocorr =       1.269452225450
              std dev =       0.581580358544
             le_variance =       0.338235713444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690655751448e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906557514484       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906558848346       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906558387490       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906557941970       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906558248508       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906559385012       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906560261505       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906561840588       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906562159888       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906562698170       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906562150146       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.906561830345       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.029000e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906557514484       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906558111321       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906557816203       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906557522254       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906557510903       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906557815528       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906558226889       residual = 7.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906558295687       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906558462663       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.951926e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906557514484       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906557700403       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906557586762       residual = 2.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906557488688       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906557438511       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906557492145       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906557611577       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906557607528       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.230062e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.341486 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6154e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.123416e-01 1 1  ON 0
 uu_1                 1.445330e-01 1 1  ON 1
 uu_2                 4.233942e-02 1 1  ON 2
 uu_3                -2.077182e-02 1 1  ON 3
 uu_4                -6.733478e-02 1 1  ON 4
 uu_5                -1.039272e-01 1 1  ON 5
 uu_6                -1.335091e-01 1 1  ON 6
 uu_7                -1.494577e-01 1 1  ON 7
 uu_8                -1.426700e-01 1 1  ON 8
 uu_9                -1.122108e-01 1 1  ON 9
 ud_0                 4.540669e-01 1 1  ON 10
 ud_1                 1.879525e-01 1 1  ON 11
 ud_2                 6.710353e-02 1 1  ON 12
 ud_3                -4.558369e-03 1 1  ON 13
 ud_4                -6.224782e-02 1 1  ON 14
 ud_5                -1.047819e-01 1 1  ON 15
 ud_6                -1.335027e-01 1 1  ON 16
 ud_7                -1.508733e-01 1 1  ON 17
 ud_8                -1.518240e-01 1 1  ON 18
 ud_9                -1.432089e-01 1 1  ON 19
 eO_0                -7.497652e-01 1 1  ON 20
 eO_1                -4.277912e-01 1 1  ON 21
 eO_2                -1.267581e-02 1 1  ON 22
 eO_3                 3.043499e-01 1 1  ON 23
 eO_4                 5.325821e-01 1 1  ON 24
 eO_5                 4.975596e-01 1 1  ON 25
 eO_6                 2.671867e-01 1 1  ON 26
 eO_7                -4.319013e-02 1 1  ON 27
 eO_8                -2.430941e-01 1 1  ON 28
 eO_9                -1.172753e-01 1 1  ON 29
eH1_0                -2.673457e-01 1 1  ON 30
eH1_1                -1.611511e-01 1 1  ON 31
eH1_2                -1.118961e-01 1 1  ON 32
eH1_3                -5.623734e-02 1 1  ON 33
eH1_4                -6.009069e-03 1 1  ON 34
eH1_5                 3.012121e-02 1 1  ON 35
eH1_6                 9.394592e-02 1 1  ON 36
eH1_7                 1.615560e-01 1 1  ON 37
eH1_8                 2.033516e-01 1 1  ON 38
eH1_9                 1.115579e-01 1 1  ON 39
eH2_0                -2.645012e-01 1 1  ON 40
eH2_1                -1.588747e-01 1 1  ON 41
eH2_2                -1.094670e-01 1 1  ON 42
eH2_3                -5.398099e-02 1 1  ON 43
eH2_4                -3.547119e-03 1 1  ON 44
eH2_5                 3.458703e-02 1 1  ON 45
eH2_6                 9.753495e-02 1 1  ON 46
eH2_7                 1.615727e-01 1 1  ON 47
eH2_8                 2.043241e-01 1 1  ON 48
eH2_9                 1.025364e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9555
    reference variance = 0.370905
====================================================
  Execution time = 2.0030e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4007e-01
  Total weights = 2.0000e+06
  Execution time = 1.8694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340171848424
                                         uncertainty =       0.006850798589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340171848424
                                         uncertainty =       0.006850798589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412389891
  error estimate for blocks of size 2^( 2) =       0.000424762783
  error estimate for blocks of size 2^( 3) =       0.000437708555
  error estimate for blocks of size 2^( 4) =       0.000450385105
  error estimate for blocks of size 2^( 5) =       0.000460818052
  error estimate for blocks of size 2^( 6) =       0.000471037199
  error estimate for blocks of size 2^( 7) =       0.000475974322

      target function =                  N/A
              le_mean =     -16.907387999654
             les_mean =     286.199899645708
             stat err =       0.000464553669
             autocorr =       1.268982892792
              std dev =       0.583207377299
             le_variance =       0.340130844936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340025164652
                                         uncertainty =       0.006830186482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340025164652
                                         uncertainty =       0.006830186482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412301041
  error estimate for blocks of size 2^( 2) =       0.000424679818
  error estimate for blocks of size 2^( 3) =       0.000437632098
  error estimate for blocks of size 2^( 4) =       0.000450316733
  error estimate for blocks of size 2^( 5) =       0.000460749099
  error estimate for blocks of size 2^( 6) =       0.000470957870
  error estimate for blocks of size 2^( 7) =       0.000475894877

      target function =                  N/A
              le_mean =     -16.907391194729
             les_mean =     286.199861138678
             stat err =       0.000464479645
             autocorr =       1.269125323394
              std dev =       0.583081724179
             le_variance =       0.339984297071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340058973150
                                         uncertainty =       0.006833672590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340058973150
                                         uncertainty =       0.006833672590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412321508
  error estimate for blocks of size 2^( 2) =       0.000424700356
  error estimate for blocks of size 2^( 3) =       0.000437650923
  error estimate for blocks of size 2^( 4) =       0.000450333767
  error estimate for blocks of size 2^( 5) =       0.000460765539
  error estimate for blocks of size 2^( 6) =       0.000470971427
  error estimate for blocks of size 2^( 7) =       0.000475908478

      target function =                  N/A
              le_mean =     -16.907391761149
             les_mean =     286.199914047002
             stat err =       0.000464494803
             autocorr =       1.269082158751
              std dev =       0.583110668779
             le_variance =       0.340018052043

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340140561489
                                         uncertainty =       0.006848154020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340140561489
                                         uncertainty =       0.006848154020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412370927
  error estimate for blocks of size 2^( 2) =       0.000424745312
  error estimate for blocks of size 2^( 3) =       0.000437692229
  error estimate for blocks of size 2^( 4) =       0.000450370084
  error estimate for blocks of size 2^( 5) =       0.000460802926
  error estimate for blocks of size 2^( 6) =       0.000471019379
  error estimate for blocks of size 2^( 7) =       0.000475956726

      target function =                  N/A
              le_mean =     -16.907388517462
             les_mean =     286.199885872635
             stat err =       0.000464537279
             autocorr =       1.269010062077
              std dev =       0.583180557183
             le_variance =       0.340099562277


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907387999654        initial
     9.7656e-02     9.7656e-01             2.0290e-03       -16.907391194729
     3.9062e-01     3.9062e+00             4.9519e-04       -16.907391761149  <--
     1.5625e+00     1.5625e+01             1.2301e-04       -16.907388517462

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.9461e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.123416e-01 1 1  ON 0
 uu_1                 1.445330e-01 1 1  ON 1
 uu_2                 4.233942e-02 1 1  ON 2
 uu_3                -2.077182e-02 1 1  ON 3
 uu_4                -6.733478e-02 1 1  ON 4
 uu_5                -1.039272e-01 1 1  ON 5
 uu_6                -1.335091e-01 1 1  ON 6
 uu_7                -1.494577e-01 1 1  ON 7
 uu_8                -1.426700e-01 1 1  ON 8
 uu_9                -1.122108e-01 1 1  ON 9
 ud_0                 4.540669e-01 1 1  ON 10
 ud_1                 1.879525e-01 1 1  ON 11
 ud_2                 6.710353e-02 1 1  ON 12
 ud_3                -4.558369e-03 1 1  ON 13
 ud_4                -6.224782e-02 1 1  ON 14
 ud_5                -1.047819e-01 1 1  ON 15
 ud_6                -1.335027e-01 1 1  ON 16
 ud_7                -1.508733e-01 1 1  ON 17
 ud_8                -1.518240e-01 1 1  ON 18
 ud_9                -1.432089e-01 1 1  ON 19
 eO_0                -7.497652e-01 1 1  ON 20
 eO_1                -4.277912e-01 1 1  ON 21
 eO_2                -1.267581e-02 1 1  ON 22
 eO_3                 3.043499e-01 1 1  ON 23
 eO_4                 5.325821e-01 1 1  ON 24
 eO_5                 4.975596e-01 1 1  ON 25
 eO_6                 2.671867e-01 1 1  ON 26
 eO_7                -4.319013e-02 1 1  ON 27
 eO_8                -2.430941e-01 1 1  ON 28
 eO_9                -1.172753e-01 1 1  ON 29
eH1_0                -2.673457e-01 1 1  ON 30
eH1_1                -1.611511e-01 1 1  ON 31
eH1_2                -1.118961e-01 1 1  ON 32
eH1_3                -5.623734e-02 1 1  ON 33
eH1_4                -6.009069e-03 1 1  ON 34
eH1_5                 3.012121e-02 1 1  ON 35
eH1_6                 9.394592e-02 1 1  ON 36
eH1_7                 1.615560e-01 1 1  ON 37
eH1_8                 2.033516e-01 1 1  ON 38
eH1_9                 1.115579e-01 1 1  ON 39
eH2_0                -2.645012e-01 1 1  ON 40
eH2_1                -1.588747e-01 1 1  ON 41
eH2_2                -1.094670e-01 1 1  ON 42
eH2_3                -5.398099e-02 1 1  ON 43
eH2_4                -3.547119e-03 1 1  ON 44
eH2_5                 3.458703e-02 1 1  ON 45
eH2_6                 9.753495e-02 1 1  ON 46
eH2_7                 1.615727e-01 1 1  ON 47
eH2_8                 2.043241e-01 1 1  ON 48
eH2_9                 1.025364e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5621e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9381
    reference variance = 0.299189
====================================================
  Execution time = 2.0525e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5321e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5155e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353266400311
                                         uncertainty =       0.012290422898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353266400311
                                         uncertainty =       0.012290422898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420245914
  error estimate for blocks of size 2^( 2) =       0.000432388012
  error estimate for blocks of size 2^( 3) =       0.000444332167
  error estimate for blocks of size 2^( 4) =       0.000456817616
  error estimate for blocks of size 2^( 5) =       0.000465696737
  error estimate for blocks of size 2^( 6) =       0.000473653741
  error estimate for blocks of size 2^( 7) =       0.000479099880

      target function =                  N/A
              le_mean =     -16.905941192582
             les_mean =     286.164060686424
             stat err =       0.000468816994
             autocorr =       1.244513731339
              std dev =       0.594317470702
             le_variance =       0.353213255981


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690594119258e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941192582       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905942662134       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905945014319       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905945652974       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905945965870       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905948324641       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905948116229       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905947713924       residual = 9.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905947812285       residual = 5.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905947520969       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.905947905771       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.905947914158       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-02 is 2.008975e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941192582       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905941918052       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905943222497       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905943643135       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905943668622       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905943981094       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905944374305       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905944062860       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905943919581       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e-01 is 4.919626e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905941192582       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905941432381       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905941912574       residual = 7.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905942091396       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905942136176       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905942153098       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905942233658       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905942151471       residual = 4.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.228531e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345074 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6048e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.120758e-01 1 1  ON 0
 uu_1                 1.445448e-01 1 1  ON 1
 uu_2                 4.231146e-02 1 1  ON 2
 uu_3                -2.080182e-02 1 1  ON 3
 uu_4                -6.721184e-02 1 1  ON 4
 uu_5                -1.039020e-01 1 1  ON 5
 uu_6                -1.334222e-01 1 1  ON 6
 uu_7                -1.492127e-01 1 1  ON 7
 uu_8                -1.426918e-01 1 1  ON 8
 uu_9                -1.125556e-01 1 1  ON 9
 ud_0                 4.542054e-01 1 1  ON 10
 ud_1                 1.880540e-01 1 1  ON 11
 ud_2                 6.717457e-02 1 1  ON 12
 ud_3                -4.489516e-03 1 1  ON 13
 ud_4                -6.215081e-02 1 1  ON 14
 ud_5                -1.047879e-01 1 1  ON 15
 ud_6                -1.334164e-01 1 1  ON 16
 ud_7                -1.507969e-01 1 1  ON 17
 ud_8                -1.520846e-01 1 1  ON 18
 ud_9                -1.433050e-01 1 1  ON 19
 eO_0                -7.496814e-01 1 1  ON 20
 eO_1                -4.277595e-01 1 1  ON 21
 eO_2                -1.239614e-02 1 1  ON 22
 eO_3                 3.042544e-01 1 1  ON 23
 eO_4                 5.325744e-01 1 1  ON 24
 eO_5                 4.976985e-01 1 1  ON 25
 eO_6                 2.673759e-01 1 1  ON 26
 eO_7                -4.317615e-02 1 1  ON 27
 eO_8                -2.433409e-01 1 1  ON 28
 eO_9                -1.175955e-01 1 1  ON 29
eH1_0                -2.674138e-01 1 1  ON 30
eH1_1                -1.612476e-01 1 1  ON 31
eH1_2                -1.118761e-01 1 1  ON 32
eH1_3                -5.623498e-02 1 1  ON 33
eH1_4                -6.190655e-03 1 1  ON 34
eH1_5                 3.029229e-02 1 1  ON 35
eH1_6                 9.406309e-02 1 1  ON 36
eH1_7                 1.613199e-01 1 1  ON 37
eH1_8                 2.032598e-01 1 1  ON 38
eH1_9                 1.118756e-01 1 1  ON 39
eH2_0                -2.646640e-01 1 1  ON 40
eH2_1                -1.590831e-01 1 1  ON 41
eH2_2                -1.094720e-01 1 1  ON 42
eH2_3                -5.388896e-02 1 1  ON 43
eH2_4                -3.868633e-03 1 1  ON 44
eH2_5                 3.435126e-02 1 1  ON 45
eH2_6                 9.736867e-02 1 1  ON 46
eH2_7                 1.616834e-01 1 1  ON 47
eH2_8                 2.046201e-01 1 1  ON 48
eH2_9                 1.030284e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.886
    reference variance = 0.301856
====================================================
  Execution time = 2.0318e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3175e-01
  Total weights = 2.0000e+06
  Execution time = 1.8698e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331807372280
                                         uncertainty =       0.005085454816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331807372280
                                         uncertainty =       0.005085454816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407303313
  error estimate for blocks of size 2^( 2) =       0.000419805835
  error estimate for blocks of size 2^( 3) =       0.000432754162
  error estimate for blocks of size 2^( 4) =       0.000444398393
  error estimate for blocks of size 2^( 5) =       0.000454082750
  error estimate for blocks of size 2^( 6) =       0.000459841846
  error estimate for blocks of size 2^( 7) =       0.000462883667

      target function =                  N/A
              le_mean =     -16.906364053245
             les_mean =     286.156937312100
             stat err =       0.000455301664
             autocorr =       1.249575756650
              std dev =       0.576013868877
             le_variance =       0.331791977138

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331678762940
                                         uncertainty =       0.005077860181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331678762940
                                         uncertainty =       0.005077860181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407224261
  error estimate for blocks of size 2^( 2) =       0.000419725115
  error estimate for blocks of size 2^( 3) =       0.000432673994
  error estimate for blocks of size 2^( 4) =       0.000444318929
  error estimate for blocks of size 2^( 5) =       0.000454009709
  error estimate for blocks of size 2^( 6) =       0.000459773417
  error estimate for blocks of size 2^( 7) =       0.000462820367

      target function =                  N/A
              le_mean =     -16.906362633108
             les_mean =     286.156760514285
             stat err =       0.000455230606
             autocorr =       1.249670784321
              std dev =       0.575902073244
             le_variance =       0.331663197966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331728205527
                                         uncertainty =       0.005076509013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331728205527
                                         uncertainty =       0.005076509013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407254615
  error estimate for blocks of size 2^( 2) =       0.000419754602
  error estimate for blocks of size 2^( 3) =       0.000432702039
  error estimate for blocks of size 2^( 4) =       0.000444345223
  error estimate for blocks of size 2^( 5) =       0.000454034744
  error estimate for blocks of size 2^( 6) =       0.000459797174
  error estimate for blocks of size 2^( 7) =       0.000462844352

      target function =                  N/A
              le_mean =     -16.906362237750
             les_mean =     286.156796591565
             stat err =       0.000455255373
             autocorr =       1.249620471031
              std dev =       0.575945000340
             le_variance =       0.331712643417

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331793766189
                                         uncertainty =       0.005083860210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331793766189
                                         uncertainty =       0.005083860210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407294943
  error estimate for blocks of size 2^( 2) =       0.000419797051
  error estimate for blocks of size 2^( 3) =       0.000432745195
  error estimate for blocks of size 2^( 4) =       0.000444389225
  error estimate for blocks of size 2^( 5) =       0.000454074553
  error estimate for blocks of size 2^( 6) =       0.000459834196
  error estimate for blocks of size 2^( 7) =       0.000462877108

      target function =                  N/A
              le_mean =     -16.906363589162
             les_mean =     286.156907984505
             stat err =       0.000455293771
             autocorr =       1.249583783170
              std dev =       0.576002032520
             le_variance =       0.331778341468


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906364053245        initial  <--
     9.7656e-02     9.7656e-01             2.0090e-03       -16.906362633108
     3.9062e-01     3.9062e+00             4.9196e-04       -16.906362237750
     1.5625e+00     1.5625e+01             1.2285e-04       -16.906363589162

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7426
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.123416e-01 1 1  ON 0
 uu_1                 1.445330e-01 1 1  ON 1
 uu_2                 4.233942e-02 1 1  ON 2
 uu_3                -2.077182e-02 1 1  ON 3
 uu_4                -6.733478e-02 1 1  ON 4
 uu_5                -1.039272e-01 1 1  ON 5
 uu_6                -1.335091e-01 1 1  ON 6
 uu_7                -1.494577e-01 1 1  ON 7
 uu_8                -1.426700e-01 1 1  ON 8
 uu_9                -1.122108e-01 1 1  ON 9
 ud_0                 4.540669e-01 1 1  ON 10
 ud_1                 1.879525e-01 1 1  ON 11
 ud_2                 6.710353e-02 1 1  ON 12
 ud_3                -4.558369e-03 1 1  ON 13
 ud_4                -6.224782e-02 1 1  ON 14
 ud_5                -1.047819e-01 1 1  ON 15
 ud_6                -1.335027e-01 1 1  ON 16
 ud_7                -1.508733e-01 1 1  ON 17
 ud_8                -1.518240e-01 1 1  ON 18
 ud_9                -1.432089e-01 1 1  ON 19
 eO_0                -7.497652e-01 1 1  ON 20
 eO_1                -4.277912e-01 1 1  ON 21
 eO_2                -1.267581e-02 1 1  ON 22
 eO_3                 3.043499e-01 1 1  ON 23
 eO_4                 5.325821e-01 1 1  ON 24
 eO_5                 4.975596e-01 1 1  ON 25
 eO_6                 2.671867e-01 1 1  ON 26
 eO_7                -4.319013e-02 1 1  ON 27
 eO_8                -2.430941e-01 1 1  ON 28
 eO_9                -1.172753e-01 1 1  ON 29
eH1_0                -2.673457e-01 1 1  ON 30
eH1_1                -1.611511e-01 1 1  ON 31
eH1_2                -1.118961e-01 1 1  ON 32
eH1_3                -5.623734e-02 1 1  ON 33
eH1_4                -6.009069e-03 1 1  ON 34
eH1_5                 3.012121e-02 1 1  ON 35
eH1_6                 9.394592e-02 1 1  ON 36
eH1_7                 1.615560e-01 1 1  ON 37
eH1_8                 2.033516e-01 1 1  ON 38
eH1_9                 1.115579e-01 1 1  ON 39
eH2_0                -2.645012e-01 1 1  ON 40
eH2_1                -1.588747e-01 1 1  ON 41
eH2_2                -1.094670e-01 1 1  ON 42
eH2_3                -5.398099e-02 1 1  ON 43
eH2_4                -3.547119e-03 1 1  ON 44
eH2_5                 3.458703e-02 1 1  ON 45
eH2_6                 9.753495e-02 1 1  ON 46
eH2_7                 1.615727e-01 1 1  ON 47
eH2_8                 2.043241e-01 1 1  ON 48
eH2_9                 1.025364e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5797e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6924e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9529
    reference variance = 0.254939
====================================================
  Execution time = 2.0272e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5711e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4998e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357197832038
                                         uncertainty =       0.021429939031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357197832038
                                         uncertainty =       0.021429939031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422555490
  error estimate for blocks of size 2^( 2) =       0.000434586502
  error estimate for blocks of size 2^( 3) =       0.000446930458
  error estimate for blocks of size 2^( 4) =       0.000458208578
  error estimate for blocks of size 2^( 5) =       0.000466934594
  error estimate for blocks of size 2^( 6) =       0.000474247753
  error estimate for blocks of size 2^( 7) =       0.000477315246

      target function =                  N/A
              le_mean =     -16.906628612966
             les_mean =     286.191197163173
             stat err =       0.000469176543
             autocorr =       1.232835365254
              std dev =       0.597583705417
             le_variance =       0.357106284980


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690662861297e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906628612966       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906628464210       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906628241719       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906628324754       residual = 5.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906628441639       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906628528081       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906628628178       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906628592738       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.720289e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906628612966       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906628571879       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906628510176       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906628535101       residual = 4.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906628570138       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906628595397       residual = 7.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906628623219       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906628611430       residual = 4.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 4.402569e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906628612966       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906628602418       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906628586635       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906628593142       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906628602298       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906628609082       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906628616198       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906628613218       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.107406e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.347777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5779e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.123155e-01 1 1  ON 0
 uu_1                 1.445216e-01 1 1  ON 1
 uu_2                 4.232308e-02 1 1  ON 2
 uu_3                -2.077094e-02 1 1  ON 3
 uu_4                -6.732076e-02 1 1  ON 4
 uu_5                -1.039332e-01 1 1  ON 5
 uu_6                -1.334866e-01 1 1  ON 6
 uu_7                -1.494243e-01 1 1  ON 7
 uu_8                -1.426907e-01 1 1  ON 8
 uu_9                -1.122437e-01 1 1  ON 9
 ud_0                 4.540867e-01 1 1  ON 10
 ud_1                 1.879861e-01 1 1  ON 11
 ud_2                 6.711405e-02 1 1  ON 12
 ud_3                -4.549350e-03 1 1  ON 13
 ud_4                -6.224445e-02 1 1  ON 14
 ud_5                -1.047833e-01 1 1  ON 15
 ud_6                -1.335167e-01 1 1  ON 16
 ud_7                -1.508871e-01 1 1  ON 17
 ud_8                -1.518520e-01 1 1  ON 18
 ud_9                -1.432220e-01 1 1  ON 19
 eO_0                -7.497669e-01 1 1  ON 20
 eO_1                -4.277916e-01 1 1  ON 21
 eO_2                -1.264228e-02 1 1  ON 22
 eO_3                 3.043568e-01 1 1  ON 23
 eO_4                 5.325914e-01 1 1  ON 24
 eO_5                 4.975507e-01 1 1  ON 25
 eO_6                 2.672073e-01 1 1  ON 26
 eO_7                -4.318675e-02 1 1  ON 27
 eO_8                -2.431226e-01 1 1  ON 28
 eO_9                -1.173058e-01 1 1  ON 29
eH1_0                -2.673500e-01 1 1  ON 30
eH1_1                -1.611749e-01 1 1  ON 31
eH1_2                -1.118957e-01 1 1  ON 32
eH1_3                -5.624594e-02 1 1  ON 33
eH1_4                -6.031513e-03 1 1  ON 34
eH1_5                 3.012534e-02 1 1  ON 35
eH1_6                 9.395386e-02 1 1  ON 36
eH1_7                 1.615529e-01 1 1  ON 37
eH1_8                 2.033667e-01 1 1  ON 38
eH1_9                 1.115888e-01 1 1  ON 39
eH2_0                -2.645179e-01 1 1  ON 40
eH2_1                -1.588970e-01 1 1  ON 41
eH2_2                -1.094772e-01 1 1  ON 42
eH2_3                -5.395422e-02 1 1  ON 43
eH2_4                -3.570056e-03 1 1  ON 44
eH2_5                 3.458034e-02 1 1  ON 45
eH2_6                 9.750794e-02 1 1  ON 46
eH2_7                 1.615744e-01 1 1  ON 47
eH2_8                 2.043501e-01 1 1  ON 48
eH2_9                 1.025804e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.9719
    reference variance = 0.281959
====================================================
  Execution time = 2.0087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3854e-01
  Total weights = 2.0000e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338520558844
                                         uncertainty =       0.003119466583

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338520558844
                                         uncertainty =       0.003119466583

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411423825
  error estimate for blocks of size 2^( 2) =       0.000423890838
  error estimate for blocks of size 2^( 3) =       0.000436646945
  error estimate for blocks of size 2^( 4) =       0.000448263411
  error estimate for blocks of size 2^( 5) =       0.000457848934
  error estimate for blocks of size 2^( 6) =       0.000465143907
  error estimate for blocks of size 2^( 7) =       0.000467224197

      target function =                  N/A
              le_mean =     -16.906694442152
             les_mean =     286.174855919109
             stat err =       0.000459620112
             autocorr =       1.248013184078
              std dev =       0.581841153647
             le_variance =       0.338539128077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338514837725
                                         uncertainty =       0.003119148473

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338514837725
                                         uncertainty =       0.003119148473

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411420337
  error estimate for blocks of size 2^( 2) =       0.000423886412
  error estimate for blocks of size 2^( 3) =       0.000436641775
  error estimate for blocks of size 2^( 4) =       0.000448257685
  error estimate for blocks of size 2^( 5) =       0.000457842815
  error estimate for blocks of size 2^( 6) =       0.000465138674
  error estimate for blocks of size 2^( 7) =       0.000467214553

      target function =                  N/A
              le_mean =     -16.906695534703
             les_mean =     286.174887121870
             stat err =       0.000459613432
             autocorr =       1.247998065793
              std dev =       0.581836220937
             le_variance =       0.338533387995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338513608622
                                         uncertainty =       0.003119246081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338513608622
                                         uncertainty =       0.003119246081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411419593
  error estimate for blocks of size 2^( 2) =       0.000423886108
  error estimate for blocks of size 2^( 3) =       0.000436641897
  error estimate for blocks of size 2^( 4) =       0.000448258159
  error estimate for blocks of size 2^( 5) =       0.000457843427
  error estimate for blocks of size 2^( 6) =       0.000465138974
  error estimate for blocks of size 2^( 7) =       0.000467216483

      target function =                  N/A
              le_mean =     -16.906695051155
             les_mean =     286.174869546964
             stat err =       0.000459614261
             autocorr =       1.248007082032
              std dev =       0.581835168663
             le_variance =       0.338532163493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338519494637
                                         uncertainty =       0.003119436329

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338519494637
                                         uncertainty =       0.003119436329

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411423177
  error estimate for blocks of size 2^( 2) =       0.000423890125
  error estimate for blocks of size 2^( 3) =       0.000436646195
  error estimate for blocks of size 2^( 4) =       0.000448262638
  error estimate for blocks of size 2^( 5) =       0.000457848126
  error estimate for blocks of size 2^( 6) =       0.000465143176
  error estimate for blocks of size 2^( 7) =       0.000467223094

      target function =                  N/A
              le_mean =     -16.906694519048
             les_mean =     286.174857453001
             stat err =       0.000459619259
             autocorr =       1.248012479373
              std dev =       0.581840237390
             le_variance =       0.338538061846


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906694442152        initial
     9.7656e-01     9.7656e+00             1.7203e-04       -16.906695534703  <--
     3.9062e+00     3.9062e+01             4.4026e-05       -16.906695051155
     1.5625e+01     1.5625e+02             1.1074e-05       -16.906694519048

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 2.9423e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.122436e-01 1 1  ON 0
 uu_1                 1.444896e-01 1 1  ON 1
 uu_2                 4.228098e-02 1 1  ON 2
 uu_3                -2.077207e-02 1 1  ON 3
 uu_4                -6.728875e-02 1 1  ON 4
 uu_5                -1.039402e-01 1 1  ON 5
 uu_6                -1.334267e-01 1 1  ON 6
 uu_7                -1.493312e-01 1 1  ON 7
 uu_8                -1.427492e-01 1 1  ON 8
 uu_9                -1.123396e-01 1 1  ON 9
 ud_0                 4.541544e-01 1 1  ON 10
 ud_1                 1.880686e-01 1 1  ON 11
 ud_2                 6.715201e-02 1 1  ON 12
 ud_3                -4.525534e-03 1 1  ON 13
 ud_4                -6.223319e-02 1 1  ON 14
 ud_5                -1.047878e-01 1 1  ON 15
 ud_6                -1.335563e-01 1 1  ON 16
 ud_7                -1.509286e-01 1 1  ON 17
 ud_8                -1.519331e-01 1 1  ON 18
 ud_9                -1.432605e-01 1 1  ON 19
 eO_0                -7.497652e-01 1 1  ON 20
 eO_1                -4.277921e-01 1 1  ON 21
 eO_2                -1.255704e-02 1 1  ON 22
 eO_3                 3.043839e-01 1 1  ON 23
 eO_4                 5.326176e-01 1 1  ON 24
 eO_5                 4.975253e-01 1 1  ON 25
 eO_6                 2.672662e-01 1 1  ON 26
 eO_7                -4.317718e-02 1 1  ON 27
 eO_8                -2.432055e-01 1 1  ON 28
 eO_9                -1.173948e-01 1 1  ON 29
eH1_0                -2.673655e-01 1 1  ON 30
eH1_1                -1.612358e-01 1 1  ON 31
eH1_2                -1.119011e-01 1 1  ON 32
eH1_3                -5.627356e-02 1 1  ON 33
eH1_4                -6.093784e-03 1 1  ON 34
eH1_5                 3.013593e-02 1 1  ON 35
eH1_6                 9.397820e-02 1 1  ON 36
eH1_7                 1.615450e-01 1 1  ON 37
eH1_8                 2.034107e-01 1 1  ON 38
eH1_9                 1.116787e-01 1 1  ON 39
eH2_0                -2.645682e-01 1 1  ON 40
eH2_1                -1.589529e-01 1 1  ON 41
eH2_2                -1.095005e-01 1 1  ON 42
eH2_3                -5.389392e-02 1 1  ON 43
eH2_4                -3.626149e-03 1 1  ON 44
eH2_5                 3.455763e-02 1 1  ON 45
eH2_6                 9.742760e-02 1 1  ON 46
eH2_7                 1.615781e-01 1 1  ON 47
eH2_8                 2.044253e-01 1 1  ON 48
eH2_9                 1.027084e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5208e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6927e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9356
    reference variance = 0.406738
====================================================
  Execution time = 2.0415e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3638e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336190093912
                                         uncertainty =       0.006563998572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336190093912
                                         uncertainty =       0.006563998572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410110292
  error estimate for blocks of size 2^( 2) =       0.000422864408
  error estimate for blocks of size 2^( 3) =       0.000435653091
  error estimate for blocks of size 2^( 4) =       0.000447421195
  error estimate for blocks of size 2^( 5) =       0.000458167936
  error estimate for blocks of size 2^( 6) =       0.000465080943
  error estimate for blocks of size 2^( 7) =       0.000468307557

      target function =                  N/A
              le_mean =     -16.906477582443
             les_mean =     286.165364980145
             stat err =       0.000459744407
             autocorr =       1.256699881109
              std dev =       0.579983536556
             le_variance =       0.336380902676


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690647758244e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906477582443       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906478307060       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906479648028       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906478779468       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906477847611       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906477941470       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906478282015       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906478922112       residual = 7.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906478626580       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906478791533       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 1.013498e-03

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906477582443       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906477855321       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906478502012       residual = 8.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906478246419       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906477861276       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906477829514       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906477915736       residual = 3.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906478046775       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 2.476313e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906477582443       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906477660549       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906477867873       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906477812429       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906477689908       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906477675589       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906477707264       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906477712748       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.351264e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.350812 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5907e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.122464e-01 1 1  ON 0
 uu_1                 1.443560e-01 1 1  ON 1
 uu_2                 4.228105e-02 1 1  ON 2
 uu_3                -2.087051e-02 1 1  ON 3
 uu_4                -6.736548e-02 1 1  ON 4
 uu_5                -1.039161e-01 1 1  ON 5
 uu_6                -1.333416e-01 1 1  ON 6
 uu_7                -1.493114e-01 1 1  ON 7
 uu_8                -1.427701e-01 1 1  ON 8
 uu_9                -1.123067e-01 1 1  ON 9
 ud_0                 4.541828e-01 1 1  ON 10
 ud_1                 1.880598e-01 1 1  ON 11
 ud_2                 6.717028e-02 1 1  ON 12
 ud_3                -4.487119e-03 1 1  ON 13
 ud_4                -6.219484e-02 1 1  ON 14
 ud_5                -1.047610e-01 1 1  ON 15
 ud_6                -1.335853e-01 1 1  ON 16
 ud_7                -1.510335e-01 1 1  ON 17
 ud_8                -1.519797e-01 1 1  ON 18
 ud_9                -1.432301e-01 1 1  ON 19
 eO_0                -7.497471e-01 1 1  ON 20
 eO_1                -4.277890e-01 1 1  ON 21
 eO_2                -1.252301e-02 1 1  ON 22
 eO_3                 3.045156e-01 1 1  ON 23
 eO_4                 5.326202e-01 1 1  ON 24
 eO_5                 4.975269e-01 1 1  ON 25
 eO_6                 2.673112e-01 1 1  ON 26
 eO_7                -4.317229e-02 1 1  ON 27
 eO_8                -2.432981e-01 1 1  ON 28
 eO_9                -1.175143e-01 1 1  ON 29
eH1_0                -2.674619e-01 1 1  ON 30
eH1_1                -1.613057e-01 1 1  ON 31
eH1_2                -1.120542e-01 1 1  ON 32
eH1_3                -5.627621e-02 1 1  ON 33
eH1_4                -6.258430e-03 1 1  ON 34
eH1_5                 3.022774e-02 1 1  ON 35
eH1_6                 9.396242e-02 1 1  ON 36
eH1_7                 1.615173e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119263e-01 1 1  ON 39
eH2_0                -2.646136e-01 1 1  ON 40
eH2_1                -1.588818e-01 1 1  ON 41
eH2_2                -1.095231e-01 1 1  ON 42
eH2_3                -5.393722e-02 1 1  ON 43
eH2_4                -3.653999e-03 1 1  ON 44
eH2_5                 3.433258e-02 1 1  ON 45
eH2_6                 9.741374e-02 1 1  ON 46
eH2_7                 1.616756e-01 1 1  ON 47
eH2_8                 2.044942e-01 1 1  ON 48
eH2_9                 1.028376e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.8572
    reference variance = 0.156606
====================================================
  Execution time = 2.0997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4132e-01
  Total weights = 2.0000e+06
  Execution time = 2.2336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341394805942
                                         uncertainty =       0.007867557383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341394805942
                                         uncertainty =       0.007867557383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413105099
  error estimate for blocks of size 2^( 2) =       0.000425934672
  error estimate for blocks of size 2^( 3) =       0.000438922059
  error estimate for blocks of size 2^( 4) =       0.000450816040
  error estimate for blocks of size 2^( 5) =       0.000461818866
  error estimate for blocks of size 2^( 6) =       0.000471567663
  error estimate for blocks of size 2^( 7) =       0.000476298031

      target function =                  N/A
              le_mean =     -16.906768518799
             les_mean =     286.180133222732
             stat err =       0.000465125150
             autocorr =       1.267705971018
              std dev =       0.584218833259
             le_variance =       0.341311645134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341417635860
                                         uncertainty =       0.007872662755

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341417635860
                                         uncertainty =       0.007872662755

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413118819
  error estimate for blocks of size 2^( 2) =       0.000425948825
  error estimate for blocks of size 2^( 3) =       0.000438938005
  error estimate for blocks of size 2^( 4) =       0.000450829198
  error estimate for blocks of size 2^( 5) =       0.000461825721
  error estimate for blocks of size 2^( 6) =       0.000471574980
  error estimate for blocks of size 2^( 7) =       0.000476308376

      target function =                  N/A
              le_mean =     -16.906769927790
             les_mean =     286.180203538174
             stat err =       0.000465134569
             autocorr =       1.267673103562
              std dev =       0.584238237032
             le_variance =       0.341334317610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341413531286
                                         uncertainty =       0.007871762230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341413531286
                                         uncertainty =       0.007871762230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413116340
  error estimate for blocks of size 2^( 2) =       0.000425945761
  error estimate for blocks of size 2^( 3) =       0.000438934582
  error estimate for blocks of size 2^( 4) =       0.000450826218
  error estimate for blocks of size 2^( 5) =       0.000461823316
  error estimate for blocks of size 2^( 6) =       0.000471574079
  error estimate for blocks of size 2^( 7) =       0.000476306383

      target function =                  N/A
              le_mean =     -16.906770159201
             les_mean =     286.180207266242
             stat err =       0.000465132499
             autocorr =       1.267677038431
              std dev =       0.584234730965
             le_variance =       0.341330220866

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341397152232
                                         uncertainty =       0.007868153639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341397152232
                                         uncertainty =       0.007868153639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413106505
  error estimate for blocks of size 2^( 2) =       0.000425936000
  error estimate for blocks of size 2^( 3) =       0.000438923594
  error estimate for blocks of size 2^( 4) =       0.000450817199
  error estimate for blocks of size 2^( 5) =       0.000461819129
  error estimate for blocks of size 2^( 6) =       0.000471568270
  error estimate for blocks of size 2^( 7) =       0.000476298894

      target function =                  N/A
              le_mean =     -16.906768755498
             les_mean =     286.180143550110
             stat err =       0.000465125873
             autocorr =       1.267701281268
              std dev =       0.584220822019
             le_variance =       0.341313968880


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906768518799        initial
     2.4414e-01     2.4414e+00             1.0135e-03       -16.906769927790
     9.7656e-01     9.7656e+00             2.4763e-04       -16.906770159201  <--
     3.9062e+00     3.9062e+01             6.3513e-05       -16.906768755498

*****************************************************************************
Applying the update for shift_i =   9.7656e-01     and shift_s =   9.7656e+00
*****************************************************************************

  Execution time = 3.0773e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.122464e-01 1 1  ON 0
 uu_1                 1.443560e-01 1 1  ON 1
 uu_2                 4.228105e-02 1 1  ON 2
 uu_3                -2.087051e-02 1 1  ON 3
 uu_4                -6.736548e-02 1 1  ON 4
 uu_5                -1.039161e-01 1 1  ON 5
 uu_6                -1.333416e-01 1 1  ON 6
 uu_7                -1.493114e-01 1 1  ON 7
 uu_8                -1.427701e-01 1 1  ON 8
 uu_9                -1.123067e-01 1 1  ON 9
 ud_0                 4.541828e-01 1 1  ON 10
 ud_1                 1.880598e-01 1 1  ON 11
 ud_2                 6.717028e-02 1 1  ON 12
 ud_3                -4.487119e-03 1 1  ON 13
 ud_4                -6.219484e-02 1 1  ON 14
 ud_5                -1.047610e-01 1 1  ON 15
 ud_6                -1.335853e-01 1 1  ON 16
 ud_7                -1.510335e-01 1 1  ON 17
 ud_8                -1.519797e-01 1 1  ON 18
 ud_9                -1.432301e-01 1 1  ON 19
 eO_0                -7.497471e-01 1 1  ON 20
 eO_1                -4.277890e-01 1 1  ON 21
 eO_2                -1.252301e-02 1 1  ON 22
 eO_3                 3.045156e-01 1 1  ON 23
 eO_4                 5.326202e-01 1 1  ON 24
 eO_5                 4.975269e-01 1 1  ON 25
 eO_6                 2.673112e-01 1 1  ON 26
 eO_7                -4.317229e-02 1 1  ON 27
 eO_8                -2.432981e-01 1 1  ON 28
 eO_9                -1.175143e-01 1 1  ON 29
eH1_0                -2.674619e-01 1 1  ON 30
eH1_1                -1.613057e-01 1 1  ON 31
eH1_2                -1.120542e-01 1 1  ON 32
eH1_3                -5.627621e-02 1 1  ON 33
eH1_4                -6.258430e-03 1 1  ON 34
eH1_5                 3.022774e-02 1 1  ON 35
eH1_6                 9.396242e-02 1 1  ON 36
eH1_7                 1.615173e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119263e-01 1 1  ON 39
eH2_0                -2.646136e-01 1 1  ON 40
eH2_1                -1.588818e-01 1 1  ON 41
eH2_2                -1.095231e-01 1 1  ON 42
eH2_3                -5.393722e-02 1 1  ON 43
eH2_4                -3.653999e-03 1 1  ON 44
eH2_5                 3.433258e-02 1 1  ON 45
eH2_6                 9.741374e-02 1 1  ON 46
eH2_7                 1.616756e-01 1 1  ON 47
eH2_8                 2.044942e-01 1 1  ON 48
eH2_9                 1.028376e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6687e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6925e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.8691
    reference variance = 0.275521
====================================================
  Execution time = 2.0421e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3792e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5385e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337946321829
                                         uncertainty =       0.003842589440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337946321829
                                         uncertainty =       0.003842589440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411046599
  error estimate for blocks of size 2^( 2) =       0.000424048898
  error estimate for blocks of size 2^( 3) =       0.000437589883
  error estimate for blocks of size 2^( 4) =       0.000449868671
  error estimate for blocks of size 2^( 5) =       0.000460059357
  error estimate for blocks of size 2^( 6) =       0.000466886272
  error estimate for blocks of size 2^( 7) =       0.000474369430

      target function =                  N/A
              le_mean =     -16.905783690852
             les_mean =     286.143440645523
             stat err =       0.000462795933
             autocorr =       1.267642960065
              std dev =       0.581307674637
             le_variance =       0.337918612591


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690578369085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-01, overlap shift 2.4414e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905783690852       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905784126543       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905784400528       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905785036567       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905785382961       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905785576902       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905785369655       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905785899043       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.905785565701       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.905785456639       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e-01 is 5.889453e-04

solving harmonic davidson linear method for identity shift 9.7656e-01, overlap shift 9.7656e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905783690852       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905783852434       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905783915727       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905783938130       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905784059827       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905784185663       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905784115452       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905784139796       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e-01 is 1.451962e-04

solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905783690852       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905783736801       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905783751177       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905783741534       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905783761619       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905783793652       residual = 6.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905783781549       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 3.885930e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.353698 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5966e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.121550e-01 1 1  ON 0
 uu_1                 1.443895e-01 1 1  ON 1
 uu_2                 4.224846e-02 1 1  ON 2
 uu_3                -2.084245e-02 1 1  ON 3
 uu_4                -6.732989e-02 1 1  ON 4
 uu_5                -1.038719e-01 1 1  ON 5
 uu_6                -1.332452e-01 1 1  ON 6
 uu_7                -1.492794e-01 1 1  ON 7
 uu_8                -1.428246e-01 1 1  ON 8
 uu_9                -1.124315e-01 1 1  ON 9
 ud_0                 4.542980e-01 1 1  ON 10
 ud_1                 1.881013e-01 1 1  ON 11
 ud_2                 6.725402e-02 1 1  ON 12
 ud_3                -4.416761e-03 1 1  ON 13
 ud_4                -6.218139e-02 1 1  ON 14
 ud_5                -1.047536e-01 1 1  ON 15
 ud_6                -1.335457e-01 1 1  ON 16
 ud_7                -1.510571e-01 1 1  ON 17
 ud_8                -1.521066e-01 1 1  ON 18
 ud_9                -1.433712e-01 1 1  ON 19
 eO_0                -7.496019e-01 1 1  ON 20
 eO_1                -4.277413e-01 1 1  ON 21
 eO_2                -1.252390e-02 1 1  ON 22
 eO_3                 3.044971e-01 1 1  ON 23
 eO_4                 5.326706e-01 1 1  ON 24
 eO_5                 4.975409e-01 1 1  ON 25
 eO_6                 2.673909e-01 1 1  ON 26
 eO_7                -4.317885e-02 1 1  ON 27
 eO_8                -2.434414e-01 1 1  ON 28
 eO_9                -1.176570e-01 1 1  ON 29
eH1_0                -2.673771e-01 1 1  ON 30
eH1_1                -1.613157e-01 1 1  ON 31
eH1_2                -1.121308e-01 1 1  ON 32
eH1_3                -5.632166e-02 1 1  ON 33
eH1_4                -6.277372e-03 1 1  ON 34
eH1_5                 3.017905e-02 1 1  ON 35
eH1_6                 9.389574e-02 1 1  ON 36
eH1_7                 1.614993e-01 1 1  ON 37
eH1_8                 2.035947e-01 1 1  ON 38
eH1_9                 1.120565e-01 1 1  ON 39
eH2_0                -2.646966e-01 1 1  ON 40
eH2_1                -1.588715e-01 1 1  ON 41
eH2_2                -1.095569e-01 1 1  ON 42
eH2_3                -5.399674e-02 1 1  ON 43
eH2_4                -3.626131e-03 1 1  ON 44
eH2_5                 3.427645e-02 1 1  ON 45
eH2_6                 9.740820e-02 1 1  ON 46
eH2_7                 1.616649e-01 1 1  ON 47
eH2_8                 2.045259e-01 1 1  ON 48
eH2_9                 1.029814e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9062
    reference variance = 0.257037
====================================================
  Execution time = 1.9914e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3438e-01
  Total weights = 2.0000e+06
  Execution time = 1.8556e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334396558318
                                         uncertainty =       0.003414156800

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334396558318
                                         uncertainty =       0.003414156800

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408872413
  error estimate for blocks of size 2^( 2) =       0.000421821843
  error estimate for blocks of size 2^( 3) =       0.000434708268
  error estimate for blocks of size 2^( 4) =       0.000446716413
  error estimate for blocks of size 2^( 5) =       0.000456103785
  error estimate for blocks of size 2^( 6) =       0.000462909672
  error estimate for blocks of size 2^( 7) =       0.000467853923

      target function =                  N/A
              le_mean =     -16.905434268580
             les_mean =     286.128060941912
             stat err =       0.000458395948
             autocorr =       1.256915039150
              std dev =       0.578232911376
             le_variance =       0.334353299798

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334413889778
                                         uncertainty =       0.003410552440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334413889778
                                         uncertainty =       0.003410552440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408882979
  error estimate for blocks of size 2^( 2) =       0.000421827393
  error estimate for blocks of size 2^( 3) =       0.000434707816
  error estimate for blocks of size 2^( 4) =       0.000446710306
  error estimate for blocks of size 2^( 5) =       0.000456099044
  error estimate for blocks of size 2^( 6) =       0.000462908868
  error estimate for blocks of size 2^( 7) =       0.000467854630

      target function =                  N/A
              le_mean =     -16.905433000529
             les_mean =     286.128035349534
             stat err =       0.000458393212
             autocorr =       1.256835072924
              std dev =       0.578247854596
             le_variance =       0.334370581344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334451908191
                                         uncertainty =       0.003411486680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334451908191
                                         uncertainty =       0.003411486680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408906214
  error estimate for blocks of size 2^( 2) =       0.000421851030
  error estimate for blocks of size 2^( 3) =       0.000434732145
  error estimate for blocks of size 2^( 4) =       0.000446735371
  error estimate for blocks of size 2^( 5) =       0.000456123479
  error estimate for blocks of size 2^( 6) =       0.000462930862
  error estimate for blocks of size 2^( 7) =       0.000467875215

      target function =                  N/A
              le_mean =     -16.905433129674
             les_mean =     286.128077717961
             stat err =       0.000458416232
             autocorr =       1.256818466767
              std dev =       0.578280713215
             le_variance =       0.334408583276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334409744363
                                         uncertainty =       0.003413800731

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334409744363
                                         uncertainty =       0.003413800731

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408880466
  error estimate for blocks of size 2^( 2) =       0.000421829069
  error estimate for blocks of size 2^( 3) =       0.000434714609
  error estimate for blocks of size 2^( 4) =       0.000446721946
  error estimate for blocks of size 2^( 5) =       0.000456109406
  error estimate for blocks of size 2^( 6) =       0.000462915405
  error estimate for blocks of size 2^( 7) =       0.000467859669

      target function =                  N/A
              le_mean =     -16.905434040582
             les_mean =     286.128066404536
             stat err =       0.000458401606
             autocorr =       1.256896554580
              std dev =       0.578244300651
             le_variance =       0.334366471235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905434268580        initial  <--
     2.4414e-01     2.4414e+00             5.8895e-04       -16.905433000529
     9.7656e-01     9.7656e+00             1.4520e-04       -16.905433129674
     3.9062e+00     3.9062e+01             3.8859e-05       -16.905434040582

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2764
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.122464e-01 1 1  ON 0
 uu_1                 1.443560e-01 1 1  ON 1
 uu_2                 4.228105e-02 1 1  ON 2
 uu_3                -2.087051e-02 1 1  ON 3
 uu_4                -6.736548e-02 1 1  ON 4
 uu_5                -1.039161e-01 1 1  ON 5
 uu_6                -1.333416e-01 1 1  ON 6
 uu_7                -1.493114e-01 1 1  ON 7
 uu_8                -1.427701e-01 1 1  ON 8
 uu_9                -1.123067e-01 1 1  ON 9
 ud_0                 4.541828e-01 1 1  ON 10
 ud_1                 1.880598e-01 1 1  ON 11
 ud_2                 6.717028e-02 1 1  ON 12
 ud_3                -4.487119e-03 1 1  ON 13
 ud_4                -6.219484e-02 1 1  ON 14
 ud_5                -1.047610e-01 1 1  ON 15
 ud_6                -1.335853e-01 1 1  ON 16
 ud_7                -1.510335e-01 1 1  ON 17
 ud_8                -1.519797e-01 1 1  ON 18
 ud_9                -1.432301e-01 1 1  ON 19
 eO_0                -7.497471e-01 1 1  ON 20
 eO_1                -4.277890e-01 1 1  ON 21
 eO_2                -1.252301e-02 1 1  ON 22
 eO_3                 3.045156e-01 1 1  ON 23
 eO_4                 5.326202e-01 1 1  ON 24
 eO_5                 4.975269e-01 1 1  ON 25
 eO_6                 2.673112e-01 1 1  ON 26
 eO_7                -4.317229e-02 1 1  ON 27
 eO_8                -2.432981e-01 1 1  ON 28
 eO_9                -1.175143e-01 1 1  ON 29
eH1_0                -2.674619e-01 1 1  ON 30
eH1_1                -1.613057e-01 1 1  ON 31
eH1_2                -1.120542e-01 1 1  ON 32
eH1_3                -5.627621e-02 1 1  ON 33
eH1_4                -6.258430e-03 1 1  ON 34
eH1_5                 3.022774e-02 1 1  ON 35
eH1_6                 9.396242e-02 1 1  ON 36
eH1_7                 1.615173e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119263e-01 1 1  ON 39
eH2_0                -2.646136e-01 1 1  ON 40
eH2_1                -1.588818e-01 1 1  ON 41
eH2_2                -1.095231e-01 1 1  ON 42
eH2_3                -5.393722e-02 1 1  ON 43
eH2_4                -3.653999e-03 1 1  ON 44
eH2_5                 3.433258e-02 1 1  ON 45
eH2_6                 9.741374e-02 1 1  ON 46
eH2_7                 1.616756e-01 1 1  ON 47
eH2_8                 2.044942e-01 1 1  ON 48
eH2_9                 1.028376e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5249e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9106
    reference variance = 0.221234
====================================================
  Execution time = 2.0426e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3706e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337098879805
                                         uncertainty =       0.003094279015

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337098879805
                                         uncertainty =       0.003094279015

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410524139
  error estimate for blocks of size 2^( 2) =       0.000423328377
  error estimate for blocks of size 2^( 3) =       0.000436465436
  error estimate for blocks of size 2^( 4) =       0.000448573587
  error estimate for blocks of size 2^( 5) =       0.000459584137
  error estimate for blocks of size 2^( 6) =       0.000466493632
  error estimate for blocks of size 2^( 7) =       0.000472819673

      target function =                  N/A
              le_mean =     -16.906870979438
             les_mean =     286.179346284472
             stat err =       0.000461867757
             autocorr =       1.265779018287
              std dev =       0.580568805252
             le_variance =       0.337060137632


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690687097944e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906870979438       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906870842564       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906870968284       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906870984614       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906870972819       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906871170574       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906871199350       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906871177326       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 7.515747e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906870979438       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906870943393       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906870976321       residual = 7.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906870980278       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906870975247       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906871023978       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906871035579       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906871031897       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 1.895674e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906870979438       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906870970305       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906870978636       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906870979614       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906870978204       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906870990307       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906870993507       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906870992730       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 4.750682e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.356360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5883e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.122340e-01 1 1  ON 0
 uu_1                 1.443693e-01 1 1  ON 1
 uu_2                 4.227658e-02 1 1  ON 2
 uu_3                -2.087136e-02 1 1  ON 3
 uu_4                -6.736611e-02 1 1  ON 4
 uu_5                -1.039153e-01 1 1  ON 5
 uu_6                -1.333427e-01 1 1  ON 6
 uu_7                -1.492991e-01 1 1  ON 7
 uu_8                -1.427766e-01 1 1  ON 8
 uu_9                -1.123208e-01 1 1  ON 9
 ud_0                 4.541804e-01 1 1  ON 10
 ud_1                 1.880663e-01 1 1  ON 11
 ud_2                 6.717095e-02 1 1  ON 12
 ud_3                -4.480318e-03 1 1  ON 13
 ud_4                -6.218971e-02 1 1  ON 14
 ud_5                -1.047616e-01 1 1  ON 15
 ud_6                -1.335702e-01 1 1  ON 16
 ud_7                -1.510280e-01 1 1  ON 17
 ud_8                -1.519938e-01 1 1  ON 18
 ud_9                -1.432439e-01 1 1  ON 19
 eO_0                -7.497462e-01 1 1  ON 20
 eO_1                -4.277817e-01 1 1  ON 21
 eO_2                -1.251579e-02 1 1  ON 22
 eO_3                 3.045216e-01 1 1  ON 23
 eO_4                 5.326250e-01 1 1  ON 24
 eO_5                 4.975235e-01 1 1  ON 25
 eO_6                 2.673147e-01 1 1  ON 26
 eO_7                -4.317093e-02 1 1  ON 27
 eO_8                -2.433103e-01 1 1  ON 28
 eO_9                -1.175269e-01 1 1  ON 29
eH1_0                -2.674561e-01 1 1  ON 30
eH1_1                -1.613125e-01 1 1  ON 31
eH1_2                -1.120567e-01 1 1  ON 32
eH1_3                -5.627505e-02 1 1  ON 33
eH1_4                -6.270050e-03 1 1  ON 34
eH1_5                 3.021499e-02 1 1  ON 35
eH1_6                 9.396782e-02 1 1  ON 36
eH1_7                 1.615200e-01 1 1  ON 37
eH1_8                 2.035473e-01 1 1  ON 38
eH1_9                 1.119400e-01 1 1  ON 39
eH2_0                -2.646248e-01 1 1  ON 40
eH2_1                -1.588933e-01 1 1  ON 41
eH2_2                -1.095324e-01 1 1  ON 42
eH2_3                -5.392997e-02 1 1  ON 43
eH2_4                -3.648264e-03 1 1  ON 44
eH2_5                 3.431743e-02 1 1  ON 45
eH2_6                 9.741390e-02 1 1  ON 46
eH2_7                 1.616776e-01 1 1  ON 47
eH2_8                 2.045058e-01 1 1  ON 48
eH2_9                 1.028565e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8717
    reference variance = 0.216804
====================================================
  Execution time = 2.0150e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3822e-01
  Total weights = 2.0000e+06
  Execution time = 1.8548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338271008550
                                         uncertainty =       0.004223458373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338271008550
                                         uncertainty =       0.004223458373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411229642
  error estimate for blocks of size 2^( 2) =       0.000424495343
  error estimate for blocks of size 2^( 3) =       0.000438253144
  error estimate for blocks of size 2^( 4) =       0.000451965355
  error estimate for blocks of size 2^( 5) =       0.000463870434
  error estimate for blocks of size 2^( 6) =       0.000475865791
  error estimate for blocks of size 2^( 7) =       0.000486688179

      target function =                  N/A
              le_mean =     -16.905807518406
             les_mean =     286.144547317159
             stat err =       0.000469597440
             autocorr =       1.304015091939
              std dev =       0.581566536932
             le_variance =       0.338219636879

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338260333835
                                         uncertainty =       0.004223233725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338260333835
                                         uncertainty =       0.004223233725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411223151
  error estimate for blocks of size 2^( 2) =       0.000424488384
  error estimate for blocks of size 2^( 3) =       0.000438245402
  error estimate for blocks of size 2^( 4) =       0.000451957054
  error estimate for blocks of size 2^( 5) =       0.000463863200
  error estimate for blocks of size 2^( 6) =       0.000475859771
  error estimate for blocks of size 2^( 7) =       0.000486682350

      target function =                  N/A
              le_mean =     -16.905807308934
             les_mean =     286.144529557870
             stat err =       0.000469590594
             autocorr =       1.304018236536
              std dev =       0.581557357590
             le_variance =       0.338208960166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338265205348
                                         uncertainty =       0.004223327951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338265205348
                                         uncertainty =       0.004223327951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411226114
  error estimate for blocks of size 2^( 2) =       0.000424491559
  error estimate for blocks of size 2^( 3) =       0.000438248908
  error estimate for blocks of size 2^( 4) =       0.000451960787
  error estimate for blocks of size 2^( 5) =       0.000463866427
  error estimate for blocks of size 2^( 6) =       0.000475862468
  error estimate for blocks of size 2^( 7) =       0.000486684945

      target function =                  N/A
              le_mean =     -16.905807395744
             les_mean =     286.144537366031
             stat err =       0.000469593657
             autocorr =       1.304016459180
              std dev =       0.581561547157
             le_variance =       0.338213833132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338270266301
                                         uncertainty =       0.004223441367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338270266301
                                         uncertainty =       0.004223441367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411229191
  error estimate for blocks of size 2^( 2) =       0.000424494859
  error estimate for blocks of size 2^( 3) =       0.000438252600
  error estimate for blocks of size 2^( 4) =       0.000451964768
  error estimate for blocks of size 2^( 5) =       0.000463869918
  error estimate for blocks of size 2^( 6) =       0.000475865364
  error estimate for blocks of size 2^( 7) =       0.000486687763

      target function =                  N/A
              le_mean =     -16.905807502104
             les_mean =     286.144546023669
             stat err =       0.000469596953
             autocorr =       1.304015251087
              std dev =       0.581565898744
             le_variance =       0.338218894582


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905807518406        initial  <--
     2.4414e+00     2.4414e+01             7.5157e-05       -16.905807308934
     9.7656e+00     9.7656e+01             1.8957e-05       -16.905807395744
     3.9062e+01     3.9062e+02             4.7507e-06       -16.905807502104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5004
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.122464e-01 1 1  ON 0
 uu_1                 1.443560e-01 1 1  ON 1
 uu_2                 4.228105e-02 1 1  ON 2
 uu_3                -2.087051e-02 1 1  ON 3
 uu_4                -6.736548e-02 1 1  ON 4
 uu_5                -1.039161e-01 1 1  ON 5
 uu_6                -1.333416e-01 1 1  ON 6
 uu_7                -1.493114e-01 1 1  ON 7
 uu_8                -1.427701e-01 1 1  ON 8
 uu_9                -1.123067e-01 1 1  ON 9
 ud_0                 4.541828e-01 1 1  ON 10
 ud_1                 1.880598e-01 1 1  ON 11
 ud_2                 6.717028e-02 1 1  ON 12
 ud_3                -4.487119e-03 1 1  ON 13
 ud_4                -6.219484e-02 1 1  ON 14
 ud_5                -1.047610e-01 1 1  ON 15
 ud_6                -1.335853e-01 1 1  ON 16
 ud_7                -1.510335e-01 1 1  ON 17
 ud_8                -1.519797e-01 1 1  ON 18
 ud_9                -1.432301e-01 1 1  ON 19
 eO_0                -7.497471e-01 1 1  ON 20
 eO_1                -4.277890e-01 1 1  ON 21
 eO_2                -1.252301e-02 1 1  ON 22
 eO_3                 3.045156e-01 1 1  ON 23
 eO_4                 5.326202e-01 1 1  ON 24
 eO_5                 4.975269e-01 1 1  ON 25
 eO_6                 2.673112e-01 1 1  ON 26
 eO_7                -4.317229e-02 1 1  ON 27
 eO_8                -2.432981e-01 1 1  ON 28
 eO_9                -1.175143e-01 1 1  ON 29
eH1_0                -2.674619e-01 1 1  ON 30
eH1_1                -1.613057e-01 1 1  ON 31
eH1_2                -1.120542e-01 1 1  ON 32
eH1_3                -5.627621e-02 1 1  ON 33
eH1_4                -6.258430e-03 1 1  ON 34
eH1_5                 3.022774e-02 1 1  ON 35
eH1_6                 9.396242e-02 1 1  ON 36
eH1_7                 1.615173e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119263e-01 1 1  ON 39
eH2_0                -2.646136e-01 1 1  ON 40
eH2_1                -1.588818e-01 1 1  ON 41
eH2_2                -1.095231e-01 1 1  ON 42
eH2_3                -5.393722e-02 1 1  ON 43
eH2_4                -3.653999e-03 1 1  ON 44
eH2_5                 3.433258e-02 1 1  ON 45
eH2_6                 9.741374e-02 1 1  ON 46
eH2_7                 1.616756e-01 1 1  ON 47
eH2_8                 2.044942e-01 1 1  ON 48
eH2_9                 1.028376e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9536
    reference variance = 0.254366
====================================================
  Execution time = 2.0460e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3949e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4725e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339559819503
                                         uncertainty =       0.003289095719

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339559819503
                                         uncertainty =       0.003289095719

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412001297
  error estimate for blocks of size 2^( 2) =       0.000424856046
  error estimate for blocks of size 2^( 3) =       0.000437917804
  error estimate for blocks of size 2^( 4) =       0.000449836682
  error estimate for blocks of size 2^( 5) =       0.000461652842
  error estimate for blocks of size 2^( 6) =       0.000470905667
  error estimate for blocks of size 2^( 7) =       0.000477962125

      target function =                  N/A
              le_mean =     -16.906497932403
             les_mean =     286.169162305499
             stat err =       0.000465089329
             autocorr =       1.274311447683
              std dev =       0.582657821436
             le_variance =       0.339490136881


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690649793240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906497932403       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906497954330       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906497949244       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906497953128       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906497974085       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906497968991       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906497975471       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906497972982       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 8.666932e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906497932403       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906497937912       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906497936632       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906497937587       residual = 8.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906497942843       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906497941627       residual = 7.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906497943233       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906497942609       residual = 3.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.168020e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906497932403       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906497933782       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906497933462       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906497933699       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906497935015       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906497934714       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906497935115       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906497934959       residual = 3.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.420859e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.359005 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5939e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.122460e-01 1 1  ON 0
 uu_1                 1.443562e-01 1 1  ON 1
 uu_2                 4.228134e-02 1 1  ON 2
 uu_3                -2.086981e-02 1 1  ON 3
 uu_4                -6.736576e-02 1 1  ON 4
 uu_5                -1.039145e-01 1 1  ON 5
 uu_6                -1.333423e-01 1 1  ON 6
 uu_7                -1.493118e-01 1 1  ON 7
 uu_8                -1.427706e-01 1 1  ON 8
 uu_9                -1.123080e-01 1 1  ON 9
 ud_0                 4.541840e-01 1 1  ON 10
 ud_1                 1.880600e-01 1 1  ON 11
 ud_2                 6.717124e-02 1 1  ON 12
 ud_3                -4.486795e-03 1 1  ON 13
 ud_4                -6.219426e-02 1 1  ON 14
 ud_5                -1.047606e-01 1 1  ON 15
 ud_6                -1.335852e-01 1 1  ON 16
 ud_7                -1.510332e-01 1 1  ON 17
 ud_8                -1.519810e-01 1 1  ON 18
 ud_9                -1.432311e-01 1 1  ON 19
 eO_0                -7.497461e-01 1 1  ON 20
 eO_1                -4.277897e-01 1 1  ON 21
 eO_2                -1.252298e-02 1 1  ON 22
 eO_3                 3.045176e-01 1 1  ON 23
 eO_4                 5.326207e-01 1 1  ON 24
 eO_5                 4.975266e-01 1 1  ON 25
 eO_6                 2.673114e-01 1 1  ON 26
 eO_7                -4.317207e-02 1 1  ON 27
 eO_8                -2.432993e-01 1 1  ON 28
 eO_9                -1.175157e-01 1 1  ON 29
eH1_0                -2.674611e-01 1 1  ON 30
eH1_1                -1.613062e-01 1 1  ON 31
eH1_2                -1.120549e-01 1 1  ON 32
eH1_3                -5.627809e-02 1 1  ON 33
eH1_4                -6.258319e-03 1 1  ON 34
eH1_5                 3.022761e-02 1 1  ON 35
eH1_6                 9.396158e-02 1 1  ON 36
eH1_7                 1.615168e-01 1 1  ON 37
eH1_8                 2.035459e-01 1 1  ON 38
eH1_9                 1.119285e-01 1 1  ON 39
eH2_0                -2.646140e-01 1 1  ON 40
eH2_1                -1.588815e-01 1 1  ON 41
eH2_2                -1.095234e-01 1 1  ON 42
eH2_3                -5.393781e-02 1 1  ON 43
eH2_4                -3.654364e-03 1 1  ON 44
eH2_5                 3.433177e-02 1 1  ON 45
eH2_6                 9.741356e-02 1 1  ON 46
eH2_7                 1.616750e-01 1 1  ON 47
eH2_8                 2.044947e-01 1 1  ON 48
eH2_9                 1.028395e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9148
    reference variance = 0.190289
====================================================
  Execution time = 2.0087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3716e-01
  Total weights = 2.0000e+06
  Execution time = 1.8533e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337299856070
                                         uncertainty =       0.005664761278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337299856070
                                         uncertainty =       0.005664761278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410587176
  error estimate for blocks of size 2^( 2) =       0.000423501376
  error estimate for blocks of size 2^( 3) =       0.000436910158
  error estimate for blocks of size 2^( 4) =       0.000448897738
  error estimate for blocks of size 2^( 5) =       0.000458641175
  error estimate for blocks of size 2^( 6) =       0.000465354134
  error estimate for blocks of size 2^( 7) =       0.000472419428

      target function =                  N/A
              le_mean =     -16.905473584455
             les_mean =     286.132200604672
             stat err =       0.000461328119
             autocorr =       1.262435187366
              std dev =       0.580657953128
             le_variance =       0.337163658531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337299989549
                                         uncertainty =       0.005664739133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337299989549
                                         uncertainty =       0.005664739133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410587258
  error estimate for blocks of size 2^( 2) =       0.000423501490
  error estimate for blocks of size 2^( 3) =       0.000436910288
  error estimate for blocks of size 2^( 4) =       0.000448897852
  error estimate for blocks of size 2^( 5) =       0.000458641302
  error estimate for blocks of size 2^( 6) =       0.000465354345
  error estimate for blocks of size 2^( 7) =       0.000472419618

      target function =                  N/A
              le_mean =     -16.905473582649
             les_mean =     286.132200677134
             stat err =       0.000461328279
             autocorr =       1.262435563681
              std dev =       0.580658068125
             le_variance =       0.337163792079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337299930267
                                         uncertainty =       0.005664749979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337299930267
                                         uncertainty =       0.005664749979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410587221
  error estimate for blocks of size 2^( 2) =       0.000423501438
  error estimate for blocks of size 2^( 3) =       0.000436910228
  error estimate for blocks of size 2^( 4) =       0.000448897800
  error estimate for blocks of size 2^( 5) =       0.000458641244
  error estimate for blocks of size 2^( 6) =       0.000465354245
  error estimate for blocks of size 2^( 7) =       0.000472419528

      target function =                  N/A
              le_mean =     -16.905473583561
             les_mean =     286.132200648662
             stat err =       0.000461328204
             autocorr =       1.262435377178
              std dev =       0.580658017047
             le_variance =       0.337163732761

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337299865562
                                         uncertainty =       0.005664759858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337299865562
                                         uncertainty =       0.005664759858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410587182
  error estimate for blocks of size 2^( 2) =       0.000423501384
  error estimate for blocks of size 2^( 3) =       0.000436910167
  error estimate for blocks of size 2^( 4) =       0.000448897746
  error estimate for blocks of size 2^( 5) =       0.000458641184
  error estimate for blocks of size 2^( 6) =       0.000465354148
  error estimate for blocks of size 2^( 7) =       0.000472419441

      target function =                  N/A
              le_mean =     -16.905473584341
             les_mean =     286.132200610290
             stat err =       0.000461328130
             autocorr =       1.262435211146
              std dev =       0.580657961305
             le_variance =       0.337163668027


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905473584455        initial  <--
     2.4414e+01     2.4414e+02             8.6669e-06       -16.905473582649
     9.7656e+01     9.7656e+02             2.1680e-06       -16.905473583561
     3.9062e+02     3.9062e+03             5.4209e-07       -16.905473584341

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4155
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.122464e-01 1 1  ON 0
 uu_1                 1.443560e-01 1 1  ON 1
 uu_2                 4.228105e-02 1 1  ON 2
 uu_3                -2.087051e-02 1 1  ON 3
 uu_4                -6.736548e-02 1 1  ON 4
 uu_5                -1.039161e-01 1 1  ON 5
 uu_6                -1.333416e-01 1 1  ON 6
 uu_7                -1.493114e-01 1 1  ON 7
 uu_8                -1.427701e-01 1 1  ON 8
 uu_9                -1.123067e-01 1 1  ON 9
 ud_0                 4.541828e-01 1 1  ON 10
 ud_1                 1.880598e-01 1 1  ON 11
 ud_2                 6.717028e-02 1 1  ON 12
 ud_3                -4.487119e-03 1 1  ON 13
 ud_4                -6.219484e-02 1 1  ON 14
 ud_5                -1.047610e-01 1 1  ON 15
 ud_6                -1.335853e-01 1 1  ON 16
 ud_7                -1.510335e-01 1 1  ON 17
 ud_8                -1.519797e-01 1 1  ON 18
 ud_9                -1.432301e-01 1 1  ON 19
 eO_0                -7.497471e-01 1 1  ON 20
 eO_1                -4.277890e-01 1 1  ON 21
 eO_2                -1.252301e-02 1 1  ON 22
 eO_3                 3.045156e-01 1 1  ON 23
 eO_4                 5.326202e-01 1 1  ON 24
 eO_5                 4.975269e-01 1 1  ON 25
 eO_6                 2.673112e-01 1 1  ON 26
 eO_7                -4.317229e-02 1 1  ON 27
 eO_8                -2.432981e-01 1 1  ON 28
 eO_9                -1.175143e-01 1 1  ON 29
eH1_0                -2.674619e-01 1 1  ON 30
eH1_1                -1.613057e-01 1 1  ON 31
eH1_2                -1.120542e-01 1 1  ON 32
eH1_3                -5.627621e-02 1 1  ON 33
eH1_4                -6.258430e-03 1 1  ON 34
eH1_5                 3.022774e-02 1 1  ON 35
eH1_6                 9.396242e-02 1 1  ON 36
eH1_7                 1.615173e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119263e-01 1 1  ON 39
eH2_0                -2.646136e-01 1 1  ON 40
eH2_1                -1.588818e-01 1 1  ON 41
eH2_2                -1.095231e-01 1 1  ON 42
eH2_3                -5.393722e-02 1 1  ON 43
eH2_4                -3.653999e-03 1 1  ON 44
eH2_5                 3.433258e-02 1 1  ON 45
eH2_6                 9.741374e-02 1 1  ON 46
eH2_7                 1.616756e-01 1 1  ON 47
eH2_8                 2.044942e-01 1 1  ON 48
eH2_9                 1.028376e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5361e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9023
    reference variance = 0.230499
====================================================
  Execution time = 2.0306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3740e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4434e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337455025379
                                         uncertainty =       0.003003863889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337455025379
                                         uncertainty =       0.003003863889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410731475
  error estimate for blocks of size 2^( 2) =       0.000423572882
  error estimate for blocks of size 2^( 3) =       0.000437708252
  error estimate for blocks of size 2^( 4) =       0.000450974781
  error estimate for blocks of size 2^( 5) =       0.000463709753
  error estimate for blocks of size 2^( 6) =       0.000473190663
  error estimate for blocks of size 2^( 7) =       0.000479376743

      target function =                  N/A
              le_mean =     -16.905873846830
             les_mean =     286.145971045899
             stat err =       0.000466812985
             autocorr =       1.291724466136
              std dev =       0.580862022926
             le_variance =       0.337400689678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587384683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905873846830       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905873845190       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905873844240       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905873844224       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905873842932       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905873843127       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905873844081       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905873844495       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 7.569764e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905873846830       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905873846420       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905873846181       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905873846177       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905873845853       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905873845900       residual = 4.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905873846140       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905873846241       residual = 3.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 1.892542e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905873846830       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905873846727       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905873846668       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905873846666       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905873846584       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905873846595       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905873846660       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905873846681       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 4.731420e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361633 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5756e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.122462e-01 1 1  ON 0
 uu_1                 1.443560e-01 1 1  ON 1
 uu_2                 4.228106e-02 1 1  ON 2
 uu_3                -2.087057e-02 1 1  ON 3
 uu_4                -6.736550e-02 1 1  ON 4
 uu_5                -1.039162e-01 1 1  ON 5
 uu_6                -1.333416e-01 1 1  ON 6
 uu_7                -1.493115e-01 1 1  ON 7
 uu_8                -1.427701e-01 1 1  ON 8
 uu_9                -1.123067e-01 1 1  ON 9
 ud_0                 4.541828e-01 1 1  ON 10
 ud_1                 1.880598e-01 1 1  ON 11
 ud_2                 6.717019e-02 1 1  ON 12
 ud_3                -4.487036e-03 1 1  ON 13
 ud_4                -6.219492e-02 1 1  ON 14
 ud_5                -1.047610e-01 1 1  ON 15
 ud_6                -1.335854e-01 1 1  ON 16
 ud_7                -1.510334e-01 1 1  ON 17
 ud_8                -1.519797e-01 1 1  ON 18
 ud_9                -1.432301e-01 1 1  ON 19
 eO_0                -7.497470e-01 1 1  ON 20
 eO_1                -4.277890e-01 1 1  ON 21
 eO_2                -1.252311e-02 1 1  ON 22
 eO_3                 3.045157e-01 1 1  ON 23
 eO_4                 5.326202e-01 1 1  ON 24
 eO_5                 4.975269e-01 1 1  ON 25
 eO_6                 2.673112e-01 1 1  ON 26
 eO_7                -4.317227e-02 1 1  ON 27
 eO_8                -2.432982e-01 1 1  ON 28
 eO_9                -1.175144e-01 1 1  ON 29
eH1_0                -2.674619e-01 1 1  ON 30
eH1_1                -1.613057e-01 1 1  ON 31
eH1_2                -1.120543e-01 1 1  ON 32
eH1_3                -5.627621e-02 1 1  ON 33
eH1_4                -6.258532e-03 1 1  ON 34
eH1_5                 3.022764e-02 1 1  ON 35
eH1_6                 9.396242e-02 1 1  ON 36
eH1_7                 1.615173e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119265e-01 1 1  ON 39
eH2_0                -2.646136e-01 1 1  ON 40
eH2_1                -1.588818e-01 1 1  ON 41
eH2_2                -1.095233e-01 1 1  ON 42
eH2_3                -5.393719e-02 1 1  ON 43
eH2_4                -3.654117e-03 1 1  ON 44
eH2_5                 3.433247e-02 1 1  ON 45
eH2_6                 9.741372e-02 1 1  ON 46
eH2_7                 1.616756e-01 1 1  ON 47
eH2_8                 2.044943e-01 1 1  ON 48
eH2_9                 1.028377e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9532
    reference variance = 0.247384
====================================================
  Execution time = 2.0209e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4497e-01
  Total weights = 2.0000e+06
  Execution time = 1.8591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345046103876
                                         uncertainty =       0.004703506004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345046103876
                                         uncertainty =       0.004703506004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415315794
  error estimate for blocks of size 2^( 2) =       0.000428095039
  error estimate for blocks of size 2^( 3) =       0.000441045759
  error estimate for blocks of size 2^( 4) =       0.000453466633
  error estimate for blocks of size 2^( 5) =       0.000463895273
  error estimate for blocks of size 2^( 6) =       0.000470820742
  error estimate for blocks of size 2^( 7) =       0.000476447495

      target function =                  N/A
              le_mean =     -16.906863663829
             les_mean =     286.187013191751
             stat err =       0.000466157536
             autocorr =       1.259820076093
              std dev =       0.587345228074
             le_variance =       0.344974416941

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345046212801
                                         uncertainty =       0.004703506209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345046212801
                                         uncertainty =       0.004703506209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415315859
  error estimate for blocks of size 2^( 2) =       0.000428095099
  error estimate for blocks of size 2^( 3) =       0.000441045812
  error estimate for blocks of size 2^( 4) =       0.000453466689
  error estimate for blocks of size 2^( 5) =       0.000463895332
  error estimate for blocks of size 2^( 6) =       0.000470820785
  error estimate for blocks of size 2^( 7) =       0.000476447539

      target function =                  N/A
              le_mean =     -16.906863664298
             les_mean =     286.187013316721
             stat err =       0.000466157586
             autocorr =       1.259819949846
              std dev =       0.587345320945
             le_variance =       0.344974526036

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345046158534
                                         uncertainty =       0.004703506111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345046158534
                                         uncertainty =       0.004703506111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415315827
  error estimate for blocks of size 2^( 2) =       0.000428095069
  error estimate for blocks of size 2^( 3) =       0.000441045785
  error estimate for blocks of size 2^( 4) =       0.000453466661
  error estimate for blocks of size 2^( 5) =       0.000463895303
  error estimate for blocks of size 2^( 6) =       0.000470820764
  error estimate for blocks of size 2^( 7) =       0.000476447517

      target function =                  N/A
              le_mean =     -16.906863664066
             les_mean =     286.187013254498
             stat err =       0.000466157561
             autocorr =       1.259820012774
              std dev =       0.587345274676
             le_variance =       0.344974471684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345046110714
                                         uncertainty =       0.004703506018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345046110714
                                         uncertainty =       0.004703506018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415315798
  error estimate for blocks of size 2^( 2) =       0.000428095043
  error estimate for blocks of size 2^( 3) =       0.000441045762
  error estimate for blocks of size 2^( 4) =       0.000453466636
  error estimate for blocks of size 2^( 5) =       0.000463895277
  error estimate for blocks of size 2^( 6) =       0.000470820745
  error estimate for blocks of size 2^( 7) =       0.000476447498

      target function =                  N/A
              le_mean =     -16.906863663859
             les_mean =     286.187013199601
             stat err =       0.000466157539
             autocorr =       1.259820068174
              std dev =       0.587345233904
             le_variance =       0.344974423789


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906863663829        initial
     2.4414e+02     2.4414e+03             7.5698e-07       -16.906863664298  <--
     9.7656e+02     9.7656e+03             1.8925e-07       -16.906863664066
     3.9062e+03     3.9062e+04             4.7314e-08       -16.906863663859

*****************************************************************************
Applying the update for shift_i =   2.4414e+02     and shift_s =   2.4414e+03
*****************************************************************************

  Execution time = 2.9571e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.122458e-01 1 1  ON 0
 uu_1                 1.443559e-01 1 1  ON 1
 uu_2                 4.228109e-02 1 1  ON 2
 uu_3                -2.087075e-02 1 1  ON 3
 uu_4                -6.736555e-02 1 1  ON 4
 uu_5                -1.039164e-01 1 1  ON 5
 uu_6                -1.333414e-01 1 1  ON 6
 uu_7                -1.493116e-01 1 1  ON 7
 uu_8                -1.427699e-01 1 1  ON 8
 uu_9                -1.123065e-01 1 1  ON 9
 ud_0                 4.541828e-01 1 1  ON 10
 ud_1                 1.880598e-01 1 1  ON 11
 ud_2                 6.716991e-02 1 1  ON 12
 ud_3                -4.486788e-03 1 1  ON 13
 ud_4                -6.219515e-02 1 1  ON 14
 ud_5                -1.047609e-01 1 1  ON 15
 ud_6                -1.335854e-01 1 1  ON 16
 ud_7                -1.510331e-01 1 1  ON 17
 ud_8                -1.519796e-01 1 1  ON 18
 ud_9                -1.432301e-01 1 1  ON 19
 eO_0                -7.497468e-01 1 1  ON 20
 eO_1                -4.277890e-01 1 1  ON 21
 eO_2                -1.252342e-02 1 1  ON 22
 eO_3                 3.045159e-01 1 1  ON 23
 eO_4                 5.326203e-01 1 1  ON 24
 eO_5                 4.975270e-01 1 1  ON 25
 eO_6                 2.673114e-01 1 1  ON 26
 eO_7                -4.317220e-02 1 1  ON 27
 eO_8                -2.432982e-01 1 1  ON 28
 eO_9                -1.175148e-01 1 1  ON 29
eH1_0                -2.674620e-01 1 1  ON 30
eH1_1                -1.613057e-01 1 1  ON 31
eH1_2                -1.120544e-01 1 1  ON 32
eH1_3                -5.627621e-02 1 1  ON 33
eH1_4                -6.258840e-03 1 1  ON 34
eH1_5                 3.022736e-02 1 1  ON 35
eH1_6                 9.396242e-02 1 1  ON 36
eH1_7                 1.615173e-01 1 1  ON 37
eH1_8                 2.035448e-01 1 1  ON 38
eH1_9                 1.119271e-01 1 1  ON 39
eH2_0                -2.646137e-01 1 1  ON 40
eH2_1                -1.588818e-01 1 1  ON 41
eH2_2                -1.095238e-01 1 1  ON 42
eH2_3                -5.393708e-02 1 1  ON 43
eH2_4                -3.654473e-03 1 1  ON 44
eH2_5                 3.433215e-02 1 1  ON 45
eH2_6                 9.741366e-02 1 1  ON 46
eH2_7                 1.616757e-01 1 1  ON 47
eH2_8                 2.044946e-01 1 1  ON 48
eH2_9                 1.028383e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5333e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9654
    reference variance = 0.879375
====================================================
  Execution time = 2.0283e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3514e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6490e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335022185113
                                         uncertainty =       0.005274174989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335022185113
                                         uncertainty =       0.005274174989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409350213
  error estimate for blocks of size 2^( 2) =       0.000422158841
  error estimate for blocks of size 2^( 3) =       0.000435109656
  error estimate for blocks of size 2^( 4) =       0.000447426789
  error estimate for blocks of size 2^( 5) =       0.000457168579
  error estimate for blocks of size 2^( 6) =       0.000463330560
  error estimate for blocks of size 2^( 7) =       0.000467504431

      target function =                  N/A
              le_mean =     -16.906639776904
             les_mean =     286.169603572090
             stat err =       0.000458857590
             autocorr =       1.256509561809
              std dev =       0.578908622898
             le_variance =       0.335135193665


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690663977690e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906639776904       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906639770294       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906639785134       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906639788049       residual = 8.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906639797177       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906639795784       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906639795118       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906639794179       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.930942e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906639776904       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906639775249       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906639778972       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906639779702       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906639781982       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906639781631       residual = 5.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906639781463       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906639781229       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 9.833706e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906639776904       residual = 5.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906639776490       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906639777422       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906639777604       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906639778174       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906639778086       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906639778044       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906639777986       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.458824e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.364243 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5940e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.122457e-01 1 1  ON 0
 uu_1                 1.443556e-01 1 1  ON 1
 uu_2                 4.228130e-02 1 1  ON 2
 uu_3                -2.087061e-02 1 1  ON 3
 uu_4                -6.736558e-02 1 1  ON 4
 uu_5                -1.039162e-01 1 1  ON 5
 uu_6                -1.333408e-01 1 1  ON 6
 uu_7                -1.493114e-01 1 1  ON 7
 uu_8                -1.427707e-01 1 1  ON 8
 uu_9                -1.123071e-01 1 1  ON 9
 ud_0                 4.541834e-01 1 1  ON 10
 ud_1                 1.880601e-01 1 1  ON 11
 ud_2                 6.717045e-02 1 1  ON 12
 ud_3                -4.486198e-03 1 1  ON 13
 ud_4                -6.219503e-02 1 1  ON 14
 ud_5                -1.047608e-01 1 1  ON 15
 ud_6                -1.335855e-01 1 1  ON 16
 ud_7                -1.510332e-01 1 1  ON 17
 ud_8                -1.519806e-01 1 1  ON 18
 ud_9                -1.432307e-01 1 1  ON 19
 eO_0                -7.497462e-01 1 1  ON 20
 eO_1                -4.277887e-01 1 1  ON 21
 eO_2                -1.252399e-02 1 1  ON 22
 eO_3                 3.045162e-01 1 1  ON 23
 eO_4                 5.326205e-01 1 1  ON 24
 eO_5                 4.975274e-01 1 1  ON 25
 eO_6                 2.673116e-01 1 1  ON 26
 eO_7                -4.317251e-02 1 1  ON 27
 eO_8                -2.432987e-01 1 1  ON 28
 eO_9                -1.175153e-01 1 1  ON 29
eH1_0                -2.674618e-01 1 1  ON 30
eH1_1                -1.613059e-01 1 1  ON 31
eH1_2                -1.120545e-01 1 1  ON 32
eH1_3                -5.627663e-02 1 1  ON 33
eH1_4                -6.258737e-03 1 1  ON 34
eH1_5                 3.022746e-02 1 1  ON 35
eH1_6                 9.396265e-02 1 1  ON 36
eH1_7                 1.615173e-01 1 1  ON 37
eH1_8                 2.035448e-01 1 1  ON 38
eH1_9                 1.119273e-01 1 1  ON 39
eH2_0                -2.646140e-01 1 1  ON 40
eH2_1                -1.588815e-01 1 1  ON 41
eH2_2                -1.095243e-01 1 1  ON 42
eH2_3                -5.393690e-02 1 1  ON 43
eH2_4                -3.654509e-03 1 1  ON 44
eH2_5                 3.433184e-02 1 1  ON 45
eH2_6                 9.741316e-02 1 1  ON 46
eH2_7                 1.616758e-01 1 1  ON 47
eH2_8                 2.044950e-01 1 1  ON 48
eH2_9                 1.028389e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.8537
    reference variance = 0.403504
====================================================
  Execution time = 2.0099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3590e-01
  Total weights = 2.0000e+06
  Execution time = 1.8591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335940209872
                                         uncertainty =       0.005662537576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335940209872
                                         uncertainty =       0.005662537576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409819749
  error estimate for blocks of size 2^( 2) =       0.000422333490
  error estimate for blocks of size 2^( 3) =       0.000435183818
  error estimate for blocks of size 2^( 4) =       0.000447961303
  error estimate for blocks of size 2^( 5) =       0.000456766788
  error estimate for blocks of size 2^( 6) =       0.000462691484
  error estimate for blocks of size 2^( 7) =       0.000465963608

      target function =                  N/A
              le_mean =     -16.906149638560
             les_mean =     286.153799887030
             stat err =       0.000458345796
             autocorr =       1.250837053252
              std dev =       0.579572647388
             le_variance =       0.335904453600

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335939953039
                                         uncertainty =       0.005662521125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335939953039
                                         uncertainty =       0.005662521125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409819592
  error estimate for blocks of size 2^( 2) =       0.000422333337
  error estimate for blocks of size 2^( 3) =       0.000435183664
  error estimate for blocks of size 2^( 4) =       0.000447961126
  error estimate for blocks of size 2^( 5) =       0.000456766628
  error estimate for blocks of size 2^( 6) =       0.000462691360
  error estimate for blocks of size 2^( 7) =       0.000465963448

      target function =                  N/A
              le_mean =     -16.906149646076
             les_mean =     286.153799884238
             stat err =       0.000458345640
             autocorr =       1.250837162520
              std dev =       0.579572425729
             le_variance =       0.335904196666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335940082205
                                         uncertainty =       0.005662529326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335940082205
                                         uncertainty =       0.005662529326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409819671
  error estimate for blocks of size 2^( 2) =       0.000422333414
  error estimate for blocks of size 2^( 3) =       0.000435183742
  error estimate for blocks of size 2^( 4) =       0.000447961215
  error estimate for blocks of size 2^( 5) =       0.000456766708
  error estimate for blocks of size 2^( 6) =       0.000462691422
  error estimate for blocks of size 2^( 7) =       0.000465963529

      target function =                  N/A
              le_mean =     -16.906149642342
             les_mean =     286.153799887195
             stat err =       0.000458345719
             autocorr =       1.250837107499
              std dev =       0.579572537204
             le_variance =       0.335904325881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335940193933
                                         uncertainty =       0.005662536544

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335940193933
                                         uncertainty =       0.005662536544

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409819739
  error estimate for blocks of size 2^( 2) =       0.000422333480
  error estimate for blocks of size 2^( 3) =       0.000435183809
  error estimate for blocks of size 2^( 4) =       0.000447961292
  error estimate for blocks of size 2^( 5) =       0.000456766778
  error estimate for blocks of size 2^( 6) =       0.000462691476
  error estimate for blocks of size 2^( 7) =       0.000465963598

      target function =                  N/A
              le_mean =     -16.906149639033
             les_mean =     286.153799887078
             stat err =       0.000458345786
             autocorr =       1.250837060023
              std dev =       0.579572633632
             le_variance =       0.335904437655


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906149638560        initial
     6.1035e+01     6.1035e+02             3.9309e-06       -16.906149646076  <--
     2.4414e+02     2.4414e+03             9.8337e-07       -16.906149642342
     9.7656e+02     9.7656e+03             2.4588e-07       -16.906149639033

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 2.9459e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.122454e-01 1 1  ON 0
 uu_1                 1.443545e-01 1 1  ON 1
 uu_2                 4.228196e-02 1 1  ON 2
 uu_3                -2.087022e-02 1 1  ON 3
 uu_4                -6.736567e-02 1 1  ON 4
 uu_5                -1.039153e-01 1 1  ON 5
 uu_6                -1.333388e-01 1 1  ON 6
 uu_7                -1.493105e-01 1 1  ON 7
 uu_8                -1.427729e-01 1 1  ON 8
 uu_9                -1.123090e-01 1 1  ON 9
 ud_0                 4.541851e-01 1 1  ON 10
 ud_1                 1.880608e-01 1 1  ON 11
 ud_2                 6.717206e-02 1 1  ON 12
 ud_3                -4.484431e-03 1 1  ON 13
 ud_4                -6.219466e-02 1 1  ON 14
 ud_5                -1.047605e-01 1 1  ON 15
 ud_6                -1.335859e-01 1 1  ON 16
 ud_7                -1.510334e-01 1 1  ON 17
 ud_8                -1.519835e-01 1 1  ON 18
 ud_9                -1.432325e-01 1 1  ON 19
 eO_0                -7.497445e-01 1 1  ON 20
 eO_1                -4.277879e-01 1 1  ON 21
 eO_2                -1.252570e-02 1 1  ON 22
 eO_3                 3.045172e-01 1 1  ON 23
 eO_4                 5.326212e-01 1 1  ON 24
 eO_5                 4.975285e-01 1 1  ON 25
 eO_6                 2.673124e-01 1 1  ON 26
 eO_7                -4.317343e-02 1 1  ON 27
 eO_8                -2.433002e-01 1 1  ON 28
 eO_9                -1.175168e-01 1 1  ON 29
eH1_0                -2.674613e-01 1 1  ON 30
eH1_1                -1.613066e-01 1 1  ON 31
eH1_2                -1.120548e-01 1 1  ON 32
eH1_3                -5.627789e-02 1 1  ON 33
eH1_4                -6.258430e-03 1 1  ON 34
eH1_5                 3.022778e-02 1 1  ON 35
eH1_6                 9.396332e-02 1 1  ON 36
eH1_7                 1.615170e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119282e-01 1 1  ON 39
eH2_0                -2.646149e-01 1 1  ON 40
eH2_1                -1.588808e-01 1 1  ON 41
eH2_2                -1.095257e-01 1 1  ON 42
eH2_3                -5.393637e-02 1 1  ON 43
eH2_4                -3.654618e-03 1 1  ON 44
eH2_5                 3.433089e-02 1 1  ON 45
eH2_6                 9.741168e-02 1 1  ON 46
eH2_7                 1.616760e-01 1 1  ON 47
eH2_8                 2.044961e-01 1 1  ON 48
eH2_9                 1.028408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5405e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9643
    reference variance = 0.207378
====================================================
  Execution time = 2.2757e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4445e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5457e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344497401214
                                         uncertainty =       0.007520627353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344497401214
                                         uncertainty =       0.007520627353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415002416
  error estimate for blocks of size 2^( 2) =       0.000427516845
  error estimate for blocks of size 2^( 3) =       0.000440637990
  error estimate for blocks of size 2^( 4) =       0.000452867276
  error estimate for blocks of size 2^( 5) =       0.000463702063
  error estimate for blocks of size 2^( 6) =       0.000470758247
  error estimate for blocks of size 2^( 7) =       0.000479230006

      target function =                  N/A
              le_mean =     -16.906695260637
             les_mean =     286.180798474405
             stat err =       0.000466639398
             autocorr =       1.264333241196
              std dev =       0.586902045126
             le_variance =       0.344454010573


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690669526064e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906695260637       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906695285415       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906695316676       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906695325089       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906695311923       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906695302187       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906695298737       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906695301013       residual = 3.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.396684e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906695260637       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906695266898       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906695274819       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906695276996       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906695273732       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906695271122       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906695270216       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906695270748       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.520407e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906695260637       residual = 7.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906695262207       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906695264194       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906695264743       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906695263929       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906695263265       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906695263036       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906695263166       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 8.819302e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8310e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.122429e-01 1 1  ON 0
 uu_1                 1.443546e-01 1 1  ON 1
 uu_2                 4.228184e-02 1 1  ON 2
 uu_3                -2.086921e-02 1 1  ON 3
 uu_4                -6.736582e-02 1 1  ON 4
 uu_5                -1.039159e-01 1 1  ON 5
 uu_6                -1.333382e-01 1 1  ON 6
 uu_7                -1.493112e-01 1 1  ON 7
 uu_8                -1.427733e-01 1 1  ON 8
 uu_9                -1.123092e-01 1 1  ON 9
 ud_0                 4.541862e-01 1 1  ON 10
 ud_1                 1.880598e-01 1 1  ON 11
 ud_2                 6.717378e-02 1 1  ON 12
 ud_3                -4.484258e-03 1 1  ON 13
 ud_4                -6.219461e-02 1 1  ON 14
 ud_5                -1.047608e-01 1 1  ON 15
 ud_6                -1.335850e-01 1 1  ON 16
 ud_7                -1.510326e-01 1 1  ON 17
 ud_8                -1.519844e-01 1 1  ON 18
 ud_9                -1.432324e-01 1 1  ON 19
 eO_0                -7.497433e-01 1 1  ON 20
 eO_1                -4.277891e-01 1 1  ON 21
 eO_2                -1.252508e-02 1 1  ON 22
 eO_3                 3.045182e-01 1 1  ON 23
 eO_4                 5.326230e-01 1 1  ON 24
 eO_5                 4.975281e-01 1 1  ON 25
 eO_6                 2.673129e-01 1 1  ON 26
 eO_7                -4.317346e-02 1 1  ON 27
 eO_8                -2.433017e-01 1 1  ON 28
 eO_9                -1.175186e-01 1 1  ON 29
eH1_0                -2.674609e-01 1 1  ON 30
eH1_1                -1.613090e-01 1 1  ON 31
eH1_2                -1.120557e-01 1 1  ON 32
eH1_3                -5.628141e-02 1 1  ON 33
eH1_4                -6.257612e-03 1 1  ON 34
eH1_5                 3.022786e-02 1 1  ON 35
eH1_6                 9.396435e-02 1 1  ON 36
eH1_7                 1.615168e-01 1 1  ON 37
eH1_8                 2.035456e-01 1 1  ON 38
eH1_9                 1.119310e-01 1 1  ON 39
eH2_0                -2.646165e-01 1 1  ON 40
eH2_1                -1.588807e-01 1 1  ON 41
eH2_2                -1.095240e-01 1 1  ON 42
eH2_3                -5.393632e-02 1 1  ON 43
eH2_4                -3.655415e-03 1 1  ON 44
eH2_5                 3.432897e-02 1 1  ON 45
eH2_6                 9.741082e-02 1 1  ON 46
eH2_7                 1.616764e-01 1 1  ON 47
eH2_8                 2.044968e-01 1 1  ON 48
eH2_9                 1.028430e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.938
    reference variance = 0.317293
====================================================
  Execution time = 1.9857e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.5174e-01
  Total weights = 2.0000e+06
  Execution time = 1.8579e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351795044324
                                         uncertainty =       0.019108193996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351795044324
                                         uncertainty =       0.019108193996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419368085
  error estimate for blocks of size 2^( 2) =       0.000431652633
  error estimate for blocks of size 2^( 3) =       0.000443829566
  error estimate for blocks of size 2^( 4) =       0.000454608048
  error estimate for blocks of size 2^( 5) =       0.000464430541
  error estimate for blocks of size 2^( 6) =       0.000470049695
  error estimate for blocks of size 2^( 7) =       0.000475243300

      target function =                  N/A
              le_mean =     -16.906676922065
             les_mean =     286.187463552372
             stat err =       0.000466082896
             autocorr =       1.235195152387
              std dev =       0.593076033201
             le_variance =       0.351739181158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351790939285
                                         uncertainty =       0.019108126335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351790939285
                                         uncertainty =       0.019108126335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419365640
  error estimate for blocks of size 2^( 2) =       0.000431650362
  error estimate for blocks of size 2^( 3) =       0.000443827545
  error estimate for blocks of size 2^( 4) =       0.000454606216
  error estimate for blocks of size 2^( 5) =       0.000464428917
  error estimate for blocks of size 2^( 6) =       0.000470048271
  error estimate for blocks of size 2^( 7) =       0.000475241533

      target function =                  N/A
              le_mean =     -16.906676909317
             les_mean =     286.187459019963
             stat err =       0.000466081234
             autocorr =       1.235200748512
              std dev =       0.593072575488
             le_variance =       0.351735079796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351793002843
                                         uncertainty =       0.019108166313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351793002843
                                         uncertainty =       0.019108166313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419366869
  error estimate for blocks of size 2^( 2) =       0.000431651505
  error estimate for blocks of size 2^( 3) =       0.000443828564
  error estimate for blocks of size 2^( 4) =       0.000454607142
  error estimate for blocks of size 2^( 5) =       0.000464429742
  error estimate for blocks of size 2^( 6) =       0.000470048996
  error estimate for blocks of size 2^( 7) =       0.000475242426

      target function =                  N/A
              le_mean =     -16.906676915627
             les_mean =     286.187461295073
             stat err =       0.000466082076
             autocorr =       1.235197972460
              std dev =       0.593074313669
             le_variance =       0.351737141535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351794789427
                                         uncertainty =       0.019108190738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351794789427
                                         uncertainty =       0.019108190738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419367933
  error estimate for blocks of size 2^( 2) =       0.000431652492
  error estimate for blocks of size 2^( 3) =       0.000443829441
  error estimate for blocks of size 2^( 4) =       0.000454607935
  error estimate for blocks of size 2^( 5) =       0.000464430441
  error estimate for blocks of size 2^( 6) =       0.000470049608
  error estimate for blocks of size 2^( 7) =       0.000475243191

      target function =                  N/A
              le_mean =     -16.906676921246
             les_mean =     286.187463270010
             stat err =       0.000466082794
             autocorr =       1.235195505576
              std dev =       0.593075818504
             le_variance =       0.351738926494


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906676922065        initial  <--
     1.5259e+01     1.5259e+02             1.3967e-05       -16.906676909317
     6.1035e+01     6.1035e+02             3.5204e-06       -16.906676915627
     2.4414e+02     2.4414e+03             8.8193e-07       -16.906676921246

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2044
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.122454e-01 1 1  ON 0
 uu_1                 1.443545e-01 1 1  ON 1
 uu_2                 4.228196e-02 1 1  ON 2
 uu_3                -2.087022e-02 1 1  ON 3
 uu_4                -6.736567e-02 1 1  ON 4
 uu_5                -1.039153e-01 1 1  ON 5
 uu_6                -1.333388e-01 1 1  ON 6
 uu_7                -1.493105e-01 1 1  ON 7
 uu_8                -1.427729e-01 1 1  ON 8
 uu_9                -1.123090e-01 1 1  ON 9
 ud_0                 4.541851e-01 1 1  ON 10
 ud_1                 1.880608e-01 1 1  ON 11
 ud_2                 6.717206e-02 1 1  ON 12
 ud_3                -4.484431e-03 1 1  ON 13
 ud_4                -6.219466e-02 1 1  ON 14
 ud_5                -1.047605e-01 1 1  ON 15
 ud_6                -1.335859e-01 1 1  ON 16
 ud_7                -1.510334e-01 1 1  ON 17
 ud_8                -1.519835e-01 1 1  ON 18
 ud_9                -1.432325e-01 1 1  ON 19
 eO_0                -7.497445e-01 1 1  ON 20
 eO_1                -4.277879e-01 1 1  ON 21
 eO_2                -1.252570e-02 1 1  ON 22
 eO_3                 3.045172e-01 1 1  ON 23
 eO_4                 5.326212e-01 1 1  ON 24
 eO_5                 4.975285e-01 1 1  ON 25
 eO_6                 2.673124e-01 1 1  ON 26
 eO_7                -4.317343e-02 1 1  ON 27
 eO_8                -2.433002e-01 1 1  ON 28
 eO_9                -1.175168e-01 1 1  ON 29
eH1_0                -2.674613e-01 1 1  ON 30
eH1_1                -1.613066e-01 1 1  ON 31
eH1_2                -1.120548e-01 1 1  ON 32
eH1_3                -5.627789e-02 1 1  ON 33
eH1_4                -6.258430e-03 1 1  ON 34
eH1_5                 3.022778e-02 1 1  ON 35
eH1_6                 9.396332e-02 1 1  ON 36
eH1_7                 1.615170e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119282e-01 1 1  ON 39
eH2_0                -2.646149e-01 1 1  ON 40
eH2_1                -1.588808e-01 1 1  ON 41
eH2_2                -1.095257e-01 1 1  ON 42
eH2_3                -5.393637e-02 1 1  ON 43
eH2_4                -3.654618e-03 1 1  ON 44
eH2_5                 3.433089e-02 1 1  ON 45
eH2_6                 9.741168e-02 1 1  ON 46
eH2_7                 1.616760e-01 1 1  ON 47
eH2_8                 2.044961e-01 1 1  ON 48
eH2_9                 1.028408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7521e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6922e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.7953
    reference variance = 0.36999
====================================================
  Execution time = 2.0425e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3919e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4631e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220169401
                                         uncertainty =       0.005890970700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339220169401
                                         uncertainty =       0.005890970700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411817681
  error estimate for blocks of size 2^( 2) =       0.000424340607
  error estimate for blocks of size 2^( 3) =       0.000436662245
  error estimate for blocks of size 2^( 4) =       0.000448220506
  error estimate for blocks of size 2^( 5) =       0.000458136791
  error estimate for blocks of size 2^( 6) =       0.000466398580
  error estimate for blocks of size 2^( 7) =       0.000472033142

      target function =                  N/A
              le_mean =     -16.905734526954
             les_mean =     286.143047331553
             stat err =       0.000461197255
             autocorr =       1.254190332948
              std dev =       0.582398150147
             le_variance =       0.339187605295


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690573452695e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905734526954       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905734531963       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905734535735       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905734539995       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905734542291       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905734543228       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905734542847       residual = 8.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.223409e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905734526954       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905734528207       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905734529152       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905734530218       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905734530793       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905734531028       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905734530932       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 3.064211e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905734526954       residual = 4.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905734527268       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905734527504       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905734527770       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905734527914       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905734527974       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905734527949       residual = 8.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 7.664096e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.369173 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5894e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.122452e-01 1 1  ON 0
 uu_1                 1.443546e-01 1 1  ON 1
 uu_2                 4.228188e-02 1 1  ON 2
 uu_3                -2.087024e-02 1 1  ON 3
 uu_4                -6.736578e-02 1 1  ON 4
 uu_5                -1.039150e-01 1 1  ON 5
 uu_6                -1.333388e-01 1 1  ON 6
 uu_7                -1.493104e-01 1 1  ON 7
 uu_8                -1.427730e-01 1 1  ON 8
 uu_9                -1.123091e-01 1 1  ON 9
 ud_0                 4.541851e-01 1 1  ON 10
 ud_1                 1.880611e-01 1 1  ON 11
 ud_2                 6.717209e-02 1 1  ON 12
 ud_3                -4.484238e-03 1 1  ON 13
 ud_4                -6.219471e-02 1 1  ON 14
 ud_5                -1.047604e-01 1 1  ON 15
 ud_6                -1.335860e-01 1 1  ON 16
 ud_7                -1.510334e-01 1 1  ON 17
 ud_8                -1.519838e-01 1 1  ON 18
 ud_9                -1.432327e-01 1 1  ON 19
 eO_0                -7.497444e-01 1 1  ON 20
 eO_1                -4.277880e-01 1 1  ON 21
 eO_2                -1.252547e-02 1 1  ON 22
 eO_3                 3.045173e-01 1 1  ON 23
 eO_4                 5.326213e-01 1 1  ON 24
 eO_5                 4.975285e-01 1 1  ON 25
 eO_6                 2.673123e-01 1 1  ON 26
 eO_7                -4.317346e-02 1 1  ON 27
 eO_8                -2.433004e-01 1 1  ON 28
 eO_9                -1.175170e-01 1 1  ON 29
eH1_0                -2.674615e-01 1 1  ON 30
eH1_1                -1.613068e-01 1 1  ON 31
eH1_2                -1.120547e-01 1 1  ON 32
eH1_3                -5.627802e-02 1 1  ON 33
eH1_4                -6.258259e-03 1 1  ON 34
eH1_5                 3.022784e-02 1 1  ON 35
eH1_6                 9.396320e-02 1 1  ON 36
eH1_7                 1.615168e-01 1 1  ON 37
eH1_8                 2.035448e-01 1 1  ON 38
eH1_9                 1.119284e-01 1 1  ON 39
eH2_0                -2.646152e-01 1 1  ON 40
eH2_1                -1.588808e-01 1 1  ON 41
eH2_2                -1.095257e-01 1 1  ON 42
eH2_3                -5.393629e-02 1 1  ON 43
eH2_4                -3.654509e-03 1 1  ON 44
eH2_5                 3.433061e-02 1 1  ON 45
eH2_6                 9.741167e-02 1 1  ON 46
eH2_7                 1.616761e-01 1 1  ON 47
eH2_8                 2.044962e-01 1 1  ON 48
eH2_9                 1.028410e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9181
    reference variance = 0.190533
====================================================
  Execution time = 2.0204e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3889e-01
  Total weights = 2.0000e+06
  Execution time = 1.8893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338500138422
                                         uncertainty =       0.003528539460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338500138422
                                         uncertainty =       0.003528539460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411637805
  error estimate for blocks of size 2^( 2) =       0.000424427007
  error estimate for blocks of size 2^( 3) =       0.000437377987
  error estimate for blocks of size 2^( 4) =       0.000449302302
  error estimate for blocks of size 2^( 5) =       0.000459414217
  error estimate for blocks of size 2^( 6) =       0.000467375863
  error estimate for blocks of size 2^( 7) =       0.000471073072

      target function =                  N/A
              le_mean =     -16.906351671578
             les_mean =     286.163618037950
             stat err =       0.000461791363
             autocorr =       1.258522853022
              std dev =       0.582143766018
             le_variance =       0.338891364314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338499755624
                                         uncertainty =       0.003528540582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338499755624
                                         uncertainty =       0.003528540582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411637571
  error estimate for blocks of size 2^( 2) =       0.000424426775
  error estimate for blocks of size 2^( 3) =       0.000437377751
  error estimate for blocks of size 2^( 4) =       0.000449302058
  error estimate for blocks of size 2^( 5) =       0.000459413974
  error estimate for blocks of size 2^( 6) =       0.000467375632
  error estimate for blocks of size 2^( 7) =       0.000471072818

      target function =                  N/A
              le_mean =     -16.906351667006
             les_mean =     286.163617499157
             stat err =       0.000461791120
             autocorr =       1.258522955193
              std dev =       0.582143436051
             le_variance =       0.338890980137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338499946666
                                         uncertainty =       0.003528540025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338499946666
                                         uncertainty =       0.003528540025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411637688
  error estimate for blocks of size 2^( 2) =       0.000424426891
  error estimate for blocks of size 2^( 3) =       0.000437377868
  error estimate for blocks of size 2^( 4) =       0.000449302180
  error estimate for blocks of size 2^( 5) =       0.000459414095
  error estimate for blocks of size 2^( 6) =       0.000467375747
  error estimate for blocks of size 2^( 7) =       0.000471072945

      target function =                  N/A
              le_mean =     -16.906351669280
             les_mean =     286.163617767793
             stat err =       0.000461791242
             autocorr =       1.258522904110
              std dev =       0.582143600727
             le_variance =       0.338891171867

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338500114440
                                         uncertainty =       0.003528539531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338500114440
                                         uncertainty =       0.003528539531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411637790
  error estimate for blocks of size 2^( 2) =       0.000424426993
  error estimate for blocks of size 2^( 3) =       0.000437377972
  error estimate for blocks of size 2^( 4) =       0.000449302287
  error estimate for blocks of size 2^( 5) =       0.000459414202
  error estimate for blocks of size 2^( 6) =       0.000467375848
  error estimate for blocks of size 2^( 7) =       0.000471073056

      target function =                  N/A
              le_mean =     -16.906351671291
             les_mean =     286.163618004151
             stat err =       0.000461791348
             autocorr =       1.258522859417
              std dev =       0.582143745346
             le_variance =       0.338891340246


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906351671578        initial  <--
     1.5259e+02     1.5259e+03             1.2234e-06       -16.906351667006
     6.1035e+02     6.1035e+03             3.0642e-07       -16.906351669280
     2.4414e+03     2.4414e+04             7.6641e-08       -16.906351671291

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6111
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.122454e-01 1 1  ON 0
 uu_1                 1.443545e-01 1 1  ON 1
 uu_2                 4.228196e-02 1 1  ON 2
 uu_3                -2.087022e-02 1 1  ON 3
 uu_4                -6.736567e-02 1 1  ON 4
 uu_5                -1.039153e-01 1 1  ON 5
 uu_6                -1.333388e-01 1 1  ON 6
 uu_7                -1.493105e-01 1 1  ON 7
 uu_8                -1.427729e-01 1 1  ON 8
 uu_9                -1.123090e-01 1 1  ON 9
 ud_0                 4.541851e-01 1 1  ON 10
 ud_1                 1.880608e-01 1 1  ON 11
 ud_2                 6.717206e-02 1 1  ON 12
 ud_3                -4.484431e-03 1 1  ON 13
 ud_4                -6.219466e-02 1 1  ON 14
 ud_5                -1.047605e-01 1 1  ON 15
 ud_6                -1.335859e-01 1 1  ON 16
 ud_7                -1.510334e-01 1 1  ON 17
 ud_8                -1.519835e-01 1 1  ON 18
 ud_9                -1.432325e-01 1 1  ON 19
 eO_0                -7.497445e-01 1 1  ON 20
 eO_1                -4.277879e-01 1 1  ON 21
 eO_2                -1.252570e-02 1 1  ON 22
 eO_3                 3.045172e-01 1 1  ON 23
 eO_4                 5.326212e-01 1 1  ON 24
 eO_5                 4.975285e-01 1 1  ON 25
 eO_6                 2.673124e-01 1 1  ON 26
 eO_7                -4.317343e-02 1 1  ON 27
 eO_8                -2.433002e-01 1 1  ON 28
 eO_9                -1.175168e-01 1 1  ON 29
eH1_0                -2.674613e-01 1 1  ON 30
eH1_1                -1.613066e-01 1 1  ON 31
eH1_2                -1.120548e-01 1 1  ON 32
eH1_3                -5.627789e-02 1 1  ON 33
eH1_4                -6.258430e-03 1 1  ON 34
eH1_5                 3.022778e-02 1 1  ON 35
eH1_6                 9.396332e-02 1 1  ON 36
eH1_7                 1.615170e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119282e-01 1 1  ON 39
eH2_0                -2.646149e-01 1 1  ON 40
eH2_1                -1.588808e-01 1 1  ON 41
eH2_2                -1.095257e-01 1 1  ON 42
eH2_3                -5.393637e-02 1 1  ON 43
eH2_4                -3.654618e-03 1 1  ON 44
eH2_5                 3.433089e-02 1 1  ON 45
eH2_6                 9.741168e-02 1 1  ON 46
eH2_7                 1.616760e-01 1 1  ON 47
eH2_8                 2.044961e-01 1 1  ON 48
eH2_9                 1.028408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5511e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.8795
    reference variance = 0.217063
====================================================
  Execution time = 2.0222e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3462e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334677878521
                                         uncertainty =       0.002903999143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334677878521
                                         uncertainty =       0.002903999143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409036072
  error estimate for blocks of size 2^( 2) =       0.000421748689
  error estimate for blocks of size 2^( 3) =       0.000434764044
  error estimate for blocks of size 2^( 4) =       0.000446562253
  error estimate for blocks of size 2^( 5) =       0.000456901997
  error estimate for blocks of size 2^( 6) =       0.000465228942
  error estimate for blocks of size 2^( 7) =       0.000468045140

      target function =                  N/A
              le_mean =     -16.907103126217
             les_mean =     286.184756969583
             stat err =       0.000459184583
             autocorr =       1.260234539432
              std dev =       0.578464360496
             le_variance =       0.334621016364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690710312622e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907103126217       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907103126331       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907103126487       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907103126582       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907103126780       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907103126860       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907103126823       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907103126804       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.658668e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907103126217       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907103126245       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907103126284       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907103126309       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907103126358       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907103126375       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907103126371       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907103126361       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 4.146742e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907103126217       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907103126224       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907103126234       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907103126240       residual = 5.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907103126253       residual = 3.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907103126259       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907103126259       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907103126254       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 1.036690e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.371775 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5765e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.122453e-01 1 1  ON 0
 uu_1                 1.443545e-01 1 1  ON 1
 uu_2                 4.228197e-02 1 1  ON 2
 uu_3                -2.087022e-02 1 1  ON 3
 uu_4                -6.736567e-02 1 1  ON 4
 uu_5                -1.039153e-01 1 1  ON 5
 uu_6                -1.333388e-01 1 1  ON 6
 uu_7                -1.493105e-01 1 1  ON 7
 uu_8                -1.427729e-01 1 1  ON 8
 uu_9                -1.123090e-01 1 1  ON 9
 ud_0                 4.541851e-01 1 1  ON 10
 ud_1                 1.880608e-01 1 1  ON 11
 ud_2                 6.717206e-02 1 1  ON 12
 ud_3                -4.484422e-03 1 1  ON 13
 ud_4                -6.219466e-02 1 1  ON 14
 ud_5                -1.047605e-01 1 1  ON 15
 ud_6                -1.335859e-01 1 1  ON 16
 ud_7                -1.510334e-01 1 1  ON 17
 ud_8                -1.519835e-01 1 1  ON 18
 ud_9                -1.432325e-01 1 1  ON 19
 eO_0                -7.497445e-01 1 1  ON 20
 eO_1                -4.277879e-01 1 1  ON 21
 eO_2                -1.252569e-02 1 1  ON 22
 eO_3                 3.045172e-01 1 1  ON 23
 eO_4                 5.326212e-01 1 1  ON 24
 eO_5                 4.975285e-01 1 1  ON 25
 eO_6                 2.673124e-01 1 1  ON 26
 eO_7                -4.317343e-02 1 1  ON 27
 eO_8                -2.433003e-01 1 1  ON 28
 eO_9                -1.175168e-01 1 1  ON 29
eH1_0                -2.674613e-01 1 1  ON 30
eH1_1                -1.613066e-01 1 1  ON 31
eH1_2                -1.120548e-01 1 1  ON 32
eH1_3                -5.627791e-02 1 1  ON 33
eH1_4                -6.258430e-03 1 1  ON 34
eH1_5                 3.022779e-02 1 1  ON 35
eH1_6                 9.396332e-02 1 1  ON 36
eH1_7                 1.615170e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119282e-01 1 1  ON 39
eH2_0                -2.646149e-01 1 1  ON 40
eH2_1                -1.588807e-01 1 1  ON 41
eH2_2                -1.095257e-01 1 1  ON 42
eH2_3                -5.393636e-02 1 1  ON 43
eH2_4                -3.654628e-03 1 1  ON 44
eH2_5                 3.433086e-02 1 1  ON 45
eH2_6                 9.741165e-02 1 1  ON 46
eH2_7                 1.616760e-01 1 1  ON 47
eH2_8                 2.044961e-01 1 1  ON 48
eH2_9                 1.028408e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9613
    reference variance = 0.198399
====================================================
  Execution time = 2.0215e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4240e-01
  Total weights = 2.0000e+06
  Execution time = 1.8544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342454752387
                                         uncertainty =       0.004040289007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342454752387
                                         uncertainty =       0.004040289007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413761176
  error estimate for blocks of size 2^( 2) =       0.000426640228
  error estimate for blocks of size 2^( 3) =       0.000439638986
  error estimate for blocks of size 2^( 4) =       0.000452066833
  error estimate for blocks of size 2^( 5) =       0.000464144204
  error estimate for blocks of size 2^( 6) =       0.000472862447
  error estimate for blocks of size 2^( 7) =       0.000479322185

      target function =                  N/A
              le_mean =     -16.906120729181
             les_mean =     286.159314560367
             stat err =       0.000467098917
             autocorr =       1.274436629887
              std dev =       0.585146667011
             le_variance =       0.342396621914

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342454742901
                                         uncertainty =       0.004040288128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342454742901
                                         uncertainty =       0.004040288128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413761170
  error estimate for blocks of size 2^( 2) =       0.000426640221
  error estimate for blocks of size 2^( 3) =       0.000439638979
  error estimate for blocks of size 2^( 4) =       0.000452066825
  error estimate for blocks of size 2^( 5) =       0.000464144196
  error estimate for blocks of size 2^( 6) =       0.000472862441
  error estimate for blocks of size 2^( 7) =       0.000479322180

      target function =                  N/A
              le_mean =     -16.906120730196
             les_mean =     286.159314585119
             stat err =       0.000467098910
             autocorr =       1.274436627709
              std dev =       0.585146658853
             le_variance =       0.342396612367

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342454747644
                                         uncertainty =       0.004040288567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342454747644
                                         uncertainty =       0.004040288567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413761173
  error estimate for blocks of size 2^( 2) =       0.000426640225
  error estimate for blocks of size 2^( 3) =       0.000439638983
  error estimate for blocks of size 2^( 4) =       0.000452066829
  error estimate for blocks of size 2^( 5) =       0.000464144200
  error estimate for blocks of size 2^( 6) =       0.000472862444
  error estimate for blocks of size 2^( 7) =       0.000479322183

      target function =                  N/A
              le_mean =     -16.906120729689
             les_mean =     286.159314572748
             stat err =       0.000467098914
             autocorr =       1.274436628802
              std dev =       0.585146662932
             le_variance =       0.342396617141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342454751794
                                         uncertainty =       0.004040288952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342454751794
                                         uncertainty =       0.004040288952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413761176
  error estimate for blocks of size 2^( 2) =       0.000426640227
  error estimate for blocks of size 2^( 3) =       0.000439638986
  error estimate for blocks of size 2^( 4) =       0.000452066832
  error estimate for blocks of size 2^( 5) =       0.000464144203
  error estimate for blocks of size 2^( 6) =       0.000472862447
  error estimate for blocks of size 2^( 7) =       0.000479322185

      target function =                  N/A
              le_mean =     -16.906120729245
             les_mean =     286.159314561914
             stat err =       0.000467098917
             autocorr =       1.274436629758
              std dev =       0.585146666501
             le_variance =       0.342396621317


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906120729181        initial
     1.5259e+03     1.5259e+04             1.6587e-07       -16.906120730196  <--
     6.1035e+03     6.1035e+04             4.1467e-08       -16.906120729689
     2.4414e+04     2.4414e+05             1.0367e-08       -16.906120729245

*****************************************************************************
Applying the update for shift_i =   1.5259e+03     and shift_s =   1.5259e+04
*****************************************************************************

  Execution time = 2.9576e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.122453e-01 1 1  ON 0
 uu_1                 1.443545e-01 1 1  ON 1
 uu_2                 4.228202e-02 1 1  ON 2
 uu_3                -2.087022e-02 1 1  ON 3
 uu_4                -6.736566e-02 1 1  ON 4
 uu_5                -1.039152e-01 1 1  ON 5
 uu_6                -1.333388e-01 1 1  ON 6
 uu_7                -1.493105e-01 1 1  ON 7
 uu_8                -1.427730e-01 1 1  ON 8
 uu_9                -1.123091e-01 1 1  ON 9
 ud_0                 4.541851e-01 1 1  ON 10
 ud_1                 1.880609e-01 1 1  ON 11
 ud_2                 6.717208e-02 1 1  ON 12
 ud_3                -4.484393e-03 1 1  ON 13
 ud_4                -6.219465e-02 1 1  ON 14
 ud_5                -1.047604e-01 1 1  ON 15
 ud_6                -1.335858e-01 1 1  ON 16
 ud_7                -1.510334e-01 1 1  ON 17
 ud_8                -1.519836e-01 1 1  ON 18
 ud_9                -1.432326e-01 1 1  ON 19
 eO_0                -7.497445e-01 1 1  ON 20
 eO_1                -4.277879e-01 1 1  ON 21
 eO_2                -1.252567e-02 1 1  ON 22
 eO_3                 3.045172e-01 1 1  ON 23
 eO_4                 5.326212e-01 1 1  ON 24
 eO_5                 4.975285e-01 1 1  ON 25
 eO_6                 2.673124e-01 1 1  ON 26
 eO_7                -4.317343e-02 1 1  ON 27
 eO_8                -2.433003e-01 1 1  ON 28
 eO_9                -1.175169e-01 1 1  ON 29
eH1_0                -2.674613e-01 1 1  ON 30
eH1_1                -1.613066e-01 1 1  ON 31
eH1_2                -1.120548e-01 1 1  ON 32
eH1_3                -5.627797e-02 1 1  ON 33
eH1_4                -6.258430e-03 1 1  ON 34
eH1_5                 3.022781e-02 1 1  ON 35
eH1_6                 9.396331e-02 1 1  ON 36
eH1_7                 1.615170e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119282e-01 1 1  ON 39
eH2_0                -2.646149e-01 1 1  ON 40
eH2_1                -1.588807e-01 1 1  ON 41
eH2_2                -1.095257e-01 1 1  ON 42
eH2_3                -5.393633e-02 1 1  ON 43
eH2_4                -3.654657e-03 1 1  ON 44
eH2_5                 3.433078e-02 1 1  ON 45
eH2_6                 9.741158e-02 1 1  ON 46
eH2_7                 1.616760e-01 1 1  ON 47
eH2_8                 2.044962e-01 1 1  ON 48
eH2_9                 1.028409e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5347e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8509
    reference variance = 0.35478
====================================================
  Execution time = 2.0387e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3985e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339766624791
                                         uncertainty =       0.004514330704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339766624791
                                         uncertainty =       0.004514330704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412222399
  error estimate for blocks of size 2^( 2) =       0.000425322524
  error estimate for blocks of size 2^( 3) =       0.000437894444
  error estimate for blocks of size 2^( 4) =       0.000450237063
  error estimate for blocks of size 2^( 5) =       0.000459464513
  error estimate for blocks of size 2^( 6) =       0.000466914849
  error estimate for blocks of size 2^( 7) =       0.000471769982

      target function =                  N/A
              le_mean =     -16.907004967355
             les_mean =     286.186671409418
             stat err =       0.000462096602
             autocorr =       1.256615395331
              std dev =       0.582970507992
             le_variance =       0.339854613189


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690700496735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907004967355       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907004968540       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907004969134       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907004968344       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907004967105       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907004968917       residual = 5.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907004969122       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.662805e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907004967355       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907004967651       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907004967800       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907004967603       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907004967292       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907004967745       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907004967792       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.165820e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907004967355       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907004967429       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907004967466       residual = 9.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907004967417       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907004967339       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907004967455       residual = 5.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907004967464       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 2.914624e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.374023 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5966e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.122452e-01 1 1  ON 0
 uu_1                 1.443545e-01 1 1  ON 1
 uu_2                 4.228204e-02 1 1  ON 2
 uu_3                -2.087023e-02 1 1  ON 3
 uu_4                -6.736565e-02 1 1  ON 4
 uu_5                -1.039152e-01 1 1  ON 5
 uu_6                -1.333388e-01 1 1  ON 6
 uu_7                -1.493105e-01 1 1  ON 7
 uu_8                -1.427730e-01 1 1  ON 8
 uu_9                -1.123091e-01 1 1  ON 9
 ud_0                 4.541851e-01 1 1  ON 10
 ud_1                 1.880608e-01 1 1  ON 11
 ud_2                 6.717207e-02 1 1  ON 12
 ud_3                -4.484365e-03 1 1  ON 13
 ud_4                -6.219472e-02 1 1  ON 14
 ud_5                -1.047604e-01 1 1  ON 15
 ud_6                -1.335858e-01 1 1  ON 16
 ud_7                -1.510334e-01 1 1  ON 17
 ud_8                -1.519836e-01 1 1  ON 18
 ud_9                -1.432325e-01 1 1  ON 19
 eO_0                -7.497445e-01 1 1  ON 20
 eO_1                -4.277879e-01 1 1  ON 21
 eO_2                -1.252560e-02 1 1  ON 22
 eO_3                 3.045172e-01 1 1  ON 23
 eO_4                 5.326212e-01 1 1  ON 24
 eO_5                 4.975285e-01 1 1  ON 25
 eO_6                 2.673124e-01 1 1  ON 26
 eO_7                -4.317346e-02 1 1  ON 27
 eO_8                -2.433004e-01 1 1  ON 28
 eO_9                -1.175170e-01 1 1  ON 29
eH1_0                -2.674614e-01 1 1  ON 30
eH1_1                -1.613066e-01 1 1  ON 31
eH1_2                -1.120548e-01 1 1  ON 32
eH1_3                -5.627802e-02 1 1  ON 33
eH1_4                -6.258449e-03 1 1  ON 34
eH1_5                 3.022777e-02 1 1  ON 35
eH1_6                 9.396325e-02 1 1  ON 36
eH1_7                 1.615170e-01 1 1  ON 37
eH1_8                 2.035447e-01 1 1  ON 38
eH1_9                 1.119283e-01 1 1  ON 39
eH2_0                -2.646150e-01 1 1  ON 40
eH2_1                -1.588807e-01 1 1  ON 41
eH2_2                -1.095257e-01 1 1  ON 42
eH2_3                -5.393636e-02 1 1  ON 43
eH2_4                -3.654743e-03 1 1  ON 44
eH2_5                 3.433074e-02 1 1  ON 45
eH2_6                 9.741159e-02 1 1  ON 46
eH2_7                 1.616761e-01 1 1  ON 47
eH2_8                 2.044962e-01 1 1  ON 48
eH2_9                 1.028410e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.8945
    reference variance = 0.274428
====================================================
  Execution time = 1.9900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4971e-01
  Total weights = 2.0000e+06
  Execution time = 1.8548e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349728879552
                                         uncertainty =       0.006164757737

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349728879552
                                         uncertainty =       0.006164757737

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418156715
  error estimate for blocks of size 2^( 2) =       0.000430719331
  error estimate for blocks of size 2^( 3) =       0.000443456780
  error estimate for blocks of size 2^( 4) =       0.000454656818
  error estimate for blocks of size 2^( 5) =       0.000463797267
  error estimate for blocks of size 2^( 6) =       0.000469955227
  error estimate for blocks of size 2^( 7) =       0.000475375205

      target function =                  N/A
              le_mean =     -16.906229700918
             les_mean =     286.170312601972
             stat err =       0.000465946129
             autocorr =       1.241633055815
              std dev =       0.591362897583
             le_variance =       0.349710076638

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349728798773
                                         uncertainty =       0.006164755420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349728798773
                                         uncertainty =       0.006164755420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418156667
  error estimate for blocks of size 2^( 2) =       0.000430719283
  error estimate for blocks of size 2^( 3) =       0.000443456734
  error estimate for blocks of size 2^( 4) =       0.000454656777
  error estimate for blocks of size 2^( 5) =       0.000463797231
  error estimate for blocks of size 2^( 6) =       0.000469955190
  error estimate for blocks of size 2^( 7) =       0.000475375169

      target function =                  N/A
              le_mean =     -16.906229702577
             les_mean =     286.170312577193
             stat err =       0.000465946092
             autocorr =       1.241633143213
              std dev =       0.591362829181
             le_variance =       0.349709995737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349728839170
                                         uncertainty =       0.006164756578

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349728839170
                                         uncertainty =       0.006164756578

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418156691
  error estimate for blocks of size 2^( 2) =       0.000430719307
  error estimate for blocks of size 2^( 3) =       0.000443456757
  error estimate for blocks of size 2^( 4) =       0.000454656798
  error estimate for blocks of size 2^( 5) =       0.000463797249
  error estimate for blocks of size 2^( 6) =       0.000469955209
  error estimate for blocks of size 2^( 7) =       0.000475375187

      target function =                  N/A
              le_mean =     -16.906229701748
             les_mean =     286.170312589607
             stat err =       0.000465946111
             autocorr =       1.241633099526
              std dev =       0.591362863388
             le_variance =       0.349710036195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349728874505
                                         uncertainty =       0.006164757592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349728874505
                                         uncertainty =       0.006164757592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418156712
  error estimate for blocks of size 2^( 2) =       0.000430719328
  error estimate for blocks of size 2^( 3) =       0.000443456777
  error estimate for blocks of size 2^( 4) =       0.000454656816
  error estimate for blocks of size 2^( 5) =       0.000463797265
  error estimate for blocks of size 2^( 6) =       0.000469955225
  error estimate for blocks of size 2^( 7) =       0.000475375203

      target function =                  N/A
              le_mean =     -16.906229701021
             les_mean =     286.170312600426
             stat err =       0.000465946127
             autocorr =       1.241633061284
              std dev =       0.591362893309
             le_variance =       0.349710071583


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906229700918        initial
     3.8147e+02     3.8147e+03             4.6628e-07       -16.906229702577  <--
     1.5259e+03     1.5259e+04             1.1658e-07       -16.906229701748
     6.1035e+03     6.1035e+04             2.9146e-08       -16.906229701021

*****************************************************************************
Applying the update for shift_i =   3.8147e+02     and shift_s =   3.8147e+03
*****************************************************************************

  Execution time = 2.9262e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.122449e-01 1 1  ON 0
 uu_1                 1.443545e-01 1 1  ON 1
 uu_2                 4.228211e-02 1 1  ON 2
 uu_3                -2.087025e-02 1 1  ON 3
 uu_4                -6.736564e-02 1 1  ON 4
 uu_5                -1.039152e-01 1 1  ON 5
 uu_6                -1.333387e-01 1 1  ON 6
 uu_7                -1.493106e-01 1 1  ON 7
 uu_8                -1.427731e-01 1 1  ON 8
 uu_9                -1.123091e-01 1 1  ON 9
 ud_0                 4.541852e-01 1 1  ON 10
 ud_1                 1.880608e-01 1 1  ON 11
 ud_2                 6.717204e-02 1 1  ON 12
 ud_3                -4.484279e-03 1 1  ON 13
 ud_4                -6.219493e-02 1 1  ON 14
 ud_5                -1.047604e-01 1 1  ON 15
 ud_6                -1.335856e-01 1 1  ON 16
 ud_7                -1.510335e-01 1 1  ON 17
 ud_8                -1.519835e-01 1 1  ON 18
 ud_9                -1.432324e-01 1 1  ON 19
 eO_0                -7.497445e-01 1 1  ON 20
 eO_1                -4.277878e-01 1 1  ON 21
 eO_2                -1.252539e-02 1 1  ON 22
 eO_3                 3.045174e-01 1 1  ON 23
 eO_4                 5.326212e-01 1 1  ON 24
 eO_5                 4.975285e-01 1 1  ON 25
 eO_6                 2.673124e-01 1 1  ON 26
 eO_7                -4.317355e-02 1 1  ON 27
 eO_8                -2.433005e-01 1 1  ON 28
 eO_9                -1.175171e-01 1 1  ON 29
eH1_0                -2.674615e-01 1 1  ON 30
eH1_1                -1.613066e-01 1 1  ON 31
eH1_2                -1.120547e-01 1 1  ON 32
eH1_3                -5.627818e-02 1 1  ON 33
eH1_4                -6.258506e-03 1 1  ON 34
eH1_5                 3.022766e-02 1 1  ON 35
eH1_6                 9.396308e-02 1 1  ON 36
eH1_7                 1.615170e-01 1 1  ON 37
eH1_8                 2.035448e-01 1 1  ON 38
eH1_9                 1.119287e-01 1 1  ON 39
eH2_0                -2.646152e-01 1 1  ON 40
eH2_1                -1.588807e-01 1 1  ON 41
eH2_2                -1.095257e-01 1 1  ON 42
eH2_3                -5.393644e-02 1 1  ON 43
eH2_4                -3.655000e-03 1 1  ON 44
eH2_5                 3.433061e-02 1 1  ON 45
eH2_6                 9.741163e-02 1 1  ON 46
eH2_7                 1.616762e-01 1 1  ON 47
eH2_8                 2.044964e-01 1 1  ON 48
eH2_9                 1.028413e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5235e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9219
    reference variance = 0.275651
====================================================
  Execution time = 2.0720e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3736e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337368555480
                                         uncertainty =       0.003948281450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337368555480
                                         uncertainty =       0.003948281450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410709136
  error estimate for blocks of size 2^( 2) =       0.000423271479
  error estimate for blocks of size 2^( 3) =       0.000435664790
  error estimate for blocks of size 2^( 4) =       0.000447561794
  error estimate for blocks of size 2^( 5) =       0.000458605900
  error estimate for blocks of size 2^( 6) =       0.000465527391
  error estimate for blocks of size 2^( 7) =       0.000470606026

      target function =                  N/A
              le_mean =     -16.906790073614
             les_mean =     286.176914412969
             stat err =       0.000460575278
             autocorr =       1.257571013892
              std dev =       0.580830429990
             le_variance =       0.337363988403


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690679007361e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906790073614       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906790079002       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906790075266       residual = 8.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906790079671       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906790078190       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906790077647       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906790076008       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906790077527       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 1.831694e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906790073614       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906790074963       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906790074027       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906790075130       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906790074759       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906790074622       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906790074210       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906790074589       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 4.580095e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906790073614       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906790073951       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906790073717       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906790073993       residual = 6.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906790073902       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906790073864       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906790073763       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906790073859       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.145077e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376708 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6163e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.122444e-01 1 1  ON 0
 uu_1                 1.443546e-01 1 1  ON 1
 uu_2                 4.228193e-02 1 1  ON 2
 uu_3                -2.087003e-02 1 1  ON 3
 uu_4                -6.736567e-02 1 1  ON 4
 uu_5                -1.039152e-01 1 1  ON 5
 uu_6                -1.333385e-01 1 1  ON 6
 uu_7                -1.493104e-01 1 1  ON 7
 uu_8                -1.427733e-01 1 1  ON 8
 uu_9                -1.123093e-01 1 1  ON 9
 ud_0                 4.541852e-01 1 1  ON 10
 ud_1                 1.880610e-01 1 1  ON 11
 ud_2                 6.717205e-02 1 1  ON 12
 ud_3                -4.484093e-03 1 1  ON 13
 ud_4                -6.219504e-02 1 1  ON 14
 ud_5                -1.047604e-01 1 1  ON 15
 ud_6                -1.335854e-01 1 1  ON 16
 ud_7                -1.510335e-01 1 1  ON 17
 ud_8                -1.519836e-01 1 1  ON 18
 ud_9                -1.432325e-01 1 1  ON 19
 eO_0                -7.497446e-01 1 1  ON 20
 eO_1                -4.277874e-01 1 1  ON 21
 eO_2                -1.252529e-02 1 1  ON 22
 eO_3                 3.045176e-01 1 1  ON 23
 eO_4                 5.326213e-01 1 1  ON 24
 eO_5                 4.975283e-01 1 1  ON 25
 eO_6                 2.673125e-01 1 1  ON 26
 eO_7                -4.317350e-02 1 1  ON 27
 eO_8                -2.433007e-01 1 1  ON 28
 eO_9                -1.175175e-01 1 1  ON 29
eH1_0                -2.674618e-01 1 1  ON 30
eH1_1                -1.613066e-01 1 1  ON 31
eH1_2                -1.120549e-01 1 1  ON 32
eH1_3                -5.627845e-02 1 1  ON 33
eH1_4                -6.258802e-03 1 1  ON 34
eH1_5                 3.022779e-02 1 1  ON 35
eH1_6                 9.396330e-02 1 1  ON 36
eH1_7                 1.615171e-01 1 1  ON 37
eH1_8                 2.035450e-01 1 1  ON 38
eH1_9                 1.119290e-01 1 1  ON 39
eH2_0                -2.646152e-01 1 1  ON 40
eH2_1                -1.588807e-01 1 1  ON 41
eH2_2                -1.095259e-01 1 1  ON 42
eH2_3                -5.393661e-02 1 1  ON 43
eH2_4                -3.654734e-03 1 1  ON 44
eH2_5                 3.433036e-02 1 1  ON 45
eH2_6                 9.741130e-02 1 1  ON 46
eH2_7                 1.616762e-01 1 1  ON 47
eH2_8                 2.044966e-01 1 1  ON 48
eH2_9                 1.028417e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.0165
    reference variance = 0.192053
====================================================
  Execution time = 2.0325e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3125e-01
  Total weights = 2.0000e+06
  Execution time = 1.8390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331296223072
                                         uncertainty =       0.002298129940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331296223072
                                         uncertainty =       0.002298129940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406969845
  error estimate for blocks of size 2^( 2) =       0.000419942050
  error estimate for blocks of size 2^( 3) =       0.000433051591
  error estimate for blocks of size 2^( 4) =       0.000446654796
  error estimate for blocks of size 2^( 5) =       0.000457959667
  error estimate for blocks of size 2^( 6) =       0.000468350309
  error estimate for blocks of size 2^( 7) =       0.000476087921

      target function =                  N/A
              le_mean =     -16.907302788785
             les_mean =     286.188136335046
             stat err =       0.000462263173
             autocorr =       1.290191366344
              std dev =       0.575542273859
             le_variance =       0.331248908999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331295778704
                                         uncertainty =       0.002298129168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331295778704
                                         uncertainty =       0.002298129168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406969571
  error estimate for blocks of size 2^( 2) =       0.000419941783
  error estimate for blocks of size 2^( 3) =       0.000433051332
  error estimate for blocks of size 2^( 4) =       0.000446654547
  error estimate for blocks of size 2^( 5) =       0.000457959439
  error estimate for blocks of size 2^( 6) =       0.000468350087
  error estimate for blocks of size 2^( 7) =       0.000476087683

      target function =                  N/A
              le_mean =     -16.907302795422
             les_mean =     286.188136114324
             stat err =       0.000462262939
             autocorr =       1.290191792239
              std dev =       0.575541887162
             le_variance =       0.331248463878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331296000065
                                         uncertainty =       0.002298129556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331296000065
                                         uncertainty =       0.002298129556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406969707
  error estimate for blocks of size 2^( 2) =       0.000419941916
  error estimate for blocks of size 2^( 3) =       0.000433051461
  error estimate for blocks of size 2^( 4) =       0.000446654671
  error estimate for blocks of size 2^( 5) =       0.000457959552
  error estimate for blocks of size 2^( 6) =       0.000468350198
  error estimate for blocks of size 2^( 7) =       0.000476087802

      target function =                  N/A
              le_mean =     -16.907302792106
             les_mean =     286.188136223938
             stat err =       0.000462263056
             autocorr =       1.290191579973
              std dev =       0.575542079795
             le_variance =       0.331248685614

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331296195168
                                         uncertainty =       0.002298129892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331296195168
                                         uncertainty =       0.002298129892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406969828
  error estimate for blocks of size 2^( 2) =       0.000419942033
  error estimate for blocks of size 2^( 3) =       0.000433051574
  error estimate for blocks of size 2^( 4) =       0.000446654780
  error estimate for blocks of size 2^( 5) =       0.000457959652
  error estimate for blocks of size 2^( 6) =       0.000468350295
  error estimate for blocks of size 2^( 7) =       0.000476087906

      target function =                  N/A
              le_mean =     -16.907302789200
             les_mean =     286.188136321123
             stat err =       0.000462263158
             autocorr =       1.290191393065
              std dev =       0.575542249577
             le_variance =       0.331248881048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907302788785        initial
     9.5367e+01     9.5367e+02             1.8317e-06       -16.907302795422  <--
     3.8147e+02     3.8147e+03             4.5801e-07       -16.907302792106
     1.5259e+03     1.5259e+04             1.1451e-07       -16.907302789200

*****************************************************************************
Applying the update for shift_i =   9.5367e+01     and shift_s =   9.5367e+02
*****************************************************************************

  Execution time = 2.9627e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.122431e-01 1 1  ON 0
 uu_1                 1.443546e-01 1 1  ON 1
 uu_2                 4.228138e-02 1 1  ON 2
 uu_3                -2.086939e-02 1 1  ON 3
 uu_4                -6.736575e-02 1 1  ON 4
 uu_5                -1.039151e-01 1 1  ON 5
 uu_6                -1.333376e-01 1 1  ON 6
 uu_7                -1.493096e-01 1 1  ON 7
 uu_8                -1.427740e-01 1 1  ON 8
 uu_9                -1.123098e-01 1 1  ON 9
 ud_0                 4.541851e-01 1 1  ON 10
 ud_1                 1.880617e-01 1 1  ON 11
 ud_2                 6.717206e-02 1 1  ON 12
 ud_3                -4.483538e-03 1 1  ON 13
 ud_4                -6.219539e-02 1 1  ON 14
 ud_5                -1.047604e-01 1 1  ON 15
 ud_6                -1.335847e-01 1 1  ON 16
 ud_7                -1.510337e-01 1 1  ON 17
 ud_8                -1.519837e-01 1 1  ON 18
 ud_9                -1.432329e-01 1 1  ON 19
 eO_0                -7.497451e-01 1 1  ON 20
 eO_1                -4.277863e-01 1 1  ON 21
 eO_2                -1.252499e-02 1 1  ON 22
 eO_3                 3.045183e-01 1 1  ON 23
 eO_4                 5.326216e-01 1 1  ON 24
 eO_5                 4.975278e-01 1 1  ON 25
 eO_6                 2.673128e-01 1 1  ON 26
 eO_7                -4.317337e-02 1 1  ON 27
 eO_8                -2.433014e-01 1 1  ON 28
 eO_9                -1.175184e-01 1 1  ON 29
eH1_0                -2.674628e-01 1 1  ON 30
eH1_1                -1.613064e-01 1 1  ON 31
eH1_2                -1.120555e-01 1 1  ON 32
eH1_3                -5.627926e-02 1 1  ON 33
eH1_4                -6.259691e-03 1 1  ON 34
eH1_5                 3.022818e-02 1 1  ON 35
eH1_6                 9.396396e-02 1 1  ON 36
eH1_7                 1.615173e-01 1 1  ON 37
eH1_8                 2.035456e-01 1 1  ON 38
eH1_9                 1.119299e-01 1 1  ON 39
eH2_0                -2.646153e-01 1 1  ON 40
eH2_1                -1.588807e-01 1 1  ON 41
eH2_2                -1.095265e-01 1 1  ON 42
eH2_3                -5.393712e-02 1 1  ON 43
eH2_4                -3.653936e-03 1 1  ON 44
eH2_5                 3.432960e-02 1 1  ON 45
eH2_6                 9.741032e-02 1 1  ON 46
eH2_7                 1.616760e-01 1 1  ON 47
eH2_8                 2.044974e-01 1 1  ON 48
eH2_9                 1.028431e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5797e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9725
    reference variance = 0.354954
====================================================
  Execution time = 2.0239e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4632e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4913e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346310867825
                                         uncertainty =       0.009664831173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346310867825
                                         uncertainty =       0.009664831173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416126839
  error estimate for blocks of size 2^( 2) =       0.000428660647
  error estimate for blocks of size 2^( 3) =       0.000441731974
  error estimate for blocks of size 2^( 4) =       0.000453300333
  error estimate for blocks of size 2^( 5) =       0.000462959761
  error estimate for blocks of size 2^( 6) =       0.000470943186
  error estimate for blocks of size 2^( 7) =       0.000473795005

      target function =                  N/A
              le_mean =     -16.906053683246
             les_mean =     286.160974060727
             stat err =       0.000465249571
             autocorr =       1.250030204585
              std dev =       0.588492220087
             le_variance =       0.346323093103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690605368325e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+01, overlap shift 2.3842e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906053683246       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906053700142       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906053728066       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906053720240       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906053743389       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906053752636       residual = 4.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906053742711       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906053741624       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+01 is 8.234979e-06

solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906053683246       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906053687493       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906053694516       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906053692585       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906053698407       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906053700880       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906053698442       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906053698087       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 2.062698e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906053683246       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906053684309       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906053686067       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906053685586       residual = 8.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906053687044       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906053687672       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906053687065       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906053686971       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 5.159227e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.379356 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5737e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.122426e-01 1 1  ON 0
 uu_1                 1.443538e-01 1 1  ON 1
 uu_2                 4.228094e-02 1 1  ON 2
 uu_3                -2.086933e-02 1 1  ON 3
 uu_4                -6.736688e-02 1 1  ON 4
 uu_5                -1.039155e-01 1 1  ON 5
 uu_6                -1.333363e-01 1 1  ON 6
 uu_7                -1.493082e-01 1 1  ON 7
 uu_8                -1.427744e-01 1 1  ON 8
 uu_9                -1.123105e-01 1 1  ON 9
 ud_0                 4.541861e-01 1 1  ON 10
 ud_1                 1.880619e-01 1 1  ON 11
 ud_2                 6.717298e-02 1 1  ON 12
 ud_3                -4.482879e-03 1 1  ON 13
 ud_4                -6.219514e-02 1 1  ON 14
 ud_5                -1.047606e-01 1 1  ON 15
 ud_6                -1.335841e-01 1 1  ON 16
 ud_7                -1.510342e-01 1 1  ON 17
 ud_8                -1.519858e-01 1 1  ON 18
 ud_9                -1.432340e-01 1 1  ON 19
 eO_0                -7.497440e-01 1 1  ON 20
 eO_1                -4.277854e-01 1 1  ON 21
 eO_2                -1.252605e-02 1 1  ON 22
 eO_3                 3.045198e-01 1 1  ON 23
 eO_4                 5.326220e-01 1 1  ON 24
 eO_5                 4.975273e-01 1 1  ON 25
 eO_6                 2.673130e-01 1 1  ON 26
 eO_7                -4.317328e-02 1 1  ON 27
 eO_8                -2.433024e-01 1 1  ON 28
 eO_9                -1.175198e-01 1 1  ON 29
eH1_0                -2.674629e-01 1 1  ON 30
eH1_1                -1.613076e-01 1 1  ON 31
eH1_2                -1.120562e-01 1 1  ON 32
eH1_3                -5.628027e-02 1 1  ON 33
eH1_4                -6.260629e-03 1 1  ON 34
eH1_5                 3.022870e-02 1 1  ON 35
eH1_6                 9.396403e-02 1 1  ON 36
eH1_7                 1.615169e-01 1 1  ON 37
eH1_8                 2.035471e-01 1 1  ON 38
eH1_9                 1.119318e-01 1 1  ON 39
eH2_0                -2.646161e-01 1 1  ON 40
eH2_1                -1.588810e-01 1 1  ON 41
eH2_2                -1.095263e-01 1 1  ON 42
eH2_3                -5.393792e-02 1 1  ON 43
eH2_4                -3.653703e-03 1 1  ON 44
eH2_5                 3.432759e-02 1 1  ON 45
eH2_6                 9.741034e-02 1 1  ON 46
eH2_7                 1.616762e-01 1 1  ON 47
eH2_8                 2.044986e-01 1 1  ON 48
eH2_9                 1.028449e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9437
    reference variance = 0.36043
====================================================
  Execution time = 2.1889e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4500e-01
  Total weights = 2.0000e+06
  Execution time = 1.8418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345021285139
                                         uncertainty =       0.006490141532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345021285139
                                         uncertainty =       0.006490141532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415328377
  error estimate for blocks of size 2^( 2) =       0.000427893713
  error estimate for blocks of size 2^( 3) =       0.000440721734
  error estimate for blocks of size 2^( 4) =       0.000452736391
  error estimate for blocks of size 2^( 5) =       0.000462351958
  error estimate for blocks of size 2^( 6) =       0.000469172926
  error estimate for blocks of size 2^( 7) =       0.000473135189

      target function =                  N/A
              le_mean =     -16.907056871092
             les_mean =     286.193567190518
             stat err =       0.000464349116
             autocorr =       1.249988555819
              std dev =       0.587363022903
             le_variance =       0.344995320674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345021076425
                                         uncertainty =       0.006490165006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345021076425
                                         uncertainty =       0.006490165006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415328251
  error estimate for blocks of size 2^( 2) =       0.000427893614
  error estimate for blocks of size 2^( 3) =       0.000440721673
  error estimate for blocks of size 2^( 4) =       0.000452736386
  error estimate for blocks of size 2^( 5) =       0.000462351990
  error estimate for blocks of size 2^( 6) =       0.000469172936
  error estimate for blocks of size 2^( 7) =       0.000473135267

      target function =                  N/A
              le_mean =     -16.907056844499
             les_mean =     286.193566082612
             stat err =       0.000464349145
             autocorr =       1.249989468154
              std dev =       0.587362845251
             le_variance =       0.344995111981

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345021189998
                                         uncertainty =       0.006490153726

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345021189998
                                         uncertainty =       0.006490153726

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415328319
  error estimate for blocks of size 2^( 2) =       0.000427893669
  error estimate for blocks of size 2^( 3) =       0.000440721709
  error estimate for blocks of size 2^( 4) =       0.000452736394
  error estimate for blocks of size 2^( 5) =       0.000462351980
  error estimate for blocks of size 2^( 6) =       0.000469172937
  error estimate for blocks of size 2^( 7) =       0.000473135235

      target function =                  N/A
              le_mean =     -16.907056857666
             les_mean =     286.193566641380
             stat err =       0.000464349137
             autocorr =       1.249989012589
              std dev =       0.587362941915
             le_variance =       0.344995225535

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345021273520
                                         uncertainty =       0.006490143071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345021273520
                                         uncertainty =       0.006490143071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415328370
  error estimate for blocks of size 2^( 2) =       0.000427893707
  error estimate for blocks of size 2^( 3) =       0.000440721731
  error estimate for blocks of size 2^( 4) =       0.000452736391
  error estimate for blocks of size 2^( 5) =       0.000462351961
  error estimate for blocks of size 2^( 6) =       0.000469172927
  error estimate for blocks of size 2^( 7) =       0.000473135195

      target function =                  N/A
              le_mean =     -16.907056869407
             les_mean =     286.193567121916
             stat err =       0.000464349119
             autocorr =       1.249988612936
              std dev =       0.587363013012
             le_variance =       0.344995309054


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.907056871092        initial  <--
     2.3842e+01     2.3842e+02             8.2350e-06       -16.907056844499
     9.5367e+01     9.5367e+02             2.0627e-06       -16.907056857666
     3.8147e+02     3.8147e+03             5.1592e-07       -16.907056869407

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2722
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.122431e-01 1 1  ON 0
 uu_1                 1.443546e-01 1 1  ON 1
 uu_2                 4.228138e-02 1 1  ON 2
 uu_3                -2.086939e-02 1 1  ON 3
 uu_4                -6.736575e-02 1 1  ON 4
 uu_5                -1.039151e-01 1 1  ON 5
 uu_6                -1.333376e-01 1 1  ON 6
 uu_7                -1.493096e-01 1 1  ON 7
 uu_8                -1.427740e-01 1 1  ON 8
 uu_9                -1.123098e-01 1 1  ON 9
 ud_0                 4.541851e-01 1 1  ON 10
 ud_1                 1.880617e-01 1 1  ON 11
 ud_2                 6.717206e-02 1 1  ON 12
 ud_3                -4.483538e-03 1 1  ON 13
 ud_4                -6.219539e-02 1 1  ON 14
 ud_5                -1.047604e-01 1 1  ON 15
 ud_6                -1.335847e-01 1 1  ON 16
 ud_7                -1.510337e-01 1 1  ON 17
 ud_8                -1.519837e-01 1 1  ON 18
 ud_9                -1.432329e-01 1 1  ON 19
 eO_0                -7.497451e-01 1 1  ON 20
 eO_1                -4.277863e-01 1 1  ON 21
 eO_2                -1.252499e-02 1 1  ON 22
 eO_3                 3.045183e-01 1 1  ON 23
 eO_4                 5.326216e-01 1 1  ON 24
 eO_5                 4.975278e-01 1 1  ON 25
 eO_6                 2.673128e-01 1 1  ON 26
 eO_7                -4.317337e-02 1 1  ON 27
 eO_8                -2.433014e-01 1 1  ON 28
 eO_9                -1.175184e-01 1 1  ON 29
eH1_0                -2.674628e-01 1 1  ON 30
eH1_1                -1.613064e-01 1 1  ON 31
eH1_2                -1.120555e-01 1 1  ON 32
eH1_3                -5.627926e-02 1 1  ON 33
eH1_4                -6.259691e-03 1 1  ON 34
eH1_5                 3.022818e-02 1 1  ON 35
eH1_6                 9.396396e-02 1 1  ON 36
eH1_7                 1.615173e-01 1 1  ON 37
eH1_8                 2.035456e-01 1 1  ON 38
eH1_9                 1.119299e-01 1 1  ON 39
eH2_0                -2.646153e-01 1 1  ON 40
eH2_1                -1.588807e-01 1 1  ON 41
eH2_2                -1.095265e-01 1 1  ON 42
eH2_3                -5.393712e-02 1 1  ON 43
eH2_4                -3.653936e-03 1 1  ON 44
eH2_5                 3.432960e-02 1 1  ON 45
eH2_6                 9.741032e-02 1 1  ON 46
eH2_7                 1.616760e-01 1 1  ON 47
eH2_8                 2.044974e-01 1 1  ON 48
eH2_9                 1.028431e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7015e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8843
    reference variance = 0.259403
====================================================
  Execution time = 2.0165e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3728e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337153048949
                                         uncertainty =       0.004481931745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337153048949
                                         uncertainty =       0.004481931745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410656380
  error estimate for blocks of size 2^( 2) =       0.000423236915
  error estimate for blocks of size 2^( 3) =       0.000436051155
  error estimate for blocks of size 2^( 4) =       0.000448305568
  error estimate for blocks of size 2^( 5) =       0.000459151751
  error estimate for blocks of size 2^( 6) =       0.000466413618
  error estimate for blocks of size 2^( 7) =       0.000470118304

      target function =                  N/A
              le_mean =     -16.905879688739
             les_mean =     286.146045206790
             stat err =       0.000460997310
             autocorr =       1.260200459520
              std dev =       0.580755822442
             le_variance =       0.337277325300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690587968874e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905879688739       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905879688876       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905879687955       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905879688365       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905879688003       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905879689988       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905879690680       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 7.082632e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905879688739       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905879688773       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905879688543       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905879688645       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905879688554       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905879689050       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905879689223       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 1.771199e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905879688739       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905879688748       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905879688690       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905879688716       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905879688693       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905879688827       residual = 5.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905879688854       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 4.428336e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.381622 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5727e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.122430e-01 1 1  ON 0
 uu_1                 1.443546e-01 1 1  ON 1
 uu_2                 4.228140e-02 1 1  ON 2
 uu_3                -2.086934e-02 1 1  ON 3
 uu_4                -6.736583e-02 1 1  ON 4
 uu_5                -1.039151e-01 1 1  ON 5
 uu_6                -1.333376e-01 1 1  ON 6
 uu_7                -1.493096e-01 1 1  ON 7
 uu_8                -1.427741e-01 1 1  ON 8
 uu_9                -1.123099e-01 1 1  ON 9
 ud_0                 4.541852e-01 1 1  ON 10
 ud_1                 1.880617e-01 1 1  ON 11
 ud_2                 6.717198e-02 1 1  ON 12
 ud_3                -4.483448e-03 1 1  ON 13
 ud_4                -6.219547e-02 1 1  ON 14
 ud_5                -1.047603e-01 1 1  ON 15
 ud_6                -1.335846e-01 1 1  ON 16
 ud_7                -1.510338e-01 1 1  ON 17
 ud_8                -1.519839e-01 1 1  ON 18
 ud_9                -1.432329e-01 1 1  ON 19
 eO_0                -7.497450e-01 1 1  ON 20
 eO_1                -4.277862e-01 1 1  ON 21
 eO_2                -1.252501e-02 1 1  ON 22
 eO_3                 3.045183e-01 1 1  ON 23
 eO_4                 5.326215e-01 1 1  ON 24
 eO_5                 4.975278e-01 1 1  ON 25
 eO_6                 2.673128e-01 1 1  ON 26
 eO_7                -4.317342e-02 1 1  ON 27
 eO_8                -2.433015e-01 1 1  ON 28
 eO_9                -1.175185e-01 1 1  ON 29
eH1_0                -2.674629e-01 1 1  ON 30
eH1_1                -1.613064e-01 1 1  ON 31
eH1_2                -1.120555e-01 1 1  ON 32
eH1_3                -5.627932e-02 1 1  ON 33
eH1_4                -6.259638e-03 1 1  ON 34
eH1_5                 3.022803e-02 1 1  ON 35
eH1_6                 9.396392e-02 1 1  ON 36
eH1_7                 1.615174e-01 1 1  ON 37
eH1_8                 2.035457e-01 1 1  ON 38
eH1_9                 1.119300e-01 1 1  ON 39
eH2_0                -2.646155e-01 1 1  ON 40
eH2_1                -1.588808e-01 1 1  ON 41
eH2_2                -1.095265e-01 1 1  ON 42
eH2_3                -5.393711e-02 1 1  ON 43
eH2_4                -3.653861e-03 1 1  ON 44
eH2_5                 3.432950e-02 1 1  ON 45
eH2_6                 9.741026e-02 1 1  ON 46
eH2_7                 1.616760e-01 1 1  ON 47
eH2_8                 2.044974e-01 1 1  ON 48
eH2_9                 1.028433e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8323
    reference variance = 0.322615
====================================================
  Execution time = 1.9925e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.3500e-01
  Total weights = 2.0000e+06
  Execution time = 1.8420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059638619
                                         uncertainty =       0.003229757339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059638619
                                         uncertainty =       0.003229757339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409270722
  error estimate for blocks of size 2^( 2) =       0.000422131040
  error estimate for blocks of size 2^( 3) =       0.000434720382
  error estimate for blocks of size 2^( 4) =       0.000447122887
  error estimate for blocks of size 2^( 5) =       0.000459101770
  error estimate for blocks of size 2^( 6) =       0.000467118090
  error estimate for blocks of size 2^( 7) =       0.000475576981

      target function =                  N/A
              le_mean =     -16.905491663823
             les_mean =     286.130653275153
             stat err =       0.000462229932
             autocorr =       1.275542036254
              std dev =       0.578796205122
             le_variance =       0.335005047064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059739847
                                         uncertainty =       0.003229762099

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059739847
                                         uncertainty =       0.003229762099

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409270783
  error estimate for blocks of size 2^( 2) =       0.000422131092
  error estimate for blocks of size 2^( 3) =       0.000434720433
  error estimate for blocks of size 2^( 4) =       0.000447122937
  error estimate for blocks of size 2^( 5) =       0.000459101823
  error estimate for blocks of size 2^( 6) =       0.000467118147
  error estimate for blocks of size 2^( 7) =       0.000475577013

      target function =                  N/A
              le_mean =     -16.905491665323
             les_mean =     286.130653426735
             stat err =       0.000462229980
             autocorr =       1.275541917194
              std dev =       0.578796292271
             le_variance =       0.335005147946

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059689446
                                         uncertainty =       0.003229759725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059689446
                                         uncertainty =       0.003229759725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409270753
  error estimate for blocks of size 2^( 2) =       0.000422131066
  error estimate for blocks of size 2^( 3) =       0.000434720408
  error estimate for blocks of size 2^( 4) =       0.000447122912
  error estimate for blocks of size 2^( 5) =       0.000459101797
  error estimate for blocks of size 2^( 6) =       0.000467118118
  error estimate for blocks of size 2^( 7) =       0.000475576997

      target function =                  N/A
              le_mean =     -16.905491664573
             les_mean =     286.130653351169
             stat err =       0.000462229956
             autocorr =       1.275541976492
              std dev =       0.578796248880
             le_variance =       0.335005097718

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059644979
                                         uncertainty =       0.003229757637

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335059644979
                                         uncertainty =       0.003229757637

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409270725
  error estimate for blocks of size 2^( 2) =       0.000422131043
  error estimate for blocks of size 2^( 3) =       0.000434720385
  error estimate for blocks of size 2^( 4) =       0.000447122890
  error estimate for blocks of size 2^( 5) =       0.000459101773
  error estimate for blocks of size 2^( 6) =       0.000467118093
  error estimate for blocks of size 2^( 7) =       0.000475576983

      target function =                  N/A
              le_mean =     -16.905491663917
             les_mean =     286.130653284660
             stat err =       0.000462229935
             autocorr =       1.275542028773
              std dev =       0.578796210597
             le_variance =       0.335005053402


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905491663823        initial
     2.3842e+02     2.3842e+03             7.0826e-07       -16.905491665323  <--
     9.5367e+02     9.5367e+03             1.7712e-07       -16.905491664573
     3.8147e+03     3.8147e+04             4.4283e-08       -16.905491663917

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 2.9231e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.122429e-01 1 1  ON 0
 uu_1                 1.443546e-01 1 1  ON 1
 uu_2                 4.228145e-02 1 1  ON 2
 uu_3                -2.086920e-02 1 1  ON 3
 uu_4                -6.736607e-02 1 1  ON 4
 uu_5                -1.039151e-01 1 1  ON 5
 uu_6                -1.333376e-01 1 1  ON 6
 uu_7                -1.493093e-01 1 1  ON 7
 uu_8                -1.427741e-01 1 1  ON 8
 uu_9                -1.123102e-01 1 1  ON 9
 ud_0                 4.541853e-01 1 1  ON 10
 ud_1                 1.880618e-01 1 1  ON 11
 ud_2                 6.717174e-02 1 1  ON 12
 ud_3                -4.483181e-03 1 1  ON 13
 ud_4                -6.219568e-02 1 1  ON 14
 ud_5                -1.047601e-01 1 1  ON 15
 ud_6                -1.335843e-01 1 1  ON 16
 ud_7                -1.510339e-01 1 1  ON 17
 ud_8                -1.519843e-01 1 1  ON 18
 ud_9                -1.432329e-01 1 1  ON 19
 eO_0                -7.497447e-01 1 1  ON 20
 eO_1                -4.277861e-01 1 1  ON 21
 eO_2                -1.252506e-02 1 1  ON 22
 eO_3                 3.045185e-01 1 1  ON 23
 eO_4                 5.326215e-01 1 1  ON 24
 eO_5                 4.975280e-01 1 1  ON 25
 eO_6                 2.673130e-01 1 1  ON 26
 eO_7                -4.317358e-02 1 1  ON 27
 eO_8                -2.433018e-01 1 1  ON 28
 eO_9                -1.175188e-01 1 1  ON 29
eH1_0                -2.674631e-01 1 1  ON 30
eH1_1                -1.613065e-01 1 1  ON 31
eH1_2                -1.120556e-01 1 1  ON 32
eH1_3                -5.627949e-02 1 1  ON 33
eH1_4                -6.259480e-03 1 1  ON 34
eH1_5                 3.022761e-02 1 1  ON 35
eH1_6                 9.396379e-02 1 1  ON 36
eH1_7                 1.615177e-01 1 1  ON 37
eH1_8                 2.035459e-01 1 1  ON 38
eH1_9                 1.119303e-01 1 1  ON 39
eH2_0                -2.646160e-01 1 1  ON 40
eH2_1                -1.588810e-01 1 1  ON 41
eH2_2                -1.095265e-01 1 1  ON 42
eH2_3                -5.393710e-02 1 1  ON 43
eH2_4                -3.653633e-03 1 1  ON 44
eH2_5                 3.432919e-02 1 1  ON 45
eH2_6                 9.741009e-02 1 1  ON 46
eH2_7                 1.616761e-01 1 1  ON 47
eH2_8                 2.044977e-01 1 1  ON 48
eH2_9                 1.028438e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4963e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.8871
    reference variance = 0.475386
====================================================
  Execution time = 2.0517e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6905e+01
  VMC Evar = 3.4558e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5280e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345575029908
                                         uncertainty =       0.007090679980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345575029908
                                         uncertainty =       0.007090679980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415679222
  error estimate for blocks of size 2^( 2) =       0.000428886955
  error estimate for blocks of size 2^( 3) =       0.000442079521
  error estimate for blocks of size 2^( 4) =       0.000454625806
  error estimate for blocks of size 2^( 5) =       0.000466884662
  error estimate for blocks of size 2^( 6) =       0.000476450712
  error estimate for blocks of size 2^( 7) =       0.000482819487

      target function =                  N/A
              le_mean =     -16.905386904531
             les_mean =     286.137684649701
             stat err =       0.000470195167
             autocorr =       1.279498228478
              std dev =       0.587859192846
             le_variance =       0.345578430613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690538690453e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905386904531       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905386912996       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905386916791       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905386912021       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905386912350       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905386913565       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905386915580       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 3.973350e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905386904531       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905386906652       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905386907608       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905386906417       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905386906510       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905386906806       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905386907299       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 9.952424e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905386904531       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905386905061       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905386905301       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905386905003       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905386905027       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905386905100       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905386905223       residual = 5.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.489313e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.383920 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6051e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.122428e-01 1 1  ON 0
 uu_1                 1.443549e-01 1 1  ON 1
 uu_2                 4.228142e-02 1 1  ON 2
 uu_3                -2.086947e-02 1 1  ON 3
 uu_4                -6.736648e-02 1 1  ON 4
 uu_5                -1.039152e-01 1 1  ON 5
 uu_6                -1.333376e-01 1 1  ON 6
 uu_7                -1.493092e-01 1 1  ON 7
 uu_8                -1.427738e-01 1 1  ON 8
 uu_9                -1.123104e-01 1 1  ON 9
 ud_0                 4.541854e-01 1 1  ON 10
 ud_1                 1.880618e-01 1 1  ON 11
 ud_2                 6.717141e-02 1 1  ON 12
 ud_3                -4.483078e-03 1 1  ON 13
 ud_4                -6.219544e-02 1 1  ON 14
 ud_5                -1.047602e-01 1 1  ON 15
 ud_6                -1.335841e-01 1 1  ON 16
 ud_7                -1.510339e-01 1 1  ON 17
 ud_8                -1.519845e-01 1 1  ON 18
 ud_9                -1.432327e-01 1 1  ON 19
 eO_0                -7.497445e-01 1 1  ON 20
 eO_1                -4.277862e-01 1 1  ON 21
 eO_2                -1.252446e-02 1 1  ON 22
 eO_3                 3.045184e-01 1 1  ON 23
 eO_4                 5.326214e-01 1 1  ON 24
 eO_5                 4.975277e-01 1 1  ON 25
 eO_6                 2.673134e-01 1 1  ON 26
 eO_7                -4.317346e-02 1 1  ON 27
 eO_8                -2.433020e-01 1 1  ON 28
 eO_9                -1.175193e-01 1 1  ON 29
eH1_0                -2.674631e-01 1 1  ON 30
eH1_1                -1.613075e-01 1 1  ON 31
eH1_2                -1.120557e-01 1 1  ON 32
eH1_3                -5.627959e-02 1 1  ON 33
eH1_4                -6.259624e-03 1 1  ON 34
eH1_5                 3.022790e-02 1 1  ON 35
eH1_6                 9.396392e-02 1 1  ON 36
eH1_7                 1.615174e-01 1 1  ON 37
eH1_8                 2.035462e-01 1 1  ON 38
eH1_9                 1.119311e-01 1 1  ON 39
eH2_0                -2.646162e-01 1 1  ON 40
eH2_1                -1.588811e-01 1 1  ON 41
eH2_2                -1.095264e-01 1 1  ON 42
eH2_3                -5.393739e-02 1 1  ON 43
eH2_4                -3.654155e-03 1 1  ON 44
eH2_5                 3.432900e-02 1 1  ON 45
eH2_6                 9.740988e-02 1 1  ON 46
eH2_7                 1.616761e-01 1 1  ON 47
eH2_8                 2.044980e-01 1 1  ON 48
eH2_9                 1.028446e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9783
    reference variance = 0.274584
====================================================
  Execution time = 1.9923e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3704e-01
  Total weights = 2.0000e+06
  Execution time = 1.8428e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337054080735
                                         uncertainty =       0.003480135347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337054080735
                                         uncertainty =       0.003480135347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410512959
  error estimate for blocks of size 2^( 2) =       0.000423101425
  error estimate for blocks of size 2^( 3) =       0.000436283085
  error estimate for blocks of size 2^( 4) =       0.000448575760
  error estimate for blocks of size 2^( 5) =       0.000459078576
  error estimate for blocks of size 2^( 6) =       0.000466728375
  error estimate for blocks of size 2^( 7) =       0.000473526176

      target function =                  N/A
              le_mean =     -16.905949892609
             les_mean =     286.148183382647
             stat err =       0.000461977222
             autocorr =       1.266448056167
              std dev =       0.580552994806
             le_variance =       0.337041779778

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337055254665
                                         uncertainty =       0.003480149577

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337055254665
                                         uncertainty =       0.003480149577

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410513674
  error estimate for blocks of size 2^( 2) =       0.000423102056
  error estimate for blocks of size 2^( 3) =       0.000436283661
  error estimate for blocks of size 2^( 4) =       0.000448576318
  error estimate for blocks of size 2^( 5) =       0.000459079142
  error estimate for blocks of size 2^( 6) =       0.000466728864
  error estimate for blocks of size 2^( 7) =       0.000473526653

      target function =                  N/A
              le_mean =     -16.905949885021
             les_mean =     286.148184299899
             stat err =       0.000461977744
             autocorr =       1.266446509821
              std dev =       0.580554005747
             le_variance =       0.337042953589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337054669463
                                         uncertainty =       0.003480142474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337054669463
                                         uncertainty =       0.003480142474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410513318
  error estimate for blocks of size 2^( 2) =       0.000423101741
  error estimate for blocks of size 2^( 3) =       0.000436283374
  error estimate for blocks of size 2^( 4) =       0.000448576039
  error estimate for blocks of size 2^( 5) =       0.000459078860
  error estimate for blocks of size 2^( 6) =       0.000466728620
  error estimate for blocks of size 2^( 7) =       0.000473526415

      target function =                  N/A
              le_mean =     -16.905949888795
             les_mean =     286.148183842381
             stat err =       0.000461977484
             autocorr =       1.266447280669
              std dev =       0.580553501794
             le_variance =       0.337042368446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337054154376
                                         uncertainty =       0.003480136238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337054154376
                                         uncertainty =       0.003480136238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410513004
  error estimate for blocks of size 2^( 2) =       0.000423101464
  error estimate for blocks of size 2^( 3) =       0.000436283121
  error estimate for blocks of size 2^( 4) =       0.000448575795
  error estimate for blocks of size 2^( 5) =       0.000459078612
  error estimate for blocks of size 2^( 6) =       0.000466728406
  error estimate for blocks of size 2^( 7) =       0.000473526206

      target function =                  N/A
              le_mean =     -16.905949892131
             les_mean =     286.148183440120
             stat err =       0.000461977255
             autocorr =       1.266447959164
              std dev =       0.580553058222
             le_variance =       0.337041853411


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905949892609        initial  <--
     5.9605e+01     5.9605e+02             3.9734e-06       -16.905949885021
     2.3842e+02     2.3842e+03             9.9524e-07       -16.905949888795
     9.5367e+02     9.5367e+03             2.4893e-07       -16.905949892131

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2281
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.122429e-01 1 1  ON 0
 uu_1                 1.443546e-01 1 1  ON 1
 uu_2                 4.228145e-02 1 1  ON 2
 uu_3                -2.086920e-02 1 1  ON 3
 uu_4                -6.736607e-02 1 1  ON 4
 uu_5                -1.039151e-01 1 1  ON 5
 uu_6                -1.333376e-01 1 1  ON 6
 uu_7                -1.493093e-01 1 1  ON 7
 uu_8                -1.427741e-01 1 1  ON 8
 uu_9                -1.123102e-01 1 1  ON 9
 ud_0                 4.541853e-01 1 1  ON 10
 ud_1                 1.880618e-01 1 1  ON 11
 ud_2                 6.717174e-02 1 1  ON 12
 ud_3                -4.483181e-03 1 1  ON 13
 ud_4                -6.219568e-02 1 1  ON 14
 ud_5                -1.047601e-01 1 1  ON 15
 ud_6                -1.335843e-01 1 1  ON 16
 ud_7                -1.510339e-01 1 1  ON 17
 ud_8                -1.519843e-01 1 1  ON 18
 ud_9                -1.432329e-01 1 1  ON 19
 eO_0                -7.497447e-01 1 1  ON 20
 eO_1                -4.277861e-01 1 1  ON 21
 eO_2                -1.252506e-02 1 1  ON 22
 eO_3                 3.045185e-01 1 1  ON 23
 eO_4                 5.326215e-01 1 1  ON 24
 eO_5                 4.975280e-01 1 1  ON 25
 eO_6                 2.673130e-01 1 1  ON 26
 eO_7                -4.317358e-02 1 1  ON 27
 eO_8                -2.433018e-01 1 1  ON 28
 eO_9                -1.175188e-01 1 1  ON 29
eH1_0                -2.674631e-01 1 1  ON 30
eH1_1                -1.613065e-01 1 1  ON 31
eH1_2                -1.120556e-01 1 1  ON 32
eH1_3                -5.627949e-02 1 1  ON 33
eH1_4                -6.259480e-03 1 1  ON 34
eH1_5                 3.022761e-02 1 1  ON 35
eH1_6                 9.396379e-02 1 1  ON 36
eH1_7                 1.615177e-01 1 1  ON 37
eH1_8                 2.035459e-01 1 1  ON 38
eH1_9                 1.119303e-01 1 1  ON 39
eH2_0                -2.646160e-01 1 1  ON 40
eH2_1                -1.588810e-01 1 1  ON 41
eH2_2                -1.095265e-01 1 1  ON 42
eH2_3                -5.393710e-02 1 1  ON 43
eH2_4                -3.653633e-03 1 1  ON 44
eH2_5                 3.432919e-02 1 1  ON 45
eH2_6                 9.741009e-02 1 1  ON 46
eH2_7                 1.616761e-01 1 1  ON 47
eH2_8                 2.044977e-01 1 1  ON 48
eH2_9                 1.028438e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5286e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8534
    reference variance = 0.198438
====================================================
  Execution time = 2.0185e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3572e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335301927700
                                         uncertainty =       0.003785237262

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335301927700
                                         uncertainty =       0.003785237262

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409708478
  error estimate for blocks of size 2^( 2) =       0.000422725261
  error estimate for blocks of size 2^( 3) =       0.000435089071
  error estimate for blocks of size 2^( 4) =       0.000446514858
  error estimate for blocks of size 2^( 5) =       0.000456371207
  error estimate for blocks of size 2^( 6) =       0.000463300684
  error estimate for blocks of size 2^( 7) =       0.000465420812

      target function =                  N/A
              le_mean =     -16.905869347548
             les_mean =     286.144140301904
             stat err =       0.000457901890
             autocorr =       1.249093567290
              std dev =       0.579415285773
             le_variance =       0.335722073388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690586934755e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905869347548       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905869348531       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905869348443       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905869348174       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905869348584       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905869348004       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905869348097       residual = 6.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 3.017139e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905869347548       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905869347794       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905869347772       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905869347705       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905869347807       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905869347664       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905869347684       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 7.543883e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905869347548       residual = 7.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905869347610       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905869347604       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905869347588       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905869347620       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905869347578       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905869347592       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 1.886036e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.386168 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5714e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.122428e-01 1 1  ON 0
 uu_1                 1.443547e-01 1 1  ON 1
 uu_2                 4.228143e-02 1 1  ON 2
 uu_3                -2.086920e-02 1 1  ON 3
 uu_4                -6.736608e-02 1 1  ON 4
 uu_5                -1.039151e-01 1 1  ON 5
 uu_6                -1.333376e-01 1 1  ON 6
 uu_7                -1.493093e-01 1 1  ON 7
 uu_8                -1.427742e-01 1 1  ON 8
 uu_9                -1.123102e-01 1 1  ON 9
 ud_0                 4.541853e-01 1 1  ON 10
 ud_1                 1.880618e-01 1 1  ON 11
 ud_2                 6.717178e-02 1 1  ON 12
 ud_3                -4.483160e-03 1 1  ON 13
 ud_4                -6.219568e-02 1 1  ON 14
 ud_5                -1.047600e-01 1 1  ON 15
 ud_6                -1.335843e-01 1 1  ON 16
 ud_7                -1.510339e-01 1 1  ON 17
 ud_8                -1.519844e-01 1 1  ON 18
 ud_9                -1.432329e-01 1 1  ON 19
 eO_0                -7.497448e-01 1 1  ON 20
 eO_1                -4.277860e-01 1 1  ON 21
 eO_2                -1.252503e-02 1 1  ON 22
 eO_3                 3.045186e-01 1 1  ON 23
 eO_4                 5.326215e-01 1 1  ON 24
 eO_5                 4.975280e-01 1 1  ON 25
 eO_6                 2.673130e-01 1 1  ON 26
 eO_7                -4.317361e-02 1 1  ON 27
 eO_8                -2.433019e-01 1 1  ON 28
 eO_9                -1.175188e-01 1 1  ON 29
eH1_0                -2.674631e-01 1 1  ON 30
eH1_1                -1.613065e-01 1 1  ON 31
eH1_2                -1.120556e-01 1 1  ON 32
eH1_3                -5.627949e-02 1 1  ON 33
eH1_4                -6.259475e-03 1 1  ON 34
eH1_5                 3.022765e-02 1 1  ON 35
eH1_6                 9.396381e-02 1 1  ON 36
eH1_7                 1.615177e-01 1 1  ON 37
eH1_8                 2.035459e-01 1 1  ON 38
eH1_9                 1.119304e-01 1 1  ON 39
eH2_0                -2.646160e-01 1 1  ON 40
eH2_1                -1.588810e-01 1 1  ON 41
eH2_2                -1.095265e-01 1 1  ON 42
eH2_3                -5.393710e-02 1 1  ON 43
eH2_4                -3.653657e-03 1 1  ON 44
eH2_5                 3.432915e-02 1 1  ON 45
eH2_6                 9.741004e-02 1 1  ON 46
eH2_7                 1.616761e-01 1 1  ON 47
eH2_8                 2.044977e-01 1 1  ON 48
eH2_9                 1.028439e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9926
    reference variance = 0.364555
====================================================
  Execution time = 2.0210e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3171e-01
  Total weights = 2.0000e+06
  Execution time = 1.8491e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331690399557
                                         uncertainty =       0.002303577589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331690399557
                                         uncertainty =       0.002303577589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407254903
  error estimate for blocks of size 2^( 2) =       0.000420095613
  error estimate for blocks of size 2^( 3) =       0.000433319158
  error estimate for blocks of size 2^( 4) =       0.000445675511
  error estimate for blocks of size 2^( 5) =       0.000455869227
  error estimate for blocks of size 2^( 6) =       0.000464170769
  error estimate for blocks of size 2^( 7) =       0.000467417503

      target function =                  N/A
              le_mean =     -16.906263596246
             les_mean =     286.153461732561
             stat err =       0.000458283253
             autocorr =       1.266296275400
              std dev =       0.575945407708
             le_variance =       0.331713112660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331690401742
                                         uncertainty =       0.002303577759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331690401742
                                         uncertainty =       0.002303577759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407254905
  error estimate for blocks of size 2^( 2) =       0.000420095613
  error estimate for blocks of size 2^( 3) =       0.000433319155
  error estimate for blocks of size 2^( 4) =       0.000445675506
  error estimate for blocks of size 2^( 5) =       0.000455869221
  error estimate for blocks of size 2^( 6) =       0.000464170765
  error estimate for blocks of size 2^( 7) =       0.000467417498

      target function =                  N/A
              le_mean =     -16.906263596822
             les_mean =     286.153461754230
             stat err =       0.000458283247
             autocorr =       1.266296239147
              std dev =       0.575945409615
             le_variance =       0.331713114857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331690400644
                                         uncertainty =       0.002303577674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331690400644
                                         uncertainty =       0.002303577674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407254904
  error estimate for blocks of size 2^( 2) =       0.000420095613
  error estimate for blocks of size 2^( 3) =       0.000433319157
  error estimate for blocks of size 2^( 4) =       0.000445675508
  error estimate for blocks of size 2^( 5) =       0.000455869224
  error estimate for blocks of size 2^( 6) =       0.000464170767
  error estimate for blocks of size 2^( 7) =       0.000467417500

      target function =                  N/A
              le_mean =     -16.906263596534
             les_mean =     286.153461743382
             stat err =       0.000458283250
             autocorr =       1.266296257269
              std dev =       0.575945408656
             le_variance =       0.331713113752

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331690399693
                                         uncertainty =       0.002303577599

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.331690399693
                                         uncertainty =       0.002303577599

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407254903
  error estimate for blocks of size 2^( 2) =       0.000420095613
  error estimate for blocks of size 2^( 3) =       0.000433319158
  error estimate for blocks of size 2^( 4) =       0.000445675510
  error estimate for blocks of size 2^( 5) =       0.000455869227
  error estimate for blocks of size 2^( 6) =       0.000464170769
  error estimate for blocks of size 2^( 7) =       0.000467417503

      target function =                  N/A
              le_mean =     -16.906263596282
             les_mean =     286.153461733913
             stat err =       0.000458283252
             autocorr =       1.266296273128
              std dev =       0.575945407826
             le_variance =       0.331713112796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906263596246        initial
     5.9605e+02     5.9605e+03             3.0171e-07       -16.906263596822  <--
     2.3842e+03     2.3842e+04             7.5439e-08       -16.906263596534
     9.5367e+03     9.5367e+04             1.8860e-08       -16.906263596282

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 2.9585e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.122427e-01 1 1  ON 0
 uu_1                 1.443548e-01 1 1  ON 1
 uu_2                 4.228137e-02 1 1  ON 2
 uu_3                -2.086921e-02 1 1  ON 3
 uu_4                -6.736611e-02 1 1  ON 4
 uu_5                -1.039150e-01 1 1  ON 5
 uu_6                -1.333375e-01 1 1  ON 6
 uu_7                -1.493091e-01 1 1  ON 7
 uu_8                -1.427743e-01 1 1  ON 8
 uu_9                -1.123103e-01 1 1  ON 9
 ud_0                 4.541854e-01 1 1  ON 10
 ud_1                 1.880619e-01 1 1  ON 11
 ud_2                 6.717190e-02 1 1  ON 12
 ud_3                -4.483095e-03 1 1  ON 13
 ud_4                -6.219567e-02 1 1  ON 14
 ud_5                -1.047599e-01 1 1  ON 15
 ud_6                -1.335844e-01 1 1  ON 16
 ud_7                -1.510339e-01 1 1  ON 17
 ud_8                -1.519845e-01 1 1  ON 18
 ud_9                -1.432331e-01 1 1  ON 19
 eO_0                -7.497448e-01 1 1  ON 20
 eO_1                -4.277860e-01 1 1  ON 21
 eO_2                -1.252493e-02 1 1  ON 22
 eO_3                 3.045188e-01 1 1  ON 23
 eO_4                 5.326214e-01 1 1  ON 24
 eO_5                 4.975280e-01 1 1  ON 25
 eO_6                 2.673131e-01 1 1  ON 26
 eO_7                -4.317368e-02 1 1  ON 27
 eO_8                -2.433020e-01 1 1  ON 28
 eO_9                -1.175190e-01 1 1  ON 29
eH1_0                -2.674632e-01 1 1  ON 30
eH1_1                -1.613064e-01 1 1  ON 31
eH1_2                -1.120556e-01 1 1  ON 32
eH1_3                -5.627951e-02 1 1  ON 33
eH1_4                -6.259460e-03 1 1  ON 34
eH1_5                 3.022778e-02 1 1  ON 35
eH1_6                 9.396386e-02 1 1  ON 36
eH1_7                 1.615176e-01 1 1  ON 37
eH1_8                 2.035458e-01 1 1  ON 38
eH1_9                 1.119304e-01 1 1  ON 39
eH2_0                -2.646162e-01 1 1  ON 40
eH2_1                -1.588809e-01 1 1  ON 41
eH2_2                -1.095266e-01 1 1  ON 42
eH2_3                -5.393712e-02 1 1  ON 43
eH2_4                -3.653729e-03 1 1  ON 44
eH2_5                 3.432904e-02 1 1  ON 45
eH2_6                 9.740990e-02 1 1  ON 46
eH2_7                 1.616761e-01 1 1  ON 47
eH2_8                 2.044978e-01 1 1  ON 48
eH2_9                 1.028441e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5305e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8751
    reference variance = 0.28932
====================================================
  Execution time = 2.0338e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3534e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335395187347
                                         uncertainty =       0.002768332247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335395187347
                                         uncertainty =       0.002768332247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409472607
  error estimate for blocks of size 2^( 2) =       0.000421896126
  error estimate for blocks of size 2^( 3) =       0.000434117799
  error estimate for blocks of size 2^( 4) =       0.000445650705
  error estimate for blocks of size 2^( 5) =       0.000455060801
  error estimate for blocks of size 2^( 6) =       0.000462142802
  error estimate for blocks of size 2^( 7) =       0.000465756752

      target function =                  N/A
              le_mean =     -16.907245325833
             les_mean =     286.190279971815
             stat err =       0.000457152765
             autocorr =       1.246444641046
              std dev =       0.579081714091
             le_variance =       0.335335631595


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690724532583e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907245325833       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907245329365       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907245331833       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907245327642       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907245325800       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907245326034       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907245324712       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907245326063       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 2.086590e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907245325833       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907245326716       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907245327333       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907245326284       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907245325821       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907245325878       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907245325546       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907245325883       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 5.217167e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907245325833       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907245326054       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907245326208       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907245325945       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907245325830       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907245325844       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907245325762       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907245325845       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.304335e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.388824 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5856e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.122425e-01 1 1  ON 0
 uu_1                 1.443549e-01 1 1  ON 1
 uu_2                 4.228149e-02 1 1  ON 2
 uu_3                -2.086914e-02 1 1  ON 3
 uu_4                -6.736606e-02 1 1  ON 4
 uu_5                -1.039147e-01 1 1  ON 5
 uu_6                -1.333376e-01 1 1  ON 6
 uu_7                -1.493089e-01 1 1  ON 7
 uu_8                -1.427745e-01 1 1  ON 8
 uu_9                -1.123106e-01 1 1  ON 9
 ud_0                 4.541854e-01 1 1  ON 10
 ud_1                 1.880624e-01 1 1  ON 11
 ud_2                 6.717221e-02 1 1  ON 12
 ud_3                -4.482994e-03 1 1  ON 13
 ud_4                -6.219554e-02 1 1  ON 14
 ud_5                -1.047598e-01 1 1  ON 15
 ud_6                -1.335843e-01 1 1  ON 16
 ud_7                -1.510341e-01 1 1  ON 17
 ud_8                -1.519850e-01 1 1  ON 18
 ud_9                -1.432335e-01 1 1  ON 19
 eO_0                -7.497446e-01 1 1  ON 20
 eO_1                -4.277860e-01 1 1  ON 21
 eO_2                -1.252473e-02 1 1  ON 22
 eO_3                 3.045190e-01 1 1  ON 23
 eO_4                 5.326214e-01 1 1  ON 24
 eO_5                 4.975281e-01 1 1  ON 25
 eO_6                 2.673132e-01 1 1  ON 26
 eO_7                -4.317372e-02 1 1  ON 27
 eO_8                -2.433023e-01 1 1  ON 28
 eO_9                -1.175192e-01 1 1  ON 29
eH1_0                -2.674632e-01 1 1  ON 30
eH1_1                -1.613064e-01 1 1  ON 31
eH1_2                -1.120557e-01 1 1  ON 32
eH1_3                -5.627958e-02 1 1  ON 33
eH1_4                -6.259471e-03 1 1  ON 34
eH1_5                 3.022779e-02 1 1  ON 35
eH1_6                 9.396387e-02 1 1  ON 36
eH1_7                 1.615175e-01 1 1  ON 37
eH1_8                 2.035458e-01 1 1  ON 38
eH1_9                 1.119306e-01 1 1  ON 39
eH2_0                -2.646162e-01 1 1  ON 40
eH2_1                -1.588809e-01 1 1  ON 41
eH2_2                -1.095266e-01 1 1  ON 42
eH2_3                -5.393702e-02 1 1  ON 43
eH2_4                -3.653783e-03 1 1  ON 44
eH2_5                 3.432893e-02 1 1  ON 45
eH2_6                 9.740981e-02 1 1  ON 46
eH2_7                 1.616761e-01 1 1  ON 47
eH2_8                 2.044979e-01 1 1  ON 48
eH2_9                 1.028443e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.8648
    reference variance = 0.285943
====================================================
  Execution time = 2.0192e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4525e-01
  Total weights = 2.0000e+06
  Execution time = 1.8461e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345287030879
                                         uncertainty =       0.005692994343

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345287030879
                                         uncertainty =       0.005692994343

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415481039
  error estimate for blocks of size 2^( 2) =       0.000428586302
  error estimate for blocks of size 2^( 3) =       0.000441937807
  error estimate for blocks of size 2^( 4) =       0.000454106840
  error estimate for blocks of size 2^( 5) =       0.000465741559
  error estimate for blocks of size 2^( 6) =       0.000474961854
  error estimate for blocks of size 2^( 7) =       0.000480594001

      target function =                  N/A
              le_mean =     -16.906254127375
             les_mean =     286.166677435010
             stat err =       0.000468851064
             autocorr =       1.273407467555
              std dev =       0.587578920880
             le_variance =       0.345248988262

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345285616349
                                         uncertainty =       0.005692968394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345285616349
                                         uncertainty =       0.005692968394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415480188
  error estimate for blocks of size 2^( 2) =       0.000428585474
  error estimate for blocks of size 2^( 3) =       0.000441936993
  error estimate for blocks of size 2^( 4) =       0.000454106032
  error estimate for blocks of size 2^( 5) =       0.000465740770
  error estimate for blocks of size 2^( 6) =       0.000474961109
  error estimate for blocks of size 2^( 7) =       0.000480593255

      target function =                  N/A
              le_mean =     -16.906254129413
             les_mean =     286.166676089078
             stat err =       0.000468850291
             autocorr =       1.273408490679
              std dev =       0.587577716895
             le_variance =       0.345247573392

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345286321675
                                         uncertainty =       0.005692981338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345286321675
                                         uncertainty =       0.005692981338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415480613
  error estimate for blocks of size 2^( 2) =       0.000428585887
  error estimate for blocks of size 2^( 3) =       0.000441937399
  error estimate for blocks of size 2^( 4) =       0.000454106435
  error estimate for blocks of size 2^( 5) =       0.000465741164
  error estimate for blocks of size 2^( 6) =       0.000474961481
  error estimate for blocks of size 2^( 7) =       0.000480593627

      target function =                  N/A
              le_mean =     -16.906254128398
             les_mean =     286.166676760231
             stat err =       0.000468850676
             autocorr =       1.273407980667
              std dev =       0.587578317237
             le_variance =       0.345248278887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345286942167
                                         uncertainty =       0.005692992716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345286942167
                                         uncertainty =       0.005692992716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415480986
  error estimate for blocks of size 2^( 2) =       0.000428586250
  error estimate for blocks of size 2^( 3) =       0.000441937756
  error estimate for blocks of size 2^( 4) =       0.000454106789
  error estimate for blocks of size 2^( 5) =       0.000465741510
  error estimate for blocks of size 2^( 6) =       0.000474961808
  error estimate for blocks of size 2^( 7) =       0.000480593955

      target function =                  N/A
              le_mean =     -16.906254127503
             les_mean =     286.166677350599
             stat err =       0.000468851015
             autocorr =       1.273407531744
              std dev =       0.587578845372
             le_variance =       0.345248899528


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906254127375        initial
     1.4901e+02     1.4901e+03             2.0866e-06       -16.906254129413  <--
     5.9605e+02     5.9605e+03             5.2172e-07       -16.906254128398
     2.3842e+03     2.3842e+04             1.3043e-07       -16.906254127503

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 2.9527e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.122420e-01 1 1  ON 0
 uu_1                 1.443550e-01 1 1  ON 1
 uu_2                 4.228185e-02 1 1  ON 2
 uu_3                -2.086891e-02 1 1  ON 3
 uu_4                -6.736593e-02 1 1  ON 4
 uu_5                -1.039139e-01 1 1  ON 5
 uu_6                -1.333376e-01 1 1  ON 6
 uu_7                -1.493084e-01 1 1  ON 7
 uu_8                -1.427751e-01 1 1  ON 8
 uu_9                -1.123116e-01 1 1  ON 9
 ud_0                 4.541855e-01 1 1  ON 10
 ud_1                 1.880637e-01 1 1  ON 11
 ud_2                 6.717314e-02 1 1  ON 12
 ud_3                -4.482688e-03 1 1  ON 13
 ud_4                -6.219515e-02 1 1  ON 14
 ud_5                -1.047592e-01 1 1  ON 15
 ud_6                -1.335840e-01 1 1  ON 16
 ud_7                -1.510345e-01 1 1  ON 17
 ud_8                -1.519866e-01 1 1  ON 18
 ud_9                -1.432347e-01 1 1  ON 19
 eO_0                -7.497441e-01 1 1  ON 20
 eO_1                -4.277860e-01 1 1  ON 21
 eO_2                -1.252412e-02 1 1  ON 22
 eO_3                 3.045195e-01 1 1  ON 23
 eO_4                 5.326214e-01 1 1  ON 24
 eO_5                 4.975283e-01 1 1  ON 25
 eO_6                 2.673135e-01 1 1  ON 26
 eO_7                -4.317384e-02 1 1  ON 27
 eO_8                -2.433032e-01 1 1  ON 28
 eO_9                -1.175201e-01 1 1  ON 29
eH1_0                -2.674630e-01 1 1  ON 30
eH1_1                -1.613063e-01 1 1  ON 31
eH1_2                -1.120559e-01 1 1  ON 32
eH1_3                -5.627980e-02 1 1  ON 33
eH1_4                -6.259503e-03 1 1  ON 34
eH1_5                 3.022784e-02 1 1  ON 35
eH1_6                 9.396390e-02 1 1  ON 36
eH1_7                 1.615172e-01 1 1  ON 37
eH1_8                 2.035459e-01 1 1  ON 38
eH1_9                 1.119311e-01 1 1  ON 39
eH2_0                -2.646162e-01 1 1  ON 40
eH2_1                -1.588810e-01 1 1  ON 41
eH2_2                -1.095266e-01 1 1  ON 42
eH2_3                -5.393672e-02 1 1  ON 43
eH2_4                -3.653944e-03 1 1  ON 44
eH2_5                 3.432858e-02 1 1  ON 45
eH2_6                 9.740954e-02 1 1  ON 46
eH2_7                 1.616759e-01 1 1  ON 47
eH2_8                 2.044980e-01 1 1  ON 48
eH2_9                 1.028450e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5389e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.7832
    reference variance = 0.562607
====================================================
  Execution time = 2.0669e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.6475e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364486234359
                                         uncertainty =       0.019429438974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.364486234359
                                         uncertainty =       0.019429438974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427055780
  error estimate for blocks of size 2^( 2) =       0.000438809705
  error estimate for blocks of size 2^( 3) =       0.000451298361
  error estimate for blocks of size 2^( 4) =       0.000462972854
  error estimate for blocks of size 2^( 5) =       0.000472663097
  error estimate for blocks of size 2^( 6) =       0.000481689530
  error estimate for blocks of size 2^( 7) =       0.000485371153

      target function =                  N/A
              le_mean =     -16.905801322092
             les_mean =     286.170871438992
             stat err =       0.000475674159
             autocorr =       1.240651794190
              std dev =       0.603948076668
             le_variance =       0.364753279312


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690580132209e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801322092       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801320900       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801321973       residual = 6.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905801324619       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801323377       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801319285       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801322149       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 6.481146e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801322092       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801321793       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801322060       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905801322709       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801322425       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801321396       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801322087       residual = 8.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.627992e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905801322092       residual = 4.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905801322017       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905801322084       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905801322245       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905801322176       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905801321919       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905801322090       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.074829e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.391097 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6194e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.122422e-01 1 1  ON 0
 uu_1                 1.443550e-01 1 1  ON 1
 uu_2                 4.228187e-02 1 1  ON 2
 uu_3                -2.086931e-02 1 1  ON 3
 uu_4                -6.736556e-02 1 1  ON 4
 uu_5                -1.039139e-01 1 1  ON 5
 uu_6                -1.333377e-01 1 1  ON 6
 uu_7                -1.493081e-01 1 1  ON 7
 uu_8                -1.427753e-01 1 1  ON 8
 uu_9                -1.123123e-01 1 1  ON 9
 ud_0                 4.541872e-01 1 1  ON 10
 ud_1                 1.880640e-01 1 1  ON 11
 ud_2                 6.717313e-02 1 1  ON 12
 ud_3                -4.482944e-03 1 1  ON 13
 ud_4                -6.219458e-02 1 1  ON 14
 ud_5                -1.047598e-01 1 1  ON 15
 ud_6                -1.335837e-01 1 1  ON 16
 ud_7                -1.510348e-01 1 1  ON 17
 ud_8                -1.519875e-01 1 1  ON 18
 ud_9                -1.432355e-01 1 1  ON 19
 eO_0                -7.497435e-01 1 1  ON 20
 eO_1                -4.277864e-01 1 1  ON 21
 eO_2                -1.252337e-02 1 1  ON 22
 eO_3                 3.045198e-01 1 1  ON 23
 eO_4                 5.326218e-01 1 1  ON 24
 eO_5                 4.975279e-01 1 1  ON 25
 eO_6                 2.673136e-01 1 1  ON 26
 eO_7                -4.317368e-02 1 1  ON 27
 eO_8                -2.433040e-01 1 1  ON 28
 eO_9                -1.175209e-01 1 1  ON 29
eH1_0                -2.674633e-01 1 1  ON 30
eH1_1                -1.613065e-01 1 1  ON 31
eH1_2                -1.120559e-01 1 1  ON 32
eH1_3                -5.628011e-02 1 1  ON 33
eH1_4                -6.259349e-03 1 1  ON 34
eH1_5                 3.022806e-02 1 1  ON 35
eH1_6                 9.396364e-02 1 1  ON 36
eH1_7                 1.615166e-01 1 1  ON 37
eH1_8                 2.035461e-01 1 1  ON 38
eH1_9                 1.119319e-01 1 1  ON 39
eH2_0                -2.646164e-01 1 1  ON 40
eH2_1                -1.588809e-01 1 1  ON 41
eH2_2                -1.095269e-01 1 1  ON 42
eH2_3                -5.393671e-02 1 1  ON 43
eH2_4                -3.654445e-03 1 1  ON 44
eH2_5                 3.432789e-02 1 1  ON 45
eH2_6                 9.740914e-02 1 1  ON 46
eH2_7                 1.616762e-01 1 1  ON 47
eH2_8                 2.044987e-01 1 1  ON 48
eH2_9                 1.028460e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8647
    reference variance = 0.300559
====================================================
  Execution time = 1.9947e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3552e-01
  Total weights = 2.0000e+06
  Execution time = 1.8424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335487903969
                                         uncertainty =       0.003146447475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335487903969
                                         uncertainty =       0.003146447475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409585300
  error estimate for blocks of size 2^( 2) =       0.000421968614
  error estimate for blocks of size 2^( 3) =       0.000435003507
  error estimate for blocks of size 2^( 4) =       0.000446749792
  error estimate for blocks of size 2^( 5) =       0.000456758085
  error estimate for blocks of size 2^( 6) =       0.000464601357
  error estimate for blocks of size 2^( 7) =       0.000469196304

      target function =                  N/A
              le_mean =     -16.906882744498
             les_mean =     286.178204204937
             stat err =       0.000459326384
             autocorr =       1.257633397395
              std dev =       0.579241086669
             le_variance =       0.335520236485

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335493295334
                                         uncertainty =       0.003146506200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335493295334
                                         uncertainty =       0.003146506200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409588592
  error estimate for blocks of size 2^( 2) =       0.000421971706
  error estimate for blocks of size 2^( 3) =       0.000435006416
  error estimate for blocks of size 2^( 4) =       0.000446752582
  error estimate for blocks of size 2^( 5) =       0.000456760809
  error estimate for blocks of size 2^( 6) =       0.000464604029
  error estimate for blocks of size 2^( 7) =       0.000469199097

      target function =                  N/A
              le_mean =     -16.906882750756
             les_mean =     286.178209809558
             stat err =       0.000459329129
             autocorr =       1.257628213944
              std dev =       0.579245741906
             le_variance =       0.335525629517

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335490616136
                                         uncertainty =       0.003146477007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335490616136
                                         uncertainty =       0.003146477007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409586956
  error estimate for blocks of size 2^( 2) =       0.000421970170
  error estimate for blocks of size 2^( 3) =       0.000435004970
  error estimate for blocks of size 2^( 4) =       0.000446751196
  error estimate for blocks of size 2^( 5) =       0.000456759455
  error estimate for blocks of size 2^( 6) =       0.000464602701
  error estimate for blocks of size 2^( 7) =       0.000469197709

      target function =                  N/A
              le_mean =     -16.906882747644
             les_mean =     286.178207024310
             stat err =       0.000459327765
             autocorr =       1.257630789677
              std dev =       0.579243428528
             le_variance =       0.335522949493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335488243494
                                         uncertainty =       0.003146451172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335488243494
                                         uncertainty =       0.003146451172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409585508
  error estimate for blocks of size 2^( 2) =       0.000421968809
  error estimate for blocks of size 2^( 3) =       0.000435003690
  error estimate for blocks of size 2^( 4) =       0.000446749968
  error estimate for blocks of size 2^( 5) =       0.000456758256
  error estimate for blocks of size 2^( 6) =       0.000464601525
  error estimate for blocks of size 2^( 7) =       0.000469196480

      target function =                  N/A
              le_mean =     -16.906882744890
             les_mean =     286.178204557817
             stat err =       0.000459326557
             autocorr =       1.257633070924
              std dev =       0.579241379836
             le_variance =       0.335520576115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906882744498        initial
     3.7253e+01     3.7253e+02             6.4811e-06       -16.906882750756  <--
     1.4901e+02     1.4901e+03             1.6280e-06       -16.906882747644
     5.9605e+02     5.9605e+03             4.0748e-07       -16.906882744890

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 3.2279e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.122428e-01 1 1  ON 0
 uu_1                 1.443552e-01 1 1  ON 1
 uu_2                 4.228194e-02 1 1  ON 2
 uu_3                -2.087051e-02 1 1  ON 3
 uu_4                -6.736449e-02 1 1  ON 4
 uu_5                -1.039140e-01 1 1  ON 5
 uu_6                -1.333379e-01 1 1  ON 6
 uu_7                -1.493073e-01 1 1  ON 7
 uu_8                -1.427759e-01 1 1  ON 8
 uu_9                -1.123144e-01 1 1  ON 9
 ud_0                 4.541920e-01 1 1  ON 10
 ud_1                 1.880651e-01 1 1  ON 11
 ud_2                 6.717309e-02 1 1  ON 12
 ud_3                -4.483701e-03 1 1  ON 13
 ud_4                -6.219289e-02 1 1  ON 14
 ud_5                -1.047616e-01 1 1  ON 15
 ud_6                -1.335827e-01 1 1  ON 16
 ud_7                -1.510358e-01 1 1  ON 17
 ud_8                -1.519900e-01 1 1  ON 18
 ud_9                -1.432379e-01 1 1  ON 19
 eO_0                -7.497416e-01 1 1  ON 20
 eO_1                -4.277876e-01 1 1  ON 21
 eO_2                -1.252113e-02 1 1  ON 22
 eO_3                 3.045207e-01 1 1  ON 23
 eO_4                 5.326232e-01 1 1  ON 24
 eO_5                 4.975269e-01 1 1  ON 25
 eO_6                 2.673138e-01 1 1  ON 26
 eO_7                -4.317320e-02 1 1  ON 27
 eO_8                -2.433061e-01 1 1  ON 28
 eO_9                -1.175233e-01 1 1  ON 29
eH1_0                -2.674643e-01 1 1  ON 30
eH1_1                -1.613070e-01 1 1  ON 31
eH1_2                -1.120558e-01 1 1  ON 32
eH1_3                -5.628105e-02 1 1  ON 33
eH1_4                -6.258892e-03 1 1  ON 34
eH1_5                 3.022873e-02 1 1  ON 35
eH1_6                 9.396284e-02 1 1  ON 36
eH1_7                 1.615150e-01 1 1  ON 37
eH1_8                 2.035469e-01 1 1  ON 38
eH1_9                 1.119342e-01 1 1  ON 39
eH2_0                -2.646169e-01 1 1  ON 40
eH2_1                -1.588806e-01 1 1  ON 41
eH2_2                -1.095279e-01 1 1  ON 42
eH2_3                -5.393669e-02 1 1  ON 43
eH2_4                -3.655944e-03 1 1  ON 44
eH2_5                 3.432583e-02 1 1  ON 45
eH2_6                 9.740792e-02 1 1  ON 46
eH2_7                 1.616768e-01 1 1  ON 47
eH2_8                 2.045006e-01 1 1  ON 48
eH2_9                 1.028488e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8479e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9254
    reference variance = 0.233698
====================================================
  Execution time = 2.0683e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3976e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339780662194
                                         uncertainty =       0.003734044247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339780662194
                                         uncertainty =       0.003734044247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412166488
  error estimate for blocks of size 2^( 2) =       0.000424527282
  error estimate for blocks of size 2^( 3) =       0.000437239451
  error estimate for blocks of size 2^( 4) =       0.000449838282
  error estimate for blocks of size 2^( 5) =       0.000461174894
  error estimate for blocks of size 2^( 6) =       0.000469826131
  error estimate for blocks of size 2^( 7) =       0.000476654595

      target function =                  N/A
              le_mean =     -16.906436561751
             les_mean =     286.167359473796
             stat err =       0.000464373476
             autocorr =       1.269373584690
              std dev =       0.582891436866
             le_variance =       0.339762427172


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690643656175e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436561751       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906436565250       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906436533597       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906436519650       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906436536009       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906436545002       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906436547741       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906436541615       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.176135e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436561751       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906436562634       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906436554359       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906436550883       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906436554917       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906436557235       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906436557937       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906436556415       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 5.448021e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906436561751       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906436561972       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906436559880       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906436559012       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906436560016       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906436560600       residual = 4.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906436560777       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906436560397       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.362541e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.393790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6210e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.122386e-01 1 1  ON 0
 uu_1                 1.443561e-01 1 1  ON 1
 uu_2                 4.228221e-02 1 1  ON 2
 uu_3                -2.087105e-02 1 1  ON 3
 uu_4                -6.736604e-02 1 1  ON 4
 uu_5                -1.039127e-01 1 1  ON 5
 uu_6                -1.333364e-01 1 1  ON 6
 uu_7                -1.493068e-01 1 1  ON 7
 uu_8                -1.427754e-01 1 1  ON 8
 uu_9                -1.123170e-01 1 1  ON 9
 ud_0                 4.541914e-01 1 1  ON 10
 ud_1                 1.880660e-01 1 1  ON 11
 ud_2                 6.717209e-02 1 1  ON 12
 ud_3                -4.482540e-03 1 1  ON 13
 ud_4                -6.219197e-02 1 1  ON 14
 ud_5                -1.047616e-01 1 1  ON 15
 ud_6                -1.335776e-01 1 1  ON 16
 ud_7                -1.510366e-01 1 1  ON 17
 ud_8                -1.519946e-01 1 1  ON 18
 ud_9                -1.432385e-01 1 1  ON 19
 eO_0                -7.497427e-01 1 1  ON 20
 eO_1                -4.277873e-01 1 1  ON 21
 eO_2                -1.251891e-02 1 1  ON 22
 eO_3                 3.045222e-01 1 1  ON 23
 eO_4                 5.326250e-01 1 1  ON 24
 eO_5                 4.975261e-01 1 1  ON 25
 eO_6                 2.673160e-01 1 1  ON 26
 eO_7                -4.317335e-02 1 1  ON 27
 eO_8                -2.433088e-01 1 1  ON 28
 eO_9                -1.175262e-01 1 1  ON 29
eH1_0                -2.674640e-01 1 1  ON 30
eH1_1                -1.613078e-01 1 1  ON 31
eH1_2                -1.120549e-01 1 1  ON 32
eH1_3                -5.628544e-02 1 1  ON 33
eH1_4                -6.261468e-03 1 1  ON 34
eH1_5                 3.022751e-02 1 1  ON 35
eH1_6                 9.396063e-02 1 1  ON 36
eH1_7                 1.615159e-01 1 1  ON 37
eH1_8                 2.035496e-01 1 1  ON 38
eH1_9                 1.119397e-01 1 1  ON 39
eH2_0                -2.646167e-01 1 1  ON 40
eH2_1                -1.588824e-01 1 1  ON 41
eH2_2                -1.095287e-01 1 1  ON 42
eH2_3                -5.393664e-02 1 1  ON 43
eH2_4                -3.659362e-03 1 1  ON 44
eH2_5                 3.432401e-02 1 1  ON 45
eH2_6                 9.740890e-02 1 1  ON 46
eH2_7                 1.616785e-01 1 1  ON 47
eH2_8                 2.045021e-01 1 1  ON 48
eH2_9                 1.028519e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8771
    reference variance = 0.618725
====================================================
  Execution time = 2.0017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3506e-01
  Total weights = 2.0000e+06
  Execution time = 1.8411e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335141477180
                                         uncertainty =       0.002803672226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335141477180
                                         uncertainty =       0.002803672226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409303586
  error estimate for blocks of size 2^( 2) =       0.000422399484
  error estimate for blocks of size 2^( 3) =       0.000435622885
  error estimate for blocks of size 2^( 4) =       0.000447720135
  error estimate for blocks of size 2^( 5) =       0.000457357325
  error estimate for blocks of size 2^( 6) =       0.000466106228
  error estimate for blocks of size 2^( 7) =       0.000470346010

      target function =                  N/A
              le_mean =     -16.906158193006
             les_mean =     286.153243530947
             stat err =       0.000460382424
             autocorr =       1.265162676673
              std dev =       0.578842682895
             le_variance =       0.335058851541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335136872285
                                         uncertainty =       0.002803744955

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335136872285
                                         uncertainty =       0.002803744955

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409300776
  error estimate for blocks of size 2^( 2) =       0.000422396601
  error estimate for blocks of size 2^( 3) =       0.000435620030
  error estimate for blocks of size 2^( 4) =       0.000447717316
  error estimate for blocks of size 2^( 5) =       0.000457354540
  error estimate for blocks of size 2^( 6) =       0.000466103425
  error estimate for blocks of size 2^( 7) =       0.000470343415

      target function =                  N/A
              le_mean =     -16.906158269323
             les_mean =     286.153241510396
             stat err =       0.000460379674
             autocorr =       1.265164932907
              std dev =       0.578838708566
             le_variance =       0.335054250534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335139099669
                                         uncertainty =       0.002803709427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335139099669
                                         uncertainty =       0.002803709427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409302135
  error estimate for blocks of size 2^( 2) =       0.000422397996
  error estimate for blocks of size 2^( 3) =       0.000435621411
  error estimate for blocks of size 2^( 4) =       0.000447718679
  error estimate for blocks of size 2^( 5) =       0.000457355888
  error estimate for blocks of size 2^( 6) =       0.000466104778
  error estimate for blocks of size 2^( 7) =       0.000470344664

      target function =                  N/A
              le_mean =     -16.906158231002
             les_mean =     286.153242440172
             stat err =       0.000460381002
             autocorr =       1.265163830590
              std dev =       0.578840630926
             le_variance =       0.335056476011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335141177454
                                         uncertainty =       0.002803676903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335141177454
                                         uncertainty =       0.002803676903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409303403
  error estimate for blocks of size 2^( 2) =       0.000422399296
  error estimate for blocks of size 2^( 3) =       0.000435622699
  error estimate for blocks of size 2^( 4) =       0.000447719952
  error estimate for blocks of size 2^( 5) =       0.000457357144
  error estimate for blocks of size 2^( 6) =       0.000466106045
  error estimate for blocks of size 2^( 7) =       0.000470345840

      target function =                  N/A
              le_mean =     -16.906158197729
             les_mean =     286.153243391178
             stat err =       0.000460382245
             autocorr =       1.265162821671
              std dev =       0.578842424209
             le_variance =       0.335058552064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906158193006        initial
     9.3132e+00     9.3132e+01             2.1761e-05       -16.906158269323  <--
     3.7253e+01     3.7253e+02             5.4480e-06       -16.906158231002
     1.4901e+02     1.4901e+03             1.3625e-06       -16.906158197729

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.9322e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.122263e-01 1 1  ON 0
 uu_1                 1.443589e-01 1 1  ON 1
 uu_2                 4.228286e-02 1 1  ON 2
 uu_3                -2.087264e-02 1 1  ON 3
 uu_4                -6.737060e-02 1 1  ON 4
 uu_5                -1.039088e-01 1 1  ON 5
 uu_6                -1.333317e-01 1 1  ON 6
 uu_7                -1.493055e-01 1 1  ON 7
 uu_8                -1.427740e-01 1 1  ON 8
 uu_9                -1.123246e-01 1 1  ON 9
 ud_0                 4.541899e-01 1 1  ON 10
 ud_1                 1.880685e-01 1 1  ON 11
 ud_2                 6.716930e-02 1 1  ON 12
 ud_3                -4.479270e-03 1 1  ON 13
 ud_4                -6.218921e-02 1 1  ON 14
 ud_5                -1.047614e-01 1 1  ON 15
 ud_6                -1.335624e-01 1 1  ON 16
 ud_7                -1.510391e-01 1 1  ON 17
 ud_8                -1.520084e-01 1 1  ON 18
 ud_9                -1.432404e-01 1 1  ON 19
 eO_0                -7.497458e-01 1 1  ON 20
 eO_1                -4.277865e-01 1 1  ON 21
 eO_2                -1.251235e-02 1 1  ON 22
 eO_3                 3.045269e-01 1 1  ON 23
 eO_4                 5.326302e-01 1 1  ON 24
 eO_5                 4.975237e-01 1 1  ON 25
 eO_6                 2.673226e-01 1 1  ON 26
 eO_7                -4.317376e-02 1 1  ON 27
 eO_8                -2.433168e-01 1 1  ON 28
 eO_9                -1.175349e-01 1 1  ON 29
eH1_0                -2.674633e-01 1 1  ON 30
eH1_1                -1.613100e-01 1 1  ON 31
eH1_2                -1.120524e-01 1 1  ON 32
eH1_3                -5.629837e-02 1 1  ON 33
eH1_4                -6.269262e-03 1 1  ON 34
eH1_5                 3.022383e-02 1 1  ON 35
eH1_6                 9.395405e-02 1 1  ON 36
eH1_7                 1.615187e-01 1 1  ON 37
eH1_8                 2.035575e-01 1 1  ON 38
eH1_9                 1.119560e-01 1 1  ON 39
eH2_0                -2.646160e-01 1 1  ON 40
eH2_1                -1.588876e-01 1 1  ON 41
eH2_2                -1.095308e-01 1 1  ON 42
eH2_3                -5.393658e-02 1 1  ON 43
eH2_4                -3.669479e-03 1 1  ON 44
eH2_5                 3.431853e-02 1 1  ON 45
eH2_6                 9.741181e-02 1 1  ON 46
eH2_7                 1.616835e-01 1 1  ON 47
eH2_8                 2.045064e-01 1 1  ON 48
eH2_9                 1.028611e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5538e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9044
    reference variance = 0.21871
====================================================
  Execution time = 2.0739e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3759e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4882e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337596501949
                                         uncertainty =       0.003344856933

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337596501949
                                         uncertainty =       0.003344856933

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410849254
  error estimate for blocks of size 2^( 2) =       0.000423239532
  error estimate for blocks of size 2^( 3) =       0.000436262990
  error estimate for blocks of size 2^( 4) =       0.000447709255
  error estimate for blocks of size 2^( 5) =       0.000457807169
  error estimate for blocks of size 2^( 6) =       0.000465152406
  error estimate for blocks of size 2^( 7) =       0.000471419163

      target function =                  N/A
              le_mean =     -16.906693964649
             les_mean =     286.173894865234
             stat err =       0.000460521998
             autocorr =       1.256422642886
              std dev =       0.581028587714
             le_variance =       0.337594219741


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690669396465e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906693964649       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906694375932       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906694367682       residual = 7.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906694320617       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906694331055       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906694257811       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906694312525       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906694329074       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 7.150206e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906693964649       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906694073701       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906694073725       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906694061755       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906694060476       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906694042665       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906694057647       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906694060793       residual = 3.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 1.808890e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906693964649       residual = 3.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906693992331       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906693992500       residual = 8.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906693989500       residual = 7.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906693988879       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906693984451       residual = 6.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906693988300       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906693989024       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 4.534804e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.396432 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6235e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.122107e-01 1 1  ON 0
 uu_1                 1.443575e-01 1 1  ON 1
 uu_2                 4.228608e-02 1 1  ON 2
 uu_3                -2.087314e-02 1 1  ON 3
 uu_4                -6.737240e-02 1 1  ON 4
 uu_5                -1.039024e-01 1 1  ON 5
 uu_6                -1.333293e-01 1 1  ON 6
 uu_7                -1.492938e-01 1 1  ON 7
 uu_8                -1.427819e-01 1 1  ON 8
 uu_9                -1.123335e-01 1 1  ON 9
 ud_0                 4.541918e-01 1 1  ON 10
 ud_1                 1.880861e-01 1 1  ON 11
 ud_2                 6.717177e-02 1 1  ON 12
 ud_3                -4.479109e-03 1 1  ON 13
 ud_4                -6.217762e-02 1 1  ON 14
 ud_5                -1.047584e-01 1 1  ON 15
 ud_6                -1.335584e-01 1 1  ON 16
 ud_7                -1.510421e-01 1 1  ON 17
 ud_8                -1.520220e-01 1 1  ON 18
 ud_9                -1.432562e-01 1 1  ON 19
 eO_0                -7.497413e-01 1 1  ON 20
 eO_1                -4.277946e-01 1 1  ON 21
 eO_2                -1.249509e-02 1 1  ON 22
 eO_3                 3.045354e-01 1 1  ON 23
 eO_4                 5.326372e-01 1 1  ON 24
 eO_5                 4.975206e-01 1 1  ON 25
 eO_6                 2.673294e-01 1 1  ON 26
 eO_7                -4.317326e-02 1 1  ON 27
 eO_8                -2.433328e-01 1 1  ON 28
 eO_9                -1.175501e-01 1 1  ON 29
eH1_0                -2.674633e-01 1 1  ON 30
eH1_1                -1.613211e-01 1 1  ON 31
eH1_2                -1.120579e-01 1 1  ON 32
eH1_3                -5.630709e-02 1 1  ON 33
eH1_4                -6.270894e-03 1 1  ON 34
eH1_5                 3.022698e-02 1 1  ON 35
eH1_6                 9.395092e-02 1 1  ON 36
eH1_7                 1.615139e-01 1 1  ON 37
eH1_8                 2.035660e-01 1 1  ON 38
eH1_9                 1.119741e-01 1 1  ON 39
eH2_0                -2.646253e-01 1 1  ON 40
eH2_1                -1.588799e-01 1 1  ON 41
eH2_2                -1.095362e-01 1 1  ON 42
eH2_3                -5.392960e-02 1 1  ON 43
eH2_4                -3.663081e-03 1 1  ON 44
eH2_5                 3.431467e-02 1 1  ON 45
eH2_6                 9.740645e-02 1 1  ON 46
eH2_7                 1.616801e-01 1 1  ON 47
eH2_8                 2.045047e-01 1 1  ON 48
eH2_9                 1.028706e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9859
    reference variance = 0.409797
====================================================
  Execution time = 2.0318e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3893e-01
  Total weights = 2.0000e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338984905614
                                         uncertainty =       0.003736890613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338984905614
                                         uncertainty =       0.003736890613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411667065
  error estimate for blocks of size 2^( 2) =       0.000424592717
  error estimate for blocks of size 2^( 3) =       0.000437489419
  error estimate for blocks of size 2^( 4) =       0.000449599698
  error estimate for blocks of size 2^( 5) =       0.000460641379
  error estimate for blocks of size 2^( 6) =       0.000467917406
  error estimate for blocks of size 2^( 7) =       0.000472920900

      target function =                  N/A
              le_mean =     -16.906632503869
             les_mean =     286.173161995977
             stat err =       0.000462769846
             autocorr =       1.263682172082
              std dev =       0.582185146289
             le_variance =       0.338939544560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338953449099
                                         uncertainty =       0.003737449965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338953449099
                                         uncertainty =       0.003737449965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411647955
  error estimate for blocks of size 2^( 2) =       0.000424573734
  error estimate for blocks of size 2^( 3) =       0.000437469903
  error estimate for blocks of size 2^( 4) =       0.000449580145
  error estimate for blocks of size 2^( 5) =       0.000460622246
  error estimate for blocks of size 2^( 6) =       0.000467897201
  error estimate for blocks of size 2^( 7) =       0.000472901073

      target function =                  N/A
              le_mean =     -16.906632595534
             les_mean =     286.173133628565
             stat err =       0.000462750166
             autocorr =       1.263692018373
              std dev =       0.582158120836
             le_variance =       0.338908077655

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338965930471
                                         uncertainty =       0.003737188915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338965930471
                                         uncertainty =       0.003737188915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411655538
  error estimate for blocks of size 2^( 2) =       0.000424581316
  error estimate for blocks of size 2^( 3) =       0.000437477765
  error estimate for blocks of size 2^( 4) =       0.000449588059
  error estimate for blocks of size 2^( 5) =       0.000460630001
  error estimate for blocks of size 2^( 6) =       0.000467905383
  error estimate for blocks of size 2^( 7) =       0.000472909120

      target function =                  N/A
              le_mean =     -16.906632561208
             les_mean =     286.173144954454
             stat err =       0.000462758141
             autocorr =       1.263689015252
              std dev =       0.582168845108
             le_variance =       0.338920564214

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338982404405
                                         uncertainty =       0.003736928490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338982404405
                                         uncertainty =       0.003736928490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411665545
  error estimate for blocks of size 2^( 2) =       0.000424591216
  error estimate for blocks of size 2^( 3) =       0.000437487887
  error estimate for blocks of size 2^( 4) =       0.000449598169
  error estimate for blocks of size 2^( 5) =       0.000460639884
  error estimate for blocks of size 2^( 6) =       0.000467915826
  error estimate for blocks of size 2^( 7) =       0.000472919354

      target function =                  N/A
              le_mean =     -16.906632511036
             les_mean =     286.173159736456
             stat err =       0.000462768308
             autocorr =       1.263683104220
              std dev =       0.582182997605
             le_variance =       0.338937042700


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906632503869        initial
     2.3283e+00     2.3283e+01             7.1502e-05       -16.906632595534  <--
     9.3132e+00     9.3132e+01             1.8089e-05       -16.906632561208
     3.7253e+01     3.7253e+02             4.5348e-06       -16.906632511036

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 2.9738e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.121665e-01 1 1  ON 0
 uu_1                 1.443543e-01 1 1  ON 1
 uu_2                 4.229314e-02 1 1  ON 2
 uu_3                -2.087413e-02 1 1  ON 3
 uu_4                -6.737690e-02 1 1  ON 4
 uu_5                -1.038846e-01 1 1  ON 5
 uu_6                -1.333220e-01 1 1  ON 6
 uu_7                -1.492597e-01 1 1  ON 7
 uu_8                -1.428053e-01 1 1  ON 8
 uu_9                -1.123602e-01 1 1  ON 9
 ud_0                 4.542034e-01 1 1  ON 10
 ud_1                 1.881320e-01 1 1  ON 11
 ud_2                 6.718164e-02 1 1  ON 12
 ud_3                -4.477303e-03 1 1  ON 13
 ud_4                -6.214669e-02 1 1  ON 14
 ud_5                -1.047483e-01 1 1  ON 15
 ud_6                -1.335474e-01 1 1  ON 16
 ud_7                -1.510510e-01 1 1  ON 17
 ud_8                -1.520625e-01 1 1  ON 18
 ud_9                -1.433034e-01 1 1  ON 19
 eO_0                -7.497282e-01 1 1  ON 20
 eO_1                -4.278146e-01 1 1  ON 21
 eO_2                -1.244785e-02 1 1  ON 22
 eO_3                 3.045601e-01 1 1  ON 23
 eO_4                 5.326585e-01 1 1  ON 24
 eO_5                 4.975116e-01 1 1  ON 25
 eO_6                 2.673490e-01 1 1  ON 26
 eO_7                -4.317189e-02 1 1  ON 27
 eO_8                -2.433801e-01 1 1  ON 28
 eO_9                -1.175950e-01 1 1  ON 29
eH1_0                -2.674641e-01 1 1  ON 30
eH1_1                -1.613527e-01 1 1  ON 31
eH1_2                -1.120749e-01 1 1  ON 32
eH1_3                -5.633190e-02 1 1  ON 33
eH1_4                -6.277008e-03 1 1  ON 34
eH1_5                 3.023669e-02 1 1  ON 35
eH1_6                 9.394204e-02 1 1  ON 36
eH1_7                 1.614997e-01 1 1  ON 37
eH1_8                 2.035909e-01 1 1  ON 38
eH1_9                 1.120275e-01 1 1  ON 39
eH2_0                -2.646516e-01 1 1  ON 40
eH2_1                -1.588587e-01 1 1  ON 41
eH2_2                -1.095494e-01 1 1  ON 42
eH2_3                -5.391008e-02 1 1  ON 43
eH2_4                -3.644640e-03 1 1  ON 44
eH2_5                 3.430380e-02 1 1  ON 45
eH2_6                 9.739017e-02 1 1  ON 46
eH2_7                 1.616696e-01 1 1  ON 47
eH2_8                 2.044996e-01 1 1  ON 48
eH2_9                 1.028989e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5979e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.8546
    reference variance = 0.241936
====================================================
  Execution time = 2.0326e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4001e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340006326889
                                         uncertainty =       0.007068503081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340006326889
                                         uncertainty =       0.007068503081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412317048
  error estimate for blocks of size 2^( 2) =       0.000424630180
  error estimate for blocks of size 2^( 3) =       0.000437389899
  error estimate for blocks of size 2^( 4) =       0.000448368556
  error estimate for blocks of size 2^( 5) =       0.000460046296
  error estimate for blocks of size 2^( 6) =       0.000467485756
  error estimate for blocks of size 2^( 7) =       0.000470929132

      target function =                  N/A
              le_mean =     -16.905706594460
             les_mean =     286.142925984379
             stat err =       0.000461707435
             autocorr =       1.253923819421
              std dev =       0.583104361501
             le_variance =       0.340010696401


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690570659446e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905706594460       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905706363208       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905706313935       residual = 1.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905706226431       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905706388811       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905706887922       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905707298532       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905707137701       residual = 4.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 3.438206e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905706594460       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905706520106       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905706502468       residual = 7.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905706445500       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905706482057       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905706581726       residual = 7.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905706733103       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905706671934       residual = 3.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 9.234069e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905706594460       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905706574440       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905706569491       residual = 6.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905706551501       residual = 3.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905706559273       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905706581991       residual = 6.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905706623905       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905706609571       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+00 is 2.358202e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.399061 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5868e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.121056e-01 1 1  ON 0
 uu_1                 1.443482e-01 1 1  ON 1
 uu_2                 4.229978e-02 1 1  ON 2
 uu_3                -2.087730e-02 1 1  ON 3
 uu_4                -6.736674e-02 1 1  ON 4
 uu_5                -1.038854e-01 1 1  ON 5
 uu_6                -1.332782e-01 1 1  ON 6
 uu_7                -1.492413e-01 1 1  ON 7
 uu_8                -1.428524e-01 1 1  ON 8
 uu_9                -1.123932e-01 1 1  ON 9
 ud_0                 4.542263e-01 1 1  ON 10
 ud_1                 1.881657e-01 1 1  ON 11
 ud_2                 6.718973e-02 1 1  ON 12
 ud_3                -4.462908e-03 1 1  ON 13
 ud_4                -6.213349e-02 1 1  ON 14
 ud_5                -1.047576e-01 1 1  ON 15
 ud_6                -1.335021e-01 1 1  ON 16
 ud_7                -1.510390e-01 1 1  ON 17
 ud_8                -1.521549e-01 1 1  ON 18
 ud_9                -1.433574e-01 1 1  ON 19
 eO_0                -7.496981e-01 1 1  ON 20
 eO_1                -4.278310e-01 1 1  ON 21
 eO_2                -1.244021e-02 1 1  ON 22
 eO_3                 3.045895e-01 1 1  ON 23
 eO_4                 5.327115e-01 1 1  ON 24
 eO_5                 4.974940e-01 1 1  ON 25
 eO_6                 2.673951e-01 1 1  ON 26
 eO_7                -4.318024e-02 1 1  ON 27
 eO_8                -2.434435e-01 1 1  ON 28
 eO_9                -1.176484e-01 1 1  ON 29
eH1_0                -2.674602e-01 1 1  ON 30
eH1_1                -1.613972e-01 1 1  ON 31
eH1_2                -1.120851e-01 1 1  ON 32
eH1_3                -5.633120e-02 1 1  ON 33
eH1_4                -6.298494e-03 1 1  ON 34
eH1_5                 3.020770e-02 1 1  ON 35
eH1_6                 9.391998e-02 1 1  ON 36
eH1_7                 1.614995e-01 1 1  ON 37
eH1_8                 2.036203e-01 1 1  ON 38
eH1_9                 1.120912e-01 1 1  ON 39
eH2_0                -2.646932e-01 1 1  ON 40
eH2_1                -1.588626e-01 1 1  ON 41
eH2_2                -1.095423e-01 1 1  ON 42
eH2_3                -5.389869e-02 1 1  ON 43
eH2_4                -3.656236e-03 1 1  ON 44
eH2_5                 3.424454e-02 1 1  ON 45
eH2_6                 9.736484e-02 1 1  ON 46
eH2_7                 1.616746e-01 1 1  ON 47
eH2_8                 2.045335e-01 1 1  ON 48
eH2_9                 1.029700e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9828
    reference variance = 0.236841
====================================================
  Execution time = 1.9854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4848e-01
  Total weights = 2.0000e+06
  Execution time = 1.8446e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348616727619
                                         uncertainty =       0.011664298848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348616727619
                                         uncertainty =       0.011664298848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417436332
  error estimate for blocks of size 2^( 2) =       0.000429930640
  error estimate for blocks of size 2^( 3) =       0.000442591974
  error estimate for blocks of size 2^( 4) =       0.000454236085
  error estimate for blocks of size 2^( 5) =       0.000463889011
  error estimate for blocks of size 2^( 6) =       0.000471536682
  error estimate for blocks of size 2^( 7) =       0.000476223407

      target function =                  N/A
              le_mean =     -16.906109338588
             les_mean =     286.165038977398
             stat err =       0.000466471296
             autocorr =       1.248732335838
              std dev =       0.590344122828
             le_variance =       0.348506183358

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348553123622
                                         uncertainty =       0.011658652624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348553123622
                                         uncertainty =       0.011658652624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417398238
  error estimate for blocks of size 2^( 2) =       0.000429892631
  error estimate for blocks of size 2^( 3) =       0.000442553998
  error estimate for blocks of size 2^( 4) =       0.000454198610
  error estimate for blocks of size 2^( 5) =       0.000463854257
  error estimate for blocks of size 2^( 6) =       0.000471503131
  error estimate for blocks of size 2^( 7) =       0.000476188427

      target function =                  N/A
              le_mean =     -16.906109667433
             les_mean =     286.164986490964
             stat err =       0.000466436106
             autocorr =       1.248771850165
              std dev =       0.590290248860
             le_variance =       0.348442577899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348572960879
                                         uncertainty =       0.011660787996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348572960879
                                         uncertainty =       0.011660787996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417410120
  error estimate for blocks of size 2^( 2) =       0.000429904468
  error estimate for blocks of size 2^( 3) =       0.000442565959
  error estimate for blocks of size 2^( 4) =       0.000454210495
  error estimate for blocks of size 2^( 5) =       0.000463865318
  error estimate for blocks of size 2^( 6) =       0.000471513503
  error estimate for blocks of size 2^( 7) =       0.000476199451

      target function =                  N/A
              le_mean =     -16.906109622903
             les_mean =     286.165004824057
             stat err =       0.000466447192
             autocorr =       1.248760109301
              std dev =       0.590307052867
             le_variance =       0.348462416665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348610466381
                                         uncertainty =       0.011663826457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348610466381
                                         uncertainty =       0.011663826457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417432583
  error estimate for blocks of size 2^( 2) =       0.000429926898
  error estimate for blocks of size 2^( 3) =       0.000442588261
  error estimate for blocks of size 2^( 4) =       0.000454232434
  error estimate for blocks of size 2^( 5) =       0.000463885626
  error estimate for blocks of size 2^( 6) =       0.000471533358
  error estimate for blocks of size 2^( 7) =       0.000476219988

      target function =                  N/A
              le_mean =     -16.906109379104
             les_mean =     286.165034086108
             stat err =       0.000466467852
             autocorr =       1.248736327843
              std dev =       0.590338819778
             le_variance =       0.348499922137


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906109338588        initial
     5.8208e-01     5.8208e+00             3.4382e-04       -16.906109667433  <--
     2.3283e+00     2.3283e+01             9.2341e-05       -16.906109622903
     9.3132e+00     9.3132e+01             2.3582e-05       -16.906109379104

*****************************************************************************
Applying the update for shift_i =   5.8208e-01     and shift_s =   5.8208e+00
*****************************************************************************

  Execution time = 2.9180e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.119607e-01 1 1  ON 0
 uu_1                 1.443300e-01 1 1  ON 1
 uu_2                 4.229413e-02 1 1  ON 2
 uu_3                -2.087792e-02 1 1  ON 3
 uu_4                -6.734708e-02 1 1  ON 4
 uu_5                -1.038748e-01 1 1  ON 5
 uu_6                -1.331775e-01 1 1  ON 6
 uu_7                -1.491847e-01 1 1  ON 7
 uu_8                -1.429798e-01 1 1  ON 8
 uu_9                -1.124903e-01 1 1  ON 9
 ud_0                 4.542995e-01 1 1  ON 10
 ud_1                 1.882474e-01 1 1  ON 11
 ud_2                 6.723053e-02 1 1  ON 12
 ud_3                -4.425333e-03 1 1  ON 13
 ud_4                -6.210712e-02 1 1  ON 14
 ud_5                -1.047532e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.509996e-01 1 1  ON 17
 ud_8                -1.524064e-01 1 1  ON 18
 ud_9                -1.435161e-01 1 1  ON 19
 eO_0                -7.496292e-01 1 1  ON 20
 eO_1                -4.278534e-01 1 1  ON 21
 eO_2                -1.241765e-02 1 1  ON 22
 eO_3                 3.046672e-01 1 1  ON 23
 eO_4                 5.328614e-01 1 1  ON 24
 eO_5                 4.974471e-01 1 1  ON 25
 eO_6                 2.675257e-01 1 1  ON 26
 eO_7                -4.320125e-02 1 1  ON 27
 eO_8                -2.436273e-01 1 1  ON 28
 eO_9                -1.178040e-01 1 1  ON 29
eH1_0                -2.674592e-01 1 1  ON 30
eH1_1                -1.614974e-01 1 1  ON 31
eH1_2                -1.121241e-01 1 1  ON 32
eH1_3                -5.633679e-02 1 1  ON 33
eH1_4                -6.361336e-03 1 1  ON 34
eH1_5                 3.012095e-02 1 1  ON 35
eH1_6                 9.385717e-02 1 1  ON 36
eH1_7                 1.615002e-01 1 1  ON 37
eH1_8                 2.037061e-01 1 1  ON 38
eH1_9                 1.122754e-01 1 1  ON 39
eH2_0                -2.648023e-01 1 1  ON 40
eH2_1                -1.588649e-01 1 1  ON 41
eH2_2                -1.095304e-01 1 1  ON 42
eH2_3                -5.387649e-02 1 1  ON 43
eH2_4                -3.690149e-03 1 1  ON 44
eH2_5                 3.407624e-02 1 1  ON 45
eH2_6                 9.728846e-02 1 1  ON 46
eH2_7                 1.616882e-01 1 1  ON 47
eH2_8                 2.046323e-01 1 1  ON 48
eH2_9                 1.031759e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5054e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9283
    reference variance = 0.395227
====================================================
  Execution time = 2.0162e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.3673e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336761503443
                                         uncertainty =       0.003349514865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336761503443
                                         uncertainty =       0.003349514865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410325040
  error estimate for blocks of size 2^( 2) =       0.000423380898
  error estimate for blocks of size 2^( 3) =       0.000436375188
  error estimate for blocks of size 2^( 4) =       0.000448111651
  error estimate for blocks of size 2^( 5) =       0.000459449783
  error estimate for blocks of size 2^( 6) =       0.000468884377
  error estimate for blocks of size 2^( 7) =       0.000473832580

      target function =                  N/A
              le_mean =     -16.906537529799
             les_mean =     286.167744355293
             stat err =       0.000462569598
             autocorr =       1.270861226171
              std dev =       0.580287236763
             le_variance =       0.336733277150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690653752980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-01, overlap shift 1.4552e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906537529799       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906538906448       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906539614694       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906540528963       residual = 8.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906539962271       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906538722811       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906539317794       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906541592232       residual = 6.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906541230192       residual = 3.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.906541101689       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.906540770042       residual = 9.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e-01 is 1.140045e-03

solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906537529799       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906538157358       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906538317044       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906538615276       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906538577157       residual = 5.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906538400227       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906538383248       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906538422409       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.906538682957       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e-01 is 2.847804e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906537529799       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906537727358       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906537748258       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906537838893       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906537833298       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906537828408       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906537817031       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906537790601       residual = 5.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+00 is 7.397736e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.402428 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5617e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.118578e-01 1 1  ON 0
 uu_1                 1.443744e-01 1 1  ON 1
 uu_2                 4.223927e-02 1 1  ON 2
 uu_3                -2.095362e-02 1 1  ON 3
 uu_4                -6.751913e-02 1 1  ON 4
 uu_5                -1.038987e-01 1 1  ON 5
 uu_6                -1.331353e-01 1 1  ON 6
 uu_7                -1.490356e-01 1 1  ON 7
 uu_8                -1.428911e-01 1 1  ON 8
 uu_9                -1.125504e-01 1 1  ON 9
 ud_0                 4.542259e-01 1 1  ON 10
 ud_1                 1.881708e-01 1 1  ON 11
 ud_2                 6.736095e-02 1 1  ON 12
 ud_3                -4.416343e-03 1 1  ON 13
 ud_4                -6.197847e-02 1 1  ON 14
 ud_5                -1.046884e-01 1 1  ON 15
 ud_6                -1.332834e-01 1 1  ON 16
 ud_7                -1.510751e-01 1 1  ON 17
 ud_8                -1.524752e-01 1 1  ON 18
 ud_9                -1.434974e-01 1 1  ON 19
 eO_0                -7.496438e-01 1 1  ON 20
 eO_1                -4.278522e-01 1 1  ON 21
 eO_2                -1.237510e-02 1 1  ON 22
 eO_3                 3.048330e-01 1 1  ON 23
 eO_4                 5.329290e-01 1 1  ON 24
 eO_5                 4.974795e-01 1 1  ON 25
 eO_6                 2.676763e-01 1 1  ON 26
 eO_7                -4.320860e-02 1 1  ON 27
 eO_8                -2.437871e-01 1 1  ON 28
 eO_9                -1.180388e-01 1 1  ON 29
eH1_0                -2.674809e-01 1 1  ON 30
eH1_1                -1.615087e-01 1 1  ON 31
eH1_2                -1.120854e-01 1 1  ON 32
eH1_3                -5.643303e-02 1 1  ON 33
eH1_4                -6.613204e-03 1 1  ON 34
eH1_5                 2.996631e-02 1 1  ON 35
eH1_6                 9.394522e-02 1 1  ON 36
eH1_7                 1.615443e-01 1 1  ON 37
eH1_8                 2.037044e-01 1 1  ON 38
eH1_9                 1.125448e-01 1 1  ON 39
eH2_0                -2.650188e-01 1 1  ON 40
eH2_1                -1.588709e-01 1 1  ON 41
eH2_2                -1.096471e-01 1 1  ON 42
eH2_3                -5.387721e-02 1 1  ON 43
eH2_4                -3.719327e-03 1 1  ON 44
eH2_5                 3.380451e-02 1 1  ON 45
eH2_6                 9.741193e-02 1 1  ON 46
eH2_7                 1.617793e-01 1 1  ON 47
eH2_8                 2.047526e-01 1 1  ON 48
eH2_9                 1.034607e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9342
    reference variance = 0.607727
====================================================
  Execution time = 1.9920e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3428e-01
  Total weights = 2.0000e+06
  Execution time = 1.8455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334432552675
                                         uncertainty =       0.002858868863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334432552675
                                         uncertainty =       0.002858868863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408906521
  error estimate for blocks of size 2^( 2) =       0.000421678989
  error estimate for blocks of size 2^( 3) =       0.000435308494
  error estimate for blocks of size 2^( 4) =       0.000448177642
  error estimate for blocks of size 2^( 5) =       0.000459707419
  error estimate for blocks of size 2^( 6) =       0.000468693563
  error estimate for blocks of size 2^( 7) =       0.000474733060

      target function =                  N/A
              le_mean =     -16.905972048426
             les_mean =     286.146299820543
             stat err =       0.000462827921
             autocorr =       1.281123590599
              std dev =       0.578281147530
             le_variance =       0.334409085589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202312558
                                         uncertainty =       0.002857465604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334202312558
                                         uncertainty =       0.002857465604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408765786
  error estimate for blocks of size 2^( 2) =       0.000421547116
  error estimate for blocks of size 2^( 3) =       0.000435186586
  error estimate for blocks of size 2^( 4) =       0.000448069600
  error estimate for blocks of size 2^( 5) =       0.000459609381
  error estimate for blocks of size 2^( 6) =       0.000468589514
  error estimate for blocks of size 2^( 7) =       0.000474620140

      target function =                  N/A
              le_mean =     -16.905969514174
             les_mean =     286.145983981947
             stat err =       0.000462722159
             autocorr =       1.281420064621
              std dev =       0.578082117750
             le_variance =       0.334178934863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334181787453
                                         uncertainty =       0.002857195459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334181787453
                                         uncertainty =       0.002857195459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408753249
  error estimate for blocks of size 2^( 2) =       0.000421535378
  error estimate for blocks of size 2^( 3) =       0.000435175187
  error estimate for blocks of size 2^( 4) =       0.000448057175
  error estimate for blocks of size 2^( 5) =       0.000459598148
  error estimate for blocks of size 2^( 6) =       0.000468581141
  error estimate for blocks of size 2^( 7) =       0.000474614263

      target function =                  N/A
              le_mean =     -16.905968771898
             les_mean =     286.145938386827
             stat err =       0.000462712682
             autocorr =       1.281446174157
              std dev =       0.578064388718
             le_variance =       0.334158437504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334385975472
                                         uncertainty =       0.002858520069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334385975472
                                         uncertainty =       0.002858520069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408878058
  error estimate for blocks of size 2^( 2) =       0.000421652256
  error estimate for blocks of size 2^( 3) =       0.000435283474
  error estimate for blocks of size 2^( 4) =       0.000448154826
  error estimate for blocks of size 2^( 5) =       0.000459686666
  error estimate for blocks of size 2^( 6) =       0.000468672503
  error estimate for blocks of size 2^( 7) =       0.000474711052

      target function =                  N/A
              le_mean =     -16.905971307634
             les_mean =     286.146228220612
             stat err =       0.000462806262
             autocorr =       1.281182037350
              std dev =       0.578240895507
             le_variance =       0.334362533237


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905972048426        initial  <--
     1.4552e-01     1.4552e+00             1.1400e-03       -16.905969514174
     5.8208e-01     5.8208e+00             2.8478e-04       -16.905968771898
     2.3283e+00     2.3283e+01             7.3977e-05       -16.905971307634

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2485
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.119607e-01 1 1  ON 0
 uu_1                 1.443300e-01 1 1  ON 1
 uu_2                 4.229413e-02 1 1  ON 2
 uu_3                -2.087792e-02 1 1  ON 3
 uu_4                -6.734708e-02 1 1  ON 4
 uu_5                -1.038748e-01 1 1  ON 5
 uu_6                -1.331775e-01 1 1  ON 6
 uu_7                -1.491847e-01 1 1  ON 7
 uu_8                -1.429798e-01 1 1  ON 8
 uu_9                -1.124903e-01 1 1  ON 9
 ud_0                 4.542995e-01 1 1  ON 10
 ud_1                 1.882474e-01 1 1  ON 11
 ud_2                 6.723053e-02 1 1  ON 12
 ud_3                -4.425333e-03 1 1  ON 13
 ud_4                -6.210712e-02 1 1  ON 14
 ud_5                -1.047532e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.509996e-01 1 1  ON 17
 ud_8                -1.524064e-01 1 1  ON 18
 ud_9                -1.435161e-01 1 1  ON 19
 eO_0                -7.496292e-01 1 1  ON 20
 eO_1                -4.278534e-01 1 1  ON 21
 eO_2                -1.241765e-02 1 1  ON 22
 eO_3                 3.046672e-01 1 1  ON 23
 eO_4                 5.328614e-01 1 1  ON 24
 eO_5                 4.974471e-01 1 1  ON 25
 eO_6                 2.675257e-01 1 1  ON 26
 eO_7                -4.320125e-02 1 1  ON 27
 eO_8                -2.436273e-01 1 1  ON 28
 eO_9                -1.178040e-01 1 1  ON 29
eH1_0                -2.674592e-01 1 1  ON 30
eH1_1                -1.614974e-01 1 1  ON 31
eH1_2                -1.121241e-01 1 1  ON 32
eH1_3                -5.633679e-02 1 1  ON 33
eH1_4                -6.361336e-03 1 1  ON 34
eH1_5                 3.012095e-02 1 1  ON 35
eH1_6                 9.385717e-02 1 1  ON 36
eH1_7                 1.615002e-01 1 1  ON 37
eH1_8                 2.037061e-01 1 1  ON 38
eH1_9                 1.122754e-01 1 1  ON 39
eH2_0                -2.648023e-01 1 1  ON 40
eH2_1                -1.588649e-01 1 1  ON 41
eH2_2                -1.095304e-01 1 1  ON 42
eH2_3                -5.387649e-02 1 1  ON 43
eH2_4                -3.690149e-03 1 1  ON 44
eH2_5                 3.407624e-02 1 1  ON 45
eH2_6                 9.728846e-02 1 1  ON 46
eH2_7                 1.616882e-01 1 1  ON 47
eH2_8                 2.046323e-01 1 1  ON 48
eH2_9                 1.031759e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4872e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.967
    reference variance = 0.248444
====================================================
  Execution time = 2.0643e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.9588e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396058611317
                                         uncertainty =       0.055673863715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396058611317
                                         uncertainty =       0.055673863715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444904928
  error estimate for blocks of size 2^( 2) =       0.000456901501
  error estimate for blocks of size 2^( 3) =       0.000470053324
  error estimate for blocks of size 2^( 4) =       0.000481815467
  error estimate for blocks of size 2^( 5) =       0.000492445802
  error estimate for blocks of size 2^( 6) =       0.000498813816
  error estimate for blocks of size 2^( 7) =       0.000504041660

      target function =                  N/A
              le_mean =     -16.905991950824
             les_mean =     286.208444433107
             stat err =       0.000494279186
             autocorr =       1.234270115287
              std dev =       0.629190583001
             le_variance =       0.395880789737


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690599195082e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+00, overlap shift 1.4552e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905991950824       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905992243146       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905992283822       residual = 9.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905992183204       residual = 3.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905992421479       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905992270029       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905992320177       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905992336902       residual = 5.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+00 is 1.054997e-04

solving harmonic davidson linear method for identity shift 5.8208e+00, overlap shift 5.8208e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905991950824       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905992029877       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905992036255       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905992010569       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905992066982       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905992027331       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905992040004       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905992045773       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+00 is 2.663747e-05

solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905991950824       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905991970999       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905991972271       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905991965802       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905991979473       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905991969513       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905991972627       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905991974171       residual = 2.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+01 is 6.674044e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.405079 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6150e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.119550e-01 1 1  ON 0
 uu_1                 1.443339e-01 1 1  ON 1
 uu_2                 4.228948e-02 1 1  ON 2
 uu_3                -2.086783e-02 1 1  ON 3
 uu_4                -6.734228e-02 1 1  ON 4
 uu_5                -1.038713e-01 1 1  ON 5
 uu_6                -1.331739e-01 1 1  ON 6
 uu_7                -1.491847e-01 1 1  ON 7
 uu_8                -1.430046e-01 1 1  ON 8
 uu_9                -1.125084e-01 1 1  ON 9
 ud_0                 4.543024e-01 1 1  ON 10
 ud_1                 1.882334e-01 1 1  ON 11
 ud_2                 6.724140e-02 1 1  ON 12
 ud_3                -4.424704e-03 1 1  ON 13
 ud_4                -6.210985e-02 1 1  ON 14
 ud_5                -1.047389e-01 1 1  ON 15
 ud_6                -1.334130e-01 1 1  ON 16
 ud_7                -1.509997e-01 1 1  ON 17
 ud_8                -1.523989e-01 1 1  ON 18
 ud_9                -1.435158e-01 1 1  ON 19
 eO_0                -7.496119e-01 1 1  ON 20
 eO_1                -4.278302e-01 1 1  ON 21
 eO_2                -1.243171e-02 1 1  ON 22
 eO_3                 3.046791e-01 1 1  ON 23
 eO_4                 5.328564e-01 1 1  ON 24
 eO_5                 4.974474e-01 1 1  ON 25
 eO_6                 2.675320e-01 1 1  ON 26
 eO_7                -4.320208e-02 1 1  ON 27
 eO_8                -2.436417e-01 1 1  ON 28
 eO_9                -1.178247e-01 1 1  ON 29
eH1_0                -2.674612e-01 1 1  ON 30
eH1_1                -1.615136e-01 1 1  ON 31
eH1_2                -1.121416e-01 1 1  ON 32
eH1_3                -5.634972e-02 1 1  ON 33
eH1_4                -6.361131e-03 1 1  ON 34
eH1_5                 3.013661e-02 1 1  ON 35
eH1_6                 9.385146e-02 1 1  ON 36
eH1_7                 1.615020e-01 1 1  ON 37
eH1_8                 2.037064e-01 1 1  ON 38
eH1_9                 1.123019e-01 1 1  ON 39
eH2_0                -2.648115e-01 1 1  ON 40
eH2_1                -1.588740e-01 1 1  ON 41
eH2_2                -1.095420e-01 1 1  ON 42
eH2_3                -5.387317e-02 1 1  ON 43
eH2_4                -3.698511e-03 1 1  ON 44
eH2_5                 3.407083e-02 1 1  ON 45
eH2_6                 9.728248e-02 1 1  ON 46
eH2_7                 1.616958e-01 1 1  ON 47
eH2_8                 2.046380e-01 1 1  ON 48
eH2_9                 1.032026e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.8015
    reference variance = 0.389616
====================================================
  Execution time = 1.9945e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3568e-01
  Total weights = 2.0000e+06
  Execution time = 1.8378e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335608708999
                                         uncertainty =       0.003452756742

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335608708999
                                         uncertainty =       0.003452756742

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409684804
  error estimate for blocks of size 2^( 2) =       0.000422489641
  error estimate for blocks of size 2^( 3) =       0.000435609143
  error estimate for blocks of size 2^( 4) =       0.000447889955
  error estimate for blocks of size 2^( 5) =       0.000459078254
  error estimate for blocks of size 2^( 6) =       0.000468255103
  error estimate for blocks of size 2^( 7) =       0.000474916900

      target function =                  N/A
              le_mean =     -16.906275236996
             les_mean =     286.157825498480
             stat err =       0.000462535053
             autocorr =       1.274646010397
              std dev =       0.579381806110
             le_variance =       0.335683277252

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335599013085
                                         uncertainty =       0.003452518454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335599013085
                                         uncertainty =       0.003452518454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409678886
  error estimate for blocks of size 2^( 2) =       0.000422484582
  error estimate for blocks of size 2^( 3) =       0.000435605425
  error estimate for blocks of size 2^( 4) =       0.000447886591
  error estimate for blocks of size 2^( 5) =       0.000459075041
  error estimate for blocks of size 2^( 6) =       0.000468251843
  error estimate for blocks of size 2^( 7) =       0.000474915537

      target function =                  N/A
              le_mean =     -16.906275059597
             les_mean =     286.157809802147
             stat err =       0.000462532253
             autocorr =       1.274667406328
              std dev =       0.579373436773
             le_variance =       0.335673579238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335607312125
                                         uncertainty =       0.003452688365

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335607312125
                                         uncertainty =       0.003452688365

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409683950
  error estimate for blocks of size 2^( 2) =       0.000422489171
  error estimate for blocks of size 2^( 3) =       0.000435609359
  error estimate for blocks of size 2^( 4) =       0.000447890343
  error estimate for blocks of size 2^( 5) =       0.000459078710
  error estimate for blocks of size 2^( 6) =       0.000468255454
  error estimate for blocks of size 2^( 7) =       0.000474918337

      target function =                  N/A
              le_mean =     -16.906275149269
             les_mean =     286.157821133066
             stat err =       0.000462535711
             autocorr =       1.274654951572
              std dev =       0.579380598676
             le_variance =       0.335681878122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335608685214
                                         uncertainty =       0.003452750550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335608685214
                                         uncertainty =       0.003452750550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409684789
  error estimate for blocks of size 2^( 2) =       0.000422489672
  error estimate for blocks of size 2^( 3) =       0.000435609260
  error estimate for blocks of size 2^( 4) =       0.000447890093
  error estimate for blocks of size 2^( 5) =       0.000459078400
  error estimate for blocks of size 2^( 6) =       0.000468255232
  error estimate for blocks of size 2^( 7) =       0.000474917169

      target function =                  N/A
              le_mean =     -16.906275225453
             les_mean =     286.157825084042
             stat err =       0.000462535223
             autocorr =       1.274647041790
              std dev =       0.579381785294
             le_variance =       0.335683253130


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906275236996        initial  <--
     1.4552e+00     1.4552e+01             1.0550e-04       -16.906275059597
     5.8208e+00     5.8208e+01             2.6637e-05       -16.906275149269
     2.3283e+01     2.3283e+02             6.6740e-06       -16.906275225453

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2337
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.119607e-01 1 1  ON 0
 uu_1                 1.443300e-01 1 1  ON 1
 uu_2                 4.229413e-02 1 1  ON 2
 uu_3                -2.087792e-02 1 1  ON 3
 uu_4                -6.734708e-02 1 1  ON 4
 uu_5                -1.038748e-01 1 1  ON 5
 uu_6                -1.331775e-01 1 1  ON 6
 uu_7                -1.491847e-01 1 1  ON 7
 uu_8                -1.429798e-01 1 1  ON 8
 uu_9                -1.124903e-01 1 1  ON 9
 ud_0                 4.542995e-01 1 1  ON 10
 ud_1                 1.882474e-01 1 1  ON 11
 ud_2                 6.723053e-02 1 1  ON 12
 ud_3                -4.425333e-03 1 1  ON 13
 ud_4                -6.210712e-02 1 1  ON 14
 ud_5                -1.047532e-01 1 1  ON 15
 ud_6                -1.334104e-01 1 1  ON 16
 ud_7                -1.509996e-01 1 1  ON 17
 ud_8                -1.524064e-01 1 1  ON 18
 ud_9                -1.435161e-01 1 1  ON 19
 eO_0                -7.496292e-01 1 1  ON 20
 eO_1                -4.278534e-01 1 1  ON 21
 eO_2                -1.241765e-02 1 1  ON 22
 eO_3                 3.046672e-01 1 1  ON 23
 eO_4                 5.328614e-01 1 1  ON 24
 eO_5                 4.974471e-01 1 1  ON 25
 eO_6                 2.675257e-01 1 1  ON 26
 eO_7                -4.320125e-02 1 1  ON 27
 eO_8                -2.436273e-01 1 1  ON 28
 eO_9                -1.178040e-01 1 1  ON 29
eH1_0                -2.674592e-01 1 1  ON 30
eH1_1                -1.614974e-01 1 1  ON 31
eH1_2                -1.121241e-01 1 1  ON 32
eH1_3                -5.633679e-02 1 1  ON 33
eH1_4                -6.361336e-03 1 1  ON 34
eH1_5                 3.012095e-02 1 1  ON 35
eH1_6                 9.385717e-02 1 1  ON 36
eH1_7                 1.615002e-01 1 1  ON 37
eH1_8                 2.037061e-01 1 1  ON 38
eH1_9                 1.122754e-01 1 1  ON 39
eH2_0                -2.648023e-01 1 1  ON 40
eH2_1                -1.588649e-01 1 1  ON 41
eH2_2                -1.095304e-01 1 1  ON 42
eH2_3                -5.387649e-02 1 1  ON 43
eH2_4                -3.690149e-03 1 1  ON 44
eH2_5                 3.407624e-02 1 1  ON 45
eH2_6                 9.728846e-02 1 1  ON 46
eH2_7                 1.616882e-01 1 1  ON 47
eH2_8                 2.046323e-01 1 1  ON 48
eH2_9                 1.031759e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8864
    reference variance = 0.198563
====================================================
  Execution time = 2.1641e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3768e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337672338083
                                         uncertainty =       0.003568350145

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337672338083
                                         uncertainty =       0.003568350145

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410901749
  error estimate for blocks of size 2^( 2) =       0.000423592596
  error estimate for blocks of size 2^( 3) =       0.000436460471
  error estimate for blocks of size 2^( 4) =       0.000447663469
  error estimate for blocks of size 2^( 5) =       0.000458070334
  error estimate for blocks of size 2^( 6) =       0.000465605765
  error estimate for blocks of size 2^( 7) =       0.000471365817

      target function =                  N/A
              le_mean =     -16.906176019196
             les_mean =     286.156467918237
             stat err =       0.000460676347
             autocorr =       1.256943764215
              std dev =       0.581102826568
             le_variance =       0.337680495046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690617601920e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906176019196       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906176033151       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906176024167       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906176021786       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906176003517       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906176004012       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906176014024       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906176015916       residual = 3.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.178051e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906176019196       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906176022722       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906176020428       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906176019828       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906176015401       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906176015437       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906176017938       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906176018383       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 2.949473e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906176019196       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906176020080       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906176019503       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906176019353       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906176018255       residual = 1.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906176018259       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906176018883       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906176018993       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+02 is 7.376393e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.407731 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7283e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.119593e-01 1 1  ON 0
 uu_1                 1.443291e-01 1 1  ON 1
 uu_2                 4.229509e-02 1 1  ON 2
 uu_3                -2.087722e-02 1 1  ON 3
 uu_4                -6.734695e-02 1 1  ON 4
 uu_5                -1.038739e-01 1 1  ON 5
 uu_6                -1.331782e-01 1 1  ON 6
 uu_7                -1.491838e-01 1 1  ON 7
 uu_8                -1.429805e-01 1 1  ON 8
 uu_9                -1.124919e-01 1 1  ON 9
 ud_0                 4.542995e-01 1 1  ON 10
 ud_1                 1.882472e-01 1 1  ON 11
 ud_2                 6.723238e-02 1 1  ON 12
 ud_3                -4.425087e-03 1 1  ON 13
 ud_4                -6.210625e-02 1 1  ON 14
 ud_5                -1.047521e-01 1 1  ON 15
 ud_6                -1.334097e-01 1 1  ON 16
 ud_7                -1.510000e-01 1 1  ON 17
 ud_8                -1.524070e-01 1 1  ON 18
 ud_9                -1.435175e-01 1 1  ON 19
 eO_0                -7.496283e-01 1 1  ON 20
 eO_1                -4.278533e-01 1 1  ON 21
 eO_2                -1.241752e-02 1 1  ON 22
 eO_3                 3.046687e-01 1 1  ON 23
 eO_4                 5.328622e-01 1 1  ON 24
 eO_5                 4.974470e-01 1 1  ON 25
 eO_6                 2.675274e-01 1 1  ON 26
 eO_7                -4.320150e-02 1 1  ON 27
 eO_8                -2.436295e-01 1 1  ON 28
 eO_9                -1.178062e-01 1 1  ON 29
eH1_0                -2.674578e-01 1 1  ON 30
eH1_1                -1.614962e-01 1 1  ON 31
eH1_2                -1.121247e-01 1 1  ON 32
eH1_3                -5.633772e-02 1 1  ON 33
eH1_4                -6.364082e-03 1 1  ON 34
eH1_5                 3.012029e-02 1 1  ON 35
eH1_6                 9.385490e-02 1 1  ON 36
eH1_7                 1.615000e-01 1 1  ON 37
eH1_8                 2.037079e-01 1 1  ON 38
eH1_9                 1.122783e-01 1 1  ON 39
eH2_0                -2.648014e-01 1 1  ON 40
eH2_1                -1.588655e-01 1 1  ON 41
eH2_2                -1.095301e-01 1 1  ON 42
eH2_3                -5.387634e-02 1 1  ON 43
eH2_4                -3.692346e-03 1 1  ON 44
eH2_5                 3.407426e-02 1 1  ON 45
eH2_6                 9.728802e-02 1 1  ON 46
eH2_7                 1.616892e-01 1 1  ON 47
eH2_8                 2.046331e-01 1 1  ON 48
eH2_9                 1.031778e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 0.356023
====================================================
  Execution time = 2.0374e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4699e-01
  Total weights = 2.0000e+06
  Execution time = 1.8416e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347115671509
                                         uncertainty =       0.008648781469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347115671509
                                         uncertainty =       0.008648781469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416527618
  error estimate for blocks of size 2^( 2) =       0.000428923182
  error estimate for blocks of size 2^( 3) =       0.000441392604
  error estimate for blocks of size 2^( 4) =       0.000453127922
  error estimate for blocks of size 2^( 5) =       0.000462860119
  error estimate for blocks of size 2^( 6) =       0.000469429630
  error estimate for blocks of size 2^( 7) =       0.000473150495

      target function =                  N/A
              le_mean =     -16.906702699804
             les_mean =     286.183586519899
             stat err =       0.000464642042
             autocorr =       1.244369620073
              std dev =       0.589059007088
             le_variance =       0.346990513831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347107790800
                                         uncertainty =       0.008648745205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347107790800
                                         uncertainty =       0.008648745205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416522895
  error estimate for blocks of size 2^( 2) =       0.000428918699
  error estimate for blocks of size 2^( 3) =       0.000441388369
  error estimate for blocks of size 2^( 4) =       0.000453123789
  error estimate for blocks of size 2^( 5) =       0.000462856211
  error estimate for blocks of size 2^( 6) =       0.000469425722
  error estimate for blocks of size 2^( 7) =       0.000473146514

      target function =                  N/A
              le_mean =     -16.906702775911
             les_mean =     286.183581223087
             stat err =       0.000464638059
             autocorr =       1.244376510686
              std dev =       0.589052326690
             le_variance =       0.346982643579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347111667010
                                         uncertainty =       0.008648764668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347111667010
                                         uncertainty =       0.008648764668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416525218
  error estimate for blocks of size 2^( 2) =       0.000428920905
  error estimate for blocks of size 2^( 3) =       0.000441390453
  error estimate for blocks of size 2^( 4) =       0.000453125823
  error estimate for blocks of size 2^( 5) =       0.000462858135
  error estimate for blocks of size 2^( 6) =       0.000469427646
  error estimate for blocks of size 2^( 7) =       0.000473148474

      target function =                  N/A
              le_mean =     -16.906702738985
             les_mean =     286.183583845573
             stat err =       0.000464640019
             autocorr =       1.244373130087
              std dev =       0.589055612543
             le_variance =       0.346986514668

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347115168820
                                         uncertainty =       0.008648779414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347115168820
                                         uncertainty =       0.008648779414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416527317
  error estimate for blocks of size 2^( 2) =       0.000428922897
  error estimate for blocks of size 2^( 3) =       0.000441392334
  error estimate for blocks of size 2^( 4) =       0.000453127659
  error estimate for blocks of size 2^( 5) =       0.000462859870
  error estimate for blocks of size 2^( 6) =       0.000469429381
  error estimate for blocks of size 2^( 7) =       0.000473150242

      target function =                  N/A
              le_mean =     -16.906702704730
             les_mean =     286.183586184426
             stat err =       0.000464641788
             autocorr =       1.244370060898
              std dev =       0.589058580969
             le_variance =       0.346990011813


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906702699804        initial
     1.4552e+01     1.4552e+02             1.1781e-05       -16.906702775911  <--
     5.8208e+01     5.8208e+02             2.9495e-06       -16.906702738985
     2.3283e+02     2.3283e+03             7.3764e-07       -16.906702704730

*****************************************************************************
Applying the update for shift_i =   1.4552e+01     and shift_s =   1.4552e+02
*****************************************************************************

  Execution time = 2.9684e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.119550e-01 1 1  ON 0
 uu_1                 1.443262e-01 1 1  ON 1
 uu_2                 4.229782e-02 1 1  ON 2
 uu_3                -2.087512e-02 1 1  ON 3
 uu_4                -6.734656e-02 1 1  ON 4
 uu_5                -1.038711e-01 1 1  ON 5
 uu_6                -1.331801e-01 1 1  ON 6
 uu_7                -1.491811e-01 1 1  ON 7
 uu_8                -1.429829e-01 1 1  ON 8
 uu_9                -1.124966e-01 1 1  ON 9
 ud_0                 4.542995e-01 1 1  ON 10
 ud_1                 1.882466e-01 1 1  ON 11
 ud_2                 6.723778e-02 1 1  ON 12
 ud_3                -4.424267e-03 1 1  ON 13
 ud_4                -6.210367e-02 1 1  ON 14
 ud_5                -1.047487e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.510011e-01 1 1  ON 17
 ud_8                -1.524091e-01 1 1  ON 18
 ud_9                -1.435219e-01 1 1  ON 19
 eO_0                -7.496257e-01 1 1  ON 20
 eO_1                -4.278529e-01 1 1  ON 21
 eO_2                -1.241706e-02 1 1  ON 22
 eO_3                 3.046734e-01 1 1  ON 23
 eO_4                 5.328645e-01 1 1  ON 24
 eO_5                 4.974466e-01 1 1  ON 25
 eO_6                 2.675327e-01 1 1  ON 26
 eO_7                -4.320223e-02 1 1  ON 27
 eO_8                -2.436362e-01 1 1  ON 28
 eO_9                -1.178128e-01 1 1  ON 29
eH1_0                -2.674538e-01 1 1  ON 30
eH1_1                -1.614927e-01 1 1  ON 31
eH1_2                -1.121264e-01 1 1  ON 32
eH1_3                -5.634048e-02 1 1  ON 33
eH1_4                -6.372289e-03 1 1  ON 34
eH1_5                 3.011828e-02 1 1  ON 35
eH1_6                 9.384812e-02 1 1  ON 36
eH1_7                 1.614994e-01 1 1  ON 37
eH1_8                 2.037130e-01 1 1  ON 38
eH1_9                 1.122871e-01 1 1  ON 39
eH2_0                -2.647990e-01 1 1  ON 40
eH2_1                -1.588672e-01 1 1  ON 41
eH2_2                -1.095294e-01 1 1  ON 42
eH2_3                -5.387592e-02 1 1  ON 43
eH2_4                -3.698893e-03 1 1  ON 44
eH2_5                 3.406829e-02 1 1  ON 45
eH2_6                 9.728670e-02 1 1  ON 46
eH2_7                 1.616921e-01 1 1  ON 47
eH2_8                 2.046355e-01 1 1  ON 48
eH2_9                 1.031835e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6973e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9646
    reference variance = 0.231195
====================================================
  Execution time = 2.0192e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4259e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4823e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342547715093
                                         uncertainty =       0.006239841661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342547715093
                                         uncertainty =       0.006239841661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413876815
  error estimate for blocks of size 2^( 2) =       0.000426650161
  error estimate for blocks of size 2^( 3) =       0.000440059090
  error estimate for blocks of size 2^( 4) =       0.000452469069
  error estimate for blocks of size 2^( 5) =       0.000464519621
  error estimate for blocks of size 2^( 6) =       0.000474417862
  error estimate for blocks of size 2^( 7) =       0.000479944792

      target function =                  N/A
              le_mean =     -16.905963044051
             les_mean =     286.154174311190
             stat err =       0.000467837836
             autocorr =       1.277757644507
              std dev =       0.585310204639
             le_variance =       0.342588035654


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690596304405e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+00, overlap shift 3.6380e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905963044051       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905963111333       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905963244701       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905963185251       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905963189946       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905963245615       residual = 7.12e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905963160161       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905963155384       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+00 is 4.948547e-05

solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905963044051       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905963061112       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905963095528       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905963079492       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905963082521       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905963097817       residual = 6.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905963077370       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905963074983       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+01 is 1.247223e-05

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.905963044051       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.905963048332       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.905963057004       residual = 7.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.905963052928       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.905963053811       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.905963057726       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.905963052690       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.905963052014       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+01 is 3.124707e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.410382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5681e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.119448e-01 1 1  ON 0
 uu_1                 1.443299e-01 1 1  ON 1
 uu_2                 4.229056e-02 1 1  ON 2
 uu_3                -2.087510e-02 1 1  ON 3
 uu_4                -6.735586e-02 1 1  ON 4
 uu_5                -1.038662e-01 1 1  ON 5
 uu_6                -1.331777e-01 1 1  ON 6
 uu_7                -1.491768e-01 1 1  ON 7
 uu_8                -1.429787e-01 1 1  ON 8
 uu_9                -1.125002e-01 1 1  ON 9
 ud_0                 4.542967e-01 1 1  ON 10
 ud_1                 1.882484e-01 1 1  ON 11
 ud_2                 6.723813e-02 1 1  ON 12
 ud_3                -4.423897e-03 1 1  ON 13
 ud_4                -6.210042e-02 1 1  ON 14
 ud_5                -1.047487e-01 1 1  ON 15
 ud_6                -1.334091e-01 1 1  ON 16
 ud_7                -1.509953e-01 1 1  ON 17
 ud_8                -1.524074e-01 1 1  ON 18
 ud_9                -1.435223e-01 1 1  ON 19
 eO_0                -7.496266e-01 1 1  ON 20
 eO_1                -4.278541e-01 1 1  ON 21
 eO_2                -1.241157e-02 1 1  ON 22
 eO_3                 3.046769e-01 1 1  ON 23
 eO_4                 5.328660e-01 1 1  ON 24
 eO_5                 4.974432e-01 1 1  ON 25
 eO_6                 2.675387e-01 1 1  ON 26
 eO_7                -4.319822e-02 1 1  ON 27
 eO_8                -2.436412e-01 1 1  ON 28
 eO_9                -1.178211e-01 1 1  ON 29
eH1_0                -2.674537e-01 1 1  ON 30
eH1_1                -1.614952e-01 1 1  ON 31
eH1_2                -1.121335e-01 1 1  ON 32
eH1_3                -5.634864e-02 1 1  ON 33
eH1_4                -6.381187e-03 1 1  ON 34
eH1_5                 3.011874e-02 1 1  ON 35
eH1_6                 9.385153e-02 1 1  ON 36
eH1_7                 1.615025e-01 1 1  ON 37
eH1_8                 2.037195e-01 1 1  ON 38
eH1_9                 1.122984e-01 1 1  ON 39
eH2_0                -2.647994e-01 1 1  ON 40
eH2_1                -1.588647e-01 1 1  ON 41
eH2_2                -1.095336e-01 1 1  ON 42
eH2_3                -5.387876e-02 1 1  ON 43
eH2_4                -3.707312e-03 1 1  ON 44
eH2_5                 3.405952e-02 1 1  ON 45
eH2_6                 9.728297e-02 1 1  ON 46
eH2_7                 1.616961e-01 1 1  ON 47
eH2_8                 2.046418e-01 1 1  ON 48
eH2_9                 1.031960e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8486
    reference variance = 0.26504
====================================================
  Execution time = 2.0116e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4040e-01
  Total weights = 2.0000e+06
  Execution time = 1.8576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340447439253
                                         uncertainty =       0.004835507535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340447439253
                                         uncertainty =       0.004835507535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412556910
  error estimate for blocks of size 2^( 2) =       0.000425011181
  error estimate for blocks of size 2^( 3) =       0.000438146352
  error estimate for blocks of size 2^( 4) =       0.000450199921
  error estimate for blocks of size 2^( 5) =       0.000460967584
  error estimate for blocks of size 2^( 6) =       0.000470867896
  error estimate for blocks of size 2^( 7) =       0.000474990709

      target function =                  N/A
              le_mean =     -16.906947005878
             les_mean =     286.185263296914
             stat err =       0.000464256528
             autocorr =       1.266334115211
              std dev =       0.583443576994
             le_variance =       0.340406407536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340441423268
                                         uncertainty =       0.004836374335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340441423268
                                         uncertainty =       0.004836374335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412553270
  error estimate for blocks of size 2^( 2) =       0.000425007518
  error estimate for blocks of size 2^( 3) =       0.000438142645
  error estimate for blocks of size 2^( 4) =       0.000450196539
  error estimate for blocks of size 2^( 5) =       0.000460963989
  error estimate for blocks of size 2^( 6) =       0.000470864030
  error estimate for blocks of size 2^( 7) =       0.000474986704

      target function =                  N/A
              le_mean =     -16.906946797182
             les_mean =     286.185250234286
             stat err =       0.000464252816
             autocorr =       1.266336206553
              std dev =       0.583438430135
             le_variance =       0.340400401759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340444217999
                                         uncertainty =       0.004835968047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340444217999
                                         uncertainty =       0.004835968047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412554961
  error estimate for blocks of size 2^( 2) =       0.000425009220
  error estimate for blocks of size 2^( 3) =       0.000438144362
  error estimate for blocks of size 2^( 4) =       0.000450198112
  error estimate for blocks of size 2^( 5) =       0.000460965659
  error estimate for blocks of size 2^( 6) =       0.000470865822
  error estimate for blocks of size 2^( 7) =       0.000474988569

      target function =                  N/A
              le_mean =     -16.906946894557
             les_mean =     286.185256317027
             stat err =       0.000464254541
             autocorr =       1.266335238313
              std dev =       0.583440821223
             le_variance =       0.340403191870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340447028168
                                         uncertainty =       0.004835566024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340447028168
                                         uncertainty =       0.004835566024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412556661
  error estimate for blocks of size 2^( 2) =       0.000425010931
  error estimate for blocks of size 2^( 3) =       0.000438146098
  error estimate for blocks of size 2^( 4) =       0.000450199691
  error estimate for blocks of size 2^( 5) =       0.000460967338
  error estimate for blocks of size 2^( 6) =       0.000470867632
  error estimate for blocks of size 2^( 7) =       0.000474990436

      target function =                  N/A
              le_mean =     -16.906946991616
             les_mean =     286.185262404275
             stat err =       0.000464256274
             autocorr =       1.266334259020
              std dev =       0.583443225316
             le_variance =       0.340405997167


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906947005878        initial  <--
     3.6380e+00     3.6380e+01             4.9485e-05       -16.906946797182
     1.4552e+01     1.4552e+02             1.2472e-05       -16.906946894557
     5.8208e+01     5.8208e+02             3.1247e-06       -16.906946991616

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4533
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.119550e-01 1 1  ON 0
 uu_1                 1.443262e-01 1 1  ON 1
 uu_2                 4.229782e-02 1 1  ON 2
 uu_3                -2.087512e-02 1 1  ON 3
 uu_4                -6.734656e-02 1 1  ON 4
 uu_5                -1.038711e-01 1 1  ON 5
 uu_6                -1.331801e-01 1 1  ON 6
 uu_7                -1.491811e-01 1 1  ON 7
 uu_8                -1.429829e-01 1 1  ON 8
 uu_9                -1.124966e-01 1 1  ON 9
 ud_0                 4.542995e-01 1 1  ON 10
 ud_1                 1.882466e-01 1 1  ON 11
 ud_2                 6.723778e-02 1 1  ON 12
 ud_3                -4.424267e-03 1 1  ON 13
 ud_4                -6.210367e-02 1 1  ON 14
 ud_5                -1.047487e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.510011e-01 1 1  ON 17
 ud_8                -1.524091e-01 1 1  ON 18
 ud_9                -1.435219e-01 1 1  ON 19
 eO_0                -7.496257e-01 1 1  ON 20
 eO_1                -4.278529e-01 1 1  ON 21
 eO_2                -1.241706e-02 1 1  ON 22
 eO_3                 3.046734e-01 1 1  ON 23
 eO_4                 5.328645e-01 1 1  ON 24
 eO_5                 4.974466e-01 1 1  ON 25
 eO_6                 2.675327e-01 1 1  ON 26
 eO_7                -4.320223e-02 1 1  ON 27
 eO_8                -2.436362e-01 1 1  ON 28
 eO_9                -1.178128e-01 1 1  ON 29
eH1_0                -2.674538e-01 1 1  ON 30
eH1_1                -1.614927e-01 1 1  ON 31
eH1_2                -1.121264e-01 1 1  ON 32
eH1_3                -5.634048e-02 1 1  ON 33
eH1_4                -6.372289e-03 1 1  ON 34
eH1_5                 3.011828e-02 1 1  ON 35
eH1_6                 9.384812e-02 1 1  ON 36
eH1_7                 1.614994e-01 1 1  ON 37
eH1_8                 2.037130e-01 1 1  ON 38
eH1_9                 1.122871e-01 1 1  ON 39
eH2_0                -2.647990e-01 1 1  ON 40
eH2_1                -1.588672e-01 1 1  ON 41
eH2_2                -1.095294e-01 1 1  ON 42
eH2_3                -5.387592e-02 1 1  ON 43
eH2_4                -3.698893e-03 1 1  ON 44
eH2_5                 3.406829e-02 1 1  ON 45
eH2_6                 9.728670e-02 1 1  ON 46
eH2_7                 1.616921e-01 1 1  ON 47
eH2_8                 2.046355e-01 1 1  ON 48
eH2_9                 1.031835e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5140e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6913e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.9618
    reference variance = 0.246659
====================================================
  Execution time = 2.0612e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3554e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335628695188
                                         uncertainty =       0.002840653333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335628695188
                                         uncertainty =       0.002840653333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409598263
  error estimate for blocks of size 2^( 2) =       0.000422899190
  error estimate for blocks of size 2^( 3) =       0.000436834802
  error estimate for blocks of size 2^( 4) =       0.000449697607
  error estimate for blocks of size 2^( 5) =       0.000460209743
  error estimate for blocks of size 2^( 6) =       0.000469289714
  error estimate for blocks of size 2^( 7) =       0.000474734565

      target function =                  N/A
              le_mean =     -16.906371944207
             les_mean =     286.160953621693
             stat err =       0.000463482907
             autocorr =       1.280416414478
              std dev =       0.579259418230
             le_variance =       0.335541473609


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690637194421e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371944207       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371963616       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371970358       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371977168       residual = 5.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906371975584       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906371966442       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906371964531       residual = 8.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+01 is 5.860295e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371944207       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371949073       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371950769       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371952490       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906371952104       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906371949797       residual = 5.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906371949299       residual = 8.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+02 is 1.467189e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906371944207       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906371945424       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906371945849       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906371946280       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906371946184       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906371945606       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906371945481       residual = 8.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+02 is 3.669305e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.412677 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6129e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.119547e-01 1 1  ON 0
 uu_1                 1.443259e-01 1 1  ON 1
 uu_2                 4.229685e-02 1 1  ON 2
 uu_3                -2.087484e-02 1 1  ON 3
 uu_4                -6.734719e-02 1 1  ON 4
 uu_5                -1.038707e-01 1 1  ON 5
 uu_6                -1.331800e-01 1 1  ON 6
 uu_7                -1.491805e-01 1 1  ON 7
 uu_8                -1.429824e-01 1 1  ON 8
 uu_9                -1.124969e-01 1 1  ON 9
 ud_0                 4.542986e-01 1 1  ON 10
 ud_1                 1.882471e-01 1 1  ON 11
 ud_2                 6.723812e-02 1 1  ON 12
 ud_3                -4.424151e-03 1 1  ON 13
 ud_4                -6.210356e-02 1 1  ON 14
 ud_5                -1.047485e-01 1 1  ON 15
 ud_6                -1.334072e-01 1 1  ON 16
 ud_7                -1.510012e-01 1 1  ON 17
 ud_8                -1.524093e-01 1 1  ON 18
 ud_9                -1.435219e-01 1 1  ON 19
 eO_0                -7.496263e-01 1 1  ON 20
 eO_1                -4.278527e-01 1 1  ON 21
 eO_2                -1.241662e-02 1 1  ON 22
 eO_3                 3.046736e-01 1 1  ON 23
 eO_4                 5.328656e-01 1 1  ON 24
 eO_5                 4.974467e-01 1 1  ON 25
 eO_6                 2.675324e-01 1 1  ON 26
 eO_7                -4.320229e-02 1 1  ON 27
 eO_8                -2.436365e-01 1 1  ON 28
 eO_9                -1.178135e-01 1 1  ON 29
eH1_0                -2.674538e-01 1 1  ON 30
eH1_1                -1.614927e-01 1 1  ON 31
eH1_2                -1.121264e-01 1 1  ON 32
eH1_3                -5.634123e-02 1 1  ON 33
eH1_4                -6.373262e-03 1 1  ON 34
eH1_5                 3.011798e-02 1 1  ON 35
eH1_6                 9.384827e-02 1 1  ON 36
eH1_7                 1.614991e-01 1 1  ON 37
eH1_8                 2.037131e-01 1 1  ON 38
eH1_9                 1.122886e-01 1 1  ON 39
eH2_0                -2.647997e-01 1 1  ON 40
eH2_1                -1.588671e-01 1 1  ON 41
eH2_2                -1.095297e-01 1 1  ON 42
eH2_3                -5.387651e-02 1 1  ON 43
eH2_4                -3.699616e-03 1 1  ON 44
eH2_5                 3.406856e-02 1 1  ON 45
eH2_6                 9.728692e-02 1 1  ON 46
eH2_7                 1.616920e-01 1 1  ON 47
eH2_8                 2.046359e-01 1 1  ON 48
eH2_9                 1.031849e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8826
    reference variance = 0.148685
====================================================
  Execution time = 2.0137e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5238e-01
  Total weights = 2.0000e+06
  Execution time = 1.8373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352246571988
                                         uncertainty =       0.008153660079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352246571988
                                         uncertainty =       0.008153660079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419748424
  error estimate for blocks of size 2^( 2) =       0.000432692555
  error estimate for blocks of size 2^( 3) =       0.000444794527
  error estimate for blocks of size 2^( 4) =       0.000456754308
  error estimate for blocks of size 2^( 5) =       0.000466867792
  error estimate for blocks of size 2^( 6) =       0.000475546678
  error estimate for blocks of size 2^( 7) =       0.000479298391

      target function =                  N/A
              le_mean =     -16.906419145136
             les_mean =     286.179385613997
             stat err =       0.000469616792
             autocorr =       1.251725463518
              std dev =       0.593613914220
             le_variance =       0.352377479156

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352242827588
                                         uncertainty =       0.008153677270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352242827588
                                         uncertainty =       0.008153677270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419746192
  error estimate for blocks of size 2^( 2) =       0.000432690428
  error estimate for blocks of size 2^( 3) =       0.000444792546
  error estimate for blocks of size 2^( 4) =       0.000456752370
  error estimate for blocks of size 2^( 5) =       0.000466865910
  error estimate for blocks of size 2^( 6) =       0.000475544897
  error estimate for blocks of size 2^( 7) =       0.000479296630

      target function =                  N/A
              le_mean =     -16.906419134083
             les_mean =     286.179381492954
             stat err =       0.000469614952
             autocorr =       1.251728962238
              std dev =       0.593610757878
             le_variance =       0.352373731869

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352244684922
                                         uncertainty =       0.008153668707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352244684922
                                         uncertainty =       0.008153668707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419747299
  error estimate for blocks of size 2^( 2) =       0.000432691483
  error estimate for blocks of size 2^( 3) =       0.000444793528
  error estimate for blocks of size 2^( 4) =       0.000456753331
  error estimate for blocks of size 2^( 5) =       0.000466866843
  error estimate for blocks of size 2^( 6) =       0.000475545781
  error estimate for blocks of size 2^( 7) =       0.000479297504

      target function =                  N/A
              le_mean =     -16.906419139590
             les_mean =     286.179383537926
             stat err =       0.000469615865
             autocorr =       1.251727227570
              std dev =       0.593612323521
             le_variance =       0.352375590636

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352246335621
                                         uncertainty =       0.008153661158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.352246335621
                                         uncertainty =       0.008153661158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419748283
  error estimate for blocks of size 2^( 2) =       0.000432692420
  error estimate for blocks of size 2^( 3) =       0.000444794402
  error estimate for blocks of size 2^( 4) =       0.000456754186
  error estimate for blocks of size 2^( 5) =       0.000466867673
  error estimate for blocks of size 2^( 6) =       0.000475546566
  error estimate for blocks of size 2^( 7) =       0.000479298280

      target function =                  N/A
              le_mean =     -16.906419144441
             les_mean =     286.179385353927
             stat err =       0.000469616676
             autocorr =       1.251725684498
              std dev =       0.593613714975
             le_variance =       0.352377242606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906419145136        initial  <--
     3.6380e+01     3.6380e+02             5.8603e-06       -16.906419134083
     1.4552e+02     1.4552e+03             1.4672e-06       -16.906419139590
     5.8208e+02     5.8208e+03             3.6693e-07       -16.906419144441

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4133
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.119550e-01 1 1  ON 0
 uu_1                 1.443262e-01 1 1  ON 1
 uu_2                 4.229782e-02 1 1  ON 2
 uu_3                -2.087512e-02 1 1  ON 3
 uu_4                -6.734656e-02 1 1  ON 4
 uu_5                -1.038711e-01 1 1  ON 5
 uu_6                -1.331801e-01 1 1  ON 6
 uu_7                -1.491811e-01 1 1  ON 7
 uu_8                -1.429829e-01 1 1  ON 8
 uu_9                -1.124966e-01 1 1  ON 9
 ud_0                 4.542995e-01 1 1  ON 10
 ud_1                 1.882466e-01 1 1  ON 11
 ud_2                 6.723778e-02 1 1  ON 12
 ud_3                -4.424267e-03 1 1  ON 13
 ud_4                -6.210367e-02 1 1  ON 14
 ud_5                -1.047487e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.510011e-01 1 1  ON 17
 ud_8                -1.524091e-01 1 1  ON 18
 ud_9                -1.435219e-01 1 1  ON 19
 eO_0                -7.496257e-01 1 1  ON 20
 eO_1                -4.278529e-01 1 1  ON 21
 eO_2                -1.241706e-02 1 1  ON 22
 eO_3                 3.046734e-01 1 1  ON 23
 eO_4                 5.328645e-01 1 1  ON 24
 eO_5                 4.974466e-01 1 1  ON 25
 eO_6                 2.675327e-01 1 1  ON 26
 eO_7                -4.320223e-02 1 1  ON 27
 eO_8                -2.436362e-01 1 1  ON 28
 eO_9                -1.178128e-01 1 1  ON 29
eH1_0                -2.674538e-01 1 1  ON 30
eH1_1                -1.614927e-01 1 1  ON 31
eH1_2                -1.121264e-01 1 1  ON 32
eH1_3                -5.634048e-02 1 1  ON 33
eH1_4                -6.372289e-03 1 1  ON 34
eH1_5                 3.011828e-02 1 1  ON 35
eH1_6                 9.384812e-02 1 1  ON 36
eH1_7                 1.614994e-01 1 1  ON 37
eH1_8                 2.037130e-01 1 1  ON 38
eH1_9                 1.122871e-01 1 1  ON 39
eH2_0                -2.647990e-01 1 1  ON 40
eH2_1                -1.588672e-01 1 1  ON 41
eH2_2                -1.095294e-01 1 1  ON 42
eH2_3                -5.387592e-02 1 1  ON 43
eH2_4                -3.698893e-03 1 1  ON 44
eH2_5                 3.406829e-02 1 1  ON 45
eH2_6                 9.728670e-02 1 1  ON 46
eH2_7                 1.616921e-01 1 1  ON 47
eH2_8                 2.046355e-01 1 1  ON 48
eH2_9                 1.031835e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5549e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9496
    reference variance = 0.353114
====================================================
  Execution time = 2.0253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.4188e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6302e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341995233562
                                         uncertainty =       0.003281701529

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341995233562
                                         uncertainty =       0.003281701529

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413449944
  error estimate for blocks of size 2^( 2) =       0.000426215170
  error estimate for blocks of size 2^( 3) =       0.000439300599
  error estimate for blocks of size 2^( 4) =       0.000451300500
  error estimate for blocks of size 2^( 5) =       0.000463053478
  error estimate for blocks of size 2^( 6) =       0.000470656855
  error estimate for blocks of size 2^( 7) =       0.000478263833

      target function =                  N/A
              le_mean =     -16.906392593227
             les_mean =     286.167992057366
             stat err =       0.000465818667
             autocorr =       1.269369039182
              std dev =       0.584706517817
             le_variance =       0.341881711977


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690639259323e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906392593227       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906392592391       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906392591497       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906392591576       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906392591395       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906392591606       residual = 5.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906392591271       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906392591183       residual = 3.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 6.793041e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906392593227       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906392593018       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906392592794       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906392592814       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906392592769       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906392592822       residual = 5.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906392592738       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906392592716       residual = 3.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.698961e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906392593227       residual = 9.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906392593175       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906392593119       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906392593124       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906392593114       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906392593126       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906392593105       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906392593100       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 4.247840e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.415329 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5890e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.119549e-01 1 1  ON 0
 uu_1                 1.443262e-01 1 1  ON 1
 uu_2                 4.229778e-02 1 1  ON 2
 uu_3                -2.087511e-02 1 1  ON 3
 uu_4                -6.734652e-02 1 1  ON 4
 uu_5                -1.038711e-01 1 1  ON 5
 uu_6                -1.331802e-01 1 1  ON 6
 uu_7                -1.491811e-01 1 1  ON 7
 uu_8                -1.429828e-01 1 1  ON 8
 uu_9                -1.124966e-01 1 1  ON 9
 ud_0                 4.542996e-01 1 1  ON 10
 ud_1                 1.882466e-01 1 1  ON 11
 ud_2                 6.723789e-02 1 1  ON 12
 ud_3                -4.424290e-03 1 1  ON 13
 ud_4                -6.210374e-02 1 1  ON 14
 ud_5                -1.047487e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.510012e-01 1 1  ON 17
 ud_8                -1.524090e-01 1 1  ON 18
 ud_9                -1.435218e-01 1 1  ON 19
 eO_0                -7.496257e-01 1 1  ON 20
 eO_1                -4.278529e-01 1 1  ON 21
 eO_2                -1.241712e-02 1 1  ON 22
 eO_3                 3.046735e-01 1 1  ON 23
 eO_4                 5.328646e-01 1 1  ON 24
 eO_5                 4.974466e-01 1 1  ON 25
 eO_6                 2.675327e-01 1 1  ON 26
 eO_7                -4.320222e-02 1 1  ON 27
 eO_8                -2.436362e-01 1 1  ON 28
 eO_9                -1.178129e-01 1 1  ON 29
eH1_0                -2.674539e-01 1 1  ON 30
eH1_1                -1.614928e-01 1 1  ON 31
eH1_2                -1.121266e-01 1 1  ON 32
eH1_3                -5.634049e-02 1 1  ON 33
eH1_4                -6.372342e-03 1 1  ON 34
eH1_5                 3.011836e-02 1 1  ON 35
eH1_6                 9.384824e-02 1 1  ON 36
eH1_7                 1.614994e-01 1 1  ON 37
eH1_8                 2.037130e-01 1 1  ON 38
eH1_9                 1.122872e-01 1 1  ON 39
eH2_0                -2.647990e-01 1 1  ON 40
eH2_1                -1.588672e-01 1 1  ON 41
eH2_2                -1.095294e-01 1 1  ON 42
eH2_3                -5.387594e-02 1 1  ON 43
eH2_4                -3.698854e-03 1 1  ON 44
eH2_5                 3.406820e-02 1 1  ON 45
eH2_6                 9.728661e-02 1 1  ON 46
eH2_7                 1.616921e-01 1 1  ON 47
eH2_8                 2.046356e-01 1 1  ON 48
eH2_9                 1.031836e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9178
    reference variance = 0.233135
====================================================
  Execution time = 2.0188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3094e-01
  Total weights = 2.0000e+06
  Execution time = 1.8417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330907950677
                                         uncertainty =       0.002785922920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330907950677
                                         uncertainty =       0.002785922920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406778057
  error estimate for blocks of size 2^( 2) =       0.000419719549
  error estimate for blocks of size 2^( 3) =       0.000433103397
  error estimate for blocks of size 2^( 4) =       0.000446588969
  error estimate for blocks of size 2^( 5) =       0.000456761476
  error estimate for blocks of size 2^( 6) =       0.000464618713
  error estimate for blocks of size 2^( 7) =       0.000470362771

      target function =                  N/A
              le_mean =     -16.906080375206
             les_mean =     286.146490262791
             stat err =       0.000459582982
             autocorr =       1.276476556742
              std dev =       0.575271045101
             le_variance =       0.330936775332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330907711873
                                         uncertainty =       0.002785910064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330907711873
                                         uncertainty =       0.002785910064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406777910
  error estimate for blocks of size 2^( 2) =       0.000419719418
  error estimate for blocks of size 2^( 3) =       0.000433103278
  error estimate for blocks of size 2^( 4) =       0.000446588852
  error estimate for blocks of size 2^( 5) =       0.000456761361
  error estimate for blocks of size 2^( 6) =       0.000464618607
  error estimate for blocks of size 2^( 7) =       0.000470362657

      target function =                  N/A
              le_mean =     -16.906080381341
             les_mean =     286.146490231209
             stat err =       0.000459582869
             autocorr =       1.276476848877
              std dev =       0.575270837361
             le_variance =       0.330936536318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330907831229
                                         uncertainty =       0.002785916485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330907831229
                                         uncertainty =       0.002785916485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406777984
  error estimate for blocks of size 2^( 2) =       0.000419719484
  error estimate for blocks of size 2^( 3) =       0.000433103337
  error estimate for blocks of size 2^( 4) =       0.000446588910
  error estimate for blocks of size 2^( 5) =       0.000456761418
  error estimate for blocks of size 2^( 6) =       0.000464618660
  error estimate for blocks of size 2^( 7) =       0.000470362714

      target function =                  N/A
              le_mean =     -16.906080378277
             les_mean =     286.146490247063
             stat err =       0.000459582926
             autocorr =       1.276476702896
              std dev =       0.575270941191
             le_variance =       0.330936655779

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330907935744
                                         uncertainty =       0.002785922115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330907935744
                                         uncertainty =       0.002785922115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406778048
  error estimate for blocks of size 2^( 2) =       0.000419719541
  error estimate for blocks of size 2^( 3) =       0.000433103390
  error estimate for blocks of size 2^( 4) =       0.000446588962
  error estimate for blocks of size 2^( 5) =       0.000456761469
  error estimate for blocks of size 2^( 6) =       0.000464618707
  error estimate for blocks of size 2^( 7) =       0.000470362764

      target function =                  N/A
              le_mean =     -16.906080375590
             les_mean =     286.146490260825
             stat err =       0.000459582975
             autocorr =       1.276476575017
              std dev =       0.575271032111
             le_variance =       0.330936760386


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906080375206        initial
     3.6380e+02     3.6380e+03             6.7930e-07       -16.906080381341  <--
     1.4552e+03     1.4552e+04             1.6990e-07       -16.906080378277
     5.8208e+03     5.8208e+04             4.2478e-08       -16.906080375590

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 2.9501e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.119544e-01 1 1  ON 0
 uu_1                 1.443261e-01 1 1  ON 1
 uu_2                 4.229765e-02 1 1  ON 2
 uu_3                -2.087506e-02 1 1  ON 3
 uu_4                -6.734641e-02 1 1  ON 4
 uu_5                -1.038711e-01 1 1  ON 5
 uu_6                -1.331803e-01 1 1  ON 6
 uu_7                -1.491810e-01 1 1  ON 7
 uu_8                -1.429827e-01 1 1  ON 8
 uu_9                -1.124965e-01 1 1  ON 9
 ud_0                 4.542996e-01 1 1  ON 10
 ud_1                 1.882464e-01 1 1  ON 11
 ud_2                 6.723822e-02 1 1  ON 12
 ud_3                -4.424361e-03 1 1  ON 13
 ud_4                -6.210395e-02 1 1  ON 14
 ud_5                -1.047488e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.510014e-01 1 1  ON 17
 ud_8                -1.524088e-01 1 1  ON 18
 ud_9                -1.435215e-01 1 1  ON 19
 eO_0                -7.496256e-01 1 1  ON 20
 eO_1                -4.278527e-01 1 1  ON 21
 eO_2                -1.241729e-02 1 1  ON 22
 eO_3                 3.046736e-01 1 1  ON 23
 eO_4                 5.328648e-01 1 1  ON 24
 eO_5                 4.974464e-01 1 1  ON 25
 eO_6                 2.675327e-01 1 1  ON 26
 eO_7                -4.320217e-02 1 1  ON 27
 eO_8                -2.436363e-01 1 1  ON 28
 eO_9                -1.178130e-01 1 1  ON 29
eH1_0                -2.674541e-01 1 1  ON 30
eH1_1                -1.614929e-01 1 1  ON 31
eH1_2                -1.121271e-01 1 1  ON 32
eH1_3                -5.634053e-02 1 1  ON 33
eH1_4                -6.372498e-03 1 1  ON 34
eH1_5                 3.011859e-02 1 1  ON 35
eH1_6                 9.384857e-02 1 1  ON 36
eH1_7                 1.614993e-01 1 1  ON 37
eH1_8                 2.037131e-01 1 1  ON 38
eH1_9                 1.122876e-01 1 1  ON 39
eH2_0                -2.647989e-01 1 1  ON 40
eH2_1                -1.588675e-01 1 1  ON 41
eH2_2                -1.095294e-01 1 1  ON 42
eH2_3                -5.387599e-02 1 1  ON 43
eH2_4                -3.698739e-03 1 1  ON 44
eH2_5                 3.406795e-02 1 1  ON 45
eH2_6                 9.728634e-02 1 1  ON 46
eH2_7                 1.616920e-01 1 1  ON 47
eH2_8                 2.046358e-01 1 1  ON 48
eH2_9                 1.031840e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5397e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6914e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9719
    reference variance = 0.646502
====================================================
  Execution time = 2.0625e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3522e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335170255443
                                         uncertainty =       0.003118524033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335170255443
                                         uncertainty =       0.003118524033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409405056
  error estimate for blocks of size 2^( 2) =       0.000422219833
  error estimate for blocks of size 2^( 3) =       0.000435527891
  error estimate for blocks of size 2^( 4) =       0.000448370368
  error estimate for blocks of size 2^( 5) =       0.000458586409
  error estimate for blocks of size 2^( 6) =       0.000468273255
  error estimate for blocks of size 2^( 7) =       0.000471711285

      target function =                  N/A
              le_mean =     -16.906428852908
             les_mean =     286.162561390792
             stat err =       0.000461735329
             autocorr =       1.271978606864
              std dev =       0.578986182872
             le_variance =       0.335224999956


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690642885291e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906428852908       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906428862598       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906428860492       residual = 9.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906428860273       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906428857913       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906428858474       residual = 5.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906428855390       residual = 7.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.193079e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906428852908       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906428855336       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906428854811       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906428854759       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906428854166       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906428854304       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906428853533       residual = 7.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 5.490291e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906428852908       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906428853515       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906428853384       residual = 9.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906428853372       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906428853223       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906428853258       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906428853065       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.373049e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.417599 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6148e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.119538e-01 1 1  ON 0
 uu_1                 1.443259e-01 1 1  ON 1
 uu_2                 4.229767e-02 1 1  ON 2
 uu_3                -2.087527e-02 1 1  ON 3
 uu_4                -6.734649e-02 1 1  ON 4
 uu_5                -1.038708e-01 1 1  ON 5
 uu_6                -1.331802e-01 1 1  ON 6
 uu_7                -1.491809e-01 1 1  ON 7
 uu_8                -1.429825e-01 1 1  ON 8
 uu_9                -1.124964e-01 1 1  ON 9
 ud_0                 4.542996e-01 1 1  ON 10
 ud_1                 1.882464e-01 1 1  ON 11
 ud_2                 6.723846e-02 1 1  ON 12
 ud_3                -4.424254e-03 1 1  ON 13
 ud_4                -6.210399e-02 1 1  ON 14
 ud_5                -1.047487e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.510018e-01 1 1  ON 17
 ud_8                -1.524088e-01 1 1  ON 18
 ud_9                -1.435215e-01 1 1  ON 19
 eO_0                -7.496257e-01 1 1  ON 20
 eO_1                -4.278527e-01 1 1  ON 21
 eO_2                -1.241716e-02 1 1  ON 22
 eO_3                 3.046735e-01 1 1  ON 23
 eO_4                 5.328652e-01 1 1  ON 24
 eO_5                 4.974465e-01 1 1  ON 25
 eO_6                 2.675328e-01 1 1  ON 26
 eO_7                -4.320219e-02 1 1  ON 27
 eO_8                -2.436365e-01 1 1  ON 28
 eO_9                -1.178133e-01 1 1  ON 29
eH1_0                -2.674543e-01 1 1  ON 30
eH1_1                -1.614929e-01 1 1  ON 31
eH1_2                -1.121271e-01 1 1  ON 32
eH1_3                -5.634083e-02 1 1  ON 33
eH1_4                -6.372787e-03 1 1  ON 34
eH1_5                 3.011863e-02 1 1  ON 35
eH1_6                 9.384872e-02 1 1  ON 36
eH1_7                 1.614994e-01 1 1  ON 37
eH1_8                 2.037132e-01 1 1  ON 38
eH1_9                 1.122880e-01 1 1  ON 39
eH2_0                -2.647989e-01 1 1  ON 40
eH2_1                -1.588675e-01 1 1  ON 41
eH2_2                -1.095295e-01 1 1  ON 42
eH2_3                -5.387622e-02 1 1  ON 43
eH2_4                -3.699041e-03 1 1  ON 44
eH2_5                 3.406763e-02 1 1  ON 45
eH2_6                 9.728648e-02 1 1  ON 46
eH2_7                 1.616922e-01 1 1  ON 47
eH2_8                 2.046360e-01 1 1  ON 48
eH2_9                 1.031845e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9429
    reference variance = 0.470008
====================================================
  Execution time = 1.9943e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3487e-01
  Total weights = 2.0000e+06
  Execution time = 1.8426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334905133221
                                         uncertainty =       0.004803645303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334905133221
                                         uncertainty =       0.004803645303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409188156
  error estimate for blocks of size 2^( 2) =       0.000421799237
  error estimate for blocks of size 2^( 3) =       0.000435046347
  error estimate for blocks of size 2^( 4) =       0.000447324672
  error estimate for blocks of size 2^( 5) =       0.000459125540
  error estimate for blocks of size 2^( 6) =       0.000467495274
  error estimate for blocks of size 2^( 7) =       0.000473863925

      target function =                  N/A
              le_mean =     -16.905716676311
             les_mean =     286.138126066220
             stat err =       0.000461952353
             autocorr =       1.274524702889
              std dev =       0.578679439716
             le_variance =       0.334869893950

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334903856290
                                         uncertainty =       0.004803635154

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334903856290
                                         uncertainty =       0.004803635154

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409187376
  error estimate for blocks of size 2^( 2) =       0.000421798494
  error estimate for blocks of size 2^( 3) =       0.000435045651
  error estimate for blocks of size 2^( 4) =       0.000447323979
  error estimate for blocks of size 2^( 5) =       0.000459124880
  error estimate for blocks of size 2^( 6) =       0.000467494562
  error estimate for blocks of size 2^( 7) =       0.000473863204

      target function =                  N/A
              le_mean =     -16.905716676708
             les_mean =     286.138124802725
             stat err =       0.000461951656
             autocorr =       1.274525720397
              std dev =       0.578678336412
             le_variance =       0.334868617032

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334904492557
                                         uncertainty =       0.004803640224

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334904492557
                                         uncertainty =       0.004803640224

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409187765
  error estimate for blocks of size 2^( 2) =       0.000421798864
  error estimate for blocks of size 2^( 3) =       0.000435045998
  error estimate for blocks of size 2^( 4) =       0.000447324324
  error estimate for blocks of size 2^( 5) =       0.000459125209
  error estimate for blocks of size 2^( 6) =       0.000467494917
  error estimate for blocks of size 2^( 7) =       0.000473863563

      target function =                  N/A
              le_mean =     -16.905716676509
             les_mean =     286.138125432257
             stat err =       0.000461952003
             autocorr =       1.274525213616
              std dev =       0.578678886163
             le_variance =       0.334869253291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334905053067
                                         uncertainty =       0.004803644668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334905053067
                                         uncertainty =       0.004803644668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409188107
  error estimate for blocks of size 2^( 2) =       0.000421799190
  error estimate for blocks of size 2^( 3) =       0.000435046303
  error estimate for blocks of size 2^( 4) =       0.000447324628
  error estimate for blocks of size 2^( 5) =       0.000459125498
  error estimate for blocks of size 2^( 6) =       0.000467495229
  error estimate for blocks of size 2^( 7) =       0.000473863880

      target function =                  N/A
              le_mean =     -16.905716676336
             les_mean =     286.138125986894
             stat err =       0.000461952309
             autocorr =       1.274524766794
              std dev =       0.578679370460
             le_variance =       0.334869813796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.905716676311        initial
     9.0949e+01     9.0949e+02             2.1931e-06       -16.905716676708  <--
     3.6380e+02     3.6380e+03             5.4903e-07       -16.905716676509
     1.4552e+03     1.4552e+04             1.3730e-07       -16.905716676336

*****************************************************************************
Applying the update for shift_i =   9.0949e+01     and shift_s =   9.0949e+02
*****************************************************************************

  Execution time = 2.9297e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.119522e-01 1 1  ON 0
 uu_1                 1.443253e-01 1 1  ON 1
 uu_2                 4.229773e-02 1 1  ON 2
 uu_3                -2.087592e-02 1 1  ON 3
 uu_4                -6.734674e-02 1 1  ON 4
 uu_5                -1.038700e-01 1 1  ON 5
 uu_6                -1.331798e-01 1 1  ON 6
 uu_7                -1.491806e-01 1 1  ON 7
 uu_8                -1.429819e-01 1 1  ON 8
 uu_9                -1.124961e-01 1 1  ON 9
 ud_0                 4.542994e-01 1 1  ON 10
 ud_1                 1.882465e-01 1 1  ON 11
 ud_2                 6.723919e-02 1 1  ON 12
 ud_3                -4.423932e-03 1 1  ON 13
 ud_4                -6.210410e-02 1 1  ON 14
 ud_5                -1.047485e-01 1 1  ON 15
 ud_6                -1.334076e-01 1 1  ON 16
 ud_7                -1.510028e-01 1 1  ON 17
 ud_8                -1.524089e-01 1 1  ON 18
 ud_9                -1.435213e-01 1 1  ON 19
 eO_0                -7.496262e-01 1 1  ON 20
 eO_1                -4.278525e-01 1 1  ON 21
 eO_2                -1.241678e-02 1 1  ON 22
 eO_3                 3.046735e-01 1 1  ON 23
 eO_4                 5.328662e-01 1 1  ON 24
 eO_5                 4.974470e-01 1 1  ON 25
 eO_6                 2.675331e-01 1 1  ON 26
 eO_7                -4.320225e-02 1 1  ON 27
 eO_8                -2.436371e-01 1 1  ON 28
 eO_9                -1.178143e-01 1 1  ON 29
eH1_0                -2.674548e-01 1 1  ON 30
eH1_1                -1.614926e-01 1 1  ON 31
eH1_2                -1.121274e-01 1 1  ON 32
eH1_3                -5.634174e-02 1 1  ON 33
eH1_4                -6.373652e-03 1 1  ON 34
eH1_5                 3.011874e-02 1 1  ON 35
eH1_6                 9.384915e-02 1 1  ON 36
eH1_7                 1.614995e-01 1 1  ON 37
eH1_8                 2.037134e-01 1 1  ON 38
eH1_9                 1.122891e-01 1 1  ON 39
eH2_0                -2.647989e-01 1 1  ON 40
eH2_1                -1.588678e-01 1 1  ON 41
eH2_2                -1.095297e-01 1 1  ON 42
eH2_3                -5.387690e-02 1 1  ON 43
eH2_4                -3.699945e-03 1 1  ON 44
eH2_5                 3.406667e-02 1 1  ON 45
eH2_6                 9.728690e-02 1 1  ON 46
eH2_7                 1.616926e-01 1 1  ON 47
eH2_8                 2.046366e-01 1 1  ON 48
eH2_9                 1.031858e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5451e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9969
    reference variance = 0.383691
====================================================
  Execution time = 2.0147e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.5126e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5384e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351237865705
                                         uncertainty =       0.007837834439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.351237865705
                                         uncertainty =       0.007837834439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000419080924
  error estimate for blocks of size 2^( 2) =       0.000431187670
  error estimate for blocks of size 2^( 3) =       0.000444243838
  error estimate for blocks of size 2^( 4) =       0.000456373353
  error estimate for blocks of size 2^( 5) =       0.000466317810
  error estimate for blocks of size 2^( 6) =       0.000471075644
  error estimate for blocks of size 2^( 7) =       0.000475486193

      target function =                  N/A
              le_mean =     -16.906287891457
             les_mean =     286.173827735432
             stat err =       0.000467313250
             autocorr =       1.243427314870
              std dev =       0.592669926899
             le_variance =       0.351257642251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690628789146e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906287891457       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906287911845       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906287916150       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906287917530       residual = 6.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906287915766       residual = 2.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906287921642       residual = 7.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906287925078       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906287926544       residual = 3.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 7.814832e-06

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906287891457       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906287896572       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906287897653       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906287897994       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906287897540       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906287899019       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906287899874       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906287900238       residual = 3.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 1.955785e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.906287891457       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.906287892737       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.906287893007       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.906287893092       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.906287892978       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.906287893348       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.906287893562       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.906287893652       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.6380e+02 is 4.890757e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.420263 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5696e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.119524e-01 1 1  ON 0
 uu_1                 1.443256e-01 1 1  ON 1
 uu_2                 4.229878e-02 1 1  ON 2
 uu_3                -2.087660e-02 1 1  ON 3
 uu_4                -6.734640e-02 1 1  ON 4
 uu_5                -1.038697e-01 1 1  ON 5
 uu_6                -1.331809e-01 1 1  ON 6
 uu_7                -1.491798e-01 1 1  ON 7
 uu_8                -1.429826e-01 1 1  ON 8
 uu_9                -1.124981e-01 1 1  ON 9
 ud_0                 4.542993e-01 1 1  ON 10
 ud_1                 1.882469e-01 1 1  ON 11
 ud_2                 6.724029e-02 1 1  ON 12
 ud_3                -4.422720e-03 1 1  ON 13
 ud_4                -6.210305e-02 1 1  ON 14
 ud_5                -1.047466e-01 1 1  ON 15
 ud_6                -1.334069e-01 1 1  ON 16
 ud_7                -1.510032e-01 1 1  ON 17
 ud_8                -1.524107e-01 1 1  ON 18
 ud_9                -1.435232e-01 1 1  ON 19
 eO_0                -7.496246e-01 1 1  ON 20
 eO_1                -4.278523e-01 1 1  ON 21
 eO_2                -1.241611e-02 1 1  ON 22
 eO_3                 3.046738e-01 1 1  ON 23
 eO_4                 5.328661e-01 1 1  ON 24
 eO_5                 4.974475e-01 1 1  ON 25
 eO_6                 2.675337e-01 1 1  ON 26
 eO_7                -4.320294e-02 1 1  ON 27
 eO_8                -2.436385e-01 1 1  ON 28
 eO_9                -1.178158e-01 1 1  ON 29
eH1_0                -2.674540e-01 1 1  ON 30
eH1_1                -1.614922e-01 1 1  ON 31
eH1_2                -1.121286e-01 1 1  ON 32
eH1_3                -5.634297e-02 1 1  ON 33
eH1_4                -6.374244e-03 1 1  ON 34
eH1_5                 3.011837e-02 1 1  ON 35
eH1_6                 9.384986e-02 1 1  ON 36
eH1_7                 1.614996e-01 1 1  ON 37
eH1_8                 2.037138e-01 1 1  ON 38
eH1_9                 1.122901e-01 1 1  ON 39
eH2_0                -2.647997e-01 1 1  ON 40
eH2_1                -1.588669e-01 1 1  ON 41
eH2_2                -1.095297e-01 1 1  ON 42
eH2_3                -5.387755e-02 1 1  ON 43
eH2_4                -3.700870e-03 1 1  ON 44
eH2_5                 3.406664e-02 1 1  ON 45
eH2_6                 9.728660e-02 1 1  ON 46
eH2_7                 1.616923e-01 1 1  ON 47
eH2_8                 2.046369e-01 1 1  ON 48
eH2_9                 1.031875e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.0184
    reference variance = 0.572481
====================================================
  Execution time = 2.2141e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3700e-01
  Total weights = 2.0000e+06
  Execution time = 1.8402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336999799860
                                         uncertainty =       0.003714392913

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336999799860
                                         uncertainty =       0.003714392913

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410489108
  error estimate for blocks of size 2^( 2) =       0.000423337856
  error estimate for blocks of size 2^( 3) =       0.000435919426
  error estimate for blocks of size 2^( 4) =       0.000448068642
  error estimate for blocks of size 2^( 5) =       0.000459816303
  error estimate for blocks of size 2^( 6) =       0.000468030756
  error estimate for blocks of size 2^( 7) =       0.000472283005

      target function =                  N/A
              le_mean =     -16.906383959391
             les_mean =     286.162821028748
             stat err =       0.000462049677
             autocorr =       1.266992564645
              std dev =       0.580519263160
             le_variance =       0.337002614900

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336996054924
                                         uncertainty =       0.003714350084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336996054924
                                         uncertainty =       0.003714350084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410486826
  error estimate for blocks of size 2^( 2) =       0.000423335653
  error estimate for blocks of size 2^( 3) =       0.000435917290
  error estimate for blocks of size 2^( 4) =       0.000448066629
  error estimate for blocks of size 2^( 5) =       0.000459814381
  error estimate for blocks of size 2^( 6) =       0.000468028877
  error estimate for blocks of size 2^( 7) =       0.000472281357

      target function =                  N/A
              le_mean =     -16.906384012057
             les_mean =     286.162819063374
             stat err =       0.000462047811
             autocorr =       1.266996415889
              std dev =       0.580516036578
             le_variance =       0.336998868725

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336997907091
                                         uncertainty =       0.003714371168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336997907091
                                         uncertainty =       0.003714371168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410487954
  error estimate for blocks of size 2^( 2) =       0.000423336743
  error estimate for blocks of size 2^( 3) =       0.000435918347
  error estimate for blocks of size 2^( 4) =       0.000448067625
  error estimate for blocks of size 2^( 5) =       0.000459815332
  error estimate for blocks of size 2^( 6) =       0.000468029807
  error estimate for blocks of size 2^( 7) =       0.000472282172

      target function =                  N/A
              le_mean =     -16.906383986118
             les_mean =     286.162820039081
             stat err =       0.000462048734
             autocorr =       1.266994514570
              std dev =       0.580517632377
             le_variance =       0.337000721501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336999562595
                                         uncertainty =       0.003714390184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336999562595
                                         uncertainty =       0.003714390184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410488963
  error estimate for blocks of size 2^( 2) =       0.000423337716
  error estimate for blocks of size 2^( 3) =       0.000435919291
  error estimate for blocks of size 2^( 4) =       0.000448068515
  error estimate for blocks of size 2^( 5) =       0.000459816181
  error estimate for blocks of size 2^( 6) =       0.000468030637
  error estimate for blocks of size 2^( 7) =       0.000472282901

      target function =                  N/A
              le_mean =     -16.906383962741
             les_mean =     286.162820904664
             stat err =       0.000462049559
             autocorr =       1.266992809144
              std dev =       0.580519058736
             le_variance =       0.337002377556


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906383959391        initial
     2.2737e+01     2.2737e+02             7.8148e-06       -16.906384012057  <--
     9.0949e+01     9.0949e+02             1.9558e-06       -16.906383986118
     3.6380e+02     3.6380e+03             4.8908e-07       -16.906383962741

*****************************************************************************
Applying the update for shift_i =   2.2737e+01     and shift_s =   2.2737e+02
*****************************************************************************

  Execution time = 3.1459e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.119531e-01 1 1  ON 0
 uu_1                 1.443266e-01 1 1  ON 1
 uu_2                 4.230186e-02 1 1  ON 2
 uu_3                -2.087856e-02 1 1  ON 3
 uu_4                -6.734543e-02 1 1  ON 4
 uu_5                -1.038688e-01 1 1  ON 5
 uu_6                -1.331842e-01 1 1  ON 6
 uu_7                -1.491775e-01 1 1  ON 7
 uu_8                -1.429847e-01 1 1  ON 8
 uu_9                -1.125039e-01 1 1  ON 9
 ud_0                 4.542991e-01 1 1  ON 10
 ud_1                 1.882482e-01 1 1  ON 11
 ud_2                 6.724357e-02 1 1  ON 12
 ud_3                -4.419097e-03 1 1  ON 13
 ud_4                -6.209991e-02 1 1  ON 14
 ud_5                -1.047412e-01 1 1  ON 15
 ud_6                -1.334051e-01 1 1  ON 16
 ud_7                -1.510046e-01 1 1  ON 17
 ud_8                -1.524159e-01 1 1  ON 18
 ud_9                -1.435288e-01 1 1  ON 19
 eO_0                -7.496201e-01 1 1  ON 20
 eO_1                -4.278515e-01 1 1  ON 21
 eO_2                -1.241411e-02 1 1  ON 22
 eO_3                 3.046748e-01 1 1  ON 23
 eO_4                 5.328659e-01 1 1  ON 24
 eO_5                 4.974490e-01 1 1  ON 25
 eO_6                 2.675355e-01 1 1  ON 26
 eO_7                -4.320502e-02 1 1  ON 27
 eO_8                -2.436425e-01 1 1  ON 28
 eO_9                -1.178203e-01 1 1  ON 29
eH1_0                -2.674517e-01 1 1  ON 30
eH1_1                -1.614909e-01 1 1  ON 31
eH1_2                -1.121323e-01 1 1  ON 32
eH1_3                -5.634662e-02 1 1  ON 33
eH1_4                -6.376029e-03 1 1  ON 34
eH1_5                 3.011726e-02 1 1  ON 35
eH1_6                 9.385197e-02 1 1  ON 36
eH1_7                 1.614999e-01 1 1  ON 37
eH1_8                 2.037152e-01 1 1  ON 38
eH1_9                 1.122930e-01 1 1  ON 39
eH2_0                -2.648022e-01 1 1  ON 40
eH2_1                -1.588642e-01 1 1  ON 41
eH2_2                -1.095294e-01 1 1  ON 42
eH2_3                -5.387950e-02 1 1  ON 43
eH2_4                -3.703645e-03 1 1  ON 44
eH2_5                 3.406654e-02 1 1  ON 45
eH2_6                 9.728573e-02 1 1  ON 46
eH2_7                 1.616913e-01 1 1  ON 47
eH2_8                 2.046379e-01 1 1  ON 48
eH2_9                 1.031927e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7161e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9377
    reference variance = 0.264542
====================================================
  Execution time = 2.0198e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6907e+01
  VMC Evar = 3.4134e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341349390728
                                         uncertainty =       0.006275556832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341349390728
                                         uncertainty =       0.006275556832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413125193
  error estimate for blocks of size 2^( 2) =       0.000425430877
  error estimate for blocks of size 2^( 3) =       0.000437783006
  error estimate for blocks of size 2^( 4) =       0.000449654039
  error estimate for blocks of size 2^( 5) =       0.000459212135
  error estimate for blocks of size 2^( 6) =       0.000466245092
  error estimate for blocks of size 2^( 7) =       0.000470931502

      target function =                  N/A
              le_mean =     -16.907003547538
             les_mean =     286.188113635474
             stat err =       0.000461510692
             autocorr =       1.247958590902
              std dev =       0.584247250466
             le_variance =       0.341344849677


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690700354754e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+00, overlap shift 5.6843e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907003547538       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907003444143       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907003527384       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907003585495       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907003590918       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907003623867       residual = 6.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907003602251       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.907003599948       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.6843e+00 is 4.006254e-05

solving harmonic davidson linear method for identity shift 2.2737e+01, overlap shift 2.2737e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907003547538       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907003521275       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907003542820       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907003556844       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907003557754       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907003565881       residual = 6.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907003560076       residual = 8.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.2737e+01 is 1.011362e-05

solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.907003547538       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.907003540946       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.907003546379       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.907003549851       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.907003550048       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.907003552072       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.907003550596       residual = 8.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.0949e+01 is 2.529469e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.422725 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5702e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.119523e-01 1 1  ON 0
 uu_1                 1.443286e-01 1 1  ON 1
 uu_2                 4.230219e-02 1 1  ON 2
 uu_3                -2.087727e-02 1 1  ON 3
 uu_4                -6.734643e-02 1 1  ON 4
 uu_5                -1.038619e-01 1 1  ON 5
 uu_6                -1.331856e-01 1 1  ON 6
 uu_7                -1.491765e-01 1 1  ON 7
 uu_8                -1.429869e-01 1 1  ON 8
 uu_9                -1.125107e-01 1 1  ON 9
 ud_0                 4.543033e-01 1 1  ON 10
 ud_1                 1.882527e-01 1 1  ON 11
 ud_2                 6.724804e-02 1 1  ON 12
 ud_3                -4.412652e-03 1 1  ON 13
 ud_4                -6.210116e-02 1 1  ON 14
 ud_5                -1.047376e-01 1 1  ON 15
 ud_6                -1.334038e-01 1 1  ON 16
 ud_7                -1.510128e-01 1 1  ON 17
 ud_8                -1.524261e-01 1 1  ON 18
 ud_9                -1.435319e-01 1 1  ON 19
 eO_0                -7.496223e-01 1 1  ON 20
 eO_1                -4.278466e-01 1 1  ON 21
 eO_2                -1.241264e-02 1 1  ON 22
 eO_3                 3.046808e-01 1 1  ON 23
 eO_4                 5.328666e-01 1 1  ON 24
 eO_5                 4.974516e-01 1 1  ON 25
 eO_6                 2.675358e-01 1 1  ON 26
 eO_7                -4.320670e-02 1 1  ON 27
 eO_8                -2.436481e-01 1 1  ON 28
 eO_9                -1.178260e-01 1 1  ON 29
eH1_0                -2.674494e-01 1 1  ON 30
eH1_1                -1.614898e-01 1 1  ON 31
eH1_2                -1.121349e-01 1 1  ON 32
eH1_3                -5.635239e-02 1 1  ON 33
eH1_4                -6.376558e-03 1 1  ON 34
eH1_5                 3.012204e-02 1 1  ON 35
eH1_6                 9.385078e-02 1 1  ON 36
eH1_7                 1.614967e-01 1 1  ON 37
eH1_8                 2.037153e-01 1 1  ON 38
eH1_9                 1.122974e-01 1 1  ON 39
eH2_0                -2.648033e-01 1 1  ON 40
eH2_1                -1.588676e-01 1 1  ON 41
eH2_2                -1.095349e-01 1 1  ON 42
eH2_3                -5.387580e-02 1 1  ON 43
eH2_4                -3.706314e-03 1 1  ON 44
eH2_5                 3.406701e-02 1 1  ON 45
eH2_6                 9.728600e-02 1 1  ON 46
eH2_7                 1.616918e-01 1 1  ON 47
eH2_8                 2.046395e-01 1 1  ON 48
eH2_9                 1.031978e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9095
    reference variance = 0.191429
====================================================
  Execution time = 1.9818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6906e+01
  VMC Evar = 3.3614e-01
  Total weights = 2.0000e+06
  Execution time = 1.8376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335910395551
                                         uncertainty =       0.004757345475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335910395551
                                         uncertainty =       0.004757345475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409960523
  error estimate for blocks of size 2^( 2) =       0.000422509231
  error estimate for blocks of size 2^( 3) =       0.000435100109
  error estimate for blocks of size 2^( 4) =       0.000446528716
  error estimate for blocks of size 2^( 5) =       0.000457039663
  error estimate for blocks of size 2^( 6) =       0.000464172690
  error estimate for blocks of size 2^( 7) =       0.000469609273

      target function =                  N/A
              le_mean =     -16.906430554432
             les_mean =     286.163529183796
             stat err =       0.000459337586
             autocorr =       1.255393543652
              std dev =       0.579771730961
             le_variance =       0.336135260021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335915341840
                                         uncertainty =       0.004757422406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335915341840
                                         uncertainty =       0.004757422406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409963546
  error estimate for blocks of size 2^( 2) =       0.000422512027
  error estimate for blocks of size 2^( 3) =       0.000435102466
  error estimate for blocks of size 2^( 4) =       0.000446530375
  error estimate for blocks of size 2^( 5) =       0.000457040904
  error estimate for blocks of size 2^( 6) =       0.000464173397
  error estimate for blocks of size 2^( 7) =       0.000469609324

      target function =                  N/A
              le_mean =     -16.906430638651
             les_mean =     286.163536989133
             stat err =       0.000459338500
             autocorr =       1.255380025237
              std dev =       0.579776006490
             le_variance =       0.336140217701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335912339508
                                         uncertainty =       0.004757363565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335912339508
                                         uncertainty =       0.004757363565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409961711
  error estimate for blocks of size 2^( 2) =       0.000422510326
  error estimate for blocks of size 2^( 3) =       0.000435100999
  error estimate for blocks of size 2^( 4) =       0.000446529259
  error estimate for blocks of size 2^( 5) =       0.000457039994
  error estimate for blocks of size 2^( 6) =       0.000464172748
  error estimate for blocks of size 2^( 7) =       0.000469609006

      target function =                  N/A
              le_mean =     -16.906430598986
             les_mean =     286.163532639381
             stat err =       0.000459337752
             autocorr =       1.255387171787
              std dev =       0.579773411873
             le_variance =       0.336137209115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335910641595
                                         uncertainty =       0.004757347652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335910641595
                                         uncertainty =       0.004757347652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409960673
  error estimate for blocks of size 2^( 2) =       0.000422509370
  error estimate for blocks of size 2^( 3) =       0.000435100222
  error estimate for blocks of size 2^( 4) =       0.000446528785
  error estimate for blocks of size 2^( 5) =       0.000457039705
  error estimate for blocks of size 2^( 6) =       0.000464172698
  error estimate for blocks of size 2^( 7) =       0.000469609239

      target function =                  N/A
              le_mean =     -16.906430559963
             les_mean =     286.163529617508
             stat err =       0.000459337607
             autocorr =       1.255392737191
              std dev =       0.579771943720
             le_variance =       0.336135506724


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.906430554432        initial
     5.6843e+00     5.6843e+01             4.0063e-05       -16.906430638651  <--
     2.2737e+01     2.2737e+02             1.0114e-05       -16.906430598986
     9.0949e+01     9.0949e+02             2.5295e-06       -16.906430559963

*****************************************************************************
Applying the update for shift_i =   5.6843e+00     and shift_s =   5.6843e+01
*****************************************************************************

  Execution time = 2.9105e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.119502e-01 1 1  ON 0
 uu_1                 1.443344e-01 1 1  ON 1
 uu_2                 4.230326e-02 1 1  ON 2
 uu_3                -2.087400e-02 1 1  ON 3
 uu_4                -6.734868e-02 1 1  ON 4
 uu_5                -1.038428e-01 1 1  ON 5
 uu_6                -1.331901e-01 1 1  ON 6
 uu_7                -1.491723e-01 1 1  ON 7
 uu_8                -1.429928e-01 1 1  ON 8
 uu_9                -1.125317e-01 1 1  ON 9
 ud_0                 4.543167e-01 1 1  ON 10
 ud_1                 1.882661e-01 1 1  ON 11
 ud_2                 6.726057e-02 1 1  ON 12
 ud_3                -4.393934e-03 1 1  ON 13
 ud_4                -6.210423e-02 1 1  ON 14
 ud_5                -1.047283e-01 1 1  ON 15
 ud_6                -1.334004e-01 1 1  ON 16
 ud_7                -1.510358e-01 1 1  ON 17
 ud_8                -1.524560e-01 1 1  ON 18
 ud_9                -1.435410e-01 1 1  ON 19
 eO_0                -7.496281e-01 1 1  ON 20
 eO_1                -4.278327e-01 1 1  ON 21
 eO_2                -1.240719e-02 1 1  ON 22
 eO_3                 3.046992e-01 1 1  ON 23
 eO_4                 5.328688e-01 1 1  ON 24
 eO_5                 4.974593e-01 1 1  ON 25
 eO_6                 2.675366e-01 1 1  ON 26
 eO_7                -4.321129e-02 1 1  ON 27
 eO_8                -2.436654e-01 1 1  ON 28
 eO_9                -1.178440e-01 1 1  ON 29
eH1_0                -2.674423e-01 1 1  ON 30
eH1_1                -1.614867e-01 1 1  ON 31
eH1_2                -1.121435e-01 1 1  ON 32
eH1_3                -5.637036e-02 1 1  ON 33
eH1_4                -6.378645e-03 1 1  ON 34
eH1_5                 3.013612e-02 1 1  ON 35
eH1_6                 9.384750e-02 1 1  ON 36
eH1_7                 1.614870e-01 1 1  ON 37
eH1_8                 2.037161e-01 1 1  ON 38
eH1_9                 1.123117e-01 1 1  ON 39
eH2_0                -2.648072e-01 1 1  ON 40
eH2_1                -1.588793e-01 1 1  ON 41
eH2_2                -1.095500e-01 1 1  ON 42
eH2_3                -5.386492e-02 1 1  ON 43
eH2_4                -3.713962e-03 1 1  ON 44
eH2_5                 3.406766e-02 1 1  ON 45
eH2_6                 9.728637e-02 1 1  ON 46
eH2_7                 1.616936e-01 1 1  ON 47
eH2_8                 2.046449e-01 1 1  ON 48
eH2_9                 1.032143e-01 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4812e+01 secs
  Total Execution time = 2.2369e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
