Rank =    0  Free Memory = 85100 MB
Rank =    1  Free Memory = 85100 MB
Rank =    2  Free Memory = 85100 MB
Rank =    3  Free Memory = 85099 MB
Rank =    4  Free Memory = 85099 MB
Rank =    5  Free Memory = 85099 MB
Rank =    6  Free Memory = 85099 MB
Rank =    7  Free Memory = 85099 MB
Rank =    8  Free Memory = 85099 MB
Rank =    9  Free Memory = 85099 MB
Rank =   10  Free Memory = 85099 MB
Rank =   11  Free Memory = 85099 MB
Rank =   12  Free Memory = 85099 MB
Rank =   13  Free Memory = 85099 MB
Rank =   14  Free Memory = 85098 MB
Rank =   15  Free Memory = 85084 MB
Rank =   16  Free Memory = 85084 MB
Rank =   17  Free Memory = 85084 MB
Rank =   18  Free Memory = 85084 MB
Rank =   19  Free Memory = 85084 MB
Rank =   20  Free Memory = 85084 MB
Rank =   21  Free Memory = 85084 MB
Rank =   22  Free Memory = 85084 MB
Rank =   23  Free Memory = 85084 MB
Rank =   24  Free Memory = 85084 MB
Rank =   25  Free Memory = 85084 MB
Rank =   26  Free Memory = 85084 MB
Rank =   27  Free Memory = 85084 MB
Rank =   28  Free Memory = 85084 MB
Rank =   29  Free Memory = 85084 MB
Rank =   30  Free Memory = 85084 MB
Rank =   31  Free Memory = 85084 MB
Rank =   32  Free Memory = 74107 MB
Rank =   33  Free Memory = 74107 MB
Rank =   34  Free Memory = 74107 MB
Rank =   35  Free Memory = 74107 MB
Rank =   36  Free Memory = 74107 MB
Rank =   37  Free Memory = 74107 MB
Rank =   38  Free Memory = 74107 MB
Rank =   39  Free Memory = 74107 MB
Rank =   40  Free Memory = 74107 MB
Rank =   41  Free Memory = 74107 MB
Rank =   42  Free Memory = 74107 MB
Rank =   43  Free Memory = 74107 MB
Rank =   44  Free Memory = 74107 MB
Rank =   45  Free Memory = 74107 MB
Rank =   46  Free Memory = 74107 MB
Rank =   47  Free Memory = 74107 MB
Rank =   48  Free Memory = 74107 MB
Rank =   49  Free Memory = 74107 MB
Rank =   50  Free Memory = 74107 MB
Rank =   51  Free Memory = 74107 MB
Rank =   52  Free Memory = 74107 MB
Rank =   53  Free Memory = 74107 MB
Rank =   54  Free Memory = 74107 MB
Rank =   55  Free Memory = 74107 MB
Rank =   56  Free Memory = 74107 MB
Rank =   57  Free Memory = 74107 MB
Rank =   58  Free Memory = 74107 MB
Rank =   59  Free Memory = 74107 MB
Rank =   60  Free Memory = 74107 MB
Rank =   61  Free Memory = 74107 MB
Rank =   62  Free Memory = 74107 MB
Rank =   63  Free Memory = 74107 MB
Rank =   64  Free Memory = 73014 MB
Rank =   65  Free Memory = 73013 MB
Rank =   66  Free Memory = 73013 MB
Rank =   67  Free Memory = 73013 MB
Rank =   68  Free Memory = 73013 MB
Rank =   69  Free Memory = 73013 MB
Rank =   70  Free Memory = 73013 MB
Rank =   71  Free Memory = 73013 MB
Rank =   72  Free Memory = 73013 MB
Rank =   73  Free Memory = 73013 MB
Rank =   74  Free Memory = 73013 MB
Rank =   75  Free Memory = 73013 MB
Rank =   76  Free Memory = 73013 MB
Rank =   77  Free Memory = 73013 MB
Rank =   78  Free Memory = 73013 MB
Rank =   79  Free Memory = 73013 MB
Rank =   80  Free Memory = 73013 MB
Rank =   81  Free Memory = 73013 MB
Rank =   82  Free Memory = 73013 MB
Rank =   83  Free Memory = 73013 MB
Rank =   84  Free Memory = 73013 MB
Rank =   85  Free Memory = 73013 MB
Rank =   86  Free Memory = 73013 MB
Rank =   87  Free Memory = 73013 MB
Rank =   88  Free Memory = 73013 MB
Rank =   89  Free Memory = 73013 MB
Rank =   90  Free Memory = 73013 MB
Rank =   91  Free Memory = 73013 MB
Rank =   92  Free Memory = 73013 MB
Rank =   93  Free Memory = 73013 MB
Rank =   94  Free Memory = 73013 MB
Rank =   95  Free Memory = 73013 MB
Rank =   96  Free Memory = 85247 MB
Rank =   97  Free Memory = 85247 MB
Rank =   98  Free Memory = 85247 MB
Rank =   99  Free Memory = 85247 MB
Rank =  100  Free Memory = 85247 MB
Rank =  101  Free Memory = 85247 MB
Rank =  102  Free Memory = 85247 MB
Rank =  103  Free Memory = 85247 MB
Rank =  104  Free Memory = 85247 MB
Rank =  105  Free Memory = 85247 MB
Rank =  106  Free Memory = 85247 MB
Rank =  107  Free Memory = 85247 MB
Rank =  108  Free Memory = 85247 MB
Rank =  109  Free Memory = 85247 MB
Rank =  110  Free Memory = 85247 MB
Rank =  111  Free Memory = 85247 MB
Rank =  112  Free Memory = 85247 MB
Rank =  113  Free Memory = 85247 MB
Rank =  114  Free Memory = 85247 MB
Rank =  115  Free Memory = 85247 MB
Rank =  116  Free Memory = 85247 MB
Rank =  117  Free Memory = 85247 MB
Rank =  118  Free Memory = 85247 MB
Rank =  119  Free Memory = 85247 MB
Rank =  120  Free Memory = 85247 MB
Rank =  121  Free Memory = 85247 MB
Rank =  122  Free Memory = 85247 MB
Rank =  123  Free Memory = 85247 MB
Rank =  124  Free Memory = 85247 MB
Rank =  125  Free Memory = 85247 MB
Rank =  126  Free Memory = 85247 MB
Rank =  127  Free Memory = 85247 MB
  Input file(s): opt_h2o_1b1_edesc_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_1b1_edesc_run001d.xml

  Project = H2O
  date    = 2023-03-03 17:37:26 PST
  host    = n0113.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 214

  Range of prime numbers to use as seeds over processors and threads = 1321-2311


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 3.080498e-01    1         1  ON     0
     uu_1                 1.412818e-01    1         1  ON     1
     uu_2                 4.049641e-02    1         1  ON     2
     uu_3                -2.091039e-02    1         1  ON     3
     uu_4                -6.436460e-02    1         1  ON     4
     uu_5                -9.711026e-02    1         1  ON     5
     uu_6                -1.230012e-01    1         1  ON     6
     uu_7                -1.345659e-01    1         1  ON     7
     uu_8                -1.257867e-01    1         1  ON     8
     uu_9                -9.639029e-02    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 4.400011e-01    1         1  ON     0
     ud_1                 1.757947e-01    1         1  ON     1
     ud_2                 5.929423e-02    1         1  ON     2
     ud_3                -9.736014e-03    1         1  ON     3
     ud_4                -6.672413e-02    1         1  ON     4
     ud_5                -1.069756e-01    1         1  ON     5
     ud_6                -1.325991e-01    1         1  ON     6
     ud_7                -1.468293e-01    1         1  ON     7
     ud_8                -1.470633e-01    1         1  ON     8
     ud_9                -1.369486e-01    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -7.536949e-01    1         1  ON     0
     eO_1                -4.366744e-01    1         1  ON     1
     eO_2                -1.913127e-02    1         1  ON     2
     eO_3                 2.974115e-01    1         1  ON     3
     eO_4                 5.175470e-01    1         1  ON     4
     eO_5                 4.738543e-01    1         1  ON     5
     eO_6                 2.436411e-01    1         1  ON     6
     eO_7                -5.214842e-02    1         1  ON     7
     eO_8                -2.058174e-01    1         1  ON     8
     eO_9                -6.642309e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -2.309121e-01    1         1  ON     0
     eH1_1                -1.340279e-01    1         1  ON     1
     eH1_2                -8.987319e-02    1         1  ON     2
     eH1_3                -3.706594e-02    1         1  ON     3
     eH1_4                 1.014689e-02    1         1  ON     4
     eH1_5                 4.323411e-02    1         1  ON     5
     eH1_6                 9.729324e-02    1         1  ON     6
     eH1_7                 1.438614e-01    1         1  ON     7
     eH1_8                 1.570022e-01    1         1  ON     8
     eH1_9                 4.435545e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -2.288175e-01    1         1  ON     0
     eH2_1                -1.318423e-01    1         1  ON     1
     eH2_2                -8.769696e-02    1         1  ON     2
     eH2_3                -3.452217e-02    1         1  ON     3
     eH2_4                 1.291288e-02    1         1  ON     4
     eH2_5                 4.670636e-02    1         1  ON     5
     eH2_6                 1.016835e-01    1         1  ON     6
     eH2_7                 1.499661e-01    1         1  ON     7
     eH2_8                 1.635692e-01    1         1  ON     8
     eH2_9                 2.638065e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 75 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 1.362963e+00
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 30 unique up determinants.
Found 30 unique down determinants.
Number of terms in pairs array: 20
Number of terms in pairs array: 20
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.2755e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u  6.1002844054e-01  1.3250453608e-01 -4.2267217978e-01
    u -4.3494847795e-01 -2.3203549626e-01  1.0876787134e-01
    u -1.5984350305e-01  8.1842956548e-01  5.1837161342e-02
    u  1.1948334779e+00  1.4453040952e+00  1.6346730752e+00
    d -9.5054657961e-01  2.3768909128e-01 -6.0876959125e-01
    d -2.0429807517e-01  1.5546410594e+00 -1.0292769217e-01
    d  4.7451519973e-01  3.4811618685e-02  3.5425821429e-01
    d -8.6403568621e-02 -1.8286319639e+00  9.9844026831e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 40
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9051
    reference variance = 0.278594
====================================================
  Execution time = 2.1168e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3825e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4883e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338177932090
                                         uncertainty =       0.004510514911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338177932090
                                         uncertainty =       0.004510514911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411247169
  error estimate for blocks of size 2^( 2) =       0.000424653558
  error estimate for blocks of size 2^( 3) =       0.000439737761
  error estimate for blocks of size 2^( 4) =       0.000455852628
  error estimate for blocks of size 2^( 5) =       0.000470972915
  error estimate for blocks of size 2^( 6) =       0.000484982356
  error estimate for blocks of size 2^( 7) =       0.000495883738

      target function =                  N/A
              le_mean =     -16.910763770633
             les_mean =     286.312179604557
             stat err =       0.000476922909
             autocorr =       1.344901651501
              std dev =       0.581591323454
             le_variance =       0.338248467518


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.691076377063e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910763770633       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910787218392       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910794458231       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910794030368       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910793295321       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910792849011       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910794346280       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910794836941       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910796247064       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910796390700       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910796134499       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910796174413       residual = 3.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.708827e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910763770633       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910772281841       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910776337531       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910776687023       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910775942788       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910775935436       residual = 9.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910775925962       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910776168363       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910776424499       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910776392897       residual = 3.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 9.303621e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910763770633       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910766169467       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910767505483       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910767709085       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910767610902       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910767448344       residual = 8.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910767427783       residual = 6.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910767515444       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910767534536       residual = 4.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 2.664861e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.007036 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6669e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  3.078158e-01                 1 1 ON  0
uu_1  1.412638e-01                 1 1 ON  1
uu_2  4.049925e-02                 1 1 ON  2
uu_3  -2.078564e-02                1 1 ON  3
uu_4  -6.419565e-02                1 1 ON  4
uu_5  -9.695486e-02                1 1 ON  5
uu_6  -1.229043e-01                1 1 ON  6
uu_7  -1.345485e-01                1 1 ON  7
uu_8  -1.259275e-01                1 1 ON  8
uu_9  -9.665350e-02                1 1 ON  9
ud_0  4.403958e-01                 1 1 ON  10
ud_1  1.762271e-01                 1 1 ON  11
ud_2  5.891178e-02                 1 1 ON  12
ud_3  -1.012756e-02                1 1 ON  13
ud_4  -6.669119e-02                1 1 ON  14
ud_5  -1.069515e-01                1 1 ON  15
ud_6  -1.325362e-01                1 1 ON  16
ud_7  -1.469099e-01                1 1 ON  17
ud_8  -1.470448e-01                1 1 ON  18
ud_9  -1.369712e-01                1 1 ON  19
eO_0  -7.546253e-01                1 1 ON  20
eO_1  -4.367168e-01                1 1 ON  21
eO_2  -1.896481e-02                1 1 ON  22
eO_3  2.978598e-01                 1 1 ON  23
eO_4  5.178174e-01                 1 1 ON  24
eO_5  4.740328e-01                 1 1 ON  25
eO_6  2.438372e-01                 1 1 ON  26
eO_7  -5.204125e-02                1 1 ON  27
eO_8  -2.060138e-01                1 1 ON  28
eO_9  -6.659763e-02                1 1 ON  29
eH1_0 -2.312277e-01                1 1 ON  30
eH1_1 -1.341608e-01                1 1 ON  31
eH1_2 -9.000429e-02                1 1 ON  32
eH1_3 -3.688602e-02                1 1 ON  33
eH1_4 1.003848e-02                 1 1 ON  34
eH1_5 4.328068e-02                 1 1 ON  35
eH1_6 9.733836e-02                 1 1 ON  36
eH1_7 1.439731e-01                 1 1 ON  37
eH1_8 1.571487e-01                 1 1 ON  38
eH1_9 4.450995e-02                 1 1 ON  39
eH2_0 -2.290926e-01                1 1 ON  40
eH2_1 -1.319345e-01                1 1 ON  41
eH2_2 -8.770344e-02                1 1 ON  42
eH2_3 -3.440948e-02                1 1 ON  43
eH2_4 1.278588e-02                 1 1 ON  44
eH2_5 4.667490e-02                 1 1 ON  45
eH2_6 1.016631e-01                 1 1 ON  46
eH2_7 1.499619e-01                 1 1 ON  47
eH2_8 1.637880e-01                 1 1 ON  48
eH2_9 2.661741e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -16.9513
    reference variance = 0.235186
====================================================
  Execution time = 2.0734e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4075e-01
  Total weights = 2.0000e+06
  Execution time = 1.8878e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340459470158
                                         uncertainty =       0.005547104433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340459470158
                                         uncertainty =       0.005547104433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412546563
  error estimate for blocks of size 2^( 2) =       0.000426066540
  error estimate for blocks of size 2^( 3) =       0.000441028955
  error estimate for blocks of size 2^( 4) =       0.000455498681
  error estimate for blocks of size 2^( 5) =       0.000469528533
  error estimate for blocks of size 2^( 6) =       0.000481070315
  error estimate for blocks of size 2^( 7) =       0.000488222022

      target function =                  N/A
              le_mean =     -16.911323151147
             les_mean =     286.333239885746
             stat err =       0.000473579888
             autocorr =       1.317772843695
              std dev =       0.583428944634
             le_variance =       0.340389333437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341529461904
                                         uncertainty =       0.005582489362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341529461904
                                         uncertainty =       0.005582489362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413194340
  error estimate for blocks of size 2^( 2) =       0.000426665200
  error estimate for blocks of size 2^( 3) =       0.000441577839
  error estimate for blocks of size 2^( 4) =       0.000455994223
  error estimate for blocks of size 2^( 5) =       0.000469966778
  error estimate for blocks of size 2^( 6) =       0.000481471134
  error estimate for blocks of size 2^( 7) =       0.000488581821

      target function =                  N/A
              le_mean =     -16.911323619435
             les_mean =     286.334325514993
             stat err =       0.000474003489
             autocorr =       1.315995335952
              std dev =       0.584345038870
             le_variance =       0.341459124452

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341216381300
                                         uncertainty =       0.005576024522

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341216381300
                                         uncertainty =       0.005576024522

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413004886
  error estimate for blocks of size 2^( 2) =       0.000426485592
  error estimate for blocks of size 2^( 3) =       0.000441407470
  error estimate for blocks of size 2^( 4) =       0.000455836998
  error estimate for blocks of size 2^( 5) =       0.000469824069
  error estimate for blocks of size 2^( 6) =       0.000481341431
  error estimate for blocks of size 2^( 7) =       0.000488465544

      target function =                  N/A
              le_mean =     -16.911321691845
             les_mean =     286.333947266756
             stat err =       0.000473867010
             autocorr =       1.316444548192
              std dev =       0.584077111584
             le_variance =       0.341146072276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340556042538
                                         uncertainty =       0.005551474414

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340556042538
                                         uncertainty =       0.005551474414

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412605065
  error estimate for blocks of size 2^( 2) =       0.000426118877
  error estimate for blocks of size 2^( 3) =       0.000441074952
  error estimate for blocks of size 2^( 4) =       0.000455538739
  error estimate for blocks of size 2^( 5) =       0.000469562473
  error estimate for blocks of size 2^( 6) =       0.000481101084
  error estimate for blocks of size 2^( 7) =       0.000488249004

      target function =                  N/A
              le_mean =     -16.911321875091
             les_mean =     286.333293271436
             stat err =       0.000473612825
             autocorr =       1.317582442819
              std dev =       0.583511678340
             le_variance =       0.340485878760


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911323151147        initial
     2.5000e-01     2.5000e+00             2.7088e-03       -16.911323619435  <--
     1.0000e+00     1.0000e+01             9.3036e-04       -16.911321691845
     4.0000e+00     4.0000e+01             2.6649e-04       -16.911321875091

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 3.0315e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 3.076069e-01 1 1  ON 0
 uu_1                 1.413034e-01 1 1  ON 1
 uu_2                 4.053112e-02 1 1  ON 2
 uu_3                -2.058166e-02 1 1  ON 3
 uu_4                -6.392523e-02 1 1  ON 4
 uu_5                -9.662723e-02 1 1  ON 5
 uu_6                -1.226891e-01 1 1  ON 6
 uu_7                -1.345220e-01 1 1  ON 7
 uu_8                -1.263158e-01 1 1  ON 8
 uu_9                -9.743156e-02 1 1  ON 9
 ud_0                 4.412098e-01 1 1  ON 10
 ud_1                 1.767684e-01 1 1  ON 11
 ud_2                 5.852615e-02 1 1  ON 12
 ud_3                -1.078447e-02 1 1  ON 13
 ud_4                -6.683120e-02 1 1  ON 14
 ud_5                -1.069145e-01 1 1  ON 15
 ud_6                -1.323714e-01 1 1  ON 16
 ud_7                -1.470240e-01 1 1  ON 17
 ud_8                -1.469782e-01 1 1  ON 18
 ud_9                -1.370324e-01 1 1  ON 19
 eO_0                -7.564038e-01 1 1  ON 20
 eO_1                -4.372235e-01 1 1  ON 21
 eO_2                -1.888363e-02 1 1  ON 22
 eO_3                 2.986678e-01 1 1  ON 23
 eO_4                 5.187584e-01 1 1  ON 24
 eO_5                 4.747494e-01 1 1  ON 25
 eO_6                 2.444426e-01 1 1  ON 26
 eO_7                -5.172661e-02 1 1  ON 27
 eO_8                -2.065985e-01 1 1  ON 28
 eO_9                -6.712358e-02 1 1  ON 29
eH1_0                -2.320217e-01 1 1  ON 30
eH1_1                -1.345319e-01 1 1  ON 31
eH1_2                -9.023545e-02 1 1  ON 32
eH1_3                -3.671255e-02 1 1  ON 33
eH1_4                 9.800889e-03 1 1  ON 34
eH1_5                 4.332851e-02 1 1  ON 35
eH1_6                 9.748824e-02 1 1  ON 36
eH1_7                 1.443166e-01 1 1  ON 37
eH1_8                 1.575886e-01 1 1  ON 38
eH1_9                 4.497784e-02 1 1  ON 39
eH2_0                -2.297558e-01 1 1  ON 40
eH2_1                -1.321638e-01 1 1  ON 41
eH2_2                -8.773116e-02 1 1  ON 42
eH2_3                -3.433327e-02 1 1  ON 43
eH2_4                 1.247127e-02 1 1  ON 44
eH2_5                 4.652426e-02 1 1  ON 45
eH2_6                 1.016351e-01 1 1  ON 46
eH2_7                 1.499686e-01 1 1  ON 47
eH2_8                 1.644370e-01 1 1  ON 48
eH2_9                 2.733147e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6991e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6928e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8884
    reference variance = 0.266278
====================================================
  Execution time = 2.2760e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3952e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5764e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339515554948
                                         uncertainty =       0.003308731089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339515554948
                                         uncertainty =       0.003308731089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412016750
  error estimate for blocks of size 2^( 2) =       0.000426320822
  error estimate for blocks of size 2^( 3) =       0.000440899731
  error estimate for blocks of size 2^( 4) =       0.000456285750
  error estimate for blocks of size 2^( 5) =       0.000472259299
  error estimate for blocks of size 2^( 6) =       0.000486164722
  error estimate for blocks of size 2^( 7) =       0.000494388439

      target function =                  N/A
              le_mean =     -16.909987756175
             les_mean =     286.287201348934
             stat err =       0.000477274553
             autocorr =       1.341858787112
              std dev =       0.582679675892
             le_variance =       0.339515604697


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.690998775618e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909987756175       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909990745165       residual = 7.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909996290342       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909998024845       residual = 6.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909997461950       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910003427082       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910003297892       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910005143953       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910002598256       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910004151491       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910004985448       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910004470569       residual = 7.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910005071738       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910005431037       residual = 9.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 4.718935e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909987756175       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909989389319       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909993041550       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909992836211       residual = 5.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909992982774       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909995380059       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909996525166       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909995524455       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909995245993       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.909995143927       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.909995407059       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.662215e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.909987756175       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.909988336445       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.909989677044       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.909989736291       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.909989708072       residual = 7.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.909990410053       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.909990624110       residual = 9.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.909990463152       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.909990432888       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.982723e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.012368 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8345e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.075079e-01 1 1  ON 0
 uu_1                 1.411025e-01 1 1  ON 1
 uu_2                 4.046438e-02 1 1  ON 2
 uu_3                -2.060283e-02 1 1  ON 3
 uu_4                -6.389118e-02 1 1  ON 4
 uu_5                -9.661789e-02 1 1  ON 5
 uu_6                -1.227978e-01 1 1  ON 6
 uu_7                -1.346537e-01 1 1  ON 7
 uu_8                -1.262226e-01 1 1  ON 8
 uu_9                -9.751834e-02 1 1  ON 9
 ud_0                 4.419198e-01 1 1  ON 10
 ud_1                 1.771254e-01 1 1  ON 11
 ud_2                 5.807892e-02 1 1  ON 12
 ud_3                -1.142613e-02 1 1  ON 13
 ud_4                -6.732531e-02 1 1  ON 14
 ud_5                -1.070809e-01 1 1  ON 15
 ud_6                -1.325322e-01 1 1  ON 16
 ud_7                -1.470185e-01 1 1  ON 17
 ud_8                -1.464575e-01 1 1  ON 18
 ud_9                -1.365610e-01 1 1  ON 19
 eO_0                -7.580660e-01 1 1  ON 20
 eO_1                -4.382154e-01 1 1  ON 21
 eO_2                -1.887608e-02 1 1  ON 22
 eO_3                 2.996561e-01 1 1  ON 23
 eO_4                 5.198709e-01 1 1  ON 24
 eO_5                 4.756086e-01 1 1  ON 25
 eO_6                 2.447196e-01 1 1  ON 26
 eO_7                -5.147484e-02 1 1  ON 27
 eO_8                -2.068597e-01 1 1  ON 28
 eO_9                -6.755982e-02 1 1  ON 29
eH1_0                -2.329886e-01 1 1  ON 30
eH1_1                -1.349835e-01 1 1  ON 31
eH1_2                -9.011245e-02 1 1  ON 32
eH1_3                -3.649537e-02 1 1  ON 33
eH1_4                 9.376795e-03 1 1  ON 34
eH1_5                 4.303616e-02 1 1  ON 35
eH1_6                 9.744694e-02 1 1  ON 36
eH1_7                 1.446358e-01 1 1  ON 37
eH1_8                 1.583529e-01 1 1  ON 38
eH1_9                 4.570444e-02 1 1  ON 39
eH2_0                -2.303295e-01 1 1  ON 40
eH2_1                -1.325605e-01 1 1  ON 41
eH2_2                -8.775109e-02 1 1  ON 42
eH2_3                -3.427303e-02 1 1  ON 43
eH2_4                 1.231525e-02 1 1  ON 44
eH2_5                 4.593411e-02 1 1  ON 45
eH2_6                 1.014878e-01 1 1  ON 46
eH2_7                 1.501176e-01 1 1  ON 47
eH2_8                 1.650189e-01 1 1  ON 48
eH2_9                 2.830430e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -16.8934
    reference variance = 0.33159
====================================================
  Execution time = 2.0106e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.7205e-01
  Total weights = 2.0000e+06
  Execution time = 1.8921e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371399253227
                                         uncertainty =       0.028972986734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371399253227
                                         uncertainty =       0.028972986734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430828998
  error estimate for blocks of size 2^( 2) =       0.000443672551
  error estimate for blocks of size 2^( 3) =       0.000457823741
  error estimate for blocks of size 2^( 4) =       0.000473240629
  error estimate for blocks of size 2^( 5) =       0.000488056848
  error estimate for blocks of size 2^( 6) =       0.000501759807
  error estimate for blocks of size 2^( 7) =       0.000510113230

      target function =                  N/A
              le_mean =     -16.910754680443
             les_mean =     286.344850927503
             stat err =       0.000493292629
             autocorr =       1.310990056562
              std dev =       0.609284211988
             le_variance =       0.371227250978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.373086923778
                                         uncertainty =       0.029221077508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.373086923778
                                         uncertainty =       0.029221077508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431806704
  error estimate for blocks of size 2^( 2) =       0.000444615578
  error estimate for blocks of size 2^( 3) =       0.000458720572
  error estimate for blocks of size 2^( 4) =       0.000474091750
  error estimate for blocks of size 2^( 5) =       0.000488852628
  error estimate for blocks of size 2^( 6) =       0.000502507211
  error estimate for blocks of size 2^( 7) =       0.000510790713

      target function =                  N/A
              le_mean =     -16.910759103488
             les_mean =     286.346687329700
             stat err =       0.000494060576
             autocorr =       1.309126571380
              std dev =       0.610666897712
             le_variance =       0.372914059962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.373075462729
                                         uncertainty =       0.029233129266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.373075462729
                                         uncertainty =       0.029233129266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431800107
  error estimate for blocks of size 2^( 2) =       0.000444601423
  error estimate for blocks of size 2^( 3) =       0.000458702855
  error estimate for blocks of size 2^( 4) =       0.000474077220
  error estimate for blocks of size 2^( 5) =       0.000488845863
  error estimate for blocks of size 2^( 6) =       0.000502509497
  error estimate for blocks of size 2^( 7) =       0.000510804128

      target function =                  N/A
              le_mean =     -16.910758430136
             les_mean =     286.346653160644
             stat err =       0.000494059177
             autocorr =       1.309159163801
              std dev =       0.610657567440
             le_variance =       0.372902664671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371710881988
                                         uncertainty =       0.029021957010

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371710881988
                                         uncertainty =       0.029021957010

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000431009704
  error estimate for blocks of size 2^( 2) =       0.000443843167
  error estimate for blocks of size 2^( 3) =       0.000457983308
  error estimate for blocks of size 2^( 4) =       0.000473391663
  error estimate for blocks of size 2^( 5) =       0.000488198831
  error estimate for blocks of size 2^( 6) =       0.000501896020
  error estimate for blocks of size 2^( 7) =       0.000510240612

      target function =                  N/A
              le_mean =     -16.910753437932
             les_mean =     286.345120383333
             stat err =       0.000493431782
             autocorr =       1.310630106993
              std dev =       0.609539769469
             le_variance =       0.371538730565


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910754680443        initial
     6.2500e-02     6.2500e-01             4.7189e-03       -16.910759103488  <--
     2.5000e-01     2.5000e+00             1.6622e-03       -16.910758430136
     1.0000e+00     1.0000e+01             4.9827e-04       -16.910753437932

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9658e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 3.075938e-01 1 1  ON 0
 uu_1                 1.412166e-01 1 1  ON 1
 uu_2                 4.047029e-02 1 1  ON 2
 uu_3                -2.068853e-02 1 1  ON 3
 uu_4                -6.412982e-02 1 1  ON 4
 uu_5                -9.691069e-02 1 1  ON 5
 uu_6                -1.231674e-01 1 1  ON 6
 uu_7                -1.350365e-01 1 1  ON 7
 uu_8                -1.264025e-01 1 1  ON 8
 uu_9                -9.790895e-02 1 1  ON 9
 ud_0                 4.425893e-01 1 1  ON 10
 ud_1                 1.774157e-01 1 1  ON 11
 ud_2                 5.785541e-02 1 1  ON 12
 ud_3                -1.208808e-02 1 1  ON 13
 ud_4                -6.811487e-02 1 1  ON 14
 ud_5                -1.076225e-01 1 1  ON 15
 ud_6                -1.329168e-01 1 1  ON 16
 ud_7                -1.469177e-01 1 1  ON 17
 ud_8                -1.457069e-01 1 1  ON 18
 ud_9                -1.353584e-01 1 1  ON 19
 eO_0                -7.611227e-01 1 1  ON 20
 eO_1                -4.404115e-01 1 1  ON 21
 eO_2                -1.968136e-02 1 1  ON 22
 eO_3                 3.007726e-01 1 1  ON 23
 eO_4                 5.225925e-01 1 1  ON 24
 eO_5                 4.784837e-01 1 1  ON 25
 eO_6                 2.460967e-01 1 1  ON 26
 eO_7                -5.084447e-02 1 1  ON 27
 eO_8                -2.077667e-01 1 1  ON 28
 eO_9                -6.887966e-02 1 1  ON 29
eH1_0                -2.345415e-01 1 1  ON 30
eH1_1                -1.359175e-01 1 1  ON 31
eH1_2                -9.056053e-02 1 1  ON 32
eH1_3                -3.683853e-02 1 1  ON 33
eH1_4                 8.511073e-03 1 1  ON 34
eH1_5                 4.203740e-02 1 1  ON 35
eH1_6                 9.711170e-02 1 1  ON 36
eH1_7                 1.455835e-01 1 1  ON 37
eH1_8                 1.606207e-01 1 1  ON 38
eH1_9                 4.787996e-02 1 1  ON 39
eH2_0                -2.314378e-01 1 1  ON 40
eH2_1                -1.334124e-01 1 1  ON 41
eH2_2                -8.823244e-02 1 1  ON 42
eH2_3                -3.471455e-02 1 1  ON 43
eH2_4                 1.167141e-02 1 1  ON 44
eH2_5                 4.464328e-02 1 1  ON 45
eH2_6                 1.008990e-01 1 1  ON 46
eH2_7                 1.505456e-01 1 1  ON 47
eH2_8                 1.667251e-01 1 1  ON 48
eH2_9                 3.120597e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8010e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6910e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.7752
    reference variance = 0.295925
====================================================
  Execution time = 2.0801e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4520e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5029e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344800971968
                                         uncertainty =       0.006387895080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344800971968
                                         uncertainty =       0.006387895080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415449496
  error estimate for blocks of size 2^( 2) =       0.000428997050
  error estimate for blocks of size 2^( 3) =       0.000442946572
  error estimate for blocks of size 2^( 4) =       0.000458255060
  error estimate for blocks of size 2^( 5) =       0.000471226994
  error estimate for blocks of size 2^( 6) =       0.000483260687
  error estimate for blocks of size 2^( 7) =       0.000495043991

      target function =                  N/A
              le_mean =     -16.911721651956
             les_mean =     286.351525628852
             stat err =       0.000476946683
             autocorr =       1.317962919145
              std dev =       0.587534312384
             le_variance =       0.345196568229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691172165196e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911721651956       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911721480218       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911723959830       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911729933776       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911728532740       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911726990439       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911731607647       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911728818671       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911733474034       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911740099798       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911742496294       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911742376106       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911742608377       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.911743930177       residual = 9.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.911744944495       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.911744473153       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.911746505323       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.911745565646       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.911745784353       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.911745972776       residual = 6.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.299202e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911721651956       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911721514614       residual = 5.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911723117100       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911727491390       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911726623958       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911725504028       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911728506668       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911726323566       residual = 6.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911728443512       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911730008016       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.911729931814       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.911729627036       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.911729774632       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.875245e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911721651956       residual = 7.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911721575703       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911722163226       residual = 2.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911724093832       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911723803842       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911725430520       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911723905393       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911724473478       residual = 7.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.911724457191       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.911724746086       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.011089e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020808 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6319e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.084011e-01 1 1  ON 0
 uu_1                 1.416263e-01 1 1  ON 1
 uu_2                 4.090677e-02 1 1  ON 2
 uu_3                -2.031413e-02 1 1  ON 3
 uu_4                -6.360701e-02 1 1  ON 4
 uu_5                -9.670156e-02 1 1  ON 5
 uu_6                -1.233178e-01 1 1  ON 6
 uu_7                -1.363685e-01 1 1  ON 7
 uu_8                -1.282333e-01 1 1  ON 8
 uu_9                -9.946719e-02 1 1  ON 9
 ud_0                 4.435012e-01 1 1  ON 10
 ud_1                 1.777413e-01 1 1  ON 11
 ud_2                 5.799654e-02 1 1  ON 12
 ud_3                -1.250196e-02 1 1  ON 13
 ud_4                -6.881521e-02 1 1  ON 14
 ud_5                -1.080333e-01 1 1  ON 15
 ud_6                -1.329127e-01 1 1  ON 16
 ud_7                -1.469997e-01 1 1  ON 17
 ud_8                -1.457124e-01 1 1  ON 18
 ud_9                -1.352161e-01 1 1  ON 19
 eO_0                -7.634348e-01 1 1  ON 20
 eO_1                -4.422282e-01 1 1  ON 21
 eO_2                -2.051289e-02 1 1  ON 22
 eO_3                 3.008251e-01 1 1  ON 23
 eO_4                 5.250245e-01 1 1  ON 24
 eO_5                 4.810957e-01 1 1  ON 25
 eO_6                 2.499719e-01 1 1  ON 26
 eO_7                -4.947679e-02 1 1  ON 27
 eO_8                -2.103579e-01 1 1  ON 28
 eO_9                -7.122381e-02 1 1  ON 29
eH1_0                -2.362607e-01 1 1  ON 30
eH1_1                -1.371584e-01 1 1  ON 31
eH1_2                -9.157101e-02 1 1  ON 32
eH1_3                -3.822513e-02 1 1  ON 33
eH1_4                 7.512159e-03 1 1  ON 34
eH1_5                 4.099529e-02 1 1  ON 35
eH1_6                 9.636062e-02 1 1  ON 36
eH1_7                 1.470182e-01 1 1  ON 37
eH1_8                 1.638498e-01 1 1  ON 38
eH1_9                 5.089250e-02 1 1  ON 39
eH2_0                -2.332413e-01 1 1  ON 40
eH2_1                -1.341753e-01 1 1  ON 41
eH2_2                -8.867883e-02 1 1  ON 42
eH2_3                -3.499985e-02 1 1  ON 43
eH2_4                 1.126312e-02 1 1  ON 44
eH2_5                 4.343937e-02 1 1  ON 45
eH2_6                 9.996450e-02 1 1  ON 46
eH2_7                 1.512000e-01 1 1  ON 47
eH2_8                 1.689562e-01 1 1  ON 48
eH2_9                 3.395757e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -16.9338
    reference variance = 0.325198
====================================================
  Execution time = 2.0262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3939e-01
  Total weights = 2.0000e+06
  Execution time = 1.8947e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338722823626
                                         uncertainty =       0.005175864102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338722823626
                                         uncertainty =       0.005175864102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411507003
  error estimate for blocks of size 2^( 2) =       0.000425018244
  error estimate for blocks of size 2^( 3) =       0.000439891190
  error estimate for blocks of size 2^( 4) =       0.000454580486
  error estimate for blocks of size 2^( 5) =       0.000469102582
  error estimate for blocks of size 2^( 6) =       0.000481474968
  error estimate for blocks of size 2^( 7) =       0.000489445662

      target function =                  N/A
              le_mean =     -16.910586465124
             les_mean =     286.306610451757
             stat err =       0.000473650924
             autocorr =       1.324836601867
              std dev =       0.581958784326
             le_variance =       0.338676026654

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339987193964
                                         uncertainty =       0.005186217587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339987193964
                                         uncertainty =       0.005186217587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412274233
  error estimate for blocks of size 2^( 2) =       0.000425759599
  error estimate for blocks of size 2^( 3) =       0.000440584180
  error estimate for blocks of size 2^( 4) =       0.000455192688
  error estimate for blocks of size 2^( 5) =       0.000469642879
  error estimate for blocks of size 2^( 6) =       0.000481980592
  error estimate for blocks of size 2^( 7) =       0.000489927675

      target function =                  N/A
              le_mean =     -16.910584485096
             les_mean =     286.307807544212
             stat err =       0.000474185958
             autocorr =       1.322893838649
              std dev =       0.583043811906
             le_variance =       0.339940086602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340183605492
                                         uncertainty =       0.005207905087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340183605492
                                         uncertainty =       0.005207905087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412393312
  error estimate for blocks of size 2^( 2) =       0.000425873094
  error estimate for blocks of size 2^( 3) =       0.000440701034
  error estimate for blocks of size 2^( 4) =       0.000455318725
  error estimate for blocks of size 2^( 5) =       0.000469777848
  error estimate for blocks of size 2^( 6) =       0.000482133829
  error estimate for blocks of size 2^( 7) =       0.000490071715

      target function =                  N/A
              le_mean =     -16.910592087039
             les_mean =     286.308261051844
             stat err =       0.000474325529
             autocorr =       1.322908396741
              std dev =       0.583212214953
             le_variance =       0.340136487671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339071340631
                                         uncertainty =       0.005182512965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339071340631
                                         uncertainty =       0.005182512965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411718632
  error estimate for blocks of size 2^( 2) =       0.000425221239
  error estimate for blocks of size 2^( 3) =       0.000440084425
  error estimate for blocks of size 2^( 4) =       0.000454758639
  error estimate for blocks of size 2^( 5) =       0.000469268801
  error estimate for blocks of size 2^( 6) =       0.000481640738
  error estimate for blocks of size 2^( 7) =       0.000489603369

      target function =                  N/A
              le_mean =     -16.910586681002
             les_mean =     286.306966190490
             stat err =       0.000473817887
             autocorr =       1.324408197768
              std dev =       0.582258073652
             le_variance =       0.339024464333


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910586465124        initial
     1.5625e-02     1.5625e-01             1.2992e-02       -16.910584485096
     6.2500e-02     6.2500e-01             3.8752e-03       -16.910592087039  <--
     2.5000e-01     2.5000e+00             1.0111e-03       -16.910586681002

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9803e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 3.084011e-01 1 1  ON 0
 uu_1                 1.416263e-01 1 1  ON 1
 uu_2                 4.090677e-02 1 1  ON 2
 uu_3                -2.031413e-02 1 1  ON 3
 uu_4                -6.360701e-02 1 1  ON 4
 uu_5                -9.670156e-02 1 1  ON 5
 uu_6                -1.233178e-01 1 1  ON 6
 uu_7                -1.363685e-01 1 1  ON 7
 uu_8                -1.282333e-01 1 1  ON 8
 uu_9                -9.946719e-02 1 1  ON 9
 ud_0                 4.435012e-01 1 1  ON 10
 ud_1                 1.777413e-01 1 1  ON 11
 ud_2                 5.799654e-02 1 1  ON 12
 ud_3                -1.250196e-02 1 1  ON 13
 ud_4                -6.881521e-02 1 1  ON 14
 ud_5                -1.080333e-01 1 1  ON 15
 ud_6                -1.329127e-01 1 1  ON 16
 ud_7                -1.469997e-01 1 1  ON 17
 ud_8                -1.457124e-01 1 1  ON 18
 ud_9                -1.352161e-01 1 1  ON 19
 eO_0                -7.634348e-01 1 1  ON 20
 eO_1                -4.422282e-01 1 1  ON 21
 eO_2                -2.051289e-02 1 1  ON 22
 eO_3                 3.008251e-01 1 1  ON 23
 eO_4                 5.250245e-01 1 1  ON 24
 eO_5                 4.810957e-01 1 1  ON 25
 eO_6                 2.499719e-01 1 1  ON 26
 eO_7                -4.947679e-02 1 1  ON 27
 eO_8                -2.103579e-01 1 1  ON 28
 eO_9                -7.122381e-02 1 1  ON 29
eH1_0                -2.362607e-01 1 1  ON 30
eH1_1                -1.371584e-01 1 1  ON 31
eH1_2                -9.157101e-02 1 1  ON 32
eH1_3                -3.822513e-02 1 1  ON 33
eH1_4                 7.512159e-03 1 1  ON 34
eH1_5                 4.099529e-02 1 1  ON 35
eH1_6                 9.636062e-02 1 1  ON 36
eH1_7                 1.470182e-01 1 1  ON 37
eH1_8                 1.638498e-01 1 1  ON 38
eH1_9                 5.089250e-02 1 1  ON 39
eH2_0                -2.332413e-01 1 1  ON 40
eH2_1                -1.341753e-01 1 1  ON 41
eH2_2                -8.867883e-02 1 1  ON 42
eH2_3                -3.499985e-02 1 1  ON 43
eH2_4                 1.126312e-02 1 1  ON 44
eH2_5                 4.343937e-02 1 1  ON 45
eH2_6                 9.996450e-02 1 1  ON 46
eH2_7                 1.512000e-01 1 1  ON 47
eH2_8                 1.689562e-01 1 1  ON 48
eH2_9                 3.395757e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6129e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6891e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9484
    reference variance = 0.479641
====================================================
  Execution time = 2.0803e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.7142e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5444e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371421476469
                                         uncertainty =       0.038840883121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371421476469
                                         uncertainty =       0.038840883121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430942529
  error estimate for blocks of size 2^( 2) =       0.000444104363
  error estimate for blocks of size 2^( 3) =       0.000458848184
  error estimate for blocks of size 2^( 4) =       0.000474001339
  error estimate for blocks of size 2^( 5) =       0.000489440445
  error estimate for blocks of size 2^( 6) =       0.000502027527
  error estimate for blocks of size 2^( 7) =       0.000510843769

      target function =                  N/A
              le_mean =     -16.910207031131
             les_mean =     286.326524576727
             stat err =       0.000494078270
             autocorr =       1.314476405447
              std dev =       0.609444769223
             le_variance =       0.371422926734


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691020703113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910207031131       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910207900139       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910210995871       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910212841713       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910212940664       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910213325024       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910216272193       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910219386062       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910222747270       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910223300208       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910223112854       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910226533641       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910224899957       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910223870329       residual = 9.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910224443552       residual = 5.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910223605246       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.910224019276       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.910224740971       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.910224897428       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910225267032       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         19 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 1.346580e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910207031131       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910207697495       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910209877886       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910210987999       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910211112975       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910210884862       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910212417668       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910212906225       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910213907408       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910213794378       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910213570273       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910214282327       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.910214137339       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 3.450402e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910207031131       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910207375904       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910208455081       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910208754274       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910208818362       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910209080013       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910208921720       residual = 9.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910209257470       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910209172417       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910209184706       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 9.747467e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.028637 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6359e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.093937e-01 1 1  ON 0
 uu_1                 1.422985e-01 1 1  ON 1
 uu_2                 4.122386e-02 1 1  ON 2
 uu_3                -2.045478e-02 1 1  ON 3
 uu_4                -6.440733e-02 1 1  ON 4
 uu_5                -9.771617e-02 1 1  ON 5
 uu_6                -1.246445e-01 1 1  ON 6
 uu_7                -1.373000e-01 1 1  ON 7
 uu_8                -1.297229e-01 1 1  ON 8
 uu_9                -1.002913e-01 1 1  ON 9
 ud_0                 4.435754e-01 1 1  ON 10
 ud_1                 1.777966e-01 1 1  ON 11
 ud_2                 5.791343e-02 1 1  ON 12
 ud_3                -1.254827e-02 1 1  ON 13
 ud_4                -6.877330e-02 1 1  ON 14
 ud_5                -1.080232e-01 1 1  ON 15
 ud_6                -1.328652e-01 1 1  ON 16
 ud_7                -1.469648e-01 1 1  ON 17
 ud_8                -1.445843e-01 1 1  ON 18
 ud_9                -1.350800e-01 1 1  ON 19
 eO_0                -7.657926e-01 1 1  ON 20
 eO_1                -4.440883e-01 1 1  ON 21
 eO_2                -2.131377e-02 1 1  ON 22
 eO_3                 3.007174e-01 1 1  ON 23
 eO_4                 5.267091e-01 1 1  ON 24
 eO_5                 4.845461e-01 1 1  ON 25
 eO_6                 2.525334e-01 1 1  ON 26
 eO_7                -4.865737e-02 1 1  ON 27
 eO_8                -2.121027e-01 1 1  ON 28
 eO_9                -7.257537e-02 1 1  ON 29
eH1_0                -2.371881e-01 1 1  ON 30
eH1_1                -1.384611e-01 1 1  ON 31
eH1_2                -9.281605e-02 1 1  ON 32
eH1_3                -3.894407e-02 1 1  ON 33
eH1_4                 6.849035e-03 1 1  ON 34
eH1_5                 4.029060e-02 1 1  ON 35
eH1_6                 9.611383e-02 1 1  ON 36
eH1_7                 1.481705e-01 1 1  ON 37
eH1_8                 1.661564e-01 1 1  ON 38
eH1_9                 5.327571e-02 1 1  ON 39
eH2_0                -2.345794e-01 1 1  ON 40
eH2_1                -1.346498e-01 1 1  ON 41
eH2_2                -8.909560e-02 1 1  ON 42
eH2_3                -3.534452e-02 1 1  ON 43
eH2_4                 1.049170e-02 1 1  ON 44
eH2_5                 4.289963e-02 1 1  ON 45
eH2_6                 9.930730e-02 1 1  ON 46
eH2_7                 1.511878e-01 1 1  ON 47
eH2_8                 1.698532e-01 1 1  ON 48
eH2_9                 3.727418e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -16.9121
    reference variance = 0.288803
====================================================
  Execution time = 2.0519e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3934e-01
  Total weights = 2.0000e+06
  Execution time = 1.8931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338806993574
                                         uncertainty =       0.004146163479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338806993574
                                         uncertainty =       0.004146163479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411628349
  error estimate for blocks of size 2^( 2) =       0.000424956761
  error estimate for blocks of size 2^( 3) =       0.000439979690
  error estimate for blocks of size 2^( 4) =       0.000453907833
  error estimate for blocks of size 2^( 5) =       0.000469540256
  error estimate for blocks of size 2^( 6) =       0.000481218678
  error estimate for blocks of size 2^( 7) =       0.000488324628

      target function =                  N/A
              le_mean =     -16.911606668003
             les_mean =     286.341315719788
             stat err =       0.000473247849
             autocorr =       1.321803025109
              std dev =       0.582130394306
             le_variance =       0.338875795974

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339737861541
                                         uncertainty =       0.004147371607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339737861541
                                         uncertainty =       0.004147371607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412193654
  error estimate for blocks of size 2^( 2) =       0.000425499265
  error estimate for blocks of size 2^( 3) =       0.000440480918
  error estimate for blocks of size 2^( 4) =       0.000454355164
  error estimate for blocks of size 2^( 5) =       0.000469953877
  error estimate for blocks of size 2^( 6) =       0.000481587155
  error estimate for blocks of size 2^( 7) =       0.000488671471

      target function =                  N/A
              le_mean =     -16.911606064852
             les_mean =     286.342226740267
             stat err =       0.000473641917
             autocorr =       1.320376106653
              std dev =       0.582929856369
             le_variance =       0.339807217447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339751470536
                                         uncertainty =       0.004147357586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339751470536
                                         uncertainty =       0.004147357586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412201930
  error estimate for blocks of size 2^( 2) =       0.000425501339
  error estimate for blocks of size 2^( 3) =       0.000440482933
  error estimate for blocks of size 2^( 4) =       0.000454369837
  error estimate for blocks of size 2^( 5) =       0.000469983732
  error estimate for blocks of size 2^( 6) =       0.000481623461
  error estimate for blocks of size 2^( 7) =       0.000488711392

      target function =                  N/A
              le_mean =     -16.911605659443
             les_mean =     286.342226672154
             stat err =       0.000473672105
             autocorr =       1.320491404440
              std dev =       0.582941559298
             le_variance =       0.339820861557

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338988954711
                                         uncertainty =       0.004146278495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338988954711
                                         uncertainty =       0.004146278495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411738928
  error estimate for blocks of size 2^( 2) =       0.000425059559
  error estimate for blocks of size 2^( 3) =       0.000440073079
  error estimate for blocks of size 2^( 4) =       0.000453993861
  error estimate for blocks of size 2^( 5) =       0.000469624520
  error estimate for blocks of size 2^( 6) =       0.000481295481
  error estimate for blocks of size 2^( 7) =       0.000488398202

      target function =                  N/A
              le_mean =     -16.911605541402
             les_mean =     286.341459708360
             stat err =       0.000473328016
             autocorr =       1.321540759330
              std dev =       0.582286776347
             le_variance =       0.339057889908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911606668003        initial  <--
     1.5625e-02     1.5625e-01             1.3466e-02       -16.911606064852
     6.2500e-02     6.2500e-01             3.4504e-03       -16.911605659443
     2.5000e-01     2.5000e+00             9.7475e-04       -16.911605541402

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0554
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 3.084011e-01 1 1  ON 0
 uu_1                 1.416263e-01 1 1  ON 1
 uu_2                 4.090677e-02 1 1  ON 2
 uu_3                -2.031413e-02 1 1  ON 3
 uu_4                -6.360701e-02 1 1  ON 4
 uu_5                -9.670156e-02 1 1  ON 5
 uu_6                -1.233178e-01 1 1  ON 6
 uu_7                -1.363685e-01 1 1  ON 7
 uu_8                -1.282333e-01 1 1  ON 8
 uu_9                -9.946719e-02 1 1  ON 9
 ud_0                 4.435012e-01 1 1  ON 10
 ud_1                 1.777413e-01 1 1  ON 11
 ud_2                 5.799654e-02 1 1  ON 12
 ud_3                -1.250196e-02 1 1  ON 13
 ud_4                -6.881521e-02 1 1  ON 14
 ud_5                -1.080333e-01 1 1  ON 15
 ud_6                -1.329127e-01 1 1  ON 16
 ud_7                -1.469997e-01 1 1  ON 17
 ud_8                -1.457124e-01 1 1  ON 18
 ud_9                -1.352161e-01 1 1  ON 19
 eO_0                -7.634348e-01 1 1  ON 20
 eO_1                -4.422282e-01 1 1  ON 21
 eO_2                -2.051289e-02 1 1  ON 22
 eO_3                 3.008251e-01 1 1  ON 23
 eO_4                 5.250245e-01 1 1  ON 24
 eO_5                 4.810957e-01 1 1  ON 25
 eO_6                 2.499719e-01 1 1  ON 26
 eO_7                -4.947679e-02 1 1  ON 27
 eO_8                -2.103579e-01 1 1  ON 28
 eO_9                -7.122381e-02 1 1  ON 29
eH1_0                -2.362607e-01 1 1  ON 30
eH1_1                -1.371584e-01 1 1  ON 31
eH1_2                -9.157101e-02 1 1  ON 32
eH1_3                -3.822513e-02 1 1  ON 33
eH1_4                 7.512159e-03 1 1  ON 34
eH1_5                 4.099529e-02 1 1  ON 35
eH1_6                 9.636062e-02 1 1  ON 36
eH1_7                 1.470182e-01 1 1  ON 37
eH1_8                 1.638498e-01 1 1  ON 38
eH1_9                 5.089250e-02 1 1  ON 39
eH2_0                -2.332413e-01 1 1  ON 40
eH2_1                -1.341753e-01 1 1  ON 41
eH2_2                -8.867883e-02 1 1  ON 42
eH2_3                -3.499985e-02 1 1  ON 43
eH2_4                 1.126312e-02 1 1  ON 44
eH2_5                 4.343937e-02 1 1  ON 45
eH2_6                 9.996450e-02 1 1  ON 46
eH2_7                 1.512000e-01 1 1  ON 47
eH2_8                 1.689562e-01 1 1  ON 48
eH2_9                 3.395757e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6421e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9201
    reference variance = 0.197135
====================================================
  Execution time = 2.0630e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4047e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340533610595
                                         uncertainty =       0.003771432549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340533610595
                                         uncertainty =       0.003771432549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412592867
  error estimate for blocks of size 2^( 2) =       0.000426241242
  error estimate for blocks of size 2^( 3) =       0.000441485054
  error estimate for blocks of size 2^( 4) =       0.000456438057
  error estimate for blocks of size 2^( 5) =       0.000471477856
  error estimate for blocks of size 2^( 6) =       0.000486154614
  error estimate for blocks of size 2^( 7) =       0.000494862431

      target function =                  N/A
              le_mean =     -16.910770839104
             les_mean =     286.314635950415
             stat err =       0.000477233240
             autocorr =       1.337882393659
              std dev =       0.583494428389
             le_variance =       0.340465747962


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691077083910e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910770839104       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910772867170       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910773334986       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910773540563       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910774421576       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910773170496       residual = 4.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910775058732       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910775720965       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910775557456       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910775291780       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910775457048       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-01 is 1.367783e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910770839104       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910771624355       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910771939331       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910772213435       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910772122978       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910771779322       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910772146351       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910772396405       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910772328295       residual = 2.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 3.809501e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910770839104       residual = 3.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910771066632       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910771189968       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910771300087       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910771236376       residual = 3.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910771164663       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910771232602       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910771267720       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 1.061941e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.032033 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6195e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.083146e-01 1 1  ON 0
 uu_1                 1.416570e-01 1 1  ON 1
 uu_2                 4.085782e-02 1 1  ON 2
 uu_3                -2.033889e-02 1 1  ON 3
 uu_4                -6.374871e-02 1 1  ON 4
 uu_5                -9.682836e-02 1 1  ON 5
 uu_6                -1.231907e-01 1 1  ON 6
 uu_7                -1.364099e-01 1 1  ON 7
 uu_8                -1.283051e-01 1 1  ON 8
 uu_9                -9.943498e-02 1 1  ON 9
 ud_0                 4.435929e-01 1 1  ON 10
 ud_1                 1.777303e-01 1 1  ON 11
 ud_2                 5.797687e-02 1 1  ON 12
 ud_3                -1.250131e-02 1 1  ON 13
 ud_4                -6.876932e-02 1 1  ON 14
 ud_5                -1.080961e-01 1 1  ON 15
 ud_6                -1.329923e-01 1 1  ON 16
 ud_7                -1.470994e-01 1 1  ON 17
 ud_8                -1.457008e-01 1 1  ON 18
 ud_9                -1.351491e-01 1 1  ON 19
 eO_0                -7.638157e-01 1 1  ON 20
 eO_1                -4.424074e-01 1 1  ON 21
 eO_2                -2.062055e-02 1 1  ON 22
 eO_3                 3.009239e-01 1 1  ON 23
 eO_4                 5.251850e-01 1 1  ON 24
 eO_5                 4.814412e-01 1 1  ON 25
 eO_6                 2.502726e-01 1 1  ON 26
 eO_7                -4.933851e-02 1 1  ON 27
 eO_8                -2.105379e-01 1 1  ON 28
 eO_9                -7.139492e-02 1 1  ON 29
eH1_0                -2.364840e-01 1 1  ON 30
eH1_1                -1.371951e-01 1 1  ON 31
eH1_2                -9.175108e-02 1 1  ON 32
eH1_3                -3.836352e-02 1 1  ON 33
eH1_4                 7.452130e-03 1 1  ON 34
eH1_5                 4.086719e-02 1 1  ON 35
eH1_6                 9.640038e-02 1 1  ON 36
eH1_7                 1.471570e-01 1 1  ON 37
eH1_8                 1.641500e-01 1 1  ON 38
eH1_9                 5.116894e-02 1 1  ON 39
eH2_0                -2.333926e-01 1 1  ON 40
eH2_1                -1.342186e-01 1 1  ON 41
eH2_2                -8.861565e-02 1 1  ON 42
eH2_3                -3.510956e-02 1 1  ON 43
eH2_4                 1.111546e-02 1 1  ON 44
eH2_5                 4.332668e-02 1 1  ON 45
eH2_6                 9.984886e-02 1 1  ON 46
eH2_7                 1.511598e-01 1 1  ON 47
eH2_8                 1.692148e-01 1 1  ON 48
eH2_9                 3.430121e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -16.9365
    reference variance = 0.207099
====================================================
  Execution time = 2.0437e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3710e-01
  Total weights = 2.0000e+06
  Execution time = 1.8867e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336933805549
                                         uncertainty =       0.003678476068

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336933805549
                                         uncertainty =       0.003678476068

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410493369
  error estimate for blocks of size 2^( 2) =       0.000424226512
  error estimate for blocks of size 2^( 3) =       0.000439094583
  error estimate for blocks of size 2^( 4) =       0.000454033594
  error estimate for blocks of size 2^( 5) =       0.000468708848
  error estimate for blocks of size 2^( 6) =       0.000480002036
  error estimate for blocks of size 2^( 7) =       0.000487987819

      target function =                  N/A
              le_mean =     -16.911474019302
             les_mean =     286.334962949580
             stat err =       0.000472683074
             autocorr =       1.325952021767
              std dev =       0.580525290185
             le_variance =       0.337009612545

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337178979618
                                         uncertainty =       0.003682549308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337178979618
                                         uncertainty =       0.003682549308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410642496
  error estimate for blocks of size 2^( 2) =       0.000424373549
  error estimate for blocks of size 2^( 3) =       0.000439235987
  error estimate for blocks of size 2^( 4) =       0.000454170552
  error estimate for blocks of size 2^( 5) =       0.000468835470
  error estimate for blocks of size 2^( 6) =       0.000480114314
  error estimate for blocks of size 2^( 7) =       0.000488086456

      target function =                  N/A
              le_mean =     -16.911473010479
             les_mean =     286.335173734014
             stat err =       0.000472801698
             autocorr =       1.325654266397
              std dev =       0.580736186657
             le_variance =       0.337254518493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337124616999
                                         uncertainty =       0.003681202547

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337124616999
                                         uncertainty =       0.003681202547

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410609411
  error estimate for blocks of size 2^( 2) =       0.000424339553
  error estimate for blocks of size 2^( 3) =       0.000439202611
  error estimate for blocks of size 2^( 4) =       0.000454139051
  error estimate for blocks of size 2^( 5) =       0.000468807470
  error estimate for blocks of size 2^( 6) =       0.000480090874
  error estimate for blocks of size 2^( 7) =       0.000488067721

      target function =                  N/A
              le_mean =     -16.911473753883
             les_mean =     286.335144536295
             stat err =       0.000472776279
             autocorr =       1.325725343994
              std dev =       0.580689397706
             le_variance =       0.337200176608

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336968216532
                                         uncertainty =       0.003678932890

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336968216532
                                         uncertainty =       0.003678932890

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410514300
  error estimate for blocks of size 2^( 2) =       0.000424246663
  error estimate for blocks of size 2^( 3) =       0.000439113686
  error estimate for blocks of size 2^( 4) =       0.000454052148
  error estimate for blocks of size 2^( 5) =       0.000468726232
  error estimate for blocks of size 2^( 6) =       0.000480017950
  error estimate for blocks of size 2^( 7) =       0.000488002595

      target function =                  N/A
              le_mean =     -16.911473970620
             les_mean =     286.334995670837
             stat err =       0.000472699731
             autocorr =       1.325910261073
              std dev =       0.580554890079
             le_variance =       0.337043980394


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911474019302        initial  <--
     1.5625e-01     1.5625e+00             1.3678e-03       -16.911473010479
     6.2500e-01     6.2500e+00             3.8095e-04       -16.911473753883
     2.5000e+00     2.5000e+01             1.0619e-04       -16.911473970620

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.0049
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 3.084011e-01 1 1  ON 0
 uu_1                 1.416263e-01 1 1  ON 1
 uu_2                 4.090677e-02 1 1  ON 2
 uu_3                -2.031413e-02 1 1  ON 3
 uu_4                -6.360701e-02 1 1  ON 4
 uu_5                -9.670156e-02 1 1  ON 5
 uu_6                -1.233178e-01 1 1  ON 6
 uu_7                -1.363685e-01 1 1  ON 7
 uu_8                -1.282333e-01 1 1  ON 8
 uu_9                -9.946719e-02 1 1  ON 9
 ud_0                 4.435012e-01 1 1  ON 10
 ud_1                 1.777413e-01 1 1  ON 11
 ud_2                 5.799654e-02 1 1  ON 12
 ud_3                -1.250196e-02 1 1  ON 13
 ud_4                -6.881521e-02 1 1  ON 14
 ud_5                -1.080333e-01 1 1  ON 15
 ud_6                -1.329127e-01 1 1  ON 16
 ud_7                -1.469997e-01 1 1  ON 17
 ud_8                -1.457124e-01 1 1  ON 18
 ud_9                -1.352161e-01 1 1  ON 19
 eO_0                -7.634348e-01 1 1  ON 20
 eO_1                -4.422282e-01 1 1  ON 21
 eO_2                -2.051289e-02 1 1  ON 22
 eO_3                 3.008251e-01 1 1  ON 23
 eO_4                 5.250245e-01 1 1  ON 24
 eO_5                 4.810957e-01 1 1  ON 25
 eO_6                 2.499719e-01 1 1  ON 26
 eO_7                -4.947679e-02 1 1  ON 27
 eO_8                -2.103579e-01 1 1  ON 28
 eO_9                -7.122381e-02 1 1  ON 29
eH1_0                -2.362607e-01 1 1  ON 30
eH1_1                -1.371584e-01 1 1  ON 31
eH1_2                -9.157101e-02 1 1  ON 32
eH1_3                -3.822513e-02 1 1  ON 33
eH1_4                 7.512159e-03 1 1  ON 34
eH1_5                 4.099529e-02 1 1  ON 35
eH1_6                 9.636062e-02 1 1  ON 36
eH1_7                 1.470182e-01 1 1  ON 37
eH1_8                 1.638498e-01 1 1  ON 38
eH1_9                 5.089250e-02 1 1  ON 39
eH2_0                -2.332413e-01 1 1  ON 40
eH2_1                -1.341753e-01 1 1  ON 41
eH2_2                -8.867883e-02 1 1  ON 42
eH2_3                -3.499985e-02 1 1  ON 43
eH2_4                 1.126312e-02 1 1  ON 44
eH2_5                 4.343937e-02 1 1  ON 45
eH2_6                 9.996450e-02 1 1  ON 46
eH2_7                 1.512000e-01 1 1  ON 47
eH2_8                 1.689562e-01 1 1  ON 48
eH2_9                 3.395757e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6206e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6906e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8768
    reference variance = 0.222631
====================================================
  Execution time = 2.0887e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3010e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5070e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330144820997
                                         uncertainty =       0.002613943724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330144820997
                                         uncertainty =       0.002613943724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406260805
  error estimate for blocks of size 2^( 2) =       0.000419691399
  error estimate for blocks of size 2^( 3) =       0.000434291887
  error estimate for blocks of size 2^( 4) =       0.000449574163
  error estimate for blocks of size 2^( 5) =       0.000464498873
  error estimate for blocks of size 2^( 6) =       0.000477919526
  error estimate for blocks of size 2^( 7) =       0.000485333036

      target function =                  N/A
              le_mean =     -16.910518557180
             les_mean =     286.295733390548
             stat err =       0.000469331400
             autocorr =       1.334594629235
              std dev =       0.574539539853
             le_variance =       0.330095682855


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691051855718e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910518557180       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910518747008       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910518755825       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910518828691       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910518879154       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910518915379       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910518933281       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910518921496       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910518926973       residual = 1.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 1.824474e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910518557180       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910518608728       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910518611073       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910518628973       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910518633796       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910518640881       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910518645844       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910518643577       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 4.526916e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910518557180       residual = 7.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910518570351       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910518570958       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910518575415       residual = 7.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910518575875       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910518577717       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910518578811       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910518578328       residual = 6.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 1.133885e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034866 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6401e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.083795e-01 1 1  ON 0
 uu_1                 1.416453e-01 1 1  ON 1
 uu_2                 4.092528e-02 1 1  ON 2
 uu_3                -2.032078e-02 1 1  ON 3
 uu_4                -6.361633e-02 1 1  ON 4
 uu_5                -9.669574e-02 1 1  ON 5
 uu_6                -1.232956e-01 1 1  ON 6
 uu_7                -1.363577e-01 1 1  ON 7
 uu_8                -1.282610e-01 1 1  ON 8
 uu_9                -9.949317e-02 1 1  ON 9
 ud_0                 4.435194e-01 1 1  ON 10
 ud_1                 1.777464e-01 1 1  ON 11
 ud_2                 5.800037e-02 1 1  ON 12
 ud_3                -1.249086e-02 1 1  ON 13
 ud_4                -6.879786e-02 1 1  ON 14
 ud_5                -1.080295e-01 1 1  ON 15
 ud_6                -1.329039e-01 1 1  ON 16
 ud_7                -1.470021e-01 1 1  ON 17
 ud_8                -1.457469e-01 1 1  ON 18
 ud_9                -1.352389e-01 1 1  ON 19
 eO_0                -7.634633e-01 1 1  ON 20
 eO_1                -4.422372e-01 1 1  ON 21
 eO_2                -2.052819e-02 1 1  ON 22
 eO_3                 3.008318e-01 1 1  ON 23
 eO_4                 5.250390e-01 1 1  ON 24
 eO_5                 4.811410e-01 1 1  ON 25
 eO_6                 2.500101e-01 1 1  ON 26
 eO_7                -4.946430e-02 1 1  ON 27
 eO_8                -2.103914e-01 1 1  ON 28
 eO_9                -7.125084e-02 1 1  ON 29
eH1_0                -2.362681e-01 1 1  ON 30
eH1_1                -1.371732e-01 1 1  ON 31
eH1_2                -9.158985e-02 1 1  ON 32
eH1_3                -3.822851e-02 1 1  ON 33
eH1_4                 7.502079e-03 1 1  ON 34
eH1_5                 4.099619e-02 1 1  ON 35
eH1_6                 9.636815e-02 1 1  ON 36
eH1_7                 1.470340e-01 1 1  ON 37
eH1_8                 1.638639e-01 1 1  ON 38
eH1_9                 5.091278e-02 1 1  ON 39
eH2_0                -2.332471e-01 1 1  ON 40
eH2_1                -1.341870e-01 1 1  ON 41
eH2_2                -8.867422e-02 1 1  ON 42
eH2_3                -3.499744e-02 1 1  ON 43
eH2_4                 1.124712e-02 1 1  ON 44
eH2_5                 4.344035e-02 1 1  ON 45
eH2_6                 9.994666e-02 1 1  ON 46
eH2_7                 1.511940e-01 1 1  ON 47
eH2_8                 1.689788e-01 1 1  ON 48
eH2_9                 3.398635e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -16.8908
    reference variance = 0.763158
====================================================
  Execution time = 2.0897e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4079e-01
  Total weights = 2.0000e+06
  Execution time = 1.8976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340803902534
                                         uncertainty =       0.004847099819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340803902534
                                         uncertainty =       0.004847099819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412785523
  error estimate for blocks of size 2^( 2) =       0.000427159168
  error estimate for blocks of size 2^( 3) =       0.000442545221
  error estimate for blocks of size 2^( 4) =       0.000458126943
  error estimate for blocks of size 2^( 5) =       0.000473490653
  error estimate for blocks of size 2^( 6) =       0.000488211134
  error estimate for blocks of size 2^( 7) =       0.000498023081

      target function =                  N/A
              le_mean =     -16.910827036503
             les_mean =     286.316854663856
             stat err =       0.000479462953
             autocorr =       1.349152978415
              std dev =       0.583766884758
             le_variance =       0.340783775740

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340827474816
                                         uncertainty =       0.004847902520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340827474816
                                         uncertainty =       0.004847902520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412799790
  error estimate for blocks of size 2^( 2) =       0.000427171029
  error estimate for blocks of size 2^( 3) =       0.000442555469
  error estimate for blocks of size 2^( 4) =       0.000458136142
  error estimate for blocks of size 2^( 5) =       0.000473500788
  error estimate for blocks of size 2^( 6) =       0.000488220285
  error estimate for blocks of size 2^( 7) =       0.000498032117

      target function =                  N/A
              le_mean =     -16.910826686104
             les_mean =     286.316866369919
             stat err =       0.000479472333
             autocorr =       1.349112509056
              std dev =       0.583787061255
             le_variance =       0.340807332888

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340816010498
                                         uncertainty =       0.004847545518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340816010498
                                         uncertainty =       0.004847545518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412792851
  error estimate for blocks of size 2^( 2) =       0.000427165156
  error estimate for blocks of size 2^( 3) =       0.000442550352
  error estimate for blocks of size 2^( 4) =       0.000458131526
  error estimate for blocks of size 2^( 5) =       0.000473495762
  error estimate for blocks of size 2^( 6) =       0.000488215790
  error estimate for blocks of size 2^( 7) =       0.000498027730

      target function =                  N/A
              le_mean =     -16.910826800814
             les_mean =     286.316858792897
             stat err =       0.000479467702
             autocorr =       1.349131801465
              std dev =       0.583777248749
             le_variance =       0.340795876157

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340805507712
                                         uncertainty =       0.004847156787

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340805507712
                                         uncertainty =       0.004847156787

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412786494
  error estimate for blocks of size 2^( 2) =       0.000427159964
  error estimate for blocks of size 2^( 3) =       0.000442545906
  error estimate for blocks of size 2^( 4) =       0.000458127554
  error estimate for blocks of size 2^( 5) =       0.000473491330
  error estimate for blocks of size 2^( 6) =       0.000488211751
  error estimate for blocks of size 2^( 7) =       0.000498023694

      target function =                  N/A
              le_mean =     -16.910827003923
             les_mean =     286.316855166143
             stat err =       0.000479463582
             autocorr =       1.349150171784
              std dev =       0.583768258750
             le_variance =       0.340785379924


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910827036503        initial  <--
     1.5625e+00     1.5625e+01             1.8245e-04       -16.910826686104
     6.2500e+00     6.2500e+01             4.5269e-05       -16.910826800814
     2.5000e+01     2.5000e+02             1.1339e-05       -16.910827003923

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.5135
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 3.084011e-01 1 1  ON 0
 uu_1                 1.416263e-01 1 1  ON 1
 uu_2                 4.090677e-02 1 1  ON 2
 uu_3                -2.031413e-02 1 1  ON 3
 uu_4                -6.360701e-02 1 1  ON 4
 uu_5                -9.670156e-02 1 1  ON 5
 uu_6                -1.233178e-01 1 1  ON 6
 uu_7                -1.363685e-01 1 1  ON 7
 uu_8                -1.282333e-01 1 1  ON 8
 uu_9                -9.946719e-02 1 1  ON 9
 ud_0                 4.435012e-01 1 1  ON 10
 ud_1                 1.777413e-01 1 1  ON 11
 ud_2                 5.799654e-02 1 1  ON 12
 ud_3                -1.250196e-02 1 1  ON 13
 ud_4                -6.881521e-02 1 1  ON 14
 ud_5                -1.080333e-01 1 1  ON 15
 ud_6                -1.329127e-01 1 1  ON 16
 ud_7                -1.469997e-01 1 1  ON 17
 ud_8                -1.457124e-01 1 1  ON 18
 ud_9                -1.352161e-01 1 1  ON 19
 eO_0                -7.634348e-01 1 1  ON 20
 eO_1                -4.422282e-01 1 1  ON 21
 eO_2                -2.051289e-02 1 1  ON 22
 eO_3                 3.008251e-01 1 1  ON 23
 eO_4                 5.250245e-01 1 1  ON 24
 eO_5                 4.810957e-01 1 1  ON 25
 eO_6                 2.499719e-01 1 1  ON 26
 eO_7                -4.947679e-02 1 1  ON 27
 eO_8                -2.103579e-01 1 1  ON 28
 eO_9                -7.122381e-02 1 1  ON 29
eH1_0                -2.362607e-01 1 1  ON 30
eH1_1                -1.371584e-01 1 1  ON 31
eH1_2                -9.157101e-02 1 1  ON 32
eH1_3                -3.822513e-02 1 1  ON 33
eH1_4                 7.512159e-03 1 1  ON 34
eH1_5                 4.099529e-02 1 1  ON 35
eH1_6                 9.636062e-02 1 1  ON 36
eH1_7                 1.470182e-01 1 1  ON 37
eH1_8                 1.638498e-01 1 1  ON 38
eH1_9                 5.089250e-02 1 1  ON 39
eH2_0                -2.332413e-01 1 1  ON 40
eH2_1                -1.341753e-01 1 1  ON 41
eH2_2                -8.867883e-02 1 1  ON 42
eH2_3                -3.499985e-02 1 1  ON 43
eH2_4                 1.126312e-02 1 1  ON 44
eH2_5                 4.343937e-02 1 1  ON 45
eH2_6                 9.996450e-02 1 1  ON 46
eH2_7                 1.512000e-01 1 1  ON 47
eH2_8                 1.689562e-01 1 1  ON 48
eH2_9                 3.395757e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6920e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6903e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.9092
    reference variance = 0.234133
====================================================
  Execution time = 2.0792e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3906e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339059659698
                                         uncertainty =       0.003509504458

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339059659698
                                         uncertainty =       0.003509504458

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411741119
  error estimate for blocks of size 2^( 2) =       0.000425338055
  error estimate for blocks of size 2^( 3) =       0.000440484799
  error estimate for blocks of size 2^( 4) =       0.000455024940
  error estimate for blocks of size 2^( 5) =       0.000469641804
  error estimate for blocks of size 2^( 6) =       0.000481861197
  error estimate for blocks of size 2^( 7) =       0.000490713333

      target function =                  N/A
              le_mean =     -16.910560454087
             les_mean =     286.306116199334
             stat err =       0.000474310319
             autocorr =       1.327017546737
              std dev =       0.582289874134
             le_variance =       0.339061497519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691056045409e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910560454087       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910560584270       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910560603331       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910560575892       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910560585705       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910560574216       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910560592101       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910560591722       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.534398e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910560454087       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910560486971       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910560491855       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910560485072       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910560487510       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910560484448       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910560488948       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910560488969       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 3.839141e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910560454087       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910560462330       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910560463558       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910560461868       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910560462476       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910560461699       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910560462826       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910560462838       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 9.599816e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037530 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6315e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.084007e-01 1 1  ON 0
 uu_1                 1.416293e-01 1 1  ON 1
 uu_2                 4.090850e-02 1 1  ON 2
 uu_3                -2.031374e-02 1 1  ON 3
 uu_4                -6.360646e-02 1 1  ON 4
 uu_5                -9.670500e-02 1 1  ON 5
 uu_6                -1.233199e-01 1 1  ON 6
 uu_7                -1.363689e-01 1 1  ON 7
 uu_8                -1.282351e-01 1 1  ON 8
 uu_9                -9.946786e-02 1 1  ON 9
 ud_0                 4.435014e-01 1 1  ON 10
 ud_1                 1.777409e-01 1 1  ON 11
 ud_2                 5.799657e-02 1 1  ON 12
 ud_3                -1.250251e-02 1 1  ON 13
 ud_4                -6.881354e-02 1 1  ON 14
 ud_5                -1.080329e-01 1 1  ON 15
 ud_6                -1.329095e-01 1 1  ON 16
 ud_7                -1.470006e-01 1 1  ON 17
 ud_8                -1.457146e-01 1 1  ON 18
 ud_9                -1.352163e-01 1 1  ON 19
 eO_0                -7.634381e-01 1 1  ON 20
 eO_1                -4.422297e-01 1 1  ON 21
 eO_2                -2.051258e-02 1 1  ON 22
 eO_3                 3.008250e-01 1 1  ON 23
 eO_4                 5.250273e-01 1 1  ON 24
 eO_5                 4.810984e-01 1 1  ON 25
 eO_6                 2.499743e-01 1 1  ON 26
 eO_7                -4.947538e-02 1 1  ON 27
 eO_8                -2.103601e-01 1 1  ON 28
 eO_9                -7.122571e-02 1 1  ON 29
eH1_0                -2.362613e-01 1 1  ON 30
eH1_1                -1.371591e-01 1 1  ON 31
eH1_2                -9.157279e-02 1 1  ON 32
eH1_3                -3.822613e-02 1 1  ON 33
eH1_4                 7.512060e-03 1 1  ON 34
eH1_5                 4.099199e-02 1 1  ON 35
eH1_6                 9.635953e-02 1 1  ON 36
eH1_7                 1.470199e-01 1 1  ON 37
eH1_8                 1.638536e-01 1 1  ON 38
eH1_9                 5.089547e-02 1 1  ON 39
eH2_0                -2.332443e-01 1 1  ON 40
eH2_1                -1.341766e-01 1 1  ON 41
eH2_2                -8.867956e-02 1 1  ON 42
eH2_3                -3.499956e-02 1 1  ON 43
eH2_4                 1.126173e-02 1 1  ON 44
eH2_5                 4.344188e-02 1 1  ON 45
eH2_6                 9.996387e-02 1 1  ON 46
eH2_7                 1.511997e-01 1 1  ON 47
eH2_8                 1.689585e-01 1 1  ON 48
eH2_9                 3.396023e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -16.8846
    reference variance = 0.403713
====================================================
  Execution time = 2.2610e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4772e-01
  Total weights = 2.0000e+06
  Execution time = 1.8916e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347762770752
                                         uncertainty =       0.011645710192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347762770752
                                         uncertainty =       0.011645710192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416964771
  error estimate for blocks of size 2^( 2) =       0.000430073199
  error estimate for blocks of size 2^( 3) =       0.000444123895
  error estimate for blocks of size 2^( 4) =       0.000458879841
  error estimate for blocks of size 2^( 5) =       0.000473299689
  error estimate for blocks of size 2^( 6) =       0.000485705602
  error estimate for blocks of size 2^( 7) =       0.000494617540

      target function =                  N/A
              le_mean =     -16.910320973842
             les_mean =     286.306674504208
             stat err =       0.000478125668
             autocorr =       1.314877799338
              std dev =       0.589677233505
             le_variance =       0.347719239714

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347763864835
                                         uncertainty =       0.011645582289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347763864835
                                         uncertainty =       0.011645582289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416965428
  error estimate for blocks of size 2^( 2) =       0.000430073707
  error estimate for blocks of size 2^( 3) =       0.000444124242
  error estimate for blocks of size 2^( 4) =       0.000458880055
  error estimate for blocks of size 2^( 5) =       0.000473299776
  error estimate for blocks of size 2^( 6) =       0.000485705580
  error estimate for blocks of size 2^( 7) =       0.000494617433

      target function =                  N/A
              le_mean =     -16.910320999552
             les_mean =     286.306676470671
             stat err =       0.000478125711
             autocorr =       1.314873887400
              std dev =       0.589678163622
             le_variance =       0.347720336652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347763325077
                                         uncertainty =       0.011645646405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347763325077
                                         uncertainty =       0.011645646405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416965104
  error estimate for blocks of size 2^( 2) =       0.000430073456
  error estimate for blocks of size 2^( 3) =       0.000444124071
  error estimate for blocks of size 2^( 4) =       0.000458879950
  error estimate for blocks of size 2^( 5) =       0.000473299734
  error estimate for blocks of size 2^( 6) =       0.000485705591
  error estimate for blocks of size 2^( 7) =       0.000494617486

      target function =                  N/A
              le_mean =     -16.910320986228
             les_mean =     286.306675478880
             stat err =       0.000478125690
             autocorr =       1.314875821134
              std dev =       0.589677704749
             le_variance =       0.347719795478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347762840185
                                         uncertainty =       0.011645702223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347762840185
                                         uncertainty =       0.011645702223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416964812
  error estimate for blocks of size 2^( 2) =       0.000430073231
  error estimate for blocks of size 2^( 3) =       0.000444123917
  error estimate for blocks of size 2^( 4) =       0.000458879855
  error estimate for blocks of size 2^( 5) =       0.000473299695
  error estimate for blocks of size 2^( 6) =       0.000485705600
  error estimate for blocks of size 2^( 7) =       0.000494617533

      target function =                  N/A
              le_mean =     -16.910320975365
             les_mean =     286.306674625327
             stat err =       0.000478125671
             autocorr =       1.314877551375
              std dev =       0.589677292531
             le_variance =       0.347719309327


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910320973842        initial
     1.5625e+01     1.5625e+02             1.5344e-05       -16.910320999552  <--
     6.2500e+01     6.2500e+02             3.8391e-06       -16.910320986228
     2.5000e+02     2.5000e+03             9.5998e-07       -16.910320975365

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 3.2131e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 3.083996e-01 1 1  ON 0
 uu_1                 1.416384e-01 1 1  ON 1
 uu_2                 4.091360e-02 1 1  ON 2
 uu_3                -2.031254e-02 1 1  ON 3
 uu_4                -6.360492e-02 1 1  ON 4
 uu_5                -9.671516e-02 1 1  ON 5
 uu_6                -1.233262e-01 1 1  ON 6
 uu_7                -1.363702e-01 1 1  ON 7
 uu_8                -1.282404e-01 1 1  ON 8
 uu_9                -9.946988e-02 1 1  ON 9
 ud_0                 4.435021e-01 1 1  ON 10
 ud_1                 1.777400e-01 1 1  ON 11
 ud_2                 5.799665e-02 1 1  ON 12
 ud_3                -1.250409e-02 1 1  ON 13
 ud_4                -6.880863e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.329000e-01 1 1  ON 16
 ud_7                -1.470031e-01 1 1  ON 17
 ud_8                -1.457212e-01 1 1  ON 18
 ud_9                -1.352171e-01 1 1  ON 19
 eO_0                -7.634481e-01 1 1  ON 20
 eO_1                -4.422343e-01 1 1  ON 21
 eO_2                -2.051171e-02 1 1  ON 22
 eO_3                 3.008245e-01 1 1  ON 23
 eO_4                 5.250355e-01 1 1  ON 24
 eO_5                 4.811065e-01 1 1  ON 25
 eO_6                 2.499815e-01 1 1  ON 26
 eO_7                -4.947118e-02 1 1  ON 27
 eO_8                -2.103668e-01 1 1  ON 28
 eO_9                -7.123141e-02 1 1  ON 29
eH1_0                -2.362632e-01 1 1  ON 30
eH1_1                -1.371612e-01 1 1  ON 31
eH1_2                -9.157808e-02 1 1  ON 32
eH1_3                -3.822915e-02 1 1  ON 33
eH1_4                 7.511746e-03 1 1  ON 34
eH1_5                 4.098210e-02 1 1  ON 35
eH1_6                 9.635624e-02 1 1  ON 36
eH1_7                 1.470252e-01 1 1  ON 37
eH1_8                 1.638651e-01 1 1  ON 38
eH1_9                 5.090440e-02 1 1  ON 39
eH2_0                -2.332534e-01 1 1  ON 40
eH2_1                -1.341804e-01 1 1  ON 41
eH2_2                -8.868173e-02 1 1  ON 42
eH2_3                -3.499872e-02 1 1  ON 43
eH2_4                 1.125762e-02 1 1  ON 44
eH2_5                 4.344938e-02 1 1  ON 45
eH2_6                 9.996200e-02 1 1  ON 46
eH2_7                 1.511985e-01 1 1  ON 47
eH2_8                 1.689651e-01 1 1  ON 48
eH2_9                 3.396820e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8452e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6902e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.9208
    reference variance = 0.371458
====================================================
  Execution time = 2.1221e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3613e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5291e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336111500431
                                         uncertainty =       0.003702170300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336111500431
                                         uncertainty =       0.003702170300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409957367
  error estimate for blocks of size 2^( 2) =       0.000423546691
  error estimate for blocks of size 2^( 3) =       0.000438054452
  error estimate for blocks of size 2^( 4) =       0.000453106617
  error estimate for blocks of size 2^( 5) =       0.000466899535
  error estimate for blocks of size 2^( 6) =       0.000479671875
  error estimate for blocks of size 2^( 7) =       0.000487834186

      target function =                  N/A
              le_mean =     -16.911803544887
             les_mean =     286.345229058895
             stat err =       0.000471878053
             autocorr =       1.324897154390
              std dev =       0.579767268907
             le_variance =       0.336130086095


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691180354489e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911803544887       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911803740354       residual = 4.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911803822892       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911803831581       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911803606557       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911803505743       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911803693572       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911803679968       residual = 8.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 6.198903e-05

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911803544887       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911803595137       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911803619438       residual = 3.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911803623468       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911803563471       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911803535942       residual = 8.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911803580801       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911803576261       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 1.620289e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911803544887       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911803557539       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911803563866       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911803565001       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911803549777       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911803542732       residual = 7.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911803553775       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911803552567       residual = 5.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 4.098617e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040191 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6756e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.083960e-01 1 1  ON 0
 uu_1                 1.416473e-01 1 1  ON 1
 uu_2                 4.091721e-02 1 1  ON 2
 uu_3                -2.030998e-02 1 1  ON 3
 uu_4                -6.360618e-02 1 1  ON 4
 uu_5                -9.671463e-02 1 1  ON 5
 uu_6                -1.233145e-01 1 1  ON 6
 uu_7                -1.363711e-01 1 1  ON 7
 uu_8                -1.282548e-01 1 1  ON 8
 uu_9                -9.948160e-02 1 1  ON 9
 ud_0                 4.435047e-01 1 1  ON 10
 ud_1                 1.777449e-01 1 1  ON 11
 ud_2                 5.799897e-02 1 1  ON 12
 ud_3                -1.250241e-02 1 1  ON 13
 ud_4                -6.879619e-02 1 1  ON 14
 ud_5                -1.080402e-01 1 1  ON 15
 ud_6                -1.328984e-01 1 1  ON 16
 ud_7                -1.469964e-01 1 1  ON 17
 ud_8                -1.457324e-01 1 1  ON 18
 ud_9                -1.352275e-01 1 1  ON 19
 eO_0                -7.634643e-01 1 1  ON 20
 eO_1                -4.422320e-01 1 1  ON 21
 eO_2                -2.050809e-02 1 1  ON 22
 eO_3                 3.008221e-01 1 1  ON 23
 eO_4                 5.250438e-01 1 1  ON 24
 eO_5                 4.811177e-01 1 1  ON 25
 eO_6                 2.499950e-01 1 1  ON 26
 eO_7                -4.946605e-02 1 1  ON 27
 eO_8                -2.103798e-01 1 1  ON 28
 eO_9                -7.124206e-02 1 1  ON 29
eH1_0                -2.362707e-01 1 1  ON 30
eH1_1                -1.371619e-01 1 1  ON 31
eH1_2                -9.158223e-02 1 1  ON 32
eH1_3                -3.822789e-02 1 1  ON 33
eH1_4                 7.513196e-03 1 1  ON 34
eH1_5                 4.097591e-02 1 1  ON 35
eH1_6                 9.634962e-02 1 1  ON 36
eH1_7                 1.470264e-01 1 1  ON 37
eH1_8                 1.638738e-01 1 1  ON 38
eH1_9                 5.091686e-02 1 1  ON 39
eH2_0                -2.332585e-01 1 1  ON 40
eH2_1                -1.341844e-01 1 1  ON 41
eH2_2                -8.867853e-02 1 1  ON 42
eH2_3                -3.499798e-02 1 1  ON 43
eH2_4                 1.125648e-02 1 1  ON 44
eH2_5                 4.345259e-02 1 1  ON 45
eH2_6                 9.995695e-02 1 1  ON 46
eH2_7                 1.511974e-01 1 1  ON 47
eH2_8                 1.689677e-01 1 1  ON 48
eH2_9                 3.397656e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -16.8623
    reference variance = 0.359655
====================================================
  Execution time = 2.0269e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3403e-01
  Total weights = 2.0000e+06
  Execution time = 1.8902e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333961578133
                                         uncertainty =       0.002554247879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333961578133
                                         uncertainty =       0.002554247879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408676477
  error estimate for blocks of size 2^( 2) =       0.000422112289
  error estimate for blocks of size 2^( 3) =       0.000437049497
  error estimate for blocks of size 2^( 4) =       0.000452216795
  error estimate for blocks of size 2^( 5) =       0.000467387991
  error estimate for blocks of size 2^( 6) =       0.000479469140
  error estimate for blocks of size 2^( 7) =       0.000484808424

      target function =                  N/A
              le_mean =     -16.910118550368
             les_mean =     286.286142146141
             stat err =       0.000470970587
             autocorr =       1.328092395776
              std dev =       0.577955816353
             le_variance =       0.334032925656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333958032972
                                         uncertainty =       0.002554280803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333958032972
                                         uncertainty =       0.002554280803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408674303
  error estimate for blocks of size 2^( 2) =       0.000422109321
  error estimate for blocks of size 2^( 3) =       0.000437045605
  error estimate for blocks of size 2^( 4) =       0.000452212368
  error estimate for blocks of size 2^( 5) =       0.000467383279
  error estimate for blocks of size 2^( 6) =       0.000479464633
  error estimate for blocks of size 2^( 7) =       0.000484804153

      target function =                  N/A
              le_mean =     -16.910118435958
             les_mean =     286.286134723639
             stat err =       0.000470966108
             autocorr =       1.328081260778
              std dev =       0.577952742469
             le_variance =       0.334029372527

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333959261059
                                         uncertainty =       0.002554261469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333959261059
                                         uncertainty =       0.002554261469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408675057
  error estimate for blocks of size 2^( 2) =       0.000422110470
  error estimate for blocks of size 2^( 3) =       0.000437047210
  error estimate for blocks of size 2^( 4) =       0.000452214242
  error estimate for blocks of size 2^( 5) =       0.000467385288
  error estimate for blocks of size 2^( 6) =       0.000479466527
  error estimate for blocks of size 2^( 7) =       0.000484805961

      target function =                  N/A
              le_mean =     -16.910118484390
             les_mean =     286.286137593096
             stat err =       0.000470968004
             autocorr =       1.328087058500
              std dev =       0.577953807856
             le_variance =       0.334030604016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333961266222
                                         uncertainty =       0.002554249466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333961266222
                                         uncertainty =       0.002554249466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408676286
  error estimate for blocks of size 2^( 2) =       0.000422112048
  error estimate for blocks of size 2^( 3) =       0.000437049197
  error estimate for blocks of size 2^( 4) =       0.000452216462
  error estimate for blocks of size 2^( 5) =       0.000467387639
  error estimate for blocks of size 2^( 6) =       0.000479468799
  error estimate for blocks of size 2^( 7) =       0.000484808103

      target function =                  N/A
              le_mean =     -16.910118541570
             les_mean =     286.286141536102
             stat err =       0.000470970251
             autocorr =       1.328091739167
              std dev =       0.577955546003
             le_variance =       0.334032613155


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910118550368        initial  <--
     3.9062e+00     3.9062e+01             6.1989e-05       -16.910118435958
     1.5625e+01     1.5625e+02             1.6203e-05       -16.910118484390
     6.2500e+01     6.2500e+02             4.0986e-06       -16.910118541570

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7887
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 3.083996e-01 1 1  ON 0
 uu_1                 1.416384e-01 1 1  ON 1
 uu_2                 4.091360e-02 1 1  ON 2
 uu_3                -2.031254e-02 1 1  ON 3
 uu_4                -6.360492e-02 1 1  ON 4
 uu_5                -9.671516e-02 1 1  ON 5
 uu_6                -1.233262e-01 1 1  ON 6
 uu_7                -1.363702e-01 1 1  ON 7
 uu_8                -1.282404e-01 1 1  ON 8
 uu_9                -9.946988e-02 1 1  ON 9
 ud_0                 4.435021e-01 1 1  ON 10
 ud_1                 1.777400e-01 1 1  ON 11
 ud_2                 5.799665e-02 1 1  ON 12
 ud_3                -1.250409e-02 1 1  ON 13
 ud_4                -6.880863e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.329000e-01 1 1  ON 16
 ud_7                -1.470031e-01 1 1  ON 17
 ud_8                -1.457212e-01 1 1  ON 18
 ud_9                -1.352171e-01 1 1  ON 19
 eO_0                -7.634481e-01 1 1  ON 20
 eO_1                -4.422343e-01 1 1  ON 21
 eO_2                -2.051171e-02 1 1  ON 22
 eO_3                 3.008245e-01 1 1  ON 23
 eO_4                 5.250355e-01 1 1  ON 24
 eO_5                 4.811065e-01 1 1  ON 25
 eO_6                 2.499815e-01 1 1  ON 26
 eO_7                -4.947118e-02 1 1  ON 27
 eO_8                -2.103668e-01 1 1  ON 28
 eO_9                -7.123141e-02 1 1  ON 29
eH1_0                -2.362632e-01 1 1  ON 30
eH1_1                -1.371612e-01 1 1  ON 31
eH1_2                -9.157808e-02 1 1  ON 32
eH1_3                -3.822915e-02 1 1  ON 33
eH1_4                 7.511746e-03 1 1  ON 34
eH1_5                 4.098210e-02 1 1  ON 35
eH1_6                 9.635624e-02 1 1  ON 36
eH1_7                 1.470252e-01 1 1  ON 37
eH1_8                 1.638651e-01 1 1  ON 38
eH1_9                 5.090440e-02 1 1  ON 39
eH2_0                -2.332534e-01 1 1  ON 40
eH2_1                -1.341804e-01 1 1  ON 41
eH2_2                -8.868173e-02 1 1  ON 42
eH2_3                -3.499872e-02 1 1  ON 43
eH2_4                 1.125762e-02 1 1  ON 44
eH2_5                 4.344938e-02 1 1  ON 45
eH2_6                 9.996200e-02 1 1  ON 46
eH2_7                 1.511985e-01 1 1  ON 47
eH2_8                 1.689651e-01 1 1  ON 48
eH2_9                 3.396820e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6901e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9516
    reference variance = 0.228676
====================================================
  Execution time = 2.1069e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4119e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5146e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341110334474
                                         uncertainty =       0.008155482891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341110334474
                                         uncertainty =       0.008155482891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413034115
  error estimate for blocks of size 2^( 2) =       0.000426925504
  error estimate for blocks of size 2^( 3) =       0.000442355331
  error estimate for blocks of size 2^( 4) =       0.000457382935
  error estimate for blocks of size 2^( 5) =       0.000472671297
  error estimate for blocks of size 2^( 6) =       0.000486380747
  error estimate for blocks of size 2^( 7) =       0.000497160486

      target function =                  N/A
              le_mean =     -16.911634265959
             les_mean =     286.344567734862
             stat err =       0.000478398866
             autocorr =       1.341554856085
              std dev =       0.584118446812
             le_variance =       0.341194359907


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691163426596e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911634265959       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911634260469       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911634269801       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911634266352       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911634277009       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911634292341       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911634287333       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911634288245       residual = 7.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 6.855611e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911634265959       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911634264584       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911634266921       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911634266050       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911634268730       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911634272588       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911634271333       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911634271553       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.714170e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911634265959       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911634265615       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911634266199       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911634265981       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911634266652       residual = 6.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911634267618       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911634267304       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911634267360       residual = 6.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 4.285593e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.042842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6590e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.083993e-01 1 1  ON 0
 uu_1                 1.416386e-01 1 1  ON 1
 uu_2                 4.091417e-02 1 1  ON 2
 uu_3                -2.031200e-02 1 1  ON 3
 uu_4                -6.360600e-02 1 1  ON 4
 uu_5                -9.671526e-02 1 1  ON 5
 uu_6                -1.233263e-01 1 1  ON 6
 uu_7                -1.363701e-01 1 1  ON 7
 uu_8                -1.282408e-01 1 1  ON 8
 uu_9                -9.947035e-02 1 1  ON 9
 ud_0                 4.435015e-01 1 1  ON 10
 ud_1                 1.777403e-01 1 1  ON 11
 ud_2                 5.799642e-02 1 1  ON 12
 ud_3                -1.250377e-02 1 1  ON 13
 ud_4                -6.880775e-02 1 1  ON 14
 ud_5                -1.080311e-01 1 1  ON 15
 ud_6                -1.328994e-01 1 1  ON 16
 ud_7                -1.470032e-01 1 1  ON 17
 ud_8                -1.457220e-01 1 1  ON 18
 ud_9                -1.352178e-01 1 1  ON 19
 eO_0                -7.634492e-01 1 1  ON 20
 eO_1                -4.422342e-01 1 1  ON 21
 eO_2                -2.051236e-02 1 1  ON 22
 eO_3                 3.008234e-01 1 1  ON 23
 eO_4                 5.250367e-01 1 1  ON 24
 eO_5                 4.811082e-01 1 1  ON 25
 eO_6                 2.499830e-01 1 1  ON 26
 eO_7                -4.947080e-02 1 1  ON 27
 eO_8                -2.103678e-01 1 1  ON 28
 eO_9                -7.123225e-02 1 1  ON 29
eH1_0                -2.362640e-01 1 1  ON 30
eH1_1                -1.371619e-01 1 1  ON 31
eH1_2                -9.157857e-02 1 1  ON 32
eH1_3                -3.822959e-02 1 1  ON 33
eH1_4                 7.511674e-03 1 1  ON 34
eH1_5                 4.098175e-02 1 1  ON 35
eH1_6                 9.635639e-02 1 1  ON 36
eH1_7                 1.470259e-01 1 1  ON 37
eH1_8                 1.638660e-01 1 1  ON 38
eH1_9                 5.090548e-02 1 1  ON 39
eH2_0                -2.332543e-01 1 1  ON 40
eH2_1                -1.341810e-01 1 1  ON 41
eH2_2                -8.868254e-02 1 1  ON 42
eH2_3                -3.499815e-02 1 1  ON 43
eH2_4                 1.125617e-02 1 1  ON 44
eH2_5                 4.344990e-02 1 1  ON 45
eH2_6                 9.996187e-02 1 1  ON 46
eH2_7                 1.511989e-01 1 1  ON 47
eH2_8                 1.689661e-01 1 1  ON 48
eH2_9                 3.396947e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -16.9371
    reference variance = 0.43564
====================================================
  Execution time = 2.0527e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4049e-01
  Total weights = 2.0000e+06
  Execution time = 1.8956e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340487408244
                                         uncertainty =       0.003357653367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340487408244
                                         uncertainty =       0.003357653367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412607162
  error estimate for blocks of size 2^( 2) =       0.000425951497
  error estimate for blocks of size 2^( 3) =       0.000440786289
  error estimate for blocks of size 2^( 4) =       0.000454908310
  error estimate for blocks of size 2^( 5) =       0.000468983815
  error estimate for blocks of size 2^( 6) =       0.000481841702
  error estimate for blocks of size 2^( 7) =       0.000489542769

      target function =                  N/A
              le_mean =     -16.911985878626
             les_mean =     286.355755529320
             stat err =       0.000473819149
             autocorr =       1.318717264386
              std dev =       0.583514644813
             le_variance =       0.340489340712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340484863701
                                         uncertainty =       0.003357637703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340484863701
                                         uncertainty =       0.003357637703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412605622
  error estimate for blocks of size 2^( 2) =       0.000425949971
  error estimate for blocks of size 2^( 3) =       0.000440784723
  error estimate for blocks of size 2^( 4) =       0.000454906686
  error estimate for blocks of size 2^( 5) =       0.000468982267
  error estimate for blocks of size 2^( 6) =       0.000481840090
  error estimate for blocks of size 2^( 7) =       0.000489541215

      target function =                  N/A
              le_mean =     -16.911985927769
             les_mean =     286.355754648781
             stat err =       0.000473817565
             autocorr =       1.318718293976
              std dev =       0.583512465996
             le_variance =       0.340486797972

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340486127403
                                         uncertainty =       0.003357645469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340486127403
                                         uncertainty =       0.003357645469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412606387
  error estimate for blocks of size 2^( 2) =       0.000425950729
  error estimate for blocks of size 2^( 3) =       0.000440785501
  error estimate for blocks of size 2^( 4) =       0.000454907493
  error estimate for blocks of size 2^( 5) =       0.000468983036
  error estimate for blocks of size 2^( 6) =       0.000481840891
  error estimate for blocks of size 2^( 7) =       0.000489541987

      target function =                  N/A
              le_mean =     -16.911985903312
             les_mean =     286.355755084352
             stat err =       0.000473818352
             autocorr =       1.318717782791
              std dev =       0.583513548065
             le_variance =       0.340488060776

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340487247847
                                         uncertainty =       0.003357652377

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340487247847
                                         uncertainty =       0.003357652377

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412607065
  error estimate for blocks of size 2^( 2) =       0.000425951401
  error estimate for blocks of size 2^( 3) =       0.000440786191
  error estimate for blocks of size 2^( 4) =       0.000454908207
  error estimate for blocks of size 2^( 5) =       0.000468983717
  error estimate for blocks of size 2^( 6) =       0.000481841601
  error estimate for blocks of size 2^( 7) =       0.000489542671

      target function =                  N/A
              le_mean =     -16.911985881712
             les_mean =     286.355755473421
             stat err =       0.000473819049
             autocorr =       1.318717329301
              std dev =       0.583514507470
             le_variance =       0.340489180427


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911985878626        initial
     3.9062e+01     3.9062e+02             6.8556e-06       -16.911985927769  <--
     1.5625e+02     1.5625e+03             1.7142e-06       -16.911985903312
     6.2500e+02     6.2500e+03             4.2856e-07       -16.911985881712

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 3.0064e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 3.083983e-01 1 1  ON 0
 uu_1                 1.416393e-01 1 1  ON 1
 uu_2                 4.091586e-02 1 1  ON 2
 uu_3                -2.031041e-02 1 1  ON 3
 uu_4                -6.360921e-02 1 1  ON 4
 uu_5                -9.671556e-02 1 1  ON 5
 uu_6                -1.233264e-01 1 1  ON 6
 uu_7                -1.363700e-01 1 1  ON 7
 uu_8                -1.282419e-01 1 1  ON 8
 uu_9                -9.947174e-02 1 1  ON 9
 ud_0                 4.434998e-01 1 1  ON 10
 ud_1                 1.777409e-01 1 1  ON 11
 ud_2                 5.799572e-02 1 1  ON 12
 ud_3                -1.250281e-02 1 1  ON 13
 ud_4                -6.880512e-02 1 1  ON 14
 ud_5                -1.080294e-01 1 1  ON 15
 ud_6                -1.328974e-01 1 1  ON 16
 ud_7                -1.470035e-01 1 1  ON 17
 ud_8                -1.457243e-01 1 1  ON 18
 ud_9                -1.352199e-01 1 1  ON 19
 eO_0                -7.634524e-01 1 1  ON 20
 eO_1                -4.422339e-01 1 1  ON 21
 eO_2                -2.051428e-02 1 1  ON 22
 eO_3                 3.008198e-01 1 1  ON 23
 eO_4                 5.250402e-01 1 1  ON 24
 eO_5                 4.811133e-01 1 1  ON 25
 eO_6                 2.499875e-01 1 1  ON 26
 eO_7                -4.946966e-02 1 1  ON 27
 eO_8                -2.103708e-01 1 1  ON 28
 eO_9                -7.123478e-02 1 1  ON 29
eH1_0                -2.362665e-01 1 1  ON 30
eH1_1                -1.371639e-01 1 1  ON 31
eH1_2                -9.158002e-02 1 1  ON 32
eH1_3                -3.823094e-02 1 1  ON 33
eH1_4                 7.511456e-03 1 1  ON 34
eH1_5                 4.098069e-02 1 1  ON 35
eH1_6                 9.635685e-02 1 1  ON 36
eH1_7                 1.470278e-01 1 1  ON 37
eH1_8                 1.638688e-01 1 1  ON 38
eH1_9                 5.090873e-02 1 1  ON 39
eH2_0                -2.332568e-01 1 1  ON 40
eH2_1                -1.341828e-01 1 1  ON 41
eH2_2                -8.868495e-02 1 1  ON 42
eH2_3                -3.499645e-02 1 1  ON 43
eH2_4                 1.125184e-02 1 1  ON 44
eH2_5                 4.345147e-02 1 1  ON 45
eH2_6                 9.996147e-02 1 1  ON 46
eH2_7                 1.512001e-01 1 1  ON 47
eH2_8                 1.689692e-01 1 1  ON 48
eH2_9                 3.397326e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.9315
    reference variance = 0.268062
====================================================
  Execution time = 2.1218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3584e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335946053058
                                         uncertainty =       0.003117420266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335946053058
                                         uncertainty =       0.003117420266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409777950
  error estimate for blocks of size 2^( 2) =       0.000423498687
  error estimate for blocks of size 2^( 3) =       0.000438024054
  error estimate for blocks of size 2^( 4) =       0.000452623307
  error estimate for blocks of size 2^( 5) =       0.000467302492
  error estimate for blocks of size 2^( 6) =       0.000478662744
  error estimate for blocks of size 2^( 7) =       0.000487956645

      target function =                  N/A
              le_mean =     -16.911386374434
             les_mean =     286.330824874579
             stat err =       0.000471636297
             autocorr =       1.324699188608
              std dev =       0.579513534872
             le_variance =       0.335835937100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691138637443e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911386374434       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911386360434       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911386463039       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911386461995       residual = 8.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911386469253       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911386476903       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911386493622       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911386502231       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.855324e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911386374434       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911386370882       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911386397012       residual = 9.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911386396788       residual = 8.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911386398579       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911386400654       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911386404677       residual = 2.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911386406708       residual = 8.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 7.150446e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911386374434       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911386373543       residual = 5.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911386380106       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911386380053       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911386380499       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911386381028       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911386382023       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911386382524       residual = 8.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 1.788387e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045489 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6813e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.083954e-01 1 1  ON 0
 uu_1                 1.416432e-01 1 1  ON 1
 uu_2                 4.091779e-02 1 1  ON 2
 uu_3                -2.030820e-02 1 1  ON 3
 uu_4                -6.360759e-02 1 1  ON 4
 uu_5                -9.671313e-02 1 1  ON 5
 uu_6                -1.233256e-01 1 1  ON 6
 uu_7                -1.363713e-01 1 1  ON 7
 uu_8                -1.282483e-01 1 1  ON 8
 uu_9                -9.947691e-02 1 1  ON 9
 ud_0                 4.434991e-01 1 1  ON 10
 ud_1                 1.777419e-01 1 1  ON 11
 ud_2                 5.799751e-02 1 1  ON 12
 ud_3                -1.250145e-02 1 1  ON 13
 ud_4                -6.880189e-02 1 1  ON 14
 ud_5                -1.080306e-01 1 1  ON 15
 ud_6                -1.328945e-01 1 1  ON 16
 ud_7                -1.470019e-01 1 1  ON 17
 ud_8                -1.457294e-01 1 1  ON 18
 ud_9                -1.352238e-01 1 1  ON 19
 eO_0                -7.634561e-01 1 1  ON 20
 eO_1                -4.422327e-01 1 1  ON 21
 eO_2                -2.051616e-02 1 1  ON 22
 eO_3                 3.008192e-01 1 1  ON 23
 eO_4                 5.250416e-01 1 1  ON 24
 eO_5                 4.811191e-01 1 1  ON 25
 eO_6                 2.499946e-01 1 1  ON 26
 eO_7                -4.946840e-02 1 1  ON 27
 eO_8                -2.103768e-01 1 1  ON 28
 eO_9                -7.123868e-02 1 1  ON 29
eH1_0                -2.362704e-01 1 1  ON 30
eH1_1                -1.371652e-01 1 1  ON 31
eH1_2                -9.158475e-02 1 1  ON 32
eH1_3                -3.822990e-02 1 1  ON 33
eH1_4                 7.511389e-03 1 1  ON 34
eH1_5                 4.097937e-02 1 1  ON 35
eH1_6                 9.635640e-02 1 1  ON 36
eH1_7                 1.470306e-01 1 1  ON 37
eH1_8                 1.638733e-01 1 1  ON 38
eH1_9                 5.091219e-02 1 1  ON 39
eH2_0                -2.332578e-01 1 1  ON 40
eH2_1                -1.341857e-01 1 1  ON 41
eH2_2                -8.868577e-02 1 1  ON 42
eH2_3                -3.499574e-02 1 1  ON 43
eH2_4                 1.124845e-02 1 1  ON 44
eH2_5                 4.345149e-02 1 1  ON 45
eH2_6                 9.996022e-02 1 1  ON 46
eH2_7                 1.511996e-01 1 1  ON 47
eH2_8                 1.689740e-01 1 1  ON 48
eH2_9                 3.397850e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -16.8688
    reference variance = 0.192532
====================================================
  Execution time = 2.0473e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4417e-01
  Total weights = 2.0000e+06
  Execution time = 1.8672e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344304973812
                                         uncertainty =       0.007099258281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344304973812
                                         uncertainty =       0.007099258281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414835544
  error estimate for blocks of size 2^( 2) =       0.000428622515
  error estimate for blocks of size 2^( 3) =       0.000443505344
  error estimate for blocks of size 2^( 4) =       0.000458446729
  error estimate for blocks of size 2^( 5) =       0.000474367066
  error estimate for blocks of size 2^( 6) =       0.000487402772
  error estimate for blocks of size 2^( 7) =       0.000496573089

      target function =                  N/A
              le_mean =     -16.910315378498
             les_mean =     286.302943084859
             stat err =       0.000479197414
             autocorr =       1.334372277097
              std dev =       0.586666052104
             le_variance =       0.344177056691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344295912751
                                         uncertainty =       0.007099099038

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344295912751
                                         uncertainty =       0.007099099038

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414830081
  error estimate for blocks of size 2^( 2) =       0.000428617029
  error estimate for blocks of size 2^( 3) =       0.000443499792
  error estimate for blocks of size 2^( 4) =       0.000458441176
  error estimate for blocks of size 2^( 5) =       0.000474361882
  error estimate for blocks of size 2^( 6) =       0.000487398013
  error estimate for blocks of size 2^( 7) =       0.000496568688

      target function =                  N/A
              le_mean =     -16.910315403377
             les_mean =     286.302934861436
             stat err =       0.000479192440
             autocorr =       1.334379720807
              std dev =       0.586658326319
             le_variance =       0.344167991840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344300292833
                                         uncertainty =       0.007099175783

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344300292833
                                         uncertainty =       0.007099175783

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414832722
  error estimate for blocks of size 2^( 2) =       0.000428619683
  error estimate for blocks of size 2^( 3) =       0.000443502480
  error estimate for blocks of size 2^( 4) =       0.000458443868
  error estimate for blocks of size 2^( 5) =       0.000474364398
  error estimate for blocks of size 2^( 6) =       0.000487400322
  error estimate for blocks of size 2^( 7) =       0.000496570821

      target function =                  N/A
              le_mean =     -16.910315390110
             les_mean =     286.302938794692
             stat err =       0.000479194852
             autocorr =       1.334376166245
              std dev =       0.586662060961
             le_variance =       0.344172373771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344304383485
                                         uncertainty =       0.007099247874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344304383485
                                         uncertainty =       0.007099247874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000414835188
  error estimate for blocks of size 2^( 2) =       0.000428622158
  error estimate for blocks of size 2^( 3) =       0.000443504983
  error estimate for blocks of size 2^( 4) =       0.000458446368
  error estimate for blocks of size 2^( 5) =       0.000474366730
  error estimate for blocks of size 2^( 6) =       0.000487402463
  error estimate for blocks of size 2^( 7) =       0.000496572803

      target function =                  N/A
              le_mean =     -16.910315379887
             les_mean =     286.302942541287
             stat err =       0.000479197091
             autocorr =       1.334372768814
              std dev =       0.586665548776
             le_variance =       0.344176466121


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910315378498        initial
     9.7656e+00     9.7656e+01             2.8553e-05       -16.910315403377  <--
     3.9062e+01     3.9062e+02             7.1504e-06       -16.910315390110
     1.5625e+02     1.5625e+03             1.7884e-06       -16.910315379887

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.9947e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 3.083872e-01 1 1  ON 0
 uu_1                 1.416548e-01 1 1  ON 1
 uu_2                 4.092354e-02 1 1  ON 2
 uu_3                -2.030165e-02 1 1  ON 3
 uu_4                -6.360270e-02 1 1  ON 4
 uu_5                -9.670596e-02 1 1  ON 5
 uu_6                -1.233233e-01 1 1  ON 6
 uu_7                -1.363753e-01 1 1  ON 7
 uu_8                -1.282676e-01 1 1  ON 8
 uu_9                -9.949242e-02 1 1  ON 9
 ud_0                 4.434976e-01 1 1  ON 10
 ud_1                 1.777450e-01 1 1  ON 11
 ud_2                 5.800278e-02 1 1  ON 12
 ud_3                -1.249733e-02 1 1  ON 13
 ud_4                -6.879251e-02 1 1  ON 14
 ud_5                -1.080339e-01 1 1  ON 15
 ud_6                -1.328862e-01 1 1  ON 16
 ud_7                -1.469972e-01 1 1  ON 17
 ud_8                -1.457446e-01 1 1  ON 18
 ud_9                -1.352355e-01 1 1  ON 19
 eO_0                -7.634668e-01 1 1  ON 20
 eO_1                -4.422295e-01 1 1  ON 21
 eO_2                -2.052169e-02 1 1  ON 22
 eO_3                 3.008172e-01 1 1  ON 23
 eO_4                 5.250459e-01 1 1  ON 24
 eO_5                 4.811364e-01 1 1  ON 25
 eO_6                 2.500161e-01 1 1  ON 26
 eO_7                -4.946462e-02 1 1  ON 27
 eO_8                -2.103949e-01 1 1  ON 28
 eO_9                -7.125036e-02 1 1  ON 29
eH1_0                -2.362820e-01 1 1  ON 30
eH1_1                -1.371690e-01 1 1  ON 31
eH1_2                -9.159861e-02 1 1  ON 32
eH1_3                -3.822707e-02 1 1  ON 33
eH1_4                 7.511235e-03 1 1  ON 34
eH1_5                 4.097544e-02 1 1  ON 35
eH1_6                 9.635504e-02 1 1  ON 36
eH1_7                 1.470390e-01 1 1  ON 37
eH1_8                 1.638866e-01 1 1  ON 38
eH1_9                 5.092253e-02 1 1  ON 39
eH2_0                -2.332609e-01 1 1  ON 40
eH2_1                -1.341941e-01 1 1  ON 41
eH2_2                -8.868821e-02 1 1  ON 42
eH2_3                -3.499377e-02 1 1  ON 43
eH2_4                 1.123839e-02 1 1  ON 44
eH2_5                 4.345146e-02 1 1  ON 45
eH2_6                 9.995644e-02 1 1  ON 46
eH2_7                 1.511980e-01 1 1  ON 47
eH2_8                 1.689882e-01 1 1  ON 48
eH2_9                 3.399417e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6766e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6905e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8361
    reference variance = 0.530366
====================================================
  Execution time = 2.0929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3503e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335064167179
                                         uncertainty =       0.002576052907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335064167179
                                         uncertainty =       0.002576052907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409288480
  error estimate for blocks of size 2^( 2) =       0.000423345651
  error estimate for blocks of size 2^( 3) =       0.000438126479
  error estimate for blocks of size 2^( 4) =       0.000453316115
  error estimate for blocks of size 2^( 5) =       0.000469430451
  error estimate for blocks of size 2^( 6) =       0.000481594689
  error estimate for blocks of size 2^( 7) =       0.000492692461

      target function =                  N/A
              le_mean =     -16.910146654446
             les_mean =     286.288093826649
             stat err =       0.000474258429
             autocorr =       1.342675533129
              std dev =       0.578821318960
             le_variance =       0.335034119283


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691014665445e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910146654446       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910146787286       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910146903970       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910147009296       residual = 9.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910147107183       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910147055721       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910147092686       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910147128798       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+00 is 1.079888e-04

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910146654446       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910146689097       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910146721633       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910146750782       residual = 9.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910146777196       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910146764612       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910146768984       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910146778081       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 2.712823e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910146654446       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910146663204       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910146671578       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910146679057       residual = 8.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910146685824       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910146682729       residual = 9.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910146683473       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910146685705       residual = 3.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 6.790996e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6526e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.083880e-01 1 1  ON 0
 uu_1                 1.416525e-01 1 1  ON 1
 uu_2                 4.092329e-02 1 1  ON 2
 uu_3                -2.030762e-02 1 1  ON 3
 uu_4                -6.361115e-02 1 1  ON 4
 uu_5                -9.670946e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363773e-01 1 1  ON 7
 uu_8                -1.282670e-01 1 1  ON 8
 uu_9                -9.949390e-02 1 1  ON 9
 ud_0                 4.435087e-01 1 1  ON 10
 ud_1                 1.777462e-01 1 1  ON 11
 ud_2                 5.800537e-02 1 1  ON 12
 ud_3                -1.249346e-02 1 1  ON 13
 ud_4                -6.878943e-02 1 1  ON 14
 ud_5                -1.080451e-01 1 1  ON 15
 ud_6                -1.328965e-01 1 1  ON 16
 ud_7                -1.469922e-01 1 1  ON 17
 ud_8                -1.457478e-01 1 1  ON 18
 ud_9                -1.352390e-01 1 1  ON 19
 eO_0                -7.634712e-01 1 1  ON 20
 eO_1                -4.422492e-01 1 1  ON 21
 eO_2                -2.052858e-02 1 1  ON 22
 eO_3                 3.008115e-01 1 1  ON 23
 eO_4                 5.250609e-01 1 1  ON 24
 eO_5                 4.811636e-01 1 1  ON 25
 eO_6                 2.500293e-01 1 1  ON 26
 eO_7                -4.945611e-02 1 1  ON 27
 eO_8                -2.104077e-01 1 1  ON 28
 eO_9                -7.126275e-02 1 1  ON 29
eH1_0                -2.363026e-01 1 1  ON 30
eH1_1                -1.371741e-01 1 1  ON 31
eH1_2                -9.161534e-02 1 1  ON 32
eH1_3                -3.822819e-02 1 1  ON 33
eH1_4                 7.514537e-03 1 1  ON 34
eH1_5                 4.097133e-02 1 1  ON 35
eH1_6                 9.636657e-02 1 1  ON 36
eH1_7                 1.470464e-01 1 1  ON 37
eH1_8                 1.638976e-01 1 1  ON 38
eH1_9                 5.093751e-02 1 1  ON 39
eH2_0                -2.332617e-01 1 1  ON 40
eH2_1                -1.342168e-01 1 1  ON 41
eH2_2                -8.869628e-02 1 1  ON 42
eH2_3                -3.499748e-02 1 1  ON 43
eH2_4                 1.122548e-02 1 1  ON 44
eH2_5                 4.345414e-02 1 1  ON 45
eH2_6                 9.994675e-02 1 1  ON 46
eH2_7                 1.511987e-01 1 1  ON 47
eH2_8                 1.690121e-01 1 1  ON 48
eH2_9                 3.402110e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -16.8219
    reference variance = 2.71637
====================================================
  Execution time = 2.0646e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3866e-01
  Total weights = 2.0000e+06
  Execution time = 1.8797e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338385118336
                                         uncertainty =       0.003247716595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338385118336
                                         uncertainty =       0.003247716595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411491731
  error estimate for blocks of size 2^( 2) =       0.000424931000
  error estimate for blocks of size 2^( 3) =       0.000439713906
  error estimate for blocks of size 2^( 4) =       0.000455160208
  error estimate for blocks of size 2^( 5) =       0.000471121424
  error estimate for blocks of size 2^( 6) =       0.000485612735
  error estimate for blocks of size 2^( 7) =       0.000495060586

      target function =                  N/A
              le_mean =     -16.911150336312
             les_mean =     286.325656417405
             stat err =       0.000476738738
             autocorr =       1.342266220198
              std dev =       0.581937186798
             le_variance =       0.338650889378

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338416985083
                                         uncertainty =       0.003248131291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338416985083
                                         uncertainty =       0.003248131291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411511101
  error estimate for blocks of size 2^( 2) =       0.000424949643
  error estimate for blocks of size 2^( 3) =       0.000439731661
  error estimate for blocks of size 2^( 4) =       0.000455176941
  error estimate for blocks of size 2^( 5) =       0.000471137143
  error estimate for blocks of size 2^( 6) =       0.000485628580
  error estimate for blocks of size 2^( 7) =       0.000495074330

      target function =                  N/A
              le_mean =     -16.911150017317
             les_mean =     286.325677510867
             stat err =       0.000476754248
             autocorr =       1.342227193903
              std dev =       0.581964579694
             le_variance =       0.338682772018

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338402987671
                                         uncertainty =       0.003247950521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338402987671
                                         uncertainty =       0.003247950521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411502593
  error estimate for blocks of size 2^( 2) =       0.000424941441
  error estimate for blocks of size 2^( 3) =       0.000439723849
  error estimate for blocks of size 2^( 4) =       0.000455169602
  error estimate for blocks of size 2^( 5) =       0.000471130298
  error estimate for blocks of size 2^( 6) =       0.000485621692
  error estimate for blocks of size 2^( 7) =       0.000495068415

      target function =                  N/A
              le_mean =     -16.911150150959
             les_mean =     286.325668027011
             stat err =       0.000476747502
             autocorr =       1.342244706032
              std dev =       0.581952547952
             le_variance =       0.338668768068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338387419308
                                         uncertainty =       0.003247746797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338387419308
                                         uncertainty =       0.003247746797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411493130
  error estimate for blocks of size 2^( 2) =       0.000424932344
  error estimate for blocks of size 2^( 3) =       0.000439715186
  error estimate for blocks of size 2^( 4) =       0.000455161418
  error estimate for blocks of size 2^( 5) =       0.000471122569
  error estimate for blocks of size 2^( 6) =       0.000485613891
  error estimate for blocks of size 2^( 7) =       0.000495061597

      target function =                  N/A
              le_mean =     -16.911150312009
             les_mean =     286.325657897610
             stat err =       0.000476739869
             autocorr =       1.342263459929
              std dev =       0.581939164836
             le_variance =       0.338653191570


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911150336312        initial  <--
     2.4414e+00     2.4414e+01             1.0799e-04       -16.911150017317
     9.7656e+00     9.7656e+01             2.7128e-05       -16.911150150959
     3.9062e+01     3.9062e+02             6.7910e-06       -16.911150312009

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.1255
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 3.083872e-01 1 1  ON 0
 uu_1                 1.416548e-01 1 1  ON 1
 uu_2                 4.092354e-02 1 1  ON 2
 uu_3                -2.030165e-02 1 1  ON 3
 uu_4                -6.360270e-02 1 1  ON 4
 uu_5                -9.670596e-02 1 1  ON 5
 uu_6                -1.233233e-01 1 1  ON 6
 uu_7                -1.363753e-01 1 1  ON 7
 uu_8                -1.282676e-01 1 1  ON 8
 uu_9                -9.949242e-02 1 1  ON 9
 ud_0                 4.434976e-01 1 1  ON 10
 ud_1                 1.777450e-01 1 1  ON 11
 ud_2                 5.800278e-02 1 1  ON 12
 ud_3                -1.249733e-02 1 1  ON 13
 ud_4                -6.879251e-02 1 1  ON 14
 ud_5                -1.080339e-01 1 1  ON 15
 ud_6                -1.328862e-01 1 1  ON 16
 ud_7                -1.469972e-01 1 1  ON 17
 ud_8                -1.457446e-01 1 1  ON 18
 ud_9                -1.352355e-01 1 1  ON 19
 eO_0                -7.634668e-01 1 1  ON 20
 eO_1                -4.422295e-01 1 1  ON 21
 eO_2                -2.052169e-02 1 1  ON 22
 eO_3                 3.008172e-01 1 1  ON 23
 eO_4                 5.250459e-01 1 1  ON 24
 eO_5                 4.811364e-01 1 1  ON 25
 eO_6                 2.500161e-01 1 1  ON 26
 eO_7                -4.946462e-02 1 1  ON 27
 eO_8                -2.103949e-01 1 1  ON 28
 eO_9                -7.125036e-02 1 1  ON 29
eH1_0                -2.362820e-01 1 1  ON 30
eH1_1                -1.371690e-01 1 1  ON 31
eH1_2                -9.159861e-02 1 1  ON 32
eH1_3                -3.822707e-02 1 1  ON 33
eH1_4                 7.511235e-03 1 1  ON 34
eH1_5                 4.097544e-02 1 1  ON 35
eH1_6                 9.635504e-02 1 1  ON 36
eH1_7                 1.470390e-01 1 1  ON 37
eH1_8                 1.638866e-01 1 1  ON 38
eH1_9                 5.092253e-02 1 1  ON 39
eH2_0                -2.332609e-01 1 1  ON 40
eH2_1                -1.341941e-01 1 1  ON 41
eH2_2                -8.868821e-02 1 1  ON 42
eH2_3                -3.499377e-02 1 1  ON 43
eH2_4                 1.123839e-02 1 1  ON 44
eH2_5                 4.345146e-02 1 1  ON 45
eH2_6                 9.995644e-02 1 1  ON 46
eH2_7                 1.511980e-01 1 1  ON 47
eH2_8                 1.689882e-01 1 1  ON 48
eH2_9                 3.399417e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6657e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6898e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2293
    reference variance = 11.996
====================================================
  Execution time = 2.0690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3989e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7046e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339179079942
                                         uncertainty =       0.003712444134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339179079942
                                         uncertainty =       0.003712444134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412242044
  error estimate for blocks of size 2^( 2) =       0.000425007792
  error estimate for blocks of size 2^( 3) =       0.000439559890
  error estimate for blocks of size 2^( 4) =       0.000454226758
  error estimate for blocks of size 2^( 5) =       0.000468531281
  error estimate for blocks of size 2^( 6) =       0.000481672312
  error estimate for blocks of size 2^( 7) =       0.000490650872

      target function =                  N/A
              le_mean =     -16.910608677871
             les_mean =     286.308572691469
             stat err =       0.000473770306
             autocorr =       1.320781901069
              std dev =       0.582998289295
             le_variance =       0.339887005321


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691060867787e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910608677871       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910608682403       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910608705037       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910608727081       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910608720733       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910608727451       residual = 5.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910608731190       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.521464e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910608677871       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910608679007       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910608684722       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910608690245       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910608688645       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910608690298       residual = 5.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910608691255       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.382282e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910608677871       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910608678155       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910608679588       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910608680969       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910608680568       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910608680980       residual = 5.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910608681221       residual = 8.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 5.956900e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.050322 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6401e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.083861e-01 1 1  ON 0
 uu_1                 1.416556e-01 1 1  ON 1
 uu_2                 4.092399e-02 1 1  ON 2
 uu_3                -2.030124e-02 1 1  ON 3
 uu_4                -6.360326e-02 1 1  ON 4
 uu_5                -9.670605e-02 1 1  ON 5
 uu_6                -1.233232e-01 1 1  ON 6
 uu_7                -1.363753e-01 1 1  ON 7
 uu_8                -1.282689e-01 1 1  ON 8
 uu_9                -9.949310e-02 1 1  ON 9
 ud_0                 4.434986e-01 1 1  ON 10
 ud_1                 1.777451e-01 1 1  ON 11
 ud_2                 5.800254e-02 1 1  ON 12
 ud_3                -1.249805e-02 1 1  ON 13
 ud_4                -6.879258e-02 1 1  ON 14
 ud_5                -1.080345e-01 1 1  ON 15
 ud_6                -1.328861e-01 1 1  ON 16
 ud_7                -1.469968e-01 1 1  ON 17
 ud_8                -1.457456e-01 1 1  ON 18
 ud_9                -1.352352e-01 1 1  ON 19
 eO_0                -7.634682e-01 1 1  ON 20
 eO_1                -4.422314e-01 1 1  ON 21
 eO_2                -2.052177e-02 1 1  ON 22
 eO_3                 3.008176e-01 1 1  ON 23
 eO_4                 5.250467e-01 1 1  ON 24
 eO_5                 4.811381e-01 1 1  ON 25
 eO_6                 2.500184e-01 1 1  ON 26
 eO_7                -4.946367e-02 1 1  ON 27
 eO_8                -2.103964e-01 1 1  ON 28
 eO_9                -7.125149e-02 1 1  ON 29
eH1_0                -2.362830e-01 1 1  ON 30
eH1_1                -1.371692e-01 1 1  ON 31
eH1_2                -9.159965e-02 1 1  ON 32
eH1_3                -3.822798e-02 1 1  ON 33
eH1_4                 7.511250e-03 1 1  ON 34
eH1_5                 4.097443e-02 1 1  ON 35
eH1_6                 9.635564e-02 1 1  ON 36
eH1_7                 1.470393e-01 1 1  ON 37
eH1_8                 1.638879e-01 1 1  ON 38
eH1_9                 5.092445e-02 1 1  ON 39
eH2_0                -2.332613e-01 1 1  ON 40
eH2_1                -1.341941e-01 1 1  ON 41
eH2_2                -8.868873e-02 1 1  ON 42
eH2_3                -3.499453e-02 1 1  ON 43
eH2_4                 1.123875e-02 1 1  ON 44
eH2_5                 4.345155e-02 1 1  ON 45
eH2_6                 9.995412e-02 1 1  ON 46
eH2_7                 1.511977e-01 1 1  ON 47
eH2_8                 1.689897e-01 1 1  ON 48
eH2_9                 3.399632e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -16.9709
    reference variance = 0.286646
====================================================
  Execution time = 2.1288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3914e-01
  Total weights = 2.0000e+06
  Execution time = 2.2294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339088751241
                                         uncertainty =       0.003702603472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339088751241
                                         uncertainty =       0.003702603472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411791174
  error estimate for blocks of size 2^( 2) =       0.000425616260
  error estimate for blocks of size 2^( 3) =       0.000439727286
  error estimate for blocks of size 2^( 4) =       0.000454917144
  error estimate for blocks of size 2^( 5) =       0.000469070458
  error estimate for blocks of size 2^( 6) =       0.000481519522
  error estimate for blocks of size 2^( 7) =       0.000489951546

      target function =                  N/A
              le_mean =     -16.910985247510
             les_mean =     286.320565814513
             stat err =       0.000473864667
             autocorr =       1.324203057501
              std dev =       0.582360663667
             le_variance =       0.339143942587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339091605642
                                         uncertainty =       0.003702647496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339091605642
                                         uncertainty =       0.003702647496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411792908
  error estimate for blocks of size 2^( 2) =       0.000425617848
  error estimate for blocks of size 2^( 3) =       0.000439728742
  error estimate for blocks of size 2^( 4) =       0.000454918507
  error estimate for blocks of size 2^( 5) =       0.000469071711
  error estimate for blocks of size 2^( 6) =       0.000481520783
  error estimate for blocks of size 2^( 7) =       0.000489952722

      target function =                  N/A
              le_mean =     -16.910985252737
             les_mean =     286.320568847351
             stat err =       0.000473865931
             autocorr =       1.324198968493
              std dev =       0.582363115807
             le_variance =       0.339146798652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339090187538
                                         uncertainty =       0.003702625627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339090187538
                                         uncertainty =       0.003702625627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411792047
  error estimate for blocks of size 2^( 2) =       0.000425617059
  error estimate for blocks of size 2^( 3) =       0.000439728019
  error estimate for blocks of size 2^( 4) =       0.000454917830
  error estimate for blocks of size 2^( 5) =       0.000469071089
  error estimate for blocks of size 2^( 6) =       0.000481520157
  error estimate for blocks of size 2^( 7) =       0.000489952138

      target function =                  N/A
              le_mean =     -16.910985250117
             les_mean =     286.320567339842
             stat err =       0.000473865304
             autocorr =       1.324201002443
              std dev =       0.582361897559
             le_variance =       0.339145379729

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339088931049
                                         uncertainty =       0.003702606246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339088931049
                                         uncertainty =       0.003702606246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411791284
  error estimate for blocks of size 2^( 2) =       0.000425616360
  error estimate for blocks of size 2^( 3) =       0.000439727378
  error estimate for blocks of size 2^( 4) =       0.000454917230
  error estimate for blocks of size 2^( 5) =       0.000469070537
  error estimate for blocks of size 2^( 6) =       0.000481519601
  error estimate for blocks of size 2^( 7) =       0.000489951620

      target function =                  N/A
              le_mean =     -16.910985247834
             les_mean =     286.320566005376
             stat err =       0.000473864747
             autocorr =       1.324202800285
              std dev =       0.582360818137
             le_variance =       0.339144122501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910985247510        initial
     2.4414e+01     2.4414e+02             9.5215e-06       -16.910985252737  <--
     9.7656e+01     9.7656e+02             2.3823e-06       -16.910985250117
     3.9062e+02     3.9062e+03             5.9569e-07       -16.910985247834

*****************************************************************************
Applying the update for shift_i =   2.4414e+01     and shift_s =   2.4414e+02
*****************************************************************************

  Execution time = 3.1071e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 3.083828e-01 1 1  ON 0
 uu_1                 1.416579e-01 1 1  ON 1
 uu_2                 4.092534e-02 1 1  ON 2
 uu_3                -2.030004e-02 1 1  ON 3
 uu_4                -6.360492e-02 1 1  ON 4
 uu_5                -9.670634e-02 1 1  ON 5
 uu_6                -1.233231e-01 1 1  ON 6
 uu_7                -1.363751e-01 1 1  ON 7
 uu_8                -1.282727e-01 1 1  ON 8
 uu_9                -9.949514e-02 1 1  ON 9
 ud_0                 4.435016e-01 1 1  ON 10
 ud_1                 1.777453e-01 1 1  ON 11
 ud_2                 5.800181e-02 1 1  ON 12
 ud_3                -1.250019e-02 1 1  ON 13
 ud_4                -6.879280e-02 1 1  ON 14
 ud_5                -1.080362e-01 1 1  ON 15
 ud_6                -1.328856e-01 1 1  ON 16
 ud_7                -1.469958e-01 1 1  ON 17
 ud_8                -1.457486e-01 1 1  ON 18
 ud_9                -1.352342e-01 1 1  ON 19
 eO_0                -7.634724e-01 1 1  ON 20
 eO_1                -4.422372e-01 1 1  ON 21
 eO_2                -2.052200e-02 1 1  ON 22
 eO_3                 3.008186e-01 1 1  ON 23
 eO_4                 5.250490e-01 1 1  ON 24
 eO_5                 4.811430e-01 1 1  ON 25
 eO_6                 2.500256e-01 1 1  ON 26
 eO_7                -4.946081e-02 1 1  ON 27
 eO_8                -2.104009e-01 1 1  ON 28
 eO_9                -7.125487e-02 1 1  ON 29
eH1_0                -2.362860e-01 1 1  ON 30
eH1_1                -1.371701e-01 1 1  ON 31
eH1_2                -9.160275e-02 1 1  ON 32
eH1_3                -3.823069e-02 1 1  ON 33
eH1_4                 7.511282e-03 1 1  ON 34
eH1_5                 4.097143e-02 1 1  ON 35
eH1_6                 9.635746e-02 1 1  ON 36
eH1_7                 1.470401e-01 1 1  ON 37
eH1_8                 1.638918e-01 1 1  ON 38
eH1_9                 5.093018e-02 1 1  ON 39
eH2_0                -2.332626e-01 1 1  ON 40
eH2_1                -1.341944e-01 1 1  ON 41
eH2_2                -8.869028e-02 1 1  ON 42
eH2_3                -3.499679e-02 1 1  ON 43
eH2_4                 1.123979e-02 1 1  ON 44
eH2_5                 4.345181e-02 1 1  ON 45
eH2_6                 9.994715e-02 1 1  ON 46
eH2_7                 1.511969e-01 1 1  ON 47
eH2_8                 1.689941e-01 1 1  ON 48
eH2_9                 3.400276e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7478e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9164
    reference variance = 0.158511
====================================================
  Execution time = 2.0642e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3703e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4521e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337070235060
                                         uncertainty =       0.004133835260

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337070235060
                                         uncertainty =       0.004133835260

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410506863
  error estimate for blocks of size 2^( 2) =       0.000424131359
  error estimate for blocks of size 2^( 3) =       0.000439118282
  error estimate for blocks of size 2^( 4) =       0.000453367962
  error estimate for blocks of size 2^( 5) =       0.000467575940
  error estimate for blocks of size 2^( 6) =       0.000480468999
  error estimate for blocks of size 2^( 7) =       0.000489178292

      target function =                  N/A
              le_mean =     -16.911165791021
             les_mean =     286.324560012616
             stat err =       0.000472647798
             autocorr =       1.325666960860
              std dev =       0.580544373614
             le_variance =       0.337031769735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691116579102e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+00, overlap shift 6.1035e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911165791021       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911165860194       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911165891578       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911165895834       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911165879883       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911165957680       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911165938637       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911165948730       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+00 is 3.759176e-05

solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911165791021       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911165808730       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911165816808       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911165817869       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911165813474       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911165832930       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911165828635       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911165831329       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 9.418586e-06

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911165791021       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911165795475       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911165797510       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911165797775       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911165796651       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911165801513       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911165800469       residual = 1.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911165801154       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 2.355918e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052967 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6101e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.083828e-01 1 1  ON 0
 uu_1                 1.416653e-01 1 1  ON 1
 uu_2                 4.092837e-02 1 1  ON 2
 uu_3                -2.029975e-02 1 1  ON 3
 uu_4                -6.360415e-02 1 1  ON 4
 uu_5                -9.670993e-02 1 1  ON 5
 uu_6                -1.233220e-01 1 1  ON 6
 uu_7                -1.363744e-01 1 1  ON 7
 uu_8                -1.282798e-01 1 1  ON 8
 uu_9                -9.950272e-02 1 1  ON 9
 ud_0                 4.434994e-01 1 1  ON 10
 ud_1                 1.777488e-01 1 1  ON 11
 ud_2                 5.800254e-02 1 1  ON 12
 ud_3                -1.250159e-02 1 1  ON 13
 ud_4                -6.878685e-02 1 1  ON 14
 ud_5                -1.080347e-01 1 1  ON 15
 ud_6                -1.328849e-01 1 1  ON 16
 ud_7                -1.469961e-01 1 1  ON 17
 ud_8                -1.457501e-01 1 1  ON 18
 ud_9                -1.352373e-01 1 1  ON 19
 eO_0                -7.634786e-01 1 1  ON 20
 eO_1                -4.422443e-01 1 1  ON 21
 eO_2                -2.052249e-02 1 1  ON 22
 eO_3                 3.008243e-01 1 1  ON 23
 eO_4                 5.250524e-01 1 1  ON 24
 eO_5                 4.811524e-01 1 1  ON 25
 eO_6                 2.500346e-01 1 1  ON 26
 eO_7                -4.946004e-02 1 1  ON 27
 eO_8                -2.104084e-01 1 1  ON 28
 eO_9                -7.126076e-02 1 1  ON 29
eH1_0                -2.362892e-01 1 1  ON 30
eH1_1                -1.371724e-01 1 1  ON 31
eH1_2                -9.160359e-02 1 1  ON 32
eH1_3                -3.822936e-02 1 1  ON 33
eH1_4                 7.513162e-03 1 1  ON 34
eH1_5                 4.096827e-02 1 1  ON 35
eH1_6                 9.635448e-02 1 1  ON 36
eH1_7                 1.470404e-01 1 1  ON 37
eH1_8                 1.638969e-01 1 1  ON 38
eH1_9                 5.093515e-02 1 1  ON 39
eH2_0                -2.332685e-01 1 1  ON 40
eH2_1                -1.341970e-01 1 1  ON 41
eH2_2                -8.869293e-02 1 1  ON 42
eH2_3                -3.499499e-02 1 1  ON 43
eH2_4                 1.123484e-02 1 1  ON 44
eH2_5                 4.345468e-02 1 1  ON 45
eH2_6                 9.994361e-02 1 1  ON 46
eH2_7                 1.511984e-01 1 1  ON 47
eH2_8                 1.689992e-01 1 1  ON 48
eH2_9                 3.401070e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -16.9604
    reference variance = 0.266256
====================================================
  Execution time = 2.0288e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4531e-01
  Total weights = 2.0000e+06
  Execution time = 1.8737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345310288040
                                         uncertainty =       0.004006473109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345310288040
                                         uncertainty =       0.004006473109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415519652
  error estimate for blocks of size 2^( 2) =       0.000429283817
  error estimate for blocks of size 2^( 3) =       0.000444678754
  error estimate for blocks of size 2^( 4) =       0.000459493133
  error estimate for blocks of size 2^( 5) =       0.000473002662
  error estimate for blocks of size 2^( 6) =       0.000485605499
  error estimate for blocks of size 2^( 7) =       0.000492313595

      target function =                  N/A
              le_mean =     -16.910705537081
             les_mean =     286.317274751167
             stat err =       0.000477603722
             autocorr =       1.321150425225
              std dev =       0.587633526916
             le_variance =       0.345313161956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345298624608
                                         uncertainty =       0.004006363700

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345298624608
                                         uncertainty =       0.004006363700

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415512622
  error estimate for blocks of size 2^( 2) =       0.000429276897
  error estimate for blocks of size 2^( 3) =       0.000444671650
  error estimate for blocks of size 2^( 4) =       0.000459485567
  error estimate for blocks of size 2^( 5) =       0.000472995251
  error estimate for blocks of size 2^( 6) =       0.000485597538
  error estimate for blocks of size 2^( 7) =       0.000492305713

      target function =                  N/A
              le_mean =     -16.910705528914
             les_mean =     286.317262791694
             stat err =       0.000477596017
             autocorr =       1.321152498860
              std dev =       0.587623585891
             le_variance =       0.345301478695

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345304026173
                                         uncertainty =       0.004006413869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345304026173
                                         uncertainty =       0.004006413869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415515878
  error estimate for blocks of size 2^( 2) =       0.000429280107
  error estimate for blocks of size 2^( 3) =       0.000444674952
  error estimate for blocks of size 2^( 4) =       0.000459489096
  error estimate for blocks of size 2^( 5) =       0.000472998710
  error estimate for blocks of size 2^( 6) =       0.000485601259
  error estimate for blocks of size 2^( 7) =       0.000492309402

      target function =                  N/A
              le_mean =     -16.910705531318
             les_mean =     286.317268283909
             stat err =       0.000477599617
             autocorr =       1.321151712237
              std dev =       0.587628189946
             le_variance =       0.345306889619

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345309490237
                                         uncertainty =       0.004006465551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345309490237
                                         uncertainty =       0.004006465551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415519171
  error estimate for blocks of size 2^( 2) =       0.000429283344
  error estimate for blocks of size 2^( 3) =       0.000444678270
  error estimate for blocks of size 2^( 4) =       0.000459492620
  error estimate for blocks of size 2^( 5) =       0.000473002159
  error estimate for blocks of size 2^( 6) =       0.000485604960
  error estimate for blocks of size 2^( 7) =       0.000492313062

      target function =                  N/A
              le_mean =     -16.910705536248
             les_mean =     286.317273923855
             stat err =       0.000477603200
             autocorr =       1.321150594910
              std dev =       0.587632846958
             le_variance =       0.345312362824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910705537081        initial  <--
     6.1035e+00     6.1035e+01             3.7592e-05       -16.910705528914
     2.4414e+01     2.4414e+02             9.4186e-06       -16.910705531318
     9.7656e+01     9.7656e+02             2.3559e-06       -16.910705536248

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7274
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 3.083828e-01 1 1  ON 0
 uu_1                 1.416579e-01 1 1  ON 1
 uu_2                 4.092534e-02 1 1  ON 2
 uu_3                -2.030004e-02 1 1  ON 3
 uu_4                -6.360492e-02 1 1  ON 4
 uu_5                -9.670634e-02 1 1  ON 5
 uu_6                -1.233231e-01 1 1  ON 6
 uu_7                -1.363751e-01 1 1  ON 7
 uu_8                -1.282727e-01 1 1  ON 8
 uu_9                -9.949514e-02 1 1  ON 9
 ud_0                 4.435016e-01 1 1  ON 10
 ud_1                 1.777453e-01 1 1  ON 11
 ud_2                 5.800181e-02 1 1  ON 12
 ud_3                -1.250019e-02 1 1  ON 13
 ud_4                -6.879280e-02 1 1  ON 14
 ud_5                -1.080362e-01 1 1  ON 15
 ud_6                -1.328856e-01 1 1  ON 16
 ud_7                -1.469958e-01 1 1  ON 17
 ud_8                -1.457486e-01 1 1  ON 18
 ud_9                -1.352342e-01 1 1  ON 19
 eO_0                -7.634724e-01 1 1  ON 20
 eO_1                -4.422372e-01 1 1  ON 21
 eO_2                -2.052200e-02 1 1  ON 22
 eO_3                 3.008186e-01 1 1  ON 23
 eO_4                 5.250490e-01 1 1  ON 24
 eO_5                 4.811430e-01 1 1  ON 25
 eO_6                 2.500256e-01 1 1  ON 26
 eO_7                -4.946081e-02 1 1  ON 27
 eO_8                -2.104009e-01 1 1  ON 28
 eO_9                -7.125487e-02 1 1  ON 29
eH1_0                -2.362860e-01 1 1  ON 30
eH1_1                -1.371701e-01 1 1  ON 31
eH1_2                -9.160275e-02 1 1  ON 32
eH1_3                -3.823069e-02 1 1  ON 33
eH1_4                 7.511282e-03 1 1  ON 34
eH1_5                 4.097143e-02 1 1  ON 35
eH1_6                 9.635746e-02 1 1  ON 36
eH1_7                 1.470401e-01 1 1  ON 37
eH1_8                 1.638918e-01 1 1  ON 38
eH1_9                 5.093018e-02 1 1  ON 39
eH2_0                -2.332626e-01 1 1  ON 40
eH2_1                -1.341944e-01 1 1  ON 41
eH2_2                -8.869028e-02 1 1  ON 42
eH2_3                -3.499679e-02 1 1  ON 43
eH2_4                 1.123979e-02 1 1  ON 44
eH2_5                 4.345181e-02 1 1  ON 45
eH2_6                 9.994715e-02 1 1  ON 46
eH2_7                 1.511969e-01 1 1  ON 47
eH2_8                 1.689941e-01 1 1  ON 48
eH2_9                 3.400276e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5834e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.9438
    reference variance = 0.226848
====================================================
  Execution time = 2.0690e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3776e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5162e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337841993162
                                         uncertainty =       0.004195089110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337841993162
                                         uncertainty =       0.004195089110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410952783
  error estimate for blocks of size 2^( 2) =       0.000424520130
  error estimate for blocks of size 2^( 3) =       0.000439983216
  error estimate for blocks of size 2^( 4) =       0.000455243820
  error estimate for blocks of size 2^( 5) =       0.000469926043
  error estimate for blocks of size 2^( 6) =       0.000481087746
  error estimate for blocks of size 2^( 7) =       0.000490357955

      target function =                  N/A
              le_mean =     -16.910749476771
             les_mean =     286.311212076449
             stat err =       0.000474153891
             autocorr =       1.331235180518
              std dev =       0.581174998782
             le_variance =       0.337764379210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691074947677e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910749476771       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910749477146       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910749470075       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910749468123       residual = 6.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910749480452       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910749483160       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910749483675       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910749483652       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.628749e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910749476771       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910749476865       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910749475091       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910749474598       residual = 6.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910749477661       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910749478348       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910749478464       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910749478477       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 9.074918e-07

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910749476771       residual = 5.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910749476795       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910749476351       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910749476227       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910749476992       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910749477164       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910749477193       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910749477196       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 2.268897e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055616 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6213e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.083830e-01 1 1  ON 0
 uu_1                 1.416585e-01 1 1  ON 1
 uu_2                 4.092561e-02 1 1  ON 2
 uu_3                -2.029994e-02 1 1  ON 3
 uu_4                -6.360530e-02 1 1  ON 4
 uu_5                -9.670641e-02 1 1  ON 5
 uu_6                -1.233230e-01 1 1  ON 6
 uu_7                -1.363756e-01 1 1  ON 7
 uu_8                -1.282734e-01 1 1  ON 8
 uu_9                -9.949549e-02 1 1  ON 9
 ud_0                 4.435014e-01 1 1  ON 10
 ud_1                 1.777454e-01 1 1  ON 11
 ud_2                 5.800196e-02 1 1  ON 12
 ud_3                -1.250055e-02 1 1  ON 13
 ud_4                -6.879232e-02 1 1  ON 14
 ud_5                -1.080363e-01 1 1  ON 15
 ud_6                -1.328857e-01 1 1  ON 16
 ud_7                -1.469956e-01 1 1  ON 17
 ud_8                -1.457488e-01 1 1  ON 18
 ud_9                -1.352344e-01 1 1  ON 19
 eO_0                -7.634729e-01 1 1  ON 20
 eO_1                -4.422377e-01 1 1  ON 21
 eO_2                -2.052222e-02 1 1  ON 22
 eO_3                 3.008187e-01 1 1  ON 23
 eO_4                 5.250497e-01 1 1  ON 24
 eO_5                 4.811436e-01 1 1  ON 25
 eO_6                 2.500262e-01 1 1  ON 26
 eO_7                -4.946056e-02 1 1  ON 27
 eO_8                -2.104014e-01 1 1  ON 28
 eO_9                -7.125542e-02 1 1  ON 29
eH1_0                -2.362865e-01 1 1  ON 30
eH1_1                -1.371706e-01 1 1  ON 31
eH1_2                -9.160328e-02 1 1  ON 32
eH1_3                -3.823061e-02 1 1  ON 33
eH1_4                 7.511859e-03 1 1  ON 34
eH1_5                 4.097142e-02 1 1  ON 35
eH1_6                 9.635738e-02 1 1  ON 36
eH1_7                 1.470402e-01 1 1  ON 37
eH1_8                 1.638923e-01 1 1  ON 38
eH1_9                 5.093064e-02 1 1  ON 39
eH2_0                -2.332635e-01 1 1  ON 40
eH2_1                -1.341953e-01 1 1  ON 41
eH2_2                -8.869061e-02 1 1  ON 42
eH2_3                -3.499722e-02 1 1  ON 43
eH2_4                 1.124005e-02 1 1  ON 44
eH2_5                 4.345242e-02 1 1  ON 45
eH2_6                 9.994705e-02 1 1  ON 46
eH2_7                 1.511972e-01 1 1  ON 47
eH2_8                 1.689947e-01 1 1  ON 48
eH2_9                 3.400360e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -16.8659
    reference variance = 0.237022
====================================================
  Execution time = 2.0521e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3594e-01
  Total weights = 2.0000e+06
  Execution time = 1.8705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335890188512
                                         uncertainty =       0.003432262927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335890188512
                                         uncertainty =       0.003432262927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409842980
  error estimate for blocks of size 2^( 2) =       0.000423214542
  error estimate for blocks of size 2^( 3) =       0.000437685344
  error estimate for blocks of size 2^( 4) =       0.000451727243
  error estimate for blocks of size 2^( 5) =       0.000464826081
  error estimate for blocks of size 2^( 6) =       0.000476983044
  error estimate for blocks of size 2^( 7) =       0.000486086626

      target function =                  N/A
              le_mean =     -16.911025073532
             les_mean =     286.318711406270
             stat err =       0.000469905748
             autocorr =       1.314578467039
              std dev =       0.579605500852
             le_variance =       0.335942536618

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335889269949
                                         uncertainty =       0.003432253638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335889269949
                                         uncertainty =       0.003432253638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409842420
  error estimate for blocks of size 2^( 2) =       0.000423214001
  error estimate for blocks of size 2^( 3) =       0.000437684814
  error estimate for blocks of size 2^( 4) =       0.000451726696
  error estimate for blocks of size 2^( 5) =       0.000464825554
  error estimate for blocks of size 2^( 6) =       0.000476982571
  error estimate for blocks of size 2^( 7) =       0.000486086175

      target function =                  N/A
              le_mean =     -16.911025094203
             les_mean =     286.318711186706
             stat err =       0.000469905249
             autocorr =       1.314579268607
              std dev =       0.579604708311
             le_variance =       0.335941617897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335889723038
                                         uncertainty =       0.003432258230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335889723038
                                         uncertainty =       0.003432258230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409842696
  error estimate for blocks of size 2^( 2) =       0.000423214268
  error estimate for blocks of size 2^( 3) =       0.000437685075
  error estimate for blocks of size 2^( 4) =       0.000451726966
  error estimate for blocks of size 2^( 5) =       0.000464825814
  error estimate for blocks of size 2^( 6) =       0.000476982805
  error estimate for blocks of size 2^( 7) =       0.000486086398

      target function =                  N/A
              le_mean =     -16.911025083970
             les_mean =     286.318711293755
             stat err =       0.000469905496
             autocorr =       1.314578875431
              std dev =       0.579605099241
             le_variance =       0.335942071066

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335890130149
                                         uncertainty =       0.003432262338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335890130149
                                         uncertainty =       0.003432262338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409842944
  error estimate for blocks of size 2^( 2) =       0.000423214507
  error estimate for blocks of size 2^( 3) =       0.000437685310
  error estimate for blocks of size 2^( 4) =       0.000451727208
  error estimate for blocks of size 2^( 5) =       0.000464826047
  error estimate for blocks of size 2^( 6) =       0.000476983014
  error estimate for blocks of size 2^( 7) =       0.000486086597

      target function =                  N/A
              le_mean =     -16.911025074839
             les_mean =     286.318711392097
             stat err =       0.000469905717
             autocorr =       1.314578518312
              std dev =       0.579605450496
             le_variance =       0.335942478245


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911025073532        initial
     6.1035e+01     6.1035e+02             3.6287e-06       -16.911025094203  <--
     2.4414e+02     2.4414e+03             9.0749e-07       -16.911025083970
     9.7656e+02     9.7656e+03             2.2689e-07       -16.911025074839

*****************************************************************************
Applying the update for shift_i =   6.1035e+01     and shift_s =   6.1035e+02
*****************************************************************************

  Execution time = 2.9949e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 3.083836e-01 1 1  ON 0
 uu_1                 1.416601e-01 1 1  ON 1
 uu_2                 4.092641e-02 1 1  ON 2
 uu_3                -2.029965e-02 1 1  ON 3
 uu_4                -6.360641e-02 1 1  ON 4
 uu_5                -9.670664e-02 1 1  ON 5
 uu_6                -1.233228e-01 1 1  ON 6
 uu_7                -1.363771e-01 1 1  ON 7
 uu_8                -1.282756e-01 1 1  ON 8
 uu_9                -9.949653e-02 1 1  ON 9
 ud_0                 4.435009e-01 1 1  ON 10
 ud_1                 1.777456e-01 1 1  ON 11
 ud_2                 5.800241e-02 1 1  ON 12
 ud_3                -1.250162e-02 1 1  ON 13
 ud_4                -6.879089e-02 1 1  ON 14
 ud_5                -1.080364e-01 1 1  ON 15
 ud_6                -1.328859e-01 1 1  ON 16
 ud_7                -1.469952e-01 1 1  ON 17
 ud_8                -1.457494e-01 1 1  ON 18
 ud_9                -1.352348e-01 1 1  ON 19
 eO_0                -7.634743e-01 1 1  ON 20
 eO_1                -4.422392e-01 1 1  ON 21
 eO_2                -2.052289e-02 1 1  ON 22
 eO_3                 3.008191e-01 1 1  ON 23
 eO_4                 5.250517e-01 1 1  ON 24
 eO_5                 4.811456e-01 1 1  ON 25
 eO_6                 2.500282e-01 1 1  ON 26
 eO_7                -4.945980e-02 1 1  ON 27
 eO_8                -2.104030e-01 1 1  ON 28
 eO_9                -7.125706e-02 1 1  ON 29
eH1_0                -2.362878e-01 1 1  ON 30
eH1_1                -1.371722e-01 1 1  ON 31
eH1_2                -9.160485e-02 1 1  ON 32
eH1_3                -3.823037e-02 1 1  ON 33
eH1_4                 7.513582e-03 1 1  ON 34
eH1_5                 4.097139e-02 1 1  ON 35
eH1_6                 9.635715e-02 1 1  ON 36
eH1_7                 1.470403e-01 1 1  ON 37
eH1_8                 1.638938e-01 1 1  ON 38
eH1_9                 5.093202e-02 1 1  ON 39
eH2_0                -2.332662e-01 1 1  ON 40
eH2_1                -1.341979e-01 1 1  ON 41
eH2_2                -8.869159e-02 1 1  ON 42
eH2_3                -3.499850e-02 1 1  ON 43
eH2_4                 1.124081e-02 1 1  ON 44
eH2_5                 4.345424e-02 1 1  ON 45
eH2_6                 9.994674e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.689965e-01 1 1  ON 48
eH2_9                 3.400611e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6168e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9016
    reference variance = 0.259061
====================================================
  Execution time = 2.1007e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4776e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347833669670
                                         uncertainty =       0.005350566804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.347833669670
                                         uncertainty =       0.005350566804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000416990910
  error estimate for blocks of size 2^( 2) =       0.000430441068
  error estimate for blocks of size 2^( 3) =       0.000445435171
  error estimate for blocks of size 2^( 4) =       0.000461190482
  error estimate for blocks of size 2^( 5) =       0.000476135531
  error estimate for blocks of size 2^( 6) =       0.000490616142
  error estimate for blocks of size 2^( 7) =       0.000502354123

      target function =                  N/A
              le_mean =     -16.911753262679
             les_mean =     286.355161082149
             stat err =       0.000482574069
             autocorr =       1.339290497989
              std dev =       0.589714200514
             le_variance =       0.347762838288


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691175326268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911753262679       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911753355498       residual = 6.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911753409867       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911753438345       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911753445971       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911753430626       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911753451888       residual = 3.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911753447312       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.571834e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911753262679       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911753286135       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911753299990       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911753307173       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911753309103       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911753305095       residual = 8.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911753310443       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911753309285       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.935717e-06

solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911753262679       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911753268559       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911753272040       residual = 1.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911753273839       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911753274324       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911753273311       residual = 8.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911753274649       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911753274359       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 9.843173e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.058262 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6532e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.083804e-01 1 1  ON 0
 uu_1                 1.416626e-01 1 1  ON 1
 uu_2                 4.092949e-02 1 1  ON 2
 uu_3                -2.029877e-02 1 1  ON 3
 uu_4                -6.360697e-02 1 1  ON 4
 uu_5                -9.670720e-02 1 1  ON 5
 uu_6                -1.233230e-01 1 1  ON 6
 uu_7                -1.363770e-01 1 1  ON 7
 uu_8                -1.282782e-01 1 1  ON 8
 uu_9                -9.949915e-02 1 1  ON 9
 ud_0                 4.435012e-01 1 1  ON 10
 ud_1                 1.777448e-01 1 1  ON 11
 ud_2                 5.800258e-02 1 1  ON 12
 ud_3                -1.250205e-02 1 1  ON 13
 ud_4                -6.879046e-02 1 1  ON 14
 ud_5                -1.080359e-01 1 1  ON 15
 ud_6                -1.328859e-01 1 1  ON 16
 ud_7                -1.469939e-01 1 1  ON 17
 ud_8                -1.457500e-01 1 1  ON 18
 ud_9                -1.352353e-01 1 1  ON 19
 eO_0                -7.634782e-01 1 1  ON 20
 eO_1                -4.422397e-01 1 1  ON 21
 eO_2                -2.052455e-02 1 1  ON 22
 eO_3                 3.008186e-01 1 1  ON 23
 eO_4                 5.250545e-01 1 1  ON 24
 eO_5                 4.811494e-01 1 1  ON 25
 eO_6                 2.500322e-01 1 1  ON 26
 eO_7                -4.945825e-02 1 1  ON 27
 eO_8                -2.104057e-01 1 1  ON 28
 eO_9                -7.125966e-02 1 1  ON 29
eH1_0                -2.362895e-01 1 1  ON 30
eH1_1                -1.371760e-01 1 1  ON 31
eH1_2                -9.160740e-02 1 1  ON 32
eH1_3                -3.822962e-02 1 1  ON 33
eH1_4                 7.515578e-03 1 1  ON 34
eH1_5                 4.097068e-02 1 1  ON 35
eH1_6                 9.635782e-02 1 1  ON 36
eH1_7                 1.470410e-01 1 1  ON 37
eH1_8                 1.638960e-01 1 1  ON 38
eH1_9                 5.093423e-02 1 1  ON 39
eH2_0                -2.332679e-01 1 1  ON 40
eH2_1                -1.341994e-01 1 1  ON 41
eH2_2                -8.869310e-02 1 1  ON 42
eH2_3                -3.499970e-02 1 1  ON 43
eH2_4                 1.124309e-02 1 1  ON 44
eH2_5                 4.345402e-02 1 1  ON 45
eH2_6                 9.994385e-02 1 1  ON 46
eH2_7                 1.511980e-01 1 1  ON 47
eH2_8                 1.689988e-01 1 1  ON 48
eH2_9                 3.401002e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -16.9728
    reference variance = 0.264446
====================================================
  Execution time = 2.0464e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4176e-01
  Total weights = 2.0000e+06
  Execution time = 1.8761e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341757591156
                                         uncertainty =       0.004601373999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341757591156
                                         uncertainty =       0.004601373999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413379163
  error estimate for blocks of size 2^( 2) =       0.000426873998
  error estimate for blocks of size 2^( 3) =       0.000442167081
  error estimate for blocks of size 2^( 4) =       0.000458447817
  error estimate for blocks of size 2^( 5) =       0.000474425124
  error estimate for blocks of size 2^( 6) =       0.000487961618
  error estimate for blocks of size 2^( 7) =       0.000499673255

      target function =                  N/A
              le_mean =     -16.910388374392
             les_mean =     286.302999465866
             stat err =       0.000480126953
             autocorr =       1.349009512297
              std dev =       0.584606418010
             le_variance =       0.341764663978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341755434862
                                         uncertainty =       0.004601433962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341755434862
                                         uncertainty =       0.004601433962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413377860
  error estimate for blocks of size 2^( 2) =       0.000426872625
  error estimate for blocks of size 2^( 3) =       0.000442165628
  error estimate for blocks of size 2^( 4) =       0.000458446277
  error estimate for blocks of size 2^( 5) =       0.000474423447
  error estimate for blocks of size 2^( 6) =       0.000487959843
  error estimate for blocks of size 2^( 7) =       0.000499671786

      target function =                  N/A
              le_mean =     -16.910388386297
             les_mean =     286.302997714613
             stat err =       0.000480125338
             autocorr =       1.349008937932
              std dev =       0.584604575839
             le_variance =       0.341762510092

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341756494322
                                         uncertainty =       0.004601404503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341756494322
                                         uncertainty =       0.004601404503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413378500
  error estimate for blocks of size 2^( 2) =       0.000426873300
  error estimate for blocks of size 2^( 3) =       0.000442166344
  error estimate for blocks of size 2^( 4) =       0.000458447035
  error estimate for blocks of size 2^( 5) =       0.000474424274
  error estimate for blocks of size 2^( 6) =       0.000487960719
  error estimate for blocks of size 2^( 7) =       0.000499672509

      target function =                  N/A
              le_mean =     -16.910388379297
             les_mean =     286.302998536160
             stat err =       0.000480126134
             autocorr =       1.349009233489
              std dev =       0.584605480961
             le_variance =       0.341763568370

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341757453258
                                         uncertainty =       0.004601377828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341757453258
                                         uncertainty =       0.004601377828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413379079
  error estimate for blocks of size 2^( 2) =       0.000426873910
  error estimate for blocks of size 2^( 3) =       0.000442166988
  error estimate for blocks of size 2^( 4) =       0.000458447719
  error estimate for blocks of size 2^( 5) =       0.000474425017
  error estimate for blocks of size 2^( 6) =       0.000487961505
  error estimate for blocks of size 2^( 7) =       0.000499673161

      target function =                  N/A
              le_mean =     -16.910388374949
             les_mean =     286.302999346949
             stat err =       0.000480126850
             autocorr =       1.349009477771
              std dev =       0.584606300201
             le_variance =       0.341764526235


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910388374392        initial
     1.5259e+01     1.5259e+02             1.5718e-05       -16.910388386297  <--
     6.1035e+01     6.1035e+02             3.9357e-06       -16.910388379297
     2.4414e+02     2.4414e+03             9.8432e-07       -16.910388374949

*****************************************************************************
Applying the update for shift_i =   1.5259e+01     and shift_s =   1.5259e+02
*****************************************************************************

  Execution time = 2.9918e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 3.083712e-01 1 1  ON 0
 uu_1                 1.416700e-01 1 1  ON 1
 uu_2                 4.093851e-02 1 1  ON 2
 uu_3                -2.029610e-02 1 1  ON 3
 uu_4                -6.360866e-02 1 1  ON 4
 uu_5                -9.670884e-02 1 1  ON 5
 uu_6                -1.233238e-01 1 1  ON 6
 uu_7                -1.363768e-01 1 1  ON 7
 uu_8                -1.282863e-01 1 1  ON 8
 uu_9                -9.950702e-02 1 1  ON 9
 ud_0                 4.435023e-01 1 1  ON 10
 ud_1                 1.777427e-01 1 1  ON 11
 ud_2                 5.800305e-02 1 1  ON 12
 ud_3                -1.250328e-02 1 1  ON 13
 ud_4                -6.878925e-02 1 1  ON 14
 ud_5                -1.080344e-01 1 1  ON 15
 ud_6                -1.328860e-01 1 1  ON 16
 ud_7                -1.469903e-01 1 1  ON 17
 ud_8                -1.457520e-01 1 1  ON 18
 ud_9                -1.352370e-01 1 1  ON 19
 eO_0                -7.634897e-01 1 1  ON 20
 eO_1                -4.422416e-01 1 1  ON 21
 eO_2                -2.052948e-02 1 1  ON 22
 eO_3                 3.008171e-01 1 1  ON 23
 eO_4                 5.250630e-01 1 1  ON 24
 eO_5                 4.811610e-01 1 1  ON 25
 eO_6                 2.500439e-01 1 1  ON 26
 eO_7                -4.945362e-02 1 1  ON 27
 eO_8                -2.104139e-01 1 1  ON 28
 eO_9                -7.126744e-02 1 1  ON 29
eH1_0                -2.362947e-01 1 1  ON 30
eH1_1                -1.371872e-01 1 1  ON 31
eH1_2                -9.161494e-02 1 1  ON 32
eH1_3                -3.822746e-02 1 1  ON 33
eH1_4                 7.521554e-03 1 1  ON 34
eH1_5                 4.096854e-02 1 1  ON 35
eH1_6                 9.635982e-02 1 1  ON 36
eH1_7                 1.470430e-01 1 1  ON 37
eH1_8                 1.639028e-01 1 1  ON 38
eH1_9                 5.094085e-02 1 1  ON 39
eH2_0                -2.332729e-01 1 1  ON 40
eH2_1                -1.342036e-01 1 1  ON 41
eH2_2                -8.869754e-02 1 1  ON 42
eH2_3                -3.500328e-02 1 1  ON 43
eH2_4                 1.124987e-02 1 1  ON 44
eH2_5                 4.345338e-02 1 1  ON 45
eH2_6                 9.993520e-02 1 1  ON 46
eH2_7                 1.511976e-01 1 1  ON 47
eH2_8                 1.690058e-01 1 1  ON 48
eH2_9                 3.402174e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6456e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9031
    reference variance = 0.360441
====================================================
  Execution time = 2.0642e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4549e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345476913778
                                         uncertainty =       0.006169124859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345476913778
                                         uncertainty =       0.006169124859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415623211
  error estimate for blocks of size 2^( 2) =       0.000428554012
  error estimate for blocks of size 2^( 3) =       0.000442871948
  error estimate for blocks of size 2^( 4) =       0.000457206791
  error estimate for blocks of size 2^( 5) =       0.000471946656
  error estimate for blocks of size 2^( 6) =       0.000485300430
  error estimate for blocks of size 2^( 7) =       0.000495974123

      target function =                  N/A
              le_mean =     -16.911004756728
             les_mean =     286.327567016809
             stat err =       0.000477607000
             autocorr =       1.320510259346
              std dev =       0.587779982204
             le_variance =       0.345485307480


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691100475673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+00, overlap shift 3.8147e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911004756728       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911004777114       residual = 4.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911004917703       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911004985810       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911005163275       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911005156691       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911005120557       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911005106700       residual = 5.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+00 is 5.985425e-05

solving harmonic davidson linear method for identity shift 1.5259e+01, overlap shift 1.5259e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911004756728       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911004761980       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911004799309       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911004816861       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911004864941       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911004862500       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911004853624       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911004849820       residual = 4.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+01 is 1.498612e-05

solving harmonic davidson linear method for identity shift 6.1035e+01, overlap shift 6.1035e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911004756728       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911004758051       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911004767531       residual = 1.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911004771956       residual = 6.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911004784236       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911004783575       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911004781374       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911004780398       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+01 is 3.747598e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.061010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6208e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.083811e-01 1 1  ON 0
 uu_1                 1.416737e-01 1 1  ON 1
 uu_2                 4.094003e-02 1 1  ON 2
 uu_3                -2.029395e-02 1 1  ON 3
 uu_4                -6.362226e-02 1 1  ON 4
 uu_5                -9.670613e-02 1 1  ON 5
 uu_6                -1.233288e-01 1 1  ON 6
 uu_7                -1.363796e-01 1 1  ON 7
 uu_8                -1.282928e-01 1 1  ON 8
 uu_9                -9.951146e-02 1 1  ON 9
 ud_0                 4.435004e-01 1 1  ON 10
 ud_1                 1.777361e-01 1 1  ON 11
 ud_2                 5.800923e-02 1 1  ON 12
 ud_3                -1.250582e-02 1 1  ON 13
 ud_4                -6.877861e-02 1 1  ON 14
 ud_5                -1.080388e-01 1 1  ON 15
 ud_6                -1.328842e-01 1 1  ON 16
 ud_7                -1.469872e-01 1 1  ON 17
 ud_8                -1.457573e-01 1 1  ON 18
 ud_9                -1.352382e-01 1 1  ON 19
 eO_0                -7.634942e-01 1 1  ON 20
 eO_1                -4.422489e-01 1 1  ON 21
 eO_2                -2.053521e-02 1 1  ON 22
 eO_3                 3.008168e-01 1 1  ON 23
 eO_4                 5.250714e-01 1 1  ON 24
 eO_5                 4.811760e-01 1 1  ON 25
 eO_6                 2.500558e-01 1 1  ON 26
 eO_7                -4.945149e-02 1 1  ON 27
 eO_8                -2.104251e-01 1 1  ON 28
 eO_9                -7.127508e-02 1 1  ON 29
eH1_0                -2.363008e-01 1 1  ON 30
eH1_1                -1.371934e-01 1 1  ON 31
eH1_2                -9.161921e-02 1 1  ON 32
eH1_3                -3.822589e-02 1 1  ON 33
eH1_4                 7.515781e-03 1 1  ON 34
eH1_5                 4.096787e-02 1 1  ON 35
eH1_6                 9.636344e-02 1 1  ON 36
eH1_7                 1.470455e-01 1 1  ON 37
eH1_8                 1.639087e-01 1 1  ON 38
eH1_9                 5.095095e-02 1 1  ON 39
eH2_0                -2.332756e-01 1 1  ON 40
eH2_1                -1.342062e-01 1 1  ON 41
eH2_2                -8.869963e-02 1 1  ON 42
eH2_3                -3.500818e-02 1 1  ON 43
eH2_4                 1.124547e-02 1 1  ON 44
eH2_5                 4.345601e-02 1 1  ON 45
eH2_6                 9.993134e-02 1 1  ON 46
eH2_7                 1.511940e-01 1 1  ON 47
eH2_8                 1.690136e-01 1 1  ON 48
eH2_9                 3.403426e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -16.9853
    reference variance = 0.510167
====================================================
  Execution time = 2.0188e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3932e-01
  Total weights = 2.0000e+06
  Execution time = 1.8618e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339334373716
                                         uncertainty =       0.004307899552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339334373716
                                         uncertainty =       0.004307899552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411897906
  error estimate for blocks of size 2^( 2) =       0.000425471631
  error estimate for blocks of size 2^( 3) =       0.000440305933
  error estimate for blocks of size 2^( 4) =       0.000455871448
  error estimate for blocks of size 2^( 5) =       0.000472328944
  error estimate for blocks of size 2^( 6) =       0.000486187414
  error estimate for blocks of size 2^( 7) =       0.000497776117

      target function =                  N/A
              le_mean =     -16.910214341359
             les_mean =     286.294668670330
             stat err =       0.000478040981
             autocorr =       1.346948806809
              std dev =       0.582511604413
             le_variance =       0.339319769275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339327318903
                                         uncertainty =       0.004307725681

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339327318903
                                         uncertainty =       0.004307725681

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411893603
  error estimate for blocks of size 2^( 2) =       0.000425467666
  error estimate for blocks of size 2^( 3) =       0.000440302280
  error estimate for blocks of size 2^( 4) =       0.000455867958
  error estimate for blocks of size 2^( 5) =       0.000472325697
  error estimate for blocks of size 2^( 6) =       0.000486183575
  error estimate for blocks of size 2^( 7) =       0.000497771167

      target function =                  N/A
              le_mean =     -16.910214249753
             les_mean =     286.294658483010
             stat err =       0.000478037099
             autocorr =       1.346955073729
              std dev =       0.582505519377
             le_variance =       0.339312680105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339330833381
                                         uncertainty =       0.004307814698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339330833381
                                         uncertainty =       0.004307814698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411895746
  error estimate for blocks of size 2^( 2) =       0.000425469654
  error estimate for blocks of size 2^( 3) =       0.000440304128
  error estimate for blocks of size 2^( 4) =       0.000455869726
  error estimate for blocks of size 2^( 5) =       0.000472327355
  error estimate for blocks of size 2^( 6) =       0.000486185504
  error estimate for blocks of size 2^( 7) =       0.000497773607

      target function =                  N/A
              le_mean =     -16.910214288930
             les_mean =     286.294663338305
             stat err =       0.000478039048
             autocorr =       1.346952043084
              std dev =       0.582508549655
             le_variance =       0.339316210421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339333928302
                                         uncertainty =       0.004307889026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339333928302
                                         uncertainty =       0.004307889026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411897634
  error estimate for blocks of size 2^( 2) =       0.000425471382
  error estimate for blocks of size 2^( 3) =       0.000440305706
  error estimate for blocks of size 2^( 4) =       0.000455871232
  error estimate for blocks of size 2^( 5) =       0.000472328745
  error estimate for blocks of size 2^( 6) =       0.000486187174
  error estimate for blocks of size 2^( 7) =       0.000497775801

      target function =                  N/A
              le_mean =     -16.910214334319
             les_mean =     286.294667984452
             stat err =       0.000478040738
             autocorr =       1.346949216884
              std dev =       0.582511220063
             le_variance =       0.339319321500


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910214341359        initial  <--
     3.8147e+00     3.8147e+01             5.9854e-05       -16.910214249753
     1.5259e+01     1.5259e+02             1.4986e-05       -16.910214288930
     6.1035e+01     6.1035e+02             3.7476e-06       -16.910214334319

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5697
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 3.083712e-01 1 1  ON 0
 uu_1                 1.416700e-01 1 1  ON 1
 uu_2                 4.093851e-02 1 1  ON 2
 uu_3                -2.029610e-02 1 1  ON 3
 uu_4                -6.360866e-02 1 1  ON 4
 uu_5                -9.670884e-02 1 1  ON 5
 uu_6                -1.233238e-01 1 1  ON 6
 uu_7                -1.363768e-01 1 1  ON 7
 uu_8                -1.282863e-01 1 1  ON 8
 uu_9                -9.950702e-02 1 1  ON 9
 ud_0                 4.435023e-01 1 1  ON 10
 ud_1                 1.777427e-01 1 1  ON 11
 ud_2                 5.800305e-02 1 1  ON 12
 ud_3                -1.250328e-02 1 1  ON 13
 ud_4                -6.878925e-02 1 1  ON 14
 ud_5                -1.080344e-01 1 1  ON 15
 ud_6                -1.328860e-01 1 1  ON 16
 ud_7                -1.469903e-01 1 1  ON 17
 ud_8                -1.457520e-01 1 1  ON 18
 ud_9                -1.352370e-01 1 1  ON 19
 eO_0                -7.634897e-01 1 1  ON 20
 eO_1                -4.422416e-01 1 1  ON 21
 eO_2                -2.052948e-02 1 1  ON 22
 eO_3                 3.008171e-01 1 1  ON 23
 eO_4                 5.250630e-01 1 1  ON 24
 eO_5                 4.811610e-01 1 1  ON 25
 eO_6                 2.500439e-01 1 1  ON 26
 eO_7                -4.945362e-02 1 1  ON 27
 eO_8                -2.104139e-01 1 1  ON 28
 eO_9                -7.126744e-02 1 1  ON 29
eH1_0                -2.362947e-01 1 1  ON 30
eH1_1                -1.371872e-01 1 1  ON 31
eH1_2                -9.161494e-02 1 1  ON 32
eH1_3                -3.822746e-02 1 1  ON 33
eH1_4                 7.521554e-03 1 1  ON 34
eH1_5                 4.096854e-02 1 1  ON 35
eH1_6                 9.635982e-02 1 1  ON 36
eH1_7                 1.470430e-01 1 1  ON 37
eH1_8                 1.639028e-01 1 1  ON 38
eH1_9                 5.094085e-02 1 1  ON 39
eH2_0                -2.332729e-01 1 1  ON 40
eH2_1                -1.342036e-01 1 1  ON 41
eH2_2                -8.869754e-02 1 1  ON 42
eH2_3                -3.500328e-02 1 1  ON 43
eH2_4                 1.124987e-02 1 1  ON 44
eH2_5                 4.345338e-02 1 1  ON 45
eH2_6                 9.993520e-02 1 1  ON 46
eH2_7                 1.511976e-01 1 1  ON 47
eH2_8                 1.690058e-01 1 1  ON 48
eH2_9                 3.402174e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5784e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.896
    reference variance = 0.243481
====================================================
  Execution time = 2.0854e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3841e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5493e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338391419283
                                         uncertainty =       0.004866401756

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338391419283
                                         uncertainty =       0.004866401756

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411345868
  error estimate for blocks of size 2^( 2) =       0.000424649132
  error estimate for blocks of size 2^( 3) =       0.000438832912
  error estimate for blocks of size 2^( 4) =       0.000453432453
  error estimate for blocks of size 2^( 5) =       0.000466714868
  error estimate for blocks of size 2^( 6) =       0.000476907431
  error estimate for blocks of size 2^( 7) =       0.000489182406

      target function =                  N/A
              le_mean =     -16.911369978270
             les_mean =     286.332845218286
             stat err =       0.000471559290
             autocorr =       1.314190526033
              std dev =       0.581730904767
             le_variance =       0.338410845562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691136997827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911369978270       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911369986172       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911369997814       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911370010754       residual = 9.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911370012871       residual = 6.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911370015441       residual = 8.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911370013638       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911370016351       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 8.317285e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911369978270       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911369980254       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911369983177       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911369986424       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911369986961       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911369987626       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911369987172       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911369987849       residual = 4.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 2.080346e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911369978270       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911369978767       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911369979498       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911369980311       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911369980445       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911369980613       residual = 8.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911369980500       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911369980668       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 5.201503e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.063709 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6410e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.083710e-01 1 1  ON 0
 uu_1                 1.416715e-01 1 1  ON 1
 uu_2                 4.093924e-02 1 1  ON 2
 uu_3                -2.029623e-02 1 1  ON 3
 uu_4                -6.360890e-02 1 1  ON 4
 uu_5                -9.670879e-02 1 1  ON 5
 uu_6                -1.233239e-01 1 1  ON 6
 uu_7                -1.363774e-01 1 1  ON 7
 uu_8                -1.282873e-01 1 1  ON 8
 uu_9                -9.950782e-02 1 1  ON 9
 ud_0                 4.435021e-01 1 1  ON 10
 ud_1                 1.777431e-01 1 1  ON 11
 ud_2                 5.800373e-02 1 1  ON 12
 ud_3                -1.250326e-02 1 1  ON 13
 ud_4                -6.878803e-02 1 1  ON 14
 ud_5                -1.080338e-01 1 1  ON 15
 ud_6                -1.328855e-01 1 1  ON 16
 ud_7                -1.469904e-01 1 1  ON 17
 ud_8                -1.457539e-01 1 1  ON 18
 ud_9                -1.352377e-01 1 1  ON 19
 eO_0                -7.634908e-01 1 1  ON 20
 eO_1                -4.422423e-01 1 1  ON 21
 eO_2                -2.052924e-02 1 1  ON 22
 eO_3                 3.008173e-01 1 1  ON 23
 eO_4                 5.250633e-01 1 1  ON 24
 eO_5                 4.811631e-01 1 1  ON 25
 eO_6                 2.500452e-01 1 1  ON 26
 eO_7                -4.945349e-02 1 1  ON 27
 eO_8                -2.104152e-01 1 1  ON 28
 eO_9                -7.126834e-02 1 1  ON 29
eH1_0                -2.362952e-01 1 1  ON 30
eH1_1                -1.371878e-01 1 1  ON 31
eH1_2                -9.161523e-02 1 1  ON 32
eH1_3                -3.822809e-02 1 1  ON 33
eH1_4                 7.521391e-03 1 1  ON 34
eH1_5                 4.096880e-02 1 1  ON 35
eH1_6                 9.636052e-02 1 1  ON 36
eH1_7                 1.470433e-01 1 1  ON 37
eH1_8                 1.639034e-01 1 1  ON 38
eH1_9                 5.094142e-02 1 1  ON 39
eH2_0                -2.332733e-01 1 1  ON 40
eH2_1                -1.342042e-01 1 1  ON 41
eH2_2                -8.869793e-02 1 1  ON 42
eH2_3                -3.500362e-02 1 1  ON 43
eH2_4                 1.124950e-02 1 1  ON 44
eH2_5                 4.345375e-02 1 1  ON 45
eH2_6                 9.993516e-02 1 1  ON 46
eH2_7                 1.511975e-01 1 1  ON 47
eH2_8                 1.690065e-01 1 1  ON 48
eH2_9                 3.402290e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -16.9014
    reference variance = 0.513701
====================================================
  Execution time = 2.0364e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3265e-01
  Total weights = 2.0000e+06
  Execution time = 1.8671e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332729595044
                                         uncertainty =       0.002501860135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332729595044
                                         uncertainty =       0.002501860135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407829762
  error estimate for blocks of size 2^( 2) =       0.000422154989
  error estimate for blocks of size 2^( 3) =       0.000437864368
  error estimate for blocks of size 2^( 4) =       0.000454449467
  error estimate for blocks of size 2^( 5) =       0.000470516214
  error estimate for blocks of size 2^( 6) =       0.000484053029
  error estimate for blocks of size 2^( 7) =       0.000493600720

      target function =                  N/A
              le_mean =     -16.910541844163
             les_mean =     286.299075526356
             stat err =       0.000475654857
             autocorr =       1.360272883503
              std dev =       0.576758380502
             le_variance =       0.332650229479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332726931059
                                         uncertainty =       0.002501838971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332726931059
                                         uncertainty =       0.002501838971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407828130
  error estimate for blocks of size 2^( 2) =       0.000422153382
  error estimate for blocks of size 2^( 3) =       0.000437862758
  error estimate for blocks of size 2^( 4) =       0.000454447842
  error estimate for blocks of size 2^( 5) =       0.000470514572
  error estimate for blocks of size 2^( 6) =       0.000484051434
  error estimate for blocks of size 2^( 7) =       0.000493599163

      target function =                  N/A
              le_mean =     -16.910541853105
             les_mean =     286.299073166892
             stat err =       0.000475653253
             autocorr =       1.360274589726
              std dev =       0.576756072865
             le_variance =       0.332647567586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332728248913
                                         uncertainty =       0.002501849426

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332728248913
                                         uncertainty =       0.002501849426

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407828937
  error estimate for blocks of size 2^( 2) =       0.000422154177
  error estimate for blocks of size 2^( 3) =       0.000437863555
  error estimate for blocks of size 2^( 4) =       0.000454448647
  error estimate for blocks of size 2^( 5) =       0.000470515385
  error estimate for blocks of size 2^( 6) =       0.000484052224
  error estimate for blocks of size 2^( 7) =       0.000493599935

      target function =                  N/A
              le_mean =     -16.910541848582
             les_mean =     286.299074330708
             stat err =       0.000475654048
             autocorr =       1.360273751541
              std dev =       0.576757214436
             le_variance =       0.332648884404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332729426314
                                         uncertainty =       0.002501858792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332729426314
                                         uncertainty =       0.002501858792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407829659
  error estimate for blocks of size 2^( 2) =       0.000422154887
  error estimate for blocks of size 2^( 3) =       0.000437864266
  error estimate for blocks of size 2^( 4) =       0.000454449364
  error estimate for blocks of size 2^( 5) =       0.000470516110
  error estimate for blocks of size 2^( 6) =       0.000484052928
  error estimate for blocks of size 2^( 7) =       0.000493600622

      target function =                  N/A
              le_mean =     -16.910541844712
             les_mean =     286.299075376308
             stat err =       0.000475654756
             autocorr =       1.360272992484
              std dev =       0.576758234343
             le_variance =       0.332650060882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910541844163        initial
     3.8147e+01     3.8147e+02             8.3173e-06       -16.910541853105  <--
     1.5259e+02     1.5259e+03             2.0803e-06       -16.910541848582
     6.1035e+02     6.1035e+03             5.2015e-07       -16.910541844712

*****************************************************************************
Applying the update for shift_i =   3.8147e+01     and shift_s =   3.8147e+02
*****************************************************************************

  Execution time = 2.9783e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 3.083703e-01 1 1  ON 0
 uu_1                 1.416758e-01 1 1  ON 1
 uu_2                 4.094141e-02 1 1  ON 2
 uu_3                -2.029662e-02 1 1  ON 3
 uu_4                -6.360964e-02 1 1  ON 4
 uu_5                -9.670866e-02 1 1  ON 5
 uu_6                -1.233241e-01 1 1  ON 6
 uu_7                -1.363790e-01 1 1  ON 7
 uu_8                -1.282905e-01 1 1  ON 8
 uu_9                -9.951021e-02 1 1  ON 9
 ud_0                 4.435017e-01 1 1  ON 10
 ud_1                 1.777443e-01 1 1  ON 11
 ud_2                 5.800578e-02 1 1  ON 12
 ud_3                -1.250317e-02 1 1  ON 13
 ud_4                -6.878440e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328842e-01 1 1  ON 16
 ud_7                -1.469909e-01 1 1  ON 17
 ud_8                -1.457593e-01 1 1  ON 18
 ud_9                -1.352398e-01 1 1  ON 19
 eO_0                -7.634938e-01 1 1  ON 20
 eO_1                -4.422447e-01 1 1  ON 21
 eO_2                -2.052851e-02 1 1  ON 22
 eO_3                 3.008182e-01 1 1  ON 23
 eO_4                 5.250642e-01 1 1  ON 24
 eO_5                 4.811693e-01 1 1  ON 25
 eO_6                 2.500489e-01 1 1  ON 26
 eO_7                -4.945313e-02 1 1  ON 27
 eO_8                -2.104194e-01 1 1  ON 28
 eO_9                -7.127103e-02 1 1  ON 29
eH1_0                -2.362968e-01 1 1  ON 30
eH1_1                -1.371896e-01 1 1  ON 31
eH1_2                -9.161609e-02 1 1  ON 32
eH1_3                -3.822997e-02 1 1  ON 33
eH1_4                 7.520896e-03 1 1  ON 34
eH1_5                 4.096956e-02 1 1  ON 35
eH1_6                 9.636263e-02 1 1  ON 36
eH1_7                 1.470441e-01 1 1  ON 37
eH1_8                 1.639051e-01 1 1  ON 38
eH1_9                 5.094316e-02 1 1  ON 39
eH2_0                -2.332746e-01 1 1  ON 40
eH2_1                -1.342060e-01 1 1  ON 41
eH2_2                -8.869909e-02 1 1  ON 42
eH2_3                -3.500463e-02 1 1  ON 43
eH2_4                 1.124839e-02 1 1  ON 44
eH2_5                 4.345483e-02 1 1  ON 45
eH2_6                 9.993503e-02 1 1  ON 46
eH2_7                 1.511973e-01 1 1  ON 47
eH2_8                 1.690089e-01 1 1  ON 48
eH2_9                 3.402636e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6199e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6918e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.929
    reference variance = 0.19097
====================================================
  Execution time = 2.2725e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4521e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5591e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345189276552
                                         uncertainty =       0.009393686292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345189276552
                                         uncertainty =       0.009393686292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415456042
  error estimate for blocks of size 2^( 2) =       0.000429262604
  error estimate for blocks of size 2^( 3) =       0.000443529115
  error estimate for blocks of size 2^( 4) =       0.000457303132
  error estimate for blocks of size 2^( 5) =       0.000471909244
  error estimate for blocks of size 2^( 6) =       0.000484794975
  error estimate for blocks of size 2^( 7) =       0.000491801717

      target function =                  N/A
              le_mean =     -16.911750538645
             les_mean =     286.352513554154
             stat err =       0.000476452267
             autocorr =       1.315190421639
              std dev =       0.587543568934
             le_variance =       0.345207445396


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691175053865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+00, overlap shift 9.5367e+01 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911750538645       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911750700497       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911750709703       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911750695791       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911750706675       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911750731099       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911750726085       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911750728542       residual = 5.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+00 is 2.491121e-05

solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911750538645       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911750580313       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911750582805       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911750579293       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911750582001       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911750588083       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911750586584       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911750587153       residual = 5.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 6.240011e-06

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911750538645       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911750549140       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911750549776       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911750548896       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911750549573       residual = 6.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911750551092       residual = 8.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911750550701       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911750550840       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 1.560726e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069224 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8294e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.083678e-01 1 1  ON 0
 uu_1                 1.416775e-01 1 1  ON 1
 uu_2                 4.094559e-02 1 1  ON 2
 uu_3                -2.029739e-02 1 1  ON 3
 uu_4                -6.361158e-02 1 1  ON 4
 uu_5                -9.670508e-02 1 1  ON 5
 uu_6                -1.233212e-01 1 1  ON 6
 uu_7                -1.363773e-01 1 1  ON 7
 uu_8                -1.282958e-01 1 1  ON 8
 uu_9                -9.951560e-02 1 1  ON 9
 ud_0                 4.434999e-01 1 1  ON 10
 ud_1                 1.777441e-01 1 1  ON 11
 ud_2                 5.801006e-02 1 1  ON 12
 ud_3                -1.250168e-02 1 1  ON 13
 ud_4                -6.878226e-02 1 1  ON 14
 ud_5                -1.080312e-01 1 1  ON 15
 ud_6                -1.328840e-01 1 1  ON 16
 ud_7                -1.469898e-01 1 1  ON 17
 ud_8                -1.457635e-01 1 1  ON 18
 ud_9                -1.352411e-01 1 1  ON 19
 eO_0                -7.634983e-01 1 1  ON 20
 eO_1                -4.422472e-01 1 1  ON 21
 eO_2                -2.052855e-02 1 1  ON 22
 eO_3                 3.008179e-01 1 1  ON 23
 eO_4                 5.250680e-01 1 1  ON 24
 eO_5                 4.811756e-01 1 1  ON 25
 eO_6                 2.500542e-01 1 1  ON 26
 eO_7                -4.945202e-02 1 1  ON 27
 eO_8                -2.104242e-01 1 1  ON 28
 eO_9                -7.127471e-02 1 1  ON 29
eH1_0                -2.363025e-01 1 1  ON 30
eH1_1                -1.371889e-01 1 1  ON 31
eH1_2                -9.161559e-02 1 1  ON 32
eH1_3                -3.823071e-02 1 1  ON 33
eH1_4                 7.522142e-03 1 1  ON 34
eH1_5                 4.096704e-02 1 1  ON 35
eH1_6                 9.636354e-02 1 1  ON 36
eH1_7                 1.470449e-01 1 1  ON 37
eH1_8                 1.639075e-01 1 1  ON 38
eH1_9                 5.094626e-02 1 1  ON 39
eH2_0                -2.332768e-01 1 1  ON 40
eH2_1                -1.342056e-01 1 1  ON 41
eH2_2                -8.870043e-02 1 1  ON 42
eH2_3                -3.500329e-02 1 1  ON 43
eH2_4                 1.124470e-02 1 1  ON 44
eH2_5                 4.345588e-02 1 1  ON 45
eH2_6                 9.993303e-02 1 1  ON 46
eH2_7                 1.511970e-01 1 1  ON 47
eH2_8                 1.690109e-01 1 1  ON 48
eH2_9                 3.403109e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -16.9682
    reference variance = 0.889196
====================================================
  Execution time = 2.0364e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3453e-01
  Total weights = 2.0000e+06
  Execution time = 1.9020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334253949419
                                         uncertainty =       0.002895742198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334253949419
                                         uncertainty =       0.002895742198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408984858
  error estimate for blocks of size 2^( 2) =       0.000423436937
  error estimate for blocks of size 2^( 3) =       0.000438162130
  error estimate for blocks of size 2^( 4) =       0.000453443748
  error estimate for blocks of size 2^( 5) =       0.000469455103
  error estimate for blocks of size 2^( 6) =       0.000482904717
  error estimate for blocks of size 2^( 7) =       0.000491575069

      target function =                  N/A
              le_mean =     -16.911145910729
             les_mean =     286.321393074072
             stat err =       0.000474344659
             autocorr =       1.345158848108
              std dev =       0.578391932336
             le_variance =       0.334537227391

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334231725781
                                         uncertainty =       0.002895524883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334231725781
                                         uncertainty =       0.002895524883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408971267
  error estimate for blocks of size 2^( 2) =       0.000423423885
  error estimate for blocks of size 2^( 3) =       0.000438149511
  error estimate for blocks of size 2^( 4) =       0.000453431322
  error estimate for blocks of size 2^( 5) =       0.000469442688
  error estimate for blocks of size 2^( 6) =       0.000482892197
  error estimate for blocks of size 2^( 7) =       0.000491563076

      target function =                  N/A
              le_mean =     -16.911145781125
             les_mean =     286.321366456865
             stat err =       0.000474332321
             autocorr =       1.345178270998
              std dev =       0.578372711715
             le_variance =       0.334514993657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334242474365
                                         uncertainty =       0.002895628992

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334242474365
                                         uncertainty =       0.002895628992

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408977840
  error estimate for blocks of size 2^( 2) =       0.000423430200
  error estimate for blocks of size 2^( 3) =       0.000438155622
  error estimate for blocks of size 2^( 4) =       0.000453437340
  error estimate for blocks of size 2^( 5) =       0.000469448697
  error estimate for blocks of size 2^( 6) =       0.000482898253
  error estimate for blocks of size 2^( 7) =       0.000491568879

      target function =                  N/A
              le_mean =     -16.911145842520
             les_mean =     286.321379286930
             stat err =       0.000474338292
             autocorr =       1.345168896874
              std dev =       0.578382008023
             le_variance =       0.334525747205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334252502684
                                         uncertainty =       0.002895727897

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334252502684
                                         uncertainty =       0.002895727897

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408983973
  error estimate for blocks of size 2^( 2) =       0.000423436087
  error estimate for blocks of size 2^( 3) =       0.000438161310
  error estimate for blocks of size 2^( 4) =       0.000453442941
  error estimate for blocks of size 2^( 5) =       0.000469454295
  error estimate for blocks of size 2^( 6) =       0.000482903902
  error estimate for blocks of size 2^( 7) =       0.000491574288

      target function =                  N/A
              le_mean =     -16.911145902019
             les_mean =     286.321391332111
             stat err =       0.000474343856
             autocorr =       1.345160115237
              std dev =       0.578390681125
             le_variance =       0.334535780012


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911145910729        initial  <--
     9.5367e+00     9.5367e+01             2.4911e-05       -16.911145781125
     3.8147e+01     3.8147e+02             6.2400e-06       -16.911145842520
     1.5259e+02     1.5259e+03             1.5607e-06       -16.911145902019

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8438
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 3.083703e-01 1 1  ON 0
 uu_1                 1.416758e-01 1 1  ON 1
 uu_2                 4.094141e-02 1 1  ON 2
 uu_3                -2.029662e-02 1 1  ON 3
 uu_4                -6.360964e-02 1 1  ON 4
 uu_5                -9.670866e-02 1 1  ON 5
 uu_6                -1.233241e-01 1 1  ON 6
 uu_7                -1.363790e-01 1 1  ON 7
 uu_8                -1.282905e-01 1 1  ON 8
 uu_9                -9.951021e-02 1 1  ON 9
 ud_0                 4.435017e-01 1 1  ON 10
 ud_1                 1.777443e-01 1 1  ON 11
 ud_2                 5.800578e-02 1 1  ON 12
 ud_3                -1.250317e-02 1 1  ON 13
 ud_4                -6.878440e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328842e-01 1 1  ON 16
 ud_7                -1.469909e-01 1 1  ON 17
 ud_8                -1.457593e-01 1 1  ON 18
 ud_9                -1.352398e-01 1 1  ON 19
 eO_0                -7.634938e-01 1 1  ON 20
 eO_1                -4.422447e-01 1 1  ON 21
 eO_2                -2.052851e-02 1 1  ON 22
 eO_3                 3.008182e-01 1 1  ON 23
 eO_4                 5.250642e-01 1 1  ON 24
 eO_5                 4.811693e-01 1 1  ON 25
 eO_6                 2.500489e-01 1 1  ON 26
 eO_7                -4.945313e-02 1 1  ON 27
 eO_8                -2.104194e-01 1 1  ON 28
 eO_9                -7.127103e-02 1 1  ON 29
eH1_0                -2.362968e-01 1 1  ON 30
eH1_1                -1.371896e-01 1 1  ON 31
eH1_2                -9.161609e-02 1 1  ON 32
eH1_3                -3.822997e-02 1 1  ON 33
eH1_4                 7.520896e-03 1 1  ON 34
eH1_5                 4.096956e-02 1 1  ON 35
eH1_6                 9.636263e-02 1 1  ON 36
eH1_7                 1.470441e-01 1 1  ON 37
eH1_8                 1.639051e-01 1 1  ON 38
eH1_9                 5.094316e-02 1 1  ON 39
eH2_0                -2.332746e-01 1 1  ON 40
eH2_1                -1.342060e-01 1 1  ON 41
eH2_2                -8.869909e-02 1 1  ON 42
eH2_3                -3.500463e-02 1 1  ON 43
eH2_4                 1.124839e-02 1 1  ON 44
eH2_5                 4.345483e-02 1 1  ON 45
eH2_6                 9.993503e-02 1 1  ON 46
eH2_7                 1.511973e-01 1 1  ON 47
eH2_8                 1.690089e-01 1 1  ON 48
eH2_9                 3.402636e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8145e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.9319
    reference variance = 0.323559
====================================================
  Execution time = 2.0921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3816e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338202151213
                                         uncertainty =       0.005366183993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338202151213
                                         uncertainty =       0.005366183993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411190489
  error estimate for blocks of size 2^( 2) =       0.000425153634
  error estimate for blocks of size 2^( 3) =       0.000440170146
  error estimate for blocks of size 2^( 4) =       0.000455733848
  error estimate for blocks of size 2^( 5) =       0.000471288081
  error estimate for blocks of size 2^( 6) =       0.000486033021
  error estimate for blocks of size 2^( 7) =       0.000497129146

      target function =                  N/A
              le_mean =     -16.910957567290
             les_mean =     286.318640909981
             stat err =       0.000477546024
             autocorr =       1.348790025600
              std dev =       0.581511166156
             le_variance =       0.338155236364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691095756729e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+01, overlap shift 9.5367e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910957567290       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910957575133       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910957580690       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910957582474       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910957588199       residual = 4.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910957596849       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910957595503       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+01 is 3.001159e-06

solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910957567290       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910957569253       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910957570645       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910957571091       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910957572523       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910957574683       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910957574351       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 7.505228e-07

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910957567290       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910957567781       residual = 4.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910957568129       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910957568242       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910957568599       residual = 4.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910957569139       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910957569056       residual = 9.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 1.876452e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.071514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6607e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.083701e-01 1 1  ON 0
 uu_1                 1.416759e-01 1 1  ON 1
 uu_2                 4.094166e-02 1 1  ON 2
 uu_3                -2.029664e-02 1 1  ON 3
 uu_4                -6.360996e-02 1 1  ON 4
 uu_5                -9.670846e-02 1 1  ON 5
 uu_6                -1.233243e-01 1 1  ON 6
 uu_7                -1.363790e-01 1 1  ON 7
 uu_8                -1.282905e-01 1 1  ON 8
 uu_9                -9.951025e-02 1 1  ON 9
 ud_0                 4.435015e-01 1 1  ON 10
 ud_1                 1.777444e-01 1 1  ON 11
 ud_2                 5.800585e-02 1 1  ON 12
 ud_3                -1.250320e-02 1 1  ON 13
 ud_4                -6.878426e-02 1 1  ON 14
 ud_5                -1.080318e-01 1 1  ON 15
 ud_6                -1.328843e-01 1 1  ON 16
 ud_7                -1.469905e-01 1 1  ON 17
 ud_8                -1.457593e-01 1 1  ON 18
 ud_9                -1.352399e-01 1 1  ON 19
 eO_0                -7.634945e-01 1 1  ON 20
 eO_1                -4.422449e-01 1 1  ON 21
 eO_2                -2.052872e-02 1 1  ON 22
 eO_3                 3.008182e-01 1 1  ON 23
 eO_4                 5.250644e-01 1 1  ON 24
 eO_5                 4.811701e-01 1 1  ON 25
 eO_6                 2.500494e-01 1 1  ON 26
 eO_7                -4.945285e-02 1 1  ON 27
 eO_8                -2.104197e-01 1 1  ON 28
 eO_9                -7.127141e-02 1 1  ON 29
eH1_0                -2.362971e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161655e-02 1 1  ON 32
eH1_3                -3.823021e-02 1 1  ON 33
eH1_4                 7.520830e-03 1 1  ON 34
eH1_5                 4.096952e-02 1 1  ON 35
eH1_6                 9.636287e-02 1 1  ON 36
eH1_7                 1.470443e-01 1 1  ON 37
eH1_8                 1.639055e-01 1 1  ON 38
eH1_9                 5.094356e-02 1 1  ON 39
eH2_0                -2.332747e-01 1 1  ON 40
eH2_1                -1.342059e-01 1 1  ON 41
eH2_2                -8.869933e-02 1 1  ON 42
eH2_3                -3.500508e-02 1 1  ON 43
eH2_4                 1.124839e-02 1 1  ON 44
eH2_5                 4.345502e-02 1 1  ON 45
eH2_6                 9.993471e-02 1 1  ON 46
eH2_7                 1.511972e-01 1 1  ON 47
eH2_8                 1.690092e-01 1 1  ON 48
eH2_9                 3.402695e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -16.8131
    reference variance = 0.215081
====================================================
  Execution time = 2.0107e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4212e-01
  Total weights = 2.0000e+06
  Execution time = 1.8805e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342149204327
                                         uncertainty =       0.007067978706

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342149204327
                                         uncertainty =       0.007067978706

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413591709
  error estimate for blocks of size 2^( 2) =       0.000427148645
  error estimate for blocks of size 2^( 3) =       0.000441998621
  error estimate for blocks of size 2^( 4) =       0.000456333881
  error estimate for blocks of size 2^( 5) =       0.000470633226
  error estimate for blocks of size 2^( 6) =       0.000480324084
  error estimate for blocks of size 2^( 7) =       0.000489572205

      target function =                  N/A
              le_mean =     -16.911396809754
             les_mean =     286.337458089831
             stat err =       0.000474215849
             autocorr =       1.314644958787
              std dev =       0.584907004505
             le_variance =       0.342116203918

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342148057167
                                         uncertainty =       0.007067943989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342148057167
                                         uncertainty =       0.007067943989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413591016
  error estimate for blocks of size 2^( 2) =       0.000427147984
  error estimate for blocks of size 2^( 3) =       0.000441997991
  error estimate for blocks of size 2^( 4) =       0.000456333258
  error estimate for blocks of size 2^( 5) =       0.000470632593
  error estimate for blocks of size 2^( 6) =       0.000480323454
  error estimate for blocks of size 2^( 7) =       0.000489571551

      target function =                  N/A
              le_mean =     -16.911396790765
             les_mean =     286.337456300613
             stat err =       0.000474215214
             autocorr =       1.314645844653
              std dev =       0.584906024065
             le_variance =       0.342115056988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342148628225
                                         uncertainty =       0.007067961317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342148628225
                                         uncertainty =       0.007067961317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413591361
  error estimate for blocks of size 2^( 2) =       0.000427148313
  error estimate for blocks of size 2^( 3) =       0.000441998305
  error estimate for blocks of size 2^( 4) =       0.000456333568
  error estimate for blocks of size 2^( 5) =       0.000470632908
  error estimate for blocks of size 2^( 6) =       0.000480323768
  error estimate for blocks of size 2^( 7) =       0.000489571877

      target function =                  N/A
              le_mean =     -16.911396800214
             les_mean =     286.337457191166
             stat err =       0.000474215530
             autocorr =       1.314645404485
              std dev =       0.584906512130
             le_variance =       0.342115627932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342149132232
                                         uncertainty =       0.007067976532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342149132232
                                         uncertainty =       0.007067976532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413591666
  error estimate for blocks of size 2^( 2) =       0.000427148604
  error estimate for blocks of size 2^( 3) =       0.000441998582
  error estimate for blocks of size 2^( 4) =       0.000456333842
  error estimate for blocks of size 2^( 5) =       0.000470633186
  error estimate for blocks of size 2^( 6) =       0.000480324045
  error estimate for blocks of size 2^( 7) =       0.000489572164

      target function =                  N/A
              le_mean =     -16.911396808560
             les_mean =     286.337457977355
             stat err =       0.000474215809
             autocorr =       1.314645014589
              std dev =       0.584906942888
             le_variance =       0.342116131838


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911396809754        initial  <--
     9.5367e+01     9.5367e+02             3.0012e-06       -16.911396790765
     3.8147e+02     3.8147e+03             7.5052e-07       -16.911396800214
     1.5259e+03     1.5259e+04             1.8765e-07       -16.911396808560

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5860
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 3.083703e-01 1 1  ON 0
 uu_1                 1.416758e-01 1 1  ON 1
 uu_2                 4.094141e-02 1 1  ON 2
 uu_3                -2.029662e-02 1 1  ON 3
 uu_4                -6.360964e-02 1 1  ON 4
 uu_5                -9.670866e-02 1 1  ON 5
 uu_6                -1.233241e-01 1 1  ON 6
 uu_7                -1.363790e-01 1 1  ON 7
 uu_8                -1.282905e-01 1 1  ON 8
 uu_9                -9.951021e-02 1 1  ON 9
 ud_0                 4.435017e-01 1 1  ON 10
 ud_1                 1.777443e-01 1 1  ON 11
 ud_2                 5.800578e-02 1 1  ON 12
 ud_3                -1.250317e-02 1 1  ON 13
 ud_4                -6.878440e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328842e-01 1 1  ON 16
 ud_7                -1.469909e-01 1 1  ON 17
 ud_8                -1.457593e-01 1 1  ON 18
 ud_9                -1.352398e-01 1 1  ON 19
 eO_0                -7.634938e-01 1 1  ON 20
 eO_1                -4.422447e-01 1 1  ON 21
 eO_2                -2.052851e-02 1 1  ON 22
 eO_3                 3.008182e-01 1 1  ON 23
 eO_4                 5.250642e-01 1 1  ON 24
 eO_5                 4.811693e-01 1 1  ON 25
 eO_6                 2.500489e-01 1 1  ON 26
 eO_7                -4.945313e-02 1 1  ON 27
 eO_8                -2.104194e-01 1 1  ON 28
 eO_9                -7.127103e-02 1 1  ON 29
eH1_0                -2.362968e-01 1 1  ON 30
eH1_1                -1.371896e-01 1 1  ON 31
eH1_2                -9.161609e-02 1 1  ON 32
eH1_3                -3.822997e-02 1 1  ON 33
eH1_4                 7.520896e-03 1 1  ON 34
eH1_5                 4.096956e-02 1 1  ON 35
eH1_6                 9.636263e-02 1 1  ON 36
eH1_7                 1.470441e-01 1 1  ON 37
eH1_8                 1.639051e-01 1 1  ON 38
eH1_9                 5.094316e-02 1 1  ON 39
eH2_0                -2.332746e-01 1 1  ON 40
eH2_1                -1.342060e-01 1 1  ON 41
eH2_2                -8.869909e-02 1 1  ON 42
eH2_3                -3.500463e-02 1 1  ON 43
eH2_4                 1.124839e-02 1 1  ON 44
eH2_5                 4.345483e-02 1 1  ON 45
eH2_6                 9.993503e-02 1 1  ON 46
eH2_7                 1.511973e-01 1 1  ON 47
eH2_8                 1.690089e-01 1 1  ON 48
eH2_9                 3.402636e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6200e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9629
    reference variance = 0.284113
====================================================
  Execution time = 2.0674e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5026e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350185018366
                                         uncertainty =       0.008517969950

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.350185018366
                                         uncertainty =       0.008517969950

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418484285
  error estimate for blocks of size 2^( 2) =       0.000431598149
  error estimate for blocks of size 2^( 3) =       0.000445658595
  error estimate for blocks of size 2^( 4) =       0.000460529414
  error estimate for blocks of size 2^( 5) =       0.000475155416
  error estimate for blocks of size 2^( 6) =       0.000486279968
  error estimate for blocks of size 2^( 7) =       0.000493851483

      target function =                  N/A
              le_mean =     -16.911151843195
             les_mean =     286.337314681722
             stat err =       0.000478954070
             autocorr =       1.309873720903
              std dev =       0.591826151218
             le_variance =       0.350258193265


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691115184319e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911151843195       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911151843238       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911151843440       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911151843761       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911151844225       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911151844278       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911151843992       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911151844107       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.605170e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911151843195       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911151843206       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911151843256       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911151843336       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911151843452       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911151843475       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911151843394       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911151843425       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 6.513013e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911151843195       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911151843197       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911151843210       residual = 1.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911151843230       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911151843242       residual = 8.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911151843265       residual = 8.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911151843247       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911151843249       residual = 3.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 1.628259e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.074112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6282e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.083703e-01 1 1  ON 0
 uu_1                 1.416759e-01 1 1  ON 1
 uu_2                 4.094145e-02 1 1  ON 2
 uu_3                -2.029660e-02 1 1  ON 3
 uu_4                -6.360965e-02 1 1  ON 4
 uu_5                -9.670867e-02 1 1  ON 5
 uu_6                -1.233241e-01 1 1  ON 6
 uu_7                -1.363790e-01 1 1  ON 7
 uu_8                -1.282906e-01 1 1  ON 8
 uu_9                -9.951023e-02 1 1  ON 9
 ud_0                 4.435017e-01 1 1  ON 10
 ud_1                 1.777443e-01 1 1  ON 11
 ud_2                 5.800580e-02 1 1  ON 12
 ud_3                -1.250317e-02 1 1  ON 13
 ud_4                -6.878439e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328842e-01 1 1  ON 16
 ud_7                -1.469909e-01 1 1  ON 17
 ud_8                -1.457593e-01 1 1  ON 18
 ud_9                -1.352399e-01 1 1  ON 19
 eO_0                -7.634938e-01 1 1  ON 20
 eO_1                -4.422447e-01 1 1  ON 21
 eO_2                -2.052850e-02 1 1  ON 22
 eO_3                 3.008182e-01 1 1  ON 23
 eO_4                 5.250642e-01 1 1  ON 24
 eO_5                 4.811694e-01 1 1  ON 25
 eO_6                 2.500489e-01 1 1  ON 26
 eO_7                -4.945311e-02 1 1  ON 27
 eO_8                -2.104194e-01 1 1  ON 28
 eO_9                -7.127107e-02 1 1  ON 29
eH1_0                -2.362968e-01 1 1  ON 30
eH1_1                -1.371896e-01 1 1  ON 31
eH1_2                -9.161609e-02 1 1  ON 32
eH1_3                -3.823000e-02 1 1  ON 33
eH1_4                 7.520909e-03 1 1  ON 34
eH1_5                 4.096954e-02 1 1  ON 35
eH1_6                 9.636262e-02 1 1  ON 36
eH1_7                 1.470441e-01 1 1  ON 37
eH1_8                 1.639052e-01 1 1  ON 38
eH1_9                 5.094319e-02 1 1  ON 39
eH2_0                -2.332746e-01 1 1  ON 40
eH2_1                -1.342061e-01 1 1  ON 41
eH2_2                -8.869908e-02 1 1  ON 42
eH2_3                -3.500464e-02 1 1  ON 43
eH2_4                 1.124837e-02 1 1  ON 44
eH2_5                 4.345483e-02 1 1  ON 45
eH2_6                 9.993502e-02 1 1  ON 46
eH2_7                 1.511973e-01 1 1  ON 47
eH2_8                 1.690089e-01 1 1  ON 48
eH2_9                 3.402641e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -16.9616
    reference variance = 0.272437
====================================================
  Execution time = 2.0272e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5629e-01
  Total weights = 2.0000e+06
  Execution time = 1.8734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355741713258
                                         uncertainty =       0.021607371642

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355741713258
                                         uncertainty =       0.021607371642

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422070925
  error estimate for blocks of size 2^( 2) =       0.000435152279
  error estimate for blocks of size 2^( 3) =       0.000449658948
  error estimate for blocks of size 2^( 4) =       0.000464380389
  error estimate for blocks of size 2^( 5) =       0.000478246009
  error estimate for blocks of size 2^( 6) =       0.000492920015
  error estimate for blocks of size 2^( 7) =       0.000502590229

      target function =                  N/A
              le_mean =     -16.910546433359
             les_mean =     286.322868228517
             stat err =       0.000484534160
             autocorr =       1.317886256951
              std dev =       0.596898426755
             le_variance =       0.356287731863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355741680218
                                         uncertainty =       0.021607372904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355741680218
                                         uncertainty =       0.021607372904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422070906
  error estimate for blocks of size 2^( 2) =       0.000435152258
  error estimate for blocks of size 2^( 3) =       0.000449658927
  error estimate for blocks of size 2^( 4) =       0.000464380367
  error estimate for blocks of size 2^( 5) =       0.000478245985
  error estimate for blocks of size 2^( 6) =       0.000492919990
  error estimate for blocks of size 2^( 7) =       0.000502590206

      target function =                  N/A
              le_mean =     -16.910546434166
             les_mean =     286.322868222726
             stat err =       0.000484534137
             autocorr =       1.317886252318
              std dev =       0.596898399061
             le_variance =       0.356287698801

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355741696734
                                         uncertainty =       0.021607372273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355741696734
                                         uncertainty =       0.021607372273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422070915
  error estimate for blocks of size 2^( 2) =       0.000435152268
  error estimate for blocks of size 2^( 3) =       0.000449658938
  error estimate for blocks of size 2^( 4) =       0.000464380378
  error estimate for blocks of size 2^( 5) =       0.000478245997
  error estimate for blocks of size 2^( 6) =       0.000492920002
  error estimate for blocks of size 2^( 7) =       0.000502590218

      target function =                  N/A
              le_mean =     -16.910546433763
             les_mean =     286.322868225628
             stat err =       0.000484534149
             autocorr =       1.317886254635
              std dev =       0.596898412905
             le_variance =       0.356287715328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355741711192
                                         uncertainty =       0.021607371721

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.355741711192
                                         uncertainty =       0.021607371721

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422070924
  error estimate for blocks of size 2^( 2) =       0.000435152277
  error estimate for blocks of size 2^( 3) =       0.000449658947
  error estimate for blocks of size 2^( 4) =       0.000464380388
  error estimate for blocks of size 2^( 5) =       0.000478246007
  error estimate for blocks of size 2^( 6) =       0.000492920013
  error estimate for blocks of size 2^( 7) =       0.000502590228

      target function =                  N/A
              le_mean =     -16.910546433410
             les_mean =     286.322868228156
             stat err =       0.000484534159
             autocorr =       1.317886256668
              std dev =       0.596898425024
             le_variance =       0.356287729796


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910546433359        initial
     9.5367e+02     9.5367e+03             2.6052e-07       -16.910546434166  <--
     3.8147e+03     3.8147e+04             6.5130e-08       -16.910546433763
     1.5259e+04     1.5259e+05             1.6283e-08       -16.910546433410

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 2.9724e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 3.083702e-01 1 1  ON 0
 uu_1                 1.416759e-01 1 1  ON 1
 uu_2                 4.094156e-02 1 1  ON 2
 uu_3                -2.029657e-02 1 1  ON 3
 uu_4                -6.360971e-02 1 1  ON 4
 uu_5                -9.670870e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363791e-01 1 1  ON 7
 uu_8                -1.282908e-01 1 1  ON 8
 uu_9                -9.951032e-02 1 1  ON 9
 ud_0                 4.435017e-01 1 1  ON 10
 ud_1                 1.777442e-01 1 1  ON 11
 ud_2                 5.800583e-02 1 1  ON 12
 ud_3                -1.250318e-02 1 1  ON 13
 ud_4                -6.878437e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328841e-01 1 1  ON 16
 ud_7                -1.469908e-01 1 1  ON 17
 ud_8                -1.457594e-01 1 1  ON 18
 ud_9                -1.352399e-01 1 1  ON 19
 eO_0                -7.634940e-01 1 1  ON 20
 eO_1                -4.422447e-01 1 1  ON 21
 eO_2                -2.052845e-02 1 1  ON 22
 eO_3                 3.008182e-01 1 1  ON 23
 eO_4                 5.250643e-01 1 1  ON 24
 eO_5                 4.811696e-01 1 1  ON 25
 eO_6                 2.500491e-01 1 1  ON 26
 eO_7                -4.945307e-02 1 1  ON 27
 eO_8                -2.104196e-01 1 1  ON 28
 eO_9                -7.127117e-02 1 1  ON 29
eH1_0                -2.362969e-01 1 1  ON 30
eH1_1                -1.371896e-01 1 1  ON 31
eH1_2                -9.161609e-02 1 1  ON 32
eH1_3                -3.823009e-02 1 1  ON 33
eH1_4                 7.520946e-03 1 1  ON 34
eH1_5                 4.096950e-02 1 1  ON 35
eH1_6                 9.636259e-02 1 1  ON 36
eH1_7                 1.470441e-01 1 1  ON 37
eH1_8                 1.639053e-01 1 1  ON 38
eH1_9                 5.094329e-02 1 1  ON 39
eH2_0                -2.332747e-01 1 1  ON 40
eH2_1                -1.342062e-01 1 1  ON 41
eH2_2                -8.869905e-02 1 1  ON 42
eH2_3                -3.500466e-02 1 1  ON 43
eH2_4                 1.124832e-02 1 1  ON 44
eH2_5                 4.345482e-02 1 1  ON 45
eH2_6                 9.993496e-02 1 1  ON 46
eH2_7                 1.511974e-01 1 1  ON 47
eH2_8                 1.690090e-01 1 1  ON 48
eH2_9                 3.402653e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6012e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9208
    reference variance = 0.377884
====================================================
  Execution time = 2.0772e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4605e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5190e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346037762200
                                         uncertainty =       0.006832666022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.346037762200
                                         uncertainty =       0.006832666022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415962544
  error estimate for blocks of size 2^( 2) =       0.000429629323
  error estimate for blocks of size 2^( 3) =       0.000444295111
  error estimate for blocks of size 2^( 4) =       0.000459434708
  error estimate for blocks of size 2^( 5) =       0.000474431067
  error estimate for blocks of size 2^( 6) =       0.000486661795
  error estimate for blocks of size 2^( 7) =       0.000493449678

      target function =                  N/A
              le_mean =     -16.911433218638
             les_mean =     286.342623011692
             stat err =       0.000478494312
             autocorr =       1.323259765437
              std dev =       0.588259871374
             le_variance =       0.346049676269


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691143321864e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911433218638       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911433221212       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911433222270       residual = 7.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911433223776       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911433223932       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911433223293       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911433222565       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911433222828       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.148980e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911433218638       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911433219282       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911433219547       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911433219923       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911433219961       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911433219802       residual = 7.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911433219619       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911433219686       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.872699e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911433218638       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911433218799       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911433218865       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911433218959       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911433218969       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911433218927       residual = 7.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911433218884       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911433218895       residual = 3.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 7.181904e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076794 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6299e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.083702e-01 1 1  ON 0
 uu_1                 1.416760e-01 1 1  ON 1
 uu_2                 4.094178e-02 1 1  ON 2
 uu_3                -2.029656e-02 1 1  ON 3
 uu_4                -6.360985e-02 1 1  ON 4
 uu_5                -9.670860e-02 1 1  ON 5
 uu_6                -1.233241e-01 1 1  ON 6
 uu_7                -1.363791e-01 1 1  ON 7
 uu_8                -1.282909e-01 1 1  ON 8
 uu_9                -9.951048e-02 1 1  ON 9
 ud_0                 4.435017e-01 1 1  ON 10
 ud_1                 1.777443e-01 1 1  ON 11
 ud_2                 5.800583e-02 1 1  ON 12
 ud_3                -1.250310e-02 1 1  ON 13
 ud_4                -6.878424e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328840e-01 1 1  ON 16
 ud_7                -1.469908e-01 1 1  ON 17
 ud_8                -1.457595e-01 1 1  ON 18
 ud_9                -1.352400e-01 1 1  ON 19
 eO_0                -7.634942e-01 1 1  ON 20
 eO_1                -4.422448e-01 1 1  ON 21
 eO_2                -2.052857e-02 1 1  ON 22
 eO_3                 3.008182e-01 1 1  ON 23
 eO_4                 5.250644e-01 1 1  ON 24
 eO_5                 4.811699e-01 1 1  ON 25
 eO_6                 2.500493e-01 1 1  ON 26
 eO_7                -4.945296e-02 1 1  ON 27
 eO_8                -2.104198e-01 1 1  ON 28
 eO_9                -7.127134e-02 1 1  ON 29
eH1_0                -2.362970e-01 1 1  ON 30
eH1_1                -1.371897e-01 1 1  ON 31
eH1_2                -9.161622e-02 1 1  ON 32
eH1_3                -3.823005e-02 1 1  ON 33
eH1_4                 7.521028e-03 1 1  ON 34
eH1_5                 4.096944e-02 1 1  ON 35
eH1_6                 9.636261e-02 1 1  ON 36
eH1_7                 1.470442e-01 1 1  ON 37
eH1_8                 1.639054e-01 1 1  ON 38
eH1_9                 5.094341e-02 1 1  ON 39
eH2_0                -2.332748e-01 1 1  ON 40
eH2_1                -1.342064e-01 1 1  ON 41
eH2_2                -8.869909e-02 1 1  ON 42
eH2_3                -3.500467e-02 1 1  ON 43
eH2_4                 1.124830e-02 1 1  ON 44
eH2_5                 4.345491e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511975e-01 1 1  ON 47
eH2_8                 1.690092e-01 1 1  ON 48
eH2_9                 3.402668e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -16.9297
    reference variance = 0.197772
====================================================
  Execution time = 2.0194e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3434e-01
  Total weights = 2.0000e+06
  Execution time = 1.8746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334396400901
                                         uncertainty =       0.004041477294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334396400901
                                         uncertainty =       0.004041477294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408865963
  error estimate for blocks of size 2^( 2) =       0.000422467360
  error estimate for blocks of size 2^( 3) =       0.000436763587
  error estimate for blocks of size 2^( 4) =       0.000451832882
  error estimate for blocks of size 2^( 5) =       0.000467323803
  error estimate for blocks of size 2^( 6) =       0.000480926052
  error estimate for blocks of size 2^( 7) =       0.000493969643

      target function =                  N/A
              le_mean =     -16.910807922059
             les_mean =     286.309767160810
             stat err =       0.000473513095
             autocorr =       1.341226332730
              std dev =       0.578223789889
             le_variance =       0.334342751194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334395719842
                                         uncertainty =       0.004041464454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334395719842
                                         uncertainty =       0.004041464454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408865547
  error estimate for blocks of size 2^( 2) =       0.000422466958
  error estimate for blocks of size 2^( 3) =       0.000436763192
  error estimate for blocks of size 2^( 4) =       0.000451832487
  error estimate for blocks of size 2^( 5) =       0.000467323418
  error estimate for blocks of size 2^( 6) =       0.000480925668
  error estimate for blocks of size 2^( 7) =       0.000493969265

      target function =                  N/A
              le_mean =     -16.910807926408
             les_mean =     286.309766627354
             stat err =       0.000473512710
             autocorr =       1.341226879978
              std dev =       0.578223201409
             le_variance =       0.334342070648

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334396059813
                                         uncertainty =       0.004041470865

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334396059813
                                         uncertainty =       0.004041470865

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408865754
  error estimate for blocks of size 2^( 2) =       0.000422467159
  error estimate for blocks of size 2^( 3) =       0.000436763389
  error estimate for blocks of size 2^( 4) =       0.000451832684
  error estimate for blocks of size 2^( 5) =       0.000467323610
  error estimate for blocks of size 2^( 6) =       0.000480925860
  error estimate for blocks of size 2^( 7) =       0.000493969454

      target function =                  N/A
              le_mean =     -16.910807924238
             les_mean =     286.309766893664
             stat err =       0.000473512902
             autocorr =       1.341226606851
              std dev =       0.578223495167
             le_variance =       0.334342410363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334396358247
                                         uncertainty =       0.004041476490

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.334396358247
                                         uncertainty =       0.004041476490

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408865937
  error estimate for blocks of size 2^( 2) =       0.000422467335
  error estimate for blocks of size 2^( 3) =       0.000436763562
  error estimate for blocks of size 2^( 4) =       0.000451832857
  error estimate for blocks of size 2^( 5) =       0.000467323779
  error estimate for blocks of size 2^( 6) =       0.000480926028
  error estimate for blocks of size 2^( 7) =       0.000493969620

      target function =                  N/A
              le_mean =     -16.910807922332
             les_mean =     286.309767127400
             stat err =       0.000473513071
             autocorr =       1.341226367012
              std dev =       0.578223753033
             le_variance =       0.334342708572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910807922059        initial
     2.3842e+02     2.3842e+03             1.1490e-06       -16.910807926408  <--
     9.5367e+02     9.5367e+03             2.8727e-07       -16.910807924238
     3.8147e+03     3.8147e+04             7.1819e-08       -16.910807922332

*****************************************************************************
Applying the update for shift_i =   2.3842e+02     and shift_s =   2.3842e+03
*****************************************************************************

  Execution time = 2.9691e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 3.083701e-01 1 1  ON 0
 uu_1                 1.416761e-01 1 1  ON 1
 uu_2                 4.094244e-02 1 1  ON 2
 uu_3                -2.029654e-02 1 1  ON 3
 uu_4                -6.361029e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233242e-01 1 1  ON 6
 uu_7                -1.363790e-01 1 1  ON 7
 uu_8                -1.282912e-01 1 1  ON 8
 uu_9                -9.951097e-02 1 1  ON 9
 ud_0                 4.435014e-01 1 1  ON 10
 ud_1                 1.777446e-01 1 1  ON 11
 ud_2                 5.800583e-02 1 1  ON 12
 ud_3                -1.250285e-02 1 1  ON 13
 ud_4                -6.878385e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328840e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457597e-01 1 1  ON 18
 ud_9                -1.352404e-01 1 1  ON 19
 eO_0                -7.634947e-01 1 1  ON 20
 eO_1                -4.422450e-01 1 1  ON 21
 eO_2                -2.052892e-02 1 1  ON 22
 eO_3                 3.008184e-01 1 1  ON 23
 eO_4                 5.250646e-01 1 1  ON 24
 eO_5                 4.811707e-01 1 1  ON 25
 eO_6                 2.500499e-01 1 1  ON 26
 eO_7                -4.945261e-02 1 1  ON 27
 eO_8                -2.104203e-01 1 1  ON 28
 eO_9                -7.127185e-02 1 1  ON 29
eH1_0                -2.362974e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161660e-02 1 1  ON 32
eH1_3                -3.822992e-02 1 1  ON 33
eH1_4                 7.521274e-03 1 1  ON 34
eH1_5                 4.096923e-02 1 1  ON 35
eH1_6                 9.636265e-02 1 1  ON 36
eH1_7                 1.470443e-01 1 1  ON 37
eH1_8                 1.639057e-01 1 1  ON 38
eH1_9                 5.094375e-02 1 1  ON 39
eH2_0                -2.332753e-01 1 1  ON 40
eH2_1                -1.342069e-01 1 1  ON 41
eH2_2                -8.869919e-02 1 1  ON 42
eH2_3                -3.500471e-02 1 1  ON 43
eH2_4                 1.124826e-02 1 1  ON 44
eH2_5                 4.345518e-02 1 1  ON 45
eH2_6                 9.993485e-02 1 1  ON 46
eH2_7                 1.511977e-01 1 1  ON 47
eH2_8                 1.690095e-01 1 1  ON 48
eH2_9                 3.402711e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9284
    reference variance = 0.307052
====================================================
  Execution time = 2.0844e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.8563e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385800315086
                                         uncertainty =       0.041434209102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.385800315086
                                         uncertainty =       0.041434209102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439105426
  error estimate for blocks of size 2^( 2) =       0.000451500875
  error estimate for blocks of size 2^( 3) =       0.000465135144
  error estimate for blocks of size 2^( 4) =       0.000478739398
  error estimate for blocks of size 2^( 5) =       0.000492672162
  error estimate for blocks of size 2^( 6) =       0.000504406520
  error estimate for blocks of size 2^( 7) =       0.000512860784

      target function =                  N/A
              le_mean =     -16.911044197112
             les_mean =     286.369042794253
             stat err =       0.000497169716
             autocorr =       1.281951885670
              std dev =       0.620988848859
             le_variance =       0.385627150407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691104419711e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+01, overlap shift 5.9605e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911044197112       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911044204233       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911044203031       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911044201247       residual = 8.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911044194647       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911044193539       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911044196792       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+01 is 4.575189e-06

solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911044197112       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911044198895       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911044198591       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911044198143       residual = 8.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911044196493       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911044196218       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911044197030       residual = 7.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+02 is 1.144201e-06

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911044197112       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911044197558       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911044197481       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911044197369       residual = 8.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911044196957       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911044196888       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911044197091       residual = 7.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+02 is 2.860756e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.079076 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6333e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.083699e-01 1 1  ON 0
 uu_1                 1.416764e-01 1 1  ON 1
 uu_2                 4.094255e-02 1 1  ON 2
 uu_3                -2.029619e-02 1 1  ON 3
 uu_4                -6.361095e-02 1 1  ON 4
 uu_5                -9.670826e-02 1 1  ON 5
 uu_6                -1.233244e-01 1 1  ON 6
 uu_7                -1.363788e-01 1 1  ON 7
 uu_8                -1.282918e-01 1 1  ON 8
 uu_9                -9.951130e-02 1 1  ON 9
 ud_0                 4.435017e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800574e-02 1 1  ON 12
 ud_3                -1.250291e-02 1 1  ON 13
 ud_4                -6.878374e-02 1 1  ON 14
 ud_5                -1.080316e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457602e-01 1 1  ON 18
 ud_9                -1.352405e-01 1 1  ON 19
 eO_0                -7.634956e-01 1 1  ON 20
 eO_1                -4.422450e-01 1 1  ON 21
 eO_2                -2.052936e-02 1 1  ON 22
 eO_3                 3.008184e-01 1 1  ON 23
 eO_4                 5.250649e-01 1 1  ON 24
 eO_5                 4.811719e-01 1 1  ON 25
 eO_6                 2.500506e-01 1 1  ON 26
 eO_7                -4.945227e-02 1 1  ON 27
 eO_8                -2.104210e-01 1 1  ON 28
 eO_9                -7.127241e-02 1 1  ON 29
eH1_0                -2.362980e-01 1 1  ON 30
eH1_1                -1.371899e-01 1 1  ON 31
eH1_2                -9.161655e-02 1 1  ON 32
eH1_3                -3.822977e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096867e-02 1 1  ON 35
eH1_6                 9.636297e-02 1 1  ON 36
eH1_7                 1.470444e-01 1 1  ON 37
eH1_8                 1.639061e-01 1 1  ON 38
eH1_9                 5.094424e-02 1 1  ON 39
eH2_0                -2.332759e-01 1 1  ON 40
eH2_1                -1.342076e-01 1 1  ON 41
eH2_2                -8.869920e-02 1 1  ON 42
eH2_3                -3.500490e-02 1 1  ON 43
eH2_4                 1.124792e-02 1 1  ON 44
eH2_5                 4.345529e-02 1 1  ON 45
eH2_6                 9.993448e-02 1 1  ON 46
eH2_7                 1.511978e-01 1 1  ON 47
eH2_8                 1.690104e-01 1 1  ON 48
eH2_9                 3.402816e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -16.9094
    reference variance = 0.216383
====================================================
  Execution time = 2.0158e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3751e-01
  Total weights = 2.0000e+06
  Execution time = 1.8722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337554438267
                                         uncertainty =       0.003843610984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337554438267
                                         uncertainty =       0.003843610984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410796018
  error estimate for blocks of size 2^( 2) =       0.000424301625
  error estimate for blocks of size 2^( 3) =       0.000438840545
  error estimate for blocks of size 2^( 4) =       0.000452848292
  error estimate for blocks of size 2^( 5) =       0.000467230791
  error estimate for blocks of size 2^( 6) =       0.000482493172
  error estimate for blocks of size 2^( 7) =       0.000495498658

      target function =                  N/A
              le_mean =     -16.911165120515
             les_mean =     286.325012301467
             stat err =       0.000474517728
             autocorr =       1.334296770657
              std dev =       0.580953300089
             le_variance =       0.337506736885

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337555512386
                                         uncertainty =       0.003843632499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337555512386
                                         uncertainty =       0.003843632499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410796672
  error estimate for blocks of size 2^( 2) =       0.000424302229
  error estimate for blocks of size 2^( 3) =       0.000438841135
  error estimate for blocks of size 2^( 4) =       0.000452848837
  error estimate for blocks of size 2^( 5) =       0.000467231314
  error estimate for blocks of size 2^( 6) =       0.000482493636
  error estimate for blocks of size 2^( 7) =       0.000495499145

      target function =                  N/A
              le_mean =     -16.911165107519
             les_mean =     286.325012936000
             stat err =       0.000474518233
             autocorr =       1.334295361697
              std dev =       0.580954224519
             le_variance =       0.337507810987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337554978936
                                         uncertainty =       0.003843621809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337554978936
                                         uncertainty =       0.003843621809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410796347
  error estimate for blocks of size 2^( 2) =       0.000424301929
  error estimate for blocks of size 2^( 3) =       0.000438840842
  error estimate for blocks of size 2^( 4) =       0.000452848566
  error estimate for blocks of size 2^( 5) =       0.000467231054
  error estimate for blocks of size 2^( 6) =       0.000482493406
  error estimate for blocks of size 2^( 7) =       0.000495498904

      target function =                  N/A
              le_mean =     -16.911165113992
             les_mean =     286.325012621492
             stat err =       0.000474517983
             autocorr =       1.334296062367
              std dev =       0.580953765412
             le_variance =       0.337507277547

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337554505959
                                         uncertainty =       0.003843612339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337554505959
                                         uncertainty =       0.003843612339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410796059
  error estimate for blocks of size 2^( 2) =       0.000424301663
  error estimate for blocks of size 2^( 3) =       0.000438840582
  error estimate for blocks of size 2^( 4) =       0.000452848326
  error estimate for blocks of size 2^( 5) =       0.000467230824
  error estimate for blocks of size 2^( 6) =       0.000482493202
  error estimate for blocks of size 2^( 7) =       0.000495498689

      target function =                  N/A
              le_mean =     -16.911165119699
             les_mean =     286.325012341532
             stat err =       0.000474517760
             autocorr =       1.334296682010
              std dev =       0.580953358348
             le_variance =       0.337506804576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911165120515        initial  <--
     5.9605e+01     5.9605e+02             4.5752e-06       -16.911165107519
     2.3842e+02     2.3842e+03             1.1442e-06       -16.911165113992
     9.5367e+02     9.5367e+03             2.8608e-07       -16.911165119699

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5937
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 3.083701e-01 1 1  ON 0
 uu_1                 1.416761e-01 1 1  ON 1
 uu_2                 4.094244e-02 1 1  ON 2
 uu_3                -2.029654e-02 1 1  ON 3
 uu_4                -6.361029e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233242e-01 1 1  ON 6
 uu_7                -1.363790e-01 1 1  ON 7
 uu_8                -1.282912e-01 1 1  ON 8
 uu_9                -9.951097e-02 1 1  ON 9
 ud_0                 4.435014e-01 1 1  ON 10
 ud_1                 1.777446e-01 1 1  ON 11
 ud_2                 5.800583e-02 1 1  ON 12
 ud_3                -1.250285e-02 1 1  ON 13
 ud_4                -6.878385e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328840e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457597e-01 1 1  ON 18
 ud_9                -1.352404e-01 1 1  ON 19
 eO_0                -7.634947e-01 1 1  ON 20
 eO_1                -4.422450e-01 1 1  ON 21
 eO_2                -2.052892e-02 1 1  ON 22
 eO_3                 3.008184e-01 1 1  ON 23
 eO_4                 5.250646e-01 1 1  ON 24
 eO_5                 4.811707e-01 1 1  ON 25
 eO_6                 2.500499e-01 1 1  ON 26
 eO_7                -4.945261e-02 1 1  ON 27
 eO_8                -2.104203e-01 1 1  ON 28
 eO_9                -7.127185e-02 1 1  ON 29
eH1_0                -2.362974e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161660e-02 1 1  ON 32
eH1_3                -3.822992e-02 1 1  ON 33
eH1_4                 7.521274e-03 1 1  ON 34
eH1_5                 4.096923e-02 1 1  ON 35
eH1_6                 9.636265e-02 1 1  ON 36
eH1_7                 1.470443e-01 1 1  ON 37
eH1_8                 1.639057e-01 1 1  ON 38
eH1_9                 5.094375e-02 1 1  ON 39
eH2_0                -2.332753e-01 1 1  ON 40
eH2_1                -1.342069e-01 1 1  ON 41
eH2_2                -8.869919e-02 1 1  ON 42
eH2_3                -3.500471e-02 1 1  ON 43
eH2_4                 1.124826e-02 1 1  ON 44
eH2_5                 4.345518e-02 1 1  ON 45
eH2_6                 9.993485e-02 1 1  ON 46
eH2_7                 1.511977e-01 1 1  ON 47
eH2_8                 1.690095e-01 1 1  ON 48
eH2_9                 3.402711e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5933e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9604
    reference variance = 0.430001
====================================================
  Execution time = 2.0980e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3548e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335276252708
                                         uncertainty =       0.003085189168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335276252708
                                         uncertainty =       0.003085189168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409560833
  error estimate for blocks of size 2^( 2) =       0.000423267834
  error estimate for blocks of size 2^( 3) =       0.000437892161
  error estimate for blocks of size 2^( 4) =       0.000453118866
  error estimate for blocks of size 2^( 5) =       0.000468015182
  error estimate for blocks of size 2^( 6) =       0.000481816464
  error estimate for blocks of size 2^( 7) =       0.000491069819

      target function =                  N/A
              le_mean =     -16.910300146708
             les_mean =     286.293731035910
             stat err =       0.000473505083
             autocorr =       1.336633849310
              std dev =       0.579206484689
             le_variance =       0.335480151906


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691030014671e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910300146708       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910300147424       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910300147934       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910300148433       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910300147589       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910300147592       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910300148082       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910300148154       residual = 4.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.734766e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910300146708       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910300146887       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910300147014       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910300147139       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910300146928       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910300146929       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910300147051       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910300147069       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.183728e-07

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910300146708       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910300146753       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910300146784       residual = 2.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910300146816       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910300146761       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910300146763       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910300146792       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910300146801       residual = 3.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+03 is 2.959344e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.081764 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8547e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.083701e-01 1 1  ON 0
 uu_1                 1.416761e-01 1 1  ON 1
 uu_2                 4.094249e-02 1 1  ON 2
 uu_3                -2.029653e-02 1 1  ON 3
 uu_4                -6.361036e-02 1 1  ON 4
 uu_5                -9.670826e-02 1 1  ON 5
 uu_6                -1.233241e-01 1 1  ON 6
 uu_7                -1.363790e-01 1 1  ON 7
 uu_8                -1.282913e-01 1 1  ON 8
 uu_9                -9.951102e-02 1 1  ON 9
 ud_0                 4.435014e-01 1 1  ON 10
 ud_1                 1.777447e-01 1 1  ON 11
 ud_2                 5.800581e-02 1 1  ON 12
 ud_3                -1.250285e-02 1 1  ON 13
 ud_4                -6.878381e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328839e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457597e-01 1 1  ON 18
 ud_9                -1.352404e-01 1 1  ON 19
 eO_0                -7.634947e-01 1 1  ON 20
 eO_1                -4.422451e-01 1 1  ON 21
 eO_2                -2.052895e-02 1 1  ON 22
 eO_3                 3.008184e-01 1 1  ON 23
 eO_4                 5.250647e-01 1 1  ON 24
 eO_5                 4.811708e-01 1 1  ON 25
 eO_6                 2.500500e-01 1 1  ON 26
 eO_7                -4.945258e-02 1 1  ON 27
 eO_8                -2.104204e-01 1 1  ON 28
 eO_9                -7.127192e-02 1 1  ON 29
eH1_0                -2.362974e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161669e-02 1 1  ON 32
eH1_3                -3.822992e-02 1 1  ON 33
eH1_4                 7.521223e-03 1 1  ON 34
eH1_5                 4.096922e-02 1 1  ON 35
eH1_6                 9.636267e-02 1 1  ON 36
eH1_7                 1.470443e-01 1 1  ON 37
eH1_8                 1.639057e-01 1 1  ON 38
eH1_9                 5.094381e-02 1 1  ON 39
eH2_0                -2.332753e-01 1 1  ON 40
eH2_1                -1.342069e-01 1 1  ON 41
eH2_2                -8.869924e-02 1 1  ON 42
eH2_3                -3.500468e-02 1 1  ON 43
eH2_4                 1.124822e-02 1 1  ON 44
eH2_5                 4.345516e-02 1 1  ON 45
eH2_6                 9.993483e-02 1 1  ON 46
eH2_7                 1.511977e-01 1 1  ON 47
eH2_8                 1.690096e-01 1 1  ON 48
eH2_9                 3.402720e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -16.9318
    reference variance = 0.582572
====================================================
  Execution time = 2.0364e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3587e-01
  Total weights = 2.0000e+06
  Execution time = 1.8800e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335773415904
                                         uncertainty =       0.002962609980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335773415904
                                         uncertainty =       0.002962609980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409800427
  error estimate for blocks of size 2^( 2) =       0.000423466236
  error estimate for blocks of size 2^( 3) =       0.000439021589
  error estimate for blocks of size 2^( 4) =       0.000454174409
  error estimate for blocks of size 2^( 5) =       0.000470258243
  error estimate for blocks of size 2^( 6) =       0.000483313812
  error estimate for blocks of size 2^( 7) =       0.000494731971

      target function =                  N/A
              le_mean =     -16.910189702520
             les_mean =     286.290388386942
             stat err =       0.000475619609
             autocorr =       1.347022002505
              std dev =       0.579545321500
             le_variance =       0.335872779672

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335773363012
                                         uncertainty =       0.002962608025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335773363012
                                         uncertainty =       0.002962608025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409800395
  error estimate for blocks of size 2^( 2) =       0.000423466202
  error estimate for blocks of size 2^( 3) =       0.000439021551
  error estimate for blocks of size 2^( 4) =       0.000454174371
  error estimate for blocks of size 2^( 5) =       0.000470258203
  error estimate for blocks of size 2^( 6) =       0.000483313769
  error estimate for blocks of size 2^( 7) =       0.000494731934

      target function =                  N/A
              le_mean =     -16.910189703440
             les_mean =     286.290388365267
             stat err =       0.000475619569
             autocorr =       1.347021990672
              std dev =       0.579545275954
             le_variance =       0.335872726881

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335773389438
                                         uncertainty =       0.002962609002

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335773389438
                                         uncertainty =       0.002962609002

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409800411
  error estimate for blocks of size 2^( 2) =       0.000423466219
  error estimate for blocks of size 2^( 3) =       0.000439021570
  error estimate for blocks of size 2^( 4) =       0.000454174390
  error estimate for blocks of size 2^( 5) =       0.000470258223
  error estimate for blocks of size 2^( 6) =       0.000483313791
  error estimate for blocks of size 2^( 7) =       0.000494731952

      target function =                  N/A
              le_mean =     -16.910189702980
             les_mean =     286.290388376094
             stat err =       0.000475619589
             autocorr =       1.347021996595
              std dev =       0.579545298710
             le_variance =       0.335872753257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335773412595
                                         uncertainty =       0.002962609857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335773412595
                                         uncertainty =       0.002962609857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409800425
  error estimate for blocks of size 2^( 2) =       0.000423466234
  error estimate for blocks of size 2^( 3) =       0.000439021587
  error estimate for blocks of size 2^( 4) =       0.000454174406
  error estimate for blocks of size 2^( 5) =       0.000470258241
  error estimate for blocks of size 2^( 6) =       0.000483313809
  error estimate for blocks of size 2^( 7) =       0.000494731968

      target function =                  N/A
              le_mean =     -16.910189702577
             les_mean =     286.290388385585
             stat err =       0.000475619606
             autocorr =       1.347022001773
              std dev =       0.579545318650
             le_variance =       0.335872776370


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910189702520        initial
     5.9605e+02     5.9605e+03             4.7348e-07       -16.910189703440  <--
     2.3842e+03     2.3842e+04             1.1837e-07       -16.910189702980
     9.5367e+03     9.5367e+04             2.9593e-08       -16.910189702577

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 2.9850e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416762e-01 1 1  ON 1
 uu_2                 4.094264e-02 1 1  ON 2
 uu_3                -2.029648e-02 1 1  ON 3
 uu_4                -6.361058e-02 1 1  ON 4
 uu_5                -9.670819e-02 1 1  ON 5
 uu_6                -1.233241e-01 1 1  ON 6
 uu_7                -1.363791e-01 1 1  ON 7
 uu_8                -1.282915e-01 1 1  ON 8
 uu_9                -9.951120e-02 1 1  ON 9
 ud_0                 4.435014e-01 1 1  ON 10
 ud_1                 1.777447e-01 1 1  ON 11
 ud_2                 5.800577e-02 1 1  ON 12
 ud_3                -1.250288e-02 1 1  ON 13
 ud_4                -6.878371e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328839e-01 1 1  ON 16
 ud_7                -1.469905e-01 1 1  ON 17
 ud_8                -1.457598e-01 1 1  ON 18
 ud_9                -1.352405e-01 1 1  ON 19
 eO_0                -7.634949e-01 1 1  ON 20
 eO_1                -4.422455e-01 1 1  ON 21
 eO_2                -2.052903e-02 1 1  ON 22
 eO_3                 3.008185e-01 1 1  ON 23
 eO_4                 5.250648e-01 1 1  ON 24
 eO_5                 4.811712e-01 1 1  ON 25
 eO_6                 2.500503e-01 1 1  ON 26
 eO_7                -4.945248e-02 1 1  ON 27
 eO_8                -2.104206e-01 1 1  ON 28
 eO_9                -7.127211e-02 1 1  ON 29
eH1_0                -2.362975e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161693e-02 1 1  ON 32
eH1_3                -3.822994e-02 1 1  ON 33
eH1_4                 7.521070e-03 1 1  ON 34
eH1_5                 4.096919e-02 1 1  ON 35
eH1_6                 9.636275e-02 1 1  ON 36
eH1_7                 1.470444e-01 1 1  ON 37
eH1_8                 1.639059e-01 1 1  ON 38
eH1_9                 5.094398e-02 1 1  ON 39
eH2_0                -2.332753e-01 1 1  ON 40
eH2_1                -1.342071e-01 1 1  ON 41
eH2_2                -8.869937e-02 1 1  ON 42
eH2_3                -3.500461e-02 1 1  ON 43
eH2_4                 1.124812e-02 1 1  ON 44
eH2_5                 4.345511e-02 1 1  ON 45
eH2_6                 9.993478e-02 1 1  ON 46
eH2_7                 1.511977e-01 1 1  ON 47
eH2_8                 1.690097e-01 1 1  ON 48
eH2_9                 3.402747e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8416e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.8544
    reference variance = 0.2825
====================================================
  Execution time = 2.0755e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6382e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337204279961
                                         uncertainty =       0.004327489407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337204279961
                                         uncertainty =       0.004327489407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410536735
  error estimate for blocks of size 2^( 2) =       0.000424266072
  error estimate for blocks of size 2^( 3) =       0.000439408070
  error estimate for blocks of size 2^( 4) =       0.000454420068
  error estimate for blocks of size 2^( 5) =       0.000469760717
  error estimate for blocks of size 2^( 6) =       0.000482104207
  error estimate for blocks of size 2^( 7) =       0.000487789440

      target function =                  N/A
              le_mean =     -16.910259140159
             les_mean =     286.293944839596
             stat err =       0.000473518608
             autocorr =       1.330362679755
              std dev =       0.580586617846
             le_variance =       0.337080820822


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691025914016e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910259140158       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910259148237       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910259150241       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910259150637       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910259150472       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910259152160       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910259152750       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910259151900       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.736501e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910259140158       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910259142179       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910259142680       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910259142779       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910259142738       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910259143160       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910259143307       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910259143094       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.341546e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910259140158       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910259140664       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910259140789       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910259140814       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910259140802       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910259140908       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910259140946       residual = 2.96e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910259140895       residual = 6.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+03 is 1.085405e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.084421 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6400e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416763e-01 1 1  ON 1
 uu_2                 4.094265e-02 1 1  ON 2
 uu_3                -2.029644e-02 1 1  ON 3
 uu_4                -6.361079e-02 1 1  ON 4
 uu_5                -9.670822e-02 1 1  ON 5
 uu_6                -1.233241e-01 1 1  ON 6
 uu_7                -1.363790e-01 1 1  ON 7
 uu_8                -1.282916e-01 1 1  ON 8
 uu_9                -9.951131e-02 1 1  ON 9
 ud_0                 4.435015e-01 1 1  ON 10
 ud_1                 1.777446e-01 1 1  ON 11
 ud_2                 5.800569e-02 1 1  ON 12
 ud_3                -1.250293e-02 1 1  ON 13
 ud_4                -6.878377e-02 1 1  ON 14
 ud_5                -1.080318e-01 1 1  ON 15
 ud_6                -1.328839e-01 1 1  ON 16
 ud_7                -1.469905e-01 1 1  ON 17
 ud_8                -1.457596e-01 1 1  ON 18
 ud_9                -1.352404e-01 1 1  ON 19
 eO_0                -7.634952e-01 1 1  ON 20
 eO_1                -4.422457e-01 1 1  ON 21
 eO_2                -2.052930e-02 1 1  ON 22
 eO_3                 3.008188e-01 1 1  ON 23
 eO_4                 5.250649e-01 1 1  ON 24
 eO_5                 4.811716e-01 1 1  ON 25
 eO_6                 2.500507e-01 1 1  ON 26
 eO_7                -4.945233e-02 1 1  ON 27
 eO_8                -2.104208e-01 1 1  ON 28
 eO_9                -7.127231e-02 1 1  ON 29
eH1_0                -2.362975e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161729e-02 1 1  ON 32
eH1_3                -3.823000e-02 1 1  ON 33
eH1_4                 7.521050e-03 1 1  ON 34
eH1_5                 4.096906e-02 1 1  ON 35
eH1_6                 9.636265e-02 1 1  ON 36
eH1_7                 1.470445e-01 1 1  ON 37
eH1_8                 1.639062e-01 1 1  ON 38
eH1_9                 5.094425e-02 1 1  ON 39
eH2_0                -2.332757e-01 1 1  ON 40
eH2_1                -1.342073e-01 1 1  ON 41
eH2_2                -8.869922e-02 1 1  ON 42
eH2_3                -3.500474e-02 1 1  ON 43
eH2_4                 1.124805e-02 1 1  ON 44
eH2_5                 4.345530e-02 1 1  ON 45
eH2_6                 9.993482e-02 1 1  ON 46
eH2_7                 1.511978e-01 1 1  ON 47
eH2_8                 1.690099e-01 1 1  ON 48
eH2_9                 3.402772e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -16.9024
    reference variance = 0.340407
====================================================
  Execution time = 2.0282e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.5293e-01
  Total weights = 2.0000e+06
  Execution time = 1.8678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353023020034
                                         uncertainty =       0.013050215074

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353023020034
                                         uncertainty =       0.013050215074

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420074541
  error estimate for blocks of size 2^( 2) =       0.000433427422
  error estimate for blocks of size 2^( 3) =       0.000447777733
  error estimate for blocks of size 2^( 4) =       0.000462458327
  error estimate for blocks of size 2^( 5) =       0.000477536372
  error estimate for blocks of size 2^( 6) =       0.000490185114
  error estimate for blocks of size 2^( 7) =       0.000496497378

      target function =                  N/A
              le_mean =     -16.910588184668
             les_mean =     286.320917814650
             stat err =       0.000481669298
             autocorr =       1.314756139099
              std dev =       0.594075112840
             le_variance =       0.352925239696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353023625432
                                         uncertainty =       0.013050214839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353023625432
                                         uncertainty =       0.013050214839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420074901
  error estimate for blocks of size 2^( 2) =       0.000433427762
  error estimate for blocks of size 2^( 3) =       0.000447778056
  error estimate for blocks of size 2^( 4) =       0.000462458641
  error estimate for blocks of size 2^( 5) =       0.000477536689
  error estimate for blocks of size 2^( 6) =       0.000490185442
  error estimate for blocks of size 2^( 7) =       0.000496497682

      target function =                  N/A
              le_mean =     -16.910588188522
             les_mean =     286.320918550050
             stat err =       0.000481669613
             autocorr =       1.314755605501
              std dev =       0.594075622056
             le_variance =       0.352925844721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353023323351
                                         uncertainty =       0.013050214954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353023323351
                                         uncertainty =       0.013050214954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420074721
  error estimate for blocks of size 2^( 2) =       0.000433427592
  error estimate for blocks of size 2^( 3) =       0.000447777895
  error estimate for blocks of size 2^( 4) =       0.000462458484
  error estimate for blocks of size 2^( 5) =       0.000477536531
  error estimate for blocks of size 2^( 6) =       0.000490185278
  error estimate for blocks of size 2^( 7) =       0.000496497530

      target function =                  N/A
              le_mean =     -16.910588186596
             les_mean =     286.320918183016
             stat err =       0.000481669456
             autocorr =       1.314755871736
              std dev =       0.594075367968
             le_variance =       0.352925542826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353023057967
                                         uncertainty =       0.013050215059

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.353023057967
                                         uncertainty =       0.013050215059

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000420074563
  error estimate for blocks of size 2^( 2) =       0.000433427444
  error estimate for blocks of size 2^( 3) =       0.000447777753
  error estimate for blocks of size 2^( 4) =       0.000462458347
  error estimate for blocks of size 2^( 5) =       0.000477536392
  error estimate for blocks of size 2^( 6) =       0.000490185135
  error estimate for blocks of size 2^( 7) =       0.000496497397

      target function =                  N/A
              le_mean =     -16.910588184909
             les_mean =     286.320917860711
             stat err =       0.000481669318
             autocorr =       1.314756105662
              std dev =       0.594075144747
             le_variance =       0.352925277606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910588184668        initial
     1.4901e+02     1.4901e+03             1.7365e-06       -16.910588188522  <--
     5.9605e+02     5.9605e+03             4.3415e-07       -16.910588186596
     2.3842e+03     2.3842e+04             1.0854e-07       -16.910588184909

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 2.9689e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094269e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361143e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520990e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094506e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124784e-02 1 1  ON 44
eH2_5                 4.345587e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9512
    reference variance = 0.303497
====================================================
  Execution time = 2.0721e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4518e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5903e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345131157944
                                         uncertainty =       0.010478741087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345131157944
                                         uncertainty =       0.010478741087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415442326
  error estimate for blocks of size 2^( 2) =       0.000428793393
  error estimate for blocks of size 2^( 3) =       0.000443147721
  error estimate for blocks of size 2^( 4) =       0.000458108076
  error estimate for blocks of size 2^( 5) =       0.000473395360
  error estimate for blocks of size 2^( 6) =       0.000487701029
  error estimate for blocks of size 2^( 7) =       0.000496349260

      target function =                  N/A
              le_mean =     -16.910965885836
             les_mean =     286.325951671453
             stat err =       0.000478888431
             autocorr =       1.328762031486
              std dev =       0.587524171529
             le_variance =       0.345184652131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691096588584e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910965885836       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910965896244       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910965883980       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910965890401       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910965897433       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910965903366       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910965898324       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910965898295       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+01 is 7.150572e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910965885836       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910965888448       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910965885354       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910965886964       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910965888703       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910965890179       residual = 9.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910965888932       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910965888923       residual = 4.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+02 is 1.787747e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910965885836       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910965886490       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910965885714       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910965886118       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910965886551       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910965886919       residual = 9.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910965886608       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910965886604       residual = 4.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+02 is 4.469428e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087082 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6318e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.083698e-01 1 1  ON 0
 uu_1                 1.416771e-01 1 1  ON 1
 uu_2                 4.094347e-02 1 1  ON 2
 uu_3                -2.029627e-02 1 1  ON 3
 uu_4                -6.361192e-02 1 1  ON 4
 uu_5                -9.670826e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363794e-01 1 1  ON 7
 uu_8                -1.282928e-01 1 1  ON 8
 uu_9                -9.951242e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777444e-01 1 1  ON 11
 ud_2                 5.800564e-02 1 1  ON 12
 ud_3                -1.250332e-02 1 1  ON 13
 ud_4                -6.878377e-02 1 1  ON 14
 ud_5                -1.080317e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469905e-01 1 1  ON 17
 ud_8                -1.457594e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634972e-01 1 1  ON 20
 eO_1                -4.422473e-01 1 1  ON 21
 eO_2                -2.053047e-02 1 1  ON 22
 eO_3                 3.008194e-01 1 1  ON 23
 eO_4                 5.250660e-01 1 1  ON 24
 eO_5                 4.811745e-01 1 1  ON 25
 eO_6                 2.500532e-01 1 1  ON 26
 eO_7                -4.945131e-02 1 1  ON 27
 eO_8                -2.104224e-01 1 1  ON 28
 eO_9                -7.127392e-02 1 1  ON 29
eH1_0                -2.362978e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161926e-02 1 1  ON 32
eH1_3                -3.822987e-02 1 1  ON 33
eH1_4                 7.520650e-03 1 1  ON 34
eH1_5                 4.096727e-02 1 1  ON 35
eH1_6                 9.636170e-02 1 1  ON 36
eH1_7                 1.470459e-01 1 1  ON 37
eH1_8                 1.639083e-01 1 1  ON 38
eH1_9                 5.094624e-02 1 1  ON 39
eH2_0                -2.332778e-01 1 1  ON 40
eH2_1                -1.342092e-01 1 1  ON 41
eH2_2                -8.869832e-02 1 1  ON 42
eH2_3                -3.500524e-02 1 1  ON 43
eH2_4                 1.124751e-02 1 1  ON 44
eH2_5                 4.345614e-02 1 1  ON 45
eH2_6                 9.993430e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690111e-01 1 1  ON 48
eH2_9                 3.402974e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -16.9392
    reference variance = 0.40169
====================================================
  Execution time = 2.0427e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.3825e-01
  Total weights = 2.0000e+06
  Execution time = 1.8779e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338157922230
                                         uncertainty =       0.003443601420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338157922230
                                         uncertainty =       0.003443601420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411247396
  error estimate for blocks of size 2^( 2) =       0.000424352372
  error estimate for blocks of size 2^( 3) =       0.000438457973
  error estimate for blocks of size 2^( 4) =       0.000453144508
  error estimate for blocks of size 2^( 5) =       0.000467006610
  error estimate for blocks of size 2^( 6) =       0.000477909603
  error estimate for blocks of size 2^( 7) =       0.000485445460

      target function =                  N/A
              le_mean =     -16.912064024444
             les_mean =     286.356158239830
             stat err =       0.000470876545
             autocorr =       1.311015402488
              std dev =       0.581591645440
             le_variance =       0.338248842045

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338156674144
                                         uncertainty =       0.003443579638

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338156674144
                                         uncertainty =       0.003443579638

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411246637
  error estimate for blocks of size 2^( 2) =       0.000424351611
  error estimate for blocks of size 2^( 3) =       0.000438457211
  error estimate for blocks of size 2^( 4) =       0.000453143748
  error estimate for blocks of size 2^( 5) =       0.000467005844
  error estimate for blocks of size 2^( 6) =       0.000477908791
  error estimate for blocks of size 2^( 7) =       0.000485444794

      target function =                  N/A
              le_mean =     -16.912064004239
             les_mean =     286.356156307195
             stat err =       0.000470875794
             autocorr =       1.311016061985
              std dev =       0.581590571477
             le_variance =       0.338247592831

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338157293546
                                         uncertainty =       0.003443590440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338157293546
                                         uncertainty =       0.003443590440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411247014
  error estimate for blocks of size 2^( 2) =       0.000424351989
  error estimate for blocks of size 2^( 3) =       0.000438457589
  error estimate for blocks of size 2^( 4) =       0.000453144125
  error estimate for blocks of size 2^( 5) =       0.000467006225
  error estimate for blocks of size 2^( 6) =       0.000477909194
  error estimate for blocks of size 2^( 7) =       0.000485445125

      target function =                  N/A
              le_mean =     -16.912064014250
             les_mean =     286.356157265766
             stat err =       0.000470876167
             autocorr =       1.311015736475
              std dev =       0.581591104462
             le_variance =       0.338248212789

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338157843486
                                         uncertainty =       0.003443600045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338157843486
                                         uncertainty =       0.003443600045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411247348
  error estimate for blocks of size 2^( 2) =       0.000424352324
  error estimate for blocks of size 2^( 3) =       0.000438457925
  error estimate for blocks of size 2^( 4) =       0.000453144460
  error estimate for blocks of size 2^( 5) =       0.000467006562
  error estimate for blocks of size 2^( 6) =       0.000477909552
  error estimate for blocks of size 2^( 7) =       0.000485445418

      target function =                  N/A
              le_mean =     -16.912064023166
             les_mean =     286.356158117758
             stat err =       0.000470876498
             autocorr =       1.311015444375
              std dev =       0.581591577681
             le_variance =       0.338248763229


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.912064024444        initial  <--
     3.7253e+01     3.7253e+02             7.1506e-06       -16.912064004239
     1.4901e+02     1.4901e+03             1.7877e-06       -16.912064014250
     5.9605e+02     5.9605e+03             4.4694e-07       -16.912064023166

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8923
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094269e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361143e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520990e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094506e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124784e-02 1 1  ON 44
eH2_5                 4.345587e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6217e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.8996
    reference variance = 0.475192
====================================================
  Execution time = 2.0754e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3262e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4675e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332692159017
                                         uncertainty =       0.003401087952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.332692159017
                                         uncertainty =       0.003401087952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000407808289
  error estimate for blocks of size 2^( 2) =       0.000421208147
  error estimate for blocks of size 2^( 3) =       0.000434946777
  error estimate for blocks of size 2^( 4) =       0.000448613537
  error estimate for blocks of size 2^( 5) =       0.000462341856
  error estimate for blocks of size 2^( 6) =       0.000473199634
  error estimate for blocks of size 2^( 7) =       0.000480079894

      target function =                  N/A
              le_mean =     -16.910707346640
             les_mean =     286.304637999098
             stat err =       0.000466058730
             autocorr =       1.306078249433
              std dev =       0.576728013628
             le_variance =       0.332615201703


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691070734664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910707346640       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910707347475       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910707349324       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910707349328       residual = 5.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910707349635       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910707349841       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910707349513       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910707349459       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+02 is 6.593863e-07

solving harmonic davidson linear method for identity shift 1.4901e+03, overlap shift 1.4901e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910707346640       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910707346849       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910707347311       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910707347313       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910707347389       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910707347442       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910707347358       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910707347347       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+03 is 1.648584e-07

solving harmonic davidson linear method for identity shift 5.9605e+03, overlap shift 5.9605e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910707346640       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910707346692       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910707346808       residual = 9.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910707346803       residual = 5.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910707346830       residual = 2.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910707346836       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910707346828       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910707346819       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+03 is 4.121534e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.089754 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6228e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094268e-02 1 1  ON 2
 uu_3                -2.029632e-02 1 1  ON 3
 uu_4                -6.361141e-02 1 1  ON 4
 uu_5                -9.670837e-02 1 1  ON 5
 uu_6                -1.233238e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282922e-01 1 1  ON 8
 uu_9                -9.951174e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777446e-01 1 1  ON 11
 ud_2                 5.800550e-02 1 1  ON 12
 ud_3                -1.250310e-02 1 1  ON 13
 ud_4                -6.878390e-02 1 1  ON 14
 ud_5                -1.080322e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469907e-01 1 1  ON 17
 ud_8                -1.457592e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422464e-01 1 1  ON 21
 eO_2                -2.053008e-02 1 1  ON 22
 eO_3                 3.008194e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811729e-01 1 1  ON 25
 eO_6                 2.500522e-01 1 1  ON 26
 eO_7                -4.945183e-02 1 1  ON 27
 eO_8                -2.104216e-01 1 1  ON 28
 eO_9                -7.127301e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161844e-02 1 1  ON 32
eH1_3                -3.823026e-02 1 1  ON 33
eH1_4                 7.520961e-03 1 1  ON 34
eH1_5                 4.096863e-02 1 1  ON 35
eH1_6                 9.636237e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639071e-01 1 1  ON 38
eH1_9                 5.094519e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869881e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124779e-02 1 1  ON 44
eH2_5                 4.345586e-02 1 1  ON 45
eH2_6                 9.993492e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690104e-01 1 1  ON 48
eH2_9                 3.402858e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -16.9289
    reference variance = 0.297379
====================================================
  Execution time = 2.0164e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4515e-01
  Total weights = 2.0000e+06
  Execution time = 1.8701e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345109616292
                                         uncertainty =       0.006054194109

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345109616292
                                         uncertainty =       0.006054194109

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415419722
  error estimate for blocks of size 2^( 2) =       0.000429023211
  error estimate for blocks of size 2^( 3) =       0.000442791360
  error estimate for blocks of size 2^( 4) =       0.000457456240
  error estimate for blocks of size 2^( 5) =       0.000471351140
  error estimate for blocks of size 2^( 6) =       0.000483088908
  error estimate for blocks of size 2^( 7) =       0.000490257386

      target function =                  N/A
              le_mean =     -16.911055498004
             les_mean =     286.328944974095
             stat err =       0.000475538419
             autocorr =       1.310379222162
              std dev =       0.587492204278
             le_variance =       0.345147090088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345109792591
                                         uncertainty =       0.006054190386

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345109792591
                                         uncertainty =       0.006054190386

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415419828
  error estimate for blocks of size 2^( 2) =       0.000429023310
  error estimate for blocks of size 2^( 3) =       0.000442791447
  error estimate for blocks of size 2^( 4) =       0.000457456314
  error estimate for blocks of size 2^( 5) =       0.000471351212
  error estimate for blocks of size 2^( 6) =       0.000483088981
  error estimate for blocks of size 2^( 7) =       0.000490257458

      target function =                  N/A
              le_mean =     -16.911055495928
             les_mean =     286.328945080200
             stat err =       0.000475538491
             autocorr =       1.310378953284
              std dev =       0.587492354343
             le_variance =       0.345147266412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345109704448
                                         uncertainty =       0.006054192245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345109704448
                                         uncertainty =       0.006054192245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415419775
  error estimate for blocks of size 2^( 2) =       0.000429023261
  error estimate for blocks of size 2^( 3) =       0.000442791404
  error estimate for blocks of size 2^( 4) =       0.000457456277
  error estimate for blocks of size 2^( 5) =       0.000471351176
  error estimate for blocks of size 2^( 6) =       0.000483088945
  error estimate for blocks of size 2^( 7) =       0.000490257422

      target function =                  N/A
              le_mean =     -16.911055496965
             les_mean =     286.328945027104
             stat err =       0.000475538455
             autocorr =       1.310379087708
              std dev =       0.587492279317
             le_variance =       0.345147178257

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345109627311
                                         uncertainty =       0.006054193876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.345109627311
                                         uncertainty =       0.006054193876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415419728
  error estimate for blocks of size 2^( 2) =       0.000429023217
  error estimate for blocks of size 2^( 3) =       0.000442791366
  error estimate for blocks of size 2^( 4) =       0.000457456244
  error estimate for blocks of size 2^( 5) =       0.000471351145
  error estimate for blocks of size 2^( 6) =       0.000483088913
  error estimate for blocks of size 2^( 7) =       0.000490257391

      target function =                  N/A
              le_mean =     -16.911055497874
             les_mean =     286.328944980719
             stat err =       0.000475538423
             autocorr =       1.310379205355
              std dev =       0.587492213658
             le_variance =       0.345147101109


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911055498004        initial  <--
     3.7253e+02     3.7253e+03             6.5939e-07       -16.911055495928
     1.4901e+03     1.4901e+04             1.6486e-07       -16.911055496965
     5.9605e+03     5.9605e+04             4.1215e-08       -16.911055497874

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6223
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094269e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361143e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520990e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094506e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124784e-02 1 1  ON 44
eH2_5                 4.345587e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5857e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9757
    reference variance = 0.279166
====================================================
  Execution time = 2.0832e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4041e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4801e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340509307544
                                         uncertainty =       0.004472867033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340509307544
                                         uncertainty =       0.004472867033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412561808
  error estimate for blocks of size 2^( 2) =       0.000426246539
  error estimate for blocks of size 2^( 3) =       0.000441120045
  error estimate for blocks of size 2^( 4) =       0.000455408320
  error estimate for blocks of size 2^( 5) =       0.000470428621
  error estimate for blocks of size 2^( 6) =       0.000482666002
  error estimate for blocks of size 2^( 7) =       0.000493858180

      target function =                  N/A
              le_mean =     -16.911556474097
             les_mean =     286.341156697610
             stat err =       0.000475590281
             autocorr =       1.328886524545
              std dev =       0.583450504551
             le_variance =       0.340414491261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691155647410e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911556474097       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911556474141       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911556473918       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911556473932       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911556474075       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911556474150       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911556474220       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911556474147       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+03 is 5.815815e-08

solving harmonic davidson linear method for identity shift 1.4901e+04, overlap shift 1.4901e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911556474097       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911556474108       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911556474052       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911556474055       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911556474091       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911556474115       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911556474143       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911556474109       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+04 is 1.453965e-08

solving harmonic davidson linear method for identity shift 5.9605e+04, overlap shift 5.9605e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911556474097       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911556474099       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911556474085       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911556474086       residual = 7.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911556474090       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911556474102       residual = 6.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911556474081       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911556474065       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+04 is 3.634920e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6321e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094270e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361143e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800546e-02 1 1  ON 12
 ud_3                -1.250310e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520992e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094508e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345587e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -16.9265
    reference variance = 0.205087
====================================================
  Execution time = 2.0822e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3799e-01
  Total weights = 2.0000e+06
  Execution time = 1.8729e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337977724140
                                         uncertainty =       0.003977845191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337977724140
                                         uncertainty =       0.003977845191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411087161
  error estimate for blocks of size 2^( 2) =       0.000424777471
  error estimate for blocks of size 2^( 3) =       0.000440045134
  error estimate for blocks of size 2^( 4) =       0.000455787734
  error estimate for blocks of size 2^( 5) =       0.000471939290
  error estimate for blocks of size 2^( 6) =       0.000486013977
  error estimate for blocks of size 2^( 7) =       0.000498502422

      target function =                  N/A
              le_mean =     -16.910867682851
             les_mean =     286.315430925441
             stat err =       0.000478060856
             autocorr =       1.352379387666
              std dev =       0.581365038108
             le_variance =       0.337985307534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337977663798
                                         uncertainty =       0.003977844652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337977663798
                                         uncertainty =       0.003977844652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411087124
  error estimate for blocks of size 2^( 2) =       0.000424777436
  error estimate for blocks of size 2^( 3) =       0.000440045100
  error estimate for blocks of size 2^( 4) =       0.000455787701
  error estimate for blocks of size 2^( 5) =       0.000471939257
  error estimate for blocks of size 2^( 6) =       0.000486013946
  error estimate for blocks of size 2^( 7) =       0.000498502393

      target function =                  N/A
              le_mean =     -16.910867682795
             les_mean =     286.315430863221
             stat err =       0.000478060824
             autocorr =       1.352379451361
              std dev =       0.581364986234
             le_variance =       0.337985247219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337977693967
                                         uncertainty =       0.003977844921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337977693967
                                         uncertainty =       0.003977844921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411087142
  error estimate for blocks of size 2^( 2) =       0.000424777453
  error estimate for blocks of size 2^( 3) =       0.000440045117
  error estimate for blocks of size 2^( 4) =       0.000455787717
  error estimate for blocks of size 2^( 5) =       0.000471939273
  error estimate for blocks of size 2^( 6) =       0.000486013961
  error estimate for blocks of size 2^( 7) =       0.000498502408

      target function =                  N/A
              le_mean =     -16.910867682823
             les_mean =     286.315430894328
             stat err =       0.000478060840
             autocorr =       1.352379419531
              std dev =       0.581365012169
             le_variance =       0.337985277374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337977720368
                                         uncertainty =       0.003977845157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337977720368
                                         uncertainty =       0.003977845157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411087158
  error estimate for blocks of size 2^( 2) =       0.000424777469
  error estimate for blocks of size 2^( 3) =       0.000440045131
  error estimate for blocks of size 2^( 4) =       0.000455787732
  error estimate for blocks of size 2^( 5) =       0.000471939287
  error estimate for blocks of size 2^( 6) =       0.000486013975
  error estimate for blocks of size 2^( 7) =       0.000498502420

      target function =                  N/A
              le_mean =     -16.910867682848
             les_mean =     286.315430921552
             stat err =       0.000478060854
             autocorr =       1.352379391656
              std dev =       0.581365034865
             le_variance =       0.337985303764


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910867682851        initial  <--
     3.7253e+03     3.7253e+04             5.8158e-08       -16.910867682795
     1.4901e+04     1.4901e+05             1.4540e-08       -16.910867682823
     5.9605e+04     5.9605e+05             3.6349e-09       -16.910867682848

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.2610
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094269e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361143e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520990e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094506e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124784e-02 1 1  ON 44
eH2_5                 4.345587e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6589e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6921e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.878
    reference variance = 0.327392
====================================================
  Execution time = 2.0599e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3565e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335469265878
                                         uncertainty =       0.002896222163

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335469265878
                                         uncertainty =       0.002896222163

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409664114
  error estimate for blocks of size 2^( 2) =       0.000423533571
  error estimate for blocks of size 2^( 3) =       0.000438346746
  error estimate for blocks of size 2^( 4) =       0.000453510819
  error estimate for blocks of size 2^( 5) =       0.000469067999
  error estimate for blocks of size 2^( 6) =       0.000481743886
  error estimate for blocks of size 2^( 7) =       0.000492652216

      target function =                  N/A
              le_mean =     -16.911101221101
             les_mean =     286.320993715384
             stat err =       0.000474243730
             autocorr =       1.340131301282
              std dev =       0.579352546292
             le_variance =       0.335649372895


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691110122110e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911101221101       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911101221116       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911101221115       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911101221118       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911101221133       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911101221130       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911101221146       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911101221144       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 7.147357e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911101221101       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911101221104       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911101221104       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911101221105       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911101221021       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911101221222       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911101221109       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911101221257       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.786840e-09

solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911101221101       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911101221102       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911101221102       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911101221102       residual = 9.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911101221102       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911101221185       residual = 4.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911101221172       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911101220791       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 4.467102e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.096495 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6193e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094269e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361144e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520990e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094506e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124784e-02 1 1  ON 44
eH2_5                 4.345587e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402846e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -16.8967
    reference variance = 0.239075
====================================================
  Execution time = 2.2552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.4209e-01
  Total weights = 2.0000e+06
  Execution time = 1.8685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342211812052
                                         uncertainty =       0.006350886447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342211812052
                                         uncertainty =       0.006350886447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413577569
  error estimate for blocks of size 2^( 2) =       0.000426752733
  error estimate for blocks of size 2^( 3) =       0.000441673585
  error estimate for blocks of size 2^( 4) =       0.000457049138
  error estimate for blocks of size 2^( 5) =       0.000472708987
  error estimate for blocks of size 2^( 6) =       0.000485772259
  error estimate for blocks of size 2^( 7) =       0.000492129832

      target function =                  N/A
              le_mean =     -16.911744973080
             les_mean =     286.349210674625
             stat err =       0.000476915054
             autocorr =       1.329744216943
              std dev =       0.584887007176
             le_variance =       0.342092811163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342211808930
                                         uncertainty =       0.006350886402

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342211808930
                                         uncertainty =       0.006350886402

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413577567
  error estimate for blocks of size 2^( 2) =       0.000426752731
  error estimate for blocks of size 2^( 3) =       0.000441673583
  error estimate for blocks of size 2^( 4) =       0.000457049136
  error estimate for blocks of size 2^( 5) =       0.000472708985
  error estimate for blocks of size 2^( 6) =       0.000485772257
  error estimate for blocks of size 2^( 7) =       0.000492129830

      target function =                  N/A
              le_mean =     -16.911744973102
             les_mean =     286.349210672231
             stat err =       0.000476915052
             autocorr =       1.329744219865
              std dev =       0.584887004507
             le_variance =       0.342092808042

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342211810491
                                         uncertainty =       0.006350886425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342211810491
                                         uncertainty =       0.006350886425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413577568
  error estimate for blocks of size 2^( 2) =       0.000426752732
  error estimate for blocks of size 2^( 3) =       0.000441673584
  error estimate for blocks of size 2^( 4) =       0.000457049137
  error estimate for blocks of size 2^( 5) =       0.000472708986
  error estimate for blocks of size 2^( 6) =       0.000485772258
  error estimate for blocks of size 2^( 7) =       0.000492129831

      target function =                  N/A
              le_mean =     -16.911744973091
             les_mean =     286.349210673428
             stat err =       0.000476915053
             autocorr =       1.329744218403
              std dev =       0.584887005842
             le_variance =       0.342092809602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342211811857
                                         uncertainty =       0.006350886444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342211811857
                                         uncertainty =       0.006350886444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413577569
  error estimate for blocks of size 2^( 2) =       0.000426752732
  error estimate for blocks of size 2^( 3) =       0.000441673585
  error estimate for blocks of size 2^( 4) =       0.000457049138
  error estimate for blocks of size 2^( 5) =       0.000472708987
  error estimate for blocks of size 2^( 6) =       0.000485772259
  error estimate for blocks of size 2^( 7) =       0.000492129832

      target function =                  N/A
              le_mean =     -16.911744973082
             les_mean =     286.349210674476
             stat err =       0.000476915054
             autocorr =       1.329744217123
              std dev =       0.584887007009
             le_variance =       0.342092810968


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911744973080        initial
     3.7253e+04     3.7253e+05             7.1474e-09       -16.911744973102  <--
     1.4901e+05     1.4901e+06             1.7868e-09       -16.911744973091
     5.9605e+05     5.9605e+06             4.4671e-10       -16.911744973082

*****************************************************************************
Applying the update for shift_i =   3.7253e+04     and shift_s =   3.7253e+05
*****************************************************************************

  Execution time = 3.1982e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094270e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361144e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520989e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094507e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345587e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8182e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.9304
    reference variance = 0.217244
====================================================
  Execution time = 2.0566e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4225e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6247e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342197290544
                                         uncertainty =       0.004403343725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.342197290544
                                         uncertainty =       0.004403343725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413672223
  error estimate for blocks of size 2^( 2) =       0.000426957773
  error estimate for blocks of size 2^( 3) =       0.000441562708
  error estimate for blocks of size 2^( 4) =       0.000455315162
  error estimate for blocks of size 2^( 5) =       0.000468589855
  error estimate for blocks of size 2^( 6) =       0.000479716262
  error estimate for blocks of size 2^( 7) =       0.000488651864

      target function =                  N/A
              le_mean =     -16.910742783559
             les_mean =     286.315470736876
             stat err =       0.000473068286
             autocorr =       1.307780771890
              std dev =       0.585020868272
             le_variance =       0.342249416314


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691074278356e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+03, overlap shift 9.3132e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910742783559       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910742783608       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910742783597       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910742783627       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910742783619       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910742783604       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910742783603       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910742783610       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+03 is 2.710428e-08

solving harmonic davidson linear method for identity shift 3.7253e+04, overlap shift 3.7253e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910742783559       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910742783571       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910742783568       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910742783577       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910742783575       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910742783568       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910742783569       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910742783545       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+04 is 6.776070e-09

solving harmonic davidson linear method for identity shift 1.4901e+05, overlap shift 1.4901e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910742783559       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910742783562       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910742783561       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910742783563       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910742783326       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910742783562       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910742783616       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910742783516       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+05 is 1.694017e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.099153 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6198e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094270e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361144e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520989e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094507e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345587e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -16.8838
    reference variance = 0.285034
====================================================
  Execution time = 2.0256e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3350e-01
  Total weights = 2.0000e+06
  Execution time = 1.8705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333499964436
                                         uncertainty =       0.003032917070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333499964436
                                         uncertainty =       0.003032917070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408349513
  error estimate for blocks of size 2^( 2) =       0.000422189557
  error estimate for blocks of size 2^( 3) =       0.000437465776
  error estimate for blocks of size 2^( 4) =       0.000452298361
  error estimate for blocks of size 2^( 5) =       0.000467138639
  error estimate for blocks of size 2^( 6) =       0.000479076747
  error estimate for blocks of size 2^( 7) =       0.000488826478

      target function =                  N/A
              le_mean =     -16.911177469057
             les_mean =     286.321421873273
             stat err =       0.000471835057
             autocorr =       1.335107776401
              std dev =       0.577493419947
             le_variance =       0.333498650082

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333499975422
                                         uncertainty =       0.003032917191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333499975422
                                         uncertainty =       0.003032917191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408349520
  error estimate for blocks of size 2^( 2) =       0.000422189563
  error estimate for blocks of size 2^( 3) =       0.000437465781
  error estimate for blocks of size 2^( 4) =       0.000452298366
  error estimate for blocks of size 2^( 5) =       0.000467138644
  error estimate for blocks of size 2^( 6) =       0.000479076752
  error estimate for blocks of size 2^( 7) =       0.000488826483

      target function =                  N/A
              le_mean =     -16.911177468941
             les_mean =     286.321421880346
             stat err =       0.000471835061
             autocorr =       1.335107758969
              std dev =       0.577493429462
             le_variance =       0.333498661071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333499969929
                                         uncertainty =       0.003032917131

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333499969929
                                         uncertainty =       0.003032917131

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408349517
  error estimate for blocks of size 2^( 2) =       0.000422189560
  error estimate for blocks of size 2^( 3) =       0.000437465778
  error estimate for blocks of size 2^( 4) =       0.000452298363
  error estimate for blocks of size 2^( 5) =       0.000467138642
  error estimate for blocks of size 2^( 6) =       0.000479076750
  error estimate for blocks of size 2^( 7) =       0.000488826481

      target function =                  N/A
              le_mean =     -16.911177468999
             les_mean =     286.321421876809
             stat err =       0.000471835059
             autocorr =       1.335107767686
              std dev =       0.577493424705
             le_variance =       0.333498655577

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333499965123
                                         uncertainty =       0.003032917078

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.333499965123
                                         uncertainty =       0.003032917078

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000408349514
  error estimate for blocks of size 2^( 2) =       0.000422189557
  error estimate for blocks of size 2^( 3) =       0.000437465776
  error estimate for blocks of size 2^( 4) =       0.000452298361
  error estimate for blocks of size 2^( 5) =       0.000467138640
  error estimate for blocks of size 2^( 6) =       0.000479076748
  error estimate for blocks of size 2^( 7) =       0.000488826479

      target function =                  N/A
              le_mean =     -16.911177469050
             les_mean =     286.321421873715
             stat err =       0.000471835057
             autocorr =       1.335107775313
              std dev =       0.577493420542
             le_variance =       0.333498650769


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911177469057        initial  <--
     9.3132e+03     9.3132e+04             2.7104e-08       -16.911177468941
     3.7253e+04     3.7253e+05             6.7761e-09       -16.911177468999
     1.4901e+05     1.4901e+06             1.6940e-09       -16.911177469050

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6791
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094270e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361144e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520989e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094507e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345587e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.9224
    reference variance = 0.278663
====================================================
  Execution time = 2.0920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3572e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335712499052
                                         uncertainty =       0.002606237153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335712499052
                                         uncertainty =       0.002606237153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409709320
  error estimate for blocks of size 2^( 2) =       0.000423721222
  error estimate for blocks of size 2^( 3) =       0.000438950127
  error estimate for blocks of size 2^( 4) =       0.000453952235
  error estimate for blocks of size 2^( 5) =       0.000468692960
  error estimate for blocks of size 2^( 6) =       0.000482286621
  error estimate for blocks of size 2^( 7) =       0.000492375884

      target function =                  N/A
              le_mean =     -16.910443718138
             les_mean =     286.298830030210
             stat err =       0.000474326925
             autocorr =       1.340305715862
              std dev =       0.579416476945
             le_variance =       0.335723453755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691044371814e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910443718138       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910443718138       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910443718140       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910443718129       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910443718146       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910443718178       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910443718167       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910443718139       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 3.562295e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910443718138       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910443718138       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910443718139       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910443718139       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910443717839       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910443718160       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910443718116       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910443718249       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 8.905751e-10

solving harmonic davidson linear method for identity shift 1.4901e+06, overlap shift 1.4901e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910443718138       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910443718138       residual = 4.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910443718138       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910443718138       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910443718471       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910443718180       residual = 8.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910443718188       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910443717120       residual = 3.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+06 is 2.226438e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.101799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6511e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094270e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361144e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520989e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094507e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345587e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -16.8907
    reference variance = 0.168274
====================================================
  Execution time = 2.0250e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3807e-01
  Total weights = 2.0000e+06
  Execution time = 1.8747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338138400997
                                         uncertainty =       0.003029324156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338138400997
                                         uncertainty =       0.003029324156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411141469
  error estimate for blocks of size 2^( 2) =       0.000424869031
  error estimate for blocks of size 2^( 3) =       0.000439942903
  error estimate for blocks of size 2^( 4) =       0.000455249093
  error estimate for blocks of size 2^( 5) =       0.000470820080
  error estimate for blocks of size 2^( 6) =       0.000484796145
  error estimate for blocks of size 2^( 7) =       0.000496151534

      target function =                  N/A
              le_mean =     -16.910288586454
             les_mean =     286.295934523114
             stat err =       0.000476754213
             autocorr =       1.344641505453
              std dev =       0.581441841466
             le_variance =       0.338074615008

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338138399862
                                         uncertainty =       0.003029324158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338138399862
                                         uncertainty =       0.003029324158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411141468
  error estimate for blocks of size 2^( 2) =       0.000424869030
  error estimate for blocks of size 2^( 3) =       0.000439942903
  error estimate for blocks of size 2^( 4) =       0.000455249092
  error estimate for blocks of size 2^( 5) =       0.000470820079
  error estimate for blocks of size 2^( 6) =       0.000484796145
  error estimate for blocks of size 2^( 7) =       0.000496151533

      target function =                  N/A
              le_mean =     -16.910288586463
             les_mean =     286.295934522310
             stat err =       0.000476754212
             autocorr =       1.344641506506
              std dev =       0.581441840491
             le_variance =       0.338074613873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338138400429
                                         uncertainty =       0.003029324157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338138400429
                                         uncertainty =       0.003029324157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411141469
  error estimate for blocks of size 2^( 2) =       0.000424869030
  error estimate for blocks of size 2^( 3) =       0.000439942903
  error estimate for blocks of size 2^( 4) =       0.000455249093
  error estimate for blocks of size 2^( 5) =       0.000470820080
  error estimate for blocks of size 2^( 6) =       0.000484796145
  error estimate for blocks of size 2^( 7) =       0.000496151534

      target function =                  N/A
              le_mean =     -16.910288586459
             les_mean =     286.295934522712
             stat err =       0.000476754213
             autocorr =       1.344641505970
              std dev =       0.581441840978
             le_variance =       0.338074614440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338138400926
                                         uncertainty =       0.003029324156

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338138400926
                                         uncertainty =       0.003029324156

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411141469
  error estimate for blocks of size 2^( 2) =       0.000424869031
  error estimate for blocks of size 2^( 3) =       0.000439942903
  error estimate for blocks of size 2^( 4) =       0.000455249093
  error estimate for blocks of size 2^( 5) =       0.000470820080
  error estimate for blocks of size 2^( 6) =       0.000484796145
  error estimate for blocks of size 2^( 7) =       0.000496151534

      target function =                  N/A
              le_mean =     -16.910288586454
             les_mean =     286.295934523064
             stat err =       0.000476754213
             autocorr =       1.344641505514
              std dev =       0.581441841405
             le_variance =       0.338074614937


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910288586454        initial
     9.3132e+04     9.3132e+05             3.5623e-09       -16.910288586463  <--
     3.7253e+05     3.7253e+06             8.9058e-10       -16.910288586459
     1.4901e+06     1.4901e+07             2.2264e-10       -16.910288586454

*****************************************************************************
Applying the update for shift_i =   9.3132e+04     and shift_s =   9.3132e+05
*****************************************************************************

  Execution time = 2.9718e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094270e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361144e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520990e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094507e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869875e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345588e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6235e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9264
    reference variance = 0.213359
====================================================
  Execution time = 2.0836e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4176e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341790598775
                                         uncertainty =       0.004106921582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341790598775
                                         uncertainty =       0.004106921582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413379201
  error estimate for blocks of size 2^( 2) =       0.000426825421
  error estimate for blocks of size 2^( 3) =       0.000441796542
  error estimate for blocks of size 2^( 4) =       0.000456970456
  error estimate for blocks of size 2^( 5) =       0.000471658437
  error estimate for blocks of size 2^( 6) =       0.000486540152
  error estimate for blocks of size 2^( 7) =       0.000496623761

      target function =                  N/A
              le_mean =     -16.910480620276
             les_mean =     286.306119365740
             stat err =       0.000477948201
             autocorr =       1.336793792216
              std dev =       0.584606472665
             le_variance =       0.341764727882


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691048062028e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910480620276       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910480620308       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910480620327       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910480620338       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910480620362       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910480620369       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910480620353       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910480620338       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 9.878431e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910480620276       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910480620284       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910480620289       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910480620284       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910480620345       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910480620311       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910480620320       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910480620296       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.469609e-09

solving harmonic davidson linear method for identity shift 3.7253e+05, overlap shift 3.7253e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910480620276       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910480620278       residual = 5.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910480620279       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910480620279       residual = 8.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910480620221       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910480620266       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910480620058       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910480619723       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+05 is 6.174022e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104442 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6579e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094270e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361144e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053010e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945187e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127292e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520990e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094507e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345588e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402847e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -16.9348
    reference variance = 0.391481
====================================================
  Execution time = 2.0123e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3055e-01
  Total weights = 2.0000e+06
  Execution time = 1.8976e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330538044767
                                         uncertainty =       0.003122914713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330538044767
                                         uncertainty =       0.003122914713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406539258
  error estimate for blocks of size 2^( 2) =       0.000420421562
  error estimate for blocks of size 2^( 3) =       0.000435507406
  error estimate for blocks of size 2^( 4) =       0.000451370677
  error estimate for blocks of size 2^( 5) =       0.000466446889
  error estimate for blocks of size 2^( 6) =       0.000479454657
  error estimate for blocks of size 2^( 7) =       0.000487333705

      target function =                  N/A
              le_mean =     -16.910536794088
             les_mean =     286.296802834901
             stat err =       0.000471151482
             autocorr =       1.343124106023
              std dev =       0.574933331759
             le_variance =       0.330548335968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330538050235
                                         uncertainty =       0.003122914641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330538050235
                                         uncertainty =       0.003122914641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406539261
  error estimate for blocks of size 2^( 2) =       0.000420421565
  error estimate for blocks of size 2^( 3) =       0.000435507409
  error estimate for blocks of size 2^( 4) =       0.000451370680
  error estimate for blocks of size 2^( 5) =       0.000466446892
  error estimate for blocks of size 2^( 6) =       0.000479454659
  error estimate for blocks of size 2^( 7) =       0.000487333707

      target function =                  N/A
              le_mean =     -16.910536794205
             les_mean =     286.296802844308
             stat err =       0.000471151485
             autocorr =       1.343124098432
              std dev =       0.574933336511
             le_variance =       0.330548341431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330538047501
                                         uncertainty =       0.003122914677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330538047501
                                         uncertainty =       0.003122914677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406539259
  error estimate for blocks of size 2^( 2) =       0.000420421564
  error estimate for blocks of size 2^( 3) =       0.000435507407
  error estimate for blocks of size 2^( 4) =       0.000451370679
  error estimate for blocks of size 2^( 5) =       0.000466446891
  error estimate for blocks of size 2^( 6) =       0.000479454658
  error estimate for blocks of size 2^( 7) =       0.000487333706

      target function =                  N/A
              le_mean =     -16.910536794146
             les_mean =     286.296802839604
             stat err =       0.000471151483
             autocorr =       1.343124102239
              std dev =       0.574933334135
             le_variance =       0.330548338699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330538045109
                                         uncertainty =       0.003122914708

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.330538045109
                                         uncertainty =       0.003122914708

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000406539258
  error estimate for blocks of size 2^( 2) =       0.000420421562
  error estimate for blocks of size 2^( 3) =       0.000435507406
  error estimate for blocks of size 2^( 4) =       0.000451370678
  error estimate for blocks of size 2^( 5) =       0.000466446890
  error estimate for blocks of size 2^( 6) =       0.000479454657
  error estimate for blocks of size 2^( 7) =       0.000487333705

      target function =                  N/A
              le_mean =     -16.910536794095
             les_mean =     286.296802835489
             stat err =       0.000471151482
             autocorr =       1.343124105549
              std dev =       0.574933332056
             le_variance =       0.330548336309


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910536794088        initial
     2.3283e+04     2.3283e+05             9.8784e-09       -16.910536794205  <--
     9.3132e+04     9.3132e+05             2.4696e-09       -16.910536794146
     3.7253e+05     3.7253e+06             6.1740e-10       -16.910536794095

*****************************************************************************
Applying the update for shift_i =   2.3283e+04     and shift_s =   2.3283e+05
*****************************************************************************

  Execution time = 2.9572e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416766e-01 1 1  ON 1
 uu_2                 4.094270e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361144e-02 1 1  ON 4
 uu_5                -9.670828e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951165e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053011e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945186e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127293e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161836e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520992e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094508e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500511e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345588e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402848e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6157e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.8719
    reference variance = 0.285663
====================================================
  Execution time = 2.0525e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3619e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5184e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336220392103
                                         uncertainty =       0.002544656798

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336220392103
                                         uncertainty =       0.002544656798

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409996480
  error estimate for blocks of size 2^( 2) =       0.000423973873
  error estimate for blocks of size 2^( 3) =       0.000438451587
  error estimate for blocks of size 2^( 4) =       0.000453548624
  error estimate for blocks of size 2^( 5) =       0.000468918035
  error estimate for blocks of size 2^( 6) =       0.000480498636
  error estimate for blocks of size 2^( 7) =       0.000492346381

      target function =                  N/A
              le_mean =     -16.910983542355
             les_mean =     286.317558428285
             stat err =       0.000473827919
             autocorr =       1.335614230741
              std dev =       0.579822581993
             le_variance =       0.336194226588


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691098354235e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910983542355       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910983542357       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910983542486       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910983542492       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910983542612       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910983542616       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910983542606       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910983542627       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 3.895560e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910983542355       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910983542355       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910983542387       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910983542389       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910983542422       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910983542397       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910983542415       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910983542409       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 9.738935e-09

solving harmonic davidson linear method for identity shift 9.3132e+04, overlap shift 9.3132e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910983542355       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910983542355       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910983542363       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910983542363       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910983542379       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910983542708       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910983542372       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910983542367       residual = 3.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+04 is 2.434737e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107113 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6051e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094270e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951166e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634962e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053011e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945186e-02 1 1  ON 27
 eO_8                -2.104214e-01 1 1  ON 28
 eO_9                -7.127293e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161837e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520991e-03 1 1  ON 34
eH1_5                 4.096865e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094508e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500512e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993495e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402849e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -16.9431
    reference variance = 0.264034
====================================================
  Execution time = 2.0067e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4075e-01
  Total weights = 2.0000e+06
  Execution time = 1.8766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340859657727
                                         uncertainty =       0.009573459654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340859657727
                                         uncertainty =       0.009573459654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412762770
  error estimate for blocks of size 2^( 2) =       0.000426500626
  error estimate for blocks of size 2^( 3) =       0.000441277728
  error estimate for blocks of size 2^( 4) =       0.000456203574
  error estimate for blocks of size 2^( 5) =       0.000471027470
  error estimate for blocks of size 2^( 6) =       0.000483943278
  error estimate for blocks of size 2^( 7) =       0.000493696174

      target function =                  N/A
              le_mean =     -16.911160342612
             les_mean =     286.328090171622
             stat err =       0.000476217624
             autocorr =       1.331097572867
              std dev =       0.583734707255
             le_variance =       0.340746208454

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340859645088
                                         uncertainty =       0.009573459030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340859645088
                                         uncertainty =       0.009573459030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412762762
  error estimate for blocks of size 2^( 2) =       0.000426500619
  error estimate for blocks of size 2^( 3) =       0.000441277721
  error estimate for blocks of size 2^( 4) =       0.000456203567
  error estimate for blocks of size 2^( 5) =       0.000471027463
  error estimate for blocks of size 2^( 6) =       0.000483943272
  error estimate for blocks of size 2^( 7) =       0.000493696168

      target function =                  N/A
              le_mean =     -16.911160342657
             les_mean =     286.328090160498
             stat err =       0.000476217618
             autocorr =       1.331097585392
              std dev =       0.583734696438
             le_variance =       0.340746195826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340859651407
                                         uncertainty =       0.009573459342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340859651407
                                         uncertainty =       0.009573459342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412762766
  error estimate for blocks of size 2^( 2) =       0.000426500622
  error estimate for blocks of size 2^( 3) =       0.000441277725
  error estimate for blocks of size 2^( 4) =       0.000456203570
  error estimate for blocks of size 2^( 5) =       0.000471027467
  error estimate for blocks of size 2^( 6) =       0.000483943275
  error estimate for blocks of size 2^( 7) =       0.000493696171

      target function =                  N/A
              le_mean =     -16.911160342634
             les_mean =     286.328090166060
             stat err =       0.000476217621
             autocorr =       1.331097579127
              std dev =       0.583734701846
             le_variance =       0.340746202140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340859656937
                                         uncertainty =       0.009573459615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340859656937
                                         uncertainty =       0.009573459615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412762769
  error estimate for blocks of size 2^( 2) =       0.000426500625
  error estimate for blocks of size 2^( 3) =       0.000441277728
  error estimate for blocks of size 2^( 4) =       0.000456203573
  error estimate for blocks of size 2^( 5) =       0.000471027470
  error estimate for blocks of size 2^( 6) =       0.000483943278
  error estimate for blocks of size 2^( 7) =       0.000493696174

      target function =                  N/A
              le_mean =     -16.911160342615
             les_mean =     286.328090170927
             stat err =       0.000476217624
             autocorr =       1.331097573648
              std dev =       0.583734706579
             le_variance =       0.340746207664


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911160342612        initial
     5.8208e+03     5.8208e+04             3.8956e-08       -16.911160342657  <--
     2.3283e+04     2.3283e+05             9.7389e-09       -16.911160342634
     9.3132e+04     9.3132e+05             2.4347e-09       -16.911160342615

*****************************************************************************
Applying the update for shift_i =   5.8208e+03     and shift_s =   5.8208e+04
*****************************************************************************

  Execution time = 2.9522e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5579e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9589
    reference variance = 0.323729
====================================================
  Execution time = 2.0556e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3834e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5519e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338402594145
                                         uncertainty =       0.003734129941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338402594145
                                         uncertainty =       0.003734129941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411302969
  error estimate for blocks of size 2^( 2) =       0.000424645994
  error estimate for blocks of size 2^( 3) =       0.000438803268
  error estimate for blocks of size 2^( 4) =       0.000453600509
  error estimate for blocks of size 2^( 5) =       0.000467210808
  error estimate for blocks of size 2^( 6) =       0.000480109873
  error estimate for blocks of size 2^( 7) =       0.000491642739

      target function =                  N/A
              le_mean =     -16.911025629628
             les_mean =     286.321127941030
             stat err =       0.000473140982
             autocorr =       1.323297359574
              std dev =       0.581670236702
             le_variance =       0.338340264265


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691102562963e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911025629628       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911025629632       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911025629195       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911025629674       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911025629833       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911025629628       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911025629850       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911025629940       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+03 is 1.938761e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911025629628       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911025629629       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911025629520       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911025629638       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911025629680       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911025629636       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911025629684       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911025629706       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+03 is 4.847132e-08

solving harmonic davidson linear method for identity shift 2.3283e+04, overlap shift 2.3283e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911025629628       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911025629628       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911025629601       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911025629643       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911025629643       residual = 4.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911025629621       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911025629643       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911025629647       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+04 is 1.211797e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.109799 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6115e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094274e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361147e-02 1 1  ON 4
 uu_5                -9.670827e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282922e-01 1 1  ON 8
 uu_9                -9.951169e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800544e-02 1 1  ON 12
 ud_3                -1.250308e-02 1 1  ON 13
 ud_4                -6.878396e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422464e-01 1 1  ON 21
 eO_2                -2.053011e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811728e-01 1 1  ON 25
 eO_6                 2.500521e-01 1 1  ON 26
 eO_7                -4.945184e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127297e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161840e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520964e-03 1 1  ON 34
eH1_5                 4.096863e-02 1 1  ON 35
eH1_6                 9.636236e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094513e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869874e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124778e-02 1 1  ON 44
eH2_5                 4.345590e-02 1 1  ON 45
eH2_6                 9.993492e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402855e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -16.9355
    reference variance = 0.311077
====================================================
  Execution time = 2.0017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3664e-01
  Total weights = 2.0000e+06
  Execution time = 1.8747e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336675486560
                                         uncertainty =       0.003000392121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336675486560
                                         uncertainty =       0.003000392121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410265376
  error estimate for blocks of size 2^( 2) =       0.000424083591
  error estimate for blocks of size 2^( 3) =       0.000439496005
  error estimate for blocks of size 2^( 4) =       0.000455233782
  error estimate for blocks of size 2^( 5) =       0.000471066404
  error estimate for blocks of size 2^( 6) =       0.000484862834
  error estimate for blocks of size 2^( 7) =       0.000495965389

      target function =                  N/A
              le_mean =     -16.909997859926
             les_mean =     286.284662812547
             stat err =       0.000476782102
             autocorr =       1.350548404124
              std dev =       0.580202859498
             le_variance =       0.336635358170

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336675483113
                                         uncertainty =       0.003000391663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336675483113
                                         uncertainty =       0.003000391663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410265374
  error estimate for blocks of size 2^( 2) =       0.000424083587
  error estimate for blocks of size 2^( 3) =       0.000439496001
  error estimate for blocks of size 2^( 4) =       0.000455233778
  error estimate for blocks of size 2^( 5) =       0.000471066400
  error estimate for blocks of size 2^( 6) =       0.000484862832
  error estimate for blocks of size 2^( 7) =       0.000495965390

      target function =                  N/A
              le_mean =     -16.909997859110
             les_mean =     286.284662781485
             stat err =       0.000476782100
             autocorr =       1.350548407327
              std dev =       0.580202856499
             le_variance =       0.336635354689

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336675484839
                                         uncertainty =       0.003000391892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336675484839
                                         uncertainty =       0.003000391892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410265375
  error estimate for blocks of size 2^( 2) =       0.000424083589
  error estimate for blocks of size 2^( 3) =       0.000439496003
  error estimate for blocks of size 2^( 4) =       0.000455233780
  error estimate for blocks of size 2^( 5) =       0.000471066402
  error estimate for blocks of size 2^( 6) =       0.000484862833
  error estimate for blocks of size 2^( 7) =       0.000495965389

      target function =                  N/A
              le_mean =     -16.909997859518
             les_mean =     286.284662797014
             stat err =       0.000476782101
             autocorr =       1.350548405727
              std dev =       0.580202858000
             le_variance =       0.336635356432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336675486345
                                         uncertainty =       0.003000392092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.336675486345
                                         uncertainty =       0.003000392092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410265376
  error estimate for blocks of size 2^( 2) =       0.000424083591
  error estimate for blocks of size 2^( 3) =       0.000439496005
  error estimate for blocks of size 2^( 4) =       0.000455233782
  error estimate for blocks of size 2^( 5) =       0.000471066403
  error estimate for blocks of size 2^( 6) =       0.000484862833
  error estimate for blocks of size 2^( 7) =       0.000495965389

      target function =                  N/A
              le_mean =     -16.909997859875
             les_mean =     286.284662810606
             stat err =       0.000476782102
             autocorr =       1.350548404323
              std dev =       0.580202859311
             le_variance =       0.336635357953


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.909997859926        initial  <--
     1.4552e+03     1.4552e+04             1.9388e-07       -16.909997859110
     5.8208e+03     5.8208e+04             4.8471e-08       -16.909997859518
     2.3283e+04     2.3283e+05             1.2118e-08       -16.909997859875

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4530
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5576e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.0319
    reference variance = 1.31678
====================================================
  Execution time = 2.2277e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.4932e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348388089793
                                         uncertainty =       0.010145229749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348388089793
                                         uncertainty =       0.010145229749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417924781
  error estimate for blocks of size 2^( 2) =       0.000431786090
  error estimate for blocks of size 2^( 3) =       0.000447564005
  error estimate for blocks of size 2^( 4) =       0.000463835621
  error estimate for blocks of size 2^( 5) =       0.000477100044
  error estimate for blocks of size 2^( 6) =       0.000492816461
  error estimate for blocks of size 2^( 7) =       0.000503129732

      target function =                  N/A
              le_mean =     -16.910119895586
             les_mean =     286.301476953701
             stat err =       0.000484220464
             autocorr =       1.342425003534
              std dev =       0.591034893438
             le_variance =       0.349322245261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691011989559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910119895586       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910119895633       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910119895633       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910119895694       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910119895696       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910119895680       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910119895638       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910119895635       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+04 is 2.139492e-08

solving harmonic davidson linear method for identity shift 5.8208e+04, overlap shift 5.8208e+05 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910119895586       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910119895598       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910119895598       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910119895613       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910119895603       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910119895634       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910119895587       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910119895657       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+04 is 5.348774e-09

solving harmonic davidson linear method for identity shift 2.3283e+05, overlap shift 2.3283e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910119895586       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910119895589       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910119895589       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910119895593       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910119895593       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910119895558       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910119895653       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910119895323       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+05 is 1.337196e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.112499 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7808e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800544e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945184e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094511e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124782e-02 1 1  ON 44
eH2_5                 4.345590e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -16.8128
    reference variance = 0.480396
====================================================
  Execution time = 2.0174e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4887e-01
  Total weights = 2.0000e+06
  Execution time = 1.8715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348861723098
                                         uncertainty =       0.008010773632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348861723098
                                         uncertainty =       0.008010773632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417652015
  error estimate for blocks of size 2^( 2) =       0.000432468115
  error estimate for blocks of size 2^( 3) =       0.000450039845
  error estimate for blocks of size 2^( 4) =       0.000469096143
  error estimate for blocks of size 2^( 5) =       0.000492308059
  error estimate for blocks of size 2^( 6) =       0.000519606106
  error estimate for blocks of size 2^( 7) =       0.000565034008

      target function =                  N/A
              le_mean =     -16.911052333944
             les_mean =     286.332557277467
             stat err =       0.000511511079
             autocorr =       1.499964319315
              std dev =       0.590649143336
             le_variance =       0.348866410524

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348861726921
                                         uncertainty =       0.008010773745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348861726921
                                         uncertainty =       0.008010773745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417652017
  error estimate for blocks of size 2^( 2) =       0.000432468117
  error estimate for blocks of size 2^( 3) =       0.000450039847
  error estimate for blocks of size 2^( 4) =       0.000469096145
  error estimate for blocks of size 2^( 5) =       0.000492308061
  error estimate for blocks of size 2^( 6) =       0.000519606107
  error estimate for blocks of size 2^( 7) =       0.000565034008

      target function =                  N/A
              le_mean =     -16.911052333817
             les_mean =     286.332557277018
             stat err =       0.000511511080
             autocorr =       1.499964309486
              std dev =       0.590649146572
             le_variance =       0.348866414347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348861725010
                                         uncertainty =       0.008010773688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348861725010
                                         uncertainty =       0.008010773688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417652016
  error estimate for blocks of size 2^( 2) =       0.000432468116
  error estimate for blocks of size 2^( 3) =       0.000450039846
  error estimate for blocks of size 2^( 4) =       0.000469096144
  error estimate for blocks of size 2^( 5) =       0.000492308060
  error estimate for blocks of size 2^( 6) =       0.000519606106
  error estimate for blocks of size 2^( 7) =       0.000565034008

      target function =                  N/A
              le_mean =     -16.911052333880
             les_mean =     286.332557277243
             stat err =       0.000511511080
             autocorr =       1.499964314401
              std dev =       0.590649144954
             le_variance =       0.348866412435

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348861723337
                                         uncertainty =       0.008010773639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.348861723337
                                         uncertainty =       0.008010773639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000417652015
  error estimate for blocks of size 2^( 2) =       0.000432468115
  error estimate for blocks of size 2^( 3) =       0.000450039845
  error estimate for blocks of size 2^( 4) =       0.000469096143
  error estimate for blocks of size 2^( 5) =       0.000492308059
  error estimate for blocks of size 2^( 6) =       0.000519606106
  error estimate for blocks of size 2^( 7) =       0.000565034008

      target function =                  N/A
              le_mean =     -16.911052333936
             les_mean =     286.332557277439
             stat err =       0.000511511079
             autocorr =       1.499964318689
              std dev =       0.590649143538
             le_variance =       0.348866410762


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911052333944        initial  <--
     1.4552e+04     1.4552e+05             2.1395e-08       -16.911052333817
     5.8208e+04     5.8208e+05             5.3488e-09       -16.911052333880
     2.3283e+05     2.3283e+06             1.3372e-09       -16.911052333936

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5843
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7399e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6920e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.9593
    reference variance = 0.251674
====================================================
  Execution time = 2.0422e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.7591e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4248e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375973281880
                                         uncertainty =       0.021743029115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.375973281880
                                         uncertainty =       0.021743029115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000433535586
  error estimate for blocks of size 2^( 2) =       0.000446535067
  error estimate for blocks of size 2^( 3) =       0.000459865437
  error estimate for blocks of size 2^( 4) =       0.000473584493
  error estimate for blocks of size 2^( 5) =       0.000488693631
  error estimate for blocks of size 2^( 6) =       0.000498898277
  error estimate for blocks of size 2^( 7) =       0.000506029133

      target function =                  N/A
              le_mean =     -16.910312952398
             les_mean =     286.334590168681
             stat err =       0.000491801384
             autocorr =       1.286856111625
              std dev =       0.613111905430
             le_variance =       0.375906208580


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691031295240e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+05, overlap shift 1.4552e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910312952398       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910312952405       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910312952405       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910312952452       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910312952412       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910312952571       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910312952338       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910312952655       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+05 is 1.653045e-09

solving harmonic davidson linear method for identity shift 5.8208e+05, overlap shift 5.8208e+06 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910312952398       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910312952400       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910312952400       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910312952482       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910312952365       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910312952411       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910312952613       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910312952044       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+05 is 4.132613e-10

solving harmonic davidson linear method for identity shift 2.3283e+06, overlap shift 2.3283e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910312952398       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910312952399       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910312952399       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910312951613       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910312952164       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910312952350       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910312952217       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910312953236       residual = 5.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+06 is 1.033154e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.115126 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5853e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -16.8284
    reference variance = 0.374386
====================================================
  Execution time = 2.0213e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3818e-01
  Total weights = 2.0000e+06
  Execution time = 1.8763e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338251647411
                                         uncertainty =       0.004808684856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338251647411
                                         uncertainty =       0.004808684856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411205981
  error estimate for blocks of size 2^( 2) =       0.000425075237
  error estimate for blocks of size 2^( 3) =       0.000439613339
  error estimate for blocks of size 2^( 4) =       0.000454981626
  error estimate for blocks of size 2^( 5) =       0.000470227632
  error estimate for blocks of size 2^( 6) =       0.000485539164
  error estimate for blocks of size 2^( 7) =       0.000497419679

      target function =                  N/A
              le_mean =     -16.910770955443
             les_mean =     286.312354855715
             stat err =       0.000477042025
             autocorr =       1.345843107031
              std dev =       0.581533075024
             le_variance =       0.338180717347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338251647833
                                         uncertainty =       0.004808684868

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338251647833
                                         uncertainty =       0.004808684868

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411205981
  error estimate for blocks of size 2^( 2) =       0.000425075237
  error estimate for blocks of size 2^( 3) =       0.000439613340
  error estimate for blocks of size 2^( 4) =       0.000454981626
  error estimate for blocks of size 2^( 5) =       0.000470227632
  error estimate for blocks of size 2^( 6) =       0.000485539164
  error estimate for blocks of size 2^( 7) =       0.000497419679

      target function =                  N/A
              le_mean =     -16.910770955439
             les_mean =     286.312354856008
             stat err =       0.000477042025
             autocorr =       1.345843106567
              std dev =       0.581533075387
             le_variance =       0.338180717769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338251647622
                                         uncertainty =       0.004808684862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338251647622
                                         uncertainty =       0.004808684862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411205981
  error estimate for blocks of size 2^( 2) =       0.000425075237
  error estimate for blocks of size 2^( 3) =       0.000439613340
  error estimate for blocks of size 2^( 4) =       0.000454981626
  error estimate for blocks of size 2^( 5) =       0.000470227632
  error estimate for blocks of size 2^( 6) =       0.000485539164
  error estimate for blocks of size 2^( 7) =       0.000497419679

      target function =                  N/A
              le_mean =     -16.910770955441
             les_mean =     286.312354855861
             stat err =       0.000477042025
             autocorr =       1.345843106807
              std dev =       0.581533075206
             le_variance =       0.338180717558

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338251647438
                                         uncertainty =       0.004808684856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338251647438
                                         uncertainty =       0.004808684856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411205981
  error estimate for blocks of size 2^( 2) =       0.000425075237
  error estimate for blocks of size 2^( 3) =       0.000439613339
  error estimate for blocks of size 2^( 4) =       0.000454981626
  error estimate for blocks of size 2^( 5) =       0.000470227632
  error estimate for blocks of size 2^( 6) =       0.000485539164
  error estimate for blocks of size 2^( 7) =       0.000497419679

      target function =                  N/A
              le_mean =     -16.910770955443
             les_mean =     286.312354855734
             stat err =       0.000477042025
             autocorr =       1.345843107010
              std dev =       0.581533075047
             le_variance =       0.338180717374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910770955443        initial  <--
     1.4552e+05     1.4552e+06             1.6530e-09       -16.910770955439
     5.8208e+05     5.8208e+06             4.1326e-10       -16.910770955441
     2.3283e+06     2.3283e+07             1.0332e-10       -16.910770955443

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7281
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6919e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8766
    reference variance = 0.300411
====================================================
  Execution time = 2.0440e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4214e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341655638382
                                         uncertainty =       0.010124231620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341655638382
                                         uncertainty =       0.010124231620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413603676
  error estimate for blocks of size 2^( 2) =       0.000426946526
  error estimate for blocks of size 2^( 3) =       0.000441785224
  error estimate for blocks of size 2^( 4) =       0.000457205914
  error estimate for blocks of size 2^( 5) =       0.000470297366
  error estimate for blocks of size 2^( 6) =       0.000482768069
  error estimate for blocks of size 2^( 7) =       0.000488469899

      target function =                  N/A
              le_mean =     -16.910532233792
             les_mean =     286.308236260095
             stat err =       0.000474685312
             autocorr =       1.317172963562
              std dev =       0.584923927572
             le_variance =       0.342136001046


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691053223379e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910532233792       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910532233792       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910532233792       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910532233792       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910532233792       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910532233565       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910532234032       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910532233372       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 1.920368e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910532233792       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910532233792       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910532233792       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910532233792       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910532233800       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910532236826       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910532234893       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910532232082       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 4.800931e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910532233792       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910532233792       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910532233792       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910532222766       residual = 7.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910532225086       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910532232587       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910532231828       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910532227178       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 1.200217e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117686 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5962e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -16.8437
    reference variance = 0.230251
====================================================
  Execution time = 2.0301e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3951e-01
  Total weights = 2.0000e+06
  Execution time = 1.8680e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339595405940
                                         uncertainty =       0.004234401347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339595405940
                                         uncertainty =       0.004234401347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412011788
  error estimate for blocks of size 2^( 2) =       0.000425286958
  error estimate for blocks of size 2^( 3) =       0.000439439357
  error estimate for blocks of size 2^( 4) =       0.000453665225
  error estimate for blocks of size 2^( 5) =       0.000467146707
  error estimate for blocks of size 2^( 6) =       0.000478883162
  error estimate for blocks of size 2^( 7) =       0.000487635400

      target function =                  N/A
              le_mean =     -16.911228206651
             les_mean =     286.329146714285
             stat err =       0.000471832623
             autocorr =       1.311464828778
              std dev =       0.582672658208
             le_variance =       0.339507426623

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339595406015
                                         uncertainty =       0.004234401349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339595406015
                                         uncertainty =       0.004234401349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412011788
  error estimate for blocks of size 2^( 2) =       0.000425286958
  error estimate for blocks of size 2^( 3) =       0.000439439357
  error estimate for blocks of size 2^( 4) =       0.000453665225
  error estimate for blocks of size 2^( 5) =       0.000467146707
  error estimate for blocks of size 2^( 6) =       0.000478883162
  error estimate for blocks of size 2^( 7) =       0.000487635400

      target function =                  N/A
              le_mean =     -16.911228206651
             les_mean =     286.329146714358
             stat err =       0.000471832623
             autocorr =       1.311464828683
              std dev =       0.582672658272
             le_variance =       0.339507426698

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339595405977
                                         uncertainty =       0.004234401348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339595405977
                                         uncertainty =       0.004234401348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412011788
  error estimate for blocks of size 2^( 2) =       0.000425286958
  error estimate for blocks of size 2^( 3) =       0.000439439357
  error estimate for blocks of size 2^( 4) =       0.000453665225
  error estimate for blocks of size 2^( 5) =       0.000467146707
  error estimate for blocks of size 2^( 6) =       0.000478883162
  error estimate for blocks of size 2^( 7) =       0.000487635400

      target function =                  N/A
              le_mean =     -16.911228206651
             les_mean =     286.329146714322
             stat err =       0.000471832623
             autocorr =       1.311464828729
              std dev =       0.582672658240
             le_variance =       0.339507426661

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339595405944
                                         uncertainty =       0.004234401348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339595405944
                                         uncertainty =       0.004234401348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412011788
  error estimate for blocks of size 2^( 2) =       0.000425286958
  error estimate for blocks of size 2^( 3) =       0.000439439357
  error estimate for blocks of size 2^( 4) =       0.000453665225
  error estimate for blocks of size 2^( 5) =       0.000467146707
  error estimate for blocks of size 2^( 6) =       0.000478883162
  error estimate for blocks of size 2^( 7) =       0.000487635400

      target function =                  N/A
              le_mean =     -16.911228206651
             les_mean =     286.329146714290
             stat err =       0.000471832623
             autocorr =       1.311464828763
              std dev =       0.582672658212
             le_variance =       0.339507426628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911228206651        initial  <--
     1.4552e+06     1.4552e+07             1.9204e-10       -16.911228206651
     5.8208e+06     5.8208e+07             4.8009e-11       -16.911228206651
     2.3283e+07     2.3283e+08             1.2002e-11       -16.911228206651

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7126
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5682e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6917e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.807
    reference variance = 0.493427
====================================================
  Execution time = 2.0735e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3956e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5529e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339599907321
                                         uncertainty =       0.004727454648

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339599907321
                                         uncertainty =       0.004727454648

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412043801
  error estimate for blocks of size 2^( 2) =       0.000425475225
  error estimate for blocks of size 2^( 3) =       0.000440118821
  error estimate for blocks of size 2^( 4) =       0.000455729156
  error estimate for blocks of size 2^( 5) =       0.000469875572
  error estimate for blocks of size 2^( 6) =       0.000480253309
  error estimate for blocks of size 2^( 7) =       0.000486402303

      target function =                  N/A
              le_mean =     -16.911425419719
             les_mean =     286.335869745408
             stat err =       0.000473065085
             autocorr =       1.318120217522
              std dev =       0.582717932173
             le_variance =       0.339560188477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691142541972e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911425419719       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911425419719       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911425419719       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911425419719       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911425418446       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911425418861       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911425425471       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911425422232       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 2.047428e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911425419719       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911425419719       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911425419719       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911425419719       residual = 8.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911425417279       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911425420019       residual = 6.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911425380453       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911425369639       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 5.118344e-12

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911425419719       residual = 7.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911425419719       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911425419719       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911425393797       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911425413764       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911425451485       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911425446021       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911425526867       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 1.279675e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120348 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6294e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -16.9096
    reference variance = 0.150543
====================================================
  Execution time = 2.0219e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3737e-01
  Total weights = 2.0000e+06
  Execution time = 1.8845e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337413466941
                                         uncertainty =       0.003869195188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337413466941
                                         uncertainty =       0.003869195188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410710445
  error estimate for blocks of size 2^( 2) =       0.000424555791
  error estimate for blocks of size 2^( 3) =       0.000439184181
  error estimate for blocks of size 2^( 4) =       0.000454656581
  error estimate for blocks of size 2^( 5) =       0.000468958829
  error estimate for blocks of size 2^( 6) =       0.000480904526
  error estimate for blocks of size 2^( 7) =       0.000488571095

      target function =                  N/A
              le_mean =     -16.910960669987
             les_mean =     286.317956752492
             stat err =       0.000473272758
             autocorr =       1.327857642528
              std dev =       0.580832281571
             le_variance =       0.337366139315

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337413466940
                                         uncertainty =       0.003869195188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337413466940
                                         uncertainty =       0.003869195188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410710445
  error estimate for blocks of size 2^( 2) =       0.000424555791
  error estimate for blocks of size 2^( 3) =       0.000439184181
  error estimate for blocks of size 2^( 4) =       0.000454656581
  error estimate for blocks of size 2^( 5) =       0.000468958829
  error estimate for blocks of size 2^( 6) =       0.000480904526
  error estimate for blocks of size 2^( 7) =       0.000488571095

      target function =                  N/A
              le_mean =     -16.910960669987
             les_mean =     286.317956752489
             stat err =       0.000473272758
             autocorr =       1.327857642526
              std dev =       0.580832281570
             le_variance =       0.337366139314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337413466941
                                         uncertainty =       0.003869195188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337413466941
                                         uncertainty =       0.003869195188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410710445
  error estimate for blocks of size 2^( 2) =       0.000424555791
  error estimate for blocks of size 2^( 3) =       0.000439184181
  error estimate for blocks of size 2^( 4) =       0.000454656581
  error estimate for blocks of size 2^( 5) =       0.000468958829
  error estimate for blocks of size 2^( 6) =       0.000480904526
  error estimate for blocks of size 2^( 7) =       0.000488571095

      target function =                  N/A
              le_mean =     -16.910960669987
             les_mean =     286.317956752491
             stat err =       0.000473272758
             autocorr =       1.327857642530
              std dev =       0.580832281570
             le_variance =       0.337366139314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337413466941
                                         uncertainty =       0.003869195188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.337413466941
                                         uncertainty =       0.003869195188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000410710445
  error estimate for blocks of size 2^( 2) =       0.000424555791
  error estimate for blocks of size 2^( 3) =       0.000439184181
  error estimate for blocks of size 2^( 4) =       0.000454656581
  error estimate for blocks of size 2^( 5) =       0.000468958829
  error estimate for blocks of size 2^( 6) =       0.000480904526
  error estimate for blocks of size 2^( 7) =       0.000488571095

      target function =                  N/A
              le_mean =     -16.910960669987
             les_mean =     286.317956752492
             stat err =       0.000473272758
             autocorr =       1.327857642526
              std dev =       0.580832281571
             le_variance =       0.337366139315


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910960669987        initial  <--
     1.4552e+07     1.4552e+08             2.0474e-11       -16.910960669987
     5.8208e+07     5.8208e+08             5.1183e-12       -16.910960669987
     2.3283e+08     2.3283e+09             1.2797e-12       -16.910960669987

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.6286
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5929e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9115
    reference variance = 0.24689
====================================================
  Execution time = 2.0477e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.3880e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338685187364
                                         uncertainty =       0.003065127305

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.338685187364
                                         uncertainty =       0.003065127305

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411584305
  error estimate for blocks of size 2^( 2) =       0.000425517486
  error estimate for blocks of size 2^( 3) =       0.000440505554
  error estimate for blocks of size 2^( 4) =       0.000455620654
  error estimate for blocks of size 2^( 5) =       0.000470713916
  error estimate for blocks of size 2^( 6) =       0.000483441427
  error estimate for blocks of size 2^( 7) =       0.000489828182

      target function =                  N/A
              le_mean =     -16.910657948227
             les_mean =     286.309155352121
             stat err =       0.000474901045
             autocorr =       1.331338956125
              std dev =       0.582068105623
             le_variance =       0.338803279583


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691065794823e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910657948227       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910657948227       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910657948227       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910657948227       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910657955328       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910658029802       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910657881947       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.870661e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910657948227       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910657948227       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910657948227       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910657941360       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910657939495       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910657691971       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910657976080       residual = 7.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 4.679445e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910657948227       residual = 6.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910657948227       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910657948227       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910656003886       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910657948227       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910657784785       residual = 8.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910661307717       residual = 8.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 1.166664e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.122612 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6013e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -16.9118
    reference variance = 0.219413
====================================================
  Execution time = 2.0220e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4469e-01
  Total weights = 2.0000e+06
  Execution time = 1.8808e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344708485775
                                         uncertainty =       0.004030417419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344708485775
                                         uncertainty =       0.004030417419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415144652
  error estimate for blocks of size 2^( 2) =       0.000428786468
  error estimate for blocks of size 2^( 3) =       0.000443644651
  error estimate for blocks of size 2^( 4) =       0.000459704620
  error estimate for blocks of size 2^( 5) =       0.000474489669
  error estimate for blocks of size 2^( 6) =       0.000487293964
  error estimate for blocks of size 2^( 7) =       0.000501220548

      target function =                  N/A
              le_mean =     -16.911044168394
             les_mean =     286.328104857993
             stat err =       0.000480677200
             autocorr =       1.340627580427
              std dev =       0.587103197881
             le_variance =       0.344690164962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344708485776
                                         uncertainty =       0.004030417419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344708485776
                                         uncertainty =       0.004030417419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415144652
  error estimate for blocks of size 2^( 2) =       0.000428786468
  error estimate for blocks of size 2^( 3) =       0.000443644651
  error estimate for blocks of size 2^( 4) =       0.000459704620
  error estimate for blocks of size 2^( 5) =       0.000474489669
  error estimate for blocks of size 2^( 6) =       0.000487293964
  error estimate for blocks of size 2^( 7) =       0.000501220548

      target function =                  N/A
              le_mean =     -16.911044168394
             les_mean =     286.328104857994
             stat err =       0.000480677200
             autocorr =       1.340627580420
              std dev =       0.587103197881
             le_variance =       0.344690164963

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344708485775
                                         uncertainty =       0.004030417419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344708485775
                                         uncertainty =       0.004030417419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415144652
  error estimate for blocks of size 2^( 2) =       0.000428786468
  error estimate for blocks of size 2^( 3) =       0.000443644651
  error estimate for blocks of size 2^( 4) =       0.000459704620
  error estimate for blocks of size 2^( 5) =       0.000474489669
  error estimate for blocks of size 2^( 6) =       0.000487293964
  error estimate for blocks of size 2^( 7) =       0.000501220548

      target function =                  N/A
              le_mean =     -16.911044168394
             les_mean =     286.328104857994
             stat err =       0.000480677200
             autocorr =       1.340627580417
              std dev =       0.587103197881
             le_variance =       0.344690164962

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344708485775
                                         uncertainty =       0.004030417419

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.344708485775
                                         uncertainty =       0.004030417419

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000415144652
  error estimate for blocks of size 2^( 2) =       0.000428786468
  error estimate for blocks of size 2^( 3) =       0.000443644651
  error estimate for blocks of size 2^( 4) =       0.000459704620
  error estimate for blocks of size 2^( 5) =       0.000474489669
  error estimate for blocks of size 2^( 6) =       0.000487293964
  error estimate for blocks of size 2^( 7) =       0.000501220548

      target function =                  N/A
              le_mean =     -16.911044168394
             les_mean =     286.328104857993
             stat err =       0.000480677200
             autocorr =       1.340627580410
              std dev =       0.587103197881
             le_variance =       0.344690164962


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911044168394        initial
     1.4552e+08     1.4552e+09             1.8707e-12       -16.911044168394
     5.8208e+08     5.8208e+09             4.6794e-13       -16.911044168394  <--
     2.3283e+09     2.3283e+10             1.1667e-13       -16.911044168394

*****************************************************************************
Applying the update for shift_i =   5.8208e+08     and shift_s =   5.8208e+09
*****************************************************************************

  Execution time = 2.9720e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6916e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.8976
    reference variance = 0.308213
====================================================
  Execution time = 2.0547e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6911e+01
  VMC Evar = 3.4131e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.0601e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341382048445
                                         uncertainty =       0.004719057699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.341382048445
                                         uncertainty =       0.004719057699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000413101587
  error estimate for blocks of size 2^( 2) =       0.000426700022
  error estimate for blocks of size 2^( 3) =       0.000441234639
  error estimate for blocks of size 2^( 4) =       0.000455849390
  error estimate for blocks of size 2^( 5) =       0.000470231224
  error estimate for blocks of size 2^( 6) =       0.000482180272
  error estimate for blocks of size 2^( 7) =       0.000491402921

      target function =                  N/A
              le_mean =     -16.911320048816
             les_mean =     286.334051465124
             stat err =       0.000474915952
             autocorr =       1.321660126555
              std dev =       0.584213866919
             le_variance =       0.341305842300


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691132004882e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911320048816       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911320048816       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911320048816       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911320048816       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911320048816       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911320048816       residual = 9.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911320024954       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911319893918       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 1.672247e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911320048816       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911320048816       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911320048816       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911319895925       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911319119779       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911319542539       residual = 9.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911320029820       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911320873600       residual = 3.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 4.174578e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.911320048816       residual = 9.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.911320048816       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.911320048816       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.911321640044       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.911317916491       residual = 4.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.911317884365       residual = 9.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.911320266415       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.911319326177       residual = 4.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 1.040228e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125287 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7609e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -16.9061
    reference variance = 0.251352
====================================================
  Execution time = 2.0406e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3895e-01
  Total weights = 2.0000e+06
  Execution time = 1.8662e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028993255
                                         uncertainty =       0.003924142091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028993255
                                         uncertainty =       0.003924142091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411676535
  error estimate for blocks of size 2^( 2) =       0.000424894423
  error estimate for blocks of size 2^( 3) =       0.000439399452
  error estimate for blocks of size 2^( 4) =       0.000454151501
  error estimate for blocks of size 2^( 5) =       0.000468899031
  error estimate for blocks of size 2^( 6) =       0.000483124799
  error estimate for blocks of size 2^( 7) =       0.000495839148

      target function =                  N/A
              le_mean =     -16.910369886009
             les_mean =     286.299564650354
             stat err =       0.000475503620
             autocorr =       1.334121640078
              std dev =       0.582198538479
             le_variance =       0.338955138208

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028993255
                                         uncertainty =       0.003924142091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028993255
                                         uncertainty =       0.003924142091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411676535
  error estimate for blocks of size 2^( 2) =       0.000424894423
  error estimate for blocks of size 2^( 3) =       0.000439399452
  error estimate for blocks of size 2^( 4) =       0.000454151501
  error estimate for blocks of size 2^( 5) =       0.000468899031
  error estimate for blocks of size 2^( 6) =       0.000483124799
  error estimate for blocks of size 2^( 7) =       0.000495839148

      target function =                  N/A
              le_mean =     -16.910369886009
             les_mean =     286.299564650354
             stat err =       0.000475503620
             autocorr =       1.334121640084
              std dev =       0.582198538479
             le_variance =       0.338955138207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028993255
                                         uncertainty =       0.003924142091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028993255
                                         uncertainty =       0.003924142091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411676535
  error estimate for blocks of size 2^( 2) =       0.000424894423
  error estimate for blocks of size 2^( 3) =       0.000439399452
  error estimate for blocks of size 2^( 4) =       0.000454151501
  error estimate for blocks of size 2^( 5) =       0.000468899031
  error estimate for blocks of size 2^( 6) =       0.000483124799
  error estimate for blocks of size 2^( 7) =       0.000495839148

      target function =                  N/A
              le_mean =     -16.910369886009
             les_mean =     286.299564650354
             stat err =       0.000475503620
             autocorr =       1.334121640088
              std dev =       0.582198538479
             le_variance =       0.338955138207

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028993255
                                         uncertainty =       0.003924142091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.339028993255
                                         uncertainty =       0.003924142091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000411676535
  error estimate for blocks of size 2^( 2) =       0.000424894423
  error estimate for blocks of size 2^( 3) =       0.000439399452
  error estimate for blocks of size 2^( 4) =       0.000454151501
  error estimate for blocks of size 2^( 5) =       0.000468899031
  error estimate for blocks of size 2^( 6) =       0.000483124799
  error estimate for blocks of size 2^( 7) =       0.000495839148

      target function =                  N/A
              le_mean =     -16.910369886009
             les_mean =     286.299564650354
             stat err =       0.000475503620
             autocorr =       1.334121640085
              std dev =       0.582198538479
             le_variance =       0.338955138208


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.910369886009        initial  <--
     1.4552e+08     1.4552e+09             1.6722e-12       -16.910369886009
     5.8208e+08     5.8208e+09             4.1746e-13       -16.910369886009
     2.3283e+09     2.3283e+10             1.0402e-13       -16.910369886009

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8148
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7430e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.6915e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 17096 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9354
    reference variance = 0.465078
====================================================
  Execution time = 2.0473e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.6910e+01
  VMC Evar = 3.3525e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4951e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335208905626
                                         uncertainty =       0.002966126505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.335208905626
                                         uncertainty =       0.002966126505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000409421124
  error estimate for blocks of size 2^( 2) =       0.000423849361
  error estimate for blocks of size 2^( 3) =       0.000438398237
  error estimate for blocks of size 2^( 4) =       0.000453393947
  error estimate for blocks of size 2^( 5) =       0.000467484439
  error estimate for blocks of size 2^( 6) =       0.000479765399
  error estimate for blocks of size 2^( 7) =       0.000489090633

      target function =                  N/A
              le_mean =     -16.910059768732
             les_mean =     286.285372528499
             stat err =       0.000472433604
             autocorr =       1.331499691638
              std dev =       0.579008906712
             le_variance =       0.335251314052


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.691005976873e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910059768732       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910059768732       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910059768732       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910060061051       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910059377226       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910059745662       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910059986863       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 1.679314e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910059768732       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910059768732       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910059768732       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910052502133       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910058633322       residual = 4.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910055051194       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910059891919       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910056713109       residual = 5.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 4.278868e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega 0.0000e+00

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   energy =     -16.910059768732       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   energy =     -16.910059768732       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   energy =     -16.910059768732       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   energy =     -16.910035639169       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   energy =     -16.910061287121       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   energy =     -16.910043514000       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   energy =     -16.910065178006       residual = 3.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   energy =     -16.910068772903       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   energy =     -16.910071697298       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   energy =     -16.910157736469       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   energy =     -16.910001790932       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   energy =     -16.910205700801       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   energy =     -16.909978908097       residual = 8.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   energy =     -16.910504056809       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   energy =     -16.910107701351       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   energy =     -16.910821235188       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   energy =     -16.908082496147       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   energy =     -16.909417269839       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   energy =     -16.911504209289       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   energy =     -16.910562468839       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   energy =     -16.912413890068       residual = 7.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   energy =     -16.914606318082       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   energy =     -16.905186317794       residual = 3.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   energy =     -16.912683721676       residual = 8.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   energy =     -16.911052763401       residual = 1.42e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   energy =     -16.908413722321       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   energy =     -16.905977400435       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   energy =     -16.914309153964       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   energy =     -16.912128625418       residual = 5.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   energy =     -16.910393007520       residual = 1.57e-05           smallest_sin_value = 9.99e-01
davidson iteration   30:   krylov dim =  31   energy =     -16.911912905696       residual = 4.43e-04           smallest_sin_value = 9.99e-01
davidson iteration   31 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         31 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 1.049665e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.140790 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5987e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -16.9126
    reference variance = 0.214472
====================================================
  Execution time = 2.0572e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.6912e+01
  VMC Evar = 3.7876e-01
  Total weights = 2.0000e+06
  Execution time = 1.8659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378890467467
                                         uncertainty =       0.019867224155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378890467467
                                         uncertainty =       0.019867224155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435178676
  error estimate for blocks of size 2^( 2) =       0.000447992320
  error estimate for blocks of size 2^( 3) =       0.000462841471
  error estimate for blocks of size 2^( 4) =       0.000476054424
  error estimate for blocks of size 2^( 5) =       0.000490952046
  error estimate for blocks of size 2^( 6) =       0.000505927346
  error estimate for blocks of size 2^( 7) =       0.000518362870

      target function =                  N/A
              le_mean =     -16.911660587730
             les_mean =     286.383024606111
             stat err =       0.000497824172
             autocorr =       1.308629618351
              std dev =       0.615435586335
             le_variance =       0.378760960928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378890467467
                                         uncertainty =       0.019867224155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378890467467
                                         uncertainty =       0.019867224155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435178676
  error estimate for blocks of size 2^( 2) =       0.000447992320
  error estimate for blocks of size 2^( 3) =       0.000462841471
  error estimate for blocks of size 2^( 4) =       0.000476054424
  error estimate for blocks of size 2^( 5) =       0.000490952046
  error estimate for blocks of size 2^( 6) =       0.000505927346
  error estimate for blocks of size 2^( 7) =       0.000518362870

      target function =                  N/A
              le_mean =     -16.911660587730
             les_mean =     286.383024606111
             stat err =       0.000497824172
             autocorr =       1.308629618348
              std dev =       0.615435586335
             le_variance =       0.378760960928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378890467467
                                         uncertainty =       0.019867224155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378890467467
                                         uncertainty =       0.019867224155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435178676
  error estimate for blocks of size 2^( 2) =       0.000447992320
  error estimate for blocks of size 2^( 3) =       0.000462841471
  error estimate for blocks of size 2^( 4) =       0.000476054424
  error estimate for blocks of size 2^( 5) =       0.000490952046
  error estimate for blocks of size 2^( 6) =       0.000505927346
  error estimate for blocks of size 2^( 7) =       0.000518362870

      target function =                  N/A
              le_mean =     -16.911660587730
             les_mean =     286.383024606111
             stat err =       0.000497824172
             autocorr =       1.308629618348
              std dev =       0.615435586335
             le_variance =       0.378760960928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378890467467
                                         uncertainty =       0.019867224155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.378890467467
                                         uncertainty =       0.019867224155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000435178676
  error estimate for blocks of size 2^( 2) =       0.000447992320
  error estimate for blocks of size 2^( 3) =       0.000462841471
  error estimate for blocks of size 2^( 4) =       0.000476054424
  error estimate for blocks of size 2^( 5) =       0.000490952046
  error estimate for blocks of size 2^( 6) =       0.000505927346
  error estimate for blocks of size 2^( 7) =       0.000518362870

      target function =                  N/A
              le_mean =     -16.911660587730
             les_mean =     286.383024606111
             stat err =       0.000497824172
             autocorr =       1.308629618351
              std dev =       0.615435586335
             le_variance =       0.378760960928


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A       -16.911660587730        initial  <--
     1.4552e+09     1.4552e+10             1.6793e-13       -16.911660587730
     5.8208e+09     5.8208e+10             4.2789e-14       -16.911660587730
     2.3283e+10     2.3283e+11             1.0497e-14       -16.911660587730

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9809
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 3.083700e-01 1 1  ON 0
 uu_1                 1.416767e-01 1 1  ON 1
 uu_2                 4.094271e-02 1 1  ON 2
 uu_3                -2.029634e-02 1 1  ON 3
 uu_4                -6.361145e-02 1 1  ON 4
 uu_5                -9.670829e-02 1 1  ON 5
 uu_6                -1.233240e-01 1 1  ON 6
 uu_7                -1.363789e-01 1 1  ON 7
 uu_8                -1.282921e-01 1 1  ON 8
 uu_9                -9.951167e-02 1 1  ON 9
 ud_0                 4.435018e-01 1 1  ON 10
 ud_1                 1.777445e-01 1 1  ON 11
 ud_2                 5.800545e-02 1 1  ON 12
 ud_3                -1.250309e-02 1 1  ON 13
 ud_4                -6.878397e-02 1 1  ON 14
 ud_5                -1.080321e-01 1 1  ON 15
 ud_6                -1.328837e-01 1 1  ON 16
 ud_7                -1.469906e-01 1 1  ON 17
 ud_8                -1.457591e-01 1 1  ON 18
 ud_9                -1.352403e-01 1 1  ON 19
 eO_0                -7.634963e-01 1 1  ON 20
 eO_1                -4.422463e-01 1 1  ON 21
 eO_2                -2.053012e-02 1 1  ON 22
 eO_3                 3.008195e-01 1 1  ON 23
 eO_4                 5.250651e-01 1 1  ON 24
 eO_5                 4.811727e-01 1 1  ON 25
 eO_6                 2.500520e-01 1 1  ON 26
 eO_7                -4.945185e-02 1 1  ON 27
 eO_8                -2.104215e-01 1 1  ON 28
 eO_9                -7.127295e-02 1 1  ON 29
eH1_0                -2.362976e-01 1 1  ON 30
eH1_1                -1.371898e-01 1 1  ON 31
eH1_2                -9.161839e-02 1 1  ON 32
eH1_3                -3.823020e-02 1 1  ON 33
eH1_4                 7.520988e-03 1 1  ON 34
eH1_5                 4.096866e-02 1 1  ON 35
eH1_6                 9.636235e-02 1 1  ON 36
eH1_7                 1.470450e-01 1 1  ON 37
eH1_8                 1.639070e-01 1 1  ON 38
eH1_9                 5.094510e-02 1 1  ON 39
eH2_0                -2.332770e-01 1 1  ON 40
eH2_1                -1.342081e-01 1 1  ON 41
eH2_2                -8.869876e-02 1 1  ON 42
eH2_3                -3.500513e-02 1 1  ON 43
eH2_4                 1.124783e-02 1 1  ON 44
eH2_5                 4.345589e-02 1 1  ON 45
eH2_6                 9.993493e-02 1 1  ON 46
eH2_7                 1.511981e-01 1 1  ON 47
eH2_8                 1.690103e-01 1 1  ON 48
eH2_9                 3.402851e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5974e+01 secs
  Total Execution time = 2.2609e+03 secs

=========================================================
  A new xml input file : H2O.s039.cont.xml
